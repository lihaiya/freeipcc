"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[1921],{34688:function(V,j,e){e.r(j),e.d(j,{default:function(){return Ce}});var k=e(17061),p=e.n(k),q=e(42122),y=e.n(q),_=e(17156),C=e.n(_),ee=e(27424),M=e.n(ee),te=e(76772),B=e(48086),ae=e(11382),x=e(51752),ne=e(71230),K=e(15746),re=e(27904),P=e(67294),se=e(96974),d={container:"container___vQ2DX",left:"left___n70Ss",lang:"lang___UJK4w",content:"content___JsmSa",top:"top___kxtD_",header:"header___TaolM",logo:"logo___hLexh",title:"title___uCo7A",desc:"desc___DNm2Z",main:"main___MoDp4",icon:"icon___fyJ_c",other:"other___CmvHC",register:"register___DO8YG",prefixIcon:"prefixIcon___JfMBr",remember:"remember___vCS2m",right:"right___Se0gn",systemName:"systemName___GAwVY",systemDesc:"systemDesc___aZU19",bottom:"bottom___Sb3ri",view:"view___uOnY0",url:"url___XQcxK"},Z=e(19917),L=e(48017),R=e(29127),ie=e(94975),oe=e(89728),ue=e.n(oe),le=e(56690),ce=e.n(le),ge=e(38416),i=e.n(ge),s=ue()(function n(){ce()(this,n)});i()(s,"API_BASE","api"),i()(s,"SYSTEM_NAME","GSD"),i()(s,"LOGIN","LOGIN-STATUS"),i()(s,"DOC_URL","http://doc.jetlinks.cn"),i()(s,"BASE_CURD_MODAL_VISIBLE","BASE_CURD_MODAL_VISIBLE"),i()(s,"BASE_CURD_CURRENT","BASE_CURD_CURRENT"),i()(s,"BASE_CURD_MODEL","BASE_CURD_MODEL"),i()(s,"BASE_UPDATE_DATA","BASE_UPDATE_DATA"),i()(s,"GLOBAL_WEBSOCKET","GLOBAL-WEBSOCKET"),i()(s,"BIND_USER_STATE","false"),i()(s,"REFRESH_METADATA","refresh_metadata"),i()(s,"REFRESH_METADATA_TABLE","refresh_metadata_table"),i()(s,"GET_METADATA","get_metadata"),i()(s,"REFRESH_DEVICE","refresh_device"),i()(s,"AMAP_KEY","amap_key"),i()(s,"Version_Code","version_code");var l=s,o=e(11238),de={queryCaptchaConfig:function(){return(0,o.ZP)("/".concat(l.API_BASE,"/authorize/captcha/config"),{method:"GET"})},getCaptchaImg:function(){return(0,o.ZP)("/".concat(l.API_BASE,"/authorize/captcha/image?width=130&height=30"),{method:"GET"})},captchaConfig:function(){return(0,Z.P)(function(){return(0,L.D)((0,o.ZP)("/${SystemConst.API_BASE}/authorize/captcha/config",{method:"GET"})).pipe((0,R.U)(function(a){return a==null?void 0:a.result}))})},getCaptcha:function(){return(0,Z.P)(function(){return(0,L.D)((0,o.ZP)("/".concat(l.API_BASE,"/authorize/captcha/image?width=130&height=30"),{method:"GET"})).pipe((0,R.U)(function(a){return a.result}))})},login:function(a){return(0,Z.P)(function(){return(0,L.D)((0,o.ZP)("/".concat(l.API_BASE,"/authorize/login"),{method:"POST",data:a})).pipe((0,ie.h)(function(r){return r.status===200}),(0,R.U)(function(r){return r.result}))})},login2:function(a){return(0,o.ZP)("/".concat(l.API_BASE,"/authorize/login"),{method:"POST",data:a})},queryCurrent:function(){return(0,o.ZP)("/".concat(l.API_BASE,"/authorize/me"),{method:"GET"})},logout:function(){return(0,o.ZP)("".concat(l.API_BASE,"/user-token/reset"),{method:"GET"})},bindInfo:function(a){return(0,o.ZP)("/".concat(l.API_BASE,"/application/sso/_all"),{method:"GET",params:a})},settingDetail:function(a){return(0,o.ZP)("/".concat(l.API_BASE,"/system/config/").concat(a),{method:"GET"})},getSystemVersion:function(){return(0,o.ZP)("/".concat(l.API_BASE,"/system/version"),{method:"GET"})},userDetail:function(){return(0,o.ZP)("/".concat(l.API_BASE,"/user/detail"),{method:"GET"})},initPage:function(){return(0,o.ZP)("/".concat(l.API_BASE,"/user/settings/init"),{method:"GET"})},getOAuth2:function(a){return(0,o.ZP)("/".concat(l.API_BASE,"/oauth2/authorize"),{method:"GET",params:a})},initApplication:function(a){return(0,o.ZP)("/".concat(l.API_BASE,"/application/").concat(a,"/info"),{method:"GET"})}},he=de,T=e(9459),me=e(89366),fe=e(2603),pe=e(6166),G=e(5966);function Re(n,a){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function n(a,r){return _regeneratorRuntime().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",request("/api/login/captcha",_objectSpread({method:"GET",params:_objectSpread({},a)},r||{})));case 1:case"end":return h.stop()}},n)})),U.apply(this,arguments)}function Ge(){return F.apply(this,arguments)}function F(){return F=_asyncToGenerator(_regeneratorRuntime().mark(function n(){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/captchaImage",{headers:{}}));case 1:case"end":return r.stop()}},n)})),F.apply(this,arguments)}function Ue(n){return N.apply(this,arguments)}function N(){return N=_asyncToGenerator(_regeneratorRuntime().mark(function n(a){return _regeneratorRuntime().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",request("/api/login/captcha?mobile=".concat(a)));case 1:case"end":return v.stop()}},n)})),N.apply(this,arguments)}function ve(n,a){return O.apply(this,arguments)}function O(){return O=C()(p()().mark(function n(a,r){return p()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,o.ZP)("/api/login",y()({method:"POST",headers:{"Content-Type":"application/json"},data:a},r||{})));case 1:case"end":return h.stop()}},n)})),O.apply(this,arguments)}var Ae=e(8835),Se=e(84865),t=e(85893),Ee=function(a){var r=a.content;return(0,t.jsx)(te.Z,{style:{marginBottom:24},message:r,type:"error",showIcon:!0})},ye=function(){var a=(0,P.useState)({}),r=M()(a,2),v=r[0],h=r[1],Pe=(0,P.useState)(!1),b=M()(Pe,2),Te=b[0],z=b[1],Me=(0,P.useState)({}),Y=M()(Me,2),H=Y[0],Be=Y[1],J=(0,T.useModel)("@@initialState"),I=J.initialState,Ie=J.setInitialState,De=(0,P.useState)("account"),Q=M()(De,2),$=Q[0],je=Q[1],A=(0,T.useIntl)(),Fe=(0,se.s0)(),Ne=function(){var E=C()(p()().mark(function m(){var S,u;return p()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,I==null||(S=I.fetchUserInfo)===null||S===void 0?void 0:S.call(I);case 2:if(u=f.sent,!u){f.next=6;break}return f.next=6,Ie(function(D){return y()(y()({},D),{},{currentUser:u})});case 6:case"end":return f.stop()}},m)}));return function(){return E.apply(this,arguments)}}(),w=function(){var E=C()(p()().mark(function m(){return p()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:he.getCaptchaImg().then(function(g){Be(g),z(!1)}).catch(function(g){B.ZP.error(g)});case 1:case"end":return u.stop()}},m)}));return function(){return E.apply(this,arguments)}}();(0,P.useEffect)(w,[]);var xe=function(){var E=C()(p()().mark(function m(S){var u,g,f,D,W,X;return p()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,z(!0),c.next=4,ve(y()(y()({uuid:H.key},S),{},{type:$}));case 4:if(u=c.sent,z(!1),u.code!==200){c.next=18;break}return g=A.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),f=new Date,D=f.setTime(f.getTime()+432e5),(0,Ae.ZB)(u.token,u.token,D),B.ZP.success(g),W=new URL(window.location.href).searchParams,console.log("urlParams="+W),Se.m.push("/home"),c.abrupt("return");case 18:return console.log("login failed"),c.next=21,w();case 21:h({status:"error",type:"account",massage:u.msg}),B.ZP.error(u.msg);case 23:c.next=30;break;case 25:c.prev=25,c.t0=c.catch(0),X=A.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(c.t0),B.ZP.error(X);case 30:case"end":return c.stop()}},m,null,[[0,25]])}));return function(S){return E.apply(this,arguments)}}(),Ze=v.status,Le=v.type;return(0,t.jsx)(ae.Z,{delay:500,spinning:Te,children:(0,t.jsxs)("div",{className:d.container,children:[(0,t.jsxs)("div",{className:d.left,children:[(0,t.jsx)("div",{className:d.content,children:(0,t.jsx)("div",{className:d.top,children:(0,t.jsx)("div",{className:d.main,children:(0,t.jsxs)(pe.U,{logo:(0,t.jsx)("img",{alt:"logo",src:"/gsd-logo.png"}),title:"\u94A9\u4E09\u70B9\u667A\u80FD",subTitle:A.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},onFinish:function(){var E=C()(p()().mark(function m(S){return p()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,xe(S);case 2:case"end":return g.stop()}},m)}));return function(m){return E.apply(this,arguments)}}(),children:[(0,t.jsxs)(x.Z,{activeKey:$,onChange:je,children:[(0,t.jsx)(x.Z.TabPane,{tab:A.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account"),(0,t.jsx)(x.Z.TabPane,{tab:A.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})},"mobile")]}),Ze==="error"&&Le==="account"&&(0,t.jsx)(Ee,{content:A.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),$==="account"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G.Z,{name:"username",fieldProps:{size:"large",prefix:(0,t.jsx)(me.Z,{className:d.prefixIcon})},placeholder:A.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: "}),rules:[{required:!0,message:(0,t.jsx)(T.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,t.jsx)(G.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(fe.Z,{className:d.prefixIcon})},placeholder:A.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: "}),rules:[{required:!0,message:(0,t.jsx)(T.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]}),(0,t.jsxs)(ne.Z,{children:[(0,t.jsx)(K.Z,{flex:3,children:(0,t.jsx)(G.Z,{style:{float:"right"},name:"code",placeholder:A.formatMessage({id:"pages.login.code.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),rules:[{required:!0,message:(0,t.jsx)(T.FormattedMessage,{id:"pages.searchTable.updateForm.ruleName.nameRules",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"})}]})}),(0,t.jsx)(K.Z,{flex:2,children:(0,t.jsx)(re.Z,{src:H.base64,alt:"\u9A8C\u8BC1\u7801",style:{display:"inline-block",verticalAlign:"top",cursor:"pointer",paddingLeft:"10px",width:"100px"},preview:!1,onClick:w})})]})]}),(0,t.jsx)("div",{style:{marginBottom:24}})]})})})}),(0,t.jsxs)("div",{className:d.bottom,children:[(0,t.jsx)("div",{className:d.view}),(0,t.jsx)("div",{className:d.url,children:(0,t.jsx)("div",{style:{height:33},children:"2023@\u94A9\u4E09\u70B9(\u676D\u5DDE)"})})]})]}),(0,t.jsx)("div",{className:d.right,children:(0,t.jsx)("img",{src:e(95493),style:{width:"100%",height:"100%"}})})]})})},Ce=ye},95493:function(V,j,e){V.exports=e.p+"static/banner2.5c36f1ab.png"}}]);
