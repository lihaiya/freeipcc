(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5304],{20499:function(){},64851:function(){},59518:function(){},26199:function(){},14156:function(){},71468:function(){},48871:function(){},9871:function(){},25612:function(){},92777:function(){},20159:function(){},6727:function(){},48551:function(je,$,P){"use strict";P.d($,{ep:function(){return J},vI:function(){return oe}});var Z=P(46754);const H=Z.Bz.create({type:"react componnet"});Z.kJ.registerReactComponent=H.register,Z.kJ.unregisterReactComponent=H.unregister,Z.kJ.Hook.prototype.getReactComponent=function(Ae){const X=this.options.getReactComponent;if(typeof X=="function"){const Q=Z.Iw.call(X,this.graph,Ae);if(Q!=null)return Q}let le=Ae.getComponent();if(typeof le=="string"){const Q=H.get(le);if(Q==null)return H.onNotFound(le);le=Q}return le};class J extends Z.NB{get component(){return this.getComponent()}set component(X){this.setComponent(X)}getComponent(){return this.store.get("component")}setComponent(X,le={}){return X==null?this.removeComponent(le):this.store.set("component",X,le),this}removeComponent(X={}){return this.store.remove("component",X),this}}(function(Ae){function X(le,Q,ne="rect"){const he=[],Ue=Q?Z.Lu.getForeignObjectMarkup():{tagName:"g",selector:"content"};return le?he.push(Ue):he.push({tagName:ne,selector:"body"},Ue,{tagName:"text",selector:"label"}),he}Ae.config({view:"react-shape-view",markup:X(!1,!0),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"},label:{fontSize:14,fill:"#333",refX:"50%",refY:"50%",textAnchor:"middle",textVerticalAnchor:"middle"}},propHooks(le){if(le.markup==null){const Q=le.primer,ne=le.useForeignObject!==!1;if(Q&&Q!=="rect"){le.markup=X(!1,ne,Q);let he={};Q==="circle"?he={refCx:"50%",refCy:"50%",refR:"50%"}:Q==="ellipse"&&(he={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}),le.attrs=Z.QK.merge({},{body:Object.assign({refWidth:null,refHeight:null},he)},le.attrs||{})}else le.simple&&(le.markup=X(!0,ne),le.attrs=Z.QK.merge({},{body:null,label:null},le.attrs||{}))}return le}}),Z.NB.registry.register("react-shape",Ae,!0)})(J||(J={}));var U=P(67294),pe=P(73935),ke;(function(Ae){let X=!1,le;const Q=(De,_t)=>{const N=_t.payload;switch(_t.type){case"add":{const ze=De.findIndex(Ze=>Ze.id===N.id);return ze>=0?(De[ze]=N,[...De]):[...De,N]}case"remove":{const ze=De.findIndex(Ze=>Ze.id===N.id);if(ze>=0){const Ze=[...De];return Ze.splice(ze,1),Ze}break}default:break}return De};function ne(De,_t){X&&le({type:"add",payload:{id:De,portal:_t}})}Ae.connect=ne;function he(De){X&&le({type:"remove",payload:{id:De}})}Ae.disconnect=he;function Ue(){return X}Ae.isActive=Ue;function ce(){return()=>{X=!0;const[De,_t]=(0,U.useReducer)(Q,[]);return le=_t,U.createElement(U.Fragment,{children:De.map(N=>N.portal)})}}Ae.getProvider=ce})(ke||(ke={}));class Ce extends U.PureComponent{constructor(X){super(X),this.scheduledAnimationFrame=!1,this.throttleUpdateFunc=()=>{this.scheduledAnimationFrame||(this.scheduledAnimationFrame=!0,window.requestAnimationFrame(()=>{this.setState(le=>(this.scheduledAnimationFrame=!1,{tick:le.tick+1}))}))},this.onChange=le=>{if(Ce.throttleChangeTypes.includes(le.key)){this.throttleUpdateFunc();return}this.setState({tick:this.state.tick+1})},this.state={tick:0}}componentDidMount(){this.props.node.on("change:*",this.onChange)}componentWillUnmount(){this.props.node.off("change:*",this.onChange)}clone(X){const{node:le}=this.props;return typeof X.type=="string"?U.cloneElement(X):U.cloneElement(X,{node:le})}render(){const{graph:X,node:le,component:Q}=this.props;if(U.isValidElement(Q))return this.clone(Q);if(typeof Q=="function"){const ne=Z.Iw.call(Q,X,le);if(U.isValidElement(ne))return this.clone(ne)}return Q}}Ce.throttleChangeTypes=["position","size"];class ge extends Z.DK{init(){super.init(),this.cell.on("removed",()=>{ke.disconnect(this.cell.id)})}getComponentContainer(){return this.cell.prop("useForeignObject")===!1?this.selectors.content:this.selectors.foContent}confirmUpdate(X){const le=super.confirmUpdate(X);return this.handleAction(le,ge.action,()=>{Z.b2?Z.b2.scheduleTask(()=>{this.renderReactComponent()}):this.renderReactComponent()})}renderReactComponent(){this.unmountReactComponent();const X=this.getComponentContainer(),le=this.cell,Q=this.graph;if(X){const ne=this.graph.hook.getReactComponent(le),he=U.createElement(Ce,{graph:Q,node:le,component:ne});ke.isActive()?ke.connect(this.cell.id,pe.createPortal(he,X)):pe.render(he,X)}}unmountReactComponent(){const X=this.getComponentContainer();return X&&pe.unmountComponentAtNode(X),X}onMouseDown(X,le,Q){const ne=X.target;if(ne.tagName.toLowerCase()==="input"){const Ue=ne.getAttribute("type");if(Ue==null||["text","password","number","email","search","tel","url"].includes(Ue))return}super.onMouseDown(X,le,Q)}unmount(){return ke.disconnect(this.cell.id),this.unmountReactComponent(),super.unmount(),this}}(function(Ae){Ae.action="react",Ae.config({bootstrap:[Ae.action],actions:{component:Ae.action}}),Z.DK.registry.register("react-shape-view",Ae,!0)})(ge||(ge={}));var Me=function(Ae,X,le,Q){var ne=arguments.length,he=ne<3?X:Q===null?Q=Object.getOwnPropertyDescriptor(X,le):Q,Ue;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")he=Reflect.decorate(Ae,X,le,Q);else for(var ce=Ae.length-1;ce>=0;ce--)(Ue=Ae[ce])&&(he=(ne<3?Ue(he):ne>3?Ue(X,le,he):Ue(X,le))||he);return ne>3&&he&&Object.defineProperty(X,le,he),he};const Se="react";function ee(Ae){const X={current:()=>{}},le=_t=>{X.current(_t)};let Q,ne;function he(_t,N){Q({id:_t,portal:N})}function Ue(_t){ne(_t)}const ce=()=>{const[_t,N]=(0,U.useState)([]),[ze,Ze]=(0,U.useState)(),xt=(0,U.useRef)([]),Zt=(0,U.useRef)([]);X.current=Ze,Q=(0,U.useCallback)(nn=>{const{id:Dn}=nn;if(xt.current.includes(Dn)){const yn=Zt.current,Rt=yn.findIndex(Sr=>Sr.id===Dn);Rt>-1?yn[Rt]=nn:yn.push(nn),Zt.current=yn}else N(yn=>{const Rt=[...yn],Sr=Rt.findIndex(pr=>pr.id===Dn);return Sr>-1?Rt[Sr]=nn:Rt.push(nn),Rt})},[]),ne=(0,U.useCallback)(nn=>{xt.current.includes(nn)&&(xt.current=xt.current.filter(Dn=>Dn!==nn)),Zt.current.map(Dn=>Dn.id).includes(nn)&&(Zt.current=Zt.current.filter(Dn=>Dn.id!==nn)),N(Dn=>Dn.filter(yn=>yn.id!==nn))},[]);const Bn=(0,U.useCallback)(nn=>{const{name:Dn,data:yn}=nn,{cells:Rt=[]}=yn||{};if(Dn==="add"){const Sr=Rt.filter(pr=>pr.isNode()).map(pr=>pr.id);xt.current=Array.from(new Set([...xt.current,...Sr]))}},[]),Fr=(0,U.useCallback)(({name:nn})=>{if(nn==="add"){const Dn=Zt.current;if(Dn.length){const yn=Dn.map(Rt=>Rt.id);xt.current=xt.current.filter(Rt=>!yn.includes(Rt)),Zt.current=[],N(Rt=>{const Sr=[...Rt];return Dn.forEach(pr=>{const _n=Sr.findIndex(gr=>gr.id===pr.id);_n>-1?Sr[_n]=pr:Sr.push(pr)}),Sr})}}},[]);return(0,U.useLayoutEffect)(()=>(ze&&(ze.on("batch:start",Bn),ze.on("batch:stop",Fr)),()=>{ze&&(ze.off("batch:start",Bn),ze.off("batch:stop",Fr),N([]),xt.current=[],Zt.current=[])}),[ze,Bn,Fr]),U.createElement(U.Fragment,null,..._t.map(nn=>nn.portal))};class De extends Z.DK{init(){super.init(),this.cell.on("removed",()=>{Ue(this.cell.id)})}getComponentContainer(){return this.cell.prop("useForeignObject")===!1?this.selectors.content:this.selectors.foContent}confirmUpdate(N){const ze=super.confirmUpdate(N);return this.handleAction(ze,Se,()=>this.renderReactComponent())}renderReactComponent(){this.unmountReactComponent();const N=this.getComponentContainer(),ze=this.cell,Ze=this.graph;if(N){const xt=this.graph.hook.getReactComponent(ze),Zt=U.createElement(Ce,{graph:Ze,node:ze,component:xt});he(this.cell.id,pe.createPortal(Zt,N))}}unmountReactComponent(){const N=this.getComponentContainer();return N&&pe.unmountComponentAtNode(N),N}onMouseDown(N,ze,Ze){const xt=N.target;if(xt.tagName.toLowerCase()==="input"){const Kn=xt.getAttribute("type");if(Kn==null||["text","password","number","email","search","tel","url"].includes(Kn))return}super.onMouseDown(N,ze,Ze)}dispose(){Ue(this.cell.id),this.unmountReactComponent()}}return Me([Z.DK.dispose()],De.prototype,"dispose",null),De.config({bootstrap:[Se],actions:{component:Se}}),Z.DK.registry.register(Ae,De,!0),{Portal:ce,setGraph:le}}function oe(Ae){const X=(0,U.useRef)(!1),[le]=(0,U.useState)(()=>X.current?{}:(X.current=!0,ee(Ae)));return[le.Portal,le.setGraph]}},46754:function(je,$,P){"use strict";P.d($,{e9:function(){return De},is:function(){return U},kS:function(){return Qi},Iw:function(){return J},kJ:function(){return Ci},Lu:function(){return li},NB:function(){return Si},DK:function(){return aa},QK:function(){return Z},y$:function(){return sr},Bz:function(){return Ue},b2:function(){return Jm},bn:function(){return ce},kf:function(){return H}});var Z={};P.r(Z),P.d(Z,{applyMixins:function(){return Ef},clone:function(){return au},cloneDeep:function(){return qi},createClass:function(){return Cc},defaults:function(){return Cf},defaultsDeep:function(){return $p},ensure:function(){return oh},extend:function(){return Qc},flatten:function(){return lh},forIn:function(){return qu},getBoolean:function(){return Jg},getByPath:function(){return sh},getNumber:function(){return wc},getValue:function(){return $0},has:function(){return _l},inherit:function(){return qg},isEmpty:function(){return re},isEqual:function(){return ea},isMaliciousProp:function(){return Af},isObject:function(){return Js.Z},isPlainObject:function(){return Ge.Z},merge:function(){return Pi.Z},pick:function(){return fc},setByPath:function(){return Os},unsetByPath:function(){return ah}});var H={};P.r(H),P.d(H,{camelCase:function(){return as},constantCase:function(){return ov},dotCase:function(){return R1},endsWith:function(){return dd},escape:function(){return du},eval:function(){return Ht},getSpellingSuggestion:function(){return wb},hashcode:function(){return ig},isString:function(){return Z0},kebabCase:function(){return iv},lowerFirst:function(){return bb},pad:function(){return fm},padEnd:function(){return pm},padStart:function(){return Q0},pascalCase:function(){return Ic},pathCase:function(){return xb},repeat:function(){return Lf},sanitizeHTML:function(){return Am},sentenceCase:function(){return sv},split:function(){return hh},startsWith:function(){return Ua},template:function(){return Tt},titleCase:function(){return Cb},toString:function(){return hs.Z},truncate:function(){return ev},unescape:function(){return Of},uniqueId:function(){return zt},upperFirst:function(){return ar},uuid:function(){return og}});var J={};P.r(J),P.d(J,{apply:function(){return Tm},cacher:function(){return iw},call:function(){return Pn},debounce:function(){return dv.Z},defer:function(){return Nb},isAsync:function(){return Mm},isAsyncLike:function(){return kb},isFunction:function(){return K1.Z},noop:function(){return Mi},once:function(){return Q1},toAsyncBoolean:function(){return Pm},toDeferredBoolean:function(){return hv}});var U={};P.r(U),P.d(U,{KAPPA:function(){return gg},MouseWheelHandle:function(){return yo},addClass:function(){return vi},animate:function(){return _v},animateAlongPath:function(){return Rv},animateTransform:function(){return Nv},append:function(){return Yf},appendTo:function(){return Gb},attr:function(){return yi},bbox:function(){return js},before:function(){return Lm},breakText:function(){return ls},cancelAnimationFrame:function(){return Um},circleToPathData:function(){return Kb},clearSelection:function(){return Vm},contains:function(){return Rm},createElement:function(){return cg},createElementNS:function(){return _m},createSVGMatrix:function(){return On},createSVGPoint:function(){return or},createSVGTransform:function(){return ep},createSlicePathData:function(){return Qb},createSvgDocument:function(){return ug},createSvgElement:function(){return ma},createVector:function(){return gt},createVectors:function(){return Pd},decomposeMatrix:function(){return vl},ellipseToPathData:function(){return qb},empty:function(){return Im},ensureId:function(){return Ph},find:function(){return ow},findOne:function(){return km},findParentByClass:function(){return Lb},getAttribute:function(){return Bb},getBBox:function(){return Pr},getBBoxByElementAttr:function(){return Sw},getBoundingOffsetRect:function(){return Za},getClass:function(){return Mh},getComputedStyle:function(){return fg},getIntersection:function(){return t2},getMatrixByElementAttr:function(){return Aw},getPointsFromSvgElement:function(){return mg},getTransformToElement:function(){return Cu},getVendorPrefixedName:function(){return bv},hasClass:function(){return Sd},hasScrollbars:function(){return dw},index:function(){return Nm},isHTMLElement:function(){return Fm},isSVGGraphicsElement:function(){return Ad},isVector:function(){return kh},kebablizeAttrs:function(){return Kf},lineToPathData:function(){return Xb},matrixToRotation:function(){return Md},matrixToScale:function(){return Td},matrixToTransformString:function(){return Zr},matrixToTranslation:function(){return _h},mergeAttrs:function(){return zm},ns:function(){return Fo},parseTransformString:function(){return yg},parseXML:function(){return Rb},polygonToPathData:function(){return Dh},polylineToPathData:function(){return Av},prepend:function(){return Fb},qualifyAttr:function(){return mv},rectToPathData:function(){return Zm},rectangleToPathData:function(){return Jb},remove:function(){return Jl},removeAttribute:function(){return Gm},removeClass:function(){return Wa},requestAnimationFrame:function(){return qf},rotate:function(){return Km},sample:function(){return Tr},scale:function(){return ht},setAttribute:function(){return Bm},setAttributes:function(){return gv},setPrefixedStyle:function(){return uw},styleToObject:function(){return dg},svgVersion:function(){return lg},tagName:function(){return Ib},text:function(){return Sv},toGeometryShape:function(){return Dv},toLocalPoint:function(){return Ov},toPath:function(){return Tv},toPathData:function(){return Mv},toggleClass:function(){return ag},transform:function(){return Nh},transformLine:function(){return e2},transformPoint:function(){return Pt},transformPolyline:function(){return Ew},transformRectangle:function(){return va},transformStringToMatrix:function(){return kn},translate:function(){return Ym},translateAndAutoOrient:function(){return vo},uniqueId:function(){return Dm}});var pe={};P.r(pe),P.d(pe,{async:function(){return Jw},block:function(){return S2},circle:function(){return O2},circlePlus:function(){return Qw},classic:function(){return A2},cross:function(){return qw},diamond:function(){return M2},ellipse:function(){return tE},path:function(){return Yw}});var ke={};P.r(ke),P.d(ke,{annotations:function(){return g2},atConnectionLength:function(){return R2},atConnectionLengthIgnoreGradient:function(){return N2},atConnectionLengthKeepGradient:function(){return zv},atConnectionRatio:function(){return Ih},atConnectionRatioIgnoreGradient:function(){return k2},atConnectionRatioKeepGradient:function(){return Uv},connection:function(){return _2},displayEmpty:function(){return Ww},eol:function(){return m2},fill:function(){return $w},filter:function(){return w2},html:function(){return C2},lineHeight:function(){return f2},port:function(){return E2},ref:function(){return Dw},refCx:function(){return Lw},refCy:function(){return Fw},refD:function(){return qS},refDKeepOffset:function(){return Gw},refDResetOffset:function(){return l2},refDx:function(){return _w},refDy:function(){return Nw},refHeight:function(){return s2},refHeight2:function(){return Hw},refPoints:function(){return zw},refPointsKeepOffset:function(){return Bw},refPointsResetOffset:function(){return c2},refR:function(){return bo},refRCircumscribed:function(){return Iw},refRInscribed:function(){return a2},refRx:function(){return kw},refRy:function(){return Rw},refWidth:function(){return o2},refWidth2:function(){return jw},refX:function(){return r2},refX2:function(){return Uw},refY:function(){return i2},refY2:function(){return Vw},resetOffset:function(){return Xw},sourceMarker:function(){return JS},stroke:function(){return tt},style:function(){return x2},targetMarker:function(){return QS},text:function(){return Lv},textPath:function(){return p2},textVerticalAnchor:function(){return Qm},textWrap:function(){return h2},title:function(){return v2},vertexMarker:function(){return rE},xAlign:function(){return y2},yAlign:function(){return Zw}});var Ce={};P.r(Ce),P.d(Ce,{dot:function(){return I2},doubleMesh:function(){return G2},fixedDot:function(){return L2},mesh:function(){return F2}});var ge={};P.r(ge),P.d(ge,{blur:function(){return B2},brightness:function(){return W2},contrast:function(){return Z2},dropShadow:function(){return z2},grayScale:function(){return U2},highlight:function(){return cr},hueRotate:function(){return H2},invert:function(){return $2},outline:function(){return iE},saturate:function(){return j2},sepia:function(){return V2}});var Me={};P.r(Me),P.d(Me,{flipX:function(){return jv},flipXY:function(){return bl},flipY:function(){return Hv},watermark:function(){return X2}});var Se={};P.r(Se),P.d(Se,{className:function(){return Y2},opacity:function(){return K2},stroke:function(){return J2}});var ee={};P.r(ee),P.d(ee,{absolute:function(){return rp},bottom:function(){return ox},ellipse:function(){return Q2},ellipseSpread:function(){return ex},left:function(){return rx},line:function(){return nx},right:function(){return ip},top:function(){return ix}});var oe={};P.r(oe),P.d(oe,{bottom:function(){return qv},inside:function(){return ux},insideOriented:function(){return dx},left:function(){return oE},manual:function(){return Yv},outside:function(){return lx},outsideOriented:function(){return cx},radial:function(){return hx},radialOriented:function(){return fx},right:function(){return ax},top:function(){return Kv}});var Ae={};P.r(Ae),P.d(Ae,{noop:function(){return lE},pinAbsolute:function(){return Cx},pinRelative:function(){return xx}});var X={};P.r(X),P.d(X,{bottom:function(){return sA},bottomLeft:function(){return dE},bottomRight:function(){return hE},center:function(){return ly},left:function(){return cy},midSide:function(){return dA},nodeCenter:function(){return uA},orth:function(){return cA},right:function(){return Ag},top:function(){return oA},topLeft:function(){return aA},topRight:function(){return lA}});var le={};P.r(le),P.d(le,{closest:function(){return gE},length:function(){return fA},orth:function(){return Ex},ratio:function(){return hA}});var Q={};P.r(Q),P.d(Q,{anchor:function(){return vE},bbox:function(){return s0},boundary:function(){return Tx},rect:function(){return Ax}});var ne={};P.r(ne),P.d(ne,{er:function(){return CA},loop:function(){return wA},manhattan:function(){return TE},metro:function(){return xA},normal:function(){return yE},oneSide:function(){return Mx},orth:function(){return _x}});var he={};P.r(he),P.d(he,{jumpover:function(){return Hh},loop:function(){return SA},normal:function(){return EA},rounded:function(){return Fx},smooth:function(){return AA}});var Ue={};P.r(Ue),P.d(Ue,{Attr:function(){return yl},Background:function(){return Lh},ConnectionPoint:function(){return zh},ConnectionStrategy:function(){return kd},Connector:function(){return Du},EdgeAnchor:function(){return Bh},EdgeTool:function(){return Gh},Filter:function(){return Od},Grid:function(){return Gc},Highlighter:function(){return Xa},Marker:function(){return ia},NodeAnchor:function(){return ap},NodeTool:function(){return sp},PortLabelLayout:function(){return Fh},PortLayout:function(){return Au},Registry:function(){return Oo},Router:function(){return Id},create:function(){return Bx}});var ce={};P.r(ce),P.d(ce,{kS:function(){return m0}});var De={};P.r(De),P.d(De,{q6:function(){return Ru}});var _t=P(19755),N=P.n(_t),ze=P(50450);const Ze=navigator.userAgent;var xt;if(function(c){c.IS_MAC=navigator.appVersion.indexOf("Mac")>0,c.IS_IOS=!!Ze.match(/(iPad|iPhone|iPod)/g),c.IS_WINDOWS=navigator.appVersion.indexOf("Win")>0,c.IS_IE=Ze.indexOf("MSIE")>=0,c.IS_IE11=!!Ze.match(/Trident\/7\./),c.IS_EDGE=!!Ze.match(/Edge\//),c.IS_NETSCAPE=Ze.indexOf("Mozilla/")>=0&&Ze.indexOf("MSIE")<0&&Ze.indexOf("Edge/")<0,c.IS_CHROME_APP=window.chrome!=null&&window.chrome.app!=null&&window.chrome.app.runtime!=null,c.IS_CHROME=Ze.indexOf("Chrome/")>=0&&Ze.indexOf("Edge/")<0,c.IS_OPERA=Ze.indexOf("Opera/")>=0||Ze.indexOf("OPR/")>=0,c.IS_FIREFOX=Ze.indexOf("Firefox/")>=0,c.IS_SAFARI=Ze.indexOf("AppleWebKit/")>=0&&Ze.indexOf("Chrome/")<0&&Ze.indexOf("Edge/")<0,c.SUPPORT_TOUCH="ontouchstart"in document.documentElement,c.SUPPORT_POINTER=window.PointerEvent!=null&&!c.IS_MAC,c.SUPPORT_PASSIVE=!1;try{const e=Object.defineProperty({},"passive",{get(){c.SUPPORT_PASSIVE=!0}}),t=document.createElement("div");t.addEventListener&&t.addEventListener("click",()=>{},e)}catch{}c.NO_FOREIGNOBJECT=!document.createElementNS||`${document.createElementNS("http://www.w3.org/2000/svg","foreignObject")}`!="[object SVGForeignObjectElement]"||Ze.indexOf("Opera/")>=0,c.SUPPORT_FOREIGNOBJECT=!c.NO_FOREIGNOBJECT}(xt||(xt={})),function(c){function e(){const d=window.module;return d!=null&&d.hot!=null&&d.hot.status!=null?d.hot.status():"unkonwn"}c.getHMRStatus=e;function t(){return e()==="apply"}c.isApplyingHMR=t;const i={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function a(d){const f=document.createElement(i[d]||"div"),m=`on${d}`;let y=m in f;return y||(f.setAttribute(m,"return;"),y=typeof f[m]=="function"),y}c.isEventSupported=a}(xt||(xt={})),xt.SUPPORT_PASSIVE){N().event.special.touchstart={setup(e,t,i){if(!this.addEventListener)return!1;this.addEventListener("touchstart",i,{passive:!0})}};const c=N().event.special.mousewheel;if(c){const e=c.setup;c.setup=function(){const t=this.addEventListener;if(!t)return!1;this.addEventListener=(i,a)=>{t.call(this,i,a,{passive:!0})},e.call(this),this.addEventListener=t}}}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),function(c){c.forEach(e=>{Object.prototype.hasOwnProperty.call(e,"append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value(...t){const i=document.createDocumentFragment();t.forEach(a=>{const d=a instanceof Node;i.appendChild(d?a:document.createTextNode(String(a)))}),this.appendChild(i)}})})}([Element.prototype,Document.prototype,DocumentFragment.prototype]);var Zt=P(27771),Kn=P(50585),we=P(45084);function Bn(c,e,t,i){for(var a=c.length,d=t+(i?1:-1);i?d--:++d<a;)if(e(c[d],d,c))return d;return-1}var Fr=Bn;function nn(c){return c!==c}var Dn=nn;function yn(c,e,t){for(var i=t-1,a=c.length;++i<a;)if(c[i]===e)return i;return-1}var Rt=yn;function Sr(c,e,t){return e===e?Rt(c,e,t):Fr(c,Dn,t)}var pr=Sr;function _n(c,e){var t=c==null?0:c.length;return!!t&&pr(c,e,0)>-1}var gr=_n;function Nn(c,e,t){for(var i=-1,a=c==null?0:c.length;++i<a;)if(t(e,c[i]))return!0;return!1}var yr=Nn,Or=P(59548),Co=P(93203);function _r(){}var Mi=_r,Xi=P(6545),ms=1/0,Xs=Co.Z&&1/(0,Xi.Z)(new Co.Z([,-0]))[1]==ms?function(c){return new Co.Z(c)}:Mi,Yi=Xs,Bi=200;function Qr(c,e,t){var i=-1,a=gr,d=c.length,f=!0,m=[],y=m;if(t)f=!1,a=yr;else if(d>=Bi){var x=e?null:Yi(c);if(x)return(0,Xi.Z)(x);f=!1,a=Or.Z,y=new we.Z}else y=e?[]:m;e:for(;++i<d;){var E=c[i],S=e?e(E):E;if(E=t||E!==0?E:0,f&&S===S){for(var T=y.length;T--;)if(y[T]===S)continue e;e&&y.push(S),m.push(E)}else a(y,S,t)||(y!==m&&y.push(S),m.push(E))}return m}var fo=Qr;function Qn(c){return c&&c.length?fo(c):[]}var Hr=Qn,Ra=P(58694),fe=P(17685),Yc=P(84732),Bu=fe.Z?fe.Z.isConcatSpreadable:void 0;function vt(c){return(0,Zt.Z)(c)||(0,Yc.Z)(c)||!!(Bu&&c&&c[Bu])}var Tl=vt;function ct(c,e,t,i,a){var d=-1,f=c.length;for(t||(t=Tl),a||(a=[]);++d<f;){var m=c[d];e>0&&t(m)?e>1?ct(m,e-1,t,i,a):(0,Ra.Z)(a,m):i||(a[a.length]=m)}return a}var Ee=ct,Ho=P(69581),ya=P(836),Ys=(0,Ho.Z)(function(c){return fo(Ee(c,1,ya.Z,!0))}),qo=Ys,la=P(72714),Ss=4294967295,Jo=Ss-1,Ks=Math.floor,ac=Math.min;function lc(c,e,t,i){var a=0,d=c==null?0:c.length;if(d===0)return 0;e=t(e);for(var f=e!==e,m=e===null,y=(0,la.Z)(e),x=e===void 0;a<d;){var E=Ks((a+d)/2),S=t(c[E]),T=S!==void 0,R=S===null,V=S===S,j=(0,la.Z)(S);if(f)var q=i||V;else x?q=V&&(i||T):m?q=V&&T&&(i||!R):y?q=V&&T&&!R&&(i||!j):R||j?q=!1:q=i?S<=e:S<e;q?a=E+1:d=E}return ac(d,Jo)}var Qo=lc,es=P(69203),zu=4294967295,qs=zu>>>1;function ef(c,e,t){var i=0,a=c==null?i:c.length;if(typeof e=="number"&&e===e&&a<=qs){for(;i<a;){var d=i+a>>>1,f=c[d];f!==null&&!(0,la.Z)(f)&&(t?f<=e:f<e)?i=d+1:a=d}return a}return Qo(c,e,es.Z,t)}var Fp=ef;function F(c,e){return Fp(c,e)}var No=F,Ii=P(85469);function Zg(c,e,t){return Qo(c,e,(0,Ii.Z)(t,2))}var Yr=Zg,ca=P(74073),Uu=P(13317),tf=P(21018);function nf(c,e){var t=c.length;for(c.sort(e);t--;)c[t]=c[t].value;return c}var rf=nf,ba=P(21162);function Rn(c,e){if(c!==e){var t=c!==void 0,i=c===null,a=c===c,d=(0,la.Z)(c),f=e!==void 0,m=e===null,y=e===e,x=(0,la.Z)(e);if(!m&&!x&&!d&&c>e||d&&f&&y&&!m&&!x||i&&f&&y||!t&&y||!a)return 1;if(!i&&!d&&!x&&c<e||x&&t&&a&&!i&&!d||m&&t&&a||!f&&a||!y)return-1}return 0}var qn=Rn;function As(c,e,t){for(var i=-1,a=c.criteria,d=e.criteria,f=a.length,m=t.length;++i<f;){var y=qn(a[i],d[i]);if(y){if(i>=m)return y;var x=t[i];return y*(x=="desc"?-1:1)}}return c.index-e.index}var Ml=As;function of(c,e,t){e.length?e=(0,ca.Z)(e,function(d){return(0,Zt.Z)(d)?function(f){return(0,Uu.Z)(f,d.length===1?d[0]:d)}:d}):e=[es.Z];var i=-1;e=(0,ca.Z)(e,(0,ba.Z)(Ii.Z));var a=(0,tf.Z)(c,function(d,f,m){var y=(0,ca.Z)(e,function(x){return x(d)});return{criteria:y,index:++i,value:d}});return rf(a,function(d,f){return Ml(d,f,t)})}var Vu=of,Ia=P(50439),Pl=(0,Ho.Z)(function(c,e){if(c==null)return[];var t=e.length;return t>1&&(0,Ia.Z)(c,e[0],e[1])?e=[]:t>2&&(0,Ia.Z)(e[0],e[1],e[2])&&(e=[e[0]]),Vu(c,Ee(e,1),[])}),ju=Pl,sf=P(74752);function cc(c,e,t,i){for(var a=-1,d=c==null?0:c.length;++a<d;){var f=c[a];e(i,f,t(f),c)}return i}var Xg=cc,Hu=P(58570);function Hd(c,e,t,i){return(0,Hu.Z)(c,function(a,d,f){e(i,a,t(a),f)}),i}var Ol=Hd;function $d(c,e){return function(t,i){var a=(0,Zt.Z)(t)?Xg:Ol,d=e?e():{};return a(t,c,(0,Ii.Z)(i,2),d)}}var Wd=$d,Kc=Object.prototype,po=Kc.hasOwnProperty,Gp=Wd(function(c,e,t){po.call(c,t)?c[t].push(e):(0,sf.Z)(c,t,[e])}),Zd=Gp,Xd=200;function af(c,e,t,i){var a=-1,d=gr,f=!0,m=c.length,y=[],x=e.length;if(!m)return y;t&&(e=(0,ca.Z)(e,(0,ba.Z)(t))),i?(d=yr,f=!1):e.length>=Xd&&(d=Or.Z,f=!1,e=new we.Z(e));e:for(;++a<m;){var E=c[a],S=t==null?E:t(E);if(E=i||E!==0?E:0,f&&S===S){for(var T=x;T--;)if(e[T]===S)continue e;y.push(E)}else d(e,S,i)||y.push(E)}return y}var di=af,zi=(0,Ho.Z)(function(c,e){return(0,ya.Z)(c)?di(c,Ee(e,1,ya.Z,!0)):[]}),rr=zi;function Ja(c,e,t){for(var i=-1,a=c.length;++i<a;){var d=c[i],f=e(d);if(f!=null&&(m===void 0?f===f&&!(0,la.Z)(f):t(f,m)))var m=f,y=d}return y}var to=Ja;function lf(c,e){return c>e}var $u=lf;function Wu(c){return c&&c.length?to(c,es.Z,$u):void 0}var cf=Wu;function Yd(c,e,t){const i=Dl(c,t),a=Dl(e,t),d=a.free,f=i.keyIndex,m=a.keyIndex,y=[],x=[];let E=0,S,T,R=0;for(;E<c.length;){if(S=c[E],T=S[t],T)if(!m.hasOwnProperty(T))x.push(null);else{const Pe=m[T];x.push(e[Pe])}else{R+=1;const Pe=d[R];x.push(Pe||null)}E+=1}const V=x.slice(0);for(E=0;E<V.length;)V[E]===null?(ue(E),se(E)):E+=1;let j=E=0;for(;E<e.length;){S=e[E],T=S[t];const Pe=V[j];if(Pe){const He=Pe[t];if(T===He)j+=1;else if(!f.hasOwnProperty(T))be(E,S);else{const ft=V[j+1];ft&&(ft[t]===T?(ue(E),se(j),j+=1):be(E,S))}}else be(E,S);E+=1}let q=V.length-j;for(;(j+=1)<V.length;)q-=1,ue(q+E);function ue(Pe){const He={index:Pe,type:0,item:null};y.push(He)}function be(Pe,He){const ft={index:Pe,item:He,type:1};y.push(ft)}function se(Pe){V.splice(Pe,1)}return{moves:y}}function Dl(c,e){const t={},i=[];for(let a=0,d=c.length;a<d;a+=1){const f=c[a],m=f[e];m?t[m]=a:i.push(f)}return{keyIndex:t,free:i}}var Kd=Object.prototype,uf=Kd.hasOwnProperty;function ko(c,e){return c!=null&&uf.call(c,e)}var df=ko,uc=P(16174);function dc(c,e){return c!=null&&(0,uc.Z)(c,e,df)}var _l=dc,no=P(72954),wo=P(73817),Nl=P(56009),Js=P(77226),qd=P(62281);function qc(c,e,t,i){if(!(0,Js.Z)(c))return c;e=(0,wo.Z)(e,c);for(var a=-1,d=e.length,f=d-1,m=c;m!=null&&++a<d;){var y=(0,qd.Z)(e[a]),x=t;if(y==="__proto__"||y==="constructor"||y==="prototype")return c;if(a!=f){var E=m[y];x=i?i(E,y,m):void 0,x===void 0&&(x=(0,Js.Z)(E)?E:(0,Nl.Z)(e[a+1])?[]:{})}(0,no.Z)(m,y,x),m=m[y]}return c}var hc=qc;function Jc(c,e,t){for(var i=-1,a=e.length,d={};++i<a;){var f=e[i],m=(0,Uu.Z)(c,f);t(m,f)&&hc(d,(0,wo.Z)(f,c),m)}return d}var Qa=Jc,Zu=P(81910);function hf(c,e){return Qa(c,e,function(t,i){return(0,Zu.Z)(c,i)})}var Bp=hf;function ff(c){var e=c==null?0:c.length;return e?Ee(c,1):[]}var Jd=ff,pf=P(45644),zp=P(50022);function Qd(c){return(0,zp.Z)((0,pf.Z)(c,void 0,Jd),c+"")}var ua=Qd,Qs=ua(function(c,e){return c==null?{}:Bp(c,e)}),fc=Qs,Xu=P(35381),Yu=P(68882),Ki=P(57590);function Ku(c,e){return c==null?c:(0,Xu.Z)(c,(0,Yu.Z)(e),Ki.Z)}var qu=Ku,Pi=P(48568),da=P(31899),kl=P(49268),Rl=(0,kl.Z)(function(c,e){(0,da.Z)(e,(0,Ki.Z)(e),c)}),Qc=Rl,Ju=P(7980);function Il(c,e){return(0,Ju.Z)(c,e)}var ea=Il,el=P(8448),Qu=P(96155),gf=P(16706),mf=P(72764),C=P(77212),M="[object Map]",k="[object Set]",L=Object.prototype,W=L.hasOwnProperty;function Y(c){if(c==null)return!0;if((0,Kn.Z)(c)&&((0,Zt.Z)(c)||typeof c=="string"||typeof c.splice=="function"||(0,gf.Z)(c)||(0,C.Z)(c)||(0,Yc.Z)(c)))return!c.length;var e=(0,Qu.Z)(c);if(e==M||e==k)return!c.size;if((0,mf.Z)(c))return!(0,el.Z)(c).length;for(var t in c)if(W.call(c,t))return!1;return!0}var re=Y,Ge=P(37514),Fe=P(45365),it=P(76579),At=P(17179);function Qt(c,e){return c&&(0,da.Z)(e,(0,At.Z)(e),c)}var Ct=Qt;function It(c,e){return c&&(0,da.Z)(e,(0,Ki.Z)(e),c)}var ir=It,Ir=P(91050),er=P(87215),Eo=P(3573);function So(c,e){return(0,da.Z)(c,(0,Eo.Z)(c),e)}var Fs=So,br=P(12513),Nr=P(60532),Ts=Object.getOwnPropertySymbols,Gr=Ts?function(c){for(var e=[];c;)(0,Ra.Z)(e,(0,Eo.Z)(c)),c=(0,br.Z)(c);return e}:Nr.Z,Vi=Gr;function tl(c,e){return(0,da.Z)(c,Vi(c),e)}var La=tl,vs=P(1808),xa=P(63327);function ha(c){return(0,xa.Z)(c,Ki.Z,Vi)}var ts=ha,Li=Object.prototype,ro=Li.hasOwnProperty;function $o(c){var e=c.length,t=new c.constructor(e);return e&&typeof c[0]=="string"&&ro.call(c,"index")&&(t.index=c.index,t.input=c.input),t}var Up=$o,us=P(41884);function Ca(c,e){var t=e?(0,us.Z)(c.buffer):c.buffer;return new c.constructor(t,c.byteOffset,c.byteLength)}var ei=Ca,ta=/\w*$/;function pc(c){var e=new c.constructor(c.source,ta.exec(c));return e.lastIndex=c.lastIndex,e}var gc=pc,Ll=fe.Z?fe.Z.prototype:void 0,Gs=Ll?Ll.valueOf:void 0;function go(c){return Gs?Object(Gs.call(c)):{}}var mc=go,eu=P(12701),eh="[object Boolean]",ed="[object Date]",Ms="[object Map]",td="[object Number]",vc="[object RegExp]",nd="[object Set]",Fa="[object String]",rd="[object Symbol]",tu="[object ArrayBuffer]",Ps="[object DataView]",Bs="[object Float32Array]",Fl="[object Float64Array]",Gl="[object Int8Array]",nu="[object Int16Array]",th="[object Int32Array]",Oi="[object Uint8Array]",Ro="[object Uint8ClampedArray]",zs="[object Uint16Array]",ys="[object Uint32Array]";function nh(c,e,t){var i=c.constructor;switch(e){case tu:return(0,us.Z)(c);case eh:case ed:return new i(+c);case Ps:return ei(c,t);case Bs:case Fl:case Gl:case nu:case th:case Oi:case Ro:case zs:case ys:return(0,eu.Z)(c,t);case Ms:return new i;case td:case Fa:return new i(c);case vc:return gc(c);case nd:return new i;case rd:return mc(c)}}var ru=nh,Vp=P(15418),nl=P(54060),id="[object Map]";function Bl(c){return(0,nl.Z)(c)&&(0,Qu.Z)(c)==id}var od=Bl,yc=P(98351),Ga=yc.Z&&yc.Z.isMap,rl=Ga?(0,ba.Z)(Ga):od,iu=rl,jp="[object Set]";function sd(c){return(0,nl.Z)(c)&&(0,Qu.Z)(c)==jp}var ad=sd,bc=yc.Z&&yc.Z.isSet,ou=bc?(0,ba.Z)(bc):ad,te=ou,Re=1,Ke=2,Lt=4,qe="[object Arguments]",Gt="[object Array]",rn="[object Boolean]",xn="[object Date]",Sn="[object Error]",dr="[object Function]",jn="[object GeneratorFunction]",mr="[object Map]",ti="[object Number]",gi="[object Object]",Un="[object RegExp]",Io="[object Set]",ns="[object String]",Lo="[object Symbol]",Hi="[object WeakMap]",ds="[object ArrayBuffer]",fa="[object DataView]",Ao="[object Float32Array]",su="[object Float64Array]",jr="[object Int8Array]",Br="[object Int16Array]",vf="[object Int32Array]",yf="[object Uint8Array]",bf="[object Uint8ClampedArray]",xf="[object Uint16Array]",V0="[object Uint32Array]",mi={};mi[qe]=mi[Gt]=mi[ds]=mi[fa]=mi[rn]=mi[xn]=mi[Ao]=mi[su]=mi[jr]=mi[Br]=mi[vf]=mi[mr]=mi[ti]=mi[gi]=mi[Un]=mi[Io]=mi[ns]=mi[Lo]=mi[yf]=mi[bf]=mi[xf]=mi[V0]=!0,mi[Sn]=mi[dr]=mi[Hi]=!1;function il(c,e,t,i,a,d){var f,m=e&Re,y=e&Ke,x=e&Lt;if(t&&(f=a?t(c,i,a,d):t(c)),f!==void 0)return f;if(!(0,Js.Z)(c))return c;var E=(0,Zt.Z)(c);if(E){if(f=Up(c),!m)return(0,er.Z)(c,f)}else{var S=(0,Qu.Z)(c),T=S==dr||S==jn;if((0,gf.Z)(c))return(0,Ir.Z)(c,m);if(S==gi||S==qe||T&&!a){if(f=y||T?{}:(0,Vp.Z)(c),!m)return y?La(c,ir(f,c)):Fs(c,Ct(f,c))}else{if(!mi[S])return a?c:{};f=ru(c,S,m)}}d||(d=new Fe.Z);var R=d.get(c);if(R)return R;d.set(c,f),te(c)?c.forEach(function(q){f.add(il(q,e,t,q,c,d))}):iu(c)&&c.forEach(function(q,ue){f.set(ue,il(q,e,t,ue,c,d))});var V=x?y?ts:vs.Z:y?Ki.Z:At.Z,j=E?void 0:V(c);return(0,it.Z)(j||c,function(q,ue){j&&(ue=q,q=c[ue]),(0,no.Z)(f,ue,il(q,e,t,ue,c,d))}),f}var ol=il,Vt=4;function ld(c){return ol(c,Vt)}var au=ld,Yg=1,lu=4;function rh(c){return ol(c,Yg|lu)}var qi=rh,pa=P(79651),ih=Object.prototype,ga=ih.hasOwnProperty,Ba=(0,Ho.Z)(function(c,e){c=Object(c);var t=-1,i=e.length,a=i>2?e[2]:void 0;for(a&&(0,Ia.Z)(e[0],e[1],a)&&(i=1);++t<i;)for(var d=e[t],f=(0,Ki.Z)(d),m=-1,y=f.length;++m<y;){var x=f[m],E=c[x];(E===void 0||(0,pa.Z)(E,ih[x])&&!ga.call(c,x))&&(c[x]=d[x])}return c}),Cf=Ba,wf=P(18069),na=P(48240);function cu(c,e,t,i,a,d){return(0,Js.Z)(c)&&(0,Js.Z)(e)&&(d.set(e,c),(0,na.Z)(c,e,void 0,cu,d),d.delete(e)),c}var xc=cu,uu=(0,kl.Z)(function(c,e,t,i){(0,na.Z)(c,e,t,i)}),j0=uu,Hp=(0,Ho.Z)(function(c){return c.push(void 0,xc),(0,wf.Z)(j0,void 0,c)}),$p=Hp;function Ef(c,...e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(i=>{i!=="constructor"&&Object.defineProperty(c.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i))})})}const Kg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,e){c.__proto__=e}||function(c,e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(c[t]=e[t])};function qg(c,e){Kg(c,e);function t(){this.constructor=c}c.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}class H0{}const Sf=/^\s*class\s+/.test(`${H0}`)||/^\s*class\s*\{/.test(`${class{}}`);function Cc(c,e){let t;return Sf?t=class extends e{}:(t=function(){return e.apply(this,arguments)},qg(t,e)),Object.defineProperty(t,"name",{value:c}),t}function oh(c,e){return c??e}function $0(c,e,t){const i=c!=null?c[e]:null;return t!==void 0?oh(i,t):i}function wc(c,e,t){let i=c!=null?c[e]:null;return i==null||(i=+i,Number.isNaN(i)||!Number.isFinite(i))?t:i}function Jg(c,e,t){const i=c!=null?c[e]:null;return i==null?t:!!i}function Af(c){return c==="__proto__"}function sh(c,e,t="/"){let i;const a=Array.isArray(e)?e:e.split(t);if(a.length)for(i=c;a.length;){const d=a.shift();if(Object(i)===i&&d&&d in i)i=i[d];else return}return i}function Os(c,e,t,i="/"){const a=Array.isArray(e)?e:e.split(i),d=a.pop();if(d&&!Af(d)){let f=c;a.forEach(m=>{Af(m)||(f[m]==null&&(f[m]={}),f=f[m])}),f[d]=t}return c}function ah(c,e,t="/"){const i=Array.isArray(e)?e.slice():e.split(t),a=i.pop();if(a)if(i.length>0){const d=sh(c,i);d&&delete d[a]}else delete c[a];return c}function lh(c,e="/",t){const i={};Object.keys(c).forEach(a=>{const d=c[a];let f=typeof d=="object"||Array.isArray(d);if(f&&t&&t(d)&&(f=!1),f){const m=lh(d,e,t);Object.keys(m).forEach(y=>{i[a+e+y]=m[y]})}else i[a]=d});for(const a in c)Object.prototype.hasOwnProperty.call(c,a);return i}var cd=P(13243),W0="[object String]";function Qg(c){return typeof c=="string"||!(0,Zt.Z)(c)&&(0,nl.Z)(c)&&(0,cd.Z)(c)==W0}var Z0=Qg,hs=P(77338);function Ec(c){return function(e){return c==null?void 0:c[e]}}var Tf=Ec,em={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Sc=Tf(em),X0=Sc,Mf=/[&<>"']/g,Ac=RegExp(Mf.source);function tm(c){return c=(0,hs.Z)(c),c&&Ac.test(c)?c.replace(Mf,X0):c}var du=tm,nm={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},$i=Tf(nm),io=$i,hu=/&(?:amp|lt|gt|quot|#39);/g,fu=RegExp(hu.source);function Pf(c){return c=(0,hs.Z)(c),c&&fu.test(c)?c.replace(hu,io):c}var Of=Pf;function Df(c,e,t){return c===c&&(t!==void 0&&(c=c<=t?c:t),e!==void 0&&(c=c>=e?c:e)),c}var zl=Df,bs=P(42845),Ul=P(3782),za=1/0,Wp=17976931348623157e292;function Vl(c){if(!c)return c===0?c:0;if(c=(0,Ul.Z)(c),c===za||c===-za){var e=c<0?-1:1;return e*Wp}return c===c?c:0}var sl=Vl;function Zp(c){var e=sl(c),t=e%1;return e===e?t?e-t:e:0}var rs=Zp;function Tc(c,e,t){return c=(0,hs.Z)(c),t=t==null?0:zl(rs(t),0,c.length),e=(0,bs.Z)(e),c.slice(t,t+e.length)==e}var Ua=Tc;function ud(c,e,t){c=(0,hs.Z)(c),e=(0,bs.Z)(e);var i=c.length;t=t===void 0?i:zl(rs(t),0,i);var a=t;return t-=e.length,t>=0&&c.slice(t,a)==e}var dd=ud;function hd(c,e,t){var i=-1,a=c.length;e<0&&(e=-e>a?0:a+e),t=t>a?a:t,t<0&&(t+=a),a=e>t?0:t-e>>>0,e>>>=0;for(var d=Array(a);++i<a;)d[i]=c[i+e];return d}var fd=hd;function pd(c,e,t){var i=c.length;return t=t===void 0?i:t,!e&&t>=i?c:fd(c,e,t)}var al=pd,_f="\\ud800-\\udfff",ch="\\u0300-\\u036f",rm="\\ufe20-\\ufe2f",im="\\u20d0-\\u20ff",om=ch+rm+im,Nf="\\ufe0e\\ufe0f",Xp="\\u200d",sm=RegExp("["+Xp+_f+om+Nf+"]");function am(c){return sm.test(c)}var Mc=am,lm="[object RegExp]";function ll(c){return(0,nl.Z)(c)&&(0,cd.Z)(c)==lm}var cm=ll,Yp=yc.Z&&yc.Z.isRegExp,um=Yp?(0,ba.Z)(Yp):cm,kf=um;function dm(c){return c.split("")}var gd=dm,md="\\ud800-\\udfff",cl="\\u0300-\\u036f",Kp="\\ufe20-\\ufe2f",uh="\\u20d0-\\u20ff",dh=cl+Kp+uh,Va="\\ufe0e\\ufe0f",qp="["+md+"]",pu="["+dh+"]",jl="\\ud83c[\\udffb-\\udfff]",Jp="(?:"+pu+"|"+jl+")",ul="[^"+md+"]",Hl="(?:\\ud83c[\\udde6-\\uddff]){2}",ja="[\\ud800-\\udbff][\\udc00-\\udfff]",Pc="\\u200d",$l=Jp+"?",Ha="["+Va+"]?",$a="(?:"+Pc+"(?:"+[ul,Hl,ja].join("|")+")"+Ha+$l+")*",dl=Ha+$l+$a,gu="(?:"+[ul+pu+"?",pu,Hl,ja,qp].join("|")+")",Rf=RegExp(jl+"(?="+jl+")|"+gu+dl,"g");function Oc(c){return c.match(Rf)||[]}var Wl=Oc;function mu(c){return Mc(c)?Wl(c):gd(c)}var wa=mu,hl=4294967295;function If(c,e,t){return t&&typeof t!="number"&&(0,Ia.Z)(c,e,t)&&(e=t=void 0),t=t===void 0?hl:t>>>0,t?(c=(0,hs.Z)(c),c&&(typeof e=="string"||e!=null&&!kf(e))&&(e=(0,bs.Z)(e),!e&&Mc(c))?al(wa(c),0,t):c.split(e,t)):[]}var hh=If,fh=9007199254740991,vd=Math.floor;function ph(c,e){var t="";if(!c||e<1||e>fh)return t;do e%2&&(t+=c),e=vd(e/2),e&&(c+=c);while(e);return t}var vu=ph;function Zl(c,e,t){return(t?(0,Ia.Z)(c,e,t):e===void 0)?e=1:e=rs(e),vu((0,hs.Z)(c),e)}var Lf=Zl,Y0=P(54193),K0=(0,Y0.Z)("length"),gh=K0,yd="\\ud800-\\udfff",Ff="\\u0300-\\u036f",mh="\\ufe20-\\ufe2f",Gf="\\u20d0-\\u20ff",vh=Ff+mh+Gf,yh="\\ufe0e\\ufe0f",q0="["+yd+"]",Qp="["+vh+"]",hm="\\ud83c[\\udffb-\\udfff]",xs="(?:"+Qp+"|"+hm+")",En="[^"+yd+"]",Dc="(?:\\ud83c[\\udde6-\\uddff]){2}",Bf="[\\ud800-\\udbff][\\udc00-\\udfff]",Ea="\\u200d",_c=xs+"?",Kr="["+yh+"]?",Nc="(?:"+Ea+"(?:"+[En,Dc,Bf].join("|")+")"+Kr+_c+")*",bh=Kr+_c+Nc,zf="(?:"+[En+Qp+"?",Qp,Dc,Bf,q0].join("|")+")",xh=RegExp(hm+"(?="+hm+")|"+zf+bh,"g");function Ch(c){for(var e=xh.lastIndex=0;xh.test(c);)++e;return e}var yu=Ch;function Sa(c){return Mc(c)?yu(c):gh(c)}var Ds=Sa,Uf=Math.ceil;function Vf(c,e){e=e===void 0?" ":(0,bs.Z)(e);var t=e.length;if(t<2)return t?vu(e,c):e;var i=vu(e,Uf(c/Ds(e)));return Mc(e)?al(wa(i),0,c).join(""):i.slice(0,c)}var bu=Vf,_s=Math.ceil,wh=Math.floor;function Xl(c,e,t){c=(0,hs.Z)(c),e=rs(e);var i=e?Ds(c):0;if(!e||i>=e)return c;var a=(e-i)/2;return bu(wh(a),t)+c+bu(_s(a),t)}var fm=Xl;function eg(c,e,t){c=(0,hs.Z)(c),e=rs(e);var i=e?Ds(c):0;return e&&i<e?c+bu(e-i,t):c}var pm=eg;function J0(c,e,t){c=(0,hs.Z)(c),e=rs(e);var i=e?Ds(c):0;return e&&i<e?bu(e-i,t)+c:c}var Q0=J0,kc=30,gm="...",Ns=/\w*$/;function mm(c,e){var t=kc,i=gm;if((0,Js.Z)(e)){var a="separator"in e?e.separator:a;t="length"in e?rs(e.length):t,i="omission"in e?(0,bs.Z)(e.omission):i}c=(0,hs.Z)(c);var d=c.length;if(Mc(c)){var f=wa(c);d=f.length}if(t>=d)return c;var m=t-Ds(i);if(m<1)return i;var y=f?al(f,0,m).join(""):c.slice(0,m);if(a===void 0)return y+i;if(f&&(m+=y.length-m),kf(a)){if(c.slice(m).search(a)){var x,E=y;for(a.global||(a=RegExp(a.source,(0,hs.Z)(Ns.exec(a))+"g")),a.lastIndex=0;x=a.exec(E);)var S=x.index;y=y.slice(0,S===void 0?m:S)}}else if(c.indexOf((0,bs.Z)(a),m)!=m){var T=y.lastIndexOf(a);T>-1&&(y=y.slice(0,T))}return y+i}var ev=mm,vm=(0,kl.Z)(function(c,e,t,i){(0,da.Z)(e,(0,Ki.Z)(e),c,i)}),ym=vm,fl="[object DOMException]",bm="[object Error]";function bd(c){if(!(0,nl.Z)(c))return!1;var e=(0,cd.Z)(c);return e==bm||e==fl||typeof c.message=="string"&&typeof c.name=="string"&&!(0,Ge.Z)(c)}var Yl=bd,xm=(0,Ho.Z)(function(c,e){try{return(0,wf.Z)(c,void 0,e)}catch(t){return Yl(t)?t:new Error(t)}}),tg=xm;function jf(c,e){return(0,ca.Z)(e,function(t){return c[t]})}var Hf=jf,fs=Object.prototype,Kl=fs.hasOwnProperty;function hi(c,e,t,i){return c===void 0||(0,pa.Z)(c,fs[t])&&!Kl.call(i,t)?e:c}var Fi=hi,ql={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function tv(c){return"\\"+ql[c]}var Cm=tv,$f=/<%=([\s\S]+?)%>/g,wm=$f,Em=/<%-([\s\S]+?)%>/g,Sm=Em,nv=/<%([\s\S]+?)%>/g,xd=nv,Eh={escape:Sm,evaluate:xd,interpolate:wm,variable:"",imports:{_:{escape:du}}},Cd=Eh,ng="Invalid `variable` option passed into `_.template`",Sh=/\b__p \+= '';/g,wd=/\b(__p \+=) '' \+/g,Wf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xu=/[()=,{}\[\]\/\s]/,Ah=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Rc=/($^)/,z=/['\n\r\u2028\u2029\\]/g,de=Object.prototype,_e=de.hasOwnProperty;function at(c,e,t){var i=Cd.imports._.templateSettings||Cd;t&&(0,Ia.Z)(c,e,t)&&(e=void 0),c=(0,hs.Z)(c),e=ym({},e,i,Fi);var a=ym({},e.imports,i.imports,Fi),d=(0,At.Z)(a),f=Hf(a,d),m,y,x=0,E=e.interpolate||Rc,S="__p += '",T=RegExp((e.escape||Rc).source+"|"+E.source+"|"+(E===wm?Ah:Rc).source+"|"+(e.evaluate||Rc).source+"|$","g"),R=_e.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+`
`:"";c.replace(T,function(q,ue,be,se,Pe,He){return be||(be=se),S+=c.slice(x,He).replace(z,Cm),ue&&(m=!0,S+=`' +
__e(`+ue+`) +
'`),Pe&&(y=!0,S+=`';
`+Pe+`;
__p += '`),be&&(S+=`' +
((__t = (`+be+`)) == null ? '' : __t) +
'`),x=He+q.length,q}),S+=`';
`;var V=_e.call(e,"variable")&&e.variable;if(!V)S=`with (obj) {
`+S+`
}
`;else if(xu.test(V))throw new Error(ng);S=(y?S.replace(Sh,""):S).replace(wd,"$1").replace(Wf,"$1;"),S="function("+(V||"obj")+`) {
`+(V?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(m?", __e = _.escape":"")+(y?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+S+`return __p
}`;var j=tg(function(){return Function(d,R+"return "+S).apply(void 0,f)});if(j.source=S,Yl(j))throw j;return j}var Tt=at,lt=0;function mt(c){var e=++lt;return(0,hs.Z)(c)+e}var zt=mt;function Ht(c){let e=null;try{e=window.eval(c)}catch{}return e}function Kt(c,e,t,i){var a=-1,d=c==null?0:c.length;for(i&&d&&(t=c[++a]);++a<d;)t=e(t,c[a],a,c);return t}var $t=Kt,sn={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},fn=Tf(sn),Ut=fn,an=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Je="\\u0300-\\u036f",yt="\\ufe20-\\ufe2f",Jt="\\u20d0-\\u20ff",mn=Je+yt+Jt,Dt="["+mn+"]",Cn=RegExp(Dt,"g");function Ft(c){return c=(0,hs.Z)(c),c&&c.replace(an,Ut).replace(Cn,"")}var ln=Ft,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function un(c){return c.match(Nt)||[]}var $n=un,lr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function pn(c){return lr.test(c)}var en=pn,Ot="\\ud800-\\udfff",Jn="\\u0300-\\u036f",Ar="\\ufe20-\\ufe2f",Mn="\\u20d0-\\u20ff",Lr=Jn+Ar+Mn,hr="\\u2700-\\u27bf",Mr="a-z\\xdf-\\xf6\\xf8-\\xff",si="\\xac\\xb1\\xd7\\xf7",To="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Wo="\\u2000-\\u206f",Vr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",oo="A-Z\\xc0-\\xd6\\xd8-\\xde",fi="\\ufe0e\\ufe0f",so=si+To+Wo+Vr,Mo="['\u2019]",Po="["+so+"]",is="["+Lr+"]",os="\\d+",mo="["+hr+"]",wr="["+Mr+"]",ss="[^"+Ot+so+os+hr+Mr+oo+"]",ai="\\ud83c[\\udffb-\\udfff]",Yn="(?:"+is+"|"+ai+")",kr="[^"+Ot+"]",Wr="(?:\\ud83c[\\udde6-\\uddff]){2}",ao="[\\ud800-\\udbff][\\udc00-\\udfff]",Us="["+oo+"]",Ed="\\u200d",Te="(?:"+wr+"|"+ss+")",ut="(?:"+Us+"|"+ss+")",ot="(?:"+Mo+"(?:d|ll|m|re|s|t|ve))?",wn="(?:"+Mo+"(?:D|LL|M|RE|S|T|VE))?",Rr=Yn+"?",ye="["+fi+"]?",ie="(?:"+Ed+"(?:"+[kr,Wr,ao].join("|")+")"+ye+Rr+")*",Ie="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Xe="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Qe=ye+Rr+ie,Be="(?:"+[mo,Wr,ao].join("|")+")"+Qe,Le=RegExp([Us+"?"+wr+"+"+ot+"(?="+[Po,Us,"$"].join("|")+")",ut+"+"+wn+"(?="+[Po,Us+Te,"$"].join("|")+")",Us+"?"+Te+"+"+ot,Us+"+"+wn,Xe,Ie,os,Be].join("|"),"g");function $e(c){return c.match(Le)||[]}var xe=$e;function Ne(c,e,t){return c=(0,hs.Z)(c),e=t?void 0:e,e===void 0?en(c)?xe(c):$n(c):c.match(e)||[]}var me=Ne,We="['\u2019]",nt=RegExp(We,"g");function dt(c){return function(e){return $t(me(ln(e).replace(nt,"")),c,"")}}var Mt=dt;function Et(c){return function(e){e=(0,hs.Z)(e);var t=Mc(e)?wa(e):void 0,i=t?t[0]:e.charAt(0),a=t?al(t,1).join(""):e.slice(1);return i[c]()+a}}var qt=Et,Fn=qt("toUpperCase"),ar=Fn,Tn=Mt(function(c,e,t){return c+(t?" ":"")+ar(e)}),Gn=Tn;function xr(c){return ar((0,hs.Z)(c).toLowerCase())}var ni=xr,Ji=Mt(function(c,e,t){return e=e.toLowerCase(),c+(t?ni(e):e)}),as=Ji,Zf=Mt(function(c,e,t){return c+(t?" ":"")+e.toUpperCase()}),Aa=Zf,rg=Mt(function(c,e,t){return c+(t?" ":"")+e.toLowerCase()}),ra=rg,rv=qt("toLowerCase"),bb=rv;const Th=c=>{const e=Object.create(null);return t=>e[t]||(e[t]=c(t))},iv=Th(c=>c.replace(/\B([A-Z])/g,"-$1").toLowerCase()),Ic=Th(c=>Gn(as(c)).replace(/ /g,"")),ov=Th(c=>Aa(c).replace(/ /g,"_")),R1=Th(c=>ra(c).replace(/ /g,".")),xb=Th(c=>ra(c).replace(/ /g,"/")),sv=Th(c=>ar(ra(c))),Cb=Th(c=>Gn(as(c)));function ig(c){let e=2166136261,t=!1,i=c;for(let a=0,d=i.length;a<d;a+=1){let f=i.charCodeAt(a);f>127&&!t&&(i=unescape(encodeURIComponent(i)),f=i.charCodeAt(a),t=!0),e^=f,e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)}return e>>>0}function og(){let c="";const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let t=0,i=e.length;t<i;t+=1){const a=e[t],d=Math.random()*16|0;c+=(a==="x"?d:a==="y"?d&3|8:a).toString(16)}return c}function Am(c,e={}){const t=N().parseHTML(c,null,!1);return t.forEach(i=>{const a=i;if(a){const d=a.attributes;if(d)for(let f=0,m=d.length;f<m;f+=1){const y=d.item(f);if(y){const x=y.value.toLowerCase(),E=y.name.toLowerCase();(E.startsWith("on")||x.startsWith("javascript:")||x.startsWith("data:")||x.startsWith("vbscript:"))&&a.removeAttribute(E)}}}}),e.raw?t:N()("<div/>").append(t).html()}function wb(c,e,t){const i=Math.min(2,Math.floor(c.length*.34));let a=Math.floor(c.length*.4)+1,d,f=!1;const m=c.toLowerCase();for(const y of e){const x=t(y);if(x!==void 0&&Math.abs(x.length-m.length)<=i){const E=x.toLowerCase();if(E===m){if(x===c)continue;return y}if(f||x.length<3)continue;const S=I1(m,E,a-1);if(S===void 0)continue;S<3?(f=!0,d=y):(a=S,d=y)}}return d}function I1(c,e,t){let i=new Array(e.length+1),a=new Array(e.length+1);const d=t+1;for(let m=0;m<=e.length;m+=1)i[m]=m;for(let m=1;m<=c.length;m+=1){const y=c.charCodeAt(m-1),x=m>t?m-t:1,E=e.length>t+m?t+m:e.length;a[0]=m;let S=m;for(let R=1;R<x;R+=1)a[R]=d;for(let R=x;R<=E;R+=1){const V=y===e.charCodeAt(R-1)?i[R-1]:Math.min(i[R]+1,a[R-1]+1,i[R-1]+2);a[R]=V,S=Math.min(S,V)}for(let R=E+1;R<=e.length;R+=1)a[R]=d;if(S>t)return;const T=i;i=a,a=T}const f=i[e.length];return f>t?void 0:f}var Eb="[object Number]";function L1(c){return typeof c=="number"||(0,nl.Z)(c)&&(0,cd.Z)(c)==Eb}var av=L1;function F1(c){return av(c)&&c!=+c}var G1=F1,Sb=P(66092),B1=Sb.Z.isFinite;function z1(c){return typeof c=="number"&&B1(c)}var US=z1;function U1(c){return typeof c=="number"&&c==rs(c)}var V1=U1,Ab=9007199254740991;function Tb(c){return V1(c)&&c>=-Ab&&c<=Ab}var VS=Tb;function j1(c,e,t){return t===void 0&&(t=e,e=void 0),t!==void 0&&(t=(0,Ul.Z)(t),t=t===t?t:0),e!==void 0&&(e=(0,Ul.Z)(e),e=e===e?e:0),zl((0,Ul.Z)(c),e,t)}var Ta=j1,Mb=Math.max,H1=Math.min;function Pb(c,e,t){return c>=H1(e,t)&&c<Mb(e,t)}var $1=Pb;function W1(c,e,t){return e=sl(e),t===void 0?(t=e,e=0):t=sl(t),c=(0,Ul.Z)(c),$1(c,e,t)}var jS=W1,lv=9007199254740991;function Ob(c){return c?zl(rs(c),-lv,lv):c===0?c:0}var HS=Ob,cv=/^\s+/,Z1=Sb.Z.parseInt;function uv(c,e,t){return t||e==null?e=0:e&&(e=+e),Z1((0,hs.Z)(c).replace(cv,""),e||0)}var X1=uv;const eO=c=>c&&c===c.window,Db=c=>!Array.isArray(c)&&c-parseFloat(c)+1>=0;function $S(c,e){return(c%e+e)%e}function tO(c,e){if(e==null)e=c??1,c=0;else if(e<c){const t=c;c=e,e=t}return Math.floor(Math.random()*(e-c+1)+c)}function pl(c){return typeof c=="string"&&c.slice(-1)==="%"}function Lc(c,e){if(c==null)return 0;let t;if(typeof c=="string"){if(t=parseFloat(c),pl(c)&&(t/=100,Number.isFinite(t)))return t*e}else t=c;return Number.isFinite(t)?t>0&&t<1?t*e:t:0}function Y1(c,e){function t(f){const m=new RegExp(`(?:\\d+(?:\\.\\d+)*)(${f})$`).exec(c);return m?m[1]:null}const i=parseFloat(c);if(Number.isNaN(i))return null;let a;if(e==null)a="[A-Za-z]*";else if(Array.isArray(e)){if(e.length===0)return null;a=e.join("|")}else typeof e=="string"&&(a=e);const d=t(a);return d===null?null:{unit:d,value:i}}function Ma(c){if(typeof c=="object"){let t=0,i=0,a=0,d=0;return c.vertical!=null&&Number.isFinite(c.vertical)&&(i=d=c.vertical),c.horizontal!=null&&Number.isFinite(c.horizontal)&&(a=t=c.horizontal),c.left!=null&&Number.isFinite(c.left)&&(t=c.left),c.top!=null&&Number.isFinite(c.top)&&(i=c.top),c.right!=null&&Number.isFinite(c.right)&&(a=c.right),c.bottom!=null&&Number.isFinite(c.bottom)&&(d=c.bottom),{top:i,right:a,bottom:d,left:t}}let e=0;return c!=null&&Number.isFinite(c)&&(e=c),{top:e,right:e,bottom:e,left:e}}var K1=P(73234),WS="Expected a function";function q1(c,e){var t;if(typeof e!="function")throw new TypeError(WS);return c=rs(c),function(){return--c>0&&(t=e.apply(this,arguments)),c<=1&&(e=void 0),t}}var ZS=q1;function J1(c){return ZS(2,c)}var Q1=J1,dv=P(99111),ew="Expected a function";function tw(c,e,t){if(typeof c!="function")throw new TypeError(ew);return setTimeout(function(){c.apply(void 0,t)},e)}var nw=tw,_b=(0,Ho.Z)(function(c,e){return nw(c,1,e)}),Nb=_b;function Tm(c,e,t){if(t)switch(t.length){case 0:return c.call(e);case 1:return c.call(e,t[0]);case 2:return c.call(e,t[0],t[1]);case 3:return c.call(e,t[0],t[1],t[2]);case 4:return c.call(e,t[0],t[1],t[2],t[3]);case 5:return c.call(e,t[0],t[1],t[2],t[3],t[4]);case 6:return c.call(e,t[0],t[1],t[2],t[3],t[4],t[5]);default:return c.apply(e,t)}return c.call(e)}function Pn(c,e,...t){return Tm(c,e,t)}function rw(c,e){for(let t=0,i=c.length;t<i;t+=1)if(c[t]===e)return c.push(c.splice(t,1)[0])}function iw(c,e,t){const i=[],a={};return(...f)=>{let m=!1;const y=f.join("\u2400");return y in a?(m=!0,rw(i,y)):(i.length>=1e3&&delete a[i.shift()],i.push(y),a[y]=Tm(c,e||null,f)),t?t(a[y],m):a[y]}}function kb(c){return typeof c=="object"&&c.then&&typeof c.then=="function"}function Mm(c){return c!=null&&(c instanceof Promise||kb(c))}function Pm(...c){const e=[];if(c.forEach(i=>{Array.isArray(i)?e.push(...i):e.push(i)}),e.some(i=>Mm(i))){const i=e.map(a=>Mm(a)?a:Promise.resolve(a!==!1));return Promise.all(i).then(a=>a.reduce((d,f)=>f!==!1&&d,!0))}return e.every(i=>i!==!1)}function hv(...c){const e=Pm(c);return typeof e=="boolean"?Promise.resolve(e):e}const Om=/[\t\r\n\f]/g,sg=/\S+/g,Xf=c=>` ${c} `;function Mh(c){return c&&c.getAttribute&&c.getAttribute("class")||""}function Sd(c,e){if(c==null||e==null)return!1;const t=Xf(Mh(c)),i=Xf(e);return c.nodeType===1?t.replace(Om," ").includes(i):!1}function vi(c,e){if(!(c==null||e==null)){if(typeof e=="function")return vi(c,e(Mh(c)));if(typeof e=="string"&&c.nodeType===1){const t=e.match(sg)||[],i=Xf(Mh(c)).replace(Om," ");let a=t.reduce((d,f)=>d.indexOf(Xf(f))<0?`${d}${f} `:d,i);a=a.trim(),i!==a&&c.setAttribute("class",a)}}}function Wa(c,e){if(c!=null){if(typeof e=="function")return Wa(c,e(Mh(c)));if((!e||typeof e=="string")&&c.nodeType===1){const t=(e||"").match(sg)||[],i=Xf(Mh(c)).replace(Om," ");let a=t.reduce((d,f)=>{const m=Xf(f);return d.indexOf(m)>-1?d.replace(m," "):d},i);a=e?a.trim():"",i!==a&&c.setAttribute("class",a)}}}function ag(c,e,t){if(!(c==null||e==null)){if(t!=null&&typeof e=="string"){t?vi(c,e):Wa(c,e);return}if(typeof e=="function")return ag(c,e(Mh(c),t),t);typeof e=="string"&&(e.match(sg)||[]).forEach(a=>{Sd(c,a)?Wa(c,a):vi(c,a)})}}let fv=0;function Dm(){return fv+=1,`v${fv}`}function Ph(c){return(c.id==null||c.id==="")&&(c.id=Dm()),c.id}function Ad(c){return c==null?!1:typeof c.getScreenCTM=="function"&&c instanceof SVGElement}const Fo={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},lg="1.1";function cg(c,e=document){return e.createElement(c)}function _m(c,e=Fo.xhtml,t=document){return t.createElementNS(e,c)}function ma(c,e=document){return _m(c,Fo.svg,e)}function ug(c){if(c){const t=`<svg xmlns="${Fo.svg}" xmlns:xlink="${Fo.xlink}" version="${lg}">${c}</svg>`,{documentElement:i}=Rb(t,{async:!1});return i}const e=document.createElementNS(Fo.svg,"svg");return e.setAttributeNS(Fo.xmlns,"xmlns:xlink",Fo.xlink),e.setAttribute("version",lg),e}function Rb(c,e={}){let t;try{const i=new DOMParser;if(e.async!=null){const a=i;a.async=e.async}t=i.parseFromString(c,e.mimeType||"text/xml")}catch{t=void 0}if(!t||t.getElementsByTagName("parsererror").length)throw new Error(`Invalid XML: ${c}`);return t}function Ib(c,e=!0){const t=c.nodeName;return e?t.toLowerCase():t.toUpperCase()}function Nm(c){let e=0,t=c.previousSibling;for(;t;)t.nodeType===1&&(e+=1),t=t.previousSibling;return e}function ow(c,e){return c.querySelectorAll(e)}function km(c,e){return c.querySelector(e)}function Lb(c,e,t){const i=c.ownerSVGElement;let a=c.parentNode;for(;a&&a!==t&&a!==i;){if(Sd(a,e))return a;a=a.parentNode}return null}function Rm(c,e){const t=e&&e.parentNode;return c===t||!!(t&&t.nodeType===1&&c.compareDocumentPosition(t)&16)}function Jl(c){c.parentNode&&c.parentNode.removeChild(c)}function Im(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function Yf(c,e){(Array.isArray(e)?e:[e]).forEach(i=>{i!=null&&c.appendChild(i)})}function Fb(c,e){const t=c.firstChild;return t?Lm(t,e):Yf(c,e)}function Lm(c,e){const t=c.parentNode;t&&(Array.isArray(e)?e:[e]).forEach(a=>{a!=null&&t.insertBefore(a,c)})}function Gb(c,e){e!=null&&e.appendChild(c)}function Fm(c){try{return c instanceof HTMLElement}catch{return typeof c=="object"&&c.nodeType===1&&typeof c.style=="object"&&typeof c.ownerDocument=="object"}}const pv=["viewBox","attributeName","attributeType","repeatCount"];function Bb(c,e){return c.getAttribute(e)}function Gm(c,e){const t=mv(e);t.ns?c.hasAttributeNS(t.ns,t.local)&&c.removeAttributeNS(t.ns,t.local):c.hasAttribute(e)&&c.removeAttribute(e)}function Bm(c,e,t){if(t==null)return Gm(c,e);const i=mv(e);i.ns&&typeof t=="string"?c.setAttributeNS(i.ns,e,t):e==="id"?c.id=`${t}`:c.setAttribute(e,`${t}`)}function gv(c,e){Object.keys(e).forEach(t=>{Bm(c,t,e[t])})}function yi(c,e,t){if(e==null){const i=c.attributes,a={};for(let d=0;d<i.length;d+=1)a[i[d].name]=i[d].value;return a}if(typeof e=="string"&&t===void 0)return c.getAttribute(e);typeof e=="object"?gv(c,e):Bm(c,e,t)}function mv(c){if(c.indexOf(":")!==-1){const e=c.split(":");return{ns:Fo[e[0]],local:e[1]}}return{ns:null,local:c}}function Kf(c){const e={};return Object.keys(c).forEach(t=>{const i=pv.includes(t)?t:iv(t);e[i]=c[t]}),e}function dg(c){const e={};return c.split(";").forEach(i=>{const a=i.trim();if(a){const d=a.split("=");d.length&&(e[d[0].trim()]=d[1]?d[1].trim():"")}}),e}function zm(c,e){return Object.keys(e).forEach(t=>{if(t==="class")c[t]=c[t]?`${c[t]} ${e[t]}`:e[t];else if(t==="style"){const i=typeof c[t]=="object",a=typeof e[t]=="object";let d,f;i&&a?(d=c[t],f=e[t]):i?(d=c[t],f=dg(e[t])):a?(d=dg(c[t]),f=e[t]):(d=dg(c[t]),f=dg(e[t])),c[t]=zm(d,f)}else c[t]=e[t]}),c}function sw(c,e,t={}){const i=t.offset||0,a=[],d=[];let f,m,y=null;for(let x=0;x<c.length;x+=1){f=d[x]=c[x];for(let E=0,S=e.length;E<S;E+=1){const T=e[E],R=T.start+i,V=T.end+i;x>=R&&x<V&&(typeof f=="string"?f=d[x]={t:c[x],attrs:T.attrs}:f.attrs=zm(zm({},f.attrs),T.attrs),t.includeAnnotationIndices&&(f.annotations==null&&(f.annotations=[]),f.annotations.push(E)))}m=d[x-1],m?Js.Z(f)&&Js.Z(m)?(y=y,JSON.stringify(f.attrs)===JSON.stringify(m.attrs)?y.t+=f.t:(a.push(y),y=f)):Js.Z(f)||Js.Z(m)?(y=y,a.push(y),y=f):y=(y||"")+f:y=f}return y!=null&&a.push(y),a}function XS(c,e){return c?c.filter(t=>t.start<e&&e<=t.end):[]}function YS(c,e,t){return c?c.filter(i=>e>=i.start&&e<i.end||t>i.start&&t<=i.end||i.start>=e&&i.end<t):[]}function KS(c,e,t){return c&&c.forEach(i=>{i.start<e&&i.end>=e?i.end+=t:i.start>=e&&(i.start+=t,i.end+=t)}),c}function aw(c){return c.replace(/ /g,"\xA0")}var zb;(function(c){c.emptyObject=Object.freeze({}),c.emptyArray=Object.freeze([]);function e(E){return E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"}c.isPrimitive=e;function t(E){return Array.isArray(E)}c.isArray=t;function i(E){return!e(E)&&!t(E)}c.isObject=i;function a(E,S){if(E===S)return!0;if(e(E)||e(S))return!1;const T=t(E),R=t(S);return T!==R?!1:T&&R?f(E,S):m(E,S)}c.deepEqual=a;function d(E){return e(E)?E:t(E)?y(E):x(E)}c.deepCopy=d;function f(E,S){if(E===S)return!0;if(E.length!==S.length)return!1;for(let T=0,R=E.length;T<R;T+=1)if(!a(E[T],S[T]))return!1;return!0}function m(E,S){if(E===S)return!0;for(const T in E)if(!(T in S))return!1;for(const T in S)if(!(T in E))return!1;for(const T in E)if(!a(E[T],S[T]))return!1;return!0}function y(E){const S=new Array(E.length);for(let T=0,R=E.length;T<R;T+=1)S[T]=d(E[T]);return S}function x(E){const S={};return Object.keys(E).forEach(T=>{S[T]=d(E[T])}),S}})(zb||(zb={}));var vv;(function(c){function e(x){const E="data:";return x.substr(0,E.length)===E}c.isDataUrl=e;function t(x,E){if(!x||e(x)){setTimeout(()=>E(null,x));return}const S=()=>{E(new Error(`Failed to load image: ${x}`))},T=window.FileReader?V=>{if(V.status===200){const j=new FileReader;j.onload=q=>{const ue=q.target.result;E(null,ue)},j.onerror=S,j.readAsDataURL(V.response)}else S()}:V=>{const j=q=>{const be=[];for(let se=0;se<q.length;se+=32768)be.push(String.fromCharCode.apply(null,q.subarray(se,se+32768)));return be.join("")};if(V.status===200){let q=x.split(".").pop()||"png";q==="svg"&&(q="svg+xml");const ue=`data:image/${q};base64,`,be=new Uint8Array(V.response),se=ue+btoa(j(be));E(null,se)}else S()},R=new XMLHttpRequest;R.responseType=window.FileReader?"blob":"arraybuffer",R.open("GET",x,!0),R.addEventListener("error",S),R.addEventListener("load",()=>T(R)),R.send()}c.imageToDataUri=t;function i(x){let E=x.replace(/\s/g,"");E=decodeURIComponent(E);const S=E.indexOf(","),T=E.slice(0,S),R=T.split(":")[1].split(";")[0],V=E.slice(S+1);let j;T.indexOf("base64")>=0?j=atob(V):j=unescape(encodeURIComponent(V));const q=new Uint8Array(j.length);for(let ue=0;ue<j.length;ue+=1)q[ue]=j.charCodeAt(ue);return new Blob([q],{type:R})}c.dataUriToBlob=i;function a(x,E){const S=window.navigator.msSaveBlob;if(S)S(x,E);else{const T=window.URL.createObjectURL(x),R=document.createElement("a");R.href=T,R.download=E,document.body.appendChild(R),R.click(),document.body.removeChild(R),window.URL.revokeObjectURL(T)}}c.downloadBlob=a;function d(x,E){const S=i(x);a(S,E)}c.downloadDataUri=d;function f(x){const E=x.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return E&&E[2]?E[2].replace(/\s+/," ").split(" "):null}function m(x){const E=parseFloat(x);return Number.isNaN(E)?null:E}function y(x,E={}){let S=null;const T=se=>(S==null&&(S=f(x)),S!=null?m(S[se]):null),R=se=>{const Pe=x.match(se);return Pe&&Pe[2]?m(Pe[2]):null};let V=E.width;if(V==null&&(V=R(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),V==null&&(V=T(2)),V==null)throw new Error("Can not parse width from svg string");let j=E.height;if(j==null&&(j=R(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),j==null&&(j=T(3)),j==null)throw new Error("Can not parse height from svg string");return`data:image/svg+xml,${encodeURIComponent(x).replace(/'/g,"%27").replace(/"/g,"%22")}`}c.svgToDataUrl=y})(vv||(vv={}));let Oh;const lw={px(c){return c},mm(c){return Oh*c},cm(c){return Oh*c*10},in(c){return Oh*c*25.4},pt(c){return Oh*(25.4*c/72)},pc(c){return Oh*(25.4*c/6)}};var hg;(function(c){function e(i,a,d){const f=N()("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:i+(d||""),height:a+(d||"")}).appendTo(document.body),m={width:f.width()||0,height:f.height()||0};return f.remove(),m}c.measure=e;function t(i,a){Oh==null&&(Oh=e("1","1","mm").width);const d=a?lw[a]:null;return d?d(i):i}c.toPx=t})(hg||(hg={}));const qf=function(){let c;const e=window;if(e!=null&&(c=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame,c!=null&&(c=c.bind(e))),c==null){let t=0;c=i=>{const a=new Date().getTime(),d=Math.max(0,16-(a-t)),f=setTimeout(()=>{i(a+d)},d);return t=a+d,f}}return c}(),Um=function(){let c;const e=window;return e!=null&&(c=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.msCancelAnimationFrame||e.msCancelRequestAnimationFrame||e.oCancelAnimationFrame||e.oCancelRequestAnimationFrame||e.mozCancelAnimationFrame||e.mozCancelRequestAnimationFrame,c&&(c=c.bind(e))),c==null&&(c=clearTimeout),c}(),yv=/-(.)/g;function Ub(c){return c.replace(yv,(e,t)=>t.toUpperCase())}const Jf={},Vb=["Webkit","ms","Moz","O"],jb=document?document.createElement("div").style:{};function cw(c){for(let e=0;e<Vb.length;e+=1){const t=Vb[e]+c;if(t in jb)return t}return null}function bv(c){const e=Ub(c);if(Jf[e]==null){const t=e.charAt(0).toUpperCase()+e.slice(1);Jf[e]=e in jb?e:cw(t)}return Jf[e]}function uw(c,e,t){const i=bv(e);i!=null&&(c[i]=t),c[e]=t}function fg(c,e){const t=c.ownerDocument&&c.ownerDocument.defaultView&&c.ownerDocument.defaultView.opener?c.ownerDocument.defaultView.getComputedStyle(c,null):window.getComputedStyle(c,null);return t&&e?t.getPropertyValue(e)||t[e]:t}function dw(c){const e=fg(c);return e!=null&&(e.overflow==="scroll"||e.overflow==="auto")}const Vm=function(){const c=document;return c.selection?function(){c.selection.empty()}:window.getSelection?function(){const e=window.getSelection();e&&(e.empty?e.empty():e.removeAllRanges&&e.removeAllRanges())}:function(){}}();var ri;(function(c){function e(i){return 180*i/Math.PI%360}c.toDeg=e,c.toRad=function(i,a=!1){return(a?i:i%360)*Math.PI/180};function t(i){return i%360+(i<0?360:0)}c.normalize=t})(ri||(ri={}));function Fc(c,e=0){return Number.isInteger(c)?c:+c.toFixed(e)}function Hb(c,e){let t,i;if(e==null?(i=c??1,t=0):(i=e,t=c??0),i<t){const a=t;t=i,i=a}return Math.floor(Math.random()*(i-t+1)+t)}function ks(c,e,t){return Number.isNaN(c)?NaN:Number.isNaN(e)||Number.isNaN(t)?0:e<t?c<e?e:c>t?t:c:c<t?t:c>e?e:c}function xv(c,e){return e*Math.round(c/e)}function $b(c,e){return e!=null&&c!=null&&e.x>=c.x&&e.x<=c.x+c.width&&e.y>=c.y&&e.y<=c.y+c.height}function Cv(c,e){const t=c.x-e.x,i=c.y-e.y;return t*t+i*i}class Ql{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}class Oe extends Ql{constructor(e,t){super(),this.x=e??0,this.y=t??0}get[Symbol.toStringTag](){return Oe.toStringTag}round(e=0){return this.x=Fc(this.x,e),this.y=Fc(this.y,e),this}add(e,t){const i=Oe.create(e,t);return this.x+=i.x,this.y+=i.y,this}update(e,t){const i=Oe.create(e,t);return this.x=i.x,this.y=i.y,this}translate(e,t){const i=Oe.create(e,t);return this.x+=i.x,this.y+=i.y,this}rotate(e,t){const i=Oe.rotate(this,e,t);return this.x=i.x,this.y=i.y,this}scale(e,t,i=new Oe){const a=Oe.create(i);return this.x=a.x+e*(this.x-a.x),this.y=a.y+t*(this.y-a.y),this}closest(e){if(e.length===1)return Oe.create(e[0]);let t=null,i=1/0;return e.forEach(a=>{const d=this.squaredDistance(a);d<i&&(t=a,i=d)}),t?Oe.create(t):null}distance(e){return Math.sqrt(this.squaredDistance(e))}squaredDistance(e){const t=Oe.create(e),i=this.x-t.x,a=this.y-t.y;return i*i+a*a}manhattanDistance(e){const t=Oe.create(e);return Math.abs(t.x-this.x)+Math.abs(t.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(e=new Oe){const t=Oe.create(e),i=-(t.y-this.y),a=t.x-this.x;let d=Math.atan2(i,a);return d<0&&(d=2*Math.PI+d),180*d/Math.PI}angleBetween(e,t){if(this.equals(e)||this.equals(t))return NaN;let i=this.theta(t)-this.theta(e);return i<0&&(i+=360),i}vectorAngle(e){return new Oe(0,0).angleBetween(this,e)}toPolar(e){return this.update(Oe.toPolar(this,e)),this}changeInAngle(e,t,i=new Oe){return this.clone().translate(-e,-t).theta(i)-this.theta(i)}adhereToRect(e){return $b(e,this)||(this.x=Math.min(Math.max(this.x,e.x),e.x+e.width),this.y=Math.min(Math.max(this.y,e.y),e.y+e.height)),this}bearing(e){const t=Oe.create(e),i=ri.toRad(this.y),a=ri.toRad(t.y),d=this.x,f=t.x,m=ri.toRad(f-d),y=Math.sin(m)*Math.cos(a),x=Math.cos(i)*Math.sin(a)-Math.sin(i)*Math.cos(a)*Math.cos(m),E=ri.toDeg(Math.atan2(y,x)),S=["NE","E","SE","S","SW","W","NW","N"];let T=E-22.5;return T<0&&(T+=360),T=parseInt(T/45,10),S[T]}cross(e,t){if(e!=null&&t!=null){const i=Oe.create(e),a=Oe.create(t);return(a.x-this.x)*(i.y-this.y)-(a.y-this.y)*(i.x-this.x)}return NaN}dot(e){const t=Oe.create(e);return this.x*t.x+this.y*t.y}diff(e,t){if(typeof e=="number")return new Oe(this.x-e,this.y-t);const i=Oe.create(e);return new Oe(this.x-i.x,this.y-i.y)}lerp(e,t){const i=Oe.create(e);return new Oe((1-t)*this.x+t*i.x,(1-t)*this.y+t*i.y)}normalize(e=1){const t=e/this.magnitude();return this.scale(t,t)}move(e,t){const i=Oe.create(e),a=ri.toRad(i.theta(this));return this.translate(Math.cos(a)*t,-Math.sin(a)*t)}reflection(e){return Oe.create(e).move(this,this.distance(e))}snapToGrid(e,t){return this.x=xv(this.x,e),this.y=xv(this.y,t??e),this}equals(e){const t=Oe.create(e);return t!=null&&t.x===this.x&&t.y===this.y}clone(){return Oe.clone(this)}toJSON(){return Oe.toJSON(this)}serialize(){return`${this.x} ${this.y}`}}(function(c){c.toStringTag=`X6.Geometry.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.x=="number"&&typeof a.y=="number"&&typeof a.toPolar=="function"}c.isPoint=e})(Oe||(Oe={})),function(c){function e(i){return i!=null&&typeof i=="object"&&typeof i.x=="number"&&typeof i.y=="number"}c.isPointLike=e;function t(i){return i!=null&&Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"}c.isPointData=t}(Oe||(Oe={})),function(c){function e(S,T){return S==null||typeof S=="number"?new c(S,T):t(S)}c.create=e;function t(S){return c.isPoint(S)?new c(S.x,S.y):Array.isArray(S)?new c(S[0],S[1]):new c(S.x,S.y)}c.clone=t;function i(S){return c.isPoint(S)?{x:S.x,y:S.y}:Array.isArray(S)?{x:S[0],y:S[1]}:{x:S.x,y:S.y}}c.toJSON=i;function a(S,T,R=new c){let V=Math.abs(S*Math.cos(T)),j=Math.abs(S*Math.sin(T));const q=t(R),ue=ri.normalize(ri.toDeg(T));return ue<90?j=-j:ue<180?(V=-V,j=-j):ue<270&&(V=-V),new c(q.x+V,q.y+j)}c.fromPolar=a;function d(S,T=new c){const R=t(S),V=t(T),j=R.x-V.x,q=R.y-V.y;return new c(Math.sqrt(j*j+q*q),ri.toRad(V.theta(R)))}c.toPolar=d;function f(S,T){return S===T?!0:S!=null&&T!=null?S.x===T.x&&S.y===T.y:!1}c.equals=f;function m(S,T){if(S==null&&T!=null||S!=null&&T==null||S!=null&&T!=null&&S.length!==T.length)return!1;if(S!=null&&T!=null){for(let R=0,V=S.length;R<V;R+=1)if(!f(S[R],T[R]))return!1}return!0}c.equalPoints=m;function y(S,T,R,V){return new c(Hb(S,T),Hb(R,V))}c.random=y;function x(S,T,R){const V=ri.toRad(ri.normalize(-T)),j=Math.sin(V),q=Math.cos(V);return E(S,q,j,R)}c.rotate=x;function E(S,T,R,V=new c){const j=t(S),q=t(V),ue=j.x-q.x,be=j.y-q.y,se=ue*T-be*R,Pe=be*T+ue*R;return new c(se+q.x,Pe+q.y)}c.rotateEx=E}(Oe||(Oe={}));class gn extends Ql{constructor(e,t,i,a){super(),this.x=e??0,this.y=t??0,this.width=i??0,this.height=a??0}get[Symbol.toStringTag](){return gn.toStringTag}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new Oe(this.x,this.y)}get topLeft(){return new Oe(this.x,this.y)}get topCenter(){return new Oe(this.x+this.width/2,this.y)}get topRight(){return new Oe(this.x+this.width,this.y)}get center(){return new Oe(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new Oe(this.x,this.y+this.height)}get bottomCenter(){return new Oe(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new Oe(this.x+this.width,this.y+this.height)}get corner(){return new Oe(this.x+this.width,this.y+this.height)}get rightMiddle(){return new Oe(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new Oe(this.x,this.y+this.height/2)}get topLine(){return new zn(this.topLeft,this.topRight)}get rightLine(){return new zn(this.topRight,this.bottomRight)}get bottomLine(){return new zn(this.bottomLeft,this.bottomRight)}get leftLine(){return new zn(this.topLeft,this.bottomLeft)}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(e){if(!e)return this.clone();const t=ri.toRad(e),i=Math.abs(Math.sin(t)),a=Math.abs(Math.cos(t)),d=this.width*a+this.height*i,f=this.width*i+this.height*a;return new gn(this.x+(this.width-d)/2,this.y+(this.height-f)/2,d,f)}round(e=0){return this.x=Fc(this.x,e),this.y=Fc(this.y,e),this.width=Fc(this.width,e),this.height=Fc(this.height,e),this}add(e,t,i,a){const d=gn.create(e,t,i,a),f=Math.min(this.x,d.x),m=Math.min(this.y,d.y),y=Math.max(this.x+this.width,d.x+d.width),x=Math.max(this.y+this.height,d.y+d.height);return this.x=f,this.y=m,this.width=y-f,this.height=x-m,this}update(e,t,i,a){const d=gn.create(e,t,i,a);return this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this}inflate(e,t){const i=e,a=t??e;return this.x-=i,this.y-=a,this.width+=2*i,this.height+=2*a,this}snapToGrid(e,t){const i=this.origin.snapToGrid(e,t),a=this.corner.snapToGrid(e,t);return this.x=i.x,this.y=i.y,this.width=a.x-i.x,this.height=a.y-i.y,this}translate(e,t){const i=Oe.create(e,t);return this.x+=i.x,this.y+=i.y,this}scale(e,t,i=new Oe){const a=this.origin.scale(e,t,i);return this.x=a.x,this.y=a.y,this.width*=e,this.height*=t,this}rotate(e,t=this.getCenter()){if(e!==0){const i=ri.toRad(e),a=Math.cos(i),d=Math.sin(i);let f=this.getOrigin(),m=this.getTopRight(),y=this.getBottomRight(),x=this.getBottomLeft();f=Oe.rotateEx(f,a,d,t),m=Oe.rotateEx(m,a,d,t),y=Oe.rotateEx(y,a,d,t),x=Oe.rotateEx(x,a,d,t);const E=new gn(f.x,f.y,0,0);E.add(m.x,m.y,0,0),E.add(y.x,y.y,0,0),E.add(x.x,x.y,0,0),this.update(E)}return this}rotate90(){const e=(this.width-this.height)/2;this.x+=e,this.y-=e;const t=this.width;return this.width=this.height,this.height=t,this}moveAndExpand(e){const t=gn.clone(e);return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this}getMaxScaleToFit(e,t=this.center){const i=gn.clone(e),a=t.x,d=t.y;let f=1/0,m=1/0,y=1/0,x=1/0,E=1/0,S=1/0,T=1/0,R=1/0;const V=i.topLeft;V.x<a&&(f=(this.x-a)/(V.x-a)),V.y<d&&(E=(this.y-d)/(V.y-d));const j=i.bottomRight;j.x>a&&(m=(this.x+this.width-a)/(j.x-a)),j.y>d&&(S=(this.y+this.height-d)/(j.y-d));const q=i.topRight;q.x>a&&(y=(this.x+this.width-a)/(q.x-a)),q.y<d&&(T=(this.y-d)/(q.y-d));const ue=i.bottomLeft;return ue.x<a&&(x=(this.x-a)/(ue.x-a)),ue.y>d&&(R=(this.y+this.height-d)/(ue.y-d)),{sx:Math.min(f,m,y,x),sy:Math.min(E,S,T,R)}}getMaxUniformScaleToFit(e,t=this.center){const i=this.getMaxScaleToFit(e,t);return Math.min(i.sx,i.sy)}containsPoint(e,t){return $b(this,Oe.create(e,t))}containsRect(e,t,i,a){const d=gn.create(e,t,i,a),f=this.x,m=this.y,y=this.width,x=this.height,E=d.x,S=d.y,T=d.width,R=d.height;return y===0||x===0||T===0||R===0?!1:E>=f&&S>=m&&E+T<=f+y&&S+R<=m+x}intersectsWithLine(e){const t=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],i=[],a=[];return t.forEach(d=>{const f=e.intersectsWithLine(d);f!==null&&a.indexOf(f.toString())<0&&(i.push(f),a.push(f.toString()))}),i.length>0?i:null}intersectsWithLineFromCenterToPoint(e,t){const i=Oe.clone(e),a=this.center;let d=null;t!=null&&t!==0&&i.rotate(t,a);const f=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],m=new zn(a,i);for(let y=f.length-1;y>=0;y-=1){const x=f[y].intersectsWithLine(m);if(x!==null){d=x;break}}return d&&t!=null&&t!==0&&d.rotate(-t,a),d}intersectsWithRect(e,t,i,a){const d=gn.create(e,t,i,a);if(!this.isIntersectWithRect(d))return null;const f=this.origin,m=this.corner,y=d.origin,x=d.corner,E=Math.max(f.x,y.x),S=Math.max(f.y,y.y);return new gn(E,S,Math.min(m.x,x.x)-E,Math.min(m.y,x.y)-S)}isIntersectWithRect(e,t,i,a){const d=gn.create(e,t,i,a),f=this.origin,m=this.corner,y=d.origin,x=d.corner;return!(x.x<=f.x||x.y<=f.y||y.x>=m.x||y.y>=m.y)}normalize(){let e=this.x,t=this.y,i=this.width,a=this.height;return this.width<0&&(e=this.x+this.width,i=-this.width),this.height<0&&(t=this.y+this.height,a=-this.height),this.x=e,this.y=t,this.width=i,this.height=a,this}union(e){const t=gn.clone(e),i=this.origin,a=this.corner,d=t.origin,f=t.corner,m=Math.min(i.x,d.x),y=Math.min(i.y,d.y),x=Math.max(a.x,f.x),E=Math.max(a.y,f.y);return new gn(m,y,x-m,E-y)}getNearestSideToPoint(e){const t=Oe.clone(e),i=t.x-this.x,a=this.x+this.width-t.x,d=t.y-this.y,f=this.y+this.height-t.y;let m=i,y="left";return a<m&&(m=a,y="right"),d<m&&(m=d,y="top"),f<m&&(y="bottom"),y}getNearestPointToPoint(e){const t=Oe.clone(e);if(this.containsPoint(t))switch(this.getNearestSideToPoint(t)){case"right":return new Oe(this.x+this.width,t.y);case"left":return new Oe(this.x,t.y);case"bottom":return new Oe(t.x,this.y+this.height);case"top":return new Oe(t.x,this.y);default:break}return t.adhereToRect(this)}equals(e){return e!=null&&e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}clone(){return new gn(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} ${this.height}`}}(function(c){c.toStringTag=`X6.Geometry.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.x=="number"&&typeof a.y=="number"&&typeof a.width=="number"&&typeof a.height=="number"&&typeof a.inflate=="function"&&typeof a.moveAndExpand=="function"}c.isRectangle=e})(gn||(gn={})),function(c){function e(t){return t!=null&&typeof t=="object"&&typeof t.x=="number"&&typeof t.y=="number"&&typeof t.width=="number"&&typeof t.height=="number"}c.isRectangleLike=e}(gn||(gn={})),function(c){function e(f,m,y,x){return f==null||typeof f=="number"?new c(f,m,y,x):t(f)}c.create=e;function t(f){return c.isRectangle(f)?f.clone():Array.isArray(f)?new c(f[0],f[1],f[2],f[3]):new c(f.x,f.y,f.width,f.height)}c.clone=t;function i(f){return new c(0,0,f.width,f.height)}c.fromSize=i;function a(f,m){return new c(f.x,f.y,m.width,m.height)}c.fromPositionAndSize=a;function d(f){return new c(f.x-f.a,f.y-f.b,2*f.a,2*f.b)}c.fromEllipse=d}(gn||(gn={}));class zn extends Ql{constructor(e,t,i,a){super(),typeof e=="number"&&typeof t=="number"?(this.start=new Oe(e,t),this.end=new Oe(i,a)):(this.start=Oe.create(e),this.end=Oe.create(t))}get[Symbol.toStringTag](){return zn.toStringTag}get center(){return new Oe((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}getCenter(){return this.center}round(e=0){return this.start.round(e),this.end.round(e),this}translate(e,t){return typeof e=="number"?(this.start.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.end.translate(e)),this}rotate(e,t){return this.start.rotate(e,t),this.end.rotate(e,t),this}scale(e,t,i){return this.start.scale(e,t,i),this.end.scale(e,t,i),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const e=this.start.x-this.end.x,t=this.start.y-this.end.y;return e*e+t*t}setLength(e){const t=this.length();if(!t)return this;const i=e/t;return this.scale(i,i,this.start)}parallel(e){const t=this.clone();if(!t.isDifferentiable())return t;const{start:i,end:a}=t,d=i.clone().rotate(270,a),f=a.clone().rotate(90,i);return i.move(f,e),a.move(d,e),t}vector(){return new Oe(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){const e=new Oe(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,e)}bbox(){const e=Math.min(this.start.x,this.end.x),t=Math.min(this.start.y,this.end.y),i=Math.max(this.start.x,this.end.x),a=Math.max(this.start.y,this.end.y);return new gn(e,t,i-e,a-t)}bearing(){return this.start.bearing(this.end)}closestPoint(e){return this.pointAt(this.closestPointNormalizedLength(e))}closestPointLength(e){return this.closestPointNormalizedLength(e)*this.length()}closestPointTangent(e){return this.tangentAt(this.closestPointNormalizedLength(e))}closestPointNormalizedLength(e){const t=this.vector().dot(new zn(this.start,e).vector()),i=Math.min(1,Math.max(0,t/this.squaredLength()));return Number.isNaN(i)?0:i}pointAt(e){const t=this.start,i=this.end;return e<=0?t.clone():e>=1?i.clone():t.lerp(i,e)}pointAtLength(e){const t=this.start,i=this.end;let a=!0;e<0&&(a=!1,e=-e);const d=this.length();if(e>=d)return a?i.clone():t.clone();const f=(a?e:d-e)/d;return this.pointAt(f)}divideAt(e){const t=this.pointAt(e);return[new zn(this.start,t),new zn(t,this.end)]}divideAtLength(e){const t=this.pointAtLength(e);return[new zn(this.start,t),new zn(t,this.end)]}containsPoint(e){const t=this.start,i=this.end;if(t.cross(e,i)!==0)return!1;const a=this.length();return!(new zn(t,e).length()>a||new zn(e,i).length()>a)}intersect(e,t){const i=e.intersectsWithLine(this,t);return i?Array.isArray(i)?i:[i]:null}intersectsWithLine(e){const t=new Oe(this.end.x-this.start.x,this.end.y-this.start.y),i=new Oe(e.end.x-e.start.x,e.end.y-e.start.y),a=t.x*i.y-t.y*i.x,d=new Oe(e.start.x-this.start.x,e.start.y-this.start.y),f=d.x*i.y-d.y*i.x,m=d.x*t.y-d.y*t.x;if(a===0||f*a<0||m*a<0)return null;if(a>0){if(f>a||m>a)return null}else if(f<a||m<a)return null;return new Oe(this.start.x+f*t.x/a,this.start.y+f*t.y/a)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(e){const t=Oe.clone(e),i=this.start,a=this.end;return((a.x-i.x)*(t.y-i.y)-(a.y-i.y)*(t.x-i.x))/this.length()}pointSquaredDistance(e,t){const i=Oe.create(e,t);return this.closestPoint(i).squaredDistance(i)}pointDistance(e,t){const i=Oe.create(e,t);return this.closestPoint(i).distance(i)}tangentAt(e){if(!this.isDifferentiable())return null;const t=this.start,i=this.end,a=this.pointAt(e),d=new zn(t,i);return d.translate(a.x-t.x,a.y-t.y),d}tangentAtLength(e){if(!this.isDifferentiable())return null;const t=this.start,i=this.end,a=this.pointAtLength(e),d=new zn(t,i);return d.translate(a.x-t.x,a.y-t.y),d}relativeCcw(e,t){const i=Oe.create(e,t);let a=i.x-this.start.x,d=i.y-this.start.y;const f=this.end.x-this.start.x,m=this.end.y-this.start.y;let y=a*m-d*f;return y===0&&(y=a*f+d*m,y>0&&(a-=f,d-=m,y=a*f+d*m,y<0&&(y=0))),y<0?-1:y>0?1:0}equals(e){return e!=null&&this.start.x===e.start.x&&this.start.y===e.start.y&&this.end.x===e.end.x&&this.end.y===e.end.y}clone(){return new zn(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}}(function(c){c.toStringTag=`X6.Geometry.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;try{if((i==null||i===c.toStringTag)&&Oe.isPoint(a.start)&&Oe.isPoint(a.end)&&typeof a.vector=="function"&&typeof a.bearing=="function"&&typeof a.parallel=="function"&&typeof a.intersect=="function")return!0}catch{return!1}return!1}c.isLine=e})(zn||(zn={}));class gl extends Ql{constructor(e,t,i,a){super(),this.x=e??0,this.y=t??0,this.a=i??0,this.b=a??0}get[Symbol.toStringTag](){return gl.toStringTag}get center(){return new Oe(this.x,this.y)}bbox(){return gn.fromEllipse(this)}getCenter(){return this.center}inflate(e,t){const i=e,a=t??e;return this.a+=2*i,this.b+=2*a,this}normalizedDistance(e,t){const i=Oe.create(e,t),a=i.x-this.x,d=i.y-this.y,f=this.a,m=this.b;return a*a/(f*f)+d*d/(m*m)}containsPoint(e,t){return this.normalizedDistance(e,t)<=1}intersectsWithLine(e){const t=[],i=this.a,a=this.b,d=e.start,f=e.end,m=e.vector(),y=d.diff(new Oe(this.x,this.y)),x=new Oe(m.x/(i*i),m.y/(a*a)),E=new Oe(y.x/(i*i),y.y/(a*a)),S=m.dot(x),T=m.dot(E),R=y.dot(E)-1,V=T*T-S*R;if(V<0)return null;if(V>0){const j=Math.sqrt(V),q=(-T-j)/S,ue=(-T+j)/S;if((q<0||q>1)&&(ue<0||ue>1))return null;q>=0&&q<=1&&t.push(d.lerp(f,q)),ue>=0&&ue<=1&&t.push(d.lerp(f,ue))}else{const j=-T/S;if(j>=0&&j<=1)t.push(d.lerp(f,j));else return null}return t}intersectsWithLineFromCenterToPoint(e,t=0){const i=Oe.clone(e);t&&i.rotate(t,this.getCenter());const a=i.x-this.x,d=i.y-this.y;let f;if(a===0)return f=this.bbox().getNearestPointToPoint(i),t?f.rotate(-t,this.getCenter()):f;const m=d/a,y=m*m,x=this.a*this.a,E=this.b*this.b;let S=Math.sqrt(1/(1/x+y/E));S=a<0?-S:S;const T=m*S;return f=new Oe(this.x+S,this.y+T),t?f.rotate(-t,this.getCenter()):f}tangentTheta(e){const t=Oe.clone(e),i=t.x,a=t.y,d=this.a,f=this.b,m=this.bbox().center,y=m.x,x=m.y,E=30,S=i>m.x+d/2,T=i<m.x-d/2;let R,V;return S||T?(V=i>m.x?a-E:a+E,R=d*d/(i-y)-d*d*(a-x)*(V-x)/(f*f*(i-y))+y):(R=a>m.y?i+E:i-E,V=f*f/(a-x)-f*f*(i-y)*(R-y)/(d*d*(a-x))+x),new Oe(R,V).theta(t)}scale(e,t){return this.a*=e,this.b*=t,this}rotate(e,t){const i=gn.fromEllipse(this);i.rotate(e,t);const a=gl.fromRect(i);return this.a=a.a,this.b=a.b,this.x=a.x,this.y=a.y,this}translate(e,t){const i=Oe.create(e,t);return this.x+=i.x,this.y+=i.y,this}equals(e){return e!=null&&e.x===this.x&&e.y===this.y&&e.a===this.a&&e.b===this.b}clone(){return new gl(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} ${this.b}`}}(function(c){c.toStringTag=`X6.Geometry.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.x=="number"&&typeof a.y=="number"&&typeof a.a=="number"&&typeof a.b=="number"&&typeof a.inflate=="function"&&typeof a.normalizedDistance=="function"}c.isEllipse=e})(gl||(gl={})),function(c){function e(a,d,f,m){return a==null||typeof a=="number"?new c(a,d,f,m):t(a)}c.create=e;function t(a){return c.isEllipse(a)?a.clone():Array.isArray(a)?new c(a[0],a[1],a[2],a[3]):new c(a.x,a.y,a.a,a.b)}c.parse=t;function i(a){const d=a.center;return new c(d.x,d.y,a.width/2,a.height/2)}c.fromRect=i}(gl||(gl={}));class Zo extends Ql{constructor(e){if(super(),e!=null){if(typeof e=="string")return Zo.parse(e);this.points=e.map(t=>Oe.create(t))}else this.points=[]}get[Symbol.toStringTag](){return Zo.toStringTag}get start(){return this.points.length===0?null:this.points[0]}get end(){return this.points.length===0?null:this.points[this.points.length-1]}scale(e,t,i=new Oe){return this.points.forEach(a=>a.scale(e,t,i)),this}rotate(e,t){return this.points.forEach(i=>i.rotate(e,t)),this}translate(e,t){const i=Oe.create(e,t);return this.points.forEach(a=>a.translate(i.x,i.y)),this}bbox(){if(this.points.length===0)return new gn;let e=1/0,t=-1/0,i=1/0,a=-1/0;const d=this.points;for(let f=0,m=d.length;f<m;f+=1){const y=d[f],x=y.x,E=y.y;x<e&&(e=x),x>t&&(t=x),E<i&&(i=E),E>a&&(a=E)}return new gn(e,i,t-e,a-i)}closestPoint(e){const t=this.closestPointLength(e);return this.pointAtLength(t)}closestPointLength(e){const t=this.points,i=t.length;if(i===0||i===1)return 0;let a=0,d=0,f=1/0;for(let m=0,y=i-1;m<y;m+=1){const x=new zn(t[m],t[m+1]),E=x.length(),S=x.closestPointNormalizedLength(e),R=x.pointAt(S).squaredDistance(e);R<f&&(f=R,d=a+S*E),a+=E}return d}closestPointNormalizedLength(e){const t=this.closestPointLength(e);if(t===0)return 0;const i=this.length();return i===0?0:t/i}closestPointTangent(e){const t=this.closestPointLength(e);return this.tangentAtLength(t)}containsPoint(e){if(this.points.length===0)return!1;const t=Oe.clone(e),i=t.x,a=t.y,d=this.points,f=d.length;let m=f-1,y=0;for(let x=0;x<f;x+=1){const E=d[m],S=d[x];if(t.equals(E))return!0;const T=new zn(E,S);if(T.containsPoint(e))return!0;if(a<=E.y&&a>S.y||a>E.y&&a<=S.y){const R=E.x-i>S.x-i?E.x-i:S.x-i;if(R>=0){const V=new Oe(i+R,a),j=new zn(e,V);T.intersectsWithLine(j)&&(y+=1)}}m=x}return y%2===1}intersectsWithLine(e){const t=[];for(let i=0,a=this.points.length-1;i<a;i+=1){const d=this.points[i],f=this.points[i+1],m=e.intersectsWithLine(new zn(d,f));m&&t.push(m)}return t.length>0?t:null}isDifferentiable(){for(let e=0,t=this.points.length-1;e<t;e+=1){const i=this.points[e],a=this.points[e+1];if(new zn(i,a).isDifferentiable())return!0}return!1}length(){let e=0;for(let t=0,i=this.points.length-1;t<i;t+=1){const a=this.points[t],d=this.points[t+1];e+=a.distance(d)}return e}pointAt(e){const t=this.points,i=t.length;if(i===0)return null;if(i===1||e<=0)return t[0].clone();if(e>=1)return t[i-1].clone();const d=this.length()*e;return this.pointAtLength(d)}pointAtLength(e){const t=this.points,i=t.length;if(i===0)return null;if(i===1)return t[0].clone();let a=!0;e<0&&(a=!1,e=-e);let d=0;for(let m=0,y=i-1;m<y;m+=1){const x=a?m:y-1-m,E=t[x],S=t[x+1],T=new zn(E,S),R=E.distance(S);if(e<=d+R)return T.pointAtLength((a?1:-1)*(e-d));d+=R}return(a?t[i-1]:t[0]).clone()}tangentAt(e){const i=this.points.length;if(i===0||i===1)return null;e<0&&(e=0),e>1&&(e=1);const d=this.length()*e;return this.tangentAtLength(d)}tangentAtLength(e){const t=this.points,i=t.length;if(i===0||i===1)return null;let a=!0;e<0&&(a=!1,e=-e);let d,f=0;for(let m=0,y=i-1;m<y;m+=1){const x=a?m:y-1-m,E=t[x],S=t[x+1],T=new zn(E,S),R=E.distance(S);if(T.isDifferentiable()){if(e<=f+R)return T.tangentAtLength((a?1:-1)*(e-f));d=T}f+=R}if(d){const m=a?1:0;return d.tangentAt(m)}return null}simplify(e={}){const t=this.points;if(t.length<3)return this;const i=e.threshold||0;let a=0;for(;t[a+2];){const d=a,f=a+1,m=a+2,y=t[d],x=t[f],E=t[m];new zn(y,E).closestPoint(x).distance(x)<=i?t.splice(f,1):a+=1}return this}toHull(){const e=this.points,t=e.length;if(t===0)return new Zo;let i=e[0];for(let T=1;T<t;T+=1)(e[T].y<i.y||e[T].y===i.y&&e[T].x>i.x)&&(i=e[T]);const a=[];for(let T=0;T<t;T+=1){let R=i.theta(e[T]);R===0&&(R=360),a.push([e[T],T,R])}if(a.sort((T,R)=>{let V=T[2]-R[2];return V===0&&(V=R[1]-T[1]),V}),a.length>2){const T=a[a.length-1];a.unshift(T)}const d={},f=[],m=T=>`${T[0].toString()}@${T[1]}`;for(;a.length!==0;){const T=a.pop(),R=T[0];if(d[m(T)])continue;let V=!1;for(;!V;)if(f.length<2)f.push(T),V=!0;else{const j=f.pop(),q=j[0],ue=f.pop(),be=ue[0],se=be.cross(q,R);if(se<0)f.push(ue),f.push(j),f.push(T),V=!0;else if(se===0){const He=q.angleBetween(be,R);Math.abs(He-180)<1e-10||q.equals(R)||be.equals(q)?(d[m(j)]=q,f.push(ue)):Math.abs((He+1)%360-1)<1e-10&&(f.push(ue),a.push(j))}else d[m(j)]=q,f.push(ue)}}f.length>2&&f.pop();let y,x=-1;for(let T=0,R=f.length;T<R;T+=1){const V=f[T][1];(y===void 0||V<y)&&(y=V,x=T)}let E=[];if(x>0){const T=f.slice(x),R=f.slice(0,x);E=T.concat(R)}else E=f;const S=[];for(let T=0,R=E.length;T<R;T+=1)S.push(E[T][0]);return new Zo(S)}equals(e){return e==null||e.points.length!==this.points.length?!1:e.points.every((t,i)=>t.equals(this.points[i]))}clone(){return new Zo(this.points.map(e=>e.clone()))}toJSON(){return this.points.map(e=>e.toJSON())}serialize(){return this.points.map(e=>`${e.x}, ${e.y}`).join(" ")}}(function(c){c.toStringTag=`X6.Geometry.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.toHull=="function"&&typeof a.simplify=="function"}c.isPolyline=e})(Zo||(Zo={})),function(c){function e(t){const i=t.trim();if(i==="")return new c;const a=[],d=i.split(/\s*,\s*|\s+/);for(let f=0,m=d.length;f<m;f+=2)a.push({x:+d[f],y:+d[f+1]});return new c(a)}c.parse=e}(Zo||(Zo={}));class Go extends Ql{constructor(e,t,i,a){super(),this.PRECISION=3,this.start=Oe.create(e),this.controlPoint1=Oe.create(t),this.controlPoint2=Oe.create(i),this.end=Oe.create(a)}get[Symbol.toStringTag](){return Go.toStringTag}bbox(){const e=this.start,t=this.controlPoint1,i=this.controlPoint2,a=this.end,d=e.x,f=e.y,m=t.x,y=t.y,x=i.x,E=i.y,S=a.x,T=a.y,R=[],V=[],j=[[],[]];let q,ue,be,se,Pe,He,ft,pt;for(let ur=0;ur<2;ur+=1){if(ur===0?(ue=6*d-12*m+6*x,q=-3*d+9*m-9*x+3*S,be=3*m-3*d):(ue=6*f-12*y+6*E,q=-3*f+9*y-9*E+3*T,be=3*y-3*f),Math.abs(q)<1e-12){if(Math.abs(ue)<1e-12)continue;se=-be/ue,se>0&&se<1&&V.push(se);continue}ft=ue*ue-4*be*q,pt=Math.sqrt(ft),!(ft<0)&&(Pe=(-ue+pt)/(2*q),Pe>0&&Pe<1&&V.push(Pe),He=(-ue-pt)/(2*q),He>0&&He<1&&V.push(He))}let kt,cn,Bt,Xt=V.length;const on=Xt;for(;Xt;)Xt-=1,se=V[Xt],Bt=1-se,kt=Bt*Bt*Bt*d+3*Bt*Bt*se*m+3*Bt*se*se*x+se*se*se*S,j[0][Xt]=kt,cn=Bt*Bt*Bt*f+3*Bt*Bt*se*y+3*Bt*se*se*E+se*se*se*T,j[1][Xt]=cn,R[Xt]={X:kt,Y:cn};V[on]=0,V[on+1]=1,R[on]={X:d,Y:f},R[on+1]={X:S,Y:T},j[0][on]=d,j[1][on]=f,j[0][on+1]=S,j[1][on+1]=T,V.length=on+2,j[0].length=on+2,j[1].length=on+2,R.length=on+2;const fr=Math.min.apply(null,j[0]),Cr=Math.min.apply(null,j[1]),St=Math.max.apply(null,j[0]),dn=Math.max.apply(null,j[1]);return new gn(fr,Cr,St-fr,dn-Cr)}closestPoint(e,t={}){return this.pointAtT(this.closestPointT(e,t))}closestPointLength(e,t={}){const i=this.getOptions(t);return this.lengthAtT(this.closestPointT(e,i),i)}closestPointNormalizedLength(e,t={}){const i=this.getOptions(t),a=this.closestPointLength(e,i);if(!a)return 0;const d=this.length(i);return d===0?0:a/d}closestPointT(e,t={}){const i=this.getPrecision(t),a=this.getDivisions(t),d=Math.pow(10,-i);let f=null,m=0,y=0,x=0,E=0,S=0,T=null;const R=a.length;let V=R>0?1/R:0;for(a.forEach((j,q)=>{const ue=j.start.distance(e),be=j.end.distance(e),se=ue+be;(T==null||se<T)&&(f=j,m=q*V,y=(q+1)*V,x=ue,E=be,T=se,S=j.endpointDistance())});;){const j=x?Math.abs(x-E)/x:0,q=E!=null?Math.abs(x-E)/E:0,ue=j<d||q<d,be=x?x<S*d:!0,se=E?E<S*d:!0;if(ue||(be||se))return x<=E?m:y;const He=f.divide(.5);V/=2;const ft=He[0].start.distance(e),pt=He[0].end.distance(e),kt=ft+pt,cn=He[1].start.distance(e),Bt=He[1].end.distance(e),Xt=cn+Bt;kt<=Xt?(f=He[0],y-=V,x=ft,E=pt):(f=He[1],m+=V,x=cn,E=Bt)}}closestPointTangent(e,t={}){return this.tangentAtT(this.closestPointT(e,t))}containsPoint(e,t={}){return this.toPolyline(t).containsPoint(e)}divideAt(e,t={}){if(e<=0)return this.divideAtT(0);if(e>=1)return this.divideAtT(1);const i=this.tAt(e,t);return this.divideAtT(i)}divideAtLength(e,t={}){const i=this.tAtLength(e,t);return this.divideAtT(i)}divide(e){return this.divideAtT(e)}divideAtT(e){const t=this.start,i=this.controlPoint1,a=this.controlPoint2,d=this.end;if(e<=0)return[new Go(t,t,t,t),new Go(t,i,a,d)];if(e>=1)return[new Go(t,i,a,d),new Go(d,d,d,d)];const f=this.getSkeletonPoints(e),m=f.startControlPoint1,y=f.startControlPoint2,x=f.divider,E=f.dividerControlPoint1,S=f.dividerControlPoint2;return[new Go(t,m,y,x),new Go(x,E,S,d)]}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(e){const t=this.start,i=this.controlPoint1,a=this.controlPoint2,d=this.end;if(e<=0)return{startControlPoint1:t.clone(),startControlPoint2:t.clone(),divider:t.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:a.clone()};if(e>=1)return{startControlPoint1:i.clone(),startControlPoint2:a.clone(),divider:d.clone(),dividerControlPoint1:d.clone(),dividerControlPoint2:d.clone()};const f=new zn(t,i).pointAt(e),m=new zn(i,a).pointAt(e),y=new zn(a,d).pointAt(e),x=new zn(f,m).pointAt(e),E=new zn(m,y).pointAt(e),S=new zn(x,E).pointAt(e);return{startControlPoint1:f,startControlPoint2:x,divider:S,dividerControlPoint1:E,dividerControlPoint2:y}}getSubdivisions(e={}){const t=this.getPrecision(e);let i=[new Go(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(t===0)return i;let a=this.endpointDistance();const d=Math.pow(10,-t);let f=0;for(;;){f+=1;const m=[];i.forEach(E=>{const S=E.divide(.5);m.push(S[0],S[1])});const y=m.reduce((E,S)=>E+S.endpointDistance(),0),x=y!==0?(y-a)/y:0;if(f>1&&x<d)return m;i=m,a=y}}length(e={}){return this.getDivisions(e).reduce((i,a)=>i+a.endpointDistance(),0)}lengthAtT(e,t={}){if(e<=0)return 0;const i=t.precision===void 0?this.PRECISION:t.precision;return this.divide(e)[0].length({precision:i})}pointAt(e,t={}){if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();const i=this.tAt(e,t);return this.pointAtT(i)}pointAtLength(e,t={}){const i=this.tAtLength(e,t);return this.pointAtT(i)}pointAtT(e){return e<=0?this.start.clone():e>=1?this.end.clone():this.getSkeletonPoints(e).divider}isDifferentiable(){const e=this.start,t=this.controlPoint1,i=this.controlPoint2,a=this.end;return!(e.equals(t)&&t.equals(i)&&i.equals(a))}tangentAt(e,t={}){if(!this.isDifferentiable())return null;e<0?e=0:e>1&&(e=1);const i=this.tAt(e,t);return this.tangentAtT(i)}tangentAtLength(e,t={}){if(!this.isDifferentiable())return null;const i=this.tAtLength(e,t);return this.tangentAtT(i)}tangentAtT(e){if(!this.isDifferentiable())return null;e<0&&(e=0),e>1&&(e=1);const t=this.getSkeletonPoints(e),i=t.startControlPoint2,a=t.dividerControlPoint1,d=t.divider,f=new zn(i,a);return f.translate(d.x-i.x,d.y-i.y),f}getPrecision(e={}){return e.precision==null?this.PRECISION:e.precision}getDivisions(e={}){if(e.subdivisions!=null)return e.subdivisions;const t=this.getPrecision(e);return this.getSubdivisions({precision:t})}getOptions(e={}){const t=this.getPrecision(e),i=this.getDivisions(e);return{precision:t,subdivisions:i}}tAt(e,t={}){if(e<=0)return 0;if(e>=1)return 1;const i=this.getOptions(t),d=this.length(i)*e;return this.tAtLength(d,i)}tAtLength(e,t={}){let i=!0;e<0&&(i=!1,e=-e);const a=this.getPrecision(t),d=this.getDivisions(t),f={precision:a,subdivisions:d};let m=null,y,x,E=0,S=0,T=0;const R=d.length;let V=R>0?1/R:0;for(let ue=0;ue<R;ue+=1){const be=i?ue:R-1-ue,se=d[ue],Pe=se.endpointDistance();if(e<=T+Pe){m=se,y=be*V,x=(be+1)*V,E=i?e-T:Pe+T-e,S=i?Pe+T-e:e-T;break}T+=Pe}if(m==null)return i?1:0;const j=this.length(f),q=Math.pow(10,-a);for(;;){let ue;if(ue=j!==0?E/j:0,ue<q)return y;if(ue=j!==0?S/j:0,ue<q)return x;let be,se;const Pe=m.divide(.5);V/=2;const He=Pe[0].endpointDistance(),ft=Pe[1].endpointDistance();E<=He?(m=Pe[0],x-=V,be=E,se=He-be):(m=Pe[1],y+=V,be=E-He,se=ft-be),E=be,S=se}}toPoints(e={}){const t=this.getDivisions(e),i=[t[0].start.clone()];return t.forEach(a=>i.push(a.end.clone())),i}toPolyline(e={}){return new Zo(this.toPoints(e))}scale(e,t,i){return this.start.scale(e,t,i),this.controlPoint1.scale(e,t,i),this.controlPoint2.scale(e,t,i),this.end.scale(e,t,i),this}rotate(e,t){return this.start.rotate(e,t),this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}translate(e,t){return typeof e=="number"?(this.start.translate(e,t),this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}equals(e){return e!=null&&this.start.equals(e.start)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)&&this.end.equals(e.end)}clone(){return new Go(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}(function(c){c.toStringTag=`X6.Geometry.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;try{if((i==null||i===c.toStringTag)&&Oe.isPoint(a.start)&&Oe.isPoint(a.controlPoint1)&&Oe.isPoint(a.controlPoint2)&&Oe.isPoint(a.end)&&typeof a.toPoints=="function"&&typeof a.toPolyline=="function")return!0}catch{return!1}return!1}c.isCurve=e})(Go||(Go={})),function(c){function e(a){const d=a.length,f=[],m=[];let y=2;f[0]=a[0]/y;for(let x=1;x<d;x+=1)m[x]=1/y,y=(x<d-1?4:3.5)-m[x],f[x]=(a[x]-f[x-1])/y;for(let x=1;x<d;x+=1)f[d-x-1]-=m[d-x]*f[d-x];return f}function t(a){const d=a.map(T=>Oe.clone(T)),f=[],m=[],y=d.length-1;if(y===1)return f[0]=new Oe((2*d[0].x+d[1].x)/3,(2*d[0].y+d[1].y)/3),m[0]=new Oe(2*f[0].x-d[0].x,2*f[0].y-d[0].y),[f,m];const x=[];for(let T=1;T<y-1;T+=1)x[T]=4*d[T].x+2*d[T+1].x;x[0]=d[0].x+2*d[1].x,x[y-1]=(8*d[y-1].x+d[y].x)/2;const E=e(x);for(let T=1;T<y-1;T+=1)x[T]=4*d[T].y+2*d[T+1].y;x[0]=d[0].y+2*d[1].y,x[y-1]=(8*d[y-1].y+d[y].y)/2;const S=e(x);for(let T=0;T<y;T+=1)f.push(new Oe(E[T],S[T])),T<y-1?m.push(new Oe(2*d[T+1].x-E[T+1],2*d[T+1].y-S[T+1])):m.push(new Oe((d[y].x+E[y-1])/2,(d[y].y+S[y-1])/2));return[f,m]}function i(a){if(a==null||Array.isArray(a)&&a.length<2)throw new Error("At least 2 points are required");const d=t(a),f=[];for(let m=0,y=d[0].length;m<y;m+=1){const x=new Oe(d[0][m].x,d[0][m].y),E=new Oe(d[1][m].x,d[1][m].y);f.push(new c(a[m],x,E,a[m+1]))}return f}c.throughPoints=i}(Go||(Go={}));class Pa extends Ql{constructor(){super(...arguments),this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(this.previousSegment==null)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(e,t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(e);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(e,t){if(e<=0)return 0;const i=this.length();return e>=1?i:i*e}divideAtT(e){if(this.divideAt)return this.divideAt(e);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(e){if(this.pointAt)return this.pointAt(e);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(e){if(this.tangentAt)return this.tangentAt(e);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}class lo extends Pa{constructor(e,t){super(),zn.isLine(e)?this.endPoint=e.end.clone().round(2):this.endPoint=Oe.create(e,t).round(2)}get type(){return"L"}get line(){return new zn(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(e){return this.line.closestPoint(e)}closestPointLength(e){return this.line.closestPointLength(e)}closestPointNormalizedLength(e){return this.line.closestPointNormalizedLength(e)}closestPointTangent(e){return this.line.closestPointTangent(e)}length(){return this.line.length()}divideAt(e){const t=this.line.divideAt(e);return[new lo(t[0]),new lo(t[1])]}divideAtLength(e){const t=this.line.divideAtLength(e);return[new lo(t[0]),new lo(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.line.pointAt(e)}pointAtLength(e){return this.line.pointAtLength(e)}tangentAt(e){return this.line.tangentAt(e)}tangentAtLength(e){return this.line.tangentAtLength(e)}isDifferentiable(){return this.previousSegment==null?!1:!this.start.equals(this.end)}clone(){return new lo(this.end)}scale(e,t,i){return this.end.scale(e,t,i),this}rotate(e,t){return this.end.rotate(e,t),this}translate(e,t){return typeof e=="number"?this.end.translate(e,t):this.end.translate(e),this}equals(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){const e=this.end;return`${this.type} ${e.x} ${e.y}`}}(function(c){function e(...t){const i=t.length,a=t[0];if(zn.isLine(a))return new c(a);if(Oe.isPointLike(a))return i===1?new c(a):t.map(f=>new c(f));if(i===2)return new c(+t[0],+t[1]);const d=[];for(let f=0;f<i;f+=2){const m=+t[f],y=+t[f+1];d.push(new c(m,y))}return d}c.create=e})(lo||(lo={}));class ec extends Pa{get end(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}get type(){return"Z"}get line(){return new zn(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(e){return this.line.closestPoint(e)}closestPointLength(e){return this.line.closestPointLength(e)}closestPointNormalizedLength(e){return this.line.closestPointNormalizedLength(e)}closestPointTangent(e){return this.line.closestPointTangent(e)}length(){return this.line.length()}divideAt(e){const t=this.line.divideAt(e);return[t[1].isDifferentiable()?new lo(t[0]):this.clone(),new lo(t[1])]}divideAtLength(e){const t=this.line.divideAtLength(e);return[t[1].isDifferentiable()?new lo(t[0]):this.clone(),new lo(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.line.pointAt(e)}pointAtLength(e){return this.line.pointAtLength(e)}tangentAt(e){return this.line.tangentAt(e)}tangentAtLength(e){return this.line.tangentAtLength(e)}isDifferentiable(){return!this.previousSegment||!this.subpathStartSegment?!1:!this.start.equals(this.end)}scale(){return this}rotate(){return this}translate(){return this}equals(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}clone(){return new ec}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}(function(c){function e(){return new c}c.create=e})(ec||(ec={}));class tc extends Pa{constructor(e,t){super(),this.isVisible=!1,this.isSubpathStart=!0,zn.isLine(e)||Go.isCurve(e)?this.endPoint=e.end.clone().round(2):this.endPoint=Oe.create(e,t).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(e,t,i){return this.end.scale(e,t,i),this}rotate(e,t){return this.end.rotate(e,t),this}translate(e,t){return typeof e=="number"?this.end.translate(e,t):this.end.translate(e),this}clone(){return new tc(this.end)}equals(e){return this.type===e.type&&this.end.equals(e.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){const e=this.end;return`${this.type} ${e.x} ${e.y}`}}(function(c){function e(...t){const i=t.length,a=t[0];if(zn.isLine(a))return new c(a);if(Go.isCurve(a))return new c(a);if(Oe.isPointLike(a)){if(i===1)return new c(a);const f=[];for(let m=0;m<i;m+=1)m===0?f.push(new c(t[m])):f.push(new lo(t[m]));return f}if(i===2)return new c(+t[0],+t[1]);const d=[];for(let f=0;f<i;f+=2){const m=+t[f],y=+t[f+1];f===0?d.push(new c(m,y)):d.push(new lo(m,y))}return d}c.create=e})(tc||(tc={}));class ml extends Pa{constructor(e,t,i,a,d,f){super(),Go.isCurve(e)?(this.controlPoint1=e.controlPoint1.clone().round(2),this.controlPoint2=e.controlPoint2.clone().round(2),this.endPoint=e.end.clone().round(2)):typeof e=="number"?(this.controlPoint1=new Oe(e,t).round(2),this.controlPoint2=new Oe(i,a).round(2),this.endPoint=new Oe(d,f).round(2)):(this.controlPoint1=Oe.create(e).round(2),this.controlPoint2=Oe.create(t).round(2),this.endPoint=Oe.create(i).round(2))}get type(){return"C"}get curve(){return new Go(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(e){return this.curve.closestPoint(e)}closestPointLength(e){return this.curve.closestPointLength(e)}closestPointNormalizedLength(e){return this.curve.closestPointNormalizedLength(e)}closestPointTangent(e){return this.curve.closestPointTangent(e)}length(){return this.curve.length()}divideAt(e,t={}){const i=this.curve.divideAt(e,t);return[new ml(i[0]),new ml(i[1])]}divideAtLength(e,t={}){const i=this.curve.divideAtLength(e,t);return[new ml(i[0]),new ml(i[1])]}divideAtT(e){const t=this.curve.divideAtT(e);return[new ml(t[0]),new ml(t[1])]}getSubdivisions(){return[]}pointAt(e){return this.curve.pointAt(e)}pointAtLength(e){return this.curve.pointAtLength(e)}tangentAt(e){return this.curve.tangentAt(e)}tangentAtLength(e){return this.curve.tangentAtLength(e)}isDifferentiable(){if(!this.previousSegment)return!1;const e=this.start,t=this.controlPoint1,i=this.controlPoint2,a=this.end;return!(e.equals(t)&&t.equals(i)&&i.equals(a))}scale(e,t,i){return this.controlPoint1.scale(e,t,i),this.controlPoint2.scale(e,t,i),this.end.scale(e,t,i),this}rotate(e,t){return this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}translate(e,t){return typeof e=="number"?(this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}equals(e){return this.start.equals(e.start)&&this.end.equals(e.end)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)}clone(){return new ml(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){const e=this.controlPoint1,t=this.controlPoint2,i=this.end;return[this.type,e.x,e.y,t.x,t.y,i.x,i.y].join(" ")}}(function(c){function e(...t){const i=t.length,a=t[0];if(Go.isCurve(a))return new c(a);if(Oe.isPointLike(a)){if(i===3)return new c(t[0],t[1],t[2]);const f=[];for(let m=0;m<i;m+=3)f.push(new c(t[m],t[m+1],t[m+2]));return f}if(i===6)return new c(t[0],t[1],t[2],t[3],t[4],t[5]);const d=[];for(let f=0;f<i;f+=6)d.push(new c(t[f],t[f+1],t[f+2],t[f+3],t[f+4],t[f+5]));return d}c.create=e})(ml||(ml={}));function jm(c,e,t){return{x:c*Math.cos(t)-e*Math.sin(t),y:c*Math.sin(t)+e*Math.cos(t)}}function wv(c,e,t,i,a,d){const f=.3333333333333333,m=2/3;return[f*c+m*t,f*e+m*i,f*a+m*t,f*d+m*i,a,d]}function pg(c,e,t,i,a,d,f,m,y,x){const E=Math.PI*120/180,S=Math.PI/180*(+a||0);let T=[],R,V,j,q,ue;if(x)V=x[0],j=x[1],q=x[2],ue=x[3];else{R=jm(c,e,-S),c=R.x,e=R.y,R=jm(m,y,-S),m=R.x,y=R.y;const Cr=(c-m)/2,St=(e-y)/2;let dn=Cr*Cr/(t*t)+St*St/(i*i);dn>1&&(dn=Math.sqrt(dn),t=dn*t,i=dn*i);const ur=t*t,Ni=i*i,Gi=(d===f?-1:1)*Math.sqrt(Math.abs((ur*Ni-ur*St*St-Ni*Cr*Cr)/(ur*St*St+Ni*Cr*Cr)));q=Gi*t*St/i+(c+m)/2,ue=Gi*-i*Cr/t+(e+y)/2,V=Math.asin((e-ue)/i),j=Math.asin((y-ue)/i),V=c<q?Math.PI-V:V,j=m<q?Math.PI-j:j,V<0&&(V=Math.PI*2+V),j<0&&(j=Math.PI*2+j),f&&V>j&&(V-=Math.PI*2),!f&&j>V&&(j-=Math.PI*2)}let be=j-V;if(Math.abs(be)>E){const Cr=j,St=m,dn=y;j=V+E*(f&&j>V?1:-1),m=q+t*Math.cos(j),y=ue+i*Math.sin(j),T=pg(m,y,t,i,a,0,f,St,dn,[j,Cr,q,ue])}be=j-V;const se=Math.cos(V),Pe=Math.sin(V),He=Math.cos(j),ft=Math.sin(j),pt=Math.tan(be/4),kt=4/3*(t*pt),cn=4/3*(i*pt),Bt=[c,e],Xt=[c+kt*Pe,e-cn*se],on=[m+kt*ft,y-cn*He],fr=[m,y];if(Xt[0]=2*Bt[0]-Xt[0],Xt[1]=2*Bt[1]-Xt[1],x)return[Xt,on,fr].concat(T);{T=[Xt,on,fr].concat(T).join().split(",");const Cr=[],St=T.length;for(let dn=0;dn<St;dn+=1)Cr[dn]=dn%2?jm(+T[dn-1],+T[dn],S).y:jm(+T[dn],+T[dn+1],S).x;return Cr}}function Hm(c){if(!c)return null;const e=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,t=new RegExp(`([a-z])[${e},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${e}]*,?[${e}]*)+)`,"ig"),i=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${e}]*,?[${e}]*`,"ig"),a={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];return c.replace(t,(f,m,y)=>{const x=[];let E=m.toLowerCase();y.replace(i,(T,R)=>(R&&x.push(+R),T)),E==="m"&&x.length>2&&(d.push([m,...x.splice(0,2)]),E="l",m=m==="m"?"l":"L");const S=a[E];for(;x.length>=S&&(d.push([m,...x.splice(0,S)]),!!S););return f}),d}function Qf(c){const e=Hm(c);if(!e||!e.length)return[["M",0,0]];let t=0,i=0,a=0,d=0;const f=[];for(let m=0,y=e.length;m<y;m+=1){const x=[];f.push(x);const E=e[m],S=E[0];if(S!==S.toUpperCase())switch(x[0]=S.toUpperCase(),x[0]){case"A":x[1]=E[1],x[2]=E[2],x[3]=E[3],x[4]=E[4],x[5]=E[5],x[6]=+E[6]+t,x[7]=+E[7]+i;break;case"V":x[1]=+E[1]+i;break;case"H":x[1]=+E[1]+t;break;case"M":a=+E[1]+t,d=+E[2]+i;for(let T=1,R=E.length;T<R;T+=1)x[T]=+E[T]+(T%2?t:i);break;default:for(let T=1,R=E.length;T<R;T+=1)x[T]=+E[T]+(T%2?t:i);break}else for(let T=0,R=E.length;T<R;T+=1)x[T]=E[T];switch(x[0]){case"Z":t=+a,i=+d;break;case"H":t=x[1];break;case"V":i=x[1];break;case"M":a=x[x.length-2],d=x[x.length-1],t=x[x.length-2],i=x[x.length-1];break;default:t=x[x.length-2],i=x[x.length-1];break}}return f}function hw(c){const e=Qf(c),t={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function i(y,x,E){let S,T;if(!y)return["C",x.x,x.y,x.x,x.y,x.x,x.y];switch(y[0]in{T:1,Q:1}||(x.qx=null,x.qy=null),y[0]){case"M":x.X=y[1],x.Y=y[2];break;case"A":return parseFloat(y[1])===0||parseFloat(y[2])===0?["L",y[6],y[7]]:["C"].concat(pg.apply(0,[x.x,x.y].concat(y.slice(1))));case"S":return E==="C"||E==="S"?(S=x.x*2-x.bx,T=x.y*2-x.by):(S=x.x,T=x.y),["C",S,T].concat(y.slice(1));case"T":return E==="Q"||E==="T"?(x.qx=x.x*2-x.qx,x.qy=x.y*2-x.qy):(x.qx=x.x,x.qy=x.y),["C"].concat(wv(x.x,x.y,x.qx,x.qy,y[1],y[2]));case"Q":return x.qx=y[1],x.qy=y[2],["C"].concat(wv(x.x,x.y,y[1],y[2],y[3],y[4]));case"H":return["L"].concat(y[1],x.y);case"V":return["L"].concat(x.x,y[1]);case"L":break;case"Z":break;default:break}return y}function a(y,x){if(y[x].length>7){y[x].shift();const E=y[x];for(;E.length;)d[x]="A",x+=1,y.splice(x,0,["C"].concat(E.splice(0,6)));y.splice(x,1),m=e.length}}const d=[];let f="",m=e.length;for(let y=0;y<m;y+=1){let x="";e[y]&&(x=e[y][0]),x!=="C"&&(d[y]=x,y>0&&(f=d[y-1])),e[y]=i(e[y],t,f),d[y]!=="A"&&x==="C"&&(d[y]="C"),a(e,y);const E=e[y],S=E.length;t.x=E[S-2],t.y=E[S-1],t.bx=parseFloat(E[S-4])||t.x,t.by=parseFloat(E[S-3])||t.y}return(!e[0][0]||e[0][0]!=="M")&&e.unshift(["M",0,0]),e}function fw(c){return hw(c).map(e=>e.map(t=>typeof t=="string"?t:Fc(t,2))).join(",").split(",").join(" ")}const pw=new RegExp("^[\\s\\dLMCZz,.]*$");function gw(c){return typeof c!="string"?!1:pw.test(c)}function Ev(c,e){return(c%e+e)%e}function mw(c,e,t,i,a){const d=[],f=c[c.length-1],m=e!=null&&e>0,y=e||0;if(i&&m){c=c.slice();const S=c[0],T=new Oe(f.x+(S.x-f.x)/2,f.y+(S.y-f.y)/2);c.splice(0,0,T)}let x=c[0],E=1;for(t?d.push("M",x.x,x.y):d.push("L",x.x,x.y);E<(i?c.length:c.length-1);){let S=c[Ev(E,c.length)],T=x.x-S.x,R=x.y-S.y;if(m&&(T!==0||R!==0)&&(a==null||a.indexOf(E-1)<0)){let V=Math.sqrt(T*T+R*R);const j=T*Math.min(y,V/2)/V,q=R*Math.min(y,V/2)/V,ue=S.x+j,be=S.y+q;d.push("L",ue,be);let se=c[Ev(E+1,c.length)];for(;E<c.length-2&&Math.round(se.x-S.x)===0&&Math.round(se.y-S.y)===0;)se=c[Ev(E+2,c.length)],E+=1;T=se.x-S.x,R=se.y-S.y,V=Math.max(1,Math.sqrt(T*T+R*R));const Pe=T*Math.min(y,V/2)/V,He=R*Math.min(y,V/2)/V,ft=S.x+Pe,pt=S.y+He;d.push("Q",S.x,S.y,ft,pt),S=new Oe(ft,pt)}else d.push("L",S.x,S.y);x=S,E+=1}return i?d.push("Z"):d.push("L",f.x,f.y),d.map(S=>typeof S=="string"?S:+S.toFixed(3)).join(" ")}function Wb(c,e={}){const t=[];return c&&c.length&&c.forEach(i=>{Array.isArray(i)?t.push({x:i[0],y:i[1]}):t.push({x:i.x,y:i.y})}),mw(t,e.round,e.initialMove==null||e.initialMove,e.close,e.exclude)}function $m(c,e,t,i,a=0,d=0,f=0,m,y){if(t===0||i===0)return[];m-=c,y-=e,t=Math.abs(t),i=Math.abs(i);const x=-m/2,E=-y/2,S=Math.cos(a*Math.PI/180),T=Math.sin(a*Math.PI/180),R=S*x+T*E,V=-1*T*x+S*E,j=R*R,q=V*V,ue=t*t,be=i*i,se=j/ue+q/be;let Pe;if(se>1)t=Math.sqrt(se)*t,i=Math.sqrt(se)*i,Pe=0;else{let Na=1;d===f&&(Na=-1),Pe=Na*Math.sqrt((ue*be-ue*q-be*j)/(ue*q+be*j))}const He=Pe*t*V/i,ft=-1*Pe*i*R/t,pt=S*He-T*ft+m/2,kt=T*He+S*ft+y/2;let cn=Math.atan2((V-ft)/i,(R-He)/t)-Math.atan2(0,1),Bt=cn>=0?cn:2*Math.PI+cn;cn=Math.atan2((-V-ft)/i,(-R-He)/t)-Math.atan2((V-ft)/i,(R-He)/t);let Xt=cn>=0?cn:2*Math.PI+cn;f===0&&Xt>0?Xt-=2*Math.PI:f!==0&&Xt<0&&(Xt+=2*Math.PI);const on=Xt*2/Math.PI,fr=Math.ceil(on<0?-1*on:on),Cr=Xt/fr,St=8/3*Math.sin(Cr/4)*Math.sin(Cr/4)/Math.sin(Cr/2),dn=S*t,ur=S*i,Ni=T*t,Gi=T*i;let cs=Math.cos(Bt),_o=Math.sin(Bt),xp=-St*(dn*_o+Gi*cs),E0=-St*(Ni*_o-ur*cs),Vd=0,zg=0;const $c=[];for(let Na=0;Na<fr;Na+=1){Bt+=Cr,cs=Math.cos(Bt),_o=Math.sin(Bt),Vd=dn*cs-Gi*_o+pt,zg=Ni*cs+ur*_o+kt;const cC=-St*(dn*_o+Gi*cs),uC=-St*(Ni*_o-ur*cs),Cp=Na*6;$c[Cp]=Number(xp+c),$c[Cp+1]=Number(E0+e),$c[Cp+2]=Number(Vd-cC+c),$c[Cp+3]=Number(zg-uC+e),$c[Cp+4]=Number(Vd+c),$c[Cp+5]=Number(zg+e),xp=Vd+cC,E0=zg+uC}return $c.map(Na=>+Na.toFixed(2))}function vw(c,e,t,i,a=0,d=0,f=0,m,y){const x=[],E=$m(c,e,t,i,a,d,f,m,y);if(E!=null)for(let S=0,T=E.length;S<T;S+=6)x.push("C",E[S],E[S+1],E[S+2],E[S+3],E[S+4],E[S+5]);return x.join(" ")}class sr extends Ql{constructor(e){if(super(),this.PRECISION=3,this.segments=[],Array.isArray(e))if(zn.isLine(e[0])||Go.isCurve(e[0])){let t=null;e.forEach((a,d)=>{d===0&&this.appendSegment(sr.createSegment("M",a.start)),t!=null&&!t.end.equals(a.start)&&this.appendSegment(sr.createSegment("M",a.start)),zn.isLine(a)?this.appendSegment(sr.createSegment("L",a.end)):Go.isCurve(a)&&this.appendSegment(sr.createSegment("C",a.controlPoint1,a.controlPoint2,a.end)),t=a})}else e.forEach(i=>{i.isSegment&&this.appendSegment(i)});else e!=null&&(zn.isLine(e)?(this.appendSegment(sr.createSegment("M",e.start)),this.appendSegment(sr.createSegment("L",e.end))):Go.isCurve(e)?(this.appendSegment(sr.createSegment("M",e.start)),this.appendSegment(sr.createSegment("C",e.controlPoint1,e.controlPoint2,e.end))):Zo.isPolyline(e)?e.points&&e.points.length&&e.points.forEach((t,i)=>{const a=i===0?sr.createSegment("M",t):sr.createSegment("L",t);this.appendSegment(a)}):e.isSegment&&this.appendSegment(e))}get[Symbol.toStringTag](){return sr.toStringTag}get start(){const e=this.segments,t=e.length;if(t===0)return null;for(let i=0;i<t;i+=1){const a=e[i];if(a.isVisible)return a.start}return e[t-1].end}get end(){const e=this.segments,t=e.length;if(t===0)return null;for(let i=t-1;i>=0;i-=1){const a=e[i];if(a.isVisible)return a.end}return e[t-1].end}moveTo(...e){return this.appendSegment(tc.create.call(null,...e))}lineTo(...e){return this.appendSegment(lo.create.call(null,...e))}curveTo(...e){return this.appendSegment(ml.create.call(null,...e))}arcTo(e,t,i,a,d,f,m){const y=this.end||new Oe,x=typeof f=="number"?$m(y.x,y.y,e,t,i,a,d,f,m):$m(y.x,y.y,e,t,i,a,d,f.x,f.y);if(x!=null)for(let E=0,S=x.length;E<S;E+=6)this.curveTo(x[E],x[E+1],x[E+2],x[E+3],x[E+4],x[E+5]);return this}quadTo(e,t,i,a){const d=this.end||new Oe,f=["M",d.x,d.y];if(typeof e=="number")f.push("Q",e,t,i,a);else{const y=t;f.push("Q",e.x,e.y,y.x,y.y)}const m=sr.parse(f.join(" "));return this.appendSegment(m.segments.slice(1)),this}close(){return this.appendSegment(ec.create())}drawPoints(e,t={}){const i=Wb(e,t),a=sr.parse(i);a&&a.segments&&this.appendSegment(a.segments)}bbox(){const e=this.segments,t=e.length;if(t===0)return null;let i;for(let d=0;d<t;d+=1){const f=e[d];if(f.isVisible){const m=f.bbox();m!=null&&(i=i?i.union(m):m)}}if(i!=null)return i;const a=e[t-1];return new gn(a.end.x,a.end.y,0,0)}appendSegment(e){const t=this.segments.length;let i=t!==0?this.segments[t-1]:null,a;const d=null;if(Array.isArray(e))for(let f=0,m=e.length;f<m;f+=1){const y=e[f];a=this.prepareSegment(y,i,d),this.segments.push(a),i=a}else e!=null&&e.isSegment&&(a=this.prepareSegment(e,i,d),this.segments.push(a));return this}insertSegment(e,t){const i=this.segments.length;if(e<0&&(e=i+e+1),e>i||e<0)throw new Error("Index out of range.");let a,d=null,f=null;if(i!==0&&(e>=1?(d=this.segments[e-1],f=d.nextSegment):(d=null,f=this.segments[0])),!Array.isArray(t))a=this.prepareSegment(t,d,f),this.segments.splice(e,0,a);else for(let m=0,y=t.length;m<y;m+=1){const x=t[m];a=this.prepareSegment(x,d,f),this.segments.splice(e+m,0,a),d=a}return this}removeSegment(e){const t=this.fixIndex(e),i=this.segments.splice(t,1)[0],a=i.previousSegment,d=i.nextSegment;return a&&(a.nextSegment=d),d&&(d.previousSegment=a),i.isSubpathStart&&d&&this.updateSubpathStartSegment(d),i}replaceSegment(e,t){const i=this.fixIndex(e);let a;const d=this.segments[i];let f=d.previousSegment;const m=d.nextSegment;let y=d.isSubpathStart;if(!Array.isArray(t))a=this.prepareSegment(t,f,m),this.segments.splice(i,1,a),y&&a.isSubpathStart&&(y=!1);else{this.segments.splice(e,1);for(let x=0,E=t.length;x<E;x+=1){const S=t[x];a=this.prepareSegment(S,f,m),this.segments.splice(e+x,0,a),f=a,y&&a.isSubpathStart&&(y=!1)}}y&&m&&this.updateSubpathStartSegment(m)}getSegment(e){const t=this.fixIndex(e);return this.segments[t]}fixIndex(e){const t=this.segments.length;if(t===0)throw new Error("Path has no segments.");let i=e;for(;i<0;)i=t+i;if(i>=t||i<0)throw new Error("Index out of range.");return i}segmentAt(e,t={}){const i=this.segmentIndexAt(e,t);return i?this.getSegment(i):null}segmentAtLength(e,t={}){const i=this.segmentIndexAtLength(e,t);return i?this.getSegment(i):null}segmentIndexAt(e,t={}){if(this.segments.length===0)return null;const i=ks(e,0,1),a=this.getOptions(t),f=this.length(a)*i;return this.segmentIndexAtLength(f,a)}segmentIndexAtLength(e,t={}){const i=this.segments.length;if(i===0)return null;let a=!0;e<0&&(a=!1,e=-e);const d=this.getPrecision(t),f=this.getSubdivisions(t);let m=0,y=null;for(let x=0;x<i;x+=1){const E=a?x:i-1-x,S=this.segments[E],T=f[E],R=S.length({precision:d,subdivisions:T});if(S.isVisible){if(e<=m+R)return E;y=E}m+=R}return y}getSegmentSubdivisions(e={}){const t=this.getPrecision(e),i=[];for(let a=0,d=this.segments.length;a<d;a+=1){const m=this.segments[a].getSubdivisions({precision:t});i.push(m)}return i}updateSubpathStartSegment(e){let t=e.previousSegment,i=e;for(;i&&!i.isSubpathStart;)t!=null?i.subpathStartSegment=t.subpathStartSegment:i.subpathStartSegment=null,t=i,i=i.nextSegment}prepareSegment(e,t,i){e.previousSegment=t,e.nextSegment=i,t!=null&&(t.nextSegment=e),i!=null&&(i.previousSegment=e);let a=e;return e.isSubpathStart&&(e.subpathStartSegment=e,a=i),a!=null&&this.updateSubpathStartSegment(a),e}closestPoint(e,t={}){const i=this.closestPointT(e,t);return i?this.pointAtT(i):null}closestPointLength(e,t={}){const i=this.getOptions(t),a=this.closestPointT(e,i);return a?this.lengthAtT(a,i):0}closestPointNormalizedLength(e,t={}){const i=this.getOptions(t),a=this.closestPointLength(e,i);if(a===0)return 0;const d=this.length(i);return d===0?0:a/d}closestPointT(e,t={}){if(this.segments.length===0)return null;const i=this.getPrecision(t),a=this.getSubdivisions(t);let d,f=1/0;for(let m=0,y=this.segments.length;m<y;m+=1){const x=this.segments[m],E=a[m];if(x.isVisible){const S=x.closestPointT(e,{precision:i,subdivisions:E}),T=x.pointAtT(S),R=Cv(T,e);R<f&&(d={segmentIndex:m,value:S},f=R)}}return d||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(e,t={}){if(this.segments.length===0)return null;const i=this.getPrecision(t),a=this.getSubdivisions(t);let d,f=1/0;for(let m=0,y=this.segments.length;m<y;m+=1){const x=this.segments[m],E=a[m];if(x.isDifferentiable()){const S=x.closestPointT(e,{precision:i,subdivisions:E}),T=x.pointAtT(S),R=Cv(T,e);R<f&&(d=x.tangentAtT(S),f=R)}}return d||null}containsPoint(e,t={}){const i=this.toPolylines(t);if(!i)return!1;let a=0;for(let d=0,f=i.length;d<f;d+=1)i[d].containsPoint(e)&&(a+=1);return a%2===1}pointAt(e,t={}){if(this.segments.length===0)return null;if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();const i=this.getOptions(t),d=this.length(i)*e;return this.pointAtLength(d,i)}pointAtLength(e,t={}){if(this.segments.length===0)return null;if(e===0)return this.start.clone();let i=!0;e<0&&(i=!1,e=-e);const a=this.getPrecision(t),d=this.getSubdivisions(t);let f,m=0;for(let x=0,E=this.segments.length;x<E;x+=1){const S=i?x:E-1-x,T=this.segments[S],R=d[S],V=T.length({precision:a,subdivisions:R});if(T.isVisible){if(e<=m+V)return T.pointAtLength((i?1:-1)*(e-m),{precision:a,subdivisions:R});f=T}m+=V}return f?i?f.end:f.start:this.segments[this.segments.length-1].end.clone()}pointAtT(e){const t=this.segments,i=t.length;if(i===0)return null;const a=e.segmentIndex;if(a<0)return t[0].pointAtT(0);if(a>=i)return t[i-1].pointAtT(1);const d=ks(e.value,0,1);return t[a].pointAtT(d)}divideAt(e,t={}){if(this.segments.length===0)return null;const i=ks(e,0,1),a=this.getOptions(t),f=this.length(a)*i;return this.divideAtLength(f,a)}divideAtLength(e,t={}){if(this.segments.length===0)return null;let i=!0;e<0&&(i=!1,e=-e);const a=this.getPrecision(t),d=this.getSubdivisions(t);let f=0,m,y,x,E,S;for(let He=0,ft=this.segments.length;He<ft;He+=1){const pt=i?He:ft-1-He,kt=this.getSegment(pt),cn=d[pt],Bt={precision:a,subdivisions:cn},Xt=kt.length(Bt);if(kt.isDifferentiable()&&(x=kt,E=pt,e<=f+Xt)){y=pt,m=kt.divideAtLength((i?1:-1)*(e-f),Bt);break}f+=Xt}if(!x)return null;m||(y=E,S=i?1:0,m=x.divideAtT(S));const T=this.clone(),R=y;T.replaceSegment(R,m);const V=R;let j=R+1,q=R+2;m[0].isDifferentiable()||(T.removeSegment(V),j-=1,q-=1);const ue=T.getSegment(j).start;T.insertSegment(j,sr.createSegment("M",ue)),q+=1,m[1].isDifferentiable()||(T.removeSegment(q-1),q-=1);const be=q-V-1;for(let He=q,ft=T.segments.length;He<ft;He+=1){const pt=this.getSegment(He-be),kt=T.getSegment(He);if(kt.type==="Z"&&!pt.subpathStartSegment.end.equals(kt.subpathStartSegment.end)){const cn=sr.createSegment("L",pt.end);T.replaceSegment(He,cn)}}const se=new sr(T.segments.slice(0,j)),Pe=new sr(T.segments.slice(j));return[se,Pe]}intersectsWithLine(e,t={}){const i=this.toPolylines(t);if(i==null)return null;let a=null;for(let d=0,f=i.length;d<f;d+=1){const m=i[d],y=e.intersect(m);y&&(a==null&&(a=[]),Array.isArray(y)?a.push(...y):a.push(y))}return a}isDifferentiable(){for(let e=0,t=this.segments.length;e<t;e+=1)if(this.segments[e].isDifferentiable())return!0;return!1}isValid(){const e=this.segments;return e.length===0||e[0].type==="M"}length(e={}){if(this.segments.length===0)return 0;const t=this.getSubdivisions(e);let i=0;for(let a=0,d=this.segments.length;a<d;a+=1){const f=this.segments[a],m=t[a];i+=f.length({subdivisions:m})}return i}lengthAtT(e,t={}){const i=this.segments.length;if(i===0)return 0;let a=e.segmentIndex;if(a<0)return 0;let d=ks(e.value,0,1);a>=i&&(a=i-1,d=1);const f=this.getPrecision(t),m=this.getSubdivisions(t);let y=0;for(let S=0;S<a;S+=1){const T=this.segments[S],R=m[S];y+=T.length({precision:f,subdivisions:R})}const x=this.segments[a],E=m[a];return y+=x.lengthAtT(d,{precision:f,subdivisions:E}),y}tangentAt(e,t={}){if(this.segments.length===0)return null;const i=ks(e,0,1),a=this.getOptions(t),f=this.length(a)*i;return this.tangentAtLength(f,a)}tangentAtLength(e,t={}){if(this.segments.length===0)return null;let i=!0;e<0&&(i=!1,e=-e);const a=this.getPrecision(t),d=this.getSubdivisions(t);let f,m=0;for(let y=0,x=this.segments.length;y<x;y+=1){const E=i?y:x-1-y,S=this.segments[E],T=d[E],R=S.length({precision:a,subdivisions:T});if(S.isDifferentiable()){if(e<=m+R)return S.tangentAtLength((i?1:-1)*(e-m),{precision:a,subdivisions:T});f=S}m+=R}if(f){const y=i?1:0;return f.tangentAtT(y)}return null}tangentAtT(e){const t=this.segments.length;if(t===0)return null;const i=e.segmentIndex;if(i<0)return this.segments[0].tangentAtT(0);if(i>=t)return this.segments[t-1].tangentAtT(1);const a=ks(e.value,0,1);return this.segments[i].tangentAtT(a)}getPrecision(e={}){return e.precision==null?this.PRECISION:e.precision}getSubdivisions(e={}){if(e.segmentSubdivisions==null){const t=this.getPrecision(e);return this.getSegmentSubdivisions({precision:t})}return e.segmentSubdivisions}getOptions(e={}){const t=this.getPrecision(e),i=this.getSubdivisions(e);return{precision:t,segmentSubdivisions:i}}toPoints(e={}){const t=this.segments,i=t.length;if(i===0)return null;const a=this.getSubdivisions(e),d=[];let f=[];for(let m=0;m<i;m+=1){const y=t[m];if(y.isVisible){const x=a[m];x.length>0?x.forEach(E=>f.push(E.start)):f.push(y.start)}else f.length>0&&(f.push(t[m-1].end),d.push(f),f=[])}return f.length>0&&(f.push(this.end),d.push(f)),d}toPolylines(e={}){const t=this.toPoints(e);return t?t.map(i=>new Zo(i)):null}scale(e,t,i){return this.segments.forEach(a=>a.scale(e,t,i)),this}rotate(e,t){return this.segments.forEach(i=>i.rotate(e,t)),this}translate(e,t){return typeof e=="number"?this.segments.forEach(i=>i.translate(e,t)):this.segments.forEach(i=>i.translate(e)),this}clone(){const e=new sr;return this.segments.forEach(t=>e.appendSegment(t.clone())),e}equals(e){if(e==null)return!1;const t=this.segments,i=e.segments,a=t.length;if(i.length!==a)return!1;for(let d=0;d<a;d+=1){const f=t[d],m=i[d];if(f.type!==m.type||!f.equals(m))return!1}return!0}toJSON(){return this.segments.map(e=>e.toJSON())}serialize(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map(e=>e.serialize()).join(" ")}toString(){return this.serialize()}}(function(c){c.toStringTag=`X6.Geometry.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return!!((i==null||i===c.toStringTag)&&Array.isArray(a.segments)&&typeof a.moveTo=="function"&&typeof a.lineTo=="function"&&typeof a.curveTo=="function")}c.isPath=e})(sr||(sr={})),function(c){function e(i){if(!i)return new c;const a=new c,d=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g,f=c.normalize(i).match(d);if(f!=null)for(let m=0,y=f.length;m<y;m+=1){const x=f[m],E=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,S=x.match(E);if(S!=null){const T=S[0],R=S.slice(1).map(j=>+j),V=t.call(null,T,...R);a.appendSegment(V)}}return a}c.parse=e;function t(i,...a){if(i==="M")return tc.create.call(null,...a);if(i==="L")return lo.create.call(null,...a);if(i==="C")return ml.create.call(null,...a);if(i==="z"||i==="Z")return ec.create();throw new Error(`Invalid path segment type "${i}"`)}c.createSegment=t}(sr||(sr={})),function(c){c.normalize=fw,c.isValid=gw,c.drawArc=vw,c.drawPoints=Wb,c.arcToCurves=$m}(sr||(sr={}));class In{constructor(e,t,i){if(!e)throw new TypeError("Invalid element to create vector");let a;if(In.isVector(e))a=e.node;else if(typeof e=="string")if(e.toLowerCase()==="svg")a=ug();else if(e[0]==="<"){const d=ug(e);a=document.importNode(d.firstChild,!0)}else a=document.createElementNS(Fo.svg,e);else a=e;this.node=a,t&&this.setAttributes(t),i&&this.append(i)}get[Symbol.toStringTag](){return In.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(e){this.node.id=e}transform(e,t){return e==null?Nh(this.node):(Nh(this.node,e,t),this)}translate(e,t=0,i={}){return e==null?Ym(this.node):(Ym(this.node,e,t,i),this)}rotate(e,t,i,a={}){return e==null?Km(this.node):(Km(this.node,e,t,i,a),this)}scale(e,t){return e==null?ht(this.node):(ht(this.node,e,t),this)}getTransformToElement(e){const t=In.toNode(e);return Cu(this.node,t)}removeAttribute(e){return Gm(this.node,e),this}getAttribute(e){return Bb(this.node,e)}setAttribute(e,t){return Bm(this.node,e,t),this}setAttributes(e){return gv(this.node,e),this}attr(e,t){return e==null?yi(this.node):typeof e=="string"&&t===void 0?yi(this.node,e):(typeof e=="object"?yi(this.node,e):yi(this.node,e,t),this)}svg(){return this.node instanceof SVGSVGElement?this:In.create(this.node.ownerSVGElement)}defs(){const e=this.svg()||this,t=e.node.getElementsByTagName("defs")[0];return t?In.create(t):In.create("defs").appendTo(e)}text(e,t={}){return Sv(this.node,e,t),this}tagName(){return Ib(this.node)}clone(){return In.create(this.node.cloneNode(!0))}remove(){return Jl(this.node),this}empty(){return Im(this.node),this}append(e){return Yf(this.node,In.toNodes(e)),this}appendTo(e){return Gb(this.node,In.isVector(e)?e.node:e),this}prepend(e){return Fb(this.node,In.toNodes(e)),this}before(e){return Lm(this.node,In.toNodes(e)),this}replace(e){return this.node.parentNode&&this.node.parentNode.replaceChild(In.toNode(e),this.node),In.create(e)}first(){return this.node.firstChild?In.create(this.node.firstChild):null}last(){return this.node.lastChild?In.create(this.node.lastChild):null}get(e){const t=this.node.childNodes[e];return t?In.create(t):null}indexOf(e){return Array.prototype.slice.call(this.node.childNodes).indexOf(In.toNode(e))}find(e){const t=[],i=ow(this.node,e);if(i)for(let a=0,d=i.length;a<d;a+=1)t.push(In.create(i[a]));return t}findOne(e){const t=km(this.node,e);return t?In.create(t):null}findParentByClass(e,t){const i=Lb(this.node,e,t);return i?In.create(i):null}matches(e){const t=this.node,i=this.node.matches,a=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return a&&a.call(t,e)}contains(e){return Rm(this.node,In.isVector(e)?e.node:e)}wrap(e){const t=In.create(e),i=this.node.parentNode;return i!=null&&i.insertBefore(t.node,this.node),t.append(this)}parent(e){let t=this;if(t.node.parentNode==null)return null;if(t=In.create(t.node.parentNode),e==null)return t;do if(typeof e=="string"?t.matches(e):t instanceof e)return t;while(t=In.create(t.node.parentNode));return t}children(){const e=this.node.childNodes,t=[];for(let i=0;i<e.length;i+=1)e[i].nodeType===1&&t.push(In.create(e[i]));return t}eachChild(e,t){const i=this.children();for(let a=0,d=i.length;a<d;a+=1)e.call(i[a],i[a],a,i),t&&i[a].eachChild(e,t);return this}index(){return Nm(this.node)}hasClass(e){return Sd(this.node,e)}addClass(e){return vi(this.node,e),this}removeClass(e){return Wa(this.node,e),this}toggleClass(e,t){return ag(this.node,e,t),this}toLocalPoint(e,t){return Ov(this.node,e,t)}toGeometryShape(){return Dv(this.node)}translateCenterToPoint(e){const i=this.getBBox({target:this.svg()}).getCenter();return this.translate(e.x-i.x,e.y-i.y),this}translateAndAutoOrient(e,t,i){return vo(this.node,e,t,i),this}animate(e){return _v(this.node,e)}animateTransform(e){return Nv(this.node,e)}animateAlongPath(e,t){return Rv(this.node,e,t)}normalizePath(){return this.tagName()==="path"&&this.attr("d",sr.normalize(this.attr("d"))),this}bbox(e,t){return js(this.node,e,t)}getBBox(e={}){return Pr(this.node,{recursive:e.recursive,target:e.target?In.toNode(e.target):null})}sample(e=1){return this.node instanceof SVGPathElement?Tr(this.node,e):[]}toPath(){return In.create(Tv(this.node))}toPathData(){return Mv(this.node)}}(function(c){c.toStringTag=`X6.${c.name}`;function e(f){if(f==null)return!1;if(f instanceof c)return!0;const m=f[Symbol.toStringTag],y=f;return(m==null||m===c.toStringTag)&&y.node instanceof SVGElement&&typeof y.animate=="function"&&typeof y.sample=="function"&&typeof y.normalizePath=="function"&&typeof y.toPath=="function"}c.isVector=e;function t(f,m,y){return new c(f,m,y)}c.create=t;function i(f){if(f[0]==="<"){const m=ug(f),y=[];for(let x=0,E=m.childNodes.length;x<E;x+=1){const S=m.childNodes[x];y.push(t(document.importNode(S,!0)))}return y}return[t(f)]}c.createVectors=i;function a(f){return e(f)?f.node:f}c.toNode=a;function d(f){return Array.isArray(f)?f.map(m=>a(m)):[a(f)]}c.toNodes=d})(In||(In={}));function yw(c,e){const t=In.create(e),i=In.create("textPath"),a=c.d;if(a&&c["xlink:href"]===void 0){const d=In.create("path").attr("d",a).appendTo(t.defs());i.attr("xlink:href",`#${d.id}`)}return typeof c=="object"&&i.attr(c),i.node}function bw(c,e,t){const i=t.eol,a=t.baseSize,d=t.lineHeight;let f=0,m;const y={},x=e.length-1;for(let E=0;E<=x;E+=1){let S=e[E],T=null;if(typeof S=="object"){const R=S.attrs,V=In.create("tspan",R);m=V.node;let j=S.t;i&&E===x&&(j+=i),m.textContent=j;const q=R.class;q&&V.addClass(q),t.includeAnnotationIndices&&V.attr("annotations",S.annotations.join(",")),T=parseFloat(R["font-size"]),T===void 0&&(T=a),T&&T>f&&(f=T)}else i&&E===x&&(S+=i),m=document.createTextNode(S||" "),a&&a>f&&(f=a);c.appendChild(m)}return f&&(y.maxFontSize=f),d?y.lineHeight=d:f&&(y.lineHeight=f*1.2),y}const Zb=/em$/;function Wm(c,e){const t=parseFloat(c);return Zb.test(c)?t*e:t}function xw(c,e,t,i){if(!Array.isArray(e))return 0;const a=e.length;if(!a)return 0;let d=e[0];const f=Wm(d.maxFontSize,t)||t;let m=0;const y=Wm(i,t);for(let S=1;S<a;S+=1)d=e[S],m+=Wm(d.lineHeight,t)||y;const x=Wm(d.maxFontSize,t)||t;let E;switch(c){case"middle":E=f/2-.15*x-m/2;break;case"bottom":E=-(.25*x)-m;break;default:case"top":E=.8*f;break}return E}function Sv(c,e,t={}){e=aw(e);const i=t.eol;let a=t.textPath;const d=t.textVerticalAnchor,f=d==="middle"||d==="bottom"||d==="top";let m=t.x;m===void 0&&(m=c.getAttribute("x")||0);const y=t.includeAnnotationIndices;let x=t.annotations;x&&!Array.isArray(x)&&(x=[x]);const E=t.lineHeight,S=E==="auto",T=S?"1.5em":E||"1em";Im(c),yi(c,{"xml:space":"preserve",display:e||t.displayEmpty?null:"none"});const R=yi(c,"font-size");let V=parseFloat(R);V||(V=16,(f||x)&&!R&&yi(c,"font-size",`${V}`));let j;a?(typeof a=="string"&&(a={d:a}),j=yw(a,c)):j=document.createDocumentFragment();let q,ue=0,be;const se=e.split(`
`),Pe=[],He=se.length-1;for(let pt=0;pt<=He;pt+=1){q=T;let kt="v-line";const cn=ma("tspan");let Bt,Xt=se[pt];if(Xt)if(x){const on=sw(Xt,x,{offset:-ue,includeAnnotationIndices:y});Bt=bw(cn,on,{eol:pt!==He&&i,baseSize:V,lineHeight:S?null:T,includeAnnotationIndices:y});const fr=Bt.lineHeight;fr&&S&&pt!==0&&(q=fr),pt===0&&(be=Bt.maxFontSize*.8)}else i&&pt!==He&&(Xt+=i),cn.textContent=Xt;else{cn.textContent="-",kt+=" v-empty-line";const on=cn.style;on.fillOpacity=0,on.strokeOpacity=0,x&&(Bt={})}Bt&&Pe.push(Bt),pt>0&&cn.setAttribute("dy",q),(pt>0||a)&&cn.setAttribute("x",m),cn.className.baseVal=kt,j.appendChild(cn),ue+=Xt.length+1}if(f)if(x)q=xw(d,Pe,V,T);else if(d==="top")q="0.8em";else{let pt;switch(He>0?(pt=parseFloat(T)||1,pt*=He,Zb.test(T)||(pt/=V)):pt=0,d){case"middle":q=`${.3-pt/2}em`;break;case"bottom":q=`${-pt-.3}em`;break;default:break}}else d===0?q="0em":d?q=d:(q=0,c.getAttribute("y")==null&&c.setAttribute("y",`${be||"0.8em"}`));j.firstChild.setAttribute("dy",q),c.appendChild(j)}function Cw(c,e,t,i){const a=[],d=[];if(e!=null){const f=c.split(e);if(a.push(...f),typeof e=="string")for(let m=0,y=f.length-1;m<y;m+=1)d.push(e);else{const m=c.match(new RegExp(e,"g"));for(let y=0,x=f.length-1;y<x;y+=1)d.push(m?m[y]:"")}}else{let f="";for(let m=0,y=c.length;m<y;m+=1){const x=c[m];x===" "?(a.push(f),d.push(" "),f=""):x.match(/[^\x00-\xff]/)?(f.length&&(a.push(f),d.push("")),a.push(x),d.push(""),f=""):f+=x}f.length&&a.push(f)}for(let f=0;f<a.length;f+=1){const m=a[f];if(m.indexOf(t)>=0&&m.length>1){const y=m.split(t);for(let S=0,T=y.length-1;S<T;S+=1)y.splice(2*S+1,0,t);const x=y.filter(S=>S!=="");a.splice(f,1,...x);const E=x.map(()=>"");E.pop(),d.splice(f,0,...E)}}for(let f=0;f<a.length;f+=1){const m=a[f],y=m.search(i);y>0&&y<m.length-1&&(a.splice(f,1,m.substring(0,y+1),m.substring(y+1)),d.splice(f,0,""))}return{words:a,separators:d}}function ls(c,e,t={},i={}){const a=e.width,d=e.height,f=i.svgDocument||ma("svg"),m=ma("text"),y=ma("tspan"),x=document.createTextNode("");yi(m,t),m.appendChild(y),m.style.opacity="0",m.style.display="block",y.style.display="block",y.appendChild(x),f.appendChild(m);const E=f.parentNode==null;E&&document.body.appendChild(f);const S=i.eol||`
`,T=i.separator||" ",R=i.hyphen?new RegExp(i.hyphen):/[^\w\d]/,V=i.breakWord!==!1,j=[],q={};let ue=[],be,se,Pe;const{words:He,separators:ft}=Cw(c,i.separator,S,R);for(let pt=0,kt=0,cn=He.length;pt<cn;pt+=1){const Bt=He[pt];if(!!Bt){if(Bt===S){j[kt]=!0,kt+=1,ue[kt]="";continue}if(ue[kt]!=null?(Pe=ft[pt-1]||"",x.data=`${ue[kt]}${Pe}${Bt}`):x.data=Bt,y.getComputedTextLength()<=a)ue[kt]=x.data,q[kt]=ft[pt],be&&(j[kt]=!0,kt+=1,be=0);else{if(V){if(!ue[kt]||be){const Xt=!!be,on=Bt.length===1;if(be=Bt.length-1,Xt||on){if(on){if(!ue[kt]){ue=[];break}He.splice(pt,2,Bt+He[pt+1]),ft.splice(pt+1,1),j[kt]=!0,kt+=1,cn-=1,pt-=1;continue}He[pt]=Bt.substring(0,be),He[pt+1]=Bt.substring(be)+He[pt+1]}else He.splice(pt,1,Bt.substring(0,be),Bt.substring(be)),ft.splice(pt,0,""),cn+=1,kt&&!j[kt-1]&&(kt-=1);pt-=1;continue}}else if(!ue[kt]){ue[kt]=Bt,j[kt]=!0,kt+=1;continue}kt+=1,pt-=1}if(d!=null){if(se==null){let Xt;t.lineHeight==="auto"?Xt={value:1.5,unit:"em"}:Xt=Y1(t.lineHeight,["em"])||{value:1,unit:"em"},se=Xt.value,Xt.unit==="em"&&(xt.IS_FIREFOX?se*=y.getBBox().height:se*=m.getBBox().height)}if(se*ue.length>d){const Xt=Math.floor(d/se)-1,on=ue[Xt],fr=ue[Xt+1];if(ue.splice(Xt+1),on==null)break;let Cr=i.ellipsis;if(!Cr)break;typeof Cr!="string"&&(Cr="\u2026");let St=on;fr&&V&&(St+=Pe+fr);let dn=St.length,ur,Ni;do{if(Ni=St[dn],ur=St.substring(0,dn),Ni?Ni.match(T)&&(ur+=Ni):ur+=q[Xt],ur+=Cr,x.data=ur,y.getComputedTextLength()<=a){ue[Xt]=ur;break}dn-=1}while(dn>=0);break}}}}return Jl(E?f:m),ue.join(S)}const gg=.551784;function Vs(c,e,t=NaN){const i=c.getAttribute(e);if(i==null)return t;const a=parseFloat(i);return Number.isNaN(a)?t:a}function Tr(c,e=1){const t=c.getTotalLength(),i=[];let a=0,d;for(;a<t;)d=c.getPointAtLength(a),i.push({distance:a,x:d.x,y:d.y}),a+=e;return i}function Xb(c){return["M",Vs(c,"x1"),Vs(c,"y1"),"L",Vs(c,"x2"),Vs(c,"y2")].join(" ")}function Dh(c){const e=mg(c);return e.length===0?null:`${Yb(e)} Z`}function Av(c){const e=mg(c);return e.length===0?null:Yb(e)}function Yb(c){return`M ${c.map(t=>`${t.x} ${t.y}`).join(" L")}`}function mg(c){const e=[],t=c.points;if(t)for(let i=0,a=t.numberOfItems;i<a;i+=1)e.push(t.getItem(i));return e}function Kb(c){const e=Vs(c,"cx",0),t=Vs(c,"cy",0),i=Vs(c,"r"),a=i*gg;return["M",e,t-i,"C",e+a,t-i,e+i,t-a,e+i,t,"C",e+i,t+a,e+a,t+i,e,t+i,"C",e-a,t+i,e-i,t+a,e-i,t,"C",e-i,t-a,e-a,t-i,e,t-i,"Z"].join(" ")}function qb(c){const e=Vs(c,"cx",0),t=Vs(c,"cy",0),i=Vs(c,"rx"),a=Vs(c,"ry")||i,d=i*gg,f=a*gg;return["M",e,t-a,"C",e+d,t-a,e+i,t-f,e+i,t,"C",e+i,t+f,e+d,t+a,e,t+a,"C",e-d,t+a,e-i,t+f,e-i,t,"C",e-i,t-f,e-d,t-a,e,t-a,"Z"].join(" ")}function Jb(c){return Zm({x:Vs(c,"x",0),y:Vs(c,"y",0),width:Vs(c,"width",0),height:Vs(c,"height",0),rx:Vs(c,"rx",0),ry:Vs(c,"ry",0)})}function Zm(c){let e;const t=c.x,i=c.y,a=c.width,d=c.height,f=Math.min(c.rx||c["top-rx"]||0,a/2),m=Math.min(c.rx||c["bottom-rx"]||0,a/2),y=Math.min(c.ry||c["top-ry"]||0,d/2),x=Math.min(c.ry||c["bottom-ry"]||0,d/2);return f||m||y||x?e=["M",t,i+y,"v",d-y-x,"a",m,x,0,0,0,m,x,"h",a-2*m,"a",m,x,0,0,0,m,-x,"v",-(d-x-y),"a",f,y,0,0,0,-f,-y,"h",-(a-2*f),"a",f,y,0,0,0,-f,y,"Z"]:e=["M",t,i,"H",t+a,"V",i+d,"H",t,"V",i,"Z"],e.join(" ")}function Tv(c){const e=ma("path");yi(e,yi(c));const t=Mv(c);return t&&e.setAttribute("d",t),e}function Mv(c){const e=c.tagName.toLowerCase();switch(e){case"path":return c.getAttribute("d");case"line":return Xb(c);case"polygon":return Dh(c);case"polyline":return Av(c);case"ellipse":return qb(c);case"circle":return Kb(c);case"rect":return Jb(c);default:break}throw new Error(`"${e}" cannot be converted to svg path element.`)}function Qb(c,e,t,i){const a=2*Math.PI-1e-6,d=c,f=e;let m=t,y=i;if(y<m){const j=m;m=y,y=j}const x=y-m,E=x<Math.PI?"0":"1",S=Math.cos(m),T=Math.sin(m),R=Math.cos(y),V=Math.sin(y);return x>=a?d?`M0,${f}A${f},${f} 0 1,1 0,${-f}A${f},${f} 0 1,1 0,${f}M0,${d}A${d},${d} 0 1,0 0,${-d}A${d},${d} 0 1,0 0,${d}Z`:`M0,${f}A${f},${f} 0 1,1 0,${-f}A${f},${f} 0 1,1 0,${f}Z`:d?`M${f*S},${f*T}A${f},${f} 0 ${E},1 ${f*R},${f*V}L${d*R},${d*V}A${d},${d} 0 ${E},0 ${d*S},${d*T}Z`:`M${f*S},${f*T}A${f},${f} 0 ${E},1 ${f*R},${f*V}L0,0Z`}const vg=ma("svg"),ww=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,tr=/[ ,]+/,Wn=/^(\w+)\((.*)\)/;function or(c,e){const t=vg.createSVGPoint();return t.x=c,t.y=e,t}function On(c){const e=vg.createSVGMatrix();if(c!=null){const t=c,i=e;for(const a in t)i[a]=t[a]}return e}function ep(c){return c!=null?(c instanceof DOMMatrix||(c=On(c)),vg.createSVGTransformFromMatrix(c)):vg.createSVGTransform()}function kn(c){let e=On();const t=c!=null&&c.match(ww);if(!t)return e;for(let i=0,a=t.length;i<a;i+=1){const f=t[i].match(Wn);if(f){let m,y,x,E,S,T=On();const R=f[2].split(tr);switch(f[1].toLowerCase()){case"scale":m=parseFloat(R[0]),y=R[1]===void 0?m:parseFloat(R[1]),T=T.scaleNonUniform(m,y);break;case"translate":x=parseFloat(R[0]),E=parseFloat(R[1]),T=T.translate(x,E);break;case"rotate":S=parseFloat(R[0]),x=parseFloat(R[1])||0,E=parseFloat(R[2])||0,x!==0||E!==0?T=T.translate(x,E).rotate(S).translate(-x,-E):T=T.rotate(S);break;case"skewx":S=parseFloat(R[0]),T=T.skewX(S);break;case"skewy":S=parseFloat(R[0]),T=T.skewY(S);break;case"matrix":T.a=parseFloat(R[0]),T.b=parseFloat(R[1]),T.c=parseFloat(R[2]),T.d=parseFloat(R[3]),T.e=parseFloat(R[4]),T.f=parseFloat(R[5]);break;default:continue}e=e.multiply(T)}}return e}function Zr(c){const e=c||{},t=e.a!=null?e.a:1,i=e.b!=null?e.b:0,a=e.c!=null?e.c:0,d=e.d!=null?e.d:1,f=e.e!=null?e.e:0,m=e.f!=null?e.f:0;return`matrix(${t},${i},${a},${d},${f},${m})`}function yg(c){let e,t,i;if(c){const d=tr;if(c.trim().indexOf("matrix")>=0){const f=kn(c),m=vl(f);e=[m.translateX,m.translateY],t=[m.rotation],i=[m.scaleX,m.scaleY];const y=[];(e[0]!==0||e[1]!==0)&&y.push(`translate(${e.join(",")})`),(i[0]!==1||i[1]!==1)&&y.push(`scale(${i.join(",")})`),t[0]!==0&&y.push(`rotate(${t[0]})`),c=y.join(" ")}else{const f=c.match(/translate\((.*?)\)/);f&&(e=f[1].split(d));const m=c.match(/rotate\((.*?)\)/);m&&(t=m[1].split(d));const y=c.match(/scale\((.*?)\)/);y&&(i=y[1].split(d))}}const a=i&&i[0]?parseFloat(i[0]):1;return{raw:c||"",translation:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotation:{angle:t&&t[0]?parseInt(t[0],10):0,cx:t&&t[1]?parseInt(t[1],10):void 0,cy:t&&t[2]?parseInt(t[2],10):void 0},scale:{sx:a,sy:i&&i[1]?parseFloat(i[1]):a}}}function Pv(c,e){const t=e.x*c.a+e.y*c.c+0,i=e.x*c.b+e.y*c.d+0;return{x:t,y:i}}function vl(c){const e=Pv(c,{x:0,y:1}),t=Pv(c,{x:1,y:0}),i=180/Math.PI*Math.atan2(e.y,e.x)-90,a=180/Math.PI*Math.atan2(t.y,t.x);return{skewX:i,skewY:a,translateX:c.e,translateY:c.f,scaleX:Math.sqrt(c.a*c.a+c.b*c.b),scaleY:Math.sqrt(c.c*c.c+c.d*c.d),rotation:i}}function Td(c){let e,t,i,a;return c?(e=c.a==null?1:c.a,a=c.d==null?1:c.d,t=c.b,i=c.c):e=a=1,{sx:t?Math.sqrt(e*e+t*t):e,sy:i?Math.sqrt(i*i+a*a):a}}function Md(c){let e={x:0,y:1};return c&&(e=Pv(c,e)),{angle:ri.normalize(ri.toDeg(Math.atan2(e.y,e.x))-90)}}function _h(c){return{tx:c&&c.e||0,ty:c&&c.f||0}}function Pt(c,e){const t=or(c.x,c.y).matrixTransform(e);return new Oe(t.x,t.y)}function e2(c,e){return new zn(Pt(c.start,e),Pt(c.end,e))}function Ew(c,e){let t=c instanceof Zo?c.points:c;return Array.isArray(t)||(t=[]),new Zo(t.map(i=>Pt(i,e)))}function va(c,e){const t=vg.createSVGPoint();t.x=c.x,t.y=c.y;const i=t.matrixTransform(e);t.x=c.x+c.width,t.y=c.y;const a=t.matrixTransform(e);t.x=c.x+c.width,t.y=c.y+c.height;const d=t.matrixTransform(e);t.x=c.x,t.y=c.y+c.height;const f=t.matrixTransform(e),m=Math.min(i.x,a.x,d.x,f.x),y=Math.max(i.x,a.x,d.x,f.x),x=Math.min(i.y,a.y,d.y,f.y),E=Math.max(i.y,a.y,d.y,f.y);return new gn(m,x,y-m,E-x)}var Rs=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};function js(c,e,t){let i;const a=c.ownerSVGElement;if(!a)return new gn(0,0,0,0);try{i=c.getBBox()}catch{i={x:c.clientLeft,y:c.clientTop,width:c.clientWidth,height:c.clientHeight}}if(e)return gn.create(i);const d=Cu(c,t||a);return va(i,d)}function Pr(c,e={}){let t;if(!c.ownerSVGElement||!Ad(c)){if(Fm(c)){const{left:f,top:m,width:y,height:x}=Za(c);return new gn(f,m,y,x)}return new gn(0,0,0,0)}let a=e.target;if(!e.recursive){try{t=c.getBBox()}catch{t={x:c.clientLeft,y:c.clientTop,width:c.clientWidth,height:c.clientHeight}}if(!a)return gn.create(t);const f=Cu(c,a);return va(t,f)}{const f=c.childNodes,m=f.length;if(m===0)return Pr(c,{target:a});a||(a=c);for(let y=0;y<m;y+=1){const x=f[y];let E;x.childNodes.length===0?E=Pr(x,{target:a}):E=Pr(x,{target:a,recursive:!0}),t?t=t.union(E):t=E}return t}}function Sw(c){let e=c,t=e?e.tagName.toLowerCase():"";for(;t==="g";)e=e.firstElementChild,t=e?e.tagName.toLowerCase():"";const i=f=>{const m=e.getAttribute(f),y=m?parseFloat(m):0;return Number.isNaN(y)?0:y};let a,d;switch(t){case"rect":d=new gn(i("x"),i("y"),i("width"),i("height"));break;case"circle":a=i("r"),d=new gn(i("cx")-a,i("cy")-a,2*a,2*a);break;default:break}return d}function Aw(c,e){let t=On();if(Ad(e)&&Ad(c)){let i=c;const a=[];for(;i&&i!==e;){const d=i.getAttribute("transform")||null,f=kn(d);a.push(f),i=i.parentNode}a.reverse().forEach(d=>{t=t.multiply(d)})}return t}function Cu(c,e){if(Ad(e)&&Ad(c)){const t=e.getScreenCTM(),i=c.getScreenCTM();if(t&&i)return t.inverse().multiply(i)}return On()}function Ov(c,e,t){const i=c instanceof SVGSVGElement?c:c.ownerSVGElement,a=i.createSVGPoint();a.x=e,a.y=t;try{const d=i.getScreenCTM(),f=a.matrixTransform(d.inverse()),m=Cu(c,i).inverse();return f.matrixTransform(m)}catch{return a}}function Dv(c){const e=t=>{const i=c.getAttribute(t),a=i?parseFloat(i):0;return Number.isNaN(a)?0:a};switch(c instanceof SVGElement&&c.nodeName.toLowerCase()){case"rect":return new gn(e("x"),e("y"),e("width"),e("height"));case"circle":return new gl(e("cx"),e("cy"),e("r"),e("r"));case"ellipse":return new gl(e("cx"),e("cy"),e("rx"),e("ry"));case"polyline":{const t=mg(c);return new Zo(t)}case"polygon":{const t=mg(c);return t.length>1&&t.push(t[0]),new Zo(t)}case"path":{let t=c.getAttribute("d");return sr.isValid(t)||(t=sr.normalize(t)),sr.parse(t)}case"line":return new zn(e("x1"),e("y1"),e("x2"),e("y2"));default:break}return Pr(c)}function t2(c,e,t){const i=c instanceof SVGSVGElement?c:c.ownerSVGElement;t=t||i;const a=Pr(t),d=a.getCenter();if(!a.intersectsWithLineFromCenterToPoint(e))return null;let f=null;const m=c.tagName.toLowerCase();if(m==="rect"){const y=new gn(parseFloat(c.getAttribute("x")||"0"),parseFloat(c.getAttribute("y")||"0"),parseFloat(c.getAttribute("width")||"0"),parseFloat(c.getAttribute("height")||"0")),x=Cu(c,t),E=vl(x),S=i.createSVGTransform();S.setRotate(-E.rotation,d.x,d.y);const T=va(y,S.matrix.multiply(x));f=gn.create(T).intersectsWithLineFromCenterToPoint(e,E.rotation)}else if(m==="path"||m==="polygon"||m==="polyline"||m==="circle"||m==="ellipse"){const y=m==="path"?c:Tv(c),x=Tr(y);let E=1/0,S=[];for(let T=0,R=x.length;T<R;T+=1){const V=x[T];let j=or(V.x,V.y);j=j.matrixTransform(Cu(c,t));const q=Oe.create(j),ue=q.distance(d),be=q.distance(e)*1.1,se=ue+be;se<E?(E=se,S=[{sample:V,refDistance:be}]):se<E+1&&S.push({sample:V,refDistance:be})}S.sort((T,R)=>T.refDistance-R.refDistance),S[0]&&(f=Oe.create(S[0].sample))}return f}function _v(c,e){return Xm(c,e,"animate")}function Nv(c,e){return Xm(c,e,"animateTransform")}function Xm(c,e,t){const i=ma(t);c.appendChild(i);try{return kv(i,e)}catch{}return()=>{}}function kv(c,e){const{start:t,complete:i,repeat:a}=e,d=Rs(e,["start","complete","repeat"]);yi(c,d),t&&c.addEventListener("beginEvent",t),i&&c.addEventListener("endEvent",i),a&&c.addEventListener("repeatEvent",a);const f=c;return f.beginElement(),()=>f.endElement()}function Rv(c,e,t){const i=Ph(t),a=ma("animateMotion"),d=ma("mpath");yi(d,{"xlink:href":`#${i}`}),a.appendChild(d),c.appendChild(a);try{return kv(a,e)}catch{if(document.documentElement.getAttribute("smiling")==="fake"){const m=a;m.animators=[];const y=window,x=m.getAttribute("id");x&&(y.id2anim[x]=m);const E=y.getTargets(m);for(let S=0,T=E.length;S<T;S+=1){const R=E[S],V=new y.Animator(m,R,S);y.animators.push(V),m.animators[S]=V,V.register()}}}return()=>{}}function Za(c){let e=0,t=0,i=0,a=0;if(c){let d=c;for(;d;)e+=d.offsetLeft,t+=d.offsetTop,d=d.offsetParent,d&&(e+=parseInt(fg(d,"borderLeft"),10),t+=parseInt(fg(d,"borderTop"),10));i=c.offsetWidth,a=c.offsetHeight}return{left:e,top:t,width:i,height:a}}function Nh(c,e,t={}){if(e==null)return kn(yi(c,"transform"));if(t.absolute){c.setAttribute("transform",Zr(e));return}const i=c.transform,a=ep(e);i.baseVal.appendItem(a)}function Ym(c,e,t=0,i={}){let a=yi(c,"transform");const d=yg(a);if(e==null)return d.translation;a=d.raw,a=a.replace(/translate\([^)]*\)/g,"").trim();const f=i.absolute?e:d.translation.tx+e,m=i.absolute?t:d.translation.ty+t,y=`translate(${f},${m})`;c.setAttribute("transform",`${y} ${a}`.trim())}function Km(c,e,t,i,a={}){let d=yi(c,"transform");const f=yg(d);if(e==null)return f.rotation;d=f.raw,d=d.replace(/rotate\([^)]*\)/g,"").trim(),e%=360;const m=a.absolute?e:f.rotation.angle+e,y=t!=null&&i!=null?`,${t},${i}`:"",x=`rotate(${m}${y})`;c.setAttribute("transform",`${d} ${x}`.trim())}function ht(c,e,t){let i=yi(c,"transform");const a=yg(i);if(e==null)return a.scale;t=t??e,i=a.raw,i=i.replace(/scale\([^)]*\)/g,"").trim();const d=`scale(${e},${t})`;c.setAttribute("transform",`${i} ${d}`.trim())}function vo(c,e,t,i){const a=Oe.create(e),d=Oe.create(t);i||(i=c instanceof SVGSVGElement?c:c.ownerSVGElement);const f=ht(c);c.setAttribute("transform","");const m=Pr(c,{target:i}).scale(f.sx,f.sy),y=ep();y.setTranslate(-m.x-m.width/2,-m.y-m.height/2);const x=ep(),E=a.angleBetween(d,a.clone().translate(1,0));E&&x.setRotate(E,0,0);const S=ep(),T=a.clone().move(d,m.width/2);S.setTranslate(2*a.x-T.x,2*a.y-T.y);const R=Cu(c,i),V=ep();V.setMatrix(S.matrix.multiply(x.matrix.multiply(y.matrix.multiply(R.scale(f.sx,f.sy))))),c.setAttribute("transform",Zr(V.matrix))}class yo{constructor(e,t,i){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=xt.isEventSupported("wheel")?"wheel":"mousewheel",this.target=e,this.onWheelCallback=t,this.onWheelGuard=i,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){xt.SUPPORT_PASSIVE?this.target.addEventListener(this.eventName,this.onWheel,{passive:!1}):N()(this.target).on("mousewheel",this.onWheel)}disable(){xt.SUPPORT_PASSIVE?this.target.removeEventListener(this.eventName,this.onWheel):N()(this.target).off("mousewheel")}onWheel(e){if(this.onWheelGuard!=null&&!this.onWheelGuard(e))return;this.deltaX+=e.deltaX,this.deltaY+=e.deltaY,e.preventDefault();let t;(this.deltaX!==0||this.deltaY!==0)&&(e.stopPropagation(),t=!0),t===!0&&this.animationFrameId===0&&(this.animationFrameId=requestAnimationFrame(()=>{this.didWheel(e)}))}didWheel(e){this.animationFrameId=0,this.onWheelCallback(e,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}const kh=In.isVector,gt=In.create,Pd=In.createVectors;function n2(c,e=60){let t=null;return(...i)=>{t&&clearTimeout(t),t=window.setTimeout(()=>{c.apply(this,i)},e)}}function Tw(c){let e=null,t=[];const i=()=>{if(getComputedStyle(c).position==="static"){const x=c.style;x.position="relative"}const y=document.createElement("object");return y.onload=()=>{y.contentDocument.defaultView.addEventListener("resize",a),a()},y.style.display="block",y.style.position="absolute",y.style.top="0",y.style.left="0",y.style.height="100%",y.style.width="100%",y.style.overflow="hidden",y.style.pointerEvents="none",y.style.zIndex="-1",y.style.opacity="0",y.setAttribute("tabindex","-1"),y.type="text/html",c.appendChild(y),y.data="about:blank",y},a=n2(()=>{t.forEach(y=>y(c))}),d=y=>{e||(e=i()),t.indexOf(y)===-1&&t.push(y)},f=()=>{e&&e.parentNode&&(e.contentDocument&&e.contentDocument.defaultView.removeEventListener("resize",a),e.parentNode.removeChild(e),e=null,t=[])};return{element:c,bind:d,destroy:f,unbind:y=>{const x=t.indexOf(y);x!==-1&&t.splice(x,1),t.length===0&&e&&f()}}}function Mw(c){let e=null,t=[];const i=n2(()=>{t.forEach(y=>{y(c)})}),a=()=>{const y=new ResizeObserver(i);return y.observe(c),i(),y},d=y=>{e||(e=a()),t.indexOf(y)===-1&&t.push(y)},f=()=>{e&&(e.disconnect(),t=[],e=null)};return{element:c,bind:d,destroy:f,unbind:y=>{const x=t.indexOf(y);x!==-1&&t.splice(x,1),t.length===0&&e&&f()}}}const Pw=typeof ResizeObserver<"u"?Mw:Tw;var qm;(function(c){const e=new WeakMap;function t(a){let d=e.get(a);return d||(d=Pw(a),e.set(a,d),d)}function i(a){a.destroy(),e.delete(a.element)}c.bind=(a,d)=>{const f=t(a);return f.bind(d),()=>f.unbind(d)},c.clear=a=>{const d=t(a);i(d)}})(qm||(qm={}));var Jm;(function(c){const e=[],t=16.666666666666668,i=[];let a=0;const d=()=>performance.now(),f=E=>E[0],m=E=>i.push(E)===1&&y(),y=(()=>{const E=()=>i.splice(0,i.length).forEach(S=>S());if(typeof MessageChannel<"u"){const{port1:S,port2:T}=new MessageChannel;return S.onmessage=E,()=>T.postMessage(null)}return()=>setTimeout(E)})(),x=()=>{a=d()+t;let E=f(e);for(;E&&!c.shouldYield();){const{callback:S,data:T}=E;E.callback=null;const R=S&&S(T);R?E.callback=R:e.shift(),E=f(e)}E&&m(x)};c.scheduleTask=(E,S)=>{const T={callback:E,data:S};e.push(T),m(x)},c.shouldYield=()=>{var E,S;return((S=(E=navigator)===null||E===void 0?void 0:E.scheduling)===null||S===void 0?void 0:S.isInputPending())||d()>=a}})(Jm||(Jm={}));class Oo{constructor(e){this.options=Object.assign({},e),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(e,t,i=!1){if(typeof e=="object"){Object.keys(e).forEach(f=>{this.register(f,e[f],t)});return}this.exist(e)&&!i&&!xt.isApplyingHMR()&&this.onDuplicated(e);const a=this.options.process,d=a?Pn(a,this,e,t):t;return this.data[e]=d,d}unregister(e){const t=e?this.data[e]:null;return delete this.data[e],t}get(e){return e?this.data[e]:null}exist(e){return e?this.data[e]!=null:!1}onDuplicated(e){try{throw this.options.onConflict&&Pn(this.options.onConflict,this,e),new Error(`${ar(this.options.type)} with name '${e}' already registered.`)}catch(t){throw t}}onNotFound(e,t){throw new Error(this.getSpellingSuggestion(e,t))}getSpellingSuggestion(e,t){const i=this.getSpellingSuggestionForName(e),a=t?`${t} ${bb(this.options.type)}`:this.options.type;return`${ar(a)} with name '${e}' does not exist.${i?` Did you mean '${i}'?`:""}`}getSpellingSuggestionForName(e){return wb(e,Object.keys(this.data),t=>t)}}(function(c){function e(t){return new c(t)}c.create=e})(Oo||(Oo={}));const Ow={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},Dw={},r2={position:bg("x","width","origin")},i2={position:bg("y","height","origin")},_w={position:bg("x","width","corner")},Nw={position:bg("y","height","corner")},o2={set:wu("width","width")},s2={set:wu("height","height")},kw={set:wu("rx","width")},Rw={set:wu("ry","height")},a2={set:(c=>{const e=wu(c,"width"),t=wu(c,"height");return function(i,a){const d=a.refBBox,f=d.height>d.width?e:t;return Pn(f,this,i,a)}})("r")},Iw={set(c,{refBBox:e}){let t=parseFloat(c);const i=pl(c);i&&(t/=100);const a=Math.sqrt(e.height*e.height+e.width*e.width);let d;return Number.isFinite(t)&&(i||t>=0&&t<=1?d=t*a:d=Math.max(t+a,0)),{r:d}}},Lw={set:wu("cx","width")},Fw={set:wu("cy","height")},l2={set:u2({resetOffset:!0})},Gw={set:u2({resetOffset:!1})},c2={set:d2({resetOffset:!0})},Bw={set:d2({resetOffset:!1})},bo=a2,qS=l2,zw=c2,Uw=r2,Vw=i2,jw=o2,Hw=s2;function bg(c,e,t){return(i,{refBBox:a})=>{if(i==null)return null;let d=parseFloat(i);const f=pl(i);f&&(d/=100);let m;if(Number.isFinite(d)){const x=a[t];f||d>0&&d<1?m=x[c]+a[e]*d:m=x[c]+d}const y=new Oe;return y[c]=m||0,y}}function wu(c,e){return function(t,{refBBox:i}){let a=parseFloat(t);const d=pl(t);d&&(a/=100);const f={};if(Number.isFinite(a)){const m=d||a>=0&&a<=1?a*i[e]:Math.max(a+i[e],0);f[c]=m}return f}}function Iv(c,e){const t="x6-shape",i=e&&e.resetOffset;return function(a,{view:d,elem:f,refBBox:m}){const y=d.$(f);let x=y.data(t);if(!x||x.value!==a){const ue=c(a);x={value:a,shape:ue,shapeBBox:ue.bbox()},y.data(t,x)}const E=x.shape.clone(),S=x.shapeBBox.clone(),T=S.getOrigin(),R=m.getOrigin();S.x=R.x,S.y=R.y;const V=m.getMaxScaleToFit(S,R),j=S.width===0||m.width===0?1:V.sx,q=S.height===0||m.height===0?1:V.sy;return E.scale(j,q,T),i&&E.translate(-T.x,-T.y),E}}function u2(c){function e(i){return sr.parse(i)}const t=Iv(e,c);return(i,a)=>({d:t(i,a).serialize()})}function d2(c){const e=Iv(t=>new Zo(t),c);return(t,i)=>({points:e(t,i).serialize()})}const $w={qualify:Ge.Z,set(c,{view:e}){return`url(#${e.graph.defineGradient(c)})`}},tt={qualify:Ge.Z,set(c,{view:e}){const t=e.cell,i=Object.assign({},c);if(t.isEdge()&&i.type==="linearGradient"){const a=e,d=a.sourcePoint,f=a.targetPoint;i.id=`gradient-${i.type}-${t.id}`,i.attrs=Object.assign(Object.assign({},i.attrs),{x1:d.x,y1:d.y,x2:f.x,y2:f.y,gradientUnits:"userSpaceOnUse"}),e.graph.defs.remove(i.id)}return`url(#${e.graph.defineGradient(i)})`}},Lv={qualify(c,{attrs:e}){return e.textWrap==null||!Ge.Z(e.textWrap)},set(c,{view:e,elem:t,attrs:i}){const a="x6-text",d=e.$(t),f=d.data(a),m=S=>{try{return JSON.parse(S)}catch{return S}},y={x:i.x,eol:i.eol,annotations:m(i.annotations),textPath:m(i["text-path"]||i.textPath),textVerticalAnchor:i["text-vertical-anchor"]||i.textVerticalAnchor,displayEmpty:(i["display-empty"]||i.displayEmpty)==="true",lineHeight:i["line-height"]||i.lineHeight},x=i["font-size"]||i.fontSize,E=JSON.stringify([c,y]);if(x&&t.setAttribute("font-size",x),f==null||f!==E){const S=y.textPath;if(S!=null&&typeof S=="object"){const T=S.selector;if(typeof T=="string"){const R=e.find(T)[0];R instanceof SVGPathElement&&(Ph(R),y.textPath=Object.assign({"xlink:href":`#${R.id}`},S))}}Sv(t,`${c}`,y),d.data(a,E)}}},h2={qualify:Ge.Z,set(c,{view:e,elem:t,attrs:i,refBBox:a}){const d=c,f=d.width||0;pl(f)?a.width*=parseFloat(f)/100:f<=0?a.width+=f:a.width=f;const m=d.height||0;pl(m)?a.height*=parseFloat(m)/100:m<=0?a.height+=m:a.height=m;let y,x=d.text;x==null&&(x=i.text),x!=null?y=ls(`${x}`,a,{"font-weight":i["font-weight"]||i.fontWeight,"font-size":i["font-size"]||i.fontSize,"font-family":i["font-family"]||i.fontFamily,lineHeight:i.lineHeight},{svgDocument:e.graph.view.svg,ellipsis:d.ellipsis,hyphen:d.hyphen,breakWord:d.breakWord}):y="",Pn(Lv.set,this,y,{view:e,elem:t,attrs:i,refBBox:a,cell:e.cell})}},Rh=(c,{attrs:e})=>e.text!==void 0,f2={qualify:Rh},Qm={qualify:Rh},p2={qualify:Rh},g2={qualify:Rh},m2={qualify:Rh},Ww={qualify:Rh},v2={qualify(c,{elem:e}){return e instanceof SVGElement},set(c,{view:e,elem:t}){const i="x6-title",a=`${c}`,d=e.$(t),f=d.data(i);if(f==null||f!==a){d.data(i,a);const m=t.firstChild;if(m&&m.tagName.toUpperCase()==="TITLE"){const y=m;y.textContent=a}else{const y=document.createElementNS(t.namespaceURI,"title");y.textContent=a,t.insertBefore(y,m)}}}},y2={offset:b2("x","width","right")},Zw={offset:b2("y","height","bottom")},Xw={offset(c,{refBBox:e}){return c?{x:-e.x,y:-e.y}:{x:0,y:0}}};function b2(c,e,t){return(i,{refBBox:a})=>{const d=new Oe;let f;return i==="middle"?f=a[e]/2:i===t?f=a[e]:typeof i=="number"&&Number.isFinite(i)?f=i>-1&&i<1?-a[e]*i:-i:pl(i)?f=a[e]*parseFloat(i)/100:f=0,d[c]=-(a[c]+f),d}}const x2={qualify:Ge.Z,set(c,{view:e,elem:t}){e.$(t).css(c)}},C2={set(c,{view:e,elem:t}){e.$(t).html(`${c}`)}},w2={qualify:Ge.Z,set(c,{view:e}){return`url(#${e.graph.defineFilter(c)})`}},E2={set(c){return c!=null&&typeof c=="object"&&c.id?c.id:c}};function Eu(c,e,t){let i,a;typeof e=="object"?(i=e.x,a=e.y):(i=e,a=t);const d=sr.parse(c),f=d.bbox();if(f){let m=-f.height/2-f.y,y=-f.width/2-f.x;typeof i=="number"&&(y-=i),typeof a=="number"&&(m-=a),d.translate(y,m)}return d.serialize()}var tp=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const S2=c=>{var{size:e,width:t,height:i,offset:a,open:d}=c,f=tp(c,["size","width","height","offset","open"]);return Fv({size:e,width:t,height:i,offset:a},d===!0,!0,void 0,f)},A2=c=>{var{size:e,width:t,height:i,offset:a,factor:d}=c,f=tp(c,["size","width","height","offset","factor"]);return Fv({size:e,width:t,height:i,offset:a},!1,!1,d,f)};function Fv(c,e,t,i=3/4,a={}){const d=c.size||10,f=c.width||d,m=c.height||d,y=new sr,x={};if(e)y.moveTo(f,0).lineTo(0,m/2).lineTo(f,m),x.fill="none";else{if(y.moveTo(0,m/2),y.lineTo(f,0),!t){const E=Ta(i,0,1);y.lineTo(f*E,m/2)}y.lineTo(f,m),y.close()}return Object.assign(Object.assign(Object.assign({},x),a),{tagName:"path",d:Eu(y.serialize(),{x:c.offset!=null?c.offset:-f/2})})}var T2=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const M2=c=>{var{size:e,width:t,height:i,offset:a}=c,d=T2(c,["size","width","height","offset"]);const f=e||10,m=t||f,y=i||f,x=new sr;return x.moveTo(0,y/2).lineTo(m/2,0).lineTo(m,y/2).lineTo(m/2,y).close(),Object.assign(Object.assign({},d),{tagName:"path",d:Eu(x.serialize(),a??-m/2)})};var P2=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const Yw=c=>{var{d:e,offsetX:t,offsetY:i}=c,a=P2(c,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},a),{tagName:"path",d:Eu(e,t,i)})};var Kw=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const qw=c=>{var{size:e,width:t,height:i,offset:a}=c,d=Kw(c,["size","width","height","offset"]);const f=e||10,m=t||f,y=i||f,x=new sr;return x.moveTo(0,0).lineTo(m,y).moveTo(0,y).lineTo(m,0),Object.assign(Object.assign({},d),{tagName:"path",fill:"none",d:Eu(x.serialize(),a||-m/2)})};var Gv=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const Jw=c=>{var{width:e,height:t,offset:i,open:a,flip:d}=c,f=Gv(c,["width","height","offset","open","flip"]);let m=t||6;const y=e||10,x=a===!0,E=d===!0,S=Object.assign(Object.assign({},f),{tagName:"path"});E&&(m=-m);const T=new sr;return T.moveTo(0,m).lineTo(y,0),x?S.fill="none":(T.lineTo(y,m),T.close()),S.d=Eu(T.serialize(),{x:i||-y/2,y:m/2}),S};var e0=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const O2=c=>{var{r:e}=c,t=e0(c,["r"]);const i=e||5;return Object.assign(Object.assign({cx:i},t),{tagName:"circle",r:i})},Qw=c=>{var{r:e}=c,t=e0(c,["r"]);const i=e||5,a=new sr;return a.moveTo(i,0).lineTo(i,i*2),a.moveTo(0,i).lineTo(i*2,i),{children:[Object.assign(Object.assign({},O2({r:i})),{fill:"none"}),Object.assign(Object.assign({},t),{tagName:"path",d:Eu(a.serialize(),-i)})]}};var eE=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const tE=c=>{var{rx:e,ry:t}=c,i=eE(c,["rx","ry"]);const a=e||5,d=t||5;return Object.assign(Object.assign({cx:a},i),{tagName:"ellipse",rx:a,ry:d})};var ia;(function(c){c.presets=pe,c.registry=Oo.create({type:"marker"}),c.registry.register(c.presets,!0)})(ia||(ia={})),function(c){c.normalize=Eu}(ia||(ia={}));var nE=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};function D2(c){return typeof c=="string"||Ge.Z(c)}const JS={qualify:D2,set(c,{view:e,attrs:t}){return Bv("marker-start",c,e,t)}},QS={qualify:D2,set(c,{view:e,attrs:t}){return Bv("marker-end",c,e,t,{transform:"rotate(180)"})}},rE={qualify:D2,set(c,{view:e,attrs:t}){return Bv("marker-mid",c,e,t)}};function Bv(c,e,t,i,a={}){const d=typeof e=="string"?{name:e}:e,{name:f,args:m}=d,y=nE(d,["name","args"]);let x=y;if(f&&typeof f=="string"){const S=ia.registry.get(f);if(S)x=S(Object.assign(Object.assign({},y),m));else return ia.registry.onNotFound(f)}const E=Object.assign(Object.assign(Object.assign({},eA(i,c)),a),x);return{[c]:`url(#${t.graph.defineMarker(E)})`}}function eA(c,e){const t={},i=c.stroke;typeof i=="string"&&(t.stroke=i,t.fill=i);let a=c.strokeOpacity;if(a==null&&(a=c["stroke-opacity"]),a==null&&(a=c.opacity),a!=null&&(t["stroke-opacity"]=a,t["fill-opacity"]=a),e!=="marker-mid"){const d=parseFloat(c.strokeWidth||c["stroke-width"]);if(Number.isFinite(d)&&d>1){const f=Math.ceil(d/2);t.refX=e==="marker-start"?f:-f}}return t}const np=(c,{view:e})=>e.cell.isEdge(),_2={qualify:np,set(c,e){var t,i,a,d;const f=e.view,m=c.reverse||!1,y=c.stubs||0;let x;if(Number.isFinite(y)&&y!==0)if(m){let E,S;const T=f.getConnectionLength()||0;y<0?(E=(T+y)/2,S=-y):(E=y,S=T-y*2);const R=f.getConnection();x=(d=(a=(i=(t=R==null?void 0:R.divideAtLength(E))===null||t===void 0?void 0:t[1])===null||i===void 0?void 0:i.divideAtLength(S))===null||a===void 0?void 0:a[0])===null||d===void 0?void 0:d.serialize()}else{let E;y<0?E=((f.getConnectionLength()||0)+y)/2:E=y;const S=f.getConnection();if(S){const T=S.divideAtLength(E),R=S.divideAtLength(-E);T&&R&&(x=`${T[0].serialize()} ${R[1].serialize()}`)}}return{d:x||f.getConnectionPathData()}}},zv={qualify:np,set:xg("getTangentAtLength",{rotate:!0})},N2={qualify:np,set:xg("getTangentAtLength",{rotate:!1})},Uv={qualify:np,set:xg("getTangentAtRatio",{rotate:!0})},k2={qualify:np,set:xg("getTangentAtRatio",{rotate:!1})},R2=zv,Ih=Uv;function xg(c,e){const t={x:1,y:0};return(i,a)=>{let d,f;const m=a.view,y=m[c](Number(i));return y?(f=e.rotate?y.vector().vectorAngle(t):0,d=y.start):(d=m.path.start,f=0),f===0?{transform:`translate(${d.x},${d.y}')`}:{transform:`translate(${d.x},${d.y}') rotate(${f})`}}}var yl;(function(c){function e(t,i,a){return!!(t!=null&&(typeof t=="string"||typeof t.qualify!="function"||Pn(t.qualify,this,i,a)))}c.isValidDefinition=e})(yl||(yl={})),function(c){c.presets=Object.assign(Object.assign({},Ow),ke),c.registry=Oo.create({type:"attribute definition"}),c.registry.register(c.presets,!0)}(yl||(yl={}));const I2={color:"#aaaaaa",thickness:1,markup:"rect",update(c,e){const t=e.thickness*e.sx,i=e.thickness*e.sy;yi(c,{width:t,height:i,rx:t,ry:i,fill:e.color})}},L2={color:"#aaaaaa",thickness:1,markup:"rect",update(c,e){const t=e.sx<=1?e.thickness*e.sx:e.thickness;yi(c,{width:t,height:t,rx:t,ry:t,fill:e.color})}},F2={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(c,e){let t;const i=e.width,a=e.height,d=e.thickness;i-d>=0&&a-d>=0?t=["M",i,0,"H0 M0 0 V0",a].join(" "):t="M 0 0 0 0",yi(c,{d:t,stroke:e.color,"stroke-width":e.thickness})}},G2=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(c,e){let t;const i=e.width,a=e.height,d=e.thickness;i-d>=0&&a-d>=0?t=["M",i,0,"H0 M0 0 V0",a].join(" "):t="M 0 0 0 0",yi(c,{d:t,stroke:e.color,"stroke-width":e.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(c,e){let t;const i=e.factor||1,a=e.width*i,d=e.height*i,f=e.thickness;a-f>=0&&d-f>=0?t=["M",a,0,"H0 M0 0 V0",d].join(" "):t="M 0 0 0 0",e.width=a,e.height=d,yi(c,{d:t,stroke:e.color,"stroke-width":e.thickness})}}];class Gc{constructor(){this.patterns={},this.root=In.create(ug(),{width:"100%",height:"100%"},[ma("defs")]).node}add(e,t){const i=this.root.childNodes[0];i&&i.appendChild(t),this.patterns[e]=t,In.create("rect",{width:"100%",height:"100%",fill:`url(#${e})`}).appendTo(this.root)}get(e){return this.patterns[e]}has(e){return this.patterns[e]!=null}}(function(c){c.presets=Ce,c.registry=Oo.create({type:"grid"}),c.registry.register(c.presets,!0)})(Gc||(Gc={}));function Vv(c,e){return c??e}function Cs(c,e){return c!=null&&Number.isFinite(c)?c:e}function iE(c={}){const e=Vv(c.color,"blue"),t=Cs(c.width,1),i=Cs(c.margin,2),a=Cs(c.opacity,1),d=i,f=i+t;return`
    <filter>
      <feFlood flood-color="${e}" flood-opacity="${a}" result="colored"/>
      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${f}" />
      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${d}" />
      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>
      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>
      <feMerge>
        <feMergeNode in="outline"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  `.trim()}function cr(c={}){const e=Vv(c.color,"red"),t=Cs(c.blur,0),i=Cs(c.width,1),a=Cs(c.opacity,1);return`
      <filter>
        <feFlood flood-color="${e}" flood-opacity="${a}" result="colored"/>
        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${i}"/>
        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>
        <feGaussianBlur result="blured" in="composed" stdDeviation="${t}"/>
        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>
      </filter>
    `.trim()}function B2(c={}){const e=Cs(c.x,2);return`
    <filter>
      <feGaussianBlur stdDeviation="${c.y!=null&&Number.isFinite(c.y)?[e,c.y]:e}"/>
    </filter>
  `.trim()}function z2(c={}){const e=Cs(c.dx,0),t=Cs(c.dy,0),i=Vv(c.color,"black"),a=Cs(c.blur,4),d=Cs(c.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>
         <feDropShadow stdDeviation="${a}" dx="${e}" dy="${t}" flood-color="${i}" flood-opacity="${d}" />
       </filter>`.trim():`<filter>
         <feGaussianBlur in="SourceAlpha" stdDeviation="${a}" />
         <feOffset dx="${e}" dy="${t}" result="offsetblur" />
         <feFlood flood-color="${i}" />
         <feComposite in2="offsetblur" operator="in" />
         <feComponentTransfer>
           <feFuncA type="linear" slope="${d}" />
         </feComponentTransfer>
         <feMerge>
           <feMergeNode/>
           <feMergeNode in="SourceGraphic"/>
         </feMerge>
       </filter>`.trim()}function U2(c={}){const e=Cs(c.amount,1),t=.2126+.7874*(1-e),i=.7152-.7152*(1-e),a=.0722-.0722*(1-e),d=.2126-.2126*(1-e),f=.7152+.2848*(1-e),m=.0722-.0722*(1-e),y=.2126-.2126*(1-e),x=.0722+.9278*(1-e);return`
    <filter>
      <feColorMatrix type="matrix" values="${t} ${i} ${a} 0 0 ${d} ${f} ${m} 0 0 ${y} ${i} ${x} 0 0 0 0 0 1 0"/>
    </filter>
  `.trim()}function V2(c={}){const e=Cs(c.amount,1),t=.393+.607*(1-e),i=.769-.769*(1-e),a=.189-.189*(1-e),d=.349-.349*(1-e),f=.686+.314*(1-e),m=.168-.168*(1-e),y=.272-.272*(1-e),x=.534-.534*(1-e),E=.131+.869*(1-e);return`
      <filter>
        <feColorMatrix type="matrix" values="${t} ${i} ${a} 0 0 ${d} ${f} ${m} 0 0 ${y} ${x} ${E} 0 0 0 0 0 1 0"/>
      </filter>
    `.trim()}function j2(c={}){const e=Cs(c.amount,1);return`
      <filter>
        <feColorMatrix type="saturate" values="${1-e}"/>
      </filter>
    `.trim()}function H2(c={}){return`
      <filter>
        <feColorMatrix type="hueRotate" values="${Cs(c.angle,0)}"/>
      </filter>
    `.trim()}function $2(c={}){const e=Cs(c.amount,1),t=1-e;return`
      <filter>
        <feComponentTransfer>
          <feFuncR type="table" tableValues="${e} ${t}"/>
          <feFuncG type="table" tableValues="${e} ${t}"/>
          <feFuncB type="table" tableValues="${e} ${t}"/>
        </feComponentTransfer>
      </filter>
    `.trim()}function W2(c={}){const e=Cs(c.amount,1);return`
    <filter>
      <feComponentTransfer>
        <feFuncR type="linear" slope="${e}"/>
        <feFuncG type="linear" slope="${e}"/>
        <feFuncB type="linear" slope="${e}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}function Z2(c={}){const e=Cs(c.amount,1),t=.5-e/2;return`
    <filter>
     <feComponentTransfer>
        <feFuncR type="linear" slope="${e}" intercept="${t}"/>
        <feFuncG type="linear" slope="${e}" intercept="${t}"/>
        <feFuncB type="linear" slope="${e}" intercept="${t}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}var Od;(function(c){c.presets=ge,c.registry=Oo.create({type:"filter"}),c.registry.register(c.presets,!0)})(Od||(Od={}));const jv=function(c){const e=document.createElement("canvas"),t=c.width,i=c.height;e.width=t*2,e.height=i;const a=e.getContext("2d");return a.drawImage(c,0,0,t,i),a.translate(2*t,0),a.scale(-1,1),a.drawImage(c,0,0,t,i),e},Hv=function(c){const e=document.createElement("canvas"),t=c.width,i=c.height;e.width=t,e.height=i*2;const a=e.getContext("2d");return a.drawImage(c,0,0,t,i),a.translate(0,2*i),a.scale(1,-1),a.drawImage(c,0,0,t,i),e},bl=function(c){const e=document.createElement("canvas"),t=c.width,i=c.height;e.width=2*t,e.height=2*i;const a=e.getContext("2d");return a.drawImage(c,0,0,t,i),a.setTransform(-1,0,0,-1,e.width,e.height),a.drawImage(c,0,0,t,i),a.setTransform(-1,0,0,1,e.width,0),a.drawImage(c,0,0,t,i),a.setTransform(1,0,0,-1,0,e.height),a.drawImage(c,0,0,t,i),e},X2=function(c,e){const t=c.width,i=c.height,a=document.createElement("canvas");a.width=t*3,a.height=i*3;const d=a.getContext("2d"),f=e.angle!=null?-e.angle:-20,m=ri.toRad(f),y=a.width/4,x=a.height/4;for(let E=0;E<4;E+=1)for(let S=0;S<4;S+=1)(E+S)%2>0&&(d.setTransform(1,0,0,1,(2*E-1)*y,(2*S-1)*x),d.rotate(m),d.drawImage(c,-t/2,-i/2,t,i));return a};var Lh;(function(c){c.presets=Object.assign({},Me),c.presets["flip-x"]=jv,c.presets["flip-y"]=Hv,c.presets["flip-xy"]=bl,c.registry=Oo.create({type:"background pattern"}),c.registry.register(c.presets,!0)})(Lh||(Lh={}));const Hs={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,trackable:!1,trackInfo:{},track(c){Hs.trackable=c}};var Bo;(function(c){c.snapToGrid=xv,c.normalizeMarker=Eu;function e(t){return`${Hs.prefixCls}-${t}`}c.prefix=e})(Bo||(Bo={})),function(c){function e(t,i,a,d=[]){const f=typeof i.children=="function"?i.children(t):t[i.children||"children"];return a||(a=i.createNode(t),d.push(a)),Array.isArray(f)&&f.forEach(m=>{const y=i.createNode(m),x=i.createEdge(a,y);d.push(y,x),this.makeTree(m,i,y,d)}),d}c.makeTree=e}(Bo||(Bo={}));const $v=Bo.prefix("highlighted"),Y2={highlight(c,e,t){const i=t&&t.className||$v;vi(e,i)},unhighlight(c,e,t){const i=t&&t.className||$v;Wa(e,i)}},Wv=Bo.prefix("highlight-opacity"),K2={highlight(c,e){vi(e,Wv)},unhighlight(c,e){Wa(e,Wv)}},q2={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},J2={highlight(c,e,t){const i=Su.getHighlighterId(e,t);if(Su.hasCache(i))return;t=$p({},t,q2);const a=In.create(e);let d,f;try{d=a.toPathData()}catch{f=a.bbox(!0),d=Zm(Object.assign(Object.assign({},t),f))}const m=ma("path");if(yi(m,Object.assign({d,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},t.attrs?Kf(t.attrs):null)),c.isEdgeElement(e))yi(m,"d",c.getConnectionPathData());else{let E=a.getTransformToElement(c.container);const S=t.padding;if(S){f==null&&(f=a.bbox(!0));const T=f.x+f.width/2,R=f.y+f.height/2;f=va(f,E);const V=Math.max(f.width,1),j=Math.max(f.height,1),q=(V+S)/V,ue=(j+S)/j,be=On({a:q,b:0,c:0,d:ue,e:T-q*T,f:R-ue*R});E=E.multiply(be)}Nh(m,E)}vi(m,Bo.prefix("highlight-stroke"));const y=c.cell,x=()=>Su.removeHighlighter(i);y.on("removed",x),y.model&&y.model.on("reseted",x),c.container.appendChild(m),Su.setCache(i,m)},unhighlight(c,e,t){Su.removeHighlighter(Su.getHighlighterId(e,t))}};var Su;(function(c){function e(f,m){return Ph(f),f.id+JSON.stringify(m)}c.getHighlighterId=e;const t={};function i(f,m){t[f]=m}c.setCache=i;function a(f){return t[f]!=null}c.hasCache=a;function d(f){const m=t[f];m&&(Jl(m),delete t[f])}c.removeHighlighter=d})(Su||(Su={}));var Xa;(function(c){function e(t,i){if(typeof i.highlight!="function")throw new Error(`Highlighter '${t}' is missing required \`highlight()\` method`);if(typeof i.unhighlight!="function")throw new Error(`Highlighter '${t}' is missing required \`unhighlight()\` method`)}c.check=e})(Xa||(Xa={})),function(c){c.presets=Se,c.registry=Oo.create({type:"highlighter"}),c.registry.register(c.presets,!0)}(Xa||(Xa={}));function Zv(c,e={}){return new Oe(Lc(e.x,c.width),Lc(e.y,c.height))}function t0(c,e,t){return Object.assign({angle:e,position:c.toJSON()},t)}const rp=(c,e)=>c.map(({x:t,y:i,angle:a})=>t0(Zv(e,{x:t,y:i}),a||0)),Q2=(c,e,t)=>{const i=t.start||0,a=t.step||20;return Xv(c,e,i,(d,f)=>(d+.5-f/2)*a)},ex=(c,e,t)=>{const i=t.start||0,a=t.step||360/c.length;return Xv(c,e,i,d=>d*a)};function Xv(c,e,t,i){const a=e.getCenter(),d=e.getTopCenter(),f=e.width/e.height,m=gl.fromRect(e),y=c.length;return c.map((x,E)=>{const S=t+i(E,y),T=d.clone().rotate(-S,a).scale(f,1,a),R=x.compensateRotate?-m.tangentTheta(T):0;return(x.dx||x.dy)&&T.translate(x.dx||0,x.dy||0),x.dr&&T.move(a,x.dr),t0(T.round(),R,x)})}var tx=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const nx=(c,e,t)=>{const i=Zv(e,t.start||e.getOrigin()),a=Zv(e,t.end||e.getCorner());return op(c,i,a,t)},rx=(c,e,t)=>op(c,e.getTopLeft(),e.getBottomLeft(),t),ip=(c,e,t)=>op(c,e.getTopRight(),e.getBottomRight(),t),ix=(c,e,t)=>op(c,e.getTopLeft(),e.getTopRight(),t),ox=(c,e,t)=>op(c,e.getBottomLeft(),e.getBottomRight(),t);function op(c,e,t,i){const a=new zn(e,t),d=c.length;return c.map((f,m)=>{var{strict:y}=f,x=tx(f,["strict"]);const E=y||i.strict?(m+1)/(d+1):(m+.5)/d,S=a.pointAt(E);return(x.dx||x.dy)&&S.translate(x.dx||0,x.dy||0),t0(S.round(),0,x)})}var Au;(function(c){c.presets=ee,c.registry=Oo.create({type:"port layout"}),c.registry.register(c.presets,!0)})(Au||(Au={}));const sx={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function Tu(c,e){const{x:t,y:i,angle:a,attrs:d}=e||{};return $p({},{angle:a,attrs:d,position:{x:t,y:i}},c,sx)}const Yv=(c,e,t)=>Tu({position:e.getTopLeft()},t),oE=(c,e,t)=>Tu({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},t),ax=(c,e,t)=>Tu({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},t),Kv=(c,e,t)=>Tu({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},t),qv=(c,e,t)=>Tu({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},t),lx=(c,e,t)=>Cg(c,e,!1,t),cx=(c,e,t)=>Cg(c,e,!0,t),ux=(c,e,t)=>Jv(c,e,!1,t),dx=(c,e,t)=>Jv(c,e,!0,t);function Cg(c,e,t,i){const a=i.offset!=null?i.offset:15,d=e.getCenter().theta(c),f=Qv(e);let m,y,x,E,S=0;return d<f[1]||d>f[2]?(m=".3em",y=a,x=0,E="start"):d<f[0]?(m="0",y=0,x=-a,t?(S=-90,E="start"):E="middle"):d<f[3]?(m=".3em",y=-a,x=0,E="end"):(m=".6em",y=0,x=a,t?(S=90,E="start"):E="middle"),Tu({position:{x:Math.round(y),y:Math.round(x)},angle:S,attrs:{".":{y:m,"text-anchor":E}}},i)}function Jv(c,e,t,i){const a=i.offset!=null?i.offset:15,d=e.getCenter().theta(c),f=Qv(e);let m,y,x,E,S=0;return d<f[1]||d>f[2]?(m=".3em",y=-a,x=0,E="end"):d<f[0]?(m=".6em",y=0,x=a,t?(S=90,E="start"):E="middle"):d<f[3]?(m=".3em",y=a,x=0,E="start"):(m="0em",y=0,x=-a,t?(S=-90,E="start"):E="middle"),Tu({position:{x:Math.round(y),y:Math.round(x)},angle:S,attrs:{".":{y:m,"text-anchor":E}}},i)}function Qv(c){const e=c.getCenter(),t=e.theta(c.getTopLeft()),i=e.theta(c.getBottomLeft()),a=e.theta(c.getBottomRight()),d=e.theta(c.getTopRight());return[t,d,a,i]}const hx=(c,e,t)=>px(c.diff(e.getCenter()),!1,t),fx=(c,e,t)=>px(c.diff(e.getCenter()),!0,t);function px(c,e,t){const i=t.offset!=null?t.offset:20,a=new Oe(0,0),d=-c.theta(a),f=c.clone().move(a,i).diff(c).round();let m=".3em",y,x=d;return(d+90)%180===0?(y=e?"end":"middle",!e&&d===-270&&(m="0em")):d>-270&&d<-90?(y="start",x=d-180):y="end",Tu({position:f.round().toJSON(),angle:e?x:0,attrs:{".":{y:m,"text-anchor":y}}},t)}var Fh;(function(c){c.presets=oe,c.registry=Oo.create({type:"port label layout"}),c.registry.register(c.presets,!0)})(Fh||(Fh={}));class Mu{constructor(e,t,i,a){if(e==null)return this.set(255,255,255,1);if(typeof e=="number")return this.set(e,t,i,a);if(typeof e=="string")return Mu.fromString(e)||this;if(Array.isArray(e))return this.set(e);this.set(e.r,e.g,e.b,e.a==null?1:e.a)}blend(e,t,i){this.set(e.r+(t.r-e.r)*i,e.g+(t.g-e.g)*i,e.b+(t.b-e.b)*i,e.a+(t.a-e.a)*i)}lighten(e){const t=Mu.lighten(this.toArray(),e);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}darken(e){this.lighten(-e)}set(e,t,i,a){const d=Array.isArray(e)?e[0]:e,f=Array.isArray(e)?e[1]:t,m=Array.isArray(e)?e[2]:i,y=Array.isArray(e)?e[3]:a;return this.r=Math.round(Ta(d,0,255)),this.g=Math.round(Ta(f,0,255)),this.b=Math.round(Ta(m,0,255)),this.a=y==null?1:Ta(y,0,1),this}toHex(){return`#${["r","g","b"].map(t=>{const i=this[t].toString(16);return i.length<2?`0${i}`:i}).join("")}`}toRGBA(){return this.toArray()}toHSLA(){return Mu.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(e){const t=`${this.r},${this.g},${this.b},`;return e?`rgb(${t})`:`rgba(${t},${this.a})`}toGrey(){return Mu.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}}(function(c){function e(se){return new c(se)}c.fromArray=e;function t(se){return new c([...V(se),1])}c.fromHex=t;function i(se){const Pe=se.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(Pe){const He=Pe[1].split(/\s*,\s*/).map(ft=>parseInt(ft,10));return new c(He)}return null}c.fromRGBA=i;function a(se,Pe,He){He<0&&++He,He>1&&--He;const ft=6*He;return ft<1?se+(Pe-se)*ft:2*He<1?Pe:3*He<2?se+(Pe-se)*(2/3-He)*6:se}function d(se){const Pe=se.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(Pe){const He=Pe[2].split(/\s*,\s*/),ft=(parseFloat(He[0])%360+360)%360/360,pt=parseFloat(He[1])/100,kt=parseFloat(He[2])/100,cn=He[3]==null?1:parseInt(He[3],10);return new c(x(ft,pt,kt,cn))}return null}c.fromHSLA=d;function f(se){if(se.startsWith("#"))return t(se);if(se.startsWith("rgb"))return i(se);const Pe=c.named[se];return Pe?t(Pe):d(se)}c.fromString=f;function m(se,Pe){return c.fromArray([se,se,se,Pe])}c.makeGrey=m;function y(se,Pe,He,ft){const pt=Array.isArray(se)?se[0]:se,kt=Array.isArray(se)?se[1]:Pe,cn=Array.isArray(se)?se[2]:He,Bt=Array.isArray(se)?se[3]:ft,Xt=Math.max(pt,kt,cn),on=Math.min(pt,kt,cn),fr=(Xt+on)/2;let Cr=0,St=0;if(on!==Xt){const dn=Xt-on;switch(St=fr>.5?dn/(2-Xt-on):dn/(Xt+on),Xt){case pt:Cr=(kt-cn)/dn+(kt<cn?6:0);break;case kt:Cr=(cn-pt)/dn+2;break;case cn:Cr=(pt-kt)/dn+4;break;default:break}Cr/=6}return[Cr,St,fr,Bt??1]}c.rgba2hsla=y;function x(se,Pe,He,ft){const pt=Array.isArray(se)?se[0]:se,kt=Array.isArray(se)?se[1]:Pe,cn=Array.isArray(se)?se[2]:He,Bt=Array.isArray(se)?se[3]:ft,Xt=cn<=.5?cn*(kt+1):cn+kt-cn*kt,on=2*cn-Xt;return[a(on,Xt,pt+1/3)*256,a(on,Xt,pt)*256,a(on,Xt,pt-1/3)*256,Bt??1]}c.hsla2rgba=x;function E(se){return new c(Math.round(Math.random()*256),Math.round(Math.random()*256),Math.round(Math.random()*256),se?void 0:parseFloat(Math.random().toFixed(2)))}c.random=E;function S(){const se="0123456789ABCDEF";let Pe="#";for(let He=0;He<6;He+=1)Pe+=se[Math.floor(Math.random()*16)];return Pe}c.randomHex=S;function T(se){return E(se).toString()}c.randomRGBA=T;function R(se,Pe){if(typeof se=="string"){const cn=se[0]==="#",[Bt,Xt,on]=V(se);return Pe?Bt*.299+Xt*.587+on*.114>186?"#000000":"#ffffff":`${cn?"#":""}${j(255-Bt,255-Xt,255-on)}`}const He=se[0],ft=se[1],pt=se[2],kt=se[3];return Pe?He*.299+ft*.587+pt*.114>186?[0,0,0,kt]:[255,255,255,kt]:[255-He,255-ft,255-pt,kt]}c.invert=R;function V(se){const Pe=se.indexOf("#")===0?se:`#${se}`;let He=Number(`0x${Pe.substr(1)}`);if(!(Pe.length===4||Pe.length===7)||Number.isNaN(He))throw new Error("Invalid hex color.");const ft=Pe.length===4?4:8,pt=(1<<ft)-1,kt=["b","g","r"].map(()=>{const cn=He&pt;return He>>=ft,ft===4?17*cn:cn});return[kt[2],kt[1],kt[0]]}function j(se,Pe,He){const ft=pt=>pt.length<2?`0${pt}`:pt;return`${ft(se.toString(16))}${ft(Pe.toString(16))}${ft(He.toString(16))}`}function q(se,Pe){return be(se,Pe)}c.lighten=q;function ue(se,Pe){return be(se,-Pe)}c.darken=ue;function be(se,Pe){if(typeof se=="string"){const pt=se[0]==="#",kt=parseInt(pt?se.substr(1):se,16),cn=Ta((kt>>16)+Pe,0,255),Bt=Ta((kt>>8&255)+Pe,0,255),Xt=Ta((kt&255)+Pe,0,255);return`${pt?"#":""}${(Xt|Bt<<8|cn<<16).toString(16)}`}const He=j(se[0],se[1],se[2]),ft=V(be(He,Pe));return[ft[0],ft[1],ft[2],se[3]]}})(Mu||(Mu={})),function(c){c.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(Mu||(Mu={}));class sE{constructor(){this.listeners={}}on(e,t,i){return t==null?this:(this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t,i),this)}once(e,t,i){const a=(...d)=>(this.off(e,a),Dd.call([t,i],d));return this.on(e,a,this)}off(e,t,i){if(!(e||t||i))return this.listeners={},this;const a=this.listeners;return(e?[e]:Object.keys(a)).forEach(f=>{const m=a[f];if(!!m){if(!(t||i)){delete a[f];return}for(let y=m.length-2;y>=0;y-=2)t&&m[y]!==t||i&&m[y+1]!==i||m.splice(y,2)}}),this}trigger(e,...t){let i=!0;if(e!=="*"){const d=this.listeners[e];d!=null&&(i=Dd.call([...d],t))}const a=this.listeners["*"];return a!=null?Pm([i,Dd.call([...a],[e,...t])]):i}emit(e,...t){return this.trigger(e,...t)}}var Dd;(function(c){function e(t,i){const a=[];for(let d=0;d<t.length;d+=2){const f=t[d],m=t[d+1],y=Array.isArray(i)?i:[i],x=Tm(f,m,y);a.push(x)}return Pm(a)}c.call=e})(Dd||(Dd={}));class xl{get disposed(){return this._disposed===!0}dispose(){this._disposed=!0}}(function(c){function e(){return(t,i,a)=>{const d=a.value,f=t.__proto__;a.value=function(){this.disposed||(d.call(this),f.dispose.call(this))}}}c.dispose=e})(xl||(xl={}));class aE{constructor(e){this.callback=e}get disposed(){return!this.callback}dispose(){if(!this.callback)return;const e=this.callback;this.callback=null,e()}}class ey{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach(e=>{e.dispose()}),this.items.clear())}contains(e){return this.items.has(e)}add(e){this.items.add(e)}remove(e){this.items.delete(e)}clear(){this.items.clear()}}(function(c){function e(t){const i=new c;return t.forEach(a=>{i.add(a)}),i}c.from=e})(ey||(ey={}));class Is extends sE{}(function(c){c.dispose=xl.dispose})(Is||(Is={})),Ef(Is,xl);class ty extends Is{get disabled(){return this._disabled===!0}enable(){delete this._disabled}disable(){this._disabled=!0}}var gx=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class wg extends xl{constructor(){super(),this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(e){return this.map.has(e)}get(e){return this.map.get(e)}set(e,t){this.map.set(e,t),this.arr.push(e)}delete(e){const t=this.arr.indexOf(e);t>=0&&this.arr.splice(t,1);const i=this.map.get(e);return this.map.delete(e),i}each(e){this.arr.forEach(t=>{const i=this.map.get(t);e(i,t)})}dispose(){this.clear()}}gx([xl.dispose()],wg.prototype,"dispose",null);class Bc{constructor(e={}){this.comparator=e.comparator||Bc.defaultComparator,this.index={},this.data=e.data||[],this.heapify()}isEmpty(){return this.data.length===0}insert(e,t,i){const a={priority:e,value:t},d=this.data.length-1;return i&&(a.id=i,this.index[i]=d),this.data.push(a),this.bubbleUp(d),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(e,t){const i=this.index[e];if(typeof i>"u")throw new Error(`Node with id '${e}' was not found in the heap.`);const a=this.data,d=a[i].priority,f=this.comparator(t,d);f<0?(a[i].priority=t,this.bubbleUp(i)):f>0&&(a[i].priority=t,this.bubbleDown(i))}remove(){const e=this.data,t=e[0],i=e.pop();return delete this.index[e.length],e.length>0&&(e[0]=i,i.id&&(this.index[i.id]=0),this.bubbleDown(0)),t?t.value:null}heapify(){for(let e=0;e<this.data.length;e+=1)this.bubbleUp(e)}bubbleUp(e){const t=this.data;let i,a,d=e;for(;d>0&&(a=d-1>>>1,this.comparator(t[d].priority,t[a].priority)<0);){i=t[a],t[a]=t[d];let f=t[d].id;f!=null&&(this.index[f]=a),t[d]=i,f=t[d].id,f!=null&&(this.index[f]=d),d=a}}bubbleDown(e){const t=this.data,i=t.length-1;let a=e;for(;;){const d=(a<<1)+1,f=d+1;let m=a;if(d<=i&&this.comparator(t[d].priority,t[m].priority)<0&&(m=d),f<=i&&this.comparator(t[f].priority,t[m].priority)<0&&(m=f),m!==a){const y=t[m];t[m]=t[a];let x=t[a].id;x!=null&&(this.index[x]=m),t[a]=y,x=t[a].id,x!=null&&(this.index[x]=a),a=m}else break}}}(function(c){c.defaultComparator=(e,t)=>e-t})(Bc||(Bc={}));var n0;(function(c){function e(t,i,a=(d,f)=>1){const d={},f={},m={},y=new Bc;for(d[i]=0,Object.keys(t).forEach(x=>{x!==i&&(d[x]=1/0),y.insert(d[x],x,x)});!y.isEmpty();){const x=y.remove();m[x]=!0;const E=t[x]||[];for(let S=0;S<E.length;S+=1){const T=E[S];if(!m[T]){const R=d[x]+a(x,T);R<d[T]&&(d[T]=R,f[T]=x,y.updatePriority(T,R))}}}return f}c.run=e})(n0||(n0={}));var _d;(function(c){c.linear=e=>e,c.quad=e=>e*e,c.cubic=e=>e*e*e,c.inout=e=>{if(e<=0)return 0;if(e>=1)return 1;const t=e*e,i=t*e;return 4*(e<.5?i:3*(e-t)+i-.75)},c.exponential=e=>Math.pow(2,10*(e-1)),c.bounce=e=>{for(let t=0,i=1;;t+=i,i/=2)if(e>=(7-4*t)/11){const a=(11-6*t-11*e)/4;return-a*a+i*i}}})(_d||(_d={})),function(c){c.decorators={reverse(e){return t=>1-e(1-t)},reflect(e){return t=>.5*(t<.5?e(2*t):2-e(2-2*t))},clamp(e,t=0,i=1){return a=>{const d=e(a);return d<t?t:d>i?i:d}},back(e=1.70158){return t=>t*t*((e+1)*t-e)},elastic(e=1.5){return t=>Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}}(_d||(_d={})),function(c){function e(St){return-1*Math.cos(St*(Math.PI/2))+1}c.easeInSine=e;function t(St){return Math.sin(St*(Math.PI/2))}c.easeOutSine=t;function i(St){return-.5*(Math.cos(Math.PI*St)-1)}c.easeInOutSine=i;function a(St){return St*St}c.easeInQuad=a;function d(St){return St*(2-St)}c.easeOutQuad=d;function f(St){return St<.5?2*St*St:-1+(4-2*St)*St}c.easeInOutQuad=f;function m(St){return St*St*St}c.easeInCubic=m;function y(St){const dn=St-1;return dn*dn*dn+1}c.easeOutCubic=y;function x(St){return St<.5?4*St*St*St:(St-1)*(2*St-2)*(2*St-2)+1}c.easeInOutCubic=x;function E(St){return St*St*St*St}c.easeInQuart=E;function S(St){const dn=St-1;return 1-dn*dn*dn*dn}c.easeOutQuart=S;function T(St){const dn=St-1;return St<.5?8*St*St*St*St:1-8*dn*dn*dn*dn}c.easeInOutQuart=T;function R(St){return St*St*St*St*St}c.easeInQuint=R;function V(St){const dn=St-1;return 1+dn*dn*dn*dn*dn}c.easeOutQuint=V;function j(St){const dn=St-1;return St<.5?16*St*St*St*St*St:1+16*dn*dn*dn*dn*dn}c.easeInOutQuint=j;function q(St){return St===0?0:Math.pow(2,10*(St-1))}c.easeInExpo=q;function ue(St){return St===1?1:-Math.pow(2,-10*St)+1}c.easeOutExpo=ue;function be(St){if(St===0||St===1)return St;const dn=St*2,ur=dn-1;return dn<1?.5*Math.pow(2,10*ur):.5*(-Math.pow(2,-10*ur)+2)}c.easeInOutExpo=be;function se(St){const dn=St/1;return-1*(Math.sqrt(1-dn*St)-1)}c.easeInCirc=se;function Pe(St){const dn=St-1;return Math.sqrt(1-dn*dn)}c.easeOutCirc=Pe;function He(St){const dn=St*2,ur=dn-2;return dn<1?-.5*(Math.sqrt(1-dn*dn)-1):.5*(Math.sqrt(1-ur*ur)+1)}c.easeInOutCirc=He;function ft(St,dn=1.70158){return St*St*((dn+1)*St-dn)}c.easeInBack=ft;function pt(St,dn=1.70158){const ur=St/1-1;return ur*ur*((dn+1)*ur+dn)+1}c.easeOutBack=pt;function kt(St,dn=1.70158){const ur=St*2,Ni=ur-2,Gi=dn*1.525;return ur<1?.5*ur*ur*((Gi+1)*ur-Gi):.5*(Ni*Ni*((Gi+1)*Ni+Gi)+2)}c.easeInOutBack=kt;function cn(St,dn=.7){if(St===0||St===1)return St;const Ni=St/1-1,Gi=1-dn,cs=Gi/(2*Math.PI)*Math.asin(1);return-(Math.pow(2,10*Ni)*Math.sin((Ni-cs)*(2*Math.PI)/Gi))}c.easeInElastic=cn;function Bt(St,dn=.7){const ur=1-dn,Ni=St*2;if(St===0||St===1)return St;const Gi=ur/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*Ni)*Math.sin((Ni-Gi)*(2*Math.PI)/ur)+1}c.easeOutElastic=Bt;function Xt(St,dn=.65){const ur=1-dn;if(St===0||St===1)return St;const Ni=St*2,Gi=Ni-1,cs=ur/(2*Math.PI)*Math.asin(1);return Ni<1?-.5*(Math.pow(2,10*Gi)*Math.sin((Gi-cs)*(2*Math.PI)/ur)):Math.pow(2,-10*Gi)*Math.sin((Gi-cs)*(2*Math.PI)/ur)*.5+1}c.easeInOutElastic=Xt;function on(St){const dn=St/1;if(dn<1/2.75)return 7.5625*dn*dn;if(dn<2/2.75){const ur=dn-.5454545454545454;return 7.5625*ur*ur+.75}if(dn<2.5/2.75){const ur=dn-.8181818181818182;return 7.5625*ur*ur+.9375}{const ur=dn-.9545454545454546;return 7.5625*ur*ur+.984375}}c.easeOutBounce=on;function fr(St){return 1-on(1-St)}c.easeInBounce=fr;function Cr(St){return St<.5?fr(St*2)*.5:on(St*2-1)*.5+.5}c.easeInOutBounce=Cr}(_d||(_d={}));var Nd;(function(c){c.number=(e,t)=>{const i=t-e;return a=>e+i*a},c.object=(e,t)=>{const i=Object.keys(e);return a=>{const d={};for(let f=i.length-1;f!==-1;f-=1){const m=i[f];d[m]=e[m]+(t[m]-e[m])*a}return d}},c.unit=(e,t)=>{const i=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,a=i.exec(e),d=i.exec(t),f=d?d[1]:"",m=a?+a[1]:0,y=d?+d[1]:0,x=f.indexOf("."),E=x>0?f[1].length-x-1:0,S=y-m,T=a?a[2]:"";return R=>(m+S*R).toFixed(E)+T},c.color=(e,t)=>{const i=parseInt(e.slice(1),16),a=parseInt(t.slice(1),16),d=i&255,f=(a&255)-d,m=i&65280,y=(a&65280)-m,x=i&16711680,E=(a&16711680)-x;return S=>{const T=d+f*S&255,R=m+y*S&65280,V=x+E*S&16711680;return`#${(1<<24|T|R|V).toString(16).slice(1)}`}}})(Nd||(Nd={}));var ny;(function(c){const e=`${Hs.prefixCls}.storage`;function t(S,T,R){const V=T.id||zt("doc-"),j=y(S);j.keys.push(V),f(x(S,V),T),f(E(S),j),d(R,null,Object.assign(Object.assign({},T),{id:V}))}c.insert=t;function i(S,T,R){const V=y(S),j=[];if(T==null)V.keys.forEach(q=>{const ue=m(x(S,q));ue?j.push(ue):d(R,new Error(`No document found for an ID '${q}' from index.`))}),d(R,null,j);else if(T.id){const q=m(x(S,T.id));d(R,null,q?[q]:[])}else d(R,null,[])}c.find=i;function a(S,T,R){const V=y(S);if(T==null)V.keys.forEach(j=>{localStorage.removeItem(x(S,j))}),localStorage.removeItem(E(S)),d(R,null);else if(T.id){const j=V.keys.indexOf(T.id);j>=0&&V.keys.splice(j,1),localStorage.removeItem(x(S,T.id)),f(E(S),V),d(R,null)}}c.remove=a;function d(S,T,R){S&&Nb(()=>{S(T,R)})}function f(S,T){localStorage.setItem(S,JSON.stringify(T))}function m(S){const T=localStorage.getItem(S);return T?JSON.parse(T):null}function y(S){const T=m(E(S));return T?(T.keys==null&&(T.keys=[]),T):{keys:[]}}function x(S,T){return`${e}.${S}.docs.${T}`}function E(S){return`${e}.${S}.index`}})(ny||(ny={}));class ii extends Is{constructor(){super(),this.cid=ry.uniqueId(),ii.views[this.cid]=this}get priority(){return 2}confirmUpdate(e,t){return 0}$(e){return ii.$(e)}empty(e=this.container){return this.$(e).empty(),this}unmount(e=this.container){return this.$(e).remove(),this}remove(e=this.container){return e===this.container&&(this.removeEventListeners(document),this.onRemove(),delete ii.views[this.cid]),this.unmount(e),this}onRemove(){}setClass(e,t=this.container){t.classList.value=Array.isArray(e)?e.join(" "):e}addClass(e,t=this.container){return this.$(t).addClass(Array.isArray(e)?e.join(" "):e),this}removeClass(e,t=this.container){return this.$(t).removeClass(Array.isArray(e)?e.join(" "):e),this}setStyle(e,t=this.container){return this.$(t).css(e),this}setAttrs(e,t=this.container){return e!=null&&t!=null&&(t instanceof SVGElement?yi(t,e):this.$(t).attr(e)),this}findAttr(e,t=this.container){let i=t;for(;i&&i.nodeType===1;){const a=i.getAttribute(e);if(a!=null)return a;if(i===this.container)return null;i=i.parentNode}return null}find(e,t=this.container,i=this.selectors){return ii.find(e,t,i).elems}findOne(e,t=this.container,i=this.selectors){const a=this.find(e,t,i);return a.length>0?a[0]:null}findByAttr(e,t=this.container){let i=t;for(;i&&i.getAttribute;){const a=i.getAttribute(e);if((a!=null||i===this.container)&&a!=="false")return i;i=i.parentNode}return null}getSelector(e,t){let i;if(e===this.container)return typeof t=="string"&&(i=`> ${t}`),i;if(e){const a=Nm(e)+1;i=`${e.tagName.toLowerCase()}:nth-child(${a})`,t&&(i+=` > ${t}`),i=this.getSelector(e.parentNode,i)}return i}prefixClassName(e){return Bo.prefix(e)}delegateEvents(e,t){if(e==null)return this;t||this.undelegateEvents();const i=/^(\S+)\s*(.*)$/;return Object.keys(e).forEach(a=>{const d=a.match(i);if(d==null)return;const f=this.getEventHandler(e[a]);typeof f=="function"&&this.delegateEvent(d[1],d[2],f)}),this}undelegateEvents(){return this.$(this.container).off(this.getEventNamespace()),this}delegateDocumentEvents(e,t){return this.addEventListeners(document,e,t),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(e,t,i){return this.$(this.container).on(e+this.getEventNamespace(),t,i),this}undelegateEvent(e,t,i){const a=e+this.getEventNamespace();return t==null?this.$(this.container).off(a):typeof t=="string"?this.$(this.container).off(a,t,i):this.$(this.container).off(a,t),this}addEventListeners(e,t,i){if(t==null)return this;const a=this.getEventNamespace(),d=this.$(e);return Object.keys(t).forEach(f=>{const m=this.getEventHandler(t[f]);typeof m=="function"&&d.on(f+a,i,m)}),this}removeEventListeners(e){return e!=null&&this.$(e).off(this.getEventNamespace()),this}getEventNamespace(){return`.${Hs.prefixCls}-event-${this.cid}`}getEventHandler(e){let t;if(typeof e=="string"){const i=this[e];typeof i=="function"&&(t=(...a)=>i.call(this,...a))}else t=(...i)=>e.call(this,...i);return t}getEventTarget(e,t={}){const{target:i,type:a,clientX:d=0,clientY:f=0}=e;return t.fromPoint||a==="touchmove"||a==="touchend"?document.elementFromPoint(d,f):i}stopPropagation(e){return this.setEventData(e,{propagationStopped:!0}),this}isPropagationStopped(e){return this.getEventData(e).propagationStopped===!0}getEventData(e){return this.eventData(e)}setEventData(e,t){return this.eventData(e,t)}eventData(e,t){if(e==null)throw new TypeError("Event object required");let i=e.data;const a=`__${this.cid}__`;return t==null?i==null?{}:i[a]||{}:(i==null&&(i=e.data={}),i[a]==null?i[a]=Object.assign({},t):i[a]=Object.assign(Object.assign({},i[a]),t),i[a])}normalizeEvent(e){return ii.normalizeEvent(e)}}(function(c){function e(d){return N()(d)}c.$=e;function t(d,f){return f?ma(d||"g"):_m(d||"div")}c.createElement=t;function i(d,f,m){if(!d||d===".")return{elems:[f]};if(m){const y=m[d];if(y)return{elems:Array.isArray(y)?y:[y]}}return Hs.useCSSSelector?{isCSSSelector:!0,elems:e(f).find(d).toArray()}:{elems:[]}}c.find=i;function a(d){let f=d;const m=d.originalEvent,y=m&&m.changedTouches&&m.changedTouches[0];if(y){for(const E in d)y[E]===void 0&&(y[E]=d[E]);f=y}const x=f.target;if(x){const E=x.correspondingUseElement;E&&(f.target=E)}return f}c.normalizeEvent=a})(ii||(ii={})),function(c){c.views={};function e(t){return c.views[t]||null}c.getView=e}(ii||(ii={}));var ry;(function(c){let e=0;function t(){const i=`v${e}`;return e+=1,i}c.uniqueId=t})(ry||(ry={}));const lE=c=>c;function mx(c,e){return e===0?"0%":`${Math.round(c/e*100)}%`}function vx(c){return(t,i,a,d)=>i.isEdgeElement(a)?bx(c,t,i,a,d):yx(c,t,i,a,d)}function yx(c,e,t,i,a){const d=t.cell,f=d.getAngle(),m=t.getUnrotatedBBoxOfElement(i),y=d.getBBox().getCenter(),x=Oe.create(a).rotate(f,y);let E=x.x-m.x,S=x.y-m.y;return c&&(E=mx(E,m.width),S=mx(S,m.height)),e.anchor={name:"topLeft",args:{dx:E,dy:S,rotate:!0}},e}function bx(c,e,t,i,a){const d=t.getConnection();if(!d)return e;const f=d.closestPointLength(a);if(c){const m=d.length();e.anchor={name:"ratio",args:{ratio:f/m}}}else e.anchor={name:"length",args:{length:f}};return e}const xx=vx(!0),Cx=vx(!1);var kd;(function(c){c.presets=Ae,c.registry=Oo.create({type:"connection strategy"}),c.registry.register(c.presets,!0)})(kd||(kd={}));class Eg{constructor(e){this.view=e,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new wg,this.pathCache={}}get(e){return this.elemCache.has(e)||this.elemCache.set(e,{}),this.elemCache.get(e)}getData(e){const t=this.get(e);return t.data||(t.data={}),t.data}getMatrix(e){const t=this.get(e);if(t.matrix==null){const i=this.view.rotatableNode||this.view.container;t.matrix=Cu(e,i)}return On(t.matrix)}getShape(e){const t=this.get(e);return t.shape==null&&(t.shape=Dv(e)),t.shape.clone()}getBoundingRect(e){const t=this.get(e);return t.boundingRect==null&&(t.boundingRect=Pr(e)),t.boundingRect.clone()}}var li;(function(c){function e(E){return E!=null&&!t(E)}c.isJSONMarkup=e;function t(E){return E!=null&&typeof E=="string"}c.isStringMarkup=t;function i(E){return E==null||t(E)?E:qi(E)}c.clone=i;function a(E){return`${E}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")}c.sanitize=a;function d(E){const S=document.createDocumentFragment(),T={},R={},V=a(E);return Am(V,{raw:!0}).forEach(q=>{S.appendChild(q)}),{fragment:S,selectors:R,groups:T}}c.parseStringMarkup=d;function f(E,S={ns:Fo.svg}){const T=document.createDocumentFragment(),R={},V={},j=[{markup:Array.isArray(E)?E:[E],parent:T,ns:S.ns}];for(;j.length>0;){const q=j.pop();let ue=q.ns||Fo.svg;const be=q.markup,se=q.parent;be.forEach(Pe=>{const He=Pe.tagName;if(!He)throw new TypeError("Invalid tagName");Pe.ns&&(ue=Pe.ns);const ft=ue===Fo.svg,pt=ue?_m(He,ue):cg(He),kt=Pe.attrs;kt&&(ft?yi(pt,Kf(kt)):N()(pt).attr(kt));const cn=Pe.style;cn&&N()(pt).css(cn);const Bt=Pe.className;Bt!=null&&pt.setAttribute("class",Array.isArray(Bt)?Bt.join(" "):Bt),Pe.textContent&&(pt.textContent=Pe.textContent);const Xt=Pe.selector;if(Xt!=null){if(V[Xt])throw new TypeError("Selector must be unique");V[Xt]=pt}if(Pe.groupSelector){let fr=Pe.groupSelector;Array.isArray(fr)||(fr=[fr]),fr.forEach(Cr=>{R[Cr]||(R[Cr]=[]),R[Cr].push(pt)})}se.appendChild(pt);const on=Pe.children;Array.isArray(on)&&j.push({ns:ue,markup:on,parent:pt})})}return Object.keys(R).forEach(q=>{if(V[q])throw new Error("Ambiguous group selector");V[q]=R[q]}),{fragment:T,selectors:V,groups:R}}c.parseJSONMarkup=f;function m(E){return E instanceof SVGElement?ma("g"):cg("div")}function y(E){if(t(E)){const V=In.createVectors(E),j=V.length;if(j===1)return{elem:V[0].node};if(j>1){const q=m(V[0].node);return V.forEach(ue=>{q.appendChild(ue.node)}),{elem:q}}return{}}const S=f(E),T=S.fragment;let R=null;return T.childNodes.length>1?(R=m(T.firstChild),R.appendChild(T)):R=T.firstChild,{elem:R,selectors:S.selectors}}c.renderMarkup=y;function x(E){const S=In.createVectors(E),T=document.createDocumentFragment();for(let R=0,V=S.length;R<V;R+=1){const j=S[R].node;T.appendChild(j)}return{fragment:T,selectors:{}}}c.parseLabelStringMarkup=x})(li||(li={})),function(c){function e(a,d,f){if(a!=null){let m;const y=a.tagName.toLowerCase();if(a===d)return typeof f=="string"?m=`> ${y} > ${f}`:m=`> ${y}`,m;const x=a.parentNode;if(x&&x.childNodes.length>1){const E=Nm(a)+1;m=`${y}:nth-child(${E})`}else m=y;return f&&(m+=` > ${f}`),e(a.parentNode,d,m)}return f}c.getSelector=e;function t(a,d,f){if(a.nodeName==="#text")return null;let m=null,y=null,x=null,E=!1;const S={tagName:a.tagName};if(a.attributes){x={};for(let T=0,R=a.attributes.length;T<R;T+=1){const V=a.attributes[T],j=V.nodeName,q=V.nodeValue;j==="selector"?m=q:j==="groupSelector"?y=q:j==="class"?S.attrs={class:q}:x[j]=q}}return m==null&&(E=!0,m=e(a,d)),a.namespaceURI&&(S.ns=a.namespaceURI),S.ns==null&&(["body","div","section","main","nav","footer","span","p","h1","h2","h3","h4","h5","h6","ul","ol","dl","center","strong","pre","form","select","textarea","fieldset","marquee","bgsound","iframe","frameset"].includes(a.tagName)?S.ns=Fo.xhtml:f&&(S.ns=f)),m&&(S.selector=m),y!=null&&(S.groupSelector=y),{markup:S,attrs:x,isCSSSelector:E}}function i(a){const d=c.sanitize(a),f=Rb(d,{mimeType:"image/svg+xml"}),m=Array.prototype.slice.call(f.childNodes),y={},x=new WeakMap,E=(T,R,V)=>{const j=t(T,R,V);if(j==null){const q=x.get(T.parentNode);q&&T.textContent&&(q.textContent=T.textContent)}else{const{markup:q,attrs:ue,isCSSSelector:be}=j;if(x.set(T,q),q.selector&&ue!=null&&(Object.keys(ue).length&&(y[q.selector]=ue),be&&delete q.selector),T.childNodes&&T.childNodes.length>0)for(let se=0,Pe=T.childNodes.length;se<Pe;se+=1){const He=T.childNodes[se],ft=E(He,R,q.ns);ft&&(q.children==null&&(q.children=[]),q.children.push(ft))}return q}};return{markup:m.map(T=>E(T,T)).filter(T=>T!=null),attrs:y}}c.xml2json=i}(li||(li={})),function(c){function e(){return"g"}c.getPortContainerMarkup=e;function t(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}}c.getPortMarkup=t;function i(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}c.getPortLabelMarkup=i}(li||(li={})),function(c){function e(){return c.sanitize(`
    <path class="connection" stroke="black" d="M 0 0 0 0"/>
    <path class="source-marker" fill="black" stroke="black" d="M 0 0 0 0"/>
    <path class="target-marker" fill="black" stroke="black" d="M 0 0 0 0"/>
    <path class="connection-wrap" d="M 0 0 0 0"/>
    <g class="labels"/>
    <g class="vertices"/>
    <g class="arrowheads"/>
    <g class="tools"/>
  `)}c.getEdgeMarkup=e;function t(){return c.sanitize(`
    <g class="edge-tool">
      <g class="tool-remove" event="edge:remove">
        <circle r="11" />
        <path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />
        <title>Remove edge.</title>
      </g>
      <g class="tool-options" event="edge:options">
        <circle r="11" transform="translate(25)"/>
        <path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>
        <title>Edge options.</title>
      </g>
    </g>
  `)}c.getEdgeToolMarkup=t;function i(){return c.sanitize(`
    <g class="vertex-group" transform="translate(<%= x %>, <%= y %>)">
      <circle class="vertex" data-index="<%= index %>" r="10" />
      <path class="vertex-remove-area" data-index="<%= index %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>
      <path class="vertex-remove" data-index="<%= index %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">
      <title>Remove vertex.</title>
      </path>
    </g>
  `)}c.getEdgeVertexMarkup=i;function a(){return c.sanitize(`
    <g class="arrowhead-group arrowhead-group-<%= end %>">
      <path class="arrowhead" data-terminal="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />
    </g>
  `)}c.getEdgeArrowheadMarkup=a}(li||(li={})),function(c){function e(t=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:Fo.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:Fo.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:t?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}c.getForeignObjectMarkup=e}(li||(li={}));class Rd{constructor(e){this.view=e}get cell(){return this.view.cell}getDefinition(e){return this.cell.getAttrDefinition(e)}processAttrs(e,t){let i,a,d,f,m;const y=[];return Object.keys(t).forEach(x=>{const E=t[x],S=this.getDefinition(x),T=Pn(yl.isValidDefinition,this.view,S,E,{elem:e,attrs:t,cell:this.cell,view:this.view});if(S&&T)typeof S=="string"?(i==null&&(i={}),i[S]=E):E!==null&&y.push({name:x,definition:S});else{i==null&&(i={});const R=Rd.CASE_SENSITIVE_ATTR.includes(x)?x:iv(x);i[R]=E}}),y.forEach(({name:x,definition:E})=>{const S=t[x];typeof E.set=="function"&&(!Fm(e)&&Rd.DELAY_ATTRS.includes(x)?(m==null&&(m={}),m[x]=S):(a==null&&(a={}),a[x]=S)),typeof E.offset=="function"&&(d==null&&(d={}),d[x]=S),typeof E.position=="function"&&(f==null&&(f={}),f[x]=S)}),{raw:t,normal:i,set:a,offset:d,position:f,delay:m}}mergeProcessedAttrs(e,t){e.set=Object.assign(Object.assign({},e.set),t.set),e.position=Object.assign(Object.assign({},e.position),t.position),e.offset=Object.assign(Object.assign({},e.offset),t.offset);const i=e.normal&&e.normal.transform;i!=null&&t.normal&&(t.normal.transform=i),e.normal=t.normal}findAttrs(e,t,i,a){const d=[],f=new wg;return Object.keys(e).forEach(m=>{const y=e[m];if(!Ge.Z(y))return;const{isCSSSelector:x,elems:E}=ii.find(m,t,a);i[m]=E;for(let S=0,T=E.length;S<T;S+=1){const R=E[S],V=a&&a[m]===R,j=f.get(R);if(j){j.array||(d.push(R),j.array=!0,j.attrs=[j.attrs],j.priority=[j.priority]);const q=j.attrs,ue=j.priority;if(V)q.unshift(y),ue.unshift(-1);else{const be=No(ue,x?-1:T);q.splice(be,0,y),ue.splice(be,0,T)}}else f.set(R,{elem:R,attrs:y,priority:V?-1:T,array:!1})}}),d.forEach(m=>{const y=f.get(m),x=y.attrs;y.attrs=x.reduceRight((E,S)=>Pi.Z(E,S),{})}),f}updateRelativeAttrs(e,t,i,a){const d=t.raw||{};let f=t.normal||{};const m=t.set,y=t.position,x=t.offset,E=t.delay,S=()=>({elem:e,cell:this.cell,view:this.view,attrs:d,refBBox:i.clone()});if(m!=null&&Object.keys(m).forEach(He=>{const ft=m[He],pt=this.getDefinition(He);if(pt!=null){const kt=Pn(pt.set,this.view,ft,S());typeof kt=="object"?f=Object.assign(Object.assign({},f),kt):kt!=null&&(f[He]=kt)}}),Fm(e)){this.view.setAttrs(f,e);return}const T=f.transform,R=T?`${T}`:null,V=kn(R),j=new Oe(V.e,V.f);T&&(delete f.transform,V.e=0,V.f=0);let q=1,ue=1;if(y||x){const He=this.view.getScaleOfElement(e,a.scalableNode);q=He.sx,ue=He.sy}let be=!1;y!=null&&Object.keys(y).forEach(He=>{const ft=y[He],pt=this.getDefinition(He);if(pt!=null){const kt=Pn(pt.position,this.view,ft,S());kt!=null&&(be=!0,j.translate(Oe.create(kt).scale(q,ue)))}}),this.view.setAttrs(f,e);let se=!1;if(x!=null){const He=this.view.getBoundingRectOfElement(e);if(He.width>0&&He.height>0){const ft=va(He,V).scale(1/q,1/ue);Object.keys(x).forEach(pt=>{const kt=x[pt],cn=this.getDefinition(pt);if(cn!=null){const Bt=Pn(cn.offset,this.view,kt,{elem:e,cell:this.cell,view:this.view,attrs:d,refBBox:ft});Bt!=null&&(se=!0,j.translate(Oe.create(Bt).scale(q,ue)))}})}}(T!=null||be||se)&&(j.round(1),V.e=j.x,V.f=j.y,e.setAttribute("transform",Zr(V)));const Pe=()=>{E!=null&&Object.keys(E).forEach(He=>{const ft=E[He],pt=this.getDefinition(He);if(pt!=null){const kt=Pn(pt.set,this.view,ft,S());typeof kt=="object"?this.view.setAttrs(kt,e):kt!=null&&this.view.setAttrs({[He]:kt},e)}})};a.forceSync?Pe():Jm.scheduleTask(Pe)}update(e,t,i){const a={},d=this.findAttrs(i.attrs||t,e,a,i.selectors),f=i.attrs?this.findAttrs(t,e,a,i.selectors):d,m=[];d.each(E=>{const S=E.elem,T=E.attrs,R=this.processAttrs(S,T);if(R.set==null&&R.position==null&&R.offset==null&&R.delay==null)this.view.setAttrs(R.normal,S);else{const V=f.get(S),j=V?V.attrs:null,q=j&&T.ref==null?j.ref:T.ref;let ue;if(q){if(ue=(a[q]||this.view.find(q,e,i.selectors))[0],!ue)throw new Error(`"${q}" reference does not exist.`)}else ue=null;const be={node:S,refNode:ue,attributes:j,processedAttributes:R},se=m.findIndex(Pe=>Pe.refNode===S);se>-1?m.splice(se,0,be):m.push(be)}});const y=new wg;let x;m.forEach(E=>{const S=E.node,T=E.refNode;let R;const V=T!=null&&i.rotatableNode!=null&&Rm(i.rotatableNode,T);if(T&&(R=y.get(T)),!R){const be=V?i.rotatableNode:e;R=T?Pr(T,{target:be}):i.rootBBox,T&&y.set(T,R)}let j;i.attrs&&E.attributes?(j=this.processAttrs(S,E.attributes),this.mergeProcessedAttrs(j,E.processedAttributes)):j=E.processedAttributes;let q=R;V&&i.rotatableNode!=null&&!i.rotatableNode.contains(S)&&(x||(x=kn(yi(i.rotatableNode,"transform"))),q=va(R,x)),m.find(be=>be.refNode===S)&&(i.forceSync=!0),this.updateRelativeAttrs(S,j,q,i)})}}(function(c){c.CASE_SENSITIVE_ATTR=["viewBox"],c.DELAY_ATTRS=["text","textWrap","sourceMarker","targetMarker"]})(Rd||(Rd={}));class iy{constructor(e,t,i=[]){this.view=e;const a={},d={};let f=0;Object.keys(t).forEach(y=>{let x=t[y];Array.isArray(x)||(x=[x]),x.forEach(E=>{let S=a[E];S||(f+=1,S=a[E]=1<<f),d[y]|=S})});let m=i;if(Array.isArray(m)||(m=[m]),m.forEach(y=>{a[y]||(f+=1,a[y]=1<<f)}),f>25)throw new Error("Maximum number of flags exceeded.");this.flags=a,this.attrs=d,this.bootstrap=i}get cell(){return this.view.cell}getFlag(e){const t=this.flags;return t==null?0:Array.isArray(e)?e.reduce((i,a)=>i|t[a],0):t[e]|0}hasAction(e,t){return e&this.getFlag(t)}removeAction(e,t){return e^e&this.getFlag(t)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let e=0;return this.attrs&&Object.keys(this.attrs).forEach(t=>{this.cell.hasChanged(t)&&(e|=this.attrs[t])}),e}}var wx=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class xo extends ii{constructor(e,t={}){super(),this.cell=e,this.options=this.ensureOptions(t),this.graph=this.options.graph,this.attr=new Rd(this),this.flag=new iy(this,this.options.actions,this.options.bootstrap),this.cache=new Eg(this),this.setContainer(this.ensureContainer()),this.setup(),this.$(this.container).data("view",this),this.init()}static getDefaults(){return this.defaults}static config(e){this.defaults=this.getOptions(e)}static getOptions(e){const t=(x,E)=>E!=null?Hr([...Array.isArray(x)?x:[x],...Array.isArray(E)?E:[E]]):Array.isArray(x)?[...x]:[x],i=qi(this.getDefaults()),{bootstrap:a,actions:d,events:f,documentEvents:m}=e,y=wx(e,["bootstrap","actions","events","documentEvents"]);return a&&(i.bootstrap=t(i.bootstrap,a)),d&&Object.keys(d).forEach(x=>{const E=d[x],S=i.actions[x];E&&S?i.actions[x]=t(S,E):E&&(i.actions[x]=t(E))}),f&&(i.events=Object.assign(Object.assign({},i.events),f)),e.documentEvents&&(i.documentEvents=Object.assign(Object.assign({},i.documentEvents),m)),Pi.Z(i,y)}get[Symbol.toStringTag](){return xo.toStringTag}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(e){return this.getConstructor().getOptions(e)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return ii.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(e){if(this.container!==e){this.undelegateEvents(),this.container=e,this.options.events!=null&&this.delegateEvents(this.options.events);const t=this.getContainerAttrs();t!=null&&this.setAttrs(t,e);const i=this.getContainerStyle();i!=null&&this.setStyle(i,e);const a=this.getContainerClassName();a!=null&&this.addClass(a,e)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(e,t={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(e){return this.flag.getFlag(e)}hasAction(e,t){return this.flag.hasAction(e,t)}removeAction(e,t){return this.flag.removeAction(e,t)}handleAction(e,t,i,a){if(this.hasAction(e,t)){i();const d=[t];return a&&(typeof a=="string"?d.push(a):d.push(...a)),this.removeAction(e,d)}return e}setup(){this.cell.on("changed",({options:e})=>this.onAttrsChange(e))}onAttrsChange(e){let t=this.flag.getChangedFlag();e.updated||!t||(e.dirty&&this.hasAction(t,"update")&&(t|=this.getFlag("render")),e.toolId&&(e.async=!1),this.graph!=null&&this.graph.renderer.requestViewUpdate(this,t,this.priority,e))}parseJSONMarkup(e,t){const i=li.parseJSONMarkup(e),a=i.selectors,d=this.rootSelector;if(t&&d){if(a[d])throw new Error("Invalid root selector");a[d]=t}return i}can(e){let t=this.graph.options.interacting;if(typeof t=="function"&&(t=Pn(t,this.graph,this)),typeof t=="object"){let i=t[e];return typeof i=="function"&&(i=Pn(i,this.graph,this)),i!==!1}return typeof t=="boolean"?t:!1}cleanCache(){return this.cache.clean(),this}getCache(e){return this.cache.get(e)}getDataOfElement(e){return this.cache.getData(e)}getMatrixOfElement(e){return this.cache.getMatrix(e)}getShapeOfElement(e){return this.cache.getShape(e)}getScaleOfElement(e,t){let i,a;if(t&&t.contains(e)){const d=ht(t);i=1/d.sx,a=1/d.sy}else i=1,a=1;return{sx:i,sy:a}}getBoundingRectOfElement(e){return this.cache.getBoundingRect(e)}getBBoxOfElement(e){const t=this.getBoundingRectOfElement(e),i=this.getMatrixOfElement(e),a=this.getRootRotatedMatrix(),d=this.getRootTranslatedMatrix();return va(t,d.multiply(a).multiply(i))}getUnrotatedBBoxOfElement(e){const t=this.getBoundingRectOfElement(e),i=this.getMatrixOfElement(e),a=this.getRootTranslatedMatrix();return va(t,a.multiply(i))}getBBox(e={}){let t;if(e.useCellGeometry){const i=this.cell,a=i.isNode()?i.getAngle():0;t=i.getBBox().bbox(a)}else t=this.getBBoxOfElement(this.container);return this.graph.localToGraph(t)}getRootTranslatedMatrix(){const e=this.cell,t=e.isNode()?e.getPosition():{x:0,y:0};return On().translate(t.x,t.y)}getRootRotatedMatrix(){let e=On();const t=this.cell,i=t.isNode()?t.getAngle():0;if(i){const a=t.getBBox(),d=a.width/2,f=a.height/2;e=e.translate(d,f).rotate(i).translate(-d,-f)}return e}findMagnet(e=this.container){return this.findByAttr("magnet",e)}updateAttrs(e,t,i={}){i.rootBBox==null&&(i.rootBBox=new gn),i.selectors==null&&(i.selectors=this.selectors),this.attr.update(e,t,i)}isEdgeElement(e){return this.cell.isEdge()&&(e==null||e===this.container)}prepareHighlight(e,t={}){const i=e&&this.$(e)[0]||this.container;return t.partial=i===this.container,i}highlight(e,t={}){const i=this.prepareHighlight(e,t);return this.notify("cell:highlight",{magnet:i,options:t,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:i,options:t,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:i,options:t,view:this,node:this.cell,cell:this.cell}),this}unhighlight(e,t={}){const i=this.prepareHighlight(e,t);return this.notify("cell:unhighlight",{magnet:i,options:t,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:i,options:t,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:i,options:t,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(e,t){}getEdgeTerminal(e,t,i,a,d){const f=this.cell,m=this.findAttr("port",e),y=e.getAttribute("data-selector"),x={cell:f.id};return y!=null&&(x.magnet=y),m!=null?(x.port=m,f.isNode()&&!f.hasPort(m)&&y==null&&(x.selector=this.getSelector(e))):y==null&&this.container!==e&&(x.selector=this.getSelector(e)),this.customizeEdgeTerminal(x,e,t,i,a,d)}customizeEdgeTerminal(e,t,i,a,d,f){const m=d.getStrategy()||this.graph.options.connecting.strategy;if(m){const y=typeof m=="string"?m:m.name,x=typeof m=="string"?{}:m.args||{},E=kd.registry;if(y){const S=E.get(y);if(S==null)return E.onNotFound(y);const T=Pn(S,this.graph,e,this,t,new Oe(i,a),d,f,x);if(T)return T}}return e}getMagnetFromEdgeTerminal(e){const t=this.cell,i=this.container,a=e.port;let d=e.magnet,f;return a!=null&&t.isNode()&&t.hasPort(a)?f=this.findPortElem(a,d)||i:(d||(d=e.selector),!d&&a!=null&&(d=`[port="${a}"]`),f=this.findOne(d,i,this.selectors)),f}animate(e,t){const i=typeof e=="string"?this.findOne(e):e;if(i==null)throw new Error("Invalid animation element.");const a=i.parentNode,d=()=>{a||Jl(i)},f=In.create(i);a||f.appendTo(this.graph.view.stage);const m=t.complete;return t.complete=y=>{d(),m&&m(y)},f.animate(t)}animateTransform(e,t){const i=typeof e=="string"?this.findOne(e):e;if(i==null)throw new Error("Invalid animation element.");const a=i.parentNode,d=()=>{a||Jl(i)},f=In.create(i);a||f.appendTo(this.graph.view.stage);const m=t.complete;return t.complete=y=>{d(),m&&m(y)},f.animateTransform(t)}hasTools(e){const t=this.tools;return t==null?!1:e==null?!0:t.name===e}addTools(e){if(!this.can("toolsAddable"))return this;if(this.removeTools(),e){const t=Xo.isToolsView(e)?e:new Xo(e);this.tools=t,this.graph.on("tools:hide",this.hideTools,this),this.graph.on("tools:show",this.showTools,this),this.graph.on("tools:remove",this.removeTools,this),t.config({view:this}),t.mount()}return this}updateTools(e={}){return this.tools&&this.tools.update(e),this}removeTools(){return this.tools&&(this.tools.remove(),this.graph.off("tools:hide",this.hideTools,this),this.graph.off("tools:show",this.showTools,this),this.graph.off("tools:remove",this.removeTools,this),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const e=this.cell.getTools();return this.addTools(e),this}notify(e,t){return this.trigger(e,t),this.graph.trigger(e,t),this}getEventArgs(e,t,i){const a=this,d=a.cell;return t==null||i==null?{e,view:a,cell:d}:{e,x:t,y:i,view:a,cell:d}}onClick(e,t,i){this.notify("cell:click",this.getEventArgs(e,t,i))}onDblClick(e,t,i){this.notify("cell:dblclick",this.getEventArgs(e,t,i))}onContextMenu(e,t,i){this.notify("cell:contextmenu",this.getEventArgs(e,t,i))}onMouseDown(e,t,i){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(e,t,i))}onMouseUp(e,t,i){this.notify("cell:mouseup",this.getEventArgs(e,t,i)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(e,t,i){this.notify("cell:mousemove",this.getEventArgs(e,t,i))}onMouseOver(e){this.notify("cell:mouseover",this.getEventArgs(e))}onMouseOut(e){this.notify("cell:mouseout",this.getEventArgs(e))}onMouseEnter(e){this.notify("cell:mouseenter",this.getEventArgs(e))}onMouseLeave(e){this.notify("cell:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,i,a){this.notify("cell:mousewheel",Object.assign({delta:a},this.getEventArgs(e,t,i)))}onCustomEvent(e,t,i,a){this.notify("cell:customevent",Object.assign({name:t},this.getEventArgs(e,i,a))),this.notify(t,Object.assign({},this.getEventArgs(e,i,a)))}onMagnetMouseDown(e,t,i,a){}onMagnetDblClick(e,t,i,a){}onMagnetContextMenu(e,t,i,a){}onLabelMouseDown(e,t,i){}checkMouseleave(e){const t=this.graph;t.renderer.isAsync()&&t.renderer.dumpView(this);const i=this.getEventTarget(e,{fromPoint:!0}),a=t.renderer.findViewByElem(i);a!==this&&(this.onMouseLeave(e),a&&a.onMouseEnter(e))}}xo.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},function(c){c.Flag=iy,c.Attr=Rd}(xo||(xo={})),function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.isNodeView=="function"&&typeof a.isEdgeView=="function"&&typeof a.confirmUpdate=="function"}c.isCellView=e}(xo||(xo={})),function(c){function e(i){return function(a){a.config({priority:i})}}c.priority=e;function t(i){return function(a){a.config({bootstrap:i})}}c.bootstrap=t}(xo||(xo={})),function(c){c.registry=Oo.create({type:"view"})}(xo||(xo={}));class Xo extends ii{constructor(e={}){super(),this.svgContainer=this.createContainer(!0,e),this.htmlContainer=this.createContainer(!1,e),this.config(e)}get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return Xo.toStringTag}createContainer(e,t){const i=e?ii.createElement("g",!0):ii.createElement("div",!1);return vi(i,this.prefixClassName("cell-tools")),t.className&&vi(i,t.className),i}config(e){if(this.options=Object.assign(Object.assign({},this.options),e),!xo.isCellView(e.view)||e.view===this.cellView)return this;this.cellView=e.view,this.cell.isEdge()?(vi(this.svgContainer,this.prefixClassName("edge-tools")),vi(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(vi(this.svgContainer,this.prefixClassName("node-tools")),vi(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const t=this.options.items;if(!Array.isArray(t))return this;this.tools=[];const i=[];t.forEach(a=>{Xo.ToolItem.isToolItem(a)?a.name==="vertices"?i.unshift(a):i.push(a):(typeof a=="object"?a.name:a)==="vertices"?i.unshift(a):i.push(a)});for(let a=0;a<i.length;a+=1){const d=i[a];let f;if(Xo.ToolItem.isToolItem(d))f=d;else{const m=typeof d=="object"?d.name:d,y=typeof d=="object"?d.args||{}:{};if(m){if(this.cell.isNode()){const x=sp.registry.get(m);if(x)f=new x(y);else return sp.registry.onNotFound(m)}else if(this.cell.isEdge()){const x=Gh.registry.get(m);if(x)f=new x(y);else return Gh.registry.onNotFound(m)}}}f&&(f.config(this.cellView,this),f.render(),(f.options.isSVGElement!==!1?this.svgContainer:this.htmlContainer).appendChild(f.container),this.tools.push(f))}return this}update(e={}){const t=this.tools;return t&&t.forEach(i=>{e.toolId!==i.cid&&i.isVisible()&&i.update()}),this}focus(e){const t=this.tools;return t&&t.forEach(i=>{e===i?i.show():i.hide()}),this}blur(e){const t=this.tools;return t&&t.forEach(i=>{i!==e&&!i.isVisible()&&(i.show(),i.update())}),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const e=this.tools;return e&&(e.forEach(t=>t.remove()),this.tools=null),Jl(this.svgContainer),Jl(this.htmlContainer),super.remove()}mount(){const e=this.tools,t=this.cellView;if(t&&e){const i=e.some(d=>d.options.isSVGElement!==!1),a=e.some(d=>d.options.isSVGElement===!1);i&&(this.options.local?t.container:t.graph.view.decorator).appendChild(this.svgContainer),a&&this.graph.container.appendChild(this.htmlContainer)}return this}}(function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&a.graph!=null&&a.cell!=null&&typeof a.config=="function"&&typeof a.update=="function"&&typeof a.focus=="function"&&typeof a.blur=="function"&&typeof a.show=="function"&&typeof a.hide=="function"}c.isToolsView=e})(Xo||(Xo={})),function(c){class e extends ii{constructor(i={}){super(),this.visible=!0,this.options=this.getOptions(i),this.container=ii.createElement(this.options.tagName||"g",this.options.isSVGElement!==!1),vi(this.container,this.prefixClassName("cell-tool")),typeof this.options.className=="string"&&vi(this.container,this.options.className),this.init()}static getDefaults(){return this.defaults}static config(i){this.defaults=this.getOptions(i)}static getOptions(i){return Pi.Z(qi(this.getDefaults()),i)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return e.toStringTag}init(){}getOptions(i){return this.constructor.getOptions(i)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(i,a){return this.cellView=i,this.parent=a,this.stamp(this.container),this.cell.isEdge()?vi(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&vi(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const i=this.options.markup;if(i){const a=li.isStringMarkup(i)?li.parseStringMarkup(i):li.parseJSONMarkup(i);this.container.appendChild(a.fragment),this.childNodes=a.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(i=this.container){i&&i.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return!!this.visible}focus(){const i=this.options.focusOpacity;return i!=null&&Number.isFinite(i)&&(this.container.style.opacity=`${i}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(i){return this.graph==null||this.cellView==null?!0:this.graph.view.guard(i,this.cellView)}}e.defaults={isSVGElement:!0,tagName:"g"},c.ToolItem=e,function(t){let i=0;function a(f){return f?Ic(f):(i+=1,`CustomTool${i}`)}function d(f){const m=Cc(a(f.name),this);return m.config(f),m}t.define=d}(e=c.ToolItem||(c.ToolItem={})),function(t){t.toStringTag=`X6.${t.name}`;function i(a){if(a==null)return!1;if(a instanceof t)return!0;const d=a[Symbol.toStringTag],f=a;return(d==null||d===t.toStringTag)&&f.graph!=null&&f.cell!=null&&typeof f.config=="function"&&typeof f.update=="function"&&typeof f.focus=="function"&&typeof f.blur=="function"&&typeof f.show=="function"&&typeof f.hide=="function"&&typeof f.isVisible=="function"}t.isToolItem=i}(e=c.ToolItem||(c.ToolItem={}))}(Xo||(Xo={}));function ps(c,e,t,i){return Pn(kd.presets.pinRelative,this.graph,{},e,t,c,this.cell,i,{}).anchor}function cE(c,e){return e?c.cell.getBBox():c.cell.isEdge()?c.getConnection().bbox():c.getUnrotatedBBoxOfElement(c.container)}class Oa extends Xo.ToolItem{onRender(){vi(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const t=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();Nh(this.container,t,{absolute:!0})}getNodeMatrix(){const e=this.cellView,t=this.options;let{x:i=0,y:a=0}=t;const{offset:d,useCellGeometry:f,rotate:m}=t;let y=cE(e,f);const x=e.cell.getAngle();m||(y=y.bbox(x));let E=0,S=0;typeof d=="number"?(E=d,S=d):typeof d=="object"&&(E=d.x,S=d.y),i=Lc(i,y.width),a=Lc(a,y.height);let T=On().translate(y.x+y.width/2,y.y+y.height/2);return m&&(T=T.rotate(x)),T=T.translate(i+E-y.width/2,a+S-y.height/2),T}getEdgeMatrix(){const e=this.cellView,t=this.options,{offset:i=0,distance:a=0,rotate:d}=t;let f,m,y;pl(a)?f=e.getTangentAtRatio(parseFloat(a)/100):f=e.getTangentAtLength(a),f?(m=f.start,y=f.vector().vectorAngle(new Oe(1,0))||0):(m=e.getConnection().start,y=0);let x=On().translate(m.x,m.y).rotate(y);return typeof i=="object"?x=x.translate(i.x||0,i.y||0):x=x.translate(0,i),d||(x=x.rotate(-y)),x}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();const t=this.options.onClick;typeof t=="function"&&Pn(t,this.cellView,{e,view:this.cellView,cell:this.cellView.cell,btn:this})}}(function(c){c.config({name:"button",events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})})(Oa||(Oa={})),function(c){c.Remove=c.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,onClick({view:e,btn:t}){t.parent.remove(),e.cell.remove({ui:!0,toolId:t.cid})}})}(Oa||(Oa={}));var tA=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class oy extends Xo.ToolItem{onRender(){if(vi(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const e=this.options.attrs,{class:t}=e,i=tA(e,["class"]);yi(this.container,Kf(i)),t&&vi(this.container,t)}this.update()}update(){const e=this.cellView,t=this.options,{useCellGeometry:i,rotate:a}=t,d=Ma(t.padding);let f=cE(e,i).moveAndExpand({x:-d.left,y:-d.top,width:d.left+d.right,height:d.top+d.bottom});const m=e.cell;if(m.isNode()){const y=m.getAngle();if(y)if(a){const x=m.getBBox().getCenter();Km(this.container,y,x.x,x.y,{absolute:!0})}else f=f.bbox(y)}return yi(this.container,f.toJSON()),this}}(function(c){c.config({name:"boundary",tagName:"rect",padding:10,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})})(oy||(oy={}));class oa extends Xo.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const e=this.handles;this.handles=[],e&&e.forEach(t=>{this.stopHandleListening(t),t.remove()})}renderHandles(){const e=this.vertices;for(let t=0,i=e.length;t<i;t+=1){const a=e[t],d=this.options.createHandle,f=this.options.processHandle,m=d({index:t,graph:this.graph,guard:y=>this.guard(y),attrs:this.options.attrs||{}});f&&f(m),this.graph.hook.onToolItemCreated({name:"vertices",cell:this.cell,view:this.cellView,tool:m}),m.updatePosition(a.x,a.y),this.stamp(m.container),this.container.appendChild(m.container),this.handles.push(m),this.startHandleListening(m)}}updateHandles(){const e=this.vertices;for(let t=0,i=e.length;t<i;t+=1){const a=e[t],d=this.handles[t];d&&d.updatePosition(a.x,a.y)}}updatePath(){const e=this.childNodes.connection;e&&e.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(e){const t=this.cellView;t.can("vertexMovable")&&(e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.on("remove",this.onHandleRemove,this)}stopHandleListening(e){const t=this.cellView;t.can("vertexMovable")&&(e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.off("remove",this.onHandleRemove,this)}getNeighborPoints(e){const t=this.cellView,i=this.vertices,a=e>0?i[e-1]:t.sourceAnchor,d=e<i.length-1?i[e+1]:t.targetAnchor;return{prev:Oe.create(a),next:Oe.create(d)}}getMouseEventArgs(e){const t=this.normalizeEvent(e),{x:i,y:a}=this.graph.snapToGrid(t.clientX,t.clientY);return{e:t,x:i,y:a}}onHandleChange({e}){this.focus();const t=this.cellView;if(t.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e:i,x:a,y:d}=this.getMouseEventArgs(e);t.notifyMouseDown(i,a,d)}}onHandleChanging({handle:e,e:t}){const i=this.cellView,a=e.options.index,{e:d,x:f,y:m}=this.getMouseEventArgs(t),y={x:f,y:m};this.snapVertex(y,a),i.cell.setVertexAt(a,y,{ui:!0,toolId:this.cid}),e.updatePosition(y.x,y.y),this.options.stopPropagation||i.notifyMouseMove(d,f,m)}onHandleChanged({e}){const t=this.options,i=this.cellView;if(t.addable&&this.updatePath(),!t.removeRedundancies)return;i.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),i.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),this.eventData(e).vertexAdded&&i.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid});const{e:d,x:f,y:m}=this.getMouseEventArgs(e);this.options.stopPropagation||i.notifyMouseUp(d,f,m),i.checkMouseleave(d),t.onChanged&&t.onChanged({edge:i.cell,edgeView:i})}snapVertex(e,t){const i=this.options.snapRadius||0;if(i>0){const a=this.getNeighborPoints(t),d=a.prev,f=a.next;Math.abs(e.x-d.x)<i?e.x=d.x:Math.abs(e.x-f.x)<i&&(e.x=f.x),Math.abs(e.y-d.y)<i?e.y=a.prev.y:Math.abs(e.y-f.y)<i&&(e.y=f.y)}}onHandleRemove({handle:e,e:t}){if(this.options.removable){const i=e.options.index,a=this.cellView;a.cell.removeVertexAt(i,{ui:!0}),this.options.addable&&this.updatePath(),a.checkMouseleave(this.normalizeEvent(t))}}onPathMouseDown(e){const t=this.cellView;if(this.guard(e)||!this.options.addable||!t.can("vertexAddable"))return;e.stopPropagation(),e.preventDefault();const i=this.normalizeEvent(e),a=this.graph.snapToGrid(i.clientX,i.clientY).toJSON();t.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const d=t.getVertexIndex(a.x,a.y);this.snapVertex(a,d),t.cell.insertVertex(a,d,{ui:!0,toolId:this.cid}),this.render();const f=this.handles[d];this.eventData(i,{vertexAdded:!0}),f.onMouseDown(i)}onRemove(){this.resetHandles()}}(function(c){class e extends ii{constructor(i){super(),this.options=i,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}get graph(){return this.options.graph}render(){this.container=ii.createElement("circle",!0);const i=this.options.attrs;if(typeof i=="function"){const a=c.getDefaults();this.setAttrs(Object.assign(Object.assign({},a.attrs),i(this)))}else this.setAttrs(i);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(i,a){this.setAttrs({cx:i,cy:a})}onMouseDown(i){this.options.guard(i)||(i.stopPropagation(),i.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},i.data),this.emit("change",{e:i,handle:this}))}onMouseMove(i){this.emit("changing",{e:i,handle:this})}onMouseUp(i){this.emit("changed",{e:i,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(i){this.emit("remove",{e:i,handle:this})}}c.Handle=e})(oa||(oa={})),function(c){const e=Bo.prefix("edge-tool-vertex-path");c.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:t=>new c.Handle(t),markup:[{tagName:"path",selector:"connection",className:e,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${e}`]:"onPathMouseDown",[`touchstart .${e}`]:"onPathMouseDown"}})}(oa||(oa={}));class r0 extends Xo.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){vi(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const e=this.cellView,t=[...this.vertices];t.unshift(e.sourcePoint),t.push(e.targetPoint);for(let i=0,a=t.length;i<a-1;i+=1){const d=t[i],f=t[i+1],m=this.renderHandle(d,f,i);this.stamp(m.container),this.handles.push(m)}return this}renderHandle(e,t,i){const a=this.options.createHandle({index:i,graph:this.graph,guard:d=>this.guard(d),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(a),this.graph.hook.onToolItemCreated({name:"segments",cell:this.cell,view:this.cellView,tool:a}),this.updateHandle(a,e,t),this.container.appendChild(a.container),this.startHandleListening(a),a}startHandleListening(e){e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)}stopHandleListening(e){e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)}resetHandles(){const e=this.handles;this.handles=[],e&&e.forEach(t=>{this.stopHandleListening(t),t.remove()})}shiftHandleIndexes(e){const t=this.handles;for(let i=0,a=t.length;i<a;i+=1)t[i].options.index+=e}resetAnchor(e,t){const i=this.cellView.cell,a={ui:!0,toolId:this.cid};t?i.prop([e,"anchor"],t,a):i.removeProp([e,"anchor"],a)}snapHandle(e,t,i){const a=e.options.axis,d=e.options.index,y=this.cellView.cell.getVertices(),x=y[d-2]||i.sourceAnchor,E=y[d+1]||i.targetAnchor,S=this.options.snapRadius;return Math.abs(t[a]-x[a])<S?t[a]=x[a]:Math.abs(t[a]-E[a])<S&&(t[a]=E[a]),t}onHandleChanging({handle:e,e:t}){const i=this.graph,a=this.options,d=this.cellView,f=a.anchor,m=e.options.axis,y=e.options.index-1,x=this.getEventData(t),E=this.normalizeEvent(t),S=i.snapToGrid(E.clientX,E.clientY),T=this.snapHandle(e,S.clone(),x),R=qi(this.vertices);let V=R[y],j=R[y+1];const q=d.sourceView,ue=d.sourceBBox;let be=!1,se=!1;if(V?y===0?ue.containsPoint(V)?(R.shift(),this.shiftHandleIndexes(-1),be=!0):(V[m]=T[m],se=!0):V[m]=T[m]:(V=d.sourceAnchor.toJSON(),V[m]=T[m],ue.containsPoint(V)?be=!0:(R.unshift(V),this.shiftHandleIndexes(1),se=!0)),typeof f=="function"&&q){if(be){const kt=x.sourceAnchor.clone();kt[m]=T[m];const cn=Pn(f,d,kt,q,d.sourceMagnet||q.container,"source",d,this);this.resetAnchor("source",cn)}se&&this.resetAnchor("source",x.sourceAnchorDef)}const Pe=d.targetView,He=d.targetBBox;let ft=!1,pt=!1;if(j?y===R.length-2?He.containsPoint(j)?(R.pop(),ft=!0):(j[m]=T[m],pt=!0):j[m]=T[m]:(j=d.targetAnchor.toJSON(),j[m]=T[m],He.containsPoint(j)?ft=!0:(R.push(j),pt=!0)),typeof f=="function"&&Pe){if(ft){const kt=x.targetAnchor.clone();kt[m]=T[m];const cn=Pn(f,d,kt,Pe,d.targetMagnet||Pe.container,"target",d,this);this.resetAnchor("target",cn)}pt&&this.resetAnchor("target",x.targetAnchorDef)}Oe.equalPoints(R,this.vertices)||this.cellView.cell.setVertices(R,{ui:!0,toolId:this.cid}),this.updateHandle(e,V,j,0),a.stopPropagation||d.notifyMouseMove(E,S.x,S.y)}onHandleChange({handle:e,e:t}){const i=this.options,a=this.handles,d=this.cellView,f=e.options.index;if(!!Array.isArray(a)){for(let m=0,y=a.length;m<y;m+=1)m!==f&&a[m].hide();if(this.focus(),this.setEventData(t,{sourceAnchor:d.sourceAnchor.clone(),targetAnchor:d.targetAnchor.clone(),sourceAnchorDef:qi(this.cell.prop(["source","anchor"])),targetAnchorDef:qi(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!i.stopPropagation){const m=this.normalizeEvent(t),y=this.graph.snapToGrid(m.clientX,m.clientY);d.notifyMouseDown(m,y.x,y.y)}}}onHandleChanged({e}){const t=this.options,i=this.cellView;t.removeRedundancies&&i.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const a=this.normalizeEvent(e),d=this.graph.snapToGrid(a.clientX,a.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),t.stopPropagation||i.notifyMouseUp(a,d.x,d.y),i.checkMouseleave(a),t.onChanged&&t.onChanged({edge:i.cell,edgeView:i})}updateHandle(e,t,i,a=0){const d=this.options.precision||0,f=Math.abs(t.x-i.x)<d,m=Math.abs(t.y-i.y)<d;if(f||m){const y=new zn(t,i);if(y.length()<this.options.threshold)e.hide();else{const E=y.getCenter(),S=f?"x":"y";E[S]+=a||0;const T=y.vector().vectorAngle(new Oe(1,0));e.updatePosition(E.x,E.y,T,this.cellView),e.show(),e.options.axis=S}}else e.hide()}onRemove(){this.resetHandles()}}(function(c){class e extends ii{constructor(i){super(),this.options=i,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=ii.createElement("rect",!0);const i=this.options.attrs;if(typeof i=="function"){const a=c.getDefaults();this.setAttrs(Object.assign(Object.assign({},a.attrs),i(this)))}else this.setAttrs(i);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(i,a,d,f){const m=f.getClosestPoint(new Oe(i,a))||new Oe(i,a);let y=On().translate(m.x,m.y);if(m.equals({x:i,y:a}))y=y.rotate(d);else{let E=new zn(i,a,m.x,m.y).vector().vectorAngle(new Oe(1,0));E!==0&&(E+=90),y=y.rotate(E)}this.setAttrs({transform:Zr(y),cursor:d%180===0?"row-resize":"col-resize"})}onMouseDown(i){this.options.guard(i)||(this.trigger("change",{e:i,handle:this}),i.stopPropagation(),i.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},i.data))}onMouseMove(i){this.emit("changing",{e:i,handle:this})}onMouseUp(i){this.emit("changed",{e:i,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}c.Handle=e})(r0||(r0={})),function(c){c.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:e=>new c.Handle(e),anchor:ps})}(r0||(r0={}));class sy extends Xo.ToolItem{get type(){return this.options.type}onRender(){vi(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){const e=this.type;return this.cellView.getTerminalView(e)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const e=this.childNodes;if(!e)return;const t=e.anchor;if(!t)return;const i=this.type,a=this.cellView,d=this.options,f=a.getTerminalAnchor(i),m=a.cell.prop([i,"anchor"]);t.setAttribute("transform",`translate(${f.x}, ${f.y})`);const y=m?d.customAnchorAttrs:d.defaultAnchorAttrs;y&&Object.keys(y).forEach(x=>{t.setAttribute(x,y[x])})}updateArea(){const e=this.childNodes;if(!e)return;const t=e.area;if(!t)return;const i=this.type,a=this.cellView,d=a.getTerminalView(i);if(d){const f=d.cell,m=a.getTerminalMagnet(i);let y=this.options.areaPadding||0;Number.isFinite(y)||(y=0);let x,E,S;d.isEdgeElement(m)?(x=d.getBBox(),E=0,S=x.getCenter()):(x=d.getUnrotatedBBoxOfElement(m),E=f.getAngle(),S=x.getCenter(),E&&S.rotate(-E,f.getBBox().getCenter())),x.inflate(y),yi(t,{x:-x.width/2,y:-x.height/2,width:x.width,height:x.height,transform:`translate(${S.x}, ${S.y}) rotate(${E})`})}}toggleArea(e){if(this.childNodes){const t=this.childNodes.area;t&&(t.style.display=e?"":"none")}}onMouseDown(e){this.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(e){const t=this.type,i=this.cell;e?i.prop([t,"anchor"],e,{rewrite:!0,ui:!0,toolId:this.cid}):i.removeProp([t,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(e){const t=this.type,i=this.cellView,a=i.getTerminalView(t);if(a==null)return;const d=this.normalizeEvent(e),f=a.cell,m=i.getTerminalMagnet(t);let y=this.graph.clientToLocal(d.clientX,d.clientY);const x=this.options.snap;if(typeof x=="function"){const T=Pn(x,i,y,a,m,t,i,this);y=Oe.create(T)}if(this.options.restrictArea)if(a.isEdgeElement(m)){const T=a.getClosestPoint(y);T&&(y=T)}else{const T=a.getUnrotatedBBoxOfElement(m),R=f.getAngle(),V=f.getBBox().getCenter(),j=y.clone().rotate(R,V);T.containsPoint(j)||(y=T.getNearestPointToPoint(j).rotate(-R,V))}let E;const S=this.options.anchor;typeof S=="function"&&(E=Pn(S,i,y,a,m,t,i,this)),this.resetAnchor(E),this.update()}onMouseUp(e){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);const t=this.cellView;this.options.removeRedundancies&&t.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const e=this.options.resetAnchor;e&&this.resetAnchor(e===!0?void 0:e),this.update()}}(function(c){c.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:ps,snap(e,t,i,a,d,f){const m=f.options.snapRadius||0,y=a==="source",x=y?0:-1,E=this.cell.getVertexAt(x)||this.getTerminalAnchor(y?"target":"source");return E&&(Math.abs(E.x-e.x)<m&&(e.x=E.x),Math.abs(E.y-e.y)<m&&(e.y=E.y)),e}})})(sy||(sy={}));const nA=sy.define({name:"source-anchor",type:"source"}),rA=sy.define({name:"target-anchor",type:"target"});var uE=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class i0 extends Xo.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const e=this.options.attrs,{class:t}=e,i=uE(e,["class"]);this.setAttrs(i,this.container),t&&vi(this.container,t)}}onRender(){vi(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const e=this.ratio,t=this.cellView,i=t.getTangentAtRatio(e),a=i?i.start:t.getPointAtRatio(e),d=i&&i.vector().vectorAngle(new Oe(1,0))||0;if(!a)return this;const f=On().translate(a.x,a.y).rotate(d);return Nh(this.container,f,{absolute:!0}),this}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();const t=this.cellView;if(t.can("arrowheadMovable")){t.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const i=this.graph.snapToGrid(e.clientX,e.clientY),a=t.prepareArrowheadDragging(this.type,{x:i.x,y:i.y,options:{toolId:this.cid}});this.cellView.setEventData(e,a),this.delegateDocumentEvents(this.options.documentEvents,e.data),t.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(e){const t=this.normalizeEvent(e),i=this.graph.snapToGrid(t.clientX,t.clientY);this.cellView.onMouseMove(t,i.x,i.y),this.update()}onMouseUp(e){this.undelegateDocumentEvents();const t=this.normalizeEvent(e),i=this.cellView,a=this.graph.snapToGrid(t.clientX,t.clientY);i.onMouseUp(t,a.x,a.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",i.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}(function(c){c.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})})(i0||(i0={}));const iA=i0.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),o0=i0.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});class Sg extends Xo.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5}render(){return this.createElement(),this.update(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents),this}createElement(){const{cell:e}=this,t=[this.prefixClassName(`${e.isEdge()?"edge":"node"}-tool-editor`),this.prefixClassName("cell-tool-editor")];this.editor=Xo.createElement("div",!1),this.addClass(t,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}update(){const{graph:e,cell:t,editor:i}=this,a=i.style;let d=new Oe,f=20;if(t.isNode())d=t.getBBox().center,f=t.size().width-4;else if(t.isEdge()){const S=this.options.event,T=S.target,R=T.parentElement;if(R&&Sd(R,this.prefixClassName("edge-label"))){const j=R.getAttribute("data-index")||"0";this.labelIndex=parseInt(j,10);const q=R.getAttribute("transform"),{translation:ue}=yg(q);d=new Oe(ue.tx,ue.ty),f=Pr(T).width}else{if(!this.options.labelAddable)return this;d=e.clientToLocal(Oe.create(S.clientX,S.clientY));const q=this.cellView.path.closestPointLength(d);this.distance=q}}d=e.localToGraph(d),a.left=`${d.x}px`,a.top=`${d.y}px`,a.minWidth=`${f}px`;const m=e.scale();a.transform=`scale(${m.sx}, ${m.sy}) translate(-50%, -50%)`;const y=this.options.attrs;a.fontSize=`${y.fontSize}px`,a.fontFamily=y.fontFamily,a.color=y.color,a.backgroundColor=y.backgroundColor;const x=this.options.getText;let E;return typeof x=="function"&&(E=Pn(x,this.cellView,{cell:this.cell,index:this.labelIndex})),i.innerText=E||"",this}onDocumentMouseDown(e){if(e.target!==this.editor){const t=this.cell,i=this.editor.innerText.replace(/\n$/,"")||"",a=this.options.setText;typeof a=="function"&&Pn(a,this.cellView,{cell:this.cell,value:i,index:this.labelIndex,distance:this.distance}),t.removeTool(t.isEdge()?"edge-editor":"node-editor"),this.undelegateDocumentEvents()}}onDblClick(e){e.stopPropagation()}onMouseDown(e){e.stopPropagation()}autoFocus(){setTimeout(()=>{this.editor.focus(),this.selectText()})}selectText(){if(window.getSelection){const e=document.createRange(),t=window.getSelection();e.selectNodeContents(this.editor),t.removeAllRanges(),t.addRange(e)}}}(function(c){c.config({tagName:"div",isSVGElement:!1,events:{dblclick:"onDblClick",mousedown:"onMouseDown"},documentEvents:{mousedown:"onDocumentMouseDown"}})})(Sg||(Sg={})),function(c){c.NodeEditor=c.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText({cell:e}){return e.attr("text/text")},setText({cell:e,value:t}){e.attr("text/text",t)}}),c.EdgeEditor=c.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText({cell:e,index:t}){return t===-1?"":e.prop(`labels/${t}/attrs/label/text`)},setText({cell:e,value:t,index:i,distance:a}){const d=e;i===-1?d.appendLabel({position:{distance:a},attrs:{label:{text:t}}}):t?d.prop(`labels/${i}/attrs/label/text`,t):typeof i=="number"&&d.removeLabelAt(i)}})}(Sg||(Sg={}));var ay=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t},sp;(function(c){c.presets={boundary:oy,button:Oa,"button-remove":Oa.Remove,"node-editor":Sg.NodeEditor},c.registry=Oo.create({type:"node tool",process(e,t){if(typeof t=="function")return t;let i=Xo.ToolItem;const{inherit:a}=t,d=ay(t,["inherit"]);if(a){const f=this.get(a);f==null?this.onNotFound(a,"inherited"):i=f}return d.name==null&&(d.name=e),i.define.call(i,d)}}),c.registry.register(c.presets,!0)})(sp||(sp={}));var Gh;(function(c){c.presets={boundary:oy,vertices:oa,segments:r0,button:Oa,"button-remove":Oa.Remove,"source-anchor":nA,"target-anchor":rA,"source-arrowhead":iA,"target-arrowhead":o0,"edge-editor":Sg.EdgeEditor},c.registry=Oo.create({type:"edge tool",process(e,t){if(typeof t=="function")return t;let i=Xo.ToolItem;const{inherit:a}=t,d=ay(t,["inherit"]);if(a){const f=this.get(a);f==null?this.onNotFound(a,"inherited"):i=f}return d.name==null&&(d.name=e),i.define.call(i,d)}}),c.registry.register(c.presets,!0)})(Gh||(Gh={}));const ly=Pu("center"),oA=Pu("topCenter"),sA=Pu("bottomCenter"),cy=Pu("leftMiddle"),Ag=Pu("rightMiddle"),aA=Pu("topLeft"),lA=Pu("topRight"),dE=Pu("bottomLeft"),hE=Pu("bottomRight");function Pu(c){return function(e,t,i,a={}){const d=a.rotate?e.getUnrotatedBBoxOfElement(t):e.getBBoxOfElement(t),f=d[c];f.x+=Lc(a.dx,d.width),f.y+=Lc(a.dy,d.height);const m=e.cell;return a.rotate?f.rotate(-m.getAngle(),m.getBBox().getCenter()):f}}function uy(c){return function(e,t,i,a){if(i instanceof Element){const d=this.graph.renderer.findViewByElem(i);let f;if(d)if(d.isEdgeElement(i)){const m=a.fixedAt!=null?a.fixedAt:"50%";f=fE(d,m)}else f=d.getBBoxOfElement(i).getCenter();else f=new Oe;return c.call(this,e,t,f,a)}return c.apply(this,arguments)}}function fE(c,e){const t=pl(e),i=typeof e=="string"?parseFloat(e):e;return t?c.getPointAtRatio(i/100):c.getPointAtLength(i)}const cA=uy(function(c,e,t,i){const a=c.cell.getAngle(),d=c.getBBoxOfElement(e),f=d.getCenter(),m=d.getTopLeft(),y=d.getBottomRight();let x=i.padding;if(Number.isFinite(x)||(x=0),m.y+x<=t.y&&t.y<=y.y-x){const E=t.y-f.y;f.x+=a===0||a===180?0:E*1/Math.tan(ri.toRad(a)),f.y+=E}else if(m.x+x<=t.x&&t.x<=y.x-x){const E=t.x-f.x;f.y+=a===90||a===270?0:E*Math.tan(ri.toRad(a)),f.x+=E}return f}),uA=function(c,e,t,i,a){const d=c.cell.getConnectionPoint(this.cell,a);return(i.dx||i.dy)&&d.translate(i.dx||0,i.dy||0),d},dA=uy(function(c,e,t,i){let a,d=0,f;const m=c.cell;i.rotate?(a=c.getUnrotatedBBoxOfElement(e),f=m.getBBox().getCenter(),d=m.getAngle()):a=c.getBBoxOfElement(e);const y=i.padding;y!=null&&Number.isFinite(y)&&a.inflate(y),i.rotate&&t.rotate(d,f);const x=a.getNearestSideToPoint(t);let E;switch(x){case"left":E=a.getLeftMiddle();break;case"right":E=a.getRightMiddle();break;case"top":E=a.getTopCenter();break;case"bottom":E=a.getBottomCenter();break;default:break}const S=i.direction;return S==="H"?(x==="top"||x==="bottom")&&(t.x<=a.x+a.width?E=a.getLeftMiddle():E=a.getRightMiddle()):S==="V"&&(t.y<=a.y+a.height?E=a.getTopCenter():E=a.getBottomCenter()),i.rotate?E.rotate(-d,f):E});var ap;(function(c){c.presets=X,c.registry=Oo.create({type:"node endpoint"}),c.registry.register(c.presets,!0)})(ap||(ap={}));const hA=function(c,e,t,i){let a=i.ratio!=null?i.ratio:.5;return a>1&&(a/=100),c.getPointAtRatio(a)},fA=function(c,e,t,i){const a=i.length!=null?i.length:20;return c.getPointAtLength(a)},pE=function(c,e,t,i){const a=c.getClosestPoint(t);return a??new Oe},gE=uy(pE),Ex=uy(function(c,e,t,i){const d=c.getConnection(),f=c.getConnectionSubdivisions(),m=new zn(t.clone().translate(0,1e6),t.clone().translate(0,-1e6)),y=new zn(t.clone().translate(1e6,0),t.clone().translate(-1e6,0)),x=m.intersect(d,{segmentSubdivisions:f}),E=y.intersect(d,{segmentSubdivisions:f}),S=[];return x&&S.push(...x),E&&S.push(...E),S.length>0?t.closest(S):i.fallbackAt!=null?fE(c,i.fallbackAt):Pn(pE,this,c,e,t,i)});var Bh;(function(c){c.presets=le,c.registry=Oo.create({type:"edge endpoint"}),c.registry.register(c.presets,!0)})(Bh||(Bh={}));function Mg(c,e,t){let i;if(typeof t=="object"){if(Number.isFinite(t.y)){const d=new zn(e,c),{start:f,end:m}=d.parallel(t.y);e=f,c=m}i=t.x}else i=t;if(i==null||!Number.isFinite(i))return c;const a=c.distance(e);return i===0&&a>0?c:c.move(e,-Math.min(i,a-1))}function Pg(c){const e=c.getAttribute("stroke-width");return e===null?0:parseFloat(e)||0}function Sx(c){if(c==null)return null;let e=c;do{let t=e.tagName;if(typeof t!="string")return null;if(t=t.toUpperCase(),t==="G")e=e.firstElementChild;else if(t==="TITLE")e=e.nextElementSibling;else break}while(e);return e}const s0=function(c,e,t,i){const a=e.getBBoxOfElement(t);i.stroked&&a.inflate(Pg(t)/2);const d=c.intersect(a),f=d&&d.length?c.start.closest(d):c.end;return Mg(f,c.start,i.offset)},Ax=function(c,e,t,i,a){const d=e.cell,f=d.isNode()?d.getAngle():0;if(f===0)return Pn(s0,this,c,e,t,i,a);const m=e.getUnrotatedBBoxOfElement(t);i.stroked&&m.inflate(Pg(t)/2);const y=m.getCenter(),x=c.clone().rotate(f,y),E=x.setLength(1e6).intersect(m),S=E&&E.length?x.start.closest(E).rotate(-f,y):c.end;return Mg(S,c.start,i.offset)},Tx=function(c,e,t,i){let a,d;const f=c.end,m=i.selector;if(typeof m=="string"?a=e.findOne(m):Array.isArray(m)?a=sh(t,m):a=Sx(t),!Ad(a)){if(a===t||!Ad(t))return f;a=t}const y=e.getShapeOfElement(a),x=e.getMatrixOfElement(a),E=e.getRootTranslatedMatrix(),S=e.getRootRotatedMatrix(),T=E.multiply(S).multiply(x),R=T.inverse(),V=e2(c,R),j=V.start.clone(),q=e.getDataOfElement(a);if(i.insideout===!1){q.shapeBBox==null&&(q.shapeBBox=y.bbox());const Pe=q.shapeBBox;if(Pe!=null&&Pe.containsPoint(j))return f}i.extrapolate===!0&&V.setLength(1e6);let ue;if(sr.isPath(y)){const Pe=i.precision||2;q.segmentSubdivisions==null&&(q.segmentSubdivisions=y.getSegmentSubdivisions({precision:Pe})),ue={precision:Pe,segmentSubdivisions:q.segmentSubdivisions},d=V.intersect(y,ue)}else d=V.intersect(y);d?Array.isArray(d)&&(d=j.closest(d)):i.sticky===!0&&(gn.isRectangle(y)?d=y.getNearestPointToPoint(j):gl.isEllipse(y)?d=y.intersectsWithLineFromCenterToPoint(j):d=y.closestPoint(j,ue));const be=d?Pt(d,T):f;let se=i.offset||0;return i.stroked!==!1&&(typeof se=="object"?(se=Object.assign({},se),se.x==null&&(se.x=0),se.x+=Pg(a)/2):se+=Pg(a)/2),Mg(be,c.start,se)};function mE(c,e,t=0){const{start:i,end:a}=c;let d,f,m,y;switch(e){case"left":y="x",d=a,f=i,m=-1;break;case"right":y="x",d=i,f=a,m=1;break;case"top":y="y",d=a,f=i,m=-1;break;case"bottom":y="y",d=i,f=a,m=1;break;default:return}i[y]<a[y]?d[y]=f[y]:f[y]=d[y],Number.isFinite(t)&&(d[y]+=m*t,f[y]+=m*t)}const vE=function(c,e,t,i){const{alignOffset:a,align:d}=i;return d&&mE(c,d,a),Mg(c.end,c.start,i.offset)};var zh;(function(c){c.presets=Q,c.registry=Oo.create({type:"connection point"}),c.registry.register(c.presets,!0)})(zh||(zh={}));const yE=function(c){return[...c]},Mx=function(c,e,t){const i=e.side||"bottom",a=Ma(e.padding||40),d=t.sourceBBox,f=t.targetBBox,m=d.getCenter(),y=f.getCenter();let x,E,S;switch(i){case"top":S=-1,x="y",E="height";break;case"left":S=-1,x="x",E="width";break;case"right":S=1,x="x",E="width";break;case"bottom":default:S=1,x="y",E="height";break}return m[x]+=S*(d[E]/2+a[i]),y[x]+=S*(f[E]/2+a[i]),S*(m[x]-y[x])>0?y[x]=m[x]:m[x]=y[x],[m.toJSON(),...c,y.toJSON()]};function Og(c){return new gn(c.x,c.y,0,0)}function Dg(c={}){const e=Ma(c.padding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function Px(c,e={}){return c.sourceBBox.clone().moveAndExpand(Dg(e))}function dy(c,e={}){return c.targetBBox.clone().moveAndExpand(Dg(e))}function Ox(c,e={}){return c.sourceAnchor?c.sourceAnchor:Px(c,e).getCenter()}function Dx(c,e={}){return c.targetAnchor?c.targetAnchor:dy(c,e).getCenter()}const _x=function(c,e,t){let i=Px(t,e),a=dy(t,e);const d=Ox(t,e),f=Dx(t,e);i=i.union(Og(d)),a=a.union(Og(f));const m=c.map(E=>Oe.create(E));m.unshift(d),m.push(f);let y=null;const x=[];for(let E=0,S=m.length-1;E<S;E+=1){let T=null;const R=m[E],V=m[E+1],j=Cl.getBearing(R,V)!=null;if(E===0)E+1===S?i.intersectsWithRect(a.clone().inflate(1))?T=Cl.insideNode(R,V,i,a):j||(T=Cl.nodeToNode(R,V,i,a)):i.containsPoint(V)?T=Cl.insideNode(R,V,i,Og(V).moveAndExpand(Dg(e))):j||(T=Cl.nodeToVertex(R,V,i));else if(E+1===S){const q=j&&Cl.getBearing(V,R)===y;a.containsPoint(R)||q?T=Cl.insideNode(R,V,Og(R).moveAndExpand(Dg(e)),a,y):j||(T=Cl.vertexToNode(R,V,a,y))}else j||(T=Cl.vertexToVertex(R,V,y));T?(x.push(...T.points),y=T.direction):y=Cl.getBearing(R,V),E+1<S&&x.push(V)}return x};var Cl;(function(c){const e={N:"S",S:"N",E:"W",W:"E"},t={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function i(S,T,R){let V=new Oe(S.x,T.y);return R.containsPoint(V)&&(V=new Oe(T.x,S.y)),V}function a(S,T){return S[T==="W"||T==="E"?"width":"height"]}c.getBBoxSize=a;function d(S,T){return S.x===T.x?S.y>T.y?"N":"S":S.y===T.y?S.x>T.x?"W":"E":null}c.getBearing=d;function f(S,T,R){const V=new Oe(S.x,T.y),j=new Oe(T.x,S.y),q=d(S,V),ue=d(S,j),be=R?e[R]:null,se=q===R||q!==be&&(ue===be||ue!==R)?V:j;return{points:[se],direction:d(se,T)}}c.vertexToVertex=f;function m(S,T,R){const V=i(S,T,R);return{points:[V],direction:d(V,T)}}c.nodeToVertex=m;function y(S,T,R,V){const j=[new Oe(S.x,T.y),new Oe(T.x,S.y)],q=j.filter(se=>!R.containsPoint(se)),ue=q.filter(se=>d(se,S)!==V);let be;if(ue.length>0)return be=ue.filter(se=>d(S,se)===V).pop(),be=be||ue[0],{points:[be],direction:d(be,T)};{be=rr(j,q)[0];const se=Oe.create(T).move(be,-a(R,V)/2);return{points:[i(se,S,R),se],direction:d(se,T)}}}c.vertexToNode=y;function x(S,T,R,V){let j=m(T,S,V);const q=j.points[0];if(R.containsPoint(q)){j=m(S,T,R);const ue=j.points[0];if(V.containsPoint(ue)){const be=Oe.create(S).move(ue,-a(R,d(S,ue))/2),se=Oe.create(T).move(q,-a(V,d(T,q))/2),Pe=new zn(be,se).getCenter(),He=m(S,Pe,R),ft=f(Pe,T,He.direction);j.points=[He.points[0],ft.points[0]],j.direction=ft.direction}}return j}c.nodeToNode=x;function E(S,T,R,V,j){const q=R.union(V).inflate(1),ue=q.getCenter(),be=ue.distance(T)>ue.distance(S),se=be?T:S,Pe=be?S:T;let He,ft,pt;j?(He=Oe.fromPolar(q.width+q.height,t[j],se),He=q.getNearestPointToPoint(He).move(He,-1)):He=q.getNearestPointToPoint(se).move(se,1),ft=i(He,Pe,q);let kt;He.round().equals(ft.round())?(ft=Oe.fromPolar(q.width+q.height,ri.toRad(He.theta(se))+Math.PI/2,Pe),ft=q.getNearestPointToPoint(ft).move(Pe,1).round(),pt=i(He,ft,q),kt=be?[ft,pt,He]:[He,pt,ft]):kt=be?[ft,He]:[He,ft];const cn=d(be?He:ft,T);return{points:kt,direction:cn}}c.insideNode=E})(Cl||(Cl={}));const bE={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeShapes:[],excludeNodes:[],excludeHiddenNodes:!1,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return Ou(this.step,this)},directions(){const c=Ou(this.step,this),e=Ou(this.cost,this);return[{cost:e,offsetX:c,offsetY:0},{cost:e,offsetX:-c,offsetY:0},{cost:e,offsetX:0,offsetY:c},{cost:e,offsetX:0,offsetY:-c}]},penalties(){const c=Ou(this.step,this);return{0:0,45:c/2,90:c/2}},paddingBox(){const c=Ou(this.step,this);return{x:-c,y:-c,width:2*c,height:2*c}},fallbackRouter:_x,draggingRouter:null};function Ou(c,e){return typeof c=="function"?c.call(e):c}function xE(c){const e=Object.keys(c).reduce((t,i)=>{const a=t;return i==="fallbackRouter"||i==="draggingRouter"||i==="fallbackRoute"?a[i]=c[i]:a[i]=Ou(c[i],c),t},{});if(e.padding){const t=Ma(e.padding);e.paddingBox={x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}return e.directions.forEach(t=>{const i=new Oe(0,0),a=new Oe(t.offsetX,t.offsetY);t.angle=ri.normalize(i.theta(a))}),e}const hy=1,fy=2;class Nx{constructor(){this.items=[],this.hash={},this.values={}}add(e,t){this.hash[e]?this.items.splice(this.items.indexOf(e),1):this.hash[e]=hy,this.values[e]=t;const i=Yr(this.items,e,a=>this.values[a]);this.items.splice(i,0,e)}pop(){const e=this.items.shift();return e&&(this.hash[e]=fy),e}isOpen(e){return this.hash[e]===hy}isClose(e){return this.hash[e]===fy}isEmpty(){return this.items.length===0}}class kx{constructor(e){this.options=e,this.mapGridSize=100,this.map={}}build(e,t){const i=this.options,a=i.excludeTerminals.reduce((x,E)=>{const S=t[E];if(S){const T=e.getCell(S.cell);T&&x.push(T)}return x},[]);let d=[];const f=e.getCell(t.getSourceCellId());f&&(d=qo(d,f.getAncestors().map(x=>x.id)));const m=e.getCell(t.getTargetCellId());m&&(d=qo(d,m.getAncestors().map(x=>x.id)));const y=this.mapGridSize;return e.getNodes().reduce((x,E)=>{const S=E.shape,T=i.excludeShapes,R=S?T.includes(S):!1,V=a.some(se=>se.id===E.id),j=i.excludeNodes.includes(E),q=d.includes(E.id),ue=i.excludeHiddenNodes&&!E.isVisible();if(!(R||V||j||q||ue)){const se=E.getBBox().moveAndExpand(i.paddingBox),Pe=se.getOrigin().snapToGrid(y),He=se.getCorner().snapToGrid(y);for(let ft=Pe.x;ft<=He.x;ft+=y)for(let pt=Pe.y;pt<=He.y;pt+=y){const kt=new Oe(ft,pt).toString();x[kt]==null&&(x[kt]=[]),x[kt].push(se)}}return x},this.map),this}isAccessible(e){const t=e.clone().snapToGrid(this.mapGridSize).toString(),i=this.map[t];return i?i.every(a=>!a.containsPoint(e)):!0}}function lp(c,e){const t=c.sourceBBox.clone();return e&&e.paddingBox?t.moveAndExpand(e.paddingBox):t}function Rx(c,e){const t=c.targetBBox.clone();return e&&e.paddingBox?t.moveAndExpand(e.paddingBox):t}function Ix(c,e){return c.sourceAnchor?c.sourceAnchor:lp(c,e).getCenter()}function CE(c,e){return c.targetAnchor?c.targetAnchor:Rx(c,e).getCenter()}function py(c,e,t,i,a){const d=360/t,f=c.theta(wE(c,e,i,a)),m=ri.normalize(f+d/2);return d*Math.floor(m/d)}function wE(c,e,t,i){const a=i.step,d=e.x-c.x,f=e.y-c.y,m=d/t.x,y=f/t.y,x=m*a,E=y*a;return new Oe(c.x+x,c.y+E)}function Lx(c,e){const t=Math.abs(c-e);return t>180?360-t:t}function EE(c,e){const t=e.step;return e.directions.forEach(i=>{i.gridOffsetX=i.offsetX/t*c.x,i.gridOffsetY=i.offsetY/t*c.y}),e.directions}function zc(c,e,t){return{source:e.clone(),x:gy(t.x-e.x,c),y:gy(t.y-e.y,c)}}function gy(c,e){if(!c)return e;const t=Math.abs(c),i=Math.round(t/e);if(!i)return t;const a=i*e,f=(t-a)/i;return e+f}function gA(c,e){const t=e.source,i=Bo.snapToGrid(c.x-t.x,e.x)+t.x,a=Bo.snapToGrid(c.y-t.y,e.y)+t.y;return new Oe(i,a)}function a0(c,e){return c.round(e)}function l0(c,e,t){return a0(gA(c.clone(),e),t)}function Uh(c){return c.toString()}function sa(c){return new Oe(c.x===0?0:Math.abs(c.x)/c.x,c.y===0?0:Math.abs(c.y)/c.y)}function SE(c,e){let t=1/0;for(let i=0,a=e.length;i<a;i+=1){const d=c.manhattanDistance(e[i]);d<t&&(t=d)}return t}function AE(c,e,t,i,a){const d=a.precision,f=a.directionMap,m=c.diff(e.getCenter()),y=Object.keys(f).reduce((x,E)=>{if(t.includes(E)){const S=f[E],T=new Oe(c.x+S.x*(Math.abs(m.x)+e.width),c.y+S.y*(Math.abs(m.y)+e.height)),V=new zn(c,T).intersect(e)||[];let j,q=null;for(let ue=0;ue<V.length;ue+=1){const be=V[ue],se=c.squaredDistance(be);(j==null||se>j)&&(j=se,q=be)}if(q){let ue=l0(q,i,d);e.containsPoint(ue)&&(ue=l0(ue.translate(S.x*i.x,S.y*i.y),i,d)),x.push(ue)}}return x},[]);return e.containsPoint(c)||y.push(l0(c,i,d)),y}function mA(c,e,t,i,a){const d=[];let f=sa(a.diff(t)),m=Uh(t),y=c[m],x;for(;y;){x=e[m];const T=sa(x.diff(y));T.equals(f)||(d.unshift(x),f=T),m=Uh(y),y=c[m]}const E=e[m];return sa(E.diff(i)).equals(f)||d.unshift(E),d}function vA(c,e,t,i,a){const d=a.precision;let f,m;gn.isRectangle(e)?f=a0(Ix(c,a).clone(),d):f=a0(e.clone(),d),gn.isRectangle(t)?m=a0(CE(c,a).clone(),d):m=a0(t.clone(),d);const y=zc(a.step,f,m),x=f,E=m;let S,T;if(gn.isRectangle(e)?S=AE(x,e,a.startDirections,y,a):S=[x],gn.isRectangle(t)?T=AE(m,t,a.endDirections,y,a):T=[E],S=S.filter(R=>i.isAccessible(R)),T=T.filter(R=>i.isAccessible(R)),S.length>0&&T.length>0){const R=new Nx,V={},j={},q={};for(let Bt=0,Xt=S.length;Bt<Xt;Bt+=1){const on=S[Bt],fr=Uh(on);R.add(fr,SE(on,T)),V[fr]=on,q[fr]=0}const ue=a.previousDirectionAngle,be=ue===void 0;let se,Pe;const He=EE(y,a),ft=He.length,pt=T.reduce((Bt,Xt)=>{const on=Uh(Xt);return Bt.push(on),Bt},[]),kt=Oe.equalPoints(S,T);let cn=a.maxLoopCount;for(;!R.isEmpty()&&cn>0;){const Bt=R.pop(),Xt=V[Bt],on=j[Bt],fr=q[Bt],Cr=Xt.equals(x),St=on==null;let dn;if(St?be?Cr?dn=null:dn=py(x,Xt,ft,y,a):dn=ue:dn=py(on,Xt,ft,y,a),!(St&&kt)&&pt.indexOf(Bt)>=0)return a.previousDirectionAngle=dn,mA(j,V,Xt,x,E);for(let Ni=0;Ni<ft;Ni+=1){se=He[Ni];const Gi=se.angle;if(Pe=Lx(dn,Gi),!(be&&Cr)&&Pe>a.maxDirectionChange)continue;const cs=l0(Xt.clone().translate(se.gridOffsetX||0,se.gridOffsetY||0),y,d),_o=Uh(cs);if(R.isClose(_o)||!i.isAccessible(cs))continue;if(pt.indexOf(_o)>=0&&!cs.equals(E)){const $c=py(cs,E,ft,y,a);if(Lx(Gi,$c)>a.maxDirectionChange)continue}const xp=se.cost,E0=Cr?0:a.penalties[Pe],Vd=fr+xp+E0;(!R.isOpen(_o)||Vd<q[_o])&&(V[_o]=cs,j[_o]=Xt,q[_o]=Vd,R.add(_o,Vd+SE(cs,T)))}cn-=1}}return a.fallbackRoute?Pn(a.fallbackRoute,this,x,E,a):null}const yA=function(c,e,t){const i=xE(e),a=lp(t,i),d=Rx(t,i),f=Ix(t,i),m=new kx(i).build(t.graph.model,t.cell),y=c.map(R=>Oe.create(R)),x=[];let E=f,S,T;for(let R=0,V=y.length;R<=V;R+=1){let j=null;if(S=T||a,T=y[R],T==null){T=d;const ue=t.cell;if((ue.getSourceCellId()==null||ue.getTargetCellId()==null)&&typeof i.draggingRouter=="function"){const se=S===a?f:S,Pe=T.getOrigin();j=Pn(i.draggingRouter,t,se,Pe,i)}}if(j==null&&(j=vA(t,S,T,m,i)),j===null)return Pn(i.fallbackRouter,this,c,i,t);const q=j[0];q&&q.equals(E)&&j.shift(),E=j[j.length-1]||E,x.push(...j)}return x},TE=function(c,e,t){return Pn(yA,this,c,Object.assign(Object.assign({},bE),e),t)},bA={maxDirectionChange:45,directions(){const c=Ou(this.step,this),e=Ou(this.cost,this),t=Math.ceil(Math.sqrt(c*c<<1));return[{cost:e,offsetX:c,offsetY:0},{cost:t,offsetX:c,offsetY:c},{cost:e,offsetX:0,offsetY:c},{cost:t,offsetX:-c,offsetY:c},{cost:e,offsetX:-c,offsetY:0},{cost:t,offsetX:-c,offsetY:-c},{cost:e,offsetX:0,offsetY:-c},{cost:t,offsetX:c,offsetY:-c}]},fallbackRoute(c,e,t){const i=c.theta(e),a=[];let d={x:e.x,y:c.y},f={x:c.x,y:e.y};if(i%180>90){const se=d;d=f,f=se}const m=i%90<45?d:f,y=new zn(c,m),x=90*Math.ceil(i/90),E=Oe.fromPolar(y.squaredLength(),ri.toRad(x+135),m),S=new zn(e,E),T=y.intersectsWithLine(S),R=T||e,V=T?R:c,j=360/t.directions.length,q=V.theta(e),ue=ri.normalize(q+j/2),be=j*Math.floor(ue/j);return t.previousDirectionAngle=be,R&&a.push(R.round()),a.push(e),a}},xA=function(c,e,t){return Pn(TE,this,c,Object.assign(Object.assign({},bA),e),t)},CA=function(c,e,t){const i=e.offset||32,a=e.min==null?16:e.min;let d=0,f=e.direction;const m=t.sourceBBox,y=t.targetBBox,x=m.getCenter(),E=y.getCenter();if(typeof i=="number"&&(d=i),f==null){let ue=y.left-m.right,be=y.top-m.bottom;ue>=0&&be>=0?f=ue>=be?"L":"T":ue<=0&&be>=0?(ue=m.left-y.right,ue>=0?f=ue>=be?"R":"T":f="T"):ue>=0&&be<=0?(be=m.top-y.bottom,be>=0?f=ue>=be?"L":"B":f="L"):(ue=m.left-y.right,be=m.top-y.bottom,ue>=0&&be>=0?f=ue>=be?"R":"B":ue<=0&&be>=0?f="B":ue>=0&&be<=0?f="R":f=Math.abs(ue)>Math.abs(be)?"R":"B")}f==="H"?f=E.x-x.x>=0?"L":"R":f==="V"&&(f=E.y-x.y>=0?"T":"B"),i==="center"&&(f==="L"?d=(y.left-m.right)/2:f==="R"?d=(m.left-y.right)/2:f==="T"?d=(y.top-m.bottom)/2:f==="B"&&(d=(m.top-y.bottom)/2));let S,T,R;const V=f==="L"||f==="R";if(V){if(E.y===x.y)return[...c];R=f==="L"?1:-1,S="x",T="width"}else{if(E.x===x.x)return[...c];R=f==="T"?1:-1,S="y",T="height"}const j=x.clone(),q=E.clone();if(j[S]+=R*(m[T]/2+d),q[S]-=R*(y[T]/2+d),V){const ue=j.x,be=q.x,se=m.width/2+a,Pe=y.width/2+a;E.x>x.x?be<=ue&&(j.x=Math.max(be,x.x+se),q.x=Math.min(ue,E.x-Pe)):be>=ue&&(j.x=Math.min(be,x.x-se),q.x=Math.max(ue,E.x+Pe))}else{const ue=j.y,be=q.y,se=m.height/2+a,Pe=y.height/2+a;E.y>x.y?be<=ue&&(j.y=Math.max(be,x.y+se),q.y=Math.min(ue,E.y-Pe)):be>=ue&&(j.y=Math.min(be,x.y-se),q.y=Math.max(ue,E.y+Pe))}return[j.toJSON(),...c,q.toJSON()]};function _g(c,e){if(e!=null&&e!==!1){const t=typeof e=="boolean"?0:e;if(t>0){const i=Oe.create(c[1]).move(c[2],t),a=Oe.create(c[1]).move(c[0],t);return[i.toJSON(),...c,a.toJSON()]}{const i=c[1];return[Object.assign({},i),...c,Object.assign({},i)]}}return c}const wA=function(c,e,t){const i=e.width||50,d=(e.height||80)/2,f=e.angle||"auto",m=t.sourceAnchor,y=t.targetAnchor,x=t.sourceBBox,E=t.targetBBox;if(m.equals(y)){const S=ue=>{const be=ri.toRad(ue),se=Math.sin(be),Pe=Math.cos(be),He=new Oe(m.x+Pe*i,m.y+se*i),ft=new Oe(He.x-Pe*d,He.y-se*d),pt=ft.clone().rotate(-90,He),kt=ft.clone().rotate(90,He);return[pt.toJSON(),He.toJSON(),kt.toJSON()]},T=ue=>{const be=m.clone().move(ue,-1),se=new zn(be,ue);return!x.containsPoint(ue)&&!x.intersectsWithLine(se)},R=[0,90,180,270,45,135,225,315];if(typeof f=="number")return _g(S(f),e.merge);const V=x.getCenter();if(V.equals(m))return _g(S(0),e.merge);const j=V.angleBetween(m,V.clone().translate(1,0));let q=S(j);if(T(q[1]))return _g(q,e.merge);for(let ue=1,be=R.length;ue<be;ue+=1)if(q=S(j+R[ue]),T(q[1]))return _g(q,e.merge);return _g(q,e.merge)}{const S=new zn(m,y);let T=S.parallel(-i),R=T.getCenter(),V=T.start.clone().move(T.end,d),j=T.end.clone().move(T.start,d);const q=S.parallel(-1),ue=new zn(q.start,R),be=new zn(q.end,R);if((x.containsPoint(R)||E.containsPoint(R)||x.intersectsWithLine(ue)||x.intersectsWithLine(be)||E.intersectsWithLine(ue)||E.intersectsWithLine(be))&&(T=S.parallel(i),R=T.getCenter(),V=T.start.clone().move(T.end,d),j=T.end.clone().move(T.start,d)),e.merge){const se=new zn(m,y),Pe=new zn(R,se.center).setLength(Number.MAX_SAFE_INTEGER),He=x.intersectsWithLine(Pe),ft=E.intersectsWithLine(Pe),pt=He?Array.isArray(He)?He:[He]:[];ft&&(Array.isArray(ft)?pt.push(...ft):pt.push(ft));const kt=se.center.closest(pt);kt?(t.sourceAnchor=kt.clone(),t.targetAnchor=kt.clone()):(t.sourceAnchor=se.center.clone(),t.targetAnchor=se.center.clone())}return _g([V.toJSON(),R.toJSON(),j.toJSON()],e.merge)}};var Id;(function(c){c.presets=ne,c.registry=Oo.create({type:"router"}),c.registry.register(c.presets,!0)})(Id||(Id={}));const EA=function(c,e,t,i={}){const a=[c,...t,e],d=new Zo(a),f=new sr(d);return i.raw?f:f.serialize()},SA=function(c,e,t,i={}){const a=t.length===3?0:1,d=Oe.create(t[0+a]),f=Oe.create(t[2+a]),m=Oe.create(t[1+a]);if(!Oe.equals(c,e)){const x=new Oe((c.x+e.x)/2,(c.y+e.y)/2),E=x.angleBetween(Oe.create(c).rotate(90,x),m);E>1&&(d.rotate(180-E,x),f.rotate(180-E,x),m.rotate(180-E,x))}const y=`
     M ${c.x} ${c.y}
     Q ${d.x} ${d.y} ${m.x} ${m.y}
     Q ${f.x} ${f.y} ${e.x} ${e.y}
  `;return i.raw?sr.parse(y):y},Fx=function(c,e,t,i={}){const a=new sr;a.appendSegment(sr.createSegment("M",c));const d=1/3,f=2/3,m=i.radius||10;let y,x;for(let E=0,S=t.length;E<S;E+=1){const T=Oe.create(t[E]),R=t[E-1]||c,V=t[E+1]||e;y=x||T.distance(R)/2,x=T.distance(V)/2;const j=-Math.min(m,y),q=-Math.min(m,x),ue=T.clone().move(R,j).round(),be=T.clone().move(V,q).round(),se=new Oe(d*ue.x+f*T.x,f*T.y+d*ue.y),Pe=new Oe(d*be.x+f*T.x,f*T.y+d*be.y);a.appendSegment(sr.createSegment("L",ue)),a.appendSegment(sr.createSegment("C",se,Pe,be))}return a.appendSegment(sr.createSegment("L",e)),i.raw?a:a.serialize()},AA=function(c,e,t,i={}){let a,d=i.direction;if(t&&t.length!==0){const f=[c,...t,e],m=Go.throughPoints(f);a=new sr(m)}else if(a=new sr,a.appendSegment(sr.createSegment("M",c)),d||(d=Math.abs(c.x-e.x)>=Math.abs(c.y-e.y)?"H":"V"),d==="H"){const f=(c.x+e.x)/2;a.appendSegment(sr.createSegment("C",f,c.y,f,e.y,e.x,e.y))}else{const f=(c.y+e.y)/2;a.appendSegment(sr.createSegment("C",c.x,f,e.x,f,e.x,e.y))}return i.raw?a:a.serialize()},ME=1,my=1/3,vy=2/3;function TA(c){let e=c.graph._jumpOverUpdateList;if(e==null&&(e=c.graph._jumpOverUpdateList=[],c.graph.on("cell:mouseup",()=>{const t=c.graph._jumpOverUpdateList;for(let i=0;i<t.length;i+=1)t[i].update()}),c.graph.on("model:reseted",()=>{e=c.graph._jumpOverUpdateList=[]})),e.indexOf(c)<0){e.push(c);const t=()=>e.splice(e.indexOf(c),1);c.cell.once("change:connector",t),c.cell.once("removed",t)}}function Gx(c,e,t=[]){const i=[c,...t,e],a=[];return i.forEach((d,f)=>{const m=i[f+1];m!=null&&a.push(new zn(d,m))}),a}function Vh(c,e){const t=[];return e.forEach(i=>{const a=c.intersectsWithLine(i);a&&t.push(a)}),t}function yy(c,e){return new zn(c,e).squaredLength()}function Ld(c,e,t){return e.reduce((i,a,d)=>{if(wl.includes(a))return i;const f=i.pop()||c,m=Oe.create(a).move(f.start,-t);let y=Oe.create(a).move(f.start,+t);const x=e[d+1];if(x!=null){const T=y.distance(x);T<=t&&(y=x.move(f.start,T),wl.push(x))}else if(m.distance(f.end)<t*2+ME)return i.push(f),i;if(y.distance(f.start)<t*2+ME)return i.push(f),i;const S=new zn(m,y);return jh.push(S),i.push(new zn(f.start,m),S,new zn(y,f.end)),i},[])}function cp(c,e,t,i){const a=new sr;let d;return d=sr.createSegment("M",c[0].start),a.appendSegment(d),c.forEach((f,m)=>{if(jh.includes(f)){let y,x,E,S;if(t==="arc"){y=-90,x=f.start.diff(f.end),(x.x<0||x.x===0&&x.y<0)&&(y+=180);const R=f.getCenter(),V=new zn(R,f.end).rotate(y,R);let j;j=new zn(f.start,R),E=j.pointAt(2/3).rotate(y,f.start),S=V.pointAt(1/3).rotate(-y,V.end),d=sr.createSegment("C",E,S,V.end),a.appendSegment(d),j=new zn(R,f.end),E=V.pointAt(1/3).rotate(y,V.end),S=j.pointAt(1/3).rotate(-y,f.end),d=sr.createSegment("C",E,S,f.end),a.appendSegment(d)}else if(t==="gap")d=sr.createSegment("M",f.end),a.appendSegment(d);else if(t==="cubic"){y=f.start.theta(f.end);const T=e*.6;let R=e*1.35;x=f.start.diff(f.end),(x.x<0||x.x===0&&x.y<0)&&(R*=-1),E=new Oe(f.start.x+T,f.start.y+R).rotate(y,f.start),S=new Oe(f.end.x-T,f.end.y+R).rotate(y,f.end),d=sr.createSegment("C",E,S,f.end),a.appendSegment(d)}}else{const y=c[m+1];i===0||!y||jh.includes(y)?(d=sr.createSegment("L",f.end),a.appendSegment(d)):PE(i,a,f.end,f.start,y.end)}}),a}function PE(c,e,t,i,a){const d=t.distance(i)/2,f=t.distance(a)/2,m=-Math.min(c,d),y=-Math.min(c,f),x=t.clone().move(i,m).round(),E=t.clone().move(a,y).round(),S=new Oe(my*x.x+vy*t.x,vy*t.y+my*x.y),T=new Oe(my*E.x+vy*t.x,vy*t.y+my*E.y);let R;R=sr.createSegment("L",x),e.appendSegment(R),R=sr.createSegment("C",S,T,E),e.appendSegment(R)}let jh,wl;const Hh=function(c,e,t,i={}){jh=[],wl=[],TA(this);const a=i.size||5,d=i.type||"arc",f=i.radius||0,m=i.ignoreConnectors||["smooth"],y=this.graph,E=y.model.getEdges();if(E.length===1)return cp(Gx(c,e,t),a,d,f);const S=this.cell,T=E.indexOf(S),R=y.options.connecting.connector||{},V=E.filter((Pe,He)=>{const ft=Pe.getConnector()||R;return m.includes(ft.name)?!1:He>T?ft.name!=="jumpover":!0}),j=V.map(Pe=>y.renderer.findViewByCell(Pe)),q=Gx(c,e,t),ue=j.map(Pe=>Pe==null?[]:Pe===this?q:Gx(Pe.sourcePoint,Pe.targetPoint,Pe.routePoints)),be=[];q.forEach(Pe=>{const He=V.reduce((ft,pt,kt)=>{if(pt!==S){const cn=Vh(Pe,ue[kt]);ft.push(...cn)}return ft},[]).sort((ft,pt)=>yy(Pe.start,ft)-yy(Pe.start,pt));He.length>0?be.push(...Ld(Pe,He,a)):be.push(Pe)});const se=cp(be,a,d,f);return jh=[],wl=[],i.raw?se:se.serialize()};var Du;(function(c){c.presets=he,c.registry=Oo.create({type:"connector"}),c.registry.register(c.presets,!0)})(Du||(Du={}));const Bx=Oo.create;class up{constructor(e){this.cell=e,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(e,t,i={},a="/"){const d=this.cell.getPropByPath(e),f=Cf(i,up.defaultOptions),m=this.getTiming(f.timing),y=this.getInterp(f.interp,d,t);let x=0;const E=Array.isArray(e)?e.join(a):e,S=Array.isArray(e)?e:e.split(a),T=()=>{const R=new Date().getTime();x===0&&(x=R);let j=(R-x)/f.duration;j<1?this.ids[E]=qf(T):j=1;const q=y(m(j));this.cell.setPropByPath(S,q),i.progress&&i.progress(Object.assign({progress:j,currentValue:q},this.getArgs(E))),j===1&&(this.cell.notify("transition:end",this.getArgs(E)),this.cell.notify("transition:complete",this.getArgs(E)),i.complete&&i.complete(this.getArgs(E)),this.cell.notify("transition:finish",this.getArgs(E)),i.finish&&i.finish(this.getArgs(E)),this.clean(E))};return setTimeout(()=>{this.stop(e,void 0,a),this.cache[E]={startValue:d,targetValue:t,options:f},this.ids[E]=qf(T),this.cell.notify("transition:begin",this.getArgs(E)),this.cell.notify("transition:start",this.getArgs(E)),i.start&&i.start(this.getArgs(E))},i.delay),this.stop.bind(this,e,a,i)}stop(e,t={},i="/"){const a=Array.isArray(e)?e:e.split(i);return Object.keys(this.ids).filter(d=>ea(a,d.split(i).slice(0,a.length))).forEach(d=>{Um(this.ids[d]);const f=this.cache[d],m=this.getArgs(d),y=Object.assign(Object.assign({},f.options),t),x=y.jumpedToEnd;x&&f.targetValue!=null&&(this.cell.setPropByPath(d,f.targetValue),this.cell.notify("transition:end",Object.assign({},m)),this.cell.notify("transition:complete",Object.assign({},m)),y.complete&&y.complete(Object.assign({},m)));const E=Object.assign({jumpedToEnd:x},m);this.cell.notify("transition:stop",Object.assign({},E)),y.stop&&y.stop(Object.assign({},E)),this.cell.notify("transition:finish",Object.assign({},m)),y.finish&&y.finish(Object.assign({},m)),this.clean(d)}),this}clean(e){delete this.ids[e],delete this.cache[e]}getTiming(e){return typeof e=="string"?_d[e]:e}getInterp(e,t,i){return e?e(t,i):typeof i=="number"?Nd.number(t,i):typeof i=="string"?i[0]==="#"?Nd.color(t,i):Nd.unit(t,i):Nd.object(t,i)}getArgs(e){const t=this.cache[e];return{path:e,startValue:t.startValue,targetValue:t.targetValue,cell:this.cell}}}(function(c){c.defaultOptions={delay:10,duration:100,timing:"linear"}})(up||(up={}));var zx=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class c0 extends Is{constructor(e={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(qi(e)),this.changed={}}mutate(e,t={}){const i=t.unset===!0,a=t.silent===!0,d=[],f=this.changing;this.changing=!0,f||(this.previous=qi(this.data),this.changed={});const m=this.data,y=this.previous,x=this.changed;if(Object.keys(e).forEach(E=>{const S=E,T=e[S];ea(m[S],T)||d.push(S),ea(y[S],T)?delete x[S]:x[S]=T,i?delete m[S]:m[S]=T}),!a&&d.length>0&&(this.pending=!0,this.pendingOptions=t,d.forEach(E=>{this.emit("change:*",{key:E,options:t,store:this,current:m[E],previous:y[E]})})),f)return this;if(!a)for(;this.pending;)this.pending=!1,this.emit("changed",{current:m,previous:y,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(e,t){if(e==null)return this.data;const i=this.data[e];return i??t}getPrevious(e){if(this.previous){const t=this.previous[e];return t??void 0}}set(e,t,i){return e!=null&&(typeof e=="object"?this.mutate(e,t):this.mutate({[e]:t},i)),this}remove(e,t){const a={};let d;if(typeof e=="string")a[e]=void 0,d=t;else if(Array.isArray(e))e.forEach(f=>a[f]=void 0),d=t;else{for(const f in this.data)a[f]=void 0;d=e}return this.mutate(a,Object.assign(Object.assign({},d),{unset:!0})),this}getByPath(e){return sh(this.data,e,"/")}setByPath(e,t,i={}){const a="/",d=Array.isArray(e)?[...e]:e.split(a),f=Array.isArray(e)?e.join(a):e,m=d[0],y=d.length;if(i.propertyPath=f,i.propertyValue=t,i.propertyPathArray=d,y===1)this.set(m,t,i);else{const x={};let E=x,S=m;for(let V=1;V<y;V+=1){const j=d[V],q=Number.isFinite(Number(j));E=E[S]=q?[]:{},S=j}Os(x,d,t,a);const T=qi(this.data);i.rewrite&&ah(T,e,a);const R=Pi.Z(T,x);this.set(m,R[m],i)}return this}removeByPath(e,t){const i=Array.isArray(e)?e:e.split("/"),a=i[0];if(i.length===1)this.remove(a,t);else{const d=i.slice(1),f=qi(this.get(a));f&&ah(f,d),this.set(a,f,t)}return this}hasChanged(e){return e==null?Object.keys(this.changed).length>0:e in this.changed}getChanges(e){if(e==null)return this.hasChanged()?qi(this.changed):null;const t=this.changing?this.previous:this.data,i={};let a;for(const d in e){const f=e[d];ea(t[d],f)||(i[d]=f,a=!0)}return a?qi(i):null}toJSON(){return qi(this.data)}clone(){const e=this.constructor;return new e(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}zx([Is.dispose()],c0.prototype,"dispose",null);var Ux=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},by=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Xr extends Is{constructor(e={}){super();const i=this.constructor.getDefaults(!0),a=Pi.Z({},this.preprocess(i),this.preprocess(e));this.id=a.id||og(),this.store=new c0(a),this.animation=new up(this),this.setup(),this.init(),this.postprocess(e)}static config(e){const{markup:t,propHooks:i,attrHooks:a}=e,d=by(e,["markup","propHooks","attrHooks"]);t!=null&&(this.markup=t),i&&(this.propHooks=this.propHooks.slice(),Array.isArray(i)?this.propHooks.push(...i):typeof i=="function"?this.propHooks.push(i):Object.keys(i).forEach(f=>{const m=i[f];typeof m=="function"&&this.propHooks.push(m)})),a&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),a)),this.defaults=Pi.Z({},this.defaults,d)}static getMarkup(){return this.markup}static getDefaults(e){return e?this.defaults:qi(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(e,t){return this.propHooks.reduce((i,a)=>a?Pn(a,e,i):i,t)}get[Symbol.toStringTag](){return Xr.toStringTag}init(){}get model(){return this._model}set model(e){this._model!==e&&(this._model=e)}preprocess(e,t){const i=e.id,d=this.constructor.applyPropHooks(this,e);return i==null&&t!==!0&&(d.id=og()),d}postprocess(e){}setup(){this.store.on("change:*",e=>{const{key:t,current:i,previous:a,options:d}=e;this.notify("change:*",{key:t,options:d,current:i,previous:a,cell:this}),this.notify(`change:${t}`,{options:d,current:i,previous:a,cell:this});const f=t;(f==="source"||f==="target")&&this.notify("change:terminal",{type:f,current:i,previous:a,options:d,cell:this})}),this.store.on("changed",({options:e})=>this.notify("changed",{options:e,cell:this}))}notify(e,t){this.trigger(e,t);const i=this.model;return i&&(i.notify(`cell:${e}`,t),this.isNode()?i.notify(`node:${e}`,Object.assign(Object.assign({},t),{node:this})):this.isEdge()&&i.notify(`edge:${e}`,Object.assign(Object.assign({},t),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(e){return this.store===e.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(e,t){return e==null?this.store.get():this.store.get(e,t)}setProp(e,t,i){if(typeof e=="string")this.store.set(e,t,i);else{const a=this.preprocess(e,!0);this.store.set(Pi.Z({},this.getProp(),a),t),this.postprocess(e)}return this}removeProp(e,t){return typeof e=="string"||Array.isArray(e)?this.store.removeByPath(e,t):this.store.remove(t),this}hasChanged(e){return e==null?this.store.hasChanged():this.store.hasChanged(e)}getPropByPath(e){return this.store.getByPath(e)}setPropByPath(e,t,i={}){return this.model&&(e==="children"?this._children=t?t.map(a=>this.model.getCell(a)).filter(a=>a!=null):null:e==="parent"&&(this._parent=t?this.model.getCell(t):null)),this.store.setByPath(e,t,i),this}removePropByPath(e,t={}){const i=Array.isArray(e)?e:e.split("/");return i[0]==="attrs"&&(t.dirty=!0),this.store.removeByPath(i,t),this}prop(e,t,i){return e==null?this.getProp():typeof e=="string"||Array.isArray(e)?arguments.length===1?this.getPropByPath(e):t==null?this.removePropByPath(e,i||{}):this.setPropByPath(e,t,i||{}):this.setProp(e,t||{})}previous(e){return this.store.getPrevious(e)}get zIndex(){return this.getZIndex()}set zIndex(e){e==null?this.removeZIndex():this.setZIndex(e)}getZIndex(){return this.store.get("zIndex")}setZIndex(e,t={}){return this.store.set("zIndex",e,t),this}removeZIndex(e={}){return this.store.remove("zIndex",e),this}toFront(e={}){const t=this.model;if(t){let i=t.getMaxZIndex(),a;e.deep?(a=this.getDescendants({deep:!0,breadthFirst:!0}),a.unshift(this)):a=[this],i=i-a.length+1;const d=t.total();let f=t.indexOf(this)!==d-a.length;f||(f=a.some((m,y)=>m.getZIndex()!==i+y)),f&&this.batchUpdate("to-front",()=>{i+=a.length,a.forEach((m,y)=>{m.setZIndex(i+y,e)})})}return this}toBack(e={}){const t=this.model;if(t){let i=t.getMinZIndex(),a;e.deep?(a=this.getDescendants({deep:!0,breadthFirst:!0}),a.unshift(this)):a=[this];let d=t.indexOf(this)!==0;d||(d=a.some((f,m)=>f.getZIndex()!==i+m)),d&&this.batchUpdate("to-back",()=>{i-=a.length,a.forEach((f,m)=>{f.setZIndex(i+m,e)})})}return this}get markup(){return this.getMarkup()}set markup(e){e==null?this.removeMarkup():this.setMarkup(e)}getMarkup(){let e=this.store.get("markup");return e==null&&(e=this.constructor.getMarkup()),e}setMarkup(e,t={}){return this.store.set("markup",e,t),this}removeMarkup(e={}){return this.store.remove("markup",e),this}get attrs(){return this.getAttrs()}set attrs(e){e==null?this.removeAttrs():this.setAttrs(e)}getAttrs(){const e=this.store.get("attrs");return e?Object.assign({},e):{}}setAttrs(e,t={}){if(e==null)this.removeAttrs(t);else{const i=a=>this.store.set("attrs",a,t);if(t.overwrite===!0)i(e);else{const a=this.getAttrs();t.deep===!1?i(Object.assign(Object.assign({},a),e)):i(Pi.Z({},a,e))}}return this}replaceAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{overwrite:!0}))}updateAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{deep:!1}))}removeAttrs(e={}){return this.store.remove("attrs",e),this}getAttrDefinition(e){if(!e)return null;const i=this.constructor.getAttrHooks()||{};let a=i[e]||yl.registry.get(e);if(!a){const d=as(e);a=i[d]||yl.registry.get(d)}return a||null}getAttrByPath(e){return e==null||e===""?this.getAttrs():this.getPropByPath(this.prefixAttrPath(e))}setAttrByPath(e,t,i={}){return this.setPropByPath(this.prefixAttrPath(e),t,i),this}removeAttrByPath(e,t={}){return this.removePropByPath(this.prefixAttrPath(e),t),this}prefixAttrPath(e){return Array.isArray(e)?["attrs"].concat(e):`attrs/${e}`}attr(e,t,i){return e==null?this.getAttrByPath():typeof e=="string"||Array.isArray(e)?arguments.length===1?this.getAttrByPath(e):t==null?this.removeAttrByPath(e,i||{}):this.setAttrByPath(e,t,i||{}):this.setAttrs(e,t||{})}get visible(){return this.isVisible()}set visible(e){this.setVisible(e)}setVisible(e,t={}){return this.store.set("visible",e,t),this}isVisible(){return this.store.get("visible")!==!1}show(e={}){return this.isVisible()||this.setVisible(!0,e),this}hide(e={}){return this.isVisible()&&this.setVisible(!1,e),this}toggleVisible(e,t={}){const i=typeof e=="boolean"?e:!this.isVisible(),a=typeof e=="boolean"?t:e;return i?this.show(a):this.hide(a),this}get data(){return this.getData()}set data(e){this.setData(e)}getData(){return this.store.get("data")}setData(e,t={}){if(e==null)this.removeData(t);else{const i=a=>this.store.set("data",a,t);if(t.overwrite===!0)i(e);else{const a=this.getData();t.deep===!1?i(typeof e=="object"?Object.assign(Object.assign({},a),e):e):i(Pi.Z({},a,e))}}return this}replaceData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{overwrite:!0}))}updateData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{deep:!1}))}removeData(e={}){return this.store.remove("data",e),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){const e=this.getParentId();if(e&&this.model){const t=this.model.getCell(e);return this._parent=t,t}return null}getChildren(){const e=this.store.get("children");if(e&&e.length&&this.model){const t=e.map(i=>{var a;return(a=this.model)===null||a===void 0?void 0:a.getCell(i)}).filter(i=>i!=null);return this._children=t,[...t]}return null}hasParent(){return this.parent!=null}isParentOf(e){return e!=null&&e.getParent()===this}isChildOf(e){return e!=null&&this.getParent()===e}eachChild(e,t){return this.children&&this.children.forEach(e,t),this}filterChild(e,t){return this.children?this.children.filter(e,t):[]}getChildCount(){return this.children==null?0:this.children.length}getChildIndex(e){return this.children==null?-1:this.children.indexOf(e)}getChildAt(e){return this.children!=null&&e>=0?this.children[e]:null}getAncestors(e={}){const t=[];let i=this.getParent();for(;i;)t.push(i),i=e.deep!==!1?i.getParent():null;return t}getDescendants(e={}){if(e.deep!==!1){if(e.breadthFirst){const t=[],i=this.getChildren()||[];for(;i.length>0;){const a=i.shift(),d=a.getChildren();t.push(a),d&&i.push(...d)}return t}{const t=this.getChildren()||[];return t.forEach(i=>{t.push(...i.getDescendants(e))}),t}}return this.getChildren()||[]}isDescendantOf(e,t={}){if(e==null)return!1;if(t.deep!==!1){let i=this.getParent();for(;i;){if(i===e)return!0;i=i.getParent()}return!1}return this.isChildOf(e)}isAncestorOf(e,t={}){return e==null?!1:e.isDescendantOf(this,t)}contains(e){return this.isAncestorOf(e)}getCommonAncestor(...e){return Xr.getCommonAncestor(this,...e)}setParent(e,t={}){return this._parent=e,e?this.store.set("parent",e.id,t):this.store.remove("parent",t),this}setChildren(e,t={}){return this._children=e,e!=null?this.store.set("children",e.map(i=>i.id),t):this.store.remove("children",t),this}unembed(e,t={}){const i=this.children;if(i!=null&&e!=null){const a=this.getChildIndex(e);a!==-1&&(i.splice(a,1),e.setParent(null,t),this.setChildren(i,t))}return this}embed(e,t={}){return e.addTo(this,t),this}addTo(e,t={}){return Xr.isCell(e)?e.addChild(this,t):e.addCell(this,t),this}insertTo(e,t,i={}){return e.insertChild(this,t,i),this}addChild(e,t={}){return this.insertChild(e,void 0,t)}insertChild(e,t,i={}){if(e!=null&&e!==this){const a=e.getParent(),d=this!==a;let f=t;if(f==null&&(f=this.getChildCount(),d||(f-=1)),a){const y=a.getChildren();if(y){const x=y.indexOf(e);x>=0&&(e.setParent(null,i),y.splice(x,1),a.setChildren(y,i))}}let m=this.children;if(m==null?(m=[],m.push(e)):m.splice(f,0,e),e.setParent(this,i),this.setChildren(m,i),d&&this.model){const y=this.model.getIncomingEdges(this),x=this.model.getOutgoingEdges(this);y&&y.forEach(E=>E.updateParent(i)),x&&x.forEach(E=>E.updateParent(i))}this.model&&this.model.addCell(e,i)}return this}removeFromParent(e={}){const t=this.getParent();if(t!=null){const i=t.getChildIndex(this);t.removeChildAt(i,e)}return this}removeChild(e,t={}){const i=this.getChildIndex(e);return this.removeChildAt(i,t)}removeChildAt(e,t={}){const i=this.getChildAt(e);return this.children!=null&&i!=null&&(this.unembed(i,t),i.remove(t)),i}remove(e={}){return this.batchUpdate("remove",()=>{const t=this.getParent();t&&t.removeChild(this,e),e.deep!==!1&&this.eachChild(i=>i.remove(e)),this.model&&this.model.removeCell(this,e)}),this}transition(e,t,i={},a="/"){return this.animation.start(e,t,i,a)}stopTransition(e,t,i="/"){return this.animation.stop(e,t,i),this}getTransitions(){return this.animation.get()}translate(e,t,i){return this}scale(e,t,i,a){return this}addTools(e,t,i){const a=Array.isArray(e)?e:[e],d=typeof t=="string"?t:null,f=typeof t=="object"?t:typeof i=="object"?i:{};if(f.reset)return this.setTools({name:d,items:a,local:f.local},f);let m=qi(this.getTools());if(m==null||d==null||m.name===d)return m==null&&(m={}),m.items||(m.items=[]),m.name=d,m.items=[...m.items,...a],this.setTools(Object.assign({},m),f)}setTools(e,t={}){return e==null?this.removeTools():this.store.set("tools",Xr.normalizeTools(e),t),this}getTools(){return this.store.get("tools")}removeTools(e={}){return this.store.remove("tools",e),this}hasTools(e){const t=this.getTools();return t==null?!1:e==null?!0:t.name===e}hasTool(e){const t=this.getTools();return t==null?!1:t.items.some(i=>typeof i=="string"?i===e:i.name===e)}removeTool(e,t={}){const i=qi(this.getTools());if(i){let a=!1;const d=i.items.slice(),f=m=>{d.splice(m,1),a=!0};if(typeof e=="number")f(e);else for(let m=d.length-1;m>=0;m-=1){const y=d[m];(typeof y=="string"?y===e:y.name===e)&&f(m)}a&&(i.items=d,this.setTools(i,t))}return this}getBBox(e){return new gn}getConnectionPoint(e,t){return new Oe}toJSON(e={}){const t=Object.assign({},this.store.get()),i=Object.prototype.toString,a=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!t.shape){const V=this.constructor;throw new Error(`Unable to serialize ${a} missing "shape" prop, check the ${a} "${V.name||i.call(V)}"`)}const d=this.constructor,f=e.diff===!0,m=t.attrs||{},y=d.getDefaults(!0),x=f?this.preprocess(y,!0):y,E=x.attrs||{},S={};Object.keys(t).forEach(V=>{const j=t[V];if(j!=null&&!Array.isArray(j)&&typeof j=="object"&&!Ge.Z(j))throw new Error(`Can only serialize ${a} with plain-object props, but got a "${i.call(j)}" type of key "${V}" on ${a} "${this.id}"`);if(V!=="attrs"&&V!=="shape"&&f){const q=x[V];ea(j,q)&&delete t[V]}}),Object.keys(m).forEach(V=>{const j=m[V],q=E[V];Object.keys(j).forEach(ue=>{const be=j[ue],se=q?q[ue]:null;be!=null&&typeof be=="object"&&!Array.isArray(be)?Object.keys(be).forEach(Pe=>{const He=be[Pe];if(q==null||se==null||!Js.Z(se)||!ea(se[Pe],He)){S[V]==null&&(S[V]={}),S[V][ue]==null&&(S[V][ue]={});const ft=S[V][ue];ft[Pe]=He}}):(q==null||!ea(se,be))&&(S[V]==null&&(S[V]={}),S[V][ue]=be)})});const T=Object.assign(Object.assign({},t),{attrs:re(S)?void 0:S});T.attrs==null&&delete T.attrs;const R=T;return R.angle===0&&delete R.angle,qi(R)}clone(e={}){if(!e.deep){const i=Object.assign({},this.store.get());e.keepId||delete i.id,delete i.parent,delete i.children;const a=this.constructor;return new a(i)}return Xr.deepClone(this)[this.id]}findView(e){return e.renderer.findViewByCell(this)}startBatch(e,t={},i=this.model){return this.notify("batch:start",{name:e,data:t,cell:this}),i&&i.startBatch(e,Object.assign(Object.assign({},t),{cell:this})),this}stopBatch(e,t={},i=this.model){return i&&i.stopBatch(e,Object.assign(Object.assign({},t),{cell:this})),this.notify("batch:stop",{name:e,data:t,cell:this}),this}batchUpdate(e,t,i){const a=this.model;this.startBatch(e,i,a);const d=t();return this.stopBatch(e,i,a),d}dispose(){this.removeFromParent(),this.store.dispose()}}Xr.defaults={},Xr.attrHooks={},Xr.propHooks=[],Ux([Is.dispose()],Xr.prototype,"dispose",null),function(c){function e(t){return typeof t=="string"?{items:[t]}:Array.isArray(t)?{items:t}:t.items?t:{items:[t]}}c.normalizeTools=e}(Xr||(Xr={})),function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.isNode=="function"&&typeof a.isEdge=="function"&&typeof a.prop=="function"&&typeof a.attr=="function"}c.isCell=e}(Xr||(Xr={})),function(c){function e(...d){const f=d.filter(y=>y!=null).map(y=>y.getAncestors()).sort((y,x)=>y.length-x.length);return f.shift().find(y=>f.every(x=>x.includes(y)))||null}c.getCommonAncestor=e;function t(d,f={}){let m=null;for(let y=0,x=d.length;y<x;y+=1){const E=d[y];let S=E.getBBox(f);if(S){if(E.isNode()){const T=E.getAngle();T!=null&&T!==0&&(S=S.bbox(T))}m=m==null?S:m.union(S)}}return m}c.getCellsBBox=t;function i(d){const f=[d,...d.getDescendants({deep:!0})];return c.cloneCells(f)}c.deepClone=i;function a(d){const f=Hr(d),m=f.reduce((y,x)=>(y[x.id]=x.clone(),y),{});return f.forEach(y=>{const x=m[y.id];if(x.isEdge()){const T=x.getSourceCellId(),R=x.getTargetCellId();T&&m[T]&&x.setSource(Object.assign(Object.assign({},x.getSource()),{cell:m[T].id})),R&&m[R]&&x.setTarget(Object.assign(Object.assign({},x.getTarget()),{cell:m[R].id}))}const E=y.getParent();E&&m[E.id]&&x.setParent(m[E.id]);const S=y.getChildren();if(S&&S.length){const T=S.reduce((R,V)=>(m[V.id]&&R.push(m[V.id]),R),[]);T.length>0&&x.setChildren(T)}}),m}c.cloneCells=a}(Xr||(Xr={})),function(c){c.config({propHooks(e){var{tools:t}=e,i=by(e,["tools"]);return t&&(i.tools=c.normalizeTools(t)),i}})}(Xr||(Xr={}));var xi;(function(c){let e,t;function i(f,m){return m?e!=null&&e.exist(f):t!=null&&t.exist(f)}c.exist=i;function a(f){e=f}c.setEdgeRegistry=a;function d(f){t=f}c.setNodeRegistry=d})(xi||(xi={}));class u0{constructor(e){this.ports=[],this.groups={},this.init(qi(e))}getPorts(){return this.ports}getGroup(e){return e!=null?this.groups[e]:null}getPortsByGroup(e){return this.ports.filter(t=>t.group===e||t.group==null&&e==null)}getPortsLayoutByGroup(e,t){const i=this.getPortsByGroup(e),a=e?this.getGroup(e):null,d=a?a.position:null,f=d?d.name:null;let m;if(f!=null){const S=Au.registry.get(f);if(S==null)return Au.registry.onNotFound(f);m=S}else m=Au.presets.left;const y=i.map(S=>S&&S.position&&S.position.args||{}),x=d&&d.args||{};return m(y,t,x).map((S,T)=>{const R=i[T];return{portLayout:S,portId:R.id,portSize:R.size,portAttrs:R.attrs,labelSize:R.label.size,labelLayout:this.getPortLabelLayout(R,Oe.create(S.position),t)}})}init(e){const{groups:t,items:i}=e;t!=null&&Object.keys(t).forEach(a=>{this.groups[a]=this.parseGroup(t[a])}),Array.isArray(i)&&i.forEach(a=>{this.ports.push(this.parsePort(a))})}parseGroup(e){return Object.assign(Object.assign({},e),{label:this.getLabel(e,!0),position:this.getPortPosition(e.position,!0)})}parsePort(e){const t=Object.assign({},e),i=this.getGroup(e.group)||{};return t.markup=t.markup||i.markup,t.attrs=Pi.Z({},i.attrs,t.attrs),t.position=this.createPosition(i,t),t.label=Pi.Z({},i.label,this.getLabel(t)),t.zIndex=this.getZIndex(i,t),t.size=Object.assign(Object.assign({},i.size),t.size),t}getZIndex(e,t){return typeof t.zIndex=="number"?t.zIndex:typeof e.zIndex=="number"||e.zIndex==="auto"?e.zIndex:"auto"}createPosition(e,t){return Pi.Z({name:"left",args:{}},e.position,{args:t.args})}getPortPosition(e,t=!1){if(e==null){if(t)return{name:"left",args:{}}}else{if(typeof e=="string")return{name:e,args:{}};if(Array.isArray(e))return{name:"absolute",args:{x:e[0],y:e[1]}};if(typeof e=="object")return e}return{args:{}}}getPortLabelPosition(e,t=!1){if(e==null){if(t)return{name:"left",args:{}}}else{if(typeof e=="string")return{name:e,args:{}};if(typeof e=="object")return e}return{args:{}}}getLabel(e,t=!1){const i=e.label||{};return i.position=this.getPortLabelPosition(i.position,t),i}getPortLabelLayout(e,t,i){const a=e.label.position.name||"left",d=e.label.position.args||{},f=Fh.registry.get(a)||Fh.presets.left;return f?f(t,i,d):null}}var Uc=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Si extends Xr{constructor(e={}){super(e),this.initPorts()}get[Symbol.toStringTag](){return Si.toStringTag}preprocess(e,t){const{x:i,y:a,width:d,height:f}=e,m=Uc(e,["x","y","width","height"]);if(i!=null||a!=null){const y=m.position;m.position=Object.assign(Object.assign({},y),{x:i??(y?y.x:0),y:a??(y?y.y:0)})}if(d!=null||f!=null){const y=m.size;m.size=Object.assign(Object.assign({},y),{width:d??(y?y.width:0),height:f??(y?y.height:0)})}return super.preprocess(m,t)}isNode(){return!0}size(e,t,i){return e===void 0?this.getSize():typeof e=="number"?this.setSize(e,t,i):this.setSize(e,t)}getSize(){const e=this.store.get("size");return e?Object.assign({},e):{width:1,height:1}}setSize(e,t,i){return typeof e=="object"?this.resize(e.width,e.height,t):this.resize(e,t,i),this}resize(e,t,i={}){this.startBatch("resize",i);const a=i.direction;if(a){const d=this.getSize();switch(a){case"left":case"right":t=d.height;break;case"top":case"bottom":e=d.width;break;default:break}let m={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[a];const y=ri.normalize(this.getAngle()||0);i.absolute&&(m+=Math.floor((y+45)/90),m%=4);const x=this.getBBox();let E;m===0?E=x.getBottomLeft():m===1?E=x.getCorner():m===2?E=x.getTopRight():E=x.getOrigin();const S=E.clone().rotate(-y,x.getCenter()),T=Math.sqrt(e*e+t*t)/2;let R=m*Math.PI/2;R+=Math.atan(m%2===0?t/e:e/t),R-=ri.toRad(y);const j=Oe.fromPolar(T,R,S).clone().translate(e/-2,t/-2);this.store.set("size",{width:e,height:t},i),this.setPosition(j.x,j.y,i)}else this.store.set("size",{width:e,height:t},i);return this.stopBatch("resize",i),this}scale(e,t,i,a={}){const d=this.getBBox().scale(e,t,i??void 0);return this.startBatch("scale",a),this.setPosition(d.x,d.y,a),this.resize(d.width,d.height,a),this.stopBatch("scale"),this}position(e,t,i){return typeof e=="number"?this.setPosition(e,t,i):this.getPosition(e)}getPosition(e={}){if(e.relative){const i=this.getParent();if(i!=null&&i.isNode()){const a=this.getPosition(),d=i.getPosition();return{x:a.x-d.x,y:a.y-d.y}}}const t=this.store.get("position");return t?Object.assign({},t):{x:0,y:0}}setPosition(e,t,i={}){let a,d,f;if(typeof e=="object"?(a=e.x,d=e.y,f=t||{}):(a=e,d=t,f=i||{}),f.relative){const m=this.getParent();if(m!=null&&m.isNode()){const y=m.getPosition();a+=y.x,d+=y.y}}if(f.deep){const m=this.getPosition();this.translate(a-m.x,d-m.y,f)}else this.store.set("position",{x:a,y:d},f);return this}translate(e=0,t=0,i={}){if(e===0&&t===0)return this;i.translateBy=i.translateBy||this.id;const a=this.getPosition();if(i.restrict!=null&&i.translateBy===this.id){const f=this.getBBox({deep:!0}),m=i.restrict,y=a.x-f.x,x=a.y-f.y,E=Math.max(m.x+y,Math.min(m.x+m.width+y-f.width,a.x+e)),S=Math.max(m.y+x,Math.min(m.y+m.height+x-f.height,a.y+t));e=E-a.x,t=S-a.y}const d={x:a.x+e,y:a.y+t};return i.tx=e,i.ty=t,i.transition?(typeof i.transition!="object"&&(i.transition={}),this.transition("position",d,Object.assign(Object.assign({},i.transition),{interp:Nd.object})),this.eachChild(f=>{var m;((m=i.exclude)===null||m===void 0?void 0:m.includes(f))||f.translate(e,t,i)})):(this.startBatch("translate",i),this.store.set("position",d,i),this.eachChild(f=>{var m;((m=i.exclude)===null||m===void 0?void 0:m.includes(f))||f.translate(e,t,i)}),this.stopBatch("translate",i)),this}angle(e,t){return e==null?this.getAngle():this.rotate(e,t)}getAngle(){return this.store.get("angle",0)}rotate(e,t={}){const i=this.getAngle();if(t.center){const a=this.getSize(),d=this.getPosition(),f=this.getBBox().getCenter();f.rotate(i-e,t.center);const m=f.x-a.width/2-d.x,y=f.y-a.height/2-d.y;this.startBatch("rotate",{angle:e,options:t}),this.setPosition(d.x+m,d.y+y,t),this.rotate(e,Object.assign(Object.assign({},t),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",t.absolute?e:(i+e)%360,t);return this}getBBox(e={}){if(e.deep){const t=this.getDescendants({deep:!0,breadthFirst:!0});return t.push(this),Xr.getCellsBBox(t)}return gn.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(e,t){const i=this.getBBox(),a=i.getCenter(),d=e.getTerminal(t);if(d==null)return a;const f=d.port;if(!f||!this.hasPort(f))return a;const m=this.getPort(f);if(!m||!m.group)return a;const x=this.getPortsPosition(m.group)[f].position,E=Oe.create(x).translate(i.getOrigin()),S=this.getAngle();return S&&E.rotate(-S,a),E}fit(e={}){const i=(this.getChildren()||[]).filter(x=>x.isNode());if(i.length===0)return this;this.startBatch("fit-embeds",e),e.deep&&i.forEach(x=>x.fit(e));let{x:a,y:d,width:f,height:m}=Xr.getCellsBBox(i);const y=Ma(e.padding);return a-=y.left,d-=y.top,f+=y.left+y.right,m+=y.bottom+y.top,this.store.set({position:{x:a,y:d},size:{width:f,height:m}},e),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(e){this.setPortContainerMarkup(e)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||li.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(e,t={}){return this.store.set("portContainerMarkup",li.clone(e),t),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(e){this.setPortMarkup(e)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||li.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(e,t={}){return this.store.set("portMarkup",li.clone(e),t),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(e){this.setPortLabelMarkup(e)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||li.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(e,t={}){return this.store.set("portLabelMarkup",li.clone(e),t),this}get ports(){const e=this.store.get("ports",{items:[]});return e.items==null&&(e.items=[]),e}getPorts(){return qi(this.ports.items)}getPortsByGroup(e){return this.getPorts().filter(t=>t.group===e)}getPort(e){return qi(this.ports.items.find(t=>t.id&&t.id===e))}getPortAt(e){return this.ports.items[e]||null}hasPorts(){return this.ports.items.length>0}hasPort(e){return this.getPortIndex(e)!==-1}getPortIndex(e){const t=typeof e=="string"?e:e.id;return t!=null?this.ports.items.findIndex(i=>i.id===t):-1}getPortsPosition(e){const t=this.getSize();return this.port.getPortsLayoutByGroup(e,new gn(0,0,t.width,t.height)).reduce((a,d)=>{const f=d.portLayout;return a[d.portId]={position:Object.assign({},f.position),angle:f.angle||0},a},{})}getPortProp(e,t){return this.getPropByPath(this.prefixPortPath(e,t))}setPortProp(e,t,i,a){if(typeof t=="string"||Array.isArray(t)){const m=this.prefixPortPath(e,t),y=i;return this.setPropByPath(m,y,a)}const d=this.prefixPortPath(e),f=t;return this.setPropByPath(d,f,i)}removePortProp(e,t,i){return typeof t=="string"||Array.isArray(t)?this.removePropByPath(this.prefixPortPath(e,t),i):this.removePropByPath(this.prefixPortPath(e),t)}portProp(e,t,i,a){return t==null?this.getPortProp(e):typeof t=="string"||Array.isArray(t)?arguments.length===2?this.getPortProp(e,t):i==null?this.removePortProp(e,t,a):this.setPortProp(e,t,i,a):this.setPortProp(e,t,i)}prefixPortPath(e,t){const i=this.getPortIndex(e);if(i===-1)throw new Error(`Unable to find port with id: "${e}"`);return t==null||t===""?["ports","items",`${i}`]:Array.isArray(t)?["ports","items",`${i}`,...t]:`ports/items/${i}/${t}`}addPort(e,t){const i=[...this.ports.items];return i.push(e),this.setPropByPath("ports/items",i,t),this}addPorts(e,t){return this.setPropByPath("ports/items",[...this.ports.items,...e],t),this}insertPort(e,t,i){const a=[...this.ports.items];return a.splice(e,0,t),this.setPropByPath("ports/items",a,i),this}removePort(e,t={}){return this.removePortAt(this.getPortIndex(e),t)}removePortAt(e,t={}){if(e>=0){const i=[...this.ports.items];i.splice(e,1),t.rewrite=!0,this.setPropByPath("ports/items",i,t)}return this}removePorts(e,t){let i;if(Array.isArray(e)){if(i=t||{},e.length){i.rewrite=!0;const d=[...this.ports.items].filter(f=>!e.some(m=>{const y=typeof m=="string"?m:m.id;return f.id===y}));this.setPropByPath("ports/items",d,i)}}else i=e||{},i.rewrite=!0,this.setPropByPath("ports/items",[],i);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(e,t){return this.port.getPortsLayoutByGroup(e,t)}initPorts(){this.updatePortData(),this.on("change:ports",()=>{this.processRemovedPort(),this.updatePortData()})}processRemovedPort(){const e=this.ports,t={};e.items.forEach(f=>{f.id&&(t[f.id]=!0)});const i={};(this.store.getPrevious("ports")||{items:[]}).items.forEach(f=>{f.id&&!t[f.id]&&(i[f.id]=!0)});const d=this.model;d&&!re(i)&&(d.getConnectedEdges(this,{incoming:!0}).forEach(y=>{const x=y.getTargetPortId();x&&i[x]&&y.remove()}),d.getConnectedEdges(this,{outgoing:!0}).forEach(y=>{const x=y.getSourcePortId();x&&i[x]&&y.remove()}))}validatePorts(){const e={},t=[];return this.ports.items.forEach(i=>{typeof i!="object"&&t.push(`Invalid port ${i}.`),i.id==null&&(i.id=this.generatePortId()),e[i.id]&&t.push("Duplicitied port id."),e[i.id]=!0}),t}generatePortId(){return og()}updatePortData(){const e=this.validatePorts();if(e.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(e.join(" "));const t=this.port?this.port.getPorts():null;this.port=new u0(this.ports);const i=this.port.getPorts(),a=t?i.filter(f=>t.find(m=>m.id===f.id)?null:f):[...i],d=t?t.filter(f=>i.find(m=>m.id===f.id)?null:f):[];a.length>0&&this.notify("ports:added",{added:a,cell:this,node:this}),d.length>0&&this.notify("ports:removed",{removed:d,cell:this,node:this})}}Si.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.isNode=="function"&&typeof a.isEdge=="function"&&typeof a.prop=="function"&&typeof a.attr=="function"&&typeof a.size=="function"&&typeof a.position=="function"}c.isNode=e}(Si||(Si={})),function(c){c.config({propHooks(e){var{ports:t}=e,i=Uc(e,["ports"]);return t&&(i.ports=Array.isArray(t)?{items:t}:t),i}})}(Si||(Si={})),function(c){c.registry=Oo.create({type:"node",process(e,t){if(xi.exist(e,!0))throw new Error(`Node with name '${e}' was registered by anthor Edge`);if(typeof t=="function")return t.config({shape:e}),t;let i=c;const{inherit:a}=t,d=Uc(t,["inherit"]);if(a)if(typeof a=="string"){const m=this.get(a);m==null?this.onNotFound(a,"inherited"):i=m}else i=a;d.constructorName==null&&(d.constructorName=e);const f=i.define.call(i,d);return f.config({shape:e}),f}}),xi.setNodeRegistry(c.registry)}(Si||(Si={})),function(c){let e=0;function t(d){return d?Ic(d):(e+=1,`CustomNode${e}`)}function i(d){const{constructorName:f,overwrite:m}=d,y=Uc(d,["constructorName","overwrite"]),x=Cc(t(f||y.shape),this);return x.config(y),y.shape&&c.registry.register(y.shape,x,m),x}c.define=i;function a(d){const f=d.shape||"rect",m=c.registry.get(f);return m?new m(d):c.registry.onNotFound(f)}c.create=a}(Si||(Si={}));var Fd=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class ws extends Si{get label(){return this.getLabel()}set label(e){this.setLabel(e)}getLabel(){return this.getAttrByPath("text/text")}setLabel(e,t){return e==null?this.removeLabel():this.setAttrByPath("text/text",e,t),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}(function(c){c.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},c.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},c.config({attrs:{text:Object.assign({},c.labelAttr)},propHooks(e){const{label:t}=e,i=Fd(e,["label"]);return t&&Os(i,"attrs/text/text",t),i},visible:!0})})(ws||(ws={}));var Vx=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};function jx(c,e=!1){return`<g class="rotatable"><g class="scalable"><${c}/></g>${e?"":"<text/>"}</g>`}function d0(c){return`basic.${c}`}function $h(c="xlink:href"){return t=>{const{imageUrl:i,imageWidth:a,imageHeight:d}=t,f=Vx(t,["imageUrl","imageWidth","imageHeight"]);if(i!=null||a!=null||d!=null){const m=()=>{if(f.attrs){const y=f.attrs.image;i!=null&&(y[c]=i),a!=null&&(y.width=a),d!=null&&(y.height=d),f.attrs.image=y}};f.attrs?(f.attrs.image==null&&(f.attrs.image={}),m()):(f.attrs={image:{}},m())}return f}}function nc(c,e,t={}){const i=d0(c),a={constructorName:i,attrs:{".":{fill:"#ffffff",stroke:"none"},[c]:{fill:"#ffffff",stroke:"#000000"}}};return t.ignoreMarkup||(a.markup=jx(c,t.noText===!0)),(t.parent||ws).define(Pi.Z(a,e,{shape:i}))}const h0=nc("rect",{attrs:{rect:{width:100,height:60}}}),OE=nc("circle",{width:60,height:60,attrs:{circle:{r:30,cx:30,cy:30}}}),Wh=nc("ellipse",{width:60,height:40,attrs:{ellipse:{rx:30,ry:20,cx:30,cy:20}}}),vn=nc("polygon",{width:60,height:40,attrs:{text:{refY:null,refDy:16}}}),DE=nc("polyline",{width:60,height:40,attrs:{text:{refY:null,refDy:16}}}),MA=nc("image",{attrs:{text:{refY:null,refDy:16}},propHooks:$h()});var _E=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const Hx=nc("path",{width:60,height:60,attrs:{text:{ref:"path",refY:null,refDy:16}},propHooks(c){const{d:e}=c,t=_E(c,["d"]);return e!=null&&Os(t,"attrs/path/d",e),t}}),PA=nc("rhombus",{d:"M 30 0 L 60 30 30 60 0 30 z",attrs:{text:{refY:.5,refDy:null}}},{parent:Hx,ignoreMarkup:!0}),OA=nc("cylinder",{width:40,height:40,attrs:{path:{fill:"#FFFFFF",stroke:"#cbd2d7",strokeWidth:3,d:["M 0 10 C 10 5, 30 5, 40 10 C 30 15, 10 15, 0 10","L 0 20","C 10 25, 30 25, 40 20","L 40 10"].join(" ")},text:{refY:.7,refDy:null,fill:"#435460"}}},{parent:Hx,ignoreMarkup:!0});var f0=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Qi extends Xr{constructor(e={}){super(e)}get[Symbol.toStringTag](){return Qi.toStringTag}preprocess(e,t){const{source:i,sourceCell:a,sourcePort:d,sourcePoint:f,target:m,targetCell:y,targetPort:x,targetPoint:E}=e,T=f0(e,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),R=V=>typeof V=="string"||typeof V=="number";if(i!=null)if(Xr.isCell(i))T.source={cell:i.id};else if(R(i))T.source={cell:i};else if(Oe.isPoint(i))T.source=i.toJSON();else if(Array.isArray(i))T.source={x:i[0],y:i[1]};else{const V=i.cell;Xr.isCell(V)?T.source=Object.assign(Object.assign({},i),{cell:V.id}):T.source=i}if(a!=null||d!=null){let V=T.source;if(a!=null){const j=R(a)?a:a.id;V?V.cell=j:V=T.source={cell:j}}d!=null&&V&&(V.port=d)}else f!=null&&(T.source=Oe.create(f).toJSON());if(m!=null)if(Xr.isCell(m))T.target={cell:m.id};else if(R(m))T.target={cell:m};else if(Oe.isPoint(m))T.target=m.toJSON();else if(Array.isArray(m))T.target={x:m[0],y:m[1]};else{const V=m.cell;Xr.isCell(V)?T.target=Object.assign(Object.assign({},m),{cell:V.id}):T.target=m}if(y!=null||x!=null){let V=T.target;if(y!=null){const j=R(y)?y:y.id;V?V.cell=j:V=T.target={cell:j}}x!=null&&V&&(V.port=x)}else E!=null&&(T.target=Oe.create(E).toJSON());return super.preprocess(T,t)}setup(){super.setup(),this.on("change:labels",e=>this.onLabelsChanged(e)),this.on("change:vertices",e=>this.onVertexsChanged(e))}isEdge(){return!0}disconnect(e={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},e),this}get source(){return this.getSource()}set source(e){this.setSource(e)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(e,t,i={}){return this.setTerminal("source",e,t,i)}get target(){return this.getTarget()}set target(e){this.setTarget(e)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(e,t,i={}){return this.setTerminal("target",e,t,i)}getTerminal(e){return Object.assign({},this.store.get(e))}setTerminal(e,t,i,a={}){if(Xr.isCell(t))return this.store.set(e,Pi.Z({},i,{cell:t.id}),a),this;const d=t;return Oe.isPoint(t)||d.x!=null&&d.y!=null?(this.store.set(e,Pi.Z({},i,{x:d.x,y:d.y}),a),this):(this.store.set(e,qi(t),a),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(e){const t=this[e];if(Oe.isPointLike(t))return Oe.create(t);const i=this.getTerminalCell(e);return i?i.getConnectionPoint(this,e):new Oe}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(e){if(this.model){const t=e==="source"?this.getSourceCellId():this.getTargetCellId();if(t)return this.model.getCell(t)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(e){let t=this;const i={};for(;t&&t.isEdge();){if(i[t.id])return null;i[t.id]=!0,t=t.getTerminalCell(e)}return t&&t.isNode()?t:null}get router(){return this.getRouter()}set router(e){e==null?this.removeRouter():this.setRouter(e)}getRouter(){return this.store.get("router")}setRouter(e,t,i){return typeof e=="object"?this.store.set("router",e,t):this.store.set("router",{name:e,args:t},i),this}removeRouter(e={}){return this.store.remove("router",e),this}get connector(){return this.getConnector()}set connector(e){e==null?this.removeConnector():this.setConnector(e)}getConnector(){return this.store.get("connector")}setConnector(e,t,i){return typeof e=="object"?this.store.set("connector",e,t):this.store.set("connector",{name:e,args:t},i),this}removeConnector(e={}){return this.store.remove("connector",e)}get strategy(){return this.getStrategy()}set strategy(e){e==null?this.removeStrategy():this.setStrategy(e)}getStrategy(){return this.store.get("strategy")}setStrategy(e,t,i){return typeof e=="object"?this.store.set("strategy",e,t):this.store.set("strategy",{name:e,args:t},i),this}removeStrategy(e={}){return this.store.remove("strategy",e)}getDefaultLabel(){const e=this.constructor,t=this.store.get("defaultLabel")||e.defaultLabel||{};return qi(t)}get labels(){return this.getLabels()}set labels(e){this.setLabels(e)}getLabels(){return[...this.store.get("labels",[])].map(e=>this.parseLabel(e))}setLabels(e,t={}){return this.store.set("labels",Array.isArray(e)?e:[e],t),this}insertLabel(e,t,i={}){const a=this.getLabels(),d=a.length;let f=t!=null&&Number.isFinite(t)?t:d;return f<0&&(f=d+f+1),a.splice(f,0,this.parseLabel(e)),this.setLabels(a,i)}appendLabel(e,t={}){return this.insertLabel(e,-1,t)}getLabelAt(e){const t=this.getLabels();return e!=null&&Number.isFinite(e)?this.parseLabel(t[e]):null}setLabelAt(e,t,i={}){if(e!=null&&Number.isFinite(e)){const a=this.getLabels();a[e]=this.parseLabel(t),this.setLabels(a,i)}return this}removeLabelAt(e,t={}){const i=this.getLabels(),a=e!=null&&Number.isFinite(e)?e:-1,d=i.splice(a,1);return this.setLabels(i,t),d.length?d[0]:null}parseLabel(e){return typeof e=="string"?this.constructor.parseStringLabel(e):e}onLabelsChanged({previous:e,current:t}){const i=e&&t?t.filter(d=>e.find(f=>d===f||ea(d,f))?null:d):t?[...t]:[],a=e&&t?e.filter(d=>t.find(f=>d===f||ea(d,f))?null:d):e?[...e]:[];i.length>0&&this.notify("labels:added",{added:i,cell:this,edge:this}),a.length>0&&this.notify("labels:removed",{removed:a,cell:this,edge:this})}get vertexMarkup(){return this.getVertexMarkup()}set vertexMarkup(e){this.setVertexMarkup(e)}getDefaultVertexMarkup(){return this.store.get("defaultVertexMarkup")||li.getEdgeVertexMarkup()}getVertexMarkup(){return this.store.get("vertexMarkup")||this.getDefaultVertexMarkup()}setVertexMarkup(e,t={}){return this.store.set("vertexMarkup",li.clone(e),t),this}get vertices(){return this.getVertices()}set vertices(e){this.setVertices(e)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(e,t={}){const i=Array.isArray(e)?e:[e];return this.store.set("vertices",i.map(a=>Oe.toJSON(a)),t),this}insertVertex(e,t,i={}){const a=this.getVertices(),d=a.length;let f=t!=null&&Number.isFinite(t)?t:d;return f<0&&(f=d+f+1),a.splice(f,0,Oe.toJSON(e)),this.setVertices(a,i)}appendVertex(e,t={}){return this.insertVertex(e,-1,t)}getVertexAt(e){return e!=null&&Number.isFinite(e)?this.getVertices()[e]:null}setVertexAt(e,t,i={}){if(e!=null&&Number.isFinite(e)){const a=this.getVertices();a[e]=t,this.setVertices(a,i)}return this}removeVertexAt(e,t={}){const i=this.getVertices(),a=e!=null&&Number.isFinite(e)?e:-1;return i.splice(a,1),this.setVertices(i,t)}onVertexsChanged({previous:e,current:t}){const i=e&&t?t.filter(d=>e.find(f=>Oe.equals(d,f))?null:d):t?[...t]:[],a=e&&t?e.filter(d=>t.find(f=>Oe.equals(d,f))?null:d):e?[...e]:[];i.length>0&&this.notify("vertexs:added",{added:i,cell:this,edge:this}),a.length>0&&this.notify("vertexs:removed",{removed:a,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||li.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}get toolMarkup(){return this.getToolMarkup()}set toolMarkup(e){this.setToolMarkup(e)}getDefaultToolMarkup(){return this.store.get("defaultToolMarkup")||li.getEdgeToolMarkup()}getToolMarkup(){return this.store.get("toolMarkup")||this.getDefaultToolMarkup()}setToolMarkup(e,t={}){return this.store.set("toolMarkup",e,t),this}get doubleToolMarkup(){return this.getDoubleToolMarkup()}set doubleToolMarkup(e){this.setDoubleToolMarkup(e)}getDefaultDoubleToolMarkup(){return this.store.get("defaultDoubleToolMarkup")}getDoubleToolMarkup(){return this.store.get("doubleToolMarkup")||this.getDefaultDoubleToolMarkup()}setDoubleToolMarkup(e,t={}){return this.store.set("doubleToolMarkup",e,t),this}get arrowheadMarkup(){return this.getArrowheadMarkup()}set arrowheadMarkup(e){this.setArrowheadMarkup(e)}getDefaultArrowheadMarkup(){return this.store.get("defaultArrowheadMarkup")||li.getEdgeArrowheadMarkup()}getArrowheadMarkup(){return this.store.get("arrowheadMarkup")||this.getDefaultArrowheadMarkup()}setArrowheadMarkup(e,t={}){return this.store.set("arrowheadMarkup",e,t),this}translate(e,t,i={}){return i.translateBy=i.translateBy||this.id,i.tx=e,i.ty=t,this.applyToPoints(a=>({x:(a.x||0)+e,y:(a.y||0)+t}),i)}scale(e,t,i,a={}){return this.applyToPoints(d=>Oe.create(d).scale(e,t,i).toJSON(),a)}applyToPoints(e,t={}){const i={},a=this.getSource(),d=this.getTarget();Oe.isPointLike(a)&&(i.source=e(a)),Oe.isPointLike(d)&&(i.target=e(d));const f=this.getVertices();return f.length>0&&(i.vertices=f.map(e)),this.store.set(i,t),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const e=[this.getSourcePoint(),...this.getVertices().map(t=>Oe.create(t)),this.getTargetPoint()];return new Zo(e)}updateParent(e){let t=null;const i=this.getSourceCell(),a=this.getTargetCell(),d=this.getParent();return i&&a&&(i===a||i.isDescendantOf(a)?t=a:a.isDescendantOf(i)?t=i:t=Xr.getCommonAncestor(i,a)),d&&(!t||t.id!==d.id)&&d.unembed(this,e),t&&t.embed(this,e),t}hasLoop(e={}){const t=this.getSource(),i=this.getTarget(),a=t.cell,d=i.cell;if(!a||!d)return!1;let f=a===d;if(!f&&e.deep&&this._model){const m=this.getSourceCell(),y=this.getTargetCell();m&&y&&(f=m.isAncestorOf(y,e)||y.isAncestorOf(m,e))}return f}getFragmentAncestor(){const e=[this,this.getSourceNode(),this.getTargetNode()].filter(t=>t!=null);return this.getCommonAncestor(...e)}isFragmentDescendantOf(e){const t=this.getFragmentAncestor();return!!t&&(t.id===e.id||t.isDescendantOf(e))}}Qi.defaults={},function(c){function e(t,i){const a=t,d=i;return a.cell===d.cell?a.port===d.port||a.port==null&&d.port==null:!1}c.equalTerminals=e}(Qi||(Qi={})),function(c){c.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}};function e(t){return{attrs:{label:{text:t}}}}c.parseStringLabel=e}(Qi||(Qi={})),function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.isNode=="function"&&typeof a.isEdge=="function"&&typeof a.prop=="function"&&typeof a.attr=="function"&&typeof a.disconnect=="function"&&typeof a.getSource=="function"&&typeof a.getTarget=="function"}c.isEdge=e}(Qi||(Qi={})),function(c){c.registry=Oo.create({type:"edge",process(e,t){if(xi.exist(e,!1))throw new Error(`Edge with name '${e}' was registered by anthor Node`);if(typeof t=="function")return t.config({shape:e}),t;let i=c;const{inherit:a="edge"}=t,d=f0(t,["inherit"]);if(typeof a=="string"){const m=this.get(a||"edge");m==null&&a?this.onNotFound(a,"inherited"):i=m}else i=a;d.constructorName==null&&(d.constructorName=e);const f=i.define.call(i,d);return f.config({shape:e}),f}}),xi.setEdgeRegistry(c.registry)}(Qi||(Qi={})),function(c){let e=0;function t(d){return d?Ic(d):(e+=1,`CustomEdge${e}`)}function i(d){const{constructorName:f,overwrite:m}=d,y=f0(d,["constructorName","overwrite"]),x=Cc(t(f||y.shape),this);return x.config(y),y.shape&&c.registry.register(y.shape,x,m),x}c.define=i;function a(d){const f=d.shape||"edge",m=c.registry.get(f);return m?new m(d):c.registry.onNotFound(f)}c.create=a}(Qi||(Qi={})),function(c){const e="basic.edge";c.config({shape:e,propHooks(t){const{label:i,vertices:a}=t,d=f0(t,["label","vertices"]);if(i){d.labels==null&&(d.labels=[]);const f=typeof i=="string"?c.parseStringLabel(i):i;d.labels.push(f)}return a&&Array.isArray(a)&&(d.vertices=a.map(f=>Oe.create(f).toJSON())),d}}),c.registry.register(e,c)}(Qi||(Qi={}));var NE=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class _u extends xo{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.markerCache={}}get[Symbol.toStringTag](){return _u.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const e=this.sourceView;if(!e){const i=this.cell.getSource();return new gn(i.x,i.y)}const t=this.sourceMagnet;return e.isEdgeElement(t)?new gn(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(t||e.container)}get targetBBox(){const e=this.targetView;if(!e){const i=this.cell.getTarget();return new gn(i.x,i.y)}const t=this.targetMagnet;return e.isEdgeElement(t)?new gn(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(t||e.container)}isEdgeView(){return!0}confirmUpdate(e,t={}){let i=e;if(this.hasAction(i,"source")){if(!this.updateTerminalProperties("source"))return i;i=this.removeAction(i,"source")}if(this.hasAction(i,"target")){if(!this.updateTerminalProperties("target"))return i;i=this.removeAction(i,"target")}const a=this.graph,d=this.sourceView,f=this.targetView;return a&&(d&&!a.renderer.isViewMounted(d)||f&&!a.renderer.isViewMounted(f))?i:this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","vertices","labels","tools","widget"]),i):(i=this.handleAction(i,"vertices",()=>this.renderVertexMarkers()),i=this.handleAction(i,"update",()=>this.update(null,t)),i=this.handleAction(i,"labels",()=>this.onLabelsChange(t)),i=this.handleAction(i,"tools",()=>{this.renderTools(),this.updateToolsPosition()}),i=this.handleAction(i,"widget",()=>this.renderExternalTools()),i)}onLabelsChange(e={}){this.shouldRerenderLabels(e)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(e={}){const t=this.cell.previous("labels");if(t==null)return!0;if("propertyPathArray"in e&&"propertyValue"in e){const i=e.propertyPathArray||[],a=i.length;if(a>1){const d=i[1];if(t[d]){if(a===2)return typeof e.propertyValue=="object"&&_l(e.propertyValue,"markup");if(i[2]!=="markup")return!1}}}return!0}render(){return this.empty(),this.containers={},this.renderMarkup(),this.renderLabels(),this.update(),this.renderExternalTools(),this}renderMarkup(){const e=this.cell.markup;if(e)return typeof e=="string"?this.renderStringMarkup(e):this.renderJSONMarkup(e);throw new TypeError("Invalid edge markup.")}renderJSONMarkup(e){const t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.append(t.fragment)}renderStringMarkup(e){const t=this.containers,i=In.createVectors(e);i.forEach(a=>{const d=a.attr("class");d&&(t[as(d)]=a.node)}),this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),Yf(this.container,i.map(a=>a.node))}renderLabels(){const e=this.cell,t=e.getLabels(),i=t.length;let a=this.containers.labels;if(this.labelCache={},this.labelSelectors={},i<=0)return a&&a.parentNode&&a.parentNode.removeChild(a),this;a?this.empty(a):(a=ma("g"),this.addClass(this.prefixClassName("edge-labels"),a),this.containers.labels=a);for(let d=0,f=t.length;d<f;d+=1){const m=t[d],y=this.normalizeLabelMarkup(this.parseLabelMarkup(m.markup));let x,E;if(y)x=y.node,E=y.selectors;else{const T=e.getDefaultLabel(),R=this.normalizeLabelMarkup(this.parseLabelMarkup(T.markup));x=R.node,E=R.selectors}x.setAttribute("data-index",`${d}`),a.appendChild(x);const S=this.rootSelector;if(E[S])throw new Error("Ambiguous label root selector.");E[S]=x,this.labelCache[d]=x,this.labelSelectors[d]=E}return a.parentNode==null&&this.container.appendChild(a),this.updateLabels(),this.customizeLabels(),this}parseLabelMarkup(e){return e?typeof e=="string"?this.parseLabelStringMarkup(e):this.parseJSONMarkup(e):null}parseLabelStringMarkup(e){const t=In.createVectors(e),i=document.createDocumentFragment();for(let a=0,d=t.length;a<d;a+=1){const f=t[a].node;i.appendChild(f)}return{fragment:i,selectors:{}}}normalizeLabelMarkup(e){if(e==null)return;const t=e.fragment;if(!(t instanceof DocumentFragment)||!t.hasChildNodes())throw new Error("Invalid label markup.");let i;const a=t.childNodes;return a.length>1||a[0].nodeName.toUpperCase()!=="G"?i=In.create("g").append(t):i=In.create(a[0]),i.addClass(this.prefixClassName("edge-label")),{node:i.node,selectors:e.selectors}}updateLabels(){if(this.containers.labels){const e=this.cell,t=e.labels,i=this.can("edgeLabelMovable"),a=e.getDefaultLabel();for(let d=0,f=t.length;d<f;d+=1){const m=this.labelCache[d],y=this.labelSelectors[d];m.setAttribute("cursor",i?"move":"default");const x=t[d],E=Pi.Z({},a.attrs,x.attrs);this.updateAttrs(m,E,{selectors:y,rootBBox:x.size?gn.fromSize(x.size):void 0})}}}mergeLabelAttrs(e,t,i){if(t===null)return null;if(t===void 0)return i===null?null:i===void 0?void 0:e?i:Pi.Z({},i);if(e)return Pi.Z({},i,t)}customizeLabels(){if(this.containers.labels){const e=this.cell,t=e.labels;for(let i=0,a=t.length;i<a;i+=1){const d=t[i],f=this.labelCache[i],m=this.labelSelectors[i];this.graph.hook.onEdgeLabelRendered({edge:e,label:d,container:f,selectors:m})}}}renderTools(){const e=this.containers.tools;if(e==null)return this;const t=this.cell.toolMarkup,i=this.$(e).empty();if(li.isStringMarkup(t)){let a=Tt(t);const d=In.create(a());if(i.append(d.node),this.toolCache=d.node,this.options.doubleTools){let f;const m=this.cell.doubleToolMarkup;li.isStringMarkup(m)?(a=Tt(m),f=In.create(a())):f=d.clone(),i.append(f.node),this.tool2Cache=f.node}}return this}renderExternalTools(){const e=this.cell.getTools();return this.addTools(e),this}renderVertexMarkers(){const e=this.containers.vertices;if(e==null)return this;const t=this.cell.vertexMarkup,i=this.$(e).empty();if(li.isStringMarkup(t)){const a=Tt(t);this.cell.getVertices().forEach((d,f)=>{i.append(In.create(a(Object.assign({index:f},d))).node)})}return this}renderArrowheadMarkers(){const e=this.containers.arrowheads;if(e==null)return this;const t=this.cell.arrowheadMarkup,i=this.$(e).empty();if(li.isStringMarkup(t)){const a=Tt(t),d=In.create(a({end:"source"})).node,f=In.create(a({end:"target"})).node;this.containers.sourceArrowhead=d,this.containers.targetArrowhead=f,i.append(d,f)}return this}update(e,t={}){this.cleanCache(),this.updateConnection(t);const i=this.cell.getAttrs();return i!=null&&this.updateAttrs(this.container,i,{attrs:e===i?null:e,selectors:this.selectors}),this.updateConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),this.updateTools(t),this}removeRedundantLinearVertices(e={}){const t=this.cell,i=t.getVertices(),a=[this.sourceAnchor,...i,this.targetAnchor],d=a.length,f=new Zo(a);f.simplify({threshold:.01});const m=f.points.map(x=>x.toJSON()),y=m.length;return d===y?0:(t.setVertices(m.slice(1,y-1),e),d-y)}updateConnectionPath(){const e=this.containers;if(e.connection){const t=this.getConnectionPathData();e.connection.setAttribute("d",t)}if(e.connectionWrap){const t=this.getConnectionPathData();e.connectionWrap.setAttribute("d",t)}e.sourceMarker&&e.targetMarker&&this.translateAndAutoOrientArrows(e.sourceMarker,e.targetMarker)}getTerminalView(e){switch(e){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalAnchor(e){switch(e){case"source":return Oe.create(this.sourceAnchor);case"target":return Oe.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalConnectionPoint(e){switch(e){case"source":return Oe.create(this.sourcePoint);case"target":return Oe.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalMagnet(e,t={}){switch(e){case"source":{if(t.raw)return this.sourceMagnet;const i=this.sourceView;return i?this.sourceMagnet||i.container:null}case"target":{if(t.raw)return this.targetMagnet;const i=this.targetView;return i?this.targetMagnet||i.container:null}default:throw new Error(`Unknown terminal type '${e}'`)}}updateConnection(e={}){const t=this.cell;if(e.translateBy&&t.isFragmentDescendantOf(e.translateBy)){const i=e.tx||0,a=e.ty||0;this.routePoints=new Zo(this.routePoints).translate(i,a).points,this.translateConnectionPoints(i,a),this.path.translate(i,a)}else{const i=t.getVertices(),a=this.findAnchors(i);this.sourceAnchor=a.source,this.targetAnchor=a.target,this.routePoints=this.findRoutePoints(i);const d=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=d.source,this.targetPoint=d.target;const f=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,f.source||this.sourcePoint,f.target||this.targetPoint)}this.cleanCache()}findAnchors(e){const t=this.cell,i=t.source,a=t.target,d=e[0],f=e[e.length-1];return a.priority&&!i.priority?this.findAnchorsOrdered("target",f,"source",d):this.findAnchorsOrdered("source",d,"target",f)}findAnchorsOrdered(e,t,i,a){let d,f;const m=this.cell,y=m[e],x=m[i],E=this.getTerminalView(e),S=this.getTerminalView(i),T=this.getTerminalMagnet(e),R=this.getTerminalMagnet(i);if(E){let V;t?V=Oe.create(t):S?V=R:V=Oe.create(x),d=this.getAnchor(y.anchor,E,T,V,e)}else d=Oe.create(y);if(S){const V=Oe.create(a||d);f=this.getAnchor(x.anchor,S,R,V,i)}else f=Oe.isPointLike(x)?Oe.create(x):new Oe;return{[e]:d,[i]:f}}getAnchor(e,t,i,a,d){const f=t.isEdgeElement(i),m=this.graph.options.connecting;let y=typeof e=="string"?{name:e}:e;if(!y){const S=f?(d==="source"?m.sourceEdgeAnchor:m.targetEdgeAnchor)||m.edgeAnchor:(d==="source"?m.sourceAnchor:m.targetAnchor)||m.anchor;y=typeof S=="string"?{name:S}:S}if(!y)throw new Error("Anchor should be specified.");let x;const E=y.name;if(f){const S=Bh.registry.get(E);if(typeof S!="function")return Bh.registry.onNotFound(E);x=Pn(S,this,t,i,a,y.args||{},d)}else{const S=ap.registry.get(E);if(typeof S!="function")return ap.registry.onNotFound(E);x=Pn(S,this,t,i,a,y.args||{},d)}return x?x.round(this.POINT_ROUNDING):new Oe}findRoutePoints(e=[]){const t=this.graph.options.connecting.router||Id.presets.normal,i=this.cell.getRouter()||t;let a;if(typeof i=="function")a=Pn(i,this,e,{},this);else{const d=typeof i=="string"?i:i.name,f=typeof i=="string"?{}:i.args||{},m=d?Id.registry.get(d):Id.presets.normal;if(typeof m!="function")return Id.registry.onNotFound(d);a=Pn(m,this,e,f,this)}return a==null?e.map(d=>Oe.create(d)):a.map(d=>Oe.create(d))}findConnectionPoints(e,t,i){const a=this.cell,d=this.graph.options.connecting,f=a.getSource(),m=a.getTarget(),y=this.sourceView,x=this.targetView,E=e[0],S=e[e.length-1];let T;if(y&&!y.isEdgeElement(this.sourceMagnet)){const V=this.sourceMagnet||y.container,j=E||i,q=new zn(j,t),ue=f.connectionPoint||d.sourceConnectionPoint||d.connectionPoint;T=this.getConnectionPoint(ue,y,V,q,"source")}else T=t;let R;if(x&&!x.isEdgeElement(this.targetMagnet)){const V=this.targetMagnet||x.container,j=m.connectionPoint||d.targetConnectionPoint||d.connectionPoint,q=S||t,ue=new zn(q,i);R=this.getConnectionPoint(j,x,V,ue,"target")}else R=i;return{source:T,target:R}}getConnectionPoint(e,t,i,a,d){const f=a.end;if(e==null)return f;const m=typeof e=="string"?e:e.name,y=typeof e=="string"?{}:e.args,x=zh.registry.get(m);if(typeof x!="function")return zh.registry.onNotFound(m);const E=Pn(x,this,a,t,i,y||{},d);return E?E.round(this.POINT_ROUNDING):f}updateMarkerAttr(e){const t=this.cell.getAttrs(),i=`.${e}-marker`,a=t&&t[i];a&&this.updateAttrs(this.container,{},{attrs:{[i]:a},selectors:this.selectors})}findMarkerPoints(e,t,i){const a=T=>{const R=this.cell.getAttrs(),V=Object.keys(R);for(let j=0,q=V.length;j<q;j+=1){const ue=R[V[j]];if(ue[`${T}Marker`]||ue[`${T}-marker`]){const be=ue.strokeWidth||ue["stroke-width"];if(be)return parseFloat(be);break}}return null},d=e[0],f=e[e.length-1],m=this.containers.sourceMarker,y=this.containers.targetMarker,x=this.markerCache;let E,S;if(m){if(this.updateMarkerAttr("source"),x.sourceBBox=x.sourceBBox||Pr(m),x.sourceBBox.width>0){const T=ht(m);E=t.clone().move(d||i,x.sourceBBox.width*T.sx*-1)}}else{const T=a("source");T&&(E=t.clone().move(d||i,-T))}if(y){if(this.updateMarkerAttr("target"),x.targetBBox=x.targetBBox||Pr(y),x.targetBBox.width>0){const T=ht(y);S=i.clone().move(f||t,x.targetBBox.width*T.sx*-1)}}else{const T=a("target");T&&(S=i.clone().move(f||t,-T))}return x.sourcePoint=E||t.clone(),x.targetPoint=S||i.clone(),{source:E,target:S}}findPath(e,t,i){const a=this.cell.getConnector()||this.graph.options.connecting.connector;let d,f,m;if(typeof a=="string"?d=a:(d=a.name,f=a.args),d){const x=Du.registry.get(d);if(typeof x!="function")return Du.registry.onNotFound(d);m=x}else m=Du.presets.normal;const y=Pn(m,this,t,i,e,Object.assign(Object.assign({},f),{raw:!0}),this);return typeof y=="string"?sr.parse(y):y}translateConnectionPoints(e,t){const i=this.markerCache;i.sourcePoint&&i.sourcePoint.translate(e,t),i.targetPoint&&i.targetPoint.translate(e,t),this.sourcePoint.translate(e,t),this.targetPoint.translate(e,t),this.sourceAnchor.translate(e,t),this.targetAnchor.translate(e,t)}updateLabelPositions(){if(this.containers.labels==null)return this;if(!this.path)return this;const t=this.cell,i=t.getLabels();if(i.length===0)return this;const a=t.getDefaultLabel(),d=this.normalizeLabelPosition(a.position);for(let f=0,m=i.length;f<m;f+=1){const y=i[f],x=this.normalizeLabelPosition(y.position),E=Pi.Z({},d,x),S=this.getLabelTransformationMatrix(E);this.labelCache[f].setAttribute("transform",Zr(S))}return this}updateToolsPosition(){if(this.containers.tools==null)return this;let e="",t=this.options.toolsOffset;const i=this.getConnectionLength();if(i!=null){i<this.options.shortLength&&(e="scale(.5)",t/=2);let a=this.getPointAtLength(t);if(a!=null&&yi(this.toolCache,"transform",`translate(${a.x},${a.y}) ${e}`),this.options.doubleTools&&i>=this.options.longLength){const d=this.options.doubleToolsOffset||t;a=this.getPointAtLength(i-d),a!=null&&yi(this.tool2Cache,"transform",`translate(${a.x},${a.y}) ${e}`),yi(this.tool2Cache,"visibility","visible")}else this.options.doubleTools&&yi(this.tool2Cache,"visibility","hidden")}return this}updateArrowheadMarkers(){const e=this.containers.arrowheads;if(e==null)return this;if(e.style.display==="none")return this;const t=this.containers.sourceArrowhead,i=this.containers.targetArrowhead;if(t&&i){const d=(this.getConnectionLength()||0)<this.options.shortLength?.5:1;ht(t,d),ht(i,d),this.translateAndAutoOrientArrows(t,i)}return this}updateTerminalProperties(e){const t=this.cell,i=this.graph,a=t[e],d=a&&a.cell,f=`${e}View`;if(!d)return this[f]=null,this.updateTerminalMagnet(e),!0;const m=i.getCellById(d);if(!m)throw new Error(`Edge's ${e} node with id "${d}" not exists`);const y=m.findView(i);return y?(this[f]=y,this.updateTerminalMagnet(e),!0):!1}updateTerminalMagnet(e){const t=`${e}Magnet`,i=this.getTerminalView(e);if(i){let a=i.getMagnetFromEdgeTerminal(this.cell[e]);a===i.container&&(a=null),this[t]=a}else this[t]=null}translateAndAutoOrientArrows(e,t){const i=this.routePoints;e&&vo(e,this.sourcePoint,i[0]||this.targetPoint,this.graph.view.stage),t&&vo(t,this.targetPoint,i[i.length-1]||this.sourcePoint,this.graph.view.stage)}getLabelPositionAngle(e){const t=this.cell.getLabelAt(e);return t&&t.position&&typeof t.position=="object"&&t.position.angle||0}getLabelPositionArgs(e){const t=this.cell.getLabelAt(e);if(t&&t.position&&typeof t.position=="object")return t.position.options}getDefaultLabelPositionArgs(){const e=this.cell.getDefaultLabel();if(e&&e.position&&typeof e.position=="object")return e.position.options}mergeLabelPositionArgs(e,t){return e===null?null:e===void 0?t===null?null:t:Pi.Z({},t,e)}addLabel(e,t,i,a){let d,f,m=0,y;typeof e!="number"?(d=e.x,f=e.y,typeof t=="number"?(m=t,y=i):y=t):(d=e,f=t,typeof i=="number"?(m=i,y=a):y=i);const x=this.getDefaultLabelPositionArgs(),E=y,S=this.mergeLabelPositionArgs(E,x),T={position:this.getLabelPosition(d,f,m,S)},R=-1;return this.cell.insertLabel(T,R,y),R}addVertex(e,t,i){const a=typeof e!="number",d=a?e.x:e,f=a?e.y:t,m=a?t:i,y={x:d,y:f},x=this.getVertexIndex(d,f);return this.cell.insertVertex(y,x,m),x}sendToken(e,t,i){let a,d,f,m,y="linear";typeof t=="object"?(a=t.duration,d=t.reversed===!0,f=t.selector,t.rotate===!1?m="":t.rotate===!0?m="auto":t.rotate!=null&&(m=`${t.rotate}`),t.timing&&(y=t.timing)):(a=t,d=!1,f=null),a=a||1e3;const x={dur:`${a}ms`,repeatCount:"1",calcMode:y,fill:"freeze"};if(m&&(x.rotate=m),d&&(x.keyPoints="1;0",x.keyTimes="0;1"),typeof t=="object"){const{duration:ue,reversed:be,selector:se,rotate:Pe,timing:He}=t,ft=NE(t,["duration","reversed","selector","rotate","timing"]);Object.keys(ft).forEach(pt=>{x[pt]=ft[pt]})}let E;if(typeof f=="string"?E=this.findOne(f,this.container,this.selectors):E=this.containers.connection?this.containers.connection:this.container.querySelector("path"),!(E instanceof SVGPathElement))throw new Error("Token animation requires a valid connection path.");const S=typeof e=="string"?this.findOne(e):e;if(S==null)throw new Error("Token animation requires a valid token element.");const T=S.parentNode,R=()=>{T||Jl(S)},V=In.create(S);T||V.appendTo(this.graph.view.stage);const j=x.complete;x.complete=ue=>{R(),i&&i(),j&&j(ue)};const q=V.animateAlongPath(x,E);return()=>{R(),q()}}getConnection(){return this.path!=null?this.path.clone():null}getConnectionPathData(){if(this.path==null)return"";const e=this.cache.pathCache;return _l(e,"data")||(e.data=this.path.serialize()),e.data||""}getConnectionSubdivisions(){if(this.path==null)return null;const e=this.cache.pathCache;return _l(e,"segmentSubdivisions")||(e.segmentSubdivisions=this.path.getSegmentSubdivisions()),e.segmentSubdivisions}getConnectionLength(){if(this.path==null)return 0;const e=this.cache.pathCache;return _l(e,"length")||(e.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),e.length}getPointAtLength(e){return this.path==null?null:this.path.pointAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(e){return this.path==null?null:(pl(e)&&(e=parseFloat(e)/100),this.path.pointAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(e){return this.path==null?null:this.path.tangentAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(e){return this.path==null?null:this.path.tangentAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(e){return this.path==null?null:this.path.closestPoint(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(e){return this.path==null?null:this.path.closestPointLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(e){return this.path==null?null:this.path.closestPointNormalizedLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(e,t,i,a){const d={distance:0};let f=0,m;typeof i=="number"?(f=i,m=a):m=i,m!=null&&(d.options=m);const y=m&&m.absoluteOffset,x=!(m&&m.absoluteDistance),E=m&&m.absoluteDistance&&m.reverseDistance,S=this.path,T={segmentSubdivisions:this.getConnectionSubdivisions()},R=new Oe(e,t),V=S.closestPointT(R,T),j=this.getConnectionLength()||0;let q=S.lengthAtT(V,T);x&&(q=j>0?q/j:0),E&&(q=-1*(j-q)||1),d.distance=q;let ue;y||(ue=S.tangentAtT(V));let be;if(ue)be=ue.pointOffset(R);else{const se=S.pointAtT(V),Pe=R.diff(se);be={x:Pe.x,y:Pe.y}}return d.offset=be,d.angle=f,d}normalizeLabelPosition(e){return typeof e=="number"?{distance:e}:e}getLabelTransformationMatrix(e){const t=this.normalizeLabelPosition(e),i=t.options||{},a=t.angle||0,d=t.distance,f=d>0&&d<=1;let m=0;const y={x:0,y:0},x=t.offset;x&&(typeof x=="number"?m=x:(x.x!=null&&(y.x=x.x),x.y!=null&&(y.y=x.y)));const E=y.x!==0||y.y!==0||m===0,S=i.keepGradient,T=i.ensureLegibility,R=this.path,V={segmentSubdivisions:this.getConnectionSubdivisions()},j=f?d*this.getConnectionLength():d,q=R.tangentAtLength(j,V);let ue,be=a;if(q){if(E)ue=q.start,ue.translate(y);else{const se=q.clone();se.rotate(-90,q.start),se.setLength(m),ue=se.end}S&&(be=q.angle()+a,T&&(be=ri.normalize((be+90)%180-90)))}else ue=R.start,E&&ue.translate(y);return On().translate(ue.x,ue.y).rotate(be)}getLabelCoordinates(e){const t=this.getLabelTransformationMatrix(e);return new Oe(t.e,t.f)}getVertexIndex(e,t){const a=this.cell.getVertices(),d=this.getClosestPointLength(new Oe(e,t));let f=0;if(d!=null)for(const m=a.length;f<m;f+=1){const y=a[f],x=this.getClosestPointLength(y);if(x!=null&&d<x)break}return f}getEventArgs(e,t,i){const a=this,d=a.cell,f=d;return t==null||i==null?{e,view:a,edge:d,cell:f}:{e,x:t,y:i,view:a,edge:d,cell:f}}notifyUnhandledMouseDown(e,t,i){this.notify("edge:unhandled:mousedown",{e,x:t,y:i,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(e,t,i){super.onMouseDown(e,t,i),this.notify("edge:mousedown",this.getEventArgs(e,t,i))}notifyMouseMove(e,t,i){super.onMouseMove(e,t,i),this.notify("edge:mousemove",this.getEventArgs(e,t,i))}notifyMouseUp(e,t,i){super.onMouseUp(e,t,i),this.notify("edge:mouseup",this.getEventArgs(e,t,i))}onClick(e,t,i){super.onClick(e,t,i),this.notify("edge:click",this.getEventArgs(e,t,i))}onDblClick(e,t,i){super.onDblClick(e,t,i),this.notify("edge:dblclick",this.getEventArgs(e,t,i))}onContextMenu(e,t,i){super.onContextMenu(e,t,i),this.notify("edge:contextmenu",this.getEventArgs(e,t,i))}onMouseDown(e,t,i){switch(this.notifyMouseDown(e,t,i),e.target.getAttribute("class")){case"vertex":{this.startVertexDragging(e,t,i);return}case"vertex-remove":case"vertex-remove-area":{this.handleVertexRemoving(e,t,i);return}case"connection":case"connection-wrap":{this.handleVertexAdding(e,t,i);return}case"arrowhead":{this.startArrowheadDragging(e,t,i);return}case"source-marker":case"target-marker":{this.notifyUnhandledMouseDown(e,t,i);return}default:break}this.startEdgeDragging(e,t,i)}onMouseMove(e,t,i){const a=this.getEventData(e);switch(a.action){case"drag-vertex":{this.dragVertex(e,t,i);break}case"drag-label":{this.dragLabel(e,t,i);break}case"drag-arrowhead":{this.dragArrowhead(e,t,i);break}case"drag-edge":{this.dragEdge(e,t,i);break}default:break}return this.notifyMouseMove(e,t,i),a}onMouseUp(e,t,i){const a=this.getEventData(e);switch(a.action){case"drag-vertex":{this.stopVertexDragging(e,t,i);break}case"drag-label":{this.stopLabelDragging(e,t,i);break}case"drag-arrowhead":{this.stopArrowheadDragging(e,t,i);break}case"drag-edge":{this.stopEdgeDragging(e,t,i);break}default:break}return this.notifyMouseUp(e,t,i),this.checkMouseleave(e),a}onMouseOver(e){super.onMouseOver(e),this.notify("edge:mouseover",this.getEventArgs(e))}onMouseOut(e){super.onMouseOut(e),this.notify("edge:mouseout",this.getEventArgs(e))}onMouseEnter(e){super.onMouseEnter(e),this.notify("edge:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("edge:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,i,a){super.onMouseWheel(e,t,i,a),this.notify("edge:mousewheel",Object.assign({delta:a},this.getEventArgs(e,t,i)))}onCustomEvent(e,t,i,a){if(Lb(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if(t==="edge:remove"){this.cell.remove({ui:!0});return}this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,i,a)))}this.notifyMouseDown(e,i,a)}else this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,i,a))),super.onCustomEvent(e,t,i,a)}onLabelMouseDown(e,t,i){this.notifyMouseDown(e,t,i),this.startLabelDragging(e,t,i),this.getEventData(e).stopPropagation&&e.stopPropagation()}startEdgeDragging(e,t,i){if(!this.can("edgeMovable")){this.notifyUnhandledMouseDown(e,t,i);return}this.setEventData(e,{x:t,y:i,moving:!1,action:"drag-edge"})}dragEdge(e,t,i){const a=this.getEventData(e);a.moving||(a.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e,x:t,y:i,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(t-a.x,i-a.y,{ui:!0}),this.setEventData(e,{x:t,y:i}),this.notify("edge:moving",{e,x:t,y:i,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(e,t,i){const a=this.getEventData(e);a.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e,x:t,y:i,view:this,cell:this.cell,edge:this.cell})),a.moving=!1}prepareArrowheadDragging(e,t){const i=this.getTerminalMagnet(e),a={action:"drag-arrowhead",x:t.x,y:t.y,isNewEdge:t.isNewEdge===!0,terminalType:e,initialMagnet:i,initialTerminal:au(this.cell[e]),fallbackAction:t.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(e),options:t.options};return this.beforeArrowheadDragging(a),a}createValidateConnectionArgs(e){const t=[];t[4]=e,t[5]=this;let i,a=0,d=0;e==="source"?(a=2,i="target"):(d=2,i="source");const f=this.cell[i],m=f.cell;if(m){let y;const x=t[a]=this.graph.renderer.findViewByCell(m);x&&(y=x.getMagnetFromEdgeTerminal(f),y===x.container&&(y=void 0)),t[a+1]=y}return(y,x)=>(t[d]=y,t[d+1]=y.container===x?void 0:x,t)}beforeArrowheadDragging(e){e.zIndex=this.cell.zIndex,this.cell.toFront();const t=this.container.style;e.pointerEvents=t.pointerEvents,t.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(e)}afterArrowheadDragging(e){e.zIndex!=null&&(this.cell.setZIndex(e.zIndex,{ui:!0}),e.zIndex=null);const t=this.container;t.style.pointerEvents=e.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(e)}arrowheadDragging(e,t,i,a){a.x=t,a.y=i,a.currentTarget!==e&&(a.currentMagnet&&a.currentView&&a.currentView.unhighlight(a.currentMagnet,{type:"magnetAdsorbed"}),a.currentView=this.graph.renderer.findViewByElem(e),a.currentView?(a.currentMagnet=a.currentView.findMagnet(e),a.currentMagnet&&this.graph.hook.validateConnection(...a.getValidateConnectionArgs(a.currentView,a.currentMagnet),a.currentView.getEdgeTerminal(a.currentMagnet,t,i,this.cell,a.terminalType))?a.currentView.highlight(a.currentMagnet,{type:"magnetAdsorbed"}):a.currentMagnet=null):a.currentMagnet=null),a.currentTarget=e,this.cell.prop(a.terminalType,{x:t,y:i},Object.assign(Object.assign({},a.options),{ui:!0}))}arrowheadDragged(e,t,i){const a=e.currentView,d=e.currentMagnet;if(!d||!a)return;a.unhighlight(d,{type:"magnetAdsorbed"});const f=e.terminalType,m=a.getEdgeTerminal(d,t,i,this.cell,f);this.cell.setTerminal(f,m,{ui:!0})}snapArrowhead(e,t,i){const a=this.graph,{snap:d,allowEdge:f}=a.options.connecting,m=typeof d=="object"&&d.radius||50,y={x:e-m,y:t-m,width:2*m,height:2*m},x=a.renderer.findViewsInArea(y);if(f){const Pe=a.renderer.findEdgeViewsInArea(y).filter(He=>He!==this);x.push(...Pe)}const E=i.closestView||null,S=i.closestMagnet||null;i.closestView=null,i.closestMagnet=null;let T,R=Number.MAX_SAFE_INTEGER;const V=new Oe(e,t);x.forEach(Pe=>{Pe.container.getAttribute("magnet")!=="false"&&(T=Pe.cell.getBBox().getCenter().distance(V),T<m&&T<R&&(S===Pe.container||a.hook.validateConnection(...i.getValidateConnectionArgs(Pe,null),Pe.getEdgeTerminal(Pe.container,e,t,this.cell,i.terminalType)))&&(R=T,i.closestView=Pe,i.closestMagnet=Pe.container)),Pe.container.querySelectorAll("[magnet]").forEach(He=>{if(He.getAttribute("magnet")!=="false"){const ft=Pe.getBBoxOfElement(He);T=V.distance(ft.getCenter()),T<m&&T<R&&(S===He||a.hook.validateConnection(...i.getValidateConnectionArgs(Pe,He),Pe.getEdgeTerminal(He,e,t,this.cell,i.terminalType)))&&(R=T,i.closestView=Pe,i.closestMagnet=He)}})});let j;const q=i.terminalType,ue=i.closestView,be=i.closestMagnet,se=S!==be;if(E&&se&&E.unhighlight(S,{type:"magnetAdsorbed"}),ue){if(!se)return;ue.highlight(be,{type:"magnetAdsorbed"}),j=ue.getEdgeTerminal(be,e,t,this.cell,q)}else j={x:e,y:t};this.cell.setTerminal(q,j,{},Object.assign(Object.assign({},i.options),{ui:!0}))}snapArrowheadEnd(e){const t=e.closestView,i=e.closestMagnet;t&&i&&(t.unhighlight(i,{type:"magnetAdsorbed"}),e.currentMagnet=t.findMagnet(i)),e.closestView=null,e.closestMagnet=null}finishEmbedding(e){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(e.zIndex=null)}fallbackConnection(e){switch(e.fallbackAction){case"remove":this.cell.remove({ui:!0});break;case"revert":default:this.cell.prop(e.terminalType,e.initialTerminal,{ui:!0});break}}notifyConnectionEvent(e,t){const i=e.terminalType,a=e.initialTerminal,d=this.cell[i];if(d&&!Qi.equalTerminals(a,d)){const m=this.graph,y=a,x=y.cell?m.getCellById(y.cell):null,E=y.port,S=x?m.findViewByCell(x):null,T=x||e.isNewEdge?null:Oe.create(a).toJSON(),R=d,V=R.cell?m.getCellById(R.cell):null,j=R.port,q=V?m.findViewByCell(V):null,ue=V?null:Oe.create(d).toJSON();this.notify("edge:connected",{e:t,previousCell:x,previousPort:E,previousView:S,previousPoint:T,currentCell:V,currentView:q,currentPort:j,currentPoint:ue,previousMagnet:e.initialMagnet,currentMagnet:e.currentMagnet,edge:this.cell,view:this,type:i,isNew:e.isNewEdge})}}highlightAvailableMagnets(e){const t=this.graph,i=t.model.getCells();e.marked={};for(let a=0,d=i.length;a<d;a+=1){const f=t.renderer.findViewByCell(i[a]);if(!f)continue;const m=Array.prototype.slice.call(f.container.querySelectorAll("[magnet]"));f.container.getAttribute("magnet")!=="false"&&m.push(f.container);const y=m.filter(x=>t.hook.validateConnection(...e.getValidateConnectionArgs(f,x),f.getEdgeTerminal(x,e.x,e.y,this.cell,e.terminalType)));if(y.length>0){for(let x=0,E=y.length;x<E;x+=1)f.highlight(y[x],{type:"magnetAvailable"});f.highlight(null,{type:"nodeAvailable"}),e.marked[f.cell.id]=y}}}unhighlightAvailableMagnets(e){const t=e.marked||{};Object.keys(t).forEach(i=>{const a=this.graph.renderer.findViewByCell(i);a&&(t[i].forEach(f=>{a.unhighlight(f,{type:"magnetAvailable"})}),a.unhighlight(null,{type:"nodeAvailable"}))}),e.marked=null}startArrowheadDragging(e,t,i){if(!this.can("arrowheadMovable")){this.notifyUnhandledMouseDown(e,t,i);return}const d=e.target.getAttribute("data-terminal"),f=this.prepareArrowheadDragging(d,{x:t,y:i});this.setEventData(e,f)}dragArrowhead(e,t,i){const a=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(t,i,a):this.arrowheadDragging(this.getEventTarget(e),t,i,a)}stopArrowheadDragging(e,t,i){const a=this.graph,d=this.getEventData(e);a.options.connecting.snap?this.snapArrowheadEnd(d):this.arrowheadDragged(d,t,i),a.hook.validateEdge(this.cell,d.terminalType,d.initialTerminal)?(this.finishEmbedding(d),this.notifyConnectionEvent(d,e)):this.fallbackConnection(d),this.afterArrowheadDragging(d)}startLabelDragging(e,t,i){if(this.can("edgeLabelMovable")){const a=e.currentTarget,d=parseInt(a.getAttribute("data-index"),10),f=this.getLabelPositionAngle(d),m=this.getLabelPositionArgs(d),y=this.getDefaultLabelPositionArgs(),x=this.mergeLabelPositionArgs(m,y);this.setEventData(e,{index:d,positionAngle:f,positionArgs:x,stopPropagation:!0,action:"drag-label"})}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this)}dragLabel(e,t,i){const a=this.getEventData(e),d=this.cell.getLabelAt(a.index),f=Pi.Z({},d,{position:this.getLabelPosition(t,i,a.positionAngle,a.positionArgs)});this.cell.setLabelAt(a.index,f)}stopLabelDragging(e,t,i){}handleVertexAdding(e,t,i){if(!this.can("vertexAddable")){this.notifyUnhandledMouseDown(e,t,i);return}const a=this.addVertex({x:t,y:i},{ui:!0});this.setEventData(e,{index:a,action:"drag-vertex"})}handleVertexRemoving(e,t,i){if(!this.can("vertexDeletable")){this.notifyUnhandledMouseDown(e,t,i);return}const a=e.target,d=parseInt(a.getAttribute("idx"),10);this.cell.removeVertexAt(d)}startVertexDragging(e,t,i){if(!this.can("vertexMovable")){this.notifyUnhandledMouseDown(e,t,i);return}const a=e.target,d=parseInt(a.getAttribute("idx"),10);this.setEventData(e,{index:d,action:"drag-vertex"})}dragVertex(e,t,i){const a=this.getEventData(e);this.cell.setVertexAt(a.index,{x:t,y:i},{ui:!0})}stopVertexDragging(e,t,i){}}(function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.isNodeView=="function"&&typeof a.isEdgeView=="function"&&typeof a.confirmUpdate=="function"&&typeof a.update=="function"&&typeof a.getConnection=="function"}c.isEdgeView=e})(_u||(_u={})),_u.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],vertices:["vertices","update"],vertexMarkup:["vertices"],toolMarkup:["tools"],tools:["widget"]},shortLength:105,longLength:155,toolsOffset:40,doubleTools:!1,doubleToolsOffset:65,sampleInterval:50}),_u.registry.register("edge",_u,!0);class aa extends xo{constructor(){super(...arguments),this.scalableNode=null,this.rotatableNode=null,this.scalableSelector="scalable",this.rotatableSelector="rotatable",this.defaultPortMarkup=li.getPortMarkup(),this.defaultPortLabelMarkup=li.getPortLabelMarkup(),this.defaultPortContainerMarkup=li.getPortContainerMarkup(),this.portsCache={}}get[Symbol.toStringTag](){return aa.toStringTag}getContainerClassName(){const e=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||e.push(this.prefixClassName("node-immovable")),e.join(" ")}updateClassName(e){const t=e.target;if(t.hasAttribute("magnet")){const i=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?Wa(t,i):vi(t,i)}else{const i=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(i):this.addClass(i)}}isNodeView(){return!0}confirmUpdate(e,t={}){let i=e;return this.hasAction(i,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","resize","translate","rotate","ports","tools"])):(i=this.handleAction(i,"resize",()=>this.resize(t),"update"),i=this.handleAction(i,"update",()=>this.update(),Hs.useCSSSelector?"ports":null),i=this.handleAction(i,"translate",()=>this.translate()),i=this.handleAction(i,"rotate",()=>this.rotate()),i=this.handleAction(i,"ports",()=>this.renderPorts()),i=this.handleAction(i,"tools",()=>this.renderTools())),i}update(e){this.cleanCache(),Hs.useCSSSelector&&this.removePorts();const t=this.cell,i=t.getSize(),a=t.getAttrs();this.updateAttrs(this.container,a,{attrs:e===a?null:e,rootBBox:new gn(0,0,i.width,i.height),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode}),Hs.useCSSSelector&&this.renderPorts()}renderMarkup(){const e=this.cell.markup;if(e)return typeof e=="string"?this.renderStringMarkup(e):this.renderJSONMarkup(e);throw new TypeError("Invalid node markup.")}renderJSONMarkup(e){const t=this.parseJSONMarkup(e,this.container),i=a=>Array.isArray(a)?a[0]:a;this.selectors=t.selectors,this.rotatableNode=i(this.selectors[this.rotatableSelector]),this.scalableNode=i(this.selectors[this.scalableSelector]),this.container.appendChild(t.fragment)}renderStringMarkup(e){Yf(this.container,In.toNodes(In.createVectors(e))),this.rotatableNode=km(this.container,`.${this.rotatableSelector}`),this.scalableNode=km(this.container,`.${this.scalableSelector}`),this.selectors={},this.rootSelector&&(this.selectors[this.rootSelector]=this.container)}render(){return this.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransform(),Hs.useCSSSelector||this.renderPorts(),this.renderTools(),this}resize(e={}){if(this.scalableNode)return this.updateSize(e);this.cell.getAngle()&&this.rotate(),this.update()}translate(){if(this.rotatableNode)return this.updateTranslation();this.updateTransform()}rotate(){if(this.rotatableNode){this.updateRotation(),this.update();return}this.updateTransform()}getTranslationString(){const e=this.cell.getPosition();return`translate(${e.x},${e.y})`}getRotationString(){const e=this.cell.getAngle();if(e){const t=this.cell.getSize();return`rotate(${e},${t.width/2},${t.height/2})`}}updateTransform(){let e=this.getTranslationString();const t=this.getRotationString();t&&(e+=` ${t}`),this.container.setAttribute("transform",e)}updateRotation(){if(this.rotatableNode!=null){const e=this.getRotationString();e!=null?this.rotatableNode.setAttribute("transform",e):this.rotatableNode.removeAttribute("transform")}}updateTranslation(){this.container.setAttribute("transform",this.getTranslationString())}updateSize(e={}){const t=this.cell,i=t.getSize(),a=t.getAngle(),d=this.scalableNode;let f=!1;d.getElementsByTagName("path").length>0&&(f=!0);const m=Pr(d,{recursive:f}),y=i.width/(m.width||1),x=i.height/(m.height||1);d.setAttribute("transform",`scale(${y},${x})`);const E=this.rotatableNode;if(E!=null){const S=E.getAttribute("transform");if(S){E.setAttribute("transform",`${S} rotate(${-a},${i.width/2},${i.height/2})`);const T=Pr(d,{target:this.graph.view.stage});t.prop("position",{x:T.x,y:T.y},Object.assign({updated:!0},e)),this.translate(),this.rotate()}}this.update()}findPortElem(e,t){const i=e?this.portsCache[e]:null;if(!i)return null;const a=i.portContentElement,d=i.portContentSelectors||{};return this.findOne(t,a,d)}initializePorts(){this.cleanPortsCache()}refreshPorts(){this.removePorts(),this.cleanPortsCache(),this.renderPorts()}cleanPortsCache(){this.portsCache={}}removePorts(){Object.keys(this.portsCache).forEach(e=>{const t=this.portsCache[e];Jl(t.portElement)})}renderPorts(){const e=this.getPortsContainer(),t=[];e.childNodes.forEach(d=>{t.push(d)});const i=Zd(this.cell.getParsedPorts(),"zIndex"),a="auto";i[a]&&i[a].forEach(d=>{const f=this.getPortElement(d);e.append(f),t.push(f)}),Object.keys(i).forEach(d=>{if(d!==a){const f=parseInt(d,10);this.appendPorts(i[d],f,t)}}),this.updatePorts()}getPortsContainer(){return this.rotatableNode||this.container}appendPorts(e,t,i){const a=e.map(d=>this.getPortElement(d));i[t]||t<0?Lm(i[Math.max(t,0)],a):Yf(this.getPortsContainer(),a)}getPortElement(e){const t=this.portsCache[e.id];return t?t.portElement:this.createPortElement(e)}createPortElement(e){let t=li.renderMarkup(this.getPortContainerMarkup());const i=t.elem;if(i==null)throw new Error("Invalid port container markup.");t=li.renderMarkup(this.getPortMarkup(e));const a=t.elem,d=t.selectors;if(a==null)throw new Error("Invalid port markup.");this.setAttrs({port:e.id,"port-group":e.group},a),t=li.renderMarkup(this.getPortLabelMarkup(e.label));const f=t.elem,m=t.selectors;if(f==null)throw new Error("Invalid port label markup.");let y;if(d&&m){for(const E in m)if(d[E]&&E!==this.rootSelector)throw new Error("Selectors within port must be unique.");y=Object.assign(Object.assign({},d),m)}else y=d||m;let x="x6-port";return e.group&&(x+=` x6-port-${e.group}`),vi(i,x),vi(a,"x6-port-body"),vi(f,"x6-port-label"),i.appendChild(a),i.appendChild(f),this.portsCache[e.id]={portElement:i,portSelectors:y,portLabelElement:f,portLabelSelectors:m,portContentElement:a,portContentSelectors:d},this.graph.hook.onPortRendered({port:e,node:this.cell,container:i,selectors:y,labelContainer:f,labelSelectors:m,contentContainer:a,contentSelectors:d}),i}updatePorts(){this.updatePortGroup();const e=this.cell.getParsedGroups();Object.keys(e).forEach(t=>this.updatePortGroup(t))}updatePortGroup(e){const t=gn.fromSize(this.cell.getSize()),i=this.cell.getPortsLayoutByGroup(e,t);for(let a=0,d=i.length;a<d;a+=1){const f=i[a],m=f.portId,y=this.portsCache[m]||{},x=f.portLayout;if(this.applyPortTransform(y.portElement,x),f.portAttrs!=null){const S={selectors:y.portSelectors||{}};f.portSize&&(S.rootBBox=gn.fromSize(f.portSize)),this.updateAttrs(y.portElement,f.portAttrs,S)}const E=f.labelLayout;if(E&&(this.applyPortTransform(y.portLabelElement,E,-(x.angle||0)),E.attrs)){const S={selectors:y.portLabelSelectors||{}};f.labelSize&&(S.rootBBox=gn.fromSize(f.labelSize)),this.updateAttrs(y.portLabelElement,E.attrs,S)}}}applyPortTransform(e,t,i=0){const a=t.angle,d=t.position,f=On().rotate(i).translate(d.x||0,d.y||0).rotate(a||0);Nh(e,f,{absolute:!0})}getPortContainerMarkup(){return this.cell.getPortContainerMarkup()||this.defaultPortContainerMarkup}getPortMarkup(e){return e.markup||this.cell.portMarkup||this.defaultPortMarkup}getPortLabelMarkup(e){return e.markup||this.cell.portLabelMarkup||this.defaultPortLabelMarkup}getEventArgs(e,t,i){const a=this,d=a.cell,f=d;return t==null||i==null?{e,view:a,node:d,cell:f}:{e,x:t,y:i,view:a,node:d,cell:f}}notifyMouseDown(e,t,i){super.onMouseDown(e,t,i),this.notify("node:mousedown",this.getEventArgs(e,t,i))}notifyMouseMove(e,t,i){super.onMouseMove(e,t,i),this.notify("node:mousemove",this.getEventArgs(e,t,i))}notifyMouseUp(e,t,i){super.onMouseUp(e,t,i),this.notify("node:mouseup",this.getEventArgs(e,t,i))}onClick(e,t,i){super.onClick(e,t,i),this.notify("node:click",this.getEventArgs(e,t,i))}onDblClick(e,t,i){super.onDblClick(e,t,i),this.notify("node:dblclick",this.getEventArgs(e,t,i))}onContextMenu(e,t,i){super.onContextMenu(e,t,i),this.notify("node:contextmenu",this.getEventArgs(e,t,i))}onMouseDown(e,t,i){this.isPropagationStopped(e)||(this.notifyMouseDown(e,t,i),this.startNodeDragging(e,t,i))}onMouseMove(e,t,i){const a=this.getEventData(e),d=a.action;if(d==="magnet")this.dragMagnet(e,t,i);else{if(d==="move"){const m=a.targetView||this;m.dragNode(e,t,i),m.notify("node:moving",{e,x:t,y:i,view:m,cell:m.cell,node:m.cell})}this.notifyMouseMove(e,t,i)}this.setEventData(e,a)}onMouseUp(e,t,i){const a=this.getEventData(e),d=a.action;d==="magnet"?this.stopMagnetDragging(e,t,i):(this.notifyMouseUp(e,t,i),d==="move"&&(a.targetView||this).stopNodeDragging(e,t,i));const f=a.targetMagnet;f&&this.onMagnetClick(e,f,t,i),this.checkMouseleave(e)}onMouseOver(e){super.onMouseOver(e),this.notify("node:mouseover",this.getEventArgs(e))}onMouseOut(e){super.onMouseOut(e),this.notify("node:mouseout",this.getEventArgs(e))}onMouseEnter(e){this.updateClassName(e),super.onMouseEnter(e),this.notify("node:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("node:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,i,a){super.onMouseWheel(e,t,i,a),this.notify("node:mousewheel",Object.assign({delta:a},this.getEventArgs(e,t,i)))}onMagnetClick(e,t,i,a){this.graph.view.getMouseMovedCount(e)>this.graph.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:t},this.getEventArgs(e,i,a)))}onMagnetDblClick(e,t,i,a){this.notify("node:magnet:dblclick",Object.assign({magnet:t},this.getEventArgs(e,i,a)))}onMagnetContextMenu(e,t,i,a){this.notify("node:magnet:contextmenu",Object.assign({magnet:t},this.getEventArgs(e,i,a)))}onMagnetMouseDown(e,t,i,a){this.startMagnetDragging(e,i,a)}onCustomEvent(e,t,i,a){this.notify("node:customevent",Object.assign({name:t},this.getEventArgs(e,i,a))),super.onCustomEvent(e,t,i,a)}prepareEmbedding(e){const i=this.getEventData(e).cell||this.cell,a=this.graph.findViewByCell(i),d=this.graph.snapToGrid(e.clientX,e.clientY);this.notify("node:embed",{e,node:i,view:a,cell:i,x:d.x,y:d.y,currentParent:i.getParent()})}processEmbedding(e,t){const i=t.cell||this.cell,a=t.graph||this.graph,d=a.options.embedding,f=d.findParent;let m=typeof f=="function"?Pn(f,a,{view:this,node:this.cell}).filter(T=>Xr.isCell(T)&&this.cell.id!==T.id&&!T.isDescendantOf(this.cell)):a.model.getNodesUnderNode(i,{by:f});if(d.frontOnly&&m.length>0){const T=Zd(m,"zIndex"),R=cf(Object.keys(T));R&&(m=T[R])}m=m.filter(T=>T.visible);let y=null;const x=t.candidateEmbedView,E=d.validate;for(let T=m.length-1;T>=0;T-=1){const R=m[T];if(x&&x.cell.id===R.id){y=x;break}else{const V=R.findView(a);if(Pn(E,a,{child:this.cell,parent:V.cell,childView:this,parentView:V})){y=V;break}}}this.clearEmbedding(t),y&&y.highlight(null,{type:"embedding"}),t.candidateEmbedView=y;const S=a.snapToGrid(e.clientX,e.clientY);this.notify("node:embedding",{e,cell:i,node:i,view:a.findViewByCell(i),x:S.x,y:S.y,currentParent:i.getParent(),candidateParent:y?y.cell:null})}clearEmbedding(e){const t=e.candidateEmbedView;t&&(t.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null)}finalizeEmbedding(e,t){const i=t.cell||this.cell,a=t.graph||this.graph,d=a.findViewByCell(i),f=i.getParent(),m=t.candidateEmbedView;if(m?(m.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null,(f==null||f.id!==m.cell.id)&&m.cell.insertChild(i,void 0,{ui:!0})):f&&f.unembed(i,{ui:!0}),a.model.getConnectedEdges(i,{deep:!0}).forEach(y=>{y.updateParent({ui:!0})}),d&&m){const y=a.snapToGrid(e.clientX,e.clientY);d.notify("node:embedded",{e,cell:i,x:y.x,y:y.y,node:i,view:a.findViewByCell(i),previousParent:f,currentParent:i.getParent()})}}getDelegatedView(){let e=this.cell,t=this;for(;t&&!e.isEdge();){if(!e.hasParent()||t.can("stopDelegateOnDragging"))return t;e=e.getParent(),t=this.graph.renderer.findViewByCell(e)}return null}startMagnetDragging(e,t,i){if(!this.can("magnetConnectable"))return;e.stopPropagation();const a=e.currentTarget,d=this.graph;this.setEventData(e,{targetMagnet:a}),d.hook.validateMagnet(this,a,e)?(d.options.magnetThreshold<=0&&this.startConnectting(e,a,t,i),this.setEventData(e,{action:"magnet"}),this.stopPropagation(e)):((Sd(a,"x6-port-body")||N()(a).closest(".x6-port-body").length>0)&&this.stopPropagation(e),this.onMouseDown(e,t,i)),d.view.delegateDragEvents(e,this)}startConnectting(e,t,i,a){this.graph.model.startBatch("add-edge");const d=this.createEdgeFromMagnet(t,i,a);d.notifyMouseDown(e,i,a),d.setEventData(e,d.prepareArrowheadDragging("target",{x:i,y:a,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(e,{edgeView:d})}createEdgeFromMagnet(e,t,i){const a=this.graph,d=a.model,f=a.hook.getDefaultEdge(this,e);return f.setSource(Object.assign(Object.assign({},f.getSource()),this.getEdgeTerminal(e,t,i,f,"source"))),f.setTarget(Object.assign(Object.assign({},f.getTarget()),{x:t,y:i})),f.addTo(d,{async:!1,ui:!0}),f.findView(a)}dragMagnet(e,t,i){const a=this.getEventData(e),d=a.edgeView;if(d)d.onMouseMove(e,t,i),this.autoScrollGraph(e.clientX,e.clientY);else{const f=this.graph,m=f.options.magnetThreshold,y=this.getEventTarget(e),x=a.targetMagnet;if(m==="onleave"){if(x===y||x.contains(y))return}else if(f.view.getMouseMovedCount(e)<=m)return;this.startConnectting(e,x,t,i)}}stopMagnetDragging(e,t,i){const d=this.eventData(e).edgeView;d&&(d.onMouseUp(e,t,i),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(e,t,i){this.notify("node:unhandled:mousedown",{e,x:t,y:i,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(e,t,i,a,d){let f=[d];const m=this.graph.selection.widget;if(m&&m.options.movable){const y=this.graph.getSelectedCells();y.includes(d)&&(f=y.filter(x=>x.isNode()))}f.forEach(y=>{this.notify(e,{e:t,x:i,y:a,cell:y,node:y,view:y.findView(this.graph)})})}startNodeDragging(e,t,i){const a=this.getDelegatedView();if(a==null||!a.can("nodeMovable"))return this.notifyUnhandledMouseDown(e,t,i);this.setEventData(e,{targetView:a,action:"move"});const d=Oe.create(a.cell.getPosition());a.setEventData(e,{moving:!1,offset:d.diff(t,i),restrict:this.graph.hook.getRestrictArea(a)})}dragNode(e,t,i){const a=this.cell,d=this.graph,f=d.getGridSize(),m=this.getEventData(e),y=m.offset,x=m.restrict;m.moving||(m.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",e,t,i,this.cell)),this.autoScrollGraph(e.clientX,e.clientY);const E=Bo.snapToGrid(t+y.x,f),S=Bo.snapToGrid(i+y.y,f);a.setPosition(E,S,{restrict:x,deep:!0,ui:!0}),d.options.embedding.enabled&&(m.embedding||(this.prepareEmbedding(e),m.embedding=!0),this.processEmbedding(e,m))}stopNodeDragging(e,t,i){const a=this.getEventData(e);a.embedding&&this.finalizeEmbedding(e,a),a.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",e,t,i,this.cell)),a.moving=!1,a.embedding=!1}autoScrollGraph(e,t){const i=this.graph.scroller.widget;i&&i.autoScroll(e,t)}}(function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.isNodeView=="function"&&typeof a.isEdgeView=="function"&&typeof a.confirmUpdate=="function"&&typeof a.update=="function"&&typeof a.findPortElem=="function"&&typeof a.resize=="function"&&typeof a.rotate=="function"&&typeof a.translate=="function"}c.isNodeView=e})(aa||(aa={})),aa.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),aa.registry.register("node",aa,!0);const $x=d0("text");class Wx extends nc("text",{view:$x,attrs:{text:{fontSize:18,fill:"#000000",stroke:null,refX:.5,refY:.5}}},{noText:!0}){}(function(c){class e extends aa{confirmUpdate(i,a={}){let d=super.confirmUpdate(i,a);return this.hasAction(d,"scale")&&(this.resize(),d=this.removeAction(d,"scale")),d}}c.View=e,e.config({actions:{attrs:["scale"]}}),aa.registry.register($x,e)})(Wx||(Wx={}));class Zx extends Is{constructor(e,t={}){super(),this.length=0,this.comparator=t.comparator||"zIndex",this.clean(),e&&this.reset(e,{silent:!0})}toJSON(){return this.cells.map(e=>e.toJSON())}add(e,t,i){let a,d;typeof t=="number"?(a=t,d=Object.assign({merge:!1},i)):(a=this.length,d=Object.assign({merge:!1},t)),a>this.length&&(a=this.length),a<0&&(a+=this.length+1);const f=Array.isArray(e)?e:[e],m=this.comparator&&typeof t!="number"&&d.sort!==!1,y=this.comparator||null;let x=!1;const E=[],S=[];return f.forEach(T=>{const R=this.get(T);R?d.merge&&!T.isSameStore(R)&&(R.setProp(T.getProp(),i),S.push(R),m&&!x&&(y==null||typeof y=="function"?x=R.hasChanged():typeof y=="string"?x=R.hasChanged(y):x=y.some(V=>R.hasChanged(V)))):(E.push(T),this.reference(T))}),E.length&&(m&&(x=!0),this.cells.splice(a,0,...E),this.length=this.cells.length),x&&this.sort({silent:!0}),d.silent||(E.forEach((T,R)=>{const V={cell:T,index:a+R,options:d};this.trigger("added",V),d.dryrun||T.notify("added",Object.assign({},V))}),x&&this.trigger("sorted"),(E.length||S.length)&&this.trigger("updated",{added:E,merged:S,removed:[],options:d})),this}remove(e,t={}){const i=Array.isArray(e)?e:[e],a=this.removeCells(i,t);return!t.silent&&a.length>0&&this.trigger("updated",{options:t,removed:a,added:[],merged:[]}),Array.isArray(e)?a:a[0]}removeCells(e,t){const i=[];for(let a=0;a<e.length;a+=1){const d=this.get(e[a]);if(d==null)continue;const f=this.cells.indexOf(d);this.cells.splice(f,1),this.length-=1,delete this.map[d.id],i.push(d),this.unreference(d),t.dryrun||d.remove(),t.silent||(this.trigger("removed",{cell:d,index:f,options:t}),t.dryrun||d.notify("removed",{cell:d,index:f,options:t}))}return i}reset(e,t={}){const i=this.cells.slice();if(i.forEach(a=>this.unreference(a)),this.clean(),this.add(e,Object.assign({silent:!0},t)),!t.silent){const a=this.cells.slice();this.trigger("reseted",{options:t,previous:i,current:a});const d=[],f=[];a.forEach(m=>{i.some(x=>x.id===m.id)||d.push(m)}),i.forEach(m=>{a.some(x=>x.id===m.id)||f.push(m)}),this.trigger("updated",{options:t,added:d,removed:f,merged:[]})}return this}push(e,t){return this.add(e,this.length,t)}pop(e){const t=this.at(this.length-1);return this.remove(t,e)}unshift(e,t){return this.add(e,0,t)}shift(e){const t=this.at(0);return this.remove(t,e)}get(e){if(e==null)return null;const t=typeof e=="string"||typeof e=="number"?e:e.id;return this.map[t]||null}has(e){return this.get(e)!=null}at(e){return e<0&&(e+=this.length),this.cells[e]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(e){return this.cells.indexOf(e)}toArray(){return this.cells.slice()}sort(e={}){return this.comparator!=null&&(this.cells=ju(this.cells,this.comparator),e.silent||this.trigger("sorted")),this}clone(){const e=this.constructor;return new e(this.cells.slice(),{comparator:this.comparator})}reference(e){this.map[e.id]=e,e.on("*",this.notifyCellEvent,this)}unreference(e){e.off("*",this.notifyCellEvent,this),delete this.map[e.id]}notifyCellEvent(e,t){const i=t.cell;this.trigger(`cell:${e}`,t),i&&(i.isNode()?this.trigger(`node:${e}`,Object.assign(Object.assign({},t),{node:i})):i.isEdge()&&this.trigger(`edge:${e}`,Object.assign(Object.assign({},t),{edge:i})))}clean(){this.length=0,this.cells=[],this.map={}}}class $s extends Is{constructor(e=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new Zx(e),this.setup()}get[Symbol.toStringTag](){return $s.toStringTag}notify(e,t){this.trigger(e,t);const i=this.graph;return i&&(e==="sorted"||e==="reseted"||e==="updated"?i.trigger(`model:${e}`,t):i.trigger(e,t)),this}setup(){const e=this.collection;e.on("sorted",()=>this.notify("sorted",null)),e.on("updated",t=>this.notify("updated",t)),e.on("cell:change:zIndex",()=>this.sortOnChangeZ()),e.on("added",({cell:t})=>{this.onCellAdded(t)}),e.on("removed",t=>{const i=t.cell;this.onCellRemoved(i,t.options),this.notify("cell:removed",t),i.isNode()?this.notify("node:removed",Object.assign(Object.assign({},t),{node:i})):i.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},t),{edge:i}))}),e.on("reseted",t=>{this.onReset(t.current),this.notify("reseted",t)}),e.on("edge:change:source",({edge:t})=>this.onEdgeTerminalChanged(t,"source")),e.on("edge:change:target",({edge:t})=>{this.onEdgeTerminalChanged(t,"target")})}sortOnChangeZ(){this.collection.sort()}onCellAdded(e){const t=e.id;e.isEdge()?(e.updateParent(),this.edges[t]=!0,this.onEdgeTerminalChanged(e,"source"),this.onEdgeTerminalChanged(e,"target")):this.nodes[t]=!0}onCellRemoved(e,t){const i=e.id;if(e.isEdge()){delete this.edges[i];const a=e.getSource(),d=e.getTarget();if(a&&a.cell){const f=this.outgoings[a.cell],m=f?f.indexOf(i):-1;m>=0&&(f.splice(m,1),f.length===0&&delete this.outgoings[a.cell])}if(d&&d.cell){const f=this.incomings[d.cell],m=f?f.indexOf(i):-1;m>=0&&(f.splice(m,1),f.length===0&&delete this.incomings[d.cell])}}else delete this.nodes[i];t.clear||(t.disconnectEdges?this.disconnectConnectedEdges(e,t):this.removeConnectedEdges(e,t)),e.model===this&&(e.model=null)}onReset(e){this.nodes={},this.edges={},this.outgoings={},this.incomings={},e.forEach(t=>this.onCellAdded(t))}onEdgeTerminalChanged(e,t){const i=t==="source"?this.outgoings:this.incomings,a=e.previous(t);if(a&&a.cell){const f=Xr.isCell(a.cell)?a.cell.id:a.cell,m=i[f],y=m?m.indexOf(e.id):-1;y>=0&&(m.splice(y,1),m.length===0&&delete i[f])}const d=e.getTerminal(t);if(d&&d.cell){const f=Xr.isCell(d.cell)?d.cell.id:d.cell,m=i[f]||[];m.indexOf(e.id)===-1&&m.push(e.id),i[f]=m}}prepareCell(e,t){return!e.model&&(!t||!t.dryrun)&&(e.model=this),e.zIndex==null&&e.setZIndex(this.getMaxZIndex()+1,{silent:!0}),e}resetCells(e,t={}){return e.map(i=>this.prepareCell(i,Object.assign(Object.assign({},t),{dryrun:!0}))),this.collection.reset(e,t),e.map(i=>this.prepareCell(i,{options:t})),this}clear(e={}){const t=this.getCells();if(t.length===0)return this;const i=Object.assign(Object.assign({},e),{clear:!0});return this.batchUpdate("clear",()=>{const a=t.sort((d,f)=>{const m=d.isEdge()?1:2,y=f.isEdge()?1:2;return m-y});for(;a.length>0;){const d=a.shift();d&&d.remove(i)}},i),this}addNode(e,t={}){const i=Si.isNode(e)?e:this.createNode(e);return this.addCell(i,t),i}createNode(e){return Si.create(e)}addEdge(e,t={}){const i=Qi.isEdge(e)?e:this.createEdge(e);return this.addCell(i,t),i}createEdge(e){return Qi.create(e)}addCell(e,t={}){return Array.isArray(e)?this.addCells(e,t):(!this.collection.has(e)&&!this.addings.has(e)&&(this.addings.set(e,!0),this.collection.add(this.prepareCell(e,t),t),e.eachChild(i=>this.addCell(i,t)),this.addings.delete(e)),this)}addCells(e,t={}){const i=e.length;if(i===0)return this;const a=Object.assign(Object.assign({},t),{position:i-1,maxPosition:i-1});return this.startBatch("add",Object.assign(Object.assign({},a),{cells:e})),e.forEach(d=>{this.addCell(d,a),a.position-=1}),this.stopBatch("add",Object.assign(Object.assign({},a),{cells:e})),this}removeCell(e,t={}){const i=typeof e=="string"?this.getCell(e):e;return i&&this.has(i)?this.collection.remove(i,t):null}updateCellId(e,t){this.startBatch("update",{id:t}),e.prop("id",t);const i=e.clone({keepId:!0});return this.addCell(i),this.getConnectedEdges(e).forEach(d=>{const f=d.getSourceCell(),m=d.getTargetCell();f===e&&d.setSource(Object.assign(Object.assign({},d.getSource()),{cell:t})),m===e&&d.setTarget(Object.assign(Object.assign({},d.getTarget()),{cell:t}))}),this.removeCell(e),this.stopBatch("update",{id:t}),i}removeCells(e,t={}){return e.length?this.batchUpdate("remove",()=>e.map(i=>this.removeCell(i,t))):[]}removeConnectedEdges(e,t={}){const i=this.getConnectedEdges(e);return i.forEach(a=>{a.remove(t)}),i}disconnectConnectedEdges(e,t={}){const i=typeof e=="string"?e:e.id;this.getConnectedEdges(e).forEach(a=>{const d=a.getSourceCell(),f=a.getTargetCell();d&&d.id===i&&a.setSource({x:0,y:0},t),f&&f.id===i&&a.setTarget({x:0,y:0},t)})}has(e){return this.collection.has(e)}total(){return this.collection.length}indexOf(e){return this.collection.indexOf(e)}getCell(e){return this.collection.get(e)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const e=this.collection.first();return e&&e.getZIndex()||0}getMaxZIndex(){const e=this.collection.last();return e&&e.getZIndex()||0}getCellsFromCache(e){return e?Object.keys(e).map(t=>this.getCell(t)).filter(t=>t!=null):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(e){const t=typeof e=="string"?e:e.id,i=this.outgoings[t];return i?i.map(a=>this.getCell(a)).filter(a=>a&&a.isEdge()):null}getIncomingEdges(e){const t=typeof e=="string"?e:e.id,i=this.incomings[t];return i?i.map(a=>this.getCell(a)).filter(a=>a&&a.isEdge()):null}getConnectedEdges(e,t={}){const i=[],a=typeof e=="string"?this.getCell(e):e;if(a==null)return i;const d={},f=t.indirect;let m=t.incoming,y=t.outgoing;m==null&&y==null&&(m=y=!0);const x=(E,S)=>{const T=S?this.getOutgoingEdges(E):this.getIncomingEdges(E);if(T!=null&&T.forEach(R=>{d[R.id]||(i.push(R),d[R.id]=!0,f&&(m&&x(R,!1),y&&x(R,!0)))}),f&&E.isEdge()){const R=S?E.getTargetCell():E.getSourceCell();R&&R.isEdge()&&(d[R.id]||(i.push(R),x(R,S)))}};if(y&&x(a,!0),m&&x(a,!1),t.deep){const E=a.getDescendants({deep:!0}),S={};E.forEach(R=>{R.isNode()&&(S[R.id]=!0)});const T=(R,V)=>{const j=V?this.getOutgoingEdges(R.id):this.getIncomingEdges(R.id);j!=null&&j.forEach(q=>{if(!d[q.id]){const ue=q.getSourceCell(),be=q.getTargetCell();if(!t.enclosed&&ue&&S[ue.id]&&be&&S[be.id])return;i.push(q),d[q.id]=!0}})};E.forEach(R=>{R.isEdge()||(y&&T(R,!0),m&&T(R,!1))})}return i}isBoundary(e,t){const i=typeof e=="string"?this.getCell(e):e,a=t?this.getIncomingEdges(i):this.getOutgoingEdges(i);return a==null||a.length===0}getBoundaryNodes(e){const t=[];return Object.keys(this.nodes).forEach(i=>{if(this.isBoundary(i,e)){const a=this.getCell(i);a&&t.push(a)}}),t}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(e){return this.isBoundary(e,!0)}isLeaf(e){return this.isBoundary(e,!1)}getNeighbors(e,t={}){let i=t.incoming,a=t.outgoing;i==null&&a==null&&(i=a=!0);const f=this.getConnectedEdges(e,t).reduce((m,y)=>{const x=y.hasLoop(t),E=y.getSourceCell(),S=y.getTargetCell();return i&&E&&E.isNode()&&!m[E.id]&&(x||E!==e&&(!t.deep||!E.isDescendantOf(e)))&&(m[E.id]=E),a&&S&&S.isNode()&&!m[S.id]&&(x||S!==e&&(!t.deep||!S.isDescendantOf(e)))&&(m[S.id]=S),m},{});if(e.isEdge()){if(i){const m=e.getSourceCell();m&&m.isNode()&&!f[m.id]&&(f[m.id]=m)}if(a){const m=e.getTargetCell();m&&m.isNode()&&!f[m.id]&&(f[m.id]=m)}}return Object.keys(f).map(m=>f[m])}isNeighbor(e,t,i={}){let a=i.incoming,d=i.outgoing;return a==null&&d==null&&(a=d=!0),this.getConnectedEdges(e,i).some(f=>{const m=f.getSourceCell(),y=f.getTargetCell();return!!(a&&m&&m.id===t.id||d&&y&&y.id===t.id)})}getSuccessors(e,t={}){const i=[];return this.search(e,(a,d)=>{a!==e&&this.matchDistance(d,t.distance)&&i.push(a)},Object.assign(Object.assign({},t),{outgoing:!0})),i}isSuccessor(e,t,i={}){let a=!1;return this.search(e,(d,f)=>{if(d===t&&d!==e&&this.matchDistance(f,i.distance))return a=!0,!1},Object.assign(Object.assign({},i),{outgoing:!0})),a}getPredecessors(e,t={}){const i=[];return this.search(e,(a,d)=>{a!==e&&this.matchDistance(d,t.distance)&&i.push(a)},Object.assign(Object.assign({},t),{incoming:!0})),i}isPredecessor(e,t,i={}){let a=!1;return this.search(e,(d,f)=>{if(d===t&&d!==e&&this.matchDistance(f,i.distance))return a=!0,!1},Object.assign(Object.assign({},i),{incoming:!0})),a}matchDistance(e,t){return t==null?!0:typeof t=="function"?t(e):Array.isArray(t)&&t.includes(e)?!0:e===t}getCommonAncestor(...e){const t=[];return e.forEach(i=>{i&&(Array.isArray(i)?t.push(...i):t.push(i))}),Xr.getCommonAncestor(...t)}getSubGraph(e,t={}){const i=[],a={},d=[],f=[],m=y=>{a[y.id]||(i.push(y),a[y.id]=y,y.isEdge()&&f.push(y),y.isNode()&&d.push(y))};return e.forEach(y=>{m(y),t.deep&&y.getDescendants({deep:!0}).forEach(E=>m(E))}),f.forEach(y=>{const x=y.getSourceCell(),E=y.getTargetCell();x&&!a[x.id]&&(i.push(x),a[x.id]=x,x.isNode()&&d.push(x)),E&&!a[E.id]&&(i.push(E),a[E.id]=E,E.isNode()&&d.push(E))}),d.forEach(y=>{this.getConnectedEdges(y,t).forEach(E=>{const S=E.getSourceCell(),T=E.getTargetCell();!a[E.id]&&S&&a[S.id]&&T&&a[T.id]&&(i.push(E),a[E.id]=E)})}),i}cloneSubGraph(e,t={}){const i=this.getSubGraph(e,t);return this.cloneCells(i)}cloneCells(e){return Xr.cloneCells(e)}getNodesFromPoint(e,t){const i=typeof e=="number"?{x:e,y:t||0}:e;return this.getNodes().filter(a=>a.getBBox().containsPoint(i))}getNodesInArea(e,t,i,a,d){const f=typeof e=="number"?new gn(e,t,i,a):gn.create(e),m=typeof e=="number"?d:t,y=m&&m.strict;return this.getNodes().filter(x=>{const E=x.getBBox();return y?f.containsRect(E):f.isIntersectWithRect(E)})}getEdgesInArea(e,t,i,a,d){const f=typeof e=="number"?new gn(e,t,i,a):gn.create(e),m=typeof e=="number"?d:t,y=m&&m.strict;return this.getEdges().filter(x=>{const E=x.getBBox();return E.width===0?E.inflate(1,0):E.height===0&&E.inflate(0,1),y?f.containsRect(E):f.isIntersectWithRect(E)})}getNodesUnderNode(e,t={}){const i=e.getBBox();return(t.by==null||t.by==="bbox"?this.getNodesInArea(i):this.getNodesFromPoint(i[t.by])).filter(d=>e.id!==d.id&&!d.isDescendantOf(e))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(e,t={}){return Xr.getCellsBBox(e,t)}search(e,t,i={}){i.breadthFirst?this.breadthFirstSearch(e,t,i):this.depthFirstSearch(e,t,i)}breadthFirstSearch(e,t,i={}){const a=[],d={},f={};for(a.push(e),f[e.id]=0;a.length>0;){const m=a.shift();if(m==null||d[m.id]||(d[m.id]=!0,Pn(t,this,m,f[m.id])===!1))continue;this.getNeighbors(m,i).forEach(x=>{f[x.id]=f[m.id]+1,a.push(x)})}}depthFirstSearch(e,t,i={}){const a=[],d={},f={};for(a.push(e),f[e.id]=0;a.length>0;){const m=a.pop();if(m==null||d[m.id]||(d[m.id]=!0,Pn(t,this,m,f[m.id])===!1))continue;const y=this.getNeighbors(m,i),x=a.length;y.forEach(E=>{f[E.id]=f[m.id]+1,a.splice(x,0,E)})}}getShortestPath(e,t,i={}){const a={};this.getEdges().forEach(x=>{const E=x.getSourceCellId(),S=x.getTargetCellId();E&&S&&(a[E]||(a[E]=[]),a[S]||(a[S]=[]),a[E].push(S),i.directed||a[S].push(E))});const d=typeof e=="string"?e:e.id,f=n0.run(a,d,i.weight),m=[];let y=typeof t=="string"?t:t.id;for(f[y]&&m.push(y);y=f[y];)m.unshift(y);return m}translate(e,t,i){return this.getCells().filter(a=>!a.hasParent()).forEach(a=>a.translate(e,t,i)),this}resize(e,t,i){return this.resizeCells(e,t,this.getCells(),i)}resizeCells(e,t,i,a={}){const d=this.getCellsBBox(i);if(d){const f=Math.max(e/d.width,0),m=Math.max(t/d.height,0),y=d.getOrigin();i.forEach(x=>x.scale(f,m,y,a))}return this}toJSON(e={}){return $s.toJSON(this.getCells(),e)}parseJSON(e){return $s.fromJSON(e)}fromJSON(e,t={}){const i=this.parseJSON(e);return this.resetCells(i,t),this}startBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)+1,this.notify("batch:start",{name:e,data:t}),this}stopBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)-1,this.notify("batch:stop",{name:e,data:t}),this}batchUpdate(e,t,i={}){this.startBatch(e,i);const a=t();return this.stopBatch(e,i),a}hasActiveBatch(e=Object.keys(this.batches)){return(Array.isArray(e)?e:[e]).some(i=>this.batches[i]>0)}}(function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&typeof a.addNode=="function"&&typeof a.addEdge=="function"&&a.collection!=null}c.isModel=e})($s||($s={})),function(c){function e(i,a={}){return{cells:i.map(d=>d.toJSON(a))}}c.toJSON=e;function t(i){const a=[];return Array.isArray(i)?a.push(...i):(i.cells&&a.push(...i.cells),i.nodes&&i.nodes.forEach(d=>{d.shape==null&&(d.shape="rect"),a.push(d)}),i.edges&&i.edges.forEach(d=>{d.shape==null&&(d.shape="edge"),a.push(d)})),a.map(d=>{const f=d.shape;if(f){if(Si.registry.exist(f))return Si.create(d);if(Qi.registry.exist(f))return Qi.create(d)}throw new Error("The `shape` should be specified when creating a node/edge instance")})}c.fromJSON=t}($s||($s={}));const Vc=".text-block-content",p0=d0("text-block");class g0 extends Si{get content(){return this.getContent()}set content(e){this.setContent(e)}getContent(){return this.store.get("content","")}setContent(e,t={}){this.store.set("content",e,t)}setup(){super.setup(),this.store.on("change:*",e=>{const t=e.key;t==="content"?this.updateContent(this.getContent()):t==="size"&&this.updateSize(this.getSize())}),this.updateSize(this.getSize()),this.updateContent(this.getContent())}updateSize(e){xt.SUPPORT_FOREIGNOBJECT&&this.setAttrs({foreignObject:Object.assign({},e),[Vc]:{style:Object.assign({},e)}})}updateContent(e){xt.SUPPORT_FOREIGNOBJECT?this.setAttrs({[Vc]:{html:e?Am(e):""}}):this.setAttrs({[Vc]:{text:e}})}}(function(c){c.config({type:p0,view:p0,markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',xt.SUPPORT_FOREIGNOBJECT?["<foreignObject>",'<body xmlns="http://www.w3.org/1999/xhtml">',`<div class="${Vc.substr(1)}" />`,"</body>","</foreignObject>"].join(""):`<text class="${Vc.substr(1)}"/>`,"</g>"].join(""),attrs:{".":{fill:"#ffffff",stroke:"none"},rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000",fontSize:14,fontFamily:"Arial, helvetica, sans-serif"},body:{style:{background:"transparent",position:"static",margin:0,padding:0}},foreignObject:{style:{overflow:"hidden"}},[Vc]:{refX:.5,refY:.5,yAlign:"middle",xAlign:"middle",style:{textAlign:"center",verticalAlign:"middle",display:"table-cell",padding:"0 5px",margin:0}}}}),Si.registry.register(p0,c)})(g0||(g0={})),function(c){const e="content";class t extends aa{confirmUpdate(a,d={}){let f=super.confirmUpdate(a,d);return this.hasAction(f,e)&&(this.updateContent(),f=this.removeAction(f,e)),f}update(a){if(xt.SUPPORT_FOREIGNOBJECT)super.update(a);else{const d=this.cell,f=Object.assign({},a||d.getAttrs());delete f[Vc],super.update(f),(!a||_l(a,Vc))&&this.updateContent(a)}}updateContent(a){if(xt.SUPPORT_FOREIGNOBJECT)super.update(a);else{const d=this.cell,f=(a||d.getAttrs())[Vc],m=ls(d.getContent(),d.getSize(),f,{svgDocument:this.graph.view.svg}),y={[Vc]:Pi.Z({},f,{text:m})};super.update(y)}}}c.View=t,function(i){i.config({bootstrap:["render",e],actions:xt.SUPPORT_FOREIGNOBJECT?{}:{size:e,content:e}}),aa.registry.register(p0,i)}(t=c.View||(c.View={}))}(g0||(g0={}));const DA=ws.define({shape:"empty"});function kE(c,e="body"){return[{tagName:c,selector:e},{tagName:"text",selector:"label"}]}function Nu(c,e,t={}){const i={constructorName:c,markup:kE(c,t.selector),attrs:{[c]:Object.assign({},ws.bodyAttr)}};return(t.parent||ws).define(Pi.Z(i,e,{shape:c}))}const _A=Nu("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}}),NA=Si.define({shape:"rect-headered",markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}],attrs:{body:Object.assign(Object.assign({},ws.bodyAttr),{refWidth:"100%",refHeight:"100%"}),header:Object.assign(Object.assign({},ws.bodyAttr),{refWidth:"100%",height:30,stroke:"#000000"}),headerText:Object.assign(Object.assign({},ws.labelAttr),{refX:"50%",refY:15,fontSize:16}),bodyText:Object.assign(Object.assign({},ws.labelAttr),{refY2:15})}}),kA=Nu("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}}),xy=10,RA=ws.define({shape:"cylinder",overwrite:!0,markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],attrs:{body:Object.assign(Object.assign({},ws.bodyAttr),{lateral:xy}),top:Object.assign(Object.assign({},ws.bodyAttr),{refCx:"50%",refRx:"50%",cy:xy,ry:xy})},attrHooks:{lateral:{set(c,{refBBox:e}){const t=pl(c);t&&(c=parseFloat(c)/100);const i=e.x,a=e.y,d=e.width,f=e.height,m=d/2,y=t?f*c:c,x=.551784,E=x*m,S=x*y,T=i,R=i+d/2,V=i+d,j=a+y,q=j-y,ue=a+f-y,be=a+f;return{d:["M",T,j,"L",T,ue,"C",i,ue+S,R-E,be,R,be,"C",R+E,be,V,ue+S,V,ue,"L",V,j,"C",V,j-S,R+E,q,R,q,"C",R-E,q,T,j-S,T,j,"Z"].join(" ")}}}},knob:{enabled:!0,position({node:c}){const e=c.attr("body/lateral");return{x:0,y:e}},onMouseMove({node:c,data:e,deltaY:t}){if(t!==0){const i=c.getBBox(),a=c.attr("body/lateral");e.round==null&&(e.round=a);const d=0,f=i.height/2,m=Ta(e.round+t,d,f);m!==a&&c.attr({body:{lateral:m},top:{cy:m,ry:m}})}}}}),IA=Nu("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var RE=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class dp extends ws{get points(){return this.getPoints()}set points(e){this.setPoints(e)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(e,t){return e==null?this.removePoints():this.setAttrByPath("body/refPoints",dp.pointsToString(e),t),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}(function(c){function e(t){return typeof t=="string"?t:t.map(i=>Array.isArray(i)?i.join(","):Oe.isPointLike(i)?`${i.x}, ${i.y}`:"").join(" ")}c.pointsToString=e,c.config({propHooks(t){const{points:i}=t,a=RE(t,["points"]);if(i){const d=e(i);d&&Os(a,"attrs/body/refPoints",d)}return a}})})(dp||(dp={}));const LA=Nu("polygon",{},{parent:dp}),Do=Nu("polyline",{},{parent:dp});var FA=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const GA=ws.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(c){const{path:e}=c,t=FA(c,["path"]);return e&&Os(t,"attrs/body/refD",e),t}});var IE=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};const BA=ws.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},xt.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:Fo.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},ws.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(c){const{text:e}=c,t=IE(c,["text"]);return e&&Os(t,"attrs/label/text",e),t},attrHooks:{text:{set(c,{cell:e,view:t,refBBox:i,elem:a,attrs:d}){if(a instanceof HTMLElement)a.textContent=c;else{const f=d.style||{},m={text:c,width:-5,height:"100%"},y=Object.assign({textVerticalAnchor:"middle"},f),x=yl.presets.textWrap;return Pn(x.set,this,m,{cell:e,view:t,elem:a,refBBox:i,attrs:y}),{fill:f.color||null}}},position(c,{refBBox:e,elem:t}){if(t instanceof SVGElement)return e.getCenter()}}}}),zA=Nu("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:$h()},{selector:"image"}),UA=Nu("image-bordered",{markup:[{tagName:"rect",selector:"background",attrs:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attrs:{fill:"none"}},{tagName:"text",selector:"label"}],attrs:{background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#ffffff"},border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},image:{refWidth:-1,refHeight:-1,x:.5,y:.5}},propHooks:$h()}),LE=Nu("image-embedded",{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}],attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"}},propHooks:$h()}),FE=Nu("image-inscribed",{propHooks:$h(),markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attrs:{fill:"none"}},{tagName:"text",selector:"label"}],attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#ffffff"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"}}}),m0=Qi.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}}),GE=Qi.define({shape:"shadow-edge",markup:[{tagName:"path",selector:"shadow",attrs:{fill:"none"}},{tagName:"path",selector:"line",attrs:{fill:"none",cursor:"pointer"}}],attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{name:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z",offsetX:-5},sourceMarker:{name:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z",offsetX:-5}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{name:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none",offsetX:-5},sourceMarker:{name:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z",offsetX:-5}}}}),BE=Qi.define({shape:"double-edge",markup:[{tagName:"path",selector:"outline",attrs:{fill:"none"}},{tagName:"path",selector:"line",attrs:{fill:"none",cursor:"pointer"}}],attrs:{line:{connection:!0,stroke:"#dddddd",strokeWidth:4,strokeLinejoin:"round",targetMarker:{tagName:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}});class Ya extends ws{get html(){return this.getHTML()}set html(e){this.setHTML(e)}getHTML(){return this.store.get("html")}setHTML(e,t={}){return e==null?this.removeHTML(t):this.store.set("html",e,t),this}removeHTML(e={}){return this.store.remove("html",e)}}(function(c){class e extends aa{init(){super.init(),this.cell.on("change:*",()=>{this.graph.hook.shouldUpdateHTMLComponent(this.cell)&&this.renderHTMLComponent()})}confirmUpdate(i){const a=super.confirmUpdate(i);return this.handleAction(a,e.action,()=>this.renderHTMLComponent())}renderHTMLComponent(){const i=this.selectors.foContent;if(i){const a=this.$(i).empty(),d=this.graph.hook.getHTMLComponent(this.cell);d&&(typeof d=="string"?a.html(d):a.append(d))}}}c.View=e,function(t){t.action="html",t.config({bootstrap:[t.action],actions:{html:t.action}}),aa.registry.register("html-view",t)}(e=c.View||(c.View={}))})(Ya||(Ya={})),function(c){c.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},li.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),Si.registry.register("html",c)}(Ya||(Ya={})),function(c){c.componentRegistry=Oo.create({type:"html componnet"})}(Ya||(Ya={}));var Xx=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class hp extends ty{constructor(e){super(),this.delay=10,this.throttle=2,this.threshold=5,this.changeCount=0,this.timestamp=0,this.options=Object.assign(Object.assign({},hp.defaultOptions),e),this.graph.model.on("cell:change:*",this.onModelChanged,this)}get graph(){return this.options.graph}onModelChanged(){if(this.disabled)return;const t=(new Date().getTime()-this.timestamp)/1e3;t>this.delay||this.changeCount>=this.threshold&&t>this.throttle?(this.save(),this.reset()):this.changeCount+=1}save(){this.trigger("save")}reset(){this.changeCount=0,this.timestamp=new Date().getTime()}dispose(){this.graph.model.off("cell:change:*",this.onModelChanged,this)}}Xx([ty.dispose()],hp.prototype,"dispose",null),function(c){c.defaultOptions={delay:10,throttle:2,threshold:5}}(hp||(hp={}));class Di extends xl{constructor(e){super(),this.graph=e,this.init()}get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}init(){}}var Yx=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class El extends ii{constructor(e){super(),this.graph=e;const{selectors:t,fragment:i}=li.parseJSONMarkup(El.markup);this.background=t.background,this.grid=t.grid,this.svg=t.svg,this.defs=t.defs,this.viewport=t.viewport,this.primer=t.primer,this.stage=t.stage,this.decorator=t.decorator,this.overlay=t.overlay,this.container=this.options.container,this.restore=El.snapshoot(this.container),this.$(this.container).addClass(this.prefixClassName("graph")).append(i),this.delegateEvents()}get model(){return this.graph.model}get options(){return this.graph.options}delegateEvents(){const e=this.constructor;return super.delegateEvents(e.events),this}guard(e,t){return e.type==="mousedown"&&e.button===2||this.options.guard&&this.options.guard(e,t)?!0:e.data&&e.data.guarded!==void 0?e.data.guarded:!(t&&t.cell&&Xr.isCell(t.cell)||this.svg===e.target||this.container===e.target||N().contains(this.svg,e.target))}findView(e){return this.graph.renderer.findViewByElem(e)}onDblClick(e){this.options.preventDefaultDblClick&&e.preventDefault();const t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;const a=this.graph.snapToGrid(t.clientX,t.clientY);i?i.onDblClick(t,a.x,a.y):this.graph.trigger("blank:dblclick",{e:t,x:a.x,y:a.y})}onClick(e){if(this.getMouseMovedCount(e)<=this.options.clickThreshold){const t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;const a=this.graph.snapToGrid(t.clientX,t.clientY);i?i.onClick(t,a.x,a.y):this.graph.trigger("blank:click",{e:t,x:a.x,y:a.y})}}isPreventDefaultContextMenu(e,t){let i=this.options.preventDefaultContextMenu;return typeof i=="function"&&(i=Pn(i,this.graph,{view:t})),i}onContextMenu(e){const t=this.normalizeEvent(e),i=this.findView(t.target);if(this.isPreventDefaultContextMenu(t,i)&&e.preventDefault(),this.guard(t,i))return;const a=this.graph.snapToGrid(t.clientX,t.clientY);i?i.onContextMenu(t,a.x,a.y):this.graph.trigger("blank:contextmenu",{e:t,x:a.x,y:a.y})}delegateDragEvents(e,t){e.data==null&&(e.data={}),this.setEventData(e,{currentView:t||null,mouseMovedCount:0,startPosition:{x:e.clientX,y:e.clientY}});const i=this.constructor;this.delegateDocumentEvents(i.documentEvents,e.data),this.undelegateEvents()}getMouseMovedCount(e){return this.getEventData(e).mouseMovedCount||0}onMouseDown(e){const t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;this.options.preventDefaultMouseDown&&t.preventDefault();const a=this.graph.snapToGrid(t.clientX,t.clientY);i?i.onMouseDown(t,a.x,a.y):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.graph.trigger("blank:mousedown",{e:t,x:a.x,y:a.y})),this.delegateDragEvents(t,i)}onMouseMove(e){const t=this.getEventData(e),i=t.startPosition;if(i&&i.x===e.clientX&&i.y===e.clientY||(t.mouseMovedCount==null&&(t.mouseMovedCount=0),t.mouseMovedCount+=1,t.mouseMovedCount<=this.options.moveThreshold))return;const d=this.normalizeEvent(e),f=this.graph.snapToGrid(d.clientX,d.clientY),m=t.currentView;m?m.onMouseMove(d,f.x,f.y):this.graph.trigger("blank:mousemove",{e:d,x:f.x,y:f.y}),this.setEventData(d,t)}onMouseUp(e){this.undelegateDocumentEvents();const t=this.normalizeEvent(e),i=this.graph.snapToGrid(t.clientX,t.clientY),d=this.getEventData(e).currentView;d?d.onMouseUp(t,i.x,i.y):this.graph.trigger("blank:mouseup",{e:t,x:i.x,y:i.y}),e.isPropagationStopped()||this.onClick(N().Event(e,{type:"click",data:e.data})),e.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(e){const t=this.normalizeEvent(e),i=this.findView(t.target);if(!this.guard(t,i))if(i)i.onMouseOver(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseover",{e:t})}}onMouseOut(e){const t=this.normalizeEvent(e),i=this.findView(t.target);if(!this.guard(t,i))if(i)i.onMouseOut(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseout",{e:t})}}onMouseEnter(e){const t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;const a=this.graph.renderer.findViewByElem(t.relatedTarget);if(i){if(a===i)return;i.onMouseEnter(t)}else{if(a)return;this.graph.trigger("graph:mouseenter",{e:t})}}onMouseLeave(e){const t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;const a=this.graph.renderer.findViewByElem(t.relatedTarget);if(i){if(a===i)return;i.onMouseLeave(t)}else{if(a)return;this.graph.trigger("graph:mouseleave",{e:t})}}onMouseWheel(e){const t=this.normalizeEvent(e),i=this.findView(t.target);if(this.guard(t,i))return;const a=t.originalEvent,d=this.graph.snapToGrid(a.clientX,a.clientY),f=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));i?i.onMouseWheel(t,d.x,d.y,f):this.graph.trigger("blank:mousewheel",{e:t,delta:f,x:d.x,y:d.y})}onCustomEvent(e){const t=e.currentTarget,i=t.getAttribute("event")||t.getAttribute("data-event");if(i){const a=this.findView(t);if(a){const d=this.normalizeEvent(e);if(this.guard(d,a))return;const f=this.graph.snapToGrid(d.clientX,d.clientY);a.onCustomEvent(d,i,f.x,f.y)}}}handleMagnetEvent(e,t){const i=e.currentTarget,a=i.getAttribute("magnet");if(a&&a.toLowerCase()!=="false"){const d=this.findView(i);if(d){const f=this.normalizeEvent(e);if(this.guard(f,d))return;const m=this.graph.snapToGrid(f.clientX,f.clientY);Pn(t,this.graph,d,f,i,m.x,m.y)}}}onMagnetMouseDown(e){this.handleMagnetEvent(e,(t,i,a,d,f)=>{t.onMagnetMouseDown(i,a,d,f)})}onMagnetDblClick(e){this.handleMagnetEvent(e,(t,i,a,d,f)=>{t.onMagnetDblClick(i,a,d,f)})}onMagnetContextMenu(e){const t=this.normalizeEvent(e),i=this.findView(t.target);this.isPreventDefaultContextMenu(t,i)&&t.preventDefault(),this.handleMagnetEvent(t,(a,d,f,m,y)=>{a.onMagnetContextMenu(d,f,m,y)})}onLabelMouseDown(e){const t=e.currentTarget,i=this.findView(t);if(i){const a=this.normalizeEvent(e);if(this.guard(a,i))return;const d=this.graph.snapToGrid(a.clientX,a.clientY);i.onLabelMouseDown(a,d.x,d.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}Yx([ii.dispose()],El.prototype,"dispose",null),function(c){const e=`${Hs.prefixCls}-graph`;c.markup=[{ns:Fo.xhtml,tagName:"div",selector:"background",className:`${e}-background`},{ns:Fo.xhtml,tagName:"div",selector:"grid",className:`${e}-grid`},{ns:Fo.svg,tagName:"svg",selector:"svg",className:`${e}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":Fo.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${e}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${e}-svg-primer`},{tagName:"g",selector:"stage",className:`${e}-svg-stage`},{tagName:"g",selector:"decorator",className:`${e}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${e}-svg-overlay`}]}]}];function t(i){const a=i.cloneNode();return i.childNodes.forEach(d=>a.appendChild(d)),()=>{for(Im(i);i.attributes.length>0;)i.removeAttribute(i.attributes[0].name);for(let d=0,f=a.attributes.length;d<f;d+=1){const m=a.attributes[d];i.setAttribute(m.name,m.value)}a.childNodes.forEach(d=>i.appendChild(d))}}c.snapshoot=t}(El||(El={})),function(c){const e=Hs.prefixCls;c.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${e}-cell`]:"onMouseEnter",[`mouseleave  .${e}-cell`]:"onMouseLeave",[`mouseenter  .${e}-cell-tools`]:"onMouseEnter",[`mouseleave  .${e}-cell-tools`]:"onMouseLeave",[`mousedown   .${e}-cell [event]`]:"onCustomEvent",[`touchstart  .${e}-cell [event]`]:"onCustomEvent",[`mousedown   .${e}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${e}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${e}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${e}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${e}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${e}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${e}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${e}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${e}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${e}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${e}-cell image`]:"onImageDragStart",[`mousedown   .${e}-edge .${e}-edge-label`]:"onLabelMouseDown",[`touchstart  .${e}-edge .${e}-edge-label`]:"onLabelMouseDown"},c.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(El||(El={}));var Ka;(function(c){function e(t,i){return(a,d,f)=>{const m=f.value;f.value=function(...y){if(this.scroller.widget==null){const E=`Shoule enable scroller to use method '${d}'`;if(t!==!1)throw console.error(E),new Error(E);return i!==!1&&console.warn(E),this}return m.call(this,...y)}}}c.checkScroller=e})(Ka||(Ka={}));const Kx=`.x6-graph {
  position: relative;
  outline: none;
}
.x6-graph-background,
.x6-graph-grid,
.x6-graph-svg {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-background-stage,
.x6-graph-grid-stage,
.x6-graph-svg-stage {
  user-select: none;
}
.x6-graph.x6-graph-pannable {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph.x6-graph-panning {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-node {
  cursor: move;
  /* stylelint-disable-next-line */
}
.x6-node.x6-node-immovable {
  cursor: default;
}
.x6-node * {
  -webkit-user-drag: none;
}
.x6-node .scalable * {
  vector-effect: non-scaling-stroke;
}
.x6-node [magnet='true'] {
  cursor: crosshair;
  transition: opacity 0.3s;
}
.x6-node [magnet='true']:hover {
  opacity: 0.7;
}
.x6-node foreignObject {
  display: block;
  overflow: visible;
  background-color: transparent;
}
.x6-node foreignObject > body {
  position: static;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: visible;
  background-color: transparent;
}
.x6-edge .source-marker,
.x6-edge .target-marker {
  vector-effect: non-scaling-stroke;
}
.x6-edge .connection {
  stroke-linejoin: round;
  fill: none;
}
.x6-edge .connection-wrap {
  cursor: move;
  opacity: 0;
  fill: none;
  stroke: #000;
  stroke-width: 15;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.x6-edge .connection-wrap:hover {
  opacity: 0.4;
  stroke-opacity: 0.4;
}
.x6-edge .vertices {
  cursor: move;
  opacity: 0;
}
.x6-edge .vertices .vertex {
  fill: #1abc9c;
}
.x6-edge .vertices .vertex :hover {
  fill: #34495e;
  stroke: none;
}
.x6-edge .vertices .vertex-remove {
  cursor: pointer;
  fill: #fff;
}
.x6-edge .vertices .vertex-remove-area {
  cursor: pointer;
  opacity: 0.1;
}
.x6-edge .vertices .vertex-group:hover .vertex-remove-area {
  opacity: 1;
}
.x6-edge .arrowheads {
  cursor: move;
  opacity: 0;
}
.x6-edge .arrowheads .arrowhead {
  fill: #1abc9c;
}
.x6-edge .arrowheads .arrowhead :hover {
  fill: #f39c12;
  stroke: none;
}
.x6-edge .tools {
  cursor: pointer;
  opacity: 0;
}
.x6-edge .tools .tool-options {
  display: none;
}
.x6-edge .tools .tool-remove circle {
  fill: #f00;
}
.x6-edge .tools .tool-remove path {
  fill: #fff;
}
.x6-edge:hover .vertices,
.x6-edge:hover .arrowheads,
.x6-edge:hover .tools {
  opacity: 1;
}
.x6-highlight-opacity {
  opacity: 0.3;
}
@keyframes halo-pie-visibility {
  0% {
    visibility: hidden;
  }
  100% {
    visibility: visible;
  }
}
@keyframes halo-pie-opening {
  0% {
    transform: scale(0.4) rotate(-20deg);
  }
  100% {
    transform: scale(1) rotate(0);
  }
}
.x6-widget-handle {
  position: absolute;
  width: 20px;
  height: 20px;
  background-color: transparent;
  background-repeat: no-repeat;
  background-position: 0 0;
  background-size: 20px 20px;
  cursor: pointer;
  user-select: none;
  pointer-events: auto;
  -webkit-user-drag: none;
  user-drag: none;
  /* stylelint-disable-line */
}
.x6-widget-handle.hidden {
  display: none;
}
.x6-widget-handle-selected {
  background-color: rgba(0, 0, 0, 0.1);
  border-radius: 3px;
}
.x6-widget-handle-remove {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15.386%2C3.365c-3.315-3.314-8.707-3.313-12.021%2C0c-3.314%2C3.315-3.314%2C8.706%2C0%2C12.02%20c3.314%2C3.314%2C8.707%2C3.314%2C12.021%2C0S18.699%2C6.68%2C15.386%2C3.365L15.386%2C3.365z%20M4.152%2C14.598C1.273%2C11.719%2C1.273%2C7.035%2C4.153%2C4.154%20c2.88-2.88%2C7.563-2.88%2C10.443%2C0c2.881%2C2.88%2C2.881%2C7.562%2C0%2C10.443C11.716%2C17.477%2C7.032%2C17.477%2C4.152%2C14.598L4.152%2C14.598z%22%2F%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.157%2C11.371L7.38%2C6.593C7.162%2C6.375%2C6.809%2C6.375%2C6.592%2C6.592c-0.218%2C0.219-0.218%2C0.572%2C0%2C0.79%20l4.776%2C4.776c0.218%2C0.219%2C0.571%2C0.219%2C0.79%2C0C12.375%2C11.941%2C12.375%2C11.588%2C12.157%2C11.371L12.157%2C11.371z%22%2F%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M11.369%2C6.593l-4.777%2C4.778c-0.217%2C0.217-0.217%2C0.568%2C0%2C0.787c0.219%2C0.219%2C0.571%2C0.217%2C0.788%2C0l4.777-4.777%20c0.218-0.218%2C0.218-0.571%2C0.001-0.789C11.939%2C6.375%2C11.587%2C6.375%2C11.369%2C6.593L11.369%2C6.593z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
  cursor: pointer;
}
.x6-widget-handle-remove:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15.386%2C3.365c-3.315-3.314-8.707-3.313-12.021%2C0c-3.314%2C3.315-3.314%2C8.706%2C0%2C12.02%20c3.314%2C3.314%2C8.707%2C3.314%2C12.021%2C0S18.699%2C6.68%2C15.386%2C3.365L15.386%2C3.365z%22%2F%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M12.157%2C11.371L7.38%2C6.593C7.162%2C6.375%2C6.809%2C6.375%2C6.592%2C6.592c-0.218%2C0.219-0.218%2C0.572%2C0%2C0.79%20l4.776%2C4.776c0.218%2C0.219%2C0.571%2C0.219%2C0.79%2C0C12.375%2C11.941%2C12.375%2C11.588%2C12.157%2C11.371L12.157%2C11.371z%22%2F%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M11.369%2C6.593l-4.777%2C4.778c-0.217%2C0.217-0.217%2C0.568%2C0%2C0.787c0.219%2C0.219%2C0.571%2C0.217%2C0.788%2C0l4.777-4.777%20c0.218-0.218%2C0.218-0.571%2C0.001-0.789C11.939%2C6.375%2C11.587%2C6.375%2C11.369%2C6.593L11.369%2C6.593z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-rotate {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M9.374%2C17.592c-4.176%2C0-7.57-3.401-7.57-7.575c0-4.175%2C3.395-7.574%2C7.57-7.574c0.28%2C0%2C0.56%2C0.018%2C0.837%2C0.05%20V1.268c0-0.158%2C0.099-0.3%2C0.239-0.36c0.151-0.058%2C0.315-0.026%2C0.428%2C0.086l2.683%2C2.688c0.152%2C0.154%2C0.152%2C0.399%2C0%2C0.553l-2.68%2C2.693%20c-0.115%2C0.112-0.279%2C0.147-0.431%2C0.087c-0.141-0.063-0.239-0.205-0.239-0.361V5.296C9.934%2C5.243%2C9.654%2C5.22%2C9.374%2C5.22%20c-2.646%2C0-4.796%2C2.152-4.796%2C4.797s2.154%2C4.798%2C4.796%2C4.798c2.645%2C0%2C4.798-2.153%2C4.798-4.798c0-0.214%2C0.174-0.391%2C0.391-0.391h1.991%20c0.217%2C0%2C0.394%2C0.177%2C0.394%2C0.391C16.947%2C14.19%2C13.549%2C17.592%2C9.374%2C17.592L9.374%2C17.592z%20M9.374%2C17.592%22%2F%3E%3C%2Fsvg%3E%20');
  cursor: move;
}
.x6-widget-handle-rotate:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M9.374%2C17.592c-4.176%2C0-7.57-3.401-7.57-7.575c0-4.175%2C3.395-7.574%2C7.57-7.574c0.28%2C0%2C0.56%2C0.018%2C0.837%2C0.05%20V1.268c0-0.158%2C0.099-0.3%2C0.239-0.36c0.151-0.058%2C0.315-0.026%2C0.428%2C0.086l2.683%2C2.688c0.152%2C0.154%2C0.152%2C0.399%2C0%2C0.553l-2.68%2C2.693%20c-0.115%2C0.112-0.279%2C0.147-0.431%2C0.087c-0.141-0.063-0.239-0.205-0.239-0.361V5.296C9.934%2C5.243%2C9.654%2C5.22%2C9.374%2C5.22%20c-2.646%2C0-4.796%2C2.152-4.796%2C4.797s2.154%2C4.798%2C4.796%2C4.798c2.645%2C0%2C4.798-2.153%2C4.798-4.798c0-0.214%2C0.174-0.391%2C0.391-0.391h1.991%20c0.217%2C0%2C0.394%2C0.177%2C0.394%2C0.391C16.947%2C14.19%2C13.549%2C17.592%2C9.374%2C17.592L9.374%2C17.592z%20M9.374%2C17.592%22%2F%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-resize {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3Csvg%20height%3D%2224px%22%20version%3D%221.1%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asketch%3D%22http%3A%2F%2Fwww.bohemiancoding.com%2Fsketch%2Fns%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%2F%3E%3Cdesc%2F%3E%3Cdefs%2F%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20id%3D%22miu%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%3E%3Cg%20id%3D%22Artboard-1%22%20transform%3D%22translate(-251.000000%2C%20-443.000000)%22%3E%3Cg%20id%3D%22slice%22%20transform%3D%22translate(215.000000%2C%20119.000000)%22%2F%3E%3Cpath%20d%3D%22M252%2C448%20L256%2C448%20L256%2C444%20L252%2C444%20L252%2C448%20Z%20M257%2C448%20L269%2C448%20L269%2C446%20L257%2C446%20L257%2C448%20Z%20M257%2C464%20L269%2C464%20L269%2C462%20L257%2C462%20L257%2C464%20Z%20M270%2C444%20L270%2C448%20L274%2C448%20L274%2C444%20L270%2C444%20Z%20M252%2C462%20L252%2C466%20L256%2C466%20L256%2C462%20L252%2C462%20Z%20M270%2C462%20L270%2C466%20L274%2C466%20L274%2C462%20L270%2C462%20Z%20M254%2C461%20L256%2C461%20L256%2C449%20L254%2C449%20L254%2C461%20Z%20M270%2C461%20L272%2C461%20L272%2C449%20L270%2C449%20L270%2C461%20Z%22%20fill%3D%22%236A6C8A%22%20id%3D%22editor-crop-glyph%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');
  cursor: se-resize;
}
.x6-widget-handle-resize:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3Csvg%20height%3D%2224px%22%20version%3D%221.1%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asketch%3D%22http%3A%2F%2Fwww.bohemiancoding.com%2Fsketch%2Fns%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%2F%3E%3Cdesc%2F%3E%3Cdefs%2F%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20id%3D%22miu%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%3E%3Cg%20id%3D%22Artboard-1%22%20transform%3D%22translate(-251.000000%2C%20-443.000000)%22%3E%3Cg%20id%3D%22slice%22%20transform%3D%22translate(215.000000%2C%20119.000000)%22%2F%3E%3Cpath%20d%3D%22M252%2C448%20L256%2C448%20L256%2C444%20L252%2C444%20L252%2C448%20Z%20M257%2C448%20L269%2C448%20L269%2C446%20L257%2C446%20L257%2C448%20Z%20M257%2C464%20L269%2C464%20L269%2C462%20L257%2C462%20L257%2C464%20Z%20M270%2C444%20L270%2C448%20L274%2C448%20L274%2C444%20L270%2C444%20Z%20M252%2C462%20L252%2C466%20L256%2C466%20L256%2C462%20L252%2C462%20Z%20M270%2C462%20L270%2C466%20L274%2C466%20L274%2C462%20L270%2C462%20Z%20M254%2C461%20L256%2C461%20L256%2C449%20L254%2C449%20L254%2C461%20Z%20M270%2C461%20L272%2C461%20L272%2C449%20L270%2C449%20L270%2C461%20Z%22%20fill%3D%22%23FD6EB6%22%20id%3D%22editor-crop-glyph%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');
}
.x6-widget-handle-clone {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.852%2C0.875h-9.27c-0.853%2C0-1.547%2C0.694-1.547%2C1.547v10.816h1.547V2.422h9.27V0.875z%20M15.172%2C3.965h-8.5%20c-0.849%2C0-1.547%2C0.698-1.547%2C1.547v10.816c0%2C0.849%2C0.698%2C1.547%2C1.547%2C1.547h8.5c0.85%2C0%2C1.543-0.698%2C1.543-1.547V5.512%20C16.715%2C4.663%2C16.021%2C3.965%2C15.172%2C3.965L15.172%2C3.965z%20M15.172%2C16.328h-8.5V5.512h8.5V16.328z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
  cursor: move;
}
.x6-widget-handle-clone:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M12.852%2C0.875h-9.27c-0.853%2C0-1.547%2C0.694-1.547%2C1.547v10.816h1.547V2.422h9.27V0.875z%20M15.172%2C3.965h-8.5%20c-0.849%2C0-1.547%2C0.698-1.547%2C1.547v10.816c0%2C0.849%2C0.698%2C1.547%2C1.547%2C1.547h8.5c0.849%2C0%2C1.543-0.698%2C1.543-1.547V5.512%20C16.715%2C4.663%2C16.021%2C3.965%2C15.172%2C3.965L15.172%2C3.965z%20M15.172%2C16.328h-8.5V5.512h8.5V16.328z%20M15.172%2C16.328%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-link {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M9.884%2C9.838c0.54-0.551%2C1.005-0.955%2C1.384-1.201c0.463-0.308%2C0.749-0.352%2C0.887-0.352h1.34v1.367%20c0%2C0.104%2C0.061%2C0.2%2C0.154%2C0.242s0.204%2C0.027%2C0.284-0.038l3.168-2.669c0.06-0.051%2C0.096-0.125%2C0.096-0.203S17.16%2C6.83%2C17.101%2C6.781%20l-3.168-2.677c-0.08-0.067-0.19-0.081-0.284-0.038c-0.094%2C0.045-0.154%2C0.139-0.154%2C0.242v1.414h-1.343%20c-1.24%2C0.014-2.215%2C0.67-2.927%2C1.242c-0.797%2C0.65-1.533%2C1.447-2.245%2C2.217c-0.361%2C0.391-0.7%2C0.759-1.044%2C1.1%20c-0.541%2C0.549-1.011%2C0.951-1.395%2C1.199c-0.354%2C0.231-0.678%2C0.357-0.921%2C0.357h-1.8c-0.146%2C0-0.266%2C0.12-0.266%2C0.265v2.029%20c0%2C0.148%2C0.12%2C0.268%2C0.266%2C0.268h1.8l0%2C0c1.255-0.014%2C2.239-0.667%2C2.958-1.24c0.82-0.661%2C1.572-1.475%2C2.297-2.256%20C9.225%2C10.524%2C9.555%2C10.169%2C9.884%2C9.838z%22%2F%3E%3C%2Fsvg%3E%20');
  cursor: move;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
.x6-widget-handle-link:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M9.884%2C9.838c0.54-0.551%2C1.005-0.955%2C1.384-1.201c0.463-0.308%2C0.749-0.352%2C0.887-0.352h1.34v1.367%20c0%2C0.104%2C0.061%2C0.2%2C0.154%2C0.242s0.204%2C0.027%2C0.284-0.038l3.168-2.669c0.06-0.051%2C0.096-0.125%2C0.096-0.203S17.16%2C6.83%2C17.101%2C6.781%20l-3.168-2.677c-0.08-0.067-0.19-0.081-0.284-0.038c-0.094%2C0.045-0.154%2C0.139-0.154%2C0.242v1.414h-1.343%20c-1.24%2C0.014-2.215%2C0.67-2.927%2C1.242c-0.797%2C0.65-1.533%2C1.447-2.245%2C2.217c-0.361%2C0.391-0.7%2C0.759-1.044%2C1.1%20c-0.541%2C0.549-1.011%2C0.951-1.395%2C1.199c-0.354%2C0.231-0.678%2C0.357-0.921%2C0.357h-1.8c-0.146%2C0-0.266%2C0.12-0.266%2C0.265v2.029%20c0%2C0.148%2C0.12%2C0.268%2C0.266%2C0.268h1.8l0%2C0c1.255-0.014%2C2.239-0.667%2C2.958-1.24c0.82-0.661%2C1.572-1.475%2C2.297-2.256%20C9.225%2C10.524%2C9.555%2C10.169%2C9.884%2C9.838z%22%2F%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-fork {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20fill%3D%22%236A6C8A%22%20d%3D%22M13.307%2C11.593c-0.69%2C0-1.299%2C0.33-1.693%2C0.835l-4.136-2.387%20C7.552%2C9.82%2C7.602%2C9.589%2C7.602%2C9.344c0-0.25-0.051-0.487-0.129-0.71l4.097-2.364c0.393%2C0.536%2C1.022%2C0.888%2C1.737%2C0.888%20c1.193%2C0%2C2.16-0.967%2C2.16-2.159s-0.967-2.159-2.16-2.159c-1.191%2C0-2.158%2C0.967-2.158%2C2.159c0%2C0.076%2C0.014%2C0.149%2C0.021%2C0.223%20L6.848%2C7.716C6.469%2C7.39%2C5.982%2C7.185%2C5.442%2C7.185c-1.191%2C0-2.158%2C0.967-2.158%2C2.159s0.967%2C2.159%2C2.158%2C2.159%20c0.545%2C0%2C1.037-0.208%2C1.417-0.541l4.319%2C2.493c-0.014%2C0.098-0.029%2C0.194-0.029%2C0.296c0%2C1.193%2C0.967%2C2.159%2C2.158%2C2.159%20c1.193%2C0%2C2.16-0.966%2C2.16-2.159C15.467%2C12.559%2C14.5%2C11.593%2C13.307%2C11.593z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
  cursor: move;
}
.x6-widget-handle-fork:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20fill%3D%22%23FD6EB6%22%20d%3D%22M13.307%2C11.593c-0.69%2C0-1.299%2C0.33-1.693%2C0.835l-4.136-2.387%20c0.075-0.22%2C0.125-0.452%2C0.125-0.697c0-0.25-0.051-0.487-0.129-0.71l4.097-2.365c0.394%2C0.536%2C1.022%2C0.888%2C1.737%2C0.888%20c1.193%2C0%2C2.16-0.967%2C2.16-2.159s-0.967-2.159-2.16-2.159c-1.191%2C0-2.158%2C0.967-2.158%2C2.159c0%2C0.076%2C0.015%2C0.148%2C0.022%2C0.223%20L6.848%2C7.716C6.469%2C7.39%2C5.981%2C7.185%2C5.442%2C7.185c-1.191%2C0-2.158%2C0.967-2.158%2C2.159s0.967%2C2.159%2C2.158%2C2.159%20c0.545%2C0%2C1.037-0.208%2C1.417-0.541l4.319%2C2.493c-0.013%2C0.098-0.029%2C0.194-0.029%2C0.296c0%2C1.193%2C0.967%2C2.159%2C2.158%2C2.159%20c1.193%2C0%2C2.16-0.966%2C2.16-2.159C15.467%2C12.559%2C14.5%2C11.593%2C13.307%2C11.593z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-unlink {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.285%2C9.711l-2.104-0.302L9.243%2C8.568L6.669%2C7.095C6.948%2C6.6%2C6.995%2C6.026%2C6.845%2C5.474%20c-0.191-0.698-0.695-1.36-1.438-1.786C4.068%2C2.922%2C2.464%2C3.214%2C1.82%2C4.338C1.536%2C4.836%2C1.489%2C5.414%2C1.64%2C5.97%20c0.189%2C0.698%2C0.694%2C1.36%2C1.438%2C1.787c0.328%2C0.187%2C0.67%2C0.31%2C1.01%2C0.372c0.002%2C0%2C0.006%2C0.002%2C0.008%2C0.004%20c0.027%2C0.004%2C0.057%2C0.009%2C0.088%2C0.011c2.12%2C0.316%2C3.203%2C0.915%2C3.73%2C1.337c-0.527%2C0.424-1.61%2C1.021-3.731%2C1.339%20c-0.029%2C0.003-0.058%2C0.007-0.087%2C0.012c-0.002%2C0.002-0.004%2C0.002-0.007%2C0.003c-0.341%2C0.062-0.684%2C0.187-1.013%2C0.374%20c-0.74%2C0.425-1.246%2C1.089-1.437%2C1.787c-0.149%2C0.555-0.105%2C1.133%2C0.181%2C1.632c0.011%2C0.018%2C0.021%2C0.033%2C0.033%2C0.049l0.883%2C0.783%20c0.765%2C0.366%2C1.775%2C0.328%2C2.67-0.184c0.744-0.425%2C1.248-1.088%2C1.439-1.786c0.148-0.552%2C0.104-1.126-0.176-1.62l2.573-1.473%20c0.573%2C0.287%2C2.299%2C1.292%2C2.299%2C1.292s3.602%2C1.445%2C4.241%2C1.812c0.773%2C0.191%2C0.566-0.151%2C0.566-0.151L12.285%2C9.711z%20M5.571%2C6.482%20C5.279%2C6.993%2C4.425%2C7.076%2C3.705%2C6.664C3.282%2C6.424%2C2.966%2C6.039%2C2.856%2C5.64C2.81%2C5.464%2C2.778%2C5.203%2C2.917%2C4.963%20c0.291-0.51%2C1.146-0.593%2C1.866-0.182C5.21%2C5.027%2C5.521%2C5.4%2C5.632%2C5.807C5.679%2C5.98%2C5.708%2C6.242%2C5.571%2C6.482z%20M5.632%2C13.159%20c-0.111%2C0.406-0.422%2C0.778-0.848%2C1.025c-0.719%2C0.409-1.576%2C0.327-1.867-0.184c-0.137-0.239-0.106-0.499-0.06-0.676%20c0.108-0.398%2C0.426-0.781%2C0.847-1.022c0.72-0.412%2C1.574-0.329%2C1.866%2C0.181C5.708%2C12.723%2C5.679%2C12.983%2C5.632%2C13.159z%20M16.181%2C5.139%20c-0.448%2C0.258-4.435%2C1.9-4.435%2C1.9s-1.556%2C0.855-2.104%2C1.13l0.937%2C0.843l2.057-0.229l4.11-3.638%20C16.745%2C5.146%2C17.013%2C4.664%2C16.181%2C5.139z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-unlink:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M12.285%2C9.711l-2.104-0.302L9.243%2C8.568L6.669%2C7.095C6.948%2C6.6%2C6.995%2C6.026%2C6.845%2C5.474%20c-0.191-0.698-0.695-1.36-1.438-1.786C4.068%2C2.922%2C2.464%2C3.214%2C1.82%2C4.338C1.536%2C4.836%2C1.489%2C5.414%2C1.64%2C5.97%20c0.189%2C0.698%2C0.694%2C1.36%2C1.438%2C1.787c0.328%2C0.187%2C0.67%2C0.31%2C1.01%2C0.372c0.002%2C0%2C0.006%2C0.002%2C0.008%2C0.004%20c0.027%2C0.004%2C0.057%2C0.009%2C0.088%2C0.011c2.12%2C0.316%2C3.203%2C0.915%2C3.73%2C1.337c-0.527%2C0.424-1.61%2C1.021-3.731%2C1.339%20c-0.029%2C0.003-0.058%2C0.007-0.087%2C0.012c-0.002%2C0.002-0.004%2C0.002-0.007%2C0.003c-0.341%2C0.062-0.684%2C0.187-1.013%2C0.374%20c-0.74%2C0.425-1.246%2C1.089-1.437%2C1.787c-0.149%2C0.555-0.105%2C1.133%2C0.181%2C1.632c0.011%2C0.018%2C0.021%2C0.033%2C0.033%2C0.049l0.883%2C0.783%20c0.765%2C0.366%2C1.775%2C0.328%2C2.67-0.184c0.744-0.425%2C1.248-1.088%2C1.439-1.786c0.148-0.552%2C0.104-1.126-0.176-1.62l2.573-1.473%20c0.573%2C0.287%2C2.299%2C1.292%2C2.299%2C1.292s3.602%2C1.445%2C4.241%2C1.812c0.773%2C0.191%2C0.566-0.151%2C0.566-0.151L12.285%2C9.711z%20M5.571%2C6.482%20C5.279%2C6.993%2C4.425%2C7.076%2C3.705%2C6.664C3.282%2C6.424%2C2.966%2C6.039%2C2.856%2C5.64C2.81%2C5.464%2C2.778%2C5.203%2C2.917%2C4.963%20c0.291-0.51%2C1.146-0.593%2C1.866-0.182C5.21%2C5.027%2C5.521%2C5.4%2C5.632%2C5.807C5.679%2C5.98%2C5.708%2C6.242%2C5.571%2C6.482z%20M5.632%2C13.159%20c-0.111%2C0.406-0.422%2C0.778-0.848%2C1.025c-0.719%2C0.409-1.576%2C0.327-1.867-0.184c-0.137-0.239-0.106-0.499-0.06-0.676%20c0.108-0.398%2C0.426-0.781%2C0.847-1.022c0.72-0.412%2C1.574-0.329%2C1.866%2C0.181C5.708%2C12.723%2C5.679%2C12.983%2C5.632%2C13.159z%20M16.181%2C5.139%20c-0.448%2C0.258-4.435%2C1.9-4.435%2C1.9s-1.556%2C0.855-2.104%2C1.13l0.937%2C0.843l2.057-0.229l4.11-3.638%20C16.745%2C5.146%2C17.013%2C4.664%2C16.181%2C5.139z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');
}
.x6-widget-handle-direction {
  background-image: url("data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20%20PUBLIC%20'-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN'%20%20'http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd'%3E%3Csvg%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%20512%20512%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%20512%20512%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%09.st0%7Bfill%3A%236A6C8A%3Bstroke%3A%236A6C8A%3Bstroke-width%3A30%7D%0A%09.dot%7Bfill%3A%236A6C8A%3B%7D%0A%3C%2Fstyle%3E%3Cg%3E%3Cg%20id%3D%22XMLID_475_%22%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M133.1%2C277.1c1.8%2C0%2C3.7-0.6%2C5.4-1.7c4.1-3%2C5-8.7%2C2-12.8c-3-4.1-8.7-5-12.8-2c0%2C0%2C0%2C0%2C0%2C0%20%20%20%20%20c-4.1%2C3-5%2C8.7-2%2C12.8C127.5%2C275.8%2C130.3%2C277.1%2C133.1%2C277.1z%22%20id%3D%22XMLID_489_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M138.5%2C359.6c-4.1-3-9.8-2.1-12.8%2C2c-3%2C4.1-2.1%2C9.8%2C2%2C12.8c1.6%2C1.2%2C3.5%2C1.7%2C5.4%2C1.7%20%20%20%20%20c2.8%2C0%2C5.6-1.3%2C7.4-3.7C143.5%2C368.3%2C142.6%2C362.6%2C138.5%2C359.6z%22%20id%3D%22XMLID_726_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C327.7c-4.8%2C1.6-7.4%2C6.7-5.9%2C11.5c1.3%2C3.9%2C4.8%2C6.3%2C8.7%2C6.3c0.9%2C0%2C1.9-0.1%2C2.8-0.4%20%20%20%20%20c4.8-1.6%2C7.4-6.7%2C5.9-11.5C118%2C328.8%2C112.9%2C326.2%2C108.1%2C327.7z%22%20id%3D%22XMLID_776_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C307.3c0.9%2C0.3%2C1.9%2C0.4%2C2.8%2C0.4c3.8%2C0%2C7.4-2.4%2C8.7-6.3c1.6-4.8-1.1-9.9-5.9-11.5%20%20%20%20%20c-4.8-1.6-9.9%2C1.1-11.5%2C5.9C100.7%2C300.6%2C103.3%2C305.7%2C108.1%2C307.3z%22%20id%3D%22XMLID_777_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M169.2%2C265.4c2.4%2C0%2C4.7-1%2C6.5-2.6c1.7-1.7%2C2.7-4.1%2C2.7-6.5c0-2.4-1-4.8-2.7-6.5%20%20%20%20%20c-1.7-1.7-4.1-2.7-6.5-2.7s-4.7%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.5C164.4%2C264.4%2C166.8%2C265.4%2C169.2%2C265.4z%22%20id%3D%22XMLID_797_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M247.7%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C243.7%2C265.4%2C247.7%2C261.3%2C247.7%2C256.3z%22%20id%3D%22XMLID_798_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M213%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C208.9%2C265.4%2C213%2C261.3%2C213%2C256.3z%22%20id%3D%22XMLID_799_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M317.2%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C313.1%2C265.4%2C317.2%2C261.3%2C317.2%2C256.3z%22%20id%3D%22XMLID_800_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M282.5%2C256.3c0-5-4.1-9.1-9.1-9.1s-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20S282.5%2C261.3%2C282.5%2C256.3z%22%20id%3D%22XMLID_801_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M401.1%2C185.2c0.9%2C0%2C1.9-0.1%2C2.8-0.5c4.8-1.6%2C7.4-6.7%2C5.9-11.5c-1.6-4.8-6.7-7.4-11.5-5.8%20%20%20%20%20c-4.8%2C1.6-7.4%2C6.7-5.8%2C11.5C393.6%2C182.8%2C397.2%2C185.2%2C401.1%2C185.2z%22%20id%3D%22XMLID_802_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M403.9%2C205.2c-4.8-1.6-9.9%2C1-11.5%2C5.9l0%2C0c-1.6%2C4.8%2C1.1%2C9.9%2C5.9%2C11.5%20%20%20%20%20c0.9%2C0.3%2C1.9%2C0.5%2C2.8%2C0.5c3.9%2C0%2C7.4-2.5%2C8.7-6.3c0%2C0%2C0%2C0%2C0%2C0C411.3%2C211.9%2C408.7%2C206.8%2C403.9%2C205.2z%22%20id%3D%22XMLID_803_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C237.2L373.5%2C237.2c-4.1%2C3-5%2C8.7-2%2C12.8c1.8%2C2.4%2C4.6%2C3.7%2C7.4%2C3.7%20%20%20%20%20c1.8%2C0%2C3.7-0.6%2C5.4-1.8c4.1-3%2C4.9-8.7%2C2-12.8C383.3%2C235.1%2C377.6%2C234.2%2C373.5%2C237.2z%22%20id%3D%22XMLID_804_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C152.9c1.6%2C1.2%2C3.5%2C1.8%2C5.4%2C1.8c2.8%2C0%2C5.6-1.3%2C7.4-3.8c3-4.1%2C2.1-9.8-2-12.7%20%20%20%20%20c-4.1-3-9.8-2.1-12.7%2C2C368.5%2C144.2%2C369.4%2C149.9%2C373.5%2C152.9z%22%20id%3D%22XMLID_805_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M342.8%2C247.1c-2.4%2C0-4.8%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.4%20%20%20%20%20c1.7%2C1.7%2C4%2C2.7%2C6.5%2C2.7c2.4%2C0%2C4.7-1%2C6.5-2.7c1.7-1.7%2C2.7-4%2C2.7-6.4c0-2.4-1-4.8-2.7-6.5C347.6%2C248.1%2C345.2%2C247.1%2C342.8%2C247.1z%22%20id%3D%22XMLID_806_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M342.8%2C124.7H206.6l36.4-36.4c3.6-3.6%2C3.6-9.3%2C0-12.9c-3.6-3.6-9.3-3.6-12.9%2C0l-51.5%2C51.5%20%20%20%20%20c-1.9%2C1.9-2.8%2C4.4-2.7%2C6.9c-0.1%2C2.5%2C0.7%2C5%2C2.7%2C6.9l51.5%2C51.5c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7%20%20%20%20%20c3.6-3.6%2C3.6-9.3%2C0-12.9l-36.4-36.4h136.1c0%2C0%2C0.1%2C0%2C0.1%2C0c0.6%2C0%2C1.2-0.1%2C1.8-0.2c0.2%2C0%2C0.4-0.1%2C0.6-0.1c0.1%2C0%2C0.2%2C0%2C0.3-0.1%20%20%20%20%20c3.2-1%2C5.6-3.6%2C6.3-6.9c0.1-0.6%2C0.2-1.2%2C0.2-1.8c0-0.6-0.1-1.2-0.2-1.8C351%2C127.8%2C347.3%2C124.7%2C342.8%2C124.7z%22%20id%3D%22XMLID_807_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M322.1%2C371.3l-51.5-51.5c-3.6-3.6-9.3-3.6-12.9%2C0c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9l36.9%2C36.9H169.2%20%20%20%20%20c-2.8%2C0-5.4%2C1.3-7%2C3.3c-0.1%2C0.1-0.2%2C0.2-0.3%2C0.4c-0.1%2C0.1-0.2%2C0.2-0.2%2C0.3c-0.1%2C0.1-0.1%2C0.2-0.2%2C0.4c-0.1%2C0.1-0.2%2C0.3-0.2%2C0.4%20%20%20%20%20c0%2C0.1-0.1%2C0.2-0.1%2C0.2c-0.1%2C0.2-0.2%2C0.4-0.3%2C0.6c0%2C0%2C0%2C0%2C0%2C0.1c-0.4%2C1.1-0.7%2C2.2-0.7%2C3.4c0%2C1.5%2C0.4%2C2.9%2C1%2C4.2c0%2C0%2C0%2C0.1%2C0.1%2C0.1%20%20%20%20%20c0.1%2C0.1%2C0.1%2C0.2%2C0.2%2C0.3c0.4%2C0.7%2C0.9%2C1.3%2C1.4%2C1.8c0.4%2C0.4%2C0.7%2C0.7%2C1.2%2C1c0.1%2C0.1%2C0.1%2C0.1%2C0.2%2C0.2c0%2C0%2C0.1%2C0%2C0.1%2C0.1%20%20%20%20%20c1.4%2C0.9%2C3.1%2C1.5%2C5%2C1.5h124.4l-36%2C36c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7l51.5-51.5%20%20%20%20%20c1.9-1.9%2C2.8-4.4%2C2.7-6.9C324.8%2C375.7%2C324%2C373.2%2C322.1%2C371.3z%22%20id%3D%22XMLID_808_%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}
.x6-widget-handle-direction:hover {
  background-image: url("data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20%20PUBLIC%20'-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN'%20%20'http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd'%3E%3Csvg%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%20512%20512%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%20512%20512%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%09.st0%7Bfill%3A%23FD6EB6%3Bstroke%3A%23FD6EB6%3Bstroke-width%3A30%7D%0A%09.dot%7Bfill%3A%23FD6EB6%3B%7D%0A%3C%2Fstyle%3E%3Cg%3E%3Cg%20id%3D%22XMLID_475_%22%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M133.1%2C277.1c1.8%2C0%2C3.7-0.6%2C5.4-1.7c4.1-3%2C5-8.7%2C2-12.8c-3-4.1-8.7-5-12.8-2c0%2C0%2C0%2C0%2C0%2C0%20%20%20%20%20c-4.1%2C3-5%2C8.7-2%2C12.8C127.5%2C275.8%2C130.3%2C277.1%2C133.1%2C277.1z%22%20id%3D%22XMLID_489_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M138.5%2C359.6c-4.1-3-9.8-2.1-12.8%2C2c-3%2C4.1-2.1%2C9.8%2C2%2C12.8c1.6%2C1.2%2C3.5%2C1.7%2C5.4%2C1.7%20%20%20%20%20c2.8%2C0%2C5.6-1.3%2C7.4-3.7C143.5%2C368.3%2C142.6%2C362.6%2C138.5%2C359.6z%22%20id%3D%22XMLID_726_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C327.7c-4.8%2C1.6-7.4%2C6.7-5.9%2C11.5c1.3%2C3.9%2C4.8%2C6.3%2C8.7%2C6.3c0.9%2C0%2C1.9-0.1%2C2.8-0.4%20%20%20%20%20c4.8-1.6%2C7.4-6.7%2C5.9-11.5C118%2C328.8%2C112.9%2C326.2%2C108.1%2C327.7z%22%20id%3D%22XMLID_776_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C307.3c0.9%2C0.3%2C1.9%2C0.4%2C2.8%2C0.4c3.8%2C0%2C7.4-2.4%2C8.7-6.3c1.6-4.8-1.1-9.9-5.9-11.5%20%20%20%20%20c-4.8-1.6-9.9%2C1.1-11.5%2C5.9C100.7%2C300.6%2C103.3%2C305.7%2C108.1%2C307.3z%22%20id%3D%22XMLID_777_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M169.2%2C265.4c2.4%2C0%2C4.7-1%2C6.5-2.6c1.7-1.7%2C2.7-4.1%2C2.7-6.5c0-2.4-1-4.8-2.7-6.5%20%20%20%20%20c-1.7-1.7-4.1-2.7-6.5-2.7s-4.7%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.5C164.4%2C264.4%2C166.8%2C265.4%2C169.2%2C265.4z%22%20id%3D%22XMLID_797_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M247.7%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C243.7%2C265.4%2C247.7%2C261.3%2C247.7%2C256.3z%22%20id%3D%22XMLID_798_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M213%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C208.9%2C265.4%2C213%2C261.3%2C213%2C256.3z%22%20id%3D%22XMLID_799_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M317.2%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C313.1%2C265.4%2C317.2%2C261.3%2C317.2%2C256.3z%22%20id%3D%22XMLID_800_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M282.5%2C256.3c0-5-4.1-9.1-9.1-9.1s-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20S282.5%2C261.3%2C282.5%2C256.3z%22%20id%3D%22XMLID_801_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M401.1%2C185.2c0.9%2C0%2C1.9-0.1%2C2.8-0.5c4.8-1.6%2C7.4-6.7%2C5.9-11.5c-1.6-4.8-6.7-7.4-11.5-5.8%20%20%20%20%20c-4.8%2C1.6-7.4%2C6.7-5.8%2C11.5C393.6%2C182.8%2C397.2%2C185.2%2C401.1%2C185.2z%22%20id%3D%22XMLID_802_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M403.9%2C205.2c-4.8-1.6-9.9%2C1-11.5%2C5.9l0%2C0c-1.6%2C4.8%2C1.1%2C9.9%2C5.9%2C11.5%20%20%20%20%20c0.9%2C0.3%2C1.9%2C0.5%2C2.8%2C0.5c3.9%2C0%2C7.4-2.5%2C8.7-6.3c0%2C0%2C0%2C0%2C0%2C0C411.3%2C211.9%2C408.7%2C206.8%2C403.9%2C205.2z%22%20id%3D%22XMLID_803_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C237.2L373.5%2C237.2c-4.1%2C3-5%2C8.7-2%2C12.8c1.8%2C2.4%2C4.6%2C3.7%2C7.4%2C3.7%20%20%20%20%20c1.8%2C0%2C3.7-0.6%2C5.4-1.8c4.1-3%2C4.9-8.7%2C2-12.8C383.3%2C235.1%2C377.6%2C234.2%2C373.5%2C237.2z%22%20id%3D%22XMLID_804_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C152.9c1.6%2C1.2%2C3.5%2C1.8%2C5.4%2C1.8c2.8%2C0%2C5.6-1.3%2C7.4-3.8c3-4.1%2C2.1-9.8-2-12.7%20%20%20%20%20c-4.1-3-9.8-2.1-12.7%2C2C368.5%2C144.2%2C369.4%2C149.9%2C373.5%2C152.9z%22%20id%3D%22XMLID_805_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M342.8%2C247.1c-2.4%2C0-4.8%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.4%20%20%20%20%20c1.7%2C1.7%2C4%2C2.7%2C6.5%2C2.7c2.4%2C0%2C4.7-1%2C6.5-2.7c1.7-1.7%2C2.7-4%2C2.7-6.4c0-2.4-1-4.8-2.7-6.5C347.6%2C248.1%2C345.2%2C247.1%2C342.8%2C247.1z%22%20id%3D%22XMLID_806_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M342.8%2C124.7H206.6l36.4-36.4c3.6-3.6%2C3.6-9.3%2C0-12.9c-3.6-3.6-9.3-3.6-12.9%2C0l-51.5%2C51.5%20%20%20%20%20c-1.9%2C1.9-2.8%2C4.4-2.7%2C6.9c-0.1%2C2.5%2C0.7%2C5%2C2.7%2C6.9l51.5%2C51.5c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7%20%20%20%20%20c3.6-3.6%2C3.6-9.3%2C0-12.9l-36.4-36.4h136.1c0%2C0%2C0.1%2C0%2C0.1%2C0c0.6%2C0%2C1.2-0.1%2C1.8-0.2c0.2%2C0%2C0.4-0.1%2C0.6-0.1c0.1%2C0%2C0.2%2C0%2C0.3-0.1%20%20%20%20%20c3.2-1%2C5.6-3.6%2C6.3-6.9c0.1-0.6%2C0.2-1.2%2C0.2-1.8c0-0.6-0.1-1.2-0.2-1.8C351%2C127.8%2C347.3%2C124.7%2C342.8%2C124.7z%22%20id%3D%22XMLID_807_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M322.1%2C371.3l-51.5-51.5c-3.6-3.6-9.3-3.6-12.9%2C0c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9l36.9%2C36.9H169.2%20%20%20%20%20c-2.8%2C0-5.4%2C1.3-7%2C3.3c-0.1%2C0.1-0.2%2C0.2-0.3%2C0.4c-0.1%2C0.1-0.2%2C0.2-0.2%2C0.3c-0.1%2C0.1-0.1%2C0.2-0.2%2C0.4c-0.1%2C0.1-0.2%2C0.3-0.2%2C0.4%20%20%20%20%20c0%2C0.1-0.1%2C0.2-0.1%2C0.2c-0.1%2C0.2-0.2%2C0.4-0.3%2C0.6c0%2C0%2C0%2C0%2C0%2C0.1c-0.4%2C1.1-0.7%2C2.2-0.7%2C3.4c0%2C1.5%2C0.4%2C2.9%2C1%2C4.2c0%2C0%2C0%2C0.1%2C0.1%2C0.1%20%20%20%20%20c0.1%2C0.1%2C0.1%2C0.2%2C0.2%2C0.3c0.4%2C0.7%2C0.9%2C1.3%2C1.4%2C1.8c0.4%2C0.4%2C0.7%2C0.7%2C1.2%2C1c0.1%2C0.1%2C0.1%2C0.1%2C0.2%2C0.2c0%2C0%2C0.1%2C0%2C0.1%2C0.1%20%20%20%20%20c1.4%2C0.9%2C3.1%2C1.5%2C5%2C1.5h124.4l-36%2C36c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7l51.5-51.5%20%20%20%20%20c1.9-1.9%2C2.8-4.4%2C2.7-6.9C324.8%2C375.7%2C324%2C373.2%2C322.1%2C371.3z%22%20id%3D%22XMLID_808_%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}
.x6-widget-handle-surround .x6-widget-handle-animate .x6-widget-handle {
  transition: background-size 80ms, width 80ms, height 80ms, top 150ms, left 150ms, bottom 150ms, right 150ms;
}
.x6-widget-handle-surround .x6-widget-handle-pos-se {
  right: -25px;
  bottom: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-nw {
  top: -21px;
  left: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-n {
  top: -22px;
  left: 50%;
  margin-left: -10px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-e {
  top: -webkit-calc(40%);
  top: calc(50% - 10px);
  right: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-ne {
  top: -21px;
  right: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-w {
  top: 50%;
  left: -25px;
  margin-top: -10px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-sw {
  bottom: -25px;
  left: -25px;
}
.x6-widget-handle-surround .x6-widget-handle-pos-s {
  bottom: -24px;
  left: 50%;
  margin-left: -10px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle {
  width: 15px;
  height: 15px;
  font-size: 15px;
  background-size: 15px 15px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-se {
  right: -19px;
  bottom: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-nw {
  top: -19px;
  left: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-n {
  top: -19px;
  margin-left: -7.5px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-e {
  top: -webkit-calc(42%);
  top: calc(50% - 8px);
  right: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-ne {
  top: -19px;
  right: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-w {
  left: -19px;
  margin-top: -8px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-sw {
  bottom: -19px;
  left: -19px;
}
.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-s {
  bottom: -19px;
  margin-left: -7.5px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle {
  width: 10px;
  height: 10px;
  font-size: 10px;
  background-size: 10px 10px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-se {
  right: -15px;
  bottom: -13px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-nw {
  top: -13px;
  left: -15px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-n {
  top: -13px;
  margin-left: -5px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-e {
  top: -webkit-calc(45%);
  top: calc(50% - 5px);
  right: -15px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-ne {
  top: -13px;
  right: -15px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-w {
  left: -15px;
  margin-top: -5px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-sw {
  bottom: -13px;
  left: -15px;
}
.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-s {
  bottom: -13px;
  margin-left: -5px;
}
.x6-widget-handle-toolbar {
  position: absolute;
  top: -50px;
  display: table-row;
  padding: 7px 5px;
}
.x6-widget-handle-toolbar::after {
  position: absolute;
  top: 100%;
  left: 10px;
  width: 0;
  height: 0;
  margin-top: 4px;
  border-right: 10px solid transparent;
  border-left: 10px solid transparent;
  content: '';
}
.x6-widget-handle-toolbar .x6-widget-handle {
  position: relative;
  display: table-cell;
  min-width: 20px;
  margin: 0 2px;
  background-position: 3px 3px;
  background-size: 16px 16px;
}
.x6-widget-handle-toolbar .x6-widget-handle::after {
  position: absolute;
  bottom: -11px;
  width: 100%;
  content: '';
}
.x6-widget-handle-pie {
  position: absolute;
  top: -webkit-calc(0%);
  top: calc(50% - 50px);
  right: -50px;
  z-index: 1;
  display: none;
  width: 100px;
  height: 100px;
  margin: -2px -2px 0 0;
  border-radius: 50%;
  cursor: default;
  pointer-events: visiblePainted;
}
.x6-widget-handle-pie .x6-widget-handle {
  width: 1px;
  height: auto;
  pointer-events: visiblePainted;
}
.x6-widget-handle-pie-slice-svg {
  width: 100%;
  height: 100%;
  overflow: visible !important;
}
.x6-widget-handle-pie-slice-img,
.x6-widget-handle-pie-slice-txt {
  display: none;
  pointer-events: none;
}
.x6-widget-handle-pie[data-pie-toggle-position='e'] {
  top: calc(50% - 50px);
  right: -50px;
  left: auto;
}
.x6-widget-handle-pie[data-pie-toggle-position='w'] {
  top: calc(50% - 50px);
  right: auto;
  left: -52px;
}
.x6-widget-handle-pie[data-pie-toggle-position='n'] {
  top: -50px;
  right: auto;
  bottom: auto;
  left: calc(50% - 52px);
}
.x6-widget-handle-pie[data-pie-toggle-position='s'] {
  top: auto;
  right: auto;
  bottom: -52px;
  left: calc(50% - 52px);
}
.x6-widget-handle-pie-opened {
  display: block;
  animation: halo-pie-visibility 0.1s, halo-pie-opening 0.1s;
  animation-timing-function: step-end, ease;
  animation-delay: 0s, 0.1s;
}
.x6-widget-handle-pie-toggle {
  position: absolute;
  top: -webkit-calc(35%);
  top: calc(50% - 15px);
  right: -15px;
  z-index: 2;
  display: block;
  box-sizing: border-box;
  width: 30px;
  height: 30px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: 20px 20px;
  border-radius: 50%;
  cursor: pointer;
  user-select: none;
  pointer-events: visiblePainted;
  -webkit-user-drag: none;
  user-drag: none;
  /* stylelint-disable-line */
}
.x6-widget-handle-pie-toggle-pos-e {
  top: -webkit-calc(35%);
  top: calc(50% - 15px);
  right: -15px;
  bottom: auto;
  left: auto;
}
.x6-widget-handle-pie-toggle-pos-w {
  top: -webkit-calc(35%);
  top: calc(50% - 15px);
  right: auto;
  bottom: auto;
  left: -15px;
}
.x6-widget-handle-pie-toggle-pos-n {
  top: -15px;
  right: auto;
  bottom: auto;
  left: -webkit-calc(35%);
  left: calc(50% - 15px);
}
.x6-widget-handle-pie-toggle-pos-s {
  top: auto;
  right: auto;
  bottom: -15px;
  left: -webkit-calc(35%);
  left: calc(50% - 15px);
}
.x6-widget-handle-pie-toggle-opened {
  transition: 0.1s background-image;
}
.x6-widget-handle-toolbar {
  position: static;
  display: inline-block;
  margin-top: -50px;
  margin-left: 45px;
  white-space: nowrap;
  vertical-align: top;
  background-color: #f5f5f5;
  border-bottom: 3px solid #333;
  border-radius: 5px;
  box-shadow: 0 1px 2px #222;
}
.x6-widget-handle-toolbar::after {
  top: -12px;
  left: 55px;
  margin-top: 0;
  border-top: 6px solid #333;
  border-right: 10px solid transparent;
  border-left: 10px solid transparent;
}
.x6-widget-handle-toolbar .x6-widget-handle {
  display: inline-block;
  vertical-align: top;
}
.x6-widget-handle-toolbar .x6-widget-handle:hover::after {
  border-bottom: 4px solid #fc6cb8;
}
.x6-widget-handle-toolbar .x6-widget-handle-rotate {
  position: absolute;
  top: 100%;
  right: 100%;
  margin-top: 3px;
  margin-right: 6px;
}
.x6-widget-handle-toolbar .x6-widget-handle-remove:hover::after,
.x6-widget-handle-toolbar .x6-widget-handle-rotate:hover::after {
  border-bottom: none;
}
.x6-widget-handle-toolbar .x6-widget-handle + .x6-widget-handle {
  margin-left: 4px;
}
.x6-widget-handle-pie {
  box-sizing: content-box;
  background-color: #f5f5f5;
  border: 2px solid #404040;
}
.x6-widget-handle-pie-slice {
  fill: transparent;
  stroke: #e9e9e9;
  stroke-width: 1;
}
.x6-widget-handle-pie-slice:hover {
  fill: #fff;
}
.x6-widget-handle-pie-slice-img {
  display: block;
}
.x6-widget-handle-selected .x6-widget-handle-pie-slice {
  fill: #fff;
}
.x6-widget-handle-pie-toggle {
  background-color: #f6f6f6;
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20height%3D%2216px%22%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%2016%2016%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%2016%2016%22%20width%3D%2216px%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15%2C6h-5V1c0-0.55-0.45-1-1-1H7C6.45%2C0%2C6%2C0.45%2C6%2C1v5H1C0.45%2C6%2C0%2C6.45%2C0%2C7v2c0%2C0.55%2C0.45%2C1%2C1%2C1h5v5c0%2C0.55%2C0.45%2C1%2C1%2C1h2%20c0.55%2C0%2C1-0.45%2C1-1v-5h5c0.55%2C0%2C1-0.45%2C1-1V7C16%2C6.45%2C15.55%2C6%2C15%2C6z%22%2F%3E%3C%2Fsvg%3E');
  background-size: 16px 16px;
  border: 2px solid #3b425f;
}
.x6-widget-handle-pie-toggle:hover {
  background-color: #fff;
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20height%3D%2216px%22%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%2016%2016%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%2016%2016%22%20width%3D%2216px%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M15%2C6h-5V1c0-0.55-0.45-1-1-1H7C6.45%2C0%2C6%2C0.45%2C6%2C1v5H1C0.45%2C6%2C0%2C6.45%2C0%2C7v2c0%2C0.55%2C0.45%2C1%2C1%2C1h5v5c0%2C0.55%2C0.45%2C1%2C1%2C1h2%20c0.55%2C0%2C1-0.45%2C1-1v-5h5c0.55%2C0%2C1-0.45%2C1-1V7C16%2C6.45%2C15.55%2C6%2C15%2C6z%22%2F%3E%3C%2Fsvg%3E');
  border-color: #fd6eb6;
}
.x6-widget-handle-pie-toggle-opened {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20id%3D%22Layer_1%22%20xml%3Aspace%3D%22preserve%22%3E%3Cmetadata%20id%3D%22metadata9%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage%2Fsvg%2Bxml%3C%2Fdc%3Aformat%3E%3Cdc%3Atype%20rdf%3Aresource%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fdcmitype%2FStillImage%22%20%2F%3E%3Cdc%3Atitle%3E%3C%2Fdc%3Atitle%3E%3C%2Fcc%3AWork%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cdefs%20id%3D%22defs7%22%20%2F%3E%3Cpath%20d%3D%22M%2015%2C6%2010%2C6%20C%201.0301983%2C6.00505%2015.002631%2C6.011353%206%2C6%20L%201%2C6%20C%200.45%2C6%200%2C6.45%200%2C7%20l%200%2C2%20c%200%2C0.55%200.45%2C1%201%2C1%20l%205%2C0%20c%208.988585%2C-0.019732%20-5.02893401%2C-0.018728%204%2C0%20l%205%2C0%20c%200.55%2C0%201%2C-0.45%201%2C-1%20L%2016%2C7%20C%2016%2C6.45%2015.55%2C6%2015%2C6%20z%22%20id%3D%22path3%22%20style%3D%22fill%3A%236a6c8a%22%20%2F%3E%3C%2Fsvg%3E');
}
.x6-widget-handle-pie-toggle-opened:hover {
  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20id%3D%22Layer_1%22%20xml%3Aspace%3D%22preserve%22%3E%3Cmetadata%20id%3D%22metadata9%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage%2Fsvg%2Bxml%3C%2Fdc%3Aformat%3E%3Cdc%3Atype%20rdf%3Aresource%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fdcmitype%2FStillImage%22%20%2F%3E%3Cdc%3Atitle%3E%3C%2Fdc%3Atitle%3E%3C%2Fcc%3AWork%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cdefs%20id%3D%22defs7%22%20%2F%3E%3Cpath%20d%3D%22M%2015%2C6%2010%2C6%20C%201.0301983%2C6.00505%2015.002631%2C6.011353%206%2C6%20L%201%2C6%20C%200.45%2C6%200%2C6.45%200%2C7%20l%200%2C2%20c%200%2C0.55%200.45%2C1%201%2C1%20l%205%2C0%20c%208.988585%2C-0.019732%20-5.02893401%2C-0.018728%204%2C0%20l%205%2C0%20c%200.55%2C0%201%2C-0.45%201%2C-1%20L%2016%2C7%20C%2016%2C6.45%2015.55%2C6%2015%2C6%20z%22%20id%3D%22path3%22%20style%3D%22fill%3A%23FD6EB6%22%20%2F%3E%3C%2Fsvg%3E');
}
.x6-widget-dnd {
  position: absolute;
  top: -10000px;
  left: -10000px;
  z-index: 999999;
  display: none;
  cursor: move;
  opacity: 0.7;
  pointer-events: 'cursor';
}
.x6-widget-dnd.dragging {
  display: inline-block;
}
.x6-widget-dnd.dragging * {
  pointer-events: none !important;
}
.x6-widget-dnd .x6-graph {
  background: transparent;
  box-shadow: none;
}
.x6-widget-halo {
  position: absolute;
  pointer-events: none;
}
.x6-widget-halo-content {
  position: absolute;
  top: 100%;
  padding: 6px;
  font-size: 10px;
  line-height: 14px;
  text-align: center;
  border-radius: 6px;
}
.x6-widget-halo-handles + .x6-widget-halo-content {
  right: -20px;
  left: -20px;
  margin-top: 30px;
}
.x6-widget-halo-handles.x6-widget-handle-small + .x6-widget-halo-content {
  margin-top: 25px;
}
.x6-widget-halo-handles.x6-widget-handle-small + .x6-widget-halo-content {
  margin-top: 20px;
}
.x6-widget-halo-handles.x6-widget-handle-pie + .x6-widget-halo-content {
  right: 0;
  left: 0;
  margin-top: 10px;
}
.x6-widget-halo-content {
  color: #fff;
  background-color: #6a6b8a;
}
.x6-widget-halo.type-node .x6-widget-handle-toolbar .x6-widget-handle-remove {
  position: absolute;
  right: 100%;
  bottom: 100%;
  margin-right: 6px;
  margin-bottom: 3px;
}
.x6-widget-halo.type-edge .x6-widget-handle-surround .x6-widget-handle-remove {
  background-color: #fff;
  border-radius: 50%;
}
.x6-widget-halo.type-edge .x6-widget-handle-toolbar {
  margin-top: -60px;
  margin-left: -18px;
}
.x6-widget-halo.type-edge .x6-widget-handle-toolbar::after {
  top: -22px;
  left: -9px;
}
.x6-widget-minimap {
  position: relative;
  display: table-cell;
  box-sizing: border-box;
  overflow: hidden;
  text-align: center;
  vertical-align: middle;
  background-color: #fff;
  user-select: none;
}
.x6-widget-minimap .x6-graph {
  display: inline-block;
  box-shadow: 0 0 4px 0 #eee;
  cursor: pointer;
}
.x6-widget-minimap .x6-graph > svg {
  pointer-events: none;
  shape-rendering: optimizeSpeed;
}
.x6-widget-minimap .x6-graph .x6-node * {
  /* stylelint-disable-next-line */
  vector-effect: initial;
}
.x6-widget-minimap-viewport {
  position: absolute;
  box-sizing: content-box !important;
  margin: -2px 0 0 -2px;
  border: 2px solid #31d0c6;
  cursor: move;
}
.x6-widget-minimap-viewport-zoom {
  position: absolute;
  right: 0;
  bottom: 0;
  box-sizing: border-box;
  width: 12px;
  height: 12px;
  margin: 0 -6px -6px 0;
  background-color: #fff;
  border: 2px solid #31d0c6;
  border-radius: 50%;
  cursor: nwse-resize;
}
.x6-graph-scroller {
  position: relative;
  box-sizing: border-box;
  overflow: scroll;
  outline: none;
}
.x6-graph-scroller-content {
  position: relative;
}
.x6-graph-scroller-background {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-scroller .x6-graph {
  position: absolute;
  display: inline-block;
  margin: 0;
  box-shadow: none;
}
.x6-graph-scroller .x6-graph > svg {
  display: block;
}
.x6-graph-scroller.x6-graph-scroller-paged .x6-graph {
  box-shadow: 0 0 4px 0 #eee;
}
.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='false'] {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='true'] {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-graph-pagebreak {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-pagebreak-vertical {
  position: absolute;
  top: 0;
  bottom: 0;
  box-sizing: border-box;
  width: 1px;
  border-left: 1px dashed #bdbdbd;
}
.x6-graph-pagebreak-horizontal {
  position: absolute;
  right: 0;
  left: 0;
  box-sizing: border-box;
  height: 1px;
  border-top: 1px dashed #bdbdbd;
}
.x6-widget-selection {
  position: absolute;
  display: none;
  width: 0;
  height: 0;
  touch-action: none;
}
.x6-widget-selection-rubberband {
  display: block;
  overflow: visible;
  opacity: 0.3;
}
.x6-widget-selection-selected {
  display: block;
}
.x6-widget-selection-box {
  cursor: move;
}
.x6-widget-selection-inner[data-selection-length='0'],
.x6-widget-selection-inner[data-selection-length='1'] {
  display: none;
}
.x6-widget-selection-content {
  position: absolute;
  top: 100%;
  right: -20px;
  left: -20px;
  margin-top: 30px;
  padding: 6px;
  line-height: 14px;
  text-align: center;
  border-radius: 6px;
}
.x6-widget-selection-content:empty {
  display: none;
}
.x6-widget-selection-rubberband {
  background-color: #3498db;
  border: 2px solid #2980b9;
}
.x6-widget-selection-box {
  box-sizing: content-box !important;
  margin-top: -4px;
  margin-left: -4px;
  padding-right: 4px;
  padding-bottom: 4px;
  border: 2px dashed #feb663;
  box-shadow: 2px 2px 5px #d3d3d3;
}
.x6-widget-selection-inner {
  box-sizing: content-box !important;
  margin-top: -8px;
  margin-left: -8px;
  padding-right: 12px;
  padding-bottom: 12px;
  border: 2px solid #feb663;
  box-shadow: 2px 2px 5px #d3d3d3;
}
.x6-widget-selection-content {
  color: #fff;
  font-size: 10px;
  background-color: #6a6b8a;
}
.x6-widget-snapline {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  pointer-events: none;
}
.x6-widget-snapline-vertical,
.x6-widget-snapline-horizontal {
  stroke: #2ecc71;
  stroke-width: 1px;
}
.x6-widget-stencil {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-widget-stencil::after {
  position: absolute;
  top: 0;
  display: block;
  width: 100%;
  height: 20px;
  padding: 8px 0;
  line-height: 20px;
  text-align: center;
  opacity: 0;
  transition: top 0.1s linear, opacity 0.1s linear;
  content: ' ';
  pointer-events: none;
}
.x6-widget-stencil-content {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  height: auto;
  overflow-x: hidden;
  overflow-y: auto;
}
.x6-widget-stencil .x6-node [magnet]:not([magnet='passive']) {
  pointer-events: none;
}
.x6-widget-stencil-group {
  padding: 0;
  padding-bottom: 8px;
  overflow: hidden;
  user-select: none;
}
.x6-widget-stencil-group.collapsed {
  height: auto;
  padding-bottom: 0;
}
.x6-widget-stencil-group-title {
  position: relative;
  margin-top: 0;
  margin-bottom: 0;
  padding: 4px;
  cursor: pointer;
}
.x6-widget-stencil-title,
.x6-widget-stencil-group > .x6-widget-stencil-group-title {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  user-select: none;
}
.x6-widget-stencil .unmatched {
  opacity: 0.3;
}
.x6-widget-stencil .x6-node.unmatched {
  display: none;
}
.x6-widget-stencil-group.unmatched {
  display: none;
}
.x6-widget-stencil-search-text {
  position: relative;
  z-index: 1;
  box-sizing: border-box;
  width: 100%;
  height: 30px;
  max-height: 30px;
  line-height: 30px;
  outline: 0;
}
.x6-widget-stencil.not-found::after {
  opacity: 1;
  content: attr(data-not-found-text);
}
.x6-widget-stencil.not-found.searchable::after {
  top: 30px;
}
.x6-widget-stencil.not-found.searchable.collapsable::after {
  top: 50px;
}
.x6-widget-stencil {
  color: #333;
  background: #f5f5f5;
}
.x6-widget-stencil-content {
  position: absolute;
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-content {
  top: 32px;
}
.x6-widget-stencil.searchable > .x6-widget-stencil-content {
  top: 80px;
}
.x6-widget-stencil.not-found::after {
  position: absolute;
}
.x6-widget-stencil.not-found.searchable.collapsable::after {
  top: 80px;
}
.x6-widget-stencil.not-found.searchable::after {
  top: 60px;
}
.x6-widget-stencil-group {
  height: auto;
  margin-bottom: 1px;
  padding: 0;
  transition: none;
}
.x6-widget-stencil-group .x6-graph {
  background: transparent;
  box-shadow: none;
}
.x6-widget-stencil-group.collapsed {
  height: auto;
  max-height: 31px;
}
.x6-widget-stencil-title,
.x6-widget-stencil-group > .x6-widget-stencil-group-title {
  position: relative;
  left: 0;
  box-sizing: border-box;
  width: 100%;
  height: 32px;
  padding: 0 5px 0 8px;
  color: #666;
  font-weight: 700;
  font-size: 12px;
  line-height: 32px;
  cursor: default;
  transition: all 0.3;
}
.x6-widget-stencil-title:hover,
.x6-widget-stencil-group > .x6-widget-stencil-group-title:hover {
  color: #444;
}
.x6-widget-stencil-title {
  background: #e9e9e9;
}
.x6-widget-stencil-group > .x6-widget-stencil-group-title {
  background: #ededed;
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-title,
.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title {
  padding-left: 32px;
  cursor: pointer;
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-title::before,
.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title::before {
  position: absolute;
  top: 6px;
  left: 8px;
  display: block;
  width: 18px;
  height: 18px;
  margin: 0;
  padding: 0;
  background-color: transparent;
  background-repeat: no-repeat;
  background-position: 0 0;
  border: none;
  content: ' ';
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-title::before,
.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title::before {
  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOS4zNzUuNUM0LjY4Ny41Ljg3NSA0LjMxMy44NzUgOWMwIDQuNjg4IDMuODEyIDguNSA4LjUgOC41IDQuNjg3IDAgOC41LTMuODEyIDguNS04LjUgMC00LjY4Ny0zLjgxMy04LjUtOC41LTguNXptMCAxNS44ODZDNS4zMDMgMTYuMzg2IDEuOTkgMTMuMDcyIDEuOTkgOXMzLjMxMi03LjM4NSA3LjM4NS03LjM4NVMxNi43NiA0LjkyOCAxNi43NiA5YzAgNC4wNzItMy4zMTMgNy4zODYtNy4zODUgNy4zODZ6Ii8+PHBhdGggZD0iTTEyLjc1MyA4LjQ0M0g1Ljk5N2EuNTU4LjU1OCAwIDAwMCAxLjExNmg2Ljc1NmEuNTU4LjU1OCAwIDAwMC0xLjExNnoiLz48L2c+PC9zdmc+');
  opacity: 0.4;
  transition: all 0.3s;
}
.x6-widget-stencil.collapsable > .x6-widget-stencil-title:hover::before,
.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title:hover::before {
  opacity: 0.6;
}
.x6-widget-stencil.collapsable.collapsed > .x6-widget-stencil-title::before,
.x6-widget-stencil-group.collapsable.collapsed > .x6-widget-stencil-group-title::before {
  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOS4zNzUuNUM0LjY4Ny41Ljg3NSA0LjMxMy44NzUgOWMwIDQuNjg4IDMuODEyIDguNSA4LjUgOC41IDQuNjg3IDAgOC41LTMuODEyIDguNS04LjUgMC00LjY4Ny0zLjgxMy04LjUtOC41LTguNXptMCAxNS44ODZDNS4zMDMgMTYuMzg2IDEuOTkgMTMuMDcyIDEuOTkgOXMzLjMxMi03LjM4NSA3LjM4NS03LjM4NVMxNi43NiA0LjkyOCAxNi43NiA5YzAgNC4wNzItMy4zMTMgNy4zODYtNy4zODUgNy4zODZ6Ii8+PHBhdGggZD0iTTEyLjc1MyA4LjQ0M0g1Ljk5N2EuNTU4LjU1OCAwIDAwMCAxLjExNmg2Ljc1NmEuNTU4LjU1OCAwIDAwMC0xLjExNnoiLz48cGF0aCBkPSJNOC44MTcgNS42MjN2Ni43NTZhLjU1OC41NTggMCAwMDEuMTE2IDBWNS42MjNhLjU1OC41NTggMCAxMC0xLjExNiAweiIvPjwvZz48L3N2Zz4=');
  opacity: 0.4;
}
.x6-widget-stencil.collapsable.collapsed > .x6-widget-stencil-title:hover::before,
.x6-widget-stencil-group.collapsable.collapsed > .x6-widget-stencil-group-title:hover::before {
  opacity: 0.6;
}
.x6-widget-stencil input[type='search'] {
  -webkit-appearance: textfield;
}
.x6-widget-stencil input[type='search']::-webkit-search-cancel-button,
.x6-widget-stencil input[type='search']::-webkit-search-decoration {
  -webkit-appearance: none;
}
.x6-widget-stencil-search-text {
  display: block;
  width: 90%;
  margin: 8px 5%;
  padding-left: 8px;
  color: #333;
  background: #fff;
  border: 1px solid #e9e9e9;
  border-radius: 12px;
  outline: 0;
}
.x6-widget-stencil-search-text:focus {
  outline: 0;
}
.x6-widget-stencil::after {
  color: #808080;
  font-weight: 600;
  font-size: 12px;
  background: 0 0;
}
.x6-widget-transform {
  position: absolute;
  box-sizing: content-box !important;
  margin: -5px 0 0 -5px;
  padding: 4px;
  border: 1px dashed #000;
  border-radius: 5px;
  user-select: none;
  pointer-events: none;
}
.x6-widget-transform > div {
  position: absolute;
  box-sizing: border-box;
  background-color: #fff;
  border: 1px solid #000;
  transition: background-color 0.2s;
  pointer-events: auto;
  -webkit-user-drag: none;
  user-drag: none;
  /* stylelint-disable-line */
}
.x6-widget-transform > div:hover {
  background-color: #d3d3d3;
}
.x6-widget-transform-cursor-n {
  cursor: n-resize;
}
.x6-widget-transform-cursor-s {
  cursor: s-resize;
}
.x6-widget-transform-cursor-e {
  cursor: e-resize;
}
.x6-widget-transform-cursor-w {
  cursor: w-resize;
}
.x6-widget-transform-cursor-ne {
  cursor: ne-resize;
}
.x6-widget-transform-cursor-nw {
  cursor: nw-resize;
}
.x6-widget-transform-cursor-se {
  cursor: se-resize;
}
.x6-widget-transform-cursor-sw {
  cursor: sw-resize;
}
.x6-widget-transform-resize {
  width: 10px;
  height: 10px;
  border-radius: 6px;
}
.x6-widget-transform-resize[data-position='top-left'] {
  top: -5px;
  left: -5px;
}
.x6-widget-transform-resize[data-position='top-right'] {
  top: -5px;
  right: -5px;
}
.x6-widget-transform-resize[data-position='bottom-left'] {
  bottom: -5px;
  left: -5px;
}
.x6-widget-transform-resize[data-position='bottom-right'] {
  right: -5px;
  bottom: -5px;
}
.x6-widget-transform-resize[data-position='top'] {
  top: -5px;
  left: 50%;
  margin-left: -5px;
}
.x6-widget-transform-resize[data-position='bottom'] {
  bottom: -5px;
  left: 50%;
  margin-left: -5px;
}
.x6-widget-transform-resize[data-position='left'] {
  top: 50%;
  left: -5px;
  margin-top: -5px;
}
.x6-widget-transform-resize[data-position='right'] {
  top: 50%;
  right: -5px;
  margin-top: -5px;
}
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='top'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='bottom'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='left'],
.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='right'] {
  display: none;
}
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='bottom'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='left'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='right'],
.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='top'] {
  display: none;
}
.x6-widget-transform.no-resize .x6-widget-transform-resize {
  display: none;
}
.x6-widget-transform-rotate {
  top: -20px;
  left: -20px;
  width: 12px;
  height: 12px;
  border-radius: 6px;
  cursor: crosshair;
}
.x6-widget-transform.no-rotate .x6-widget-transform-rotate {
  display: none;
}
.x6-widget-transform-active {
  border-color: transparent;
  pointer-events: all;
}
.x6-widget-transform-active > div {
  display: none;
}
.x6-widget-transform-active > .x6-widget-transform-active-handle {
  display: block;
  background-color: #808080;
}
.x6-widget-knob {
  position: absolute;
  box-sizing: border-box;
  width: 16px;
  height: 16px;
  margin-top: -8px;
  margin-left: -8px;
  cursor: pointer;
  user-select: none;
}
.x6-widget-knob::before,
.x6-widget-knob::after {
  position: absolute;
  transform: rotate(45deg);
  content: '';
}
.x6-widget-knob::before {
  top: 4px;
  left: 4px;
  box-sizing: border-box;
  width: 8px;
  height: 8px;
  background-color: #fff;
}
.x6-widget-knob::after {
  top: 5px;
  left: 5px;
  box-sizing: border-box;
  width: 6px;
  height: 6px;
  background-color: #fca000;
}
.x6-graph-print {
  position: relative;
}
.x6-graph-print .x6-graph-print-ready {
  display: none;
}
.x6-graph-print .x6-graph-print-preview {
  overflow: hidden !important;
  background: #fff !important;
}
@media print {
  html,
  html > body.x6-graph-printing {
    position: relative !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  html > body.x6-graph-printing > * {
    display: none !important;
  }
  html > body.x6-graph-printing > .x6-graph-print {
    display: block !important;
  }
  .x6-graph-print {
    top: 0 !important;
    left: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
    page-break-after: always;
    background: #fff !important;
  }
  .x6-graph-print .x6-graph-print-ready {
    display: none;
  }
}
.x6-cell-tool-editor {
  position: relative;
  display: inline-block;
  min-height: 1em;
  margin: 0;
  padding: 0;
  line-height: 1;
  white-space: normal;
  text-align: center;
  vertical-align: top;
  overflow-wrap: normal;
  outline: none;
  transform-origin: 0 0;
  -webkit-user-drag: none;
}
.x6-edge-tool-editor {
  border: 1px solid #275fc5;
  border-radius: 2px;
}
`;var qx=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class ku extends Di{init(){Hs.autoInsertCSS&&ku.ensure()}dispose(){ku.clean()}}qx([ku.dispose()],ku.prototype,"dispose",null),function(c){let e,t=0;function i(){if(t+=1,!(t>1)&&!xt.isApplyingHMR()){e=document.createElement("style"),e.setAttribute("type","text/css"),e.textContent=Kx;const d=document.querySelector("head");d&&d.insertBefore(e,d.firstChild)}}c.ensure=i;function a(){t-=1,!(t>0)&&(e&&e.parentNode&&e.parentNode.removeChild(e),e=null)}c.clean=a}(ku||(ku={}));var Cy=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Gd{get handleClassName(){return _i.handle}get pie(){return Object.assign(Object.assign({},Gd.defaultPieOptions),this.handleOptions.pie)}initHandles(){if(this.handles=[],this.handleOptions.handles&&this.handleOptions.handles.forEach(e=>this.addHandle(e)),this.handleOptions.type==="pie"){if(this.pie.toggles){const e=_i.pieToggle;this.$pieToggles={},this.pie.toggles.forEach(t=>{const i=this.$("<div/>");this.applyAttrs(i,t.attrs),i.addClass(e).addClass(`${e}-pos-${t.position||"e"}`).attr("data-name",t.name).appendTo(this.container),this.$pieToggles[t.name]=i})}this.setPieIcons()}if(this.$handleContainer){const e=this.handleOptions.type||"surround";this.$handleContainer.addClass(_i.wrap).addClass(_i.animate).addClass(`${_i.handle}-${e}`)}this.delegateEvents({[`mousedown .${_i.handle}`]:"onHandleMouseDown",[`touchstart .${_i.handle}`]:"onHandleMouseDown",[`mousedown .${_i.pieToggle}`]:"onPieToggleMouseDown",[`touchstart .${_i.pieToggle}`]:"onPieToggleMouseDown"})}onHandleMouseDown(e){const t=this.$(e.currentTarget).closest(`.${_i.handle}`).attr("data-action");t&&(e.preventDefault(),e.stopPropagation(),this.setEventData(e,{action:t,clientX:e.clientX,clientY:e.clientY,startX:e.clientX,startY:e.clientY}),e.type==="mousedown"&&e.button===2?this.triggerHandleAction(t,"contextmenu",e):(this.triggerHandleAction(t,"mousedown",e),this.delegateDocumentEvents({mousemove:"onHandleMouseMove",touchmove:"onHandleMouseMove",mouseup:"onHandleMouseUp",touchend:"onHandleMouseUp",touchcancel:"onHandleMouseUp"},e.data)))}onHandleMouseMove(e){const i=this.getEventData(e).action;i&&this.triggerHandleAction(i,"mousemove",e)}onHandleMouseUp(e){const i=this.getEventData(e).action;i&&(this.triggerHandleAction(i,"mouseup",e),this.undelegateDocumentEvents())}triggerHandleAction(e,t,i,a){i.preventDefault(),i.stopPropagation();const d=this.normalizeEvent(i),f=this.getEventData(d),m=this.graph.snapToGrid(d.clientX,d.clientY),y=this.graph.snapToGrid(f.clientX,f.clientY),x=m.x-y.x,E=m.y-y.y;this.trigger(`action:${e}:${t}`,Object.assign({e:d,dx:x,dy:E,x:m.x,y:m.y,offsetX:i.clientX-f.startX,offsetY:i.clientY-f.startY},a)),f.clientX=i.clientX,f.clientY=i.clientY}onPieToggleMouseDown(e){e.stopPropagation();const t=this.$(e.target).closest(`.${_i.pieToggle}`).attr("data-name");this.isOpen(t)||this.isOpen()&&this.toggleState(),this.toggleState(t)}setPieIcons(){this.handleOptions.type==="pie"&&this.$handleContainer.find(`.${_i.handle}`).each((e,t)=>{const i=this.$(t),a=i.attr("data-action"),d=_i.pieSlice,f=this.getHandle(a);if(!f||!f.icon){const m=window.getComputedStyle(t,":before").getPropertyValue("content");if(m&&m!=="none"){const x=i.find(`.${d}-txt`);x.length&&In.create(x[0]).text(m.replace(/['"]/g,""))}const y=i.css("background-image");if(y){const x=y.match(/url\(['"]?([^'"]+)['"]?\)/);if(x){const E=x[1],S=i.find(`.${d}-img`);S.length>0&&In.create(S[0]).attr("xlink:href",E)}}}})}getHandleIdx(e){return this.handles.findIndex(t=>t.name===e)}hasHandle(e){return this.getHandleIdx(e)>=0}getHandle(e){return this.handles.find(t=>t.name===e)}renderHandle(e){const t=this.$("<div/>").addClass(`${_i.handle} ${_i.handle}-${e.name}`).attr("data-action",e.name).prop("draggable",!1);if(this.handleOptions.type==="pie"){const i=this.getHandleIdx(e.name),a=this.pie,d=a.outerRadius,f=a.innerRadius,m=(d+f)/2,y=new Oe(d,d),x=ri.toRad(a.sliceAngle),E=i*x+ri.toRad(a.startAngle),S=E+x,T=Qb(f,d,E,S),R=In.create("svg").addClass(`${_i.pieSlice}-svg`),V=In.create("path").addClass(_i.pieSlice).attr("d",T).translate(d,d),j=Oe.fromPolar(m,-E-x/2,y).toJSON(),q=a.iconSize,ue=In.create("image").attr(j).addClass(`${_i.pieSlice}-img`);j.y=j.y+q-2;const be=In.create("text",{"font-size":q}).attr(j).addClass(`${_i.pieSlice}-txt`);ue.attr({width:q,height:q}),ue.translate(-q/2,-q/2),be.translate(-q/2,-q/2),R.append([V,ue,be]),t.append(R.node)}else t.addClass(`${_i.handle}-pos-${e.position}`),e.content&&(typeof e.content=="string"?t.html(e.content):t.append(e.content));return this.updateHandleIcon(t,e.icon),this.applyAttrs(t,e.attrs),t}addHandle(e){if(!this.hasHandle(e.name)){this.handles.push(e);const t=e.events;t&&Object.keys(t).forEach(i=>{const a=t[i],d=`action:${e.name}:${i}`;typeof a=="string"?this.on(d,this[a],this):this.on(d,a)}),this.$handleContainer&&this.$handleContainer.append(this.renderHandle(e))}return this}addHandles(e){return e.forEach(t=>this.addHandle(t)),this}removeHandles(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this}removeHandle(e){const t=this.getHandleIdx(e),i=this.handles[t];return i&&(i.events&&Object.keys(i.events).forEach(a=>{this.off(`action:${e}:${a}`)}),this.getHandleElem(e).remove(),this.handles.splice(t,1)),this}changeHandle(e,t){const i=this.getHandle(e);return i&&(this.removeHandle(e),this.addHandle(Object.assign(Object.assign({},i),t))),this}toggleHandle(e,t){const i=this.getHandle(e);if(i){const a=this.getHandleElem(e),d=`${_i.handle}-selected`;t===void 0&&(t=!a.hasClass(d)),a.toggleClass(d,t);const f=t?i.iconSelected:i.icon;f&&this.updateHandleIcon(a,f)}return this}selectHandle(e){return this.toggleHandle(e,!0)}deselectHandle(e){return this.toggleHandle(e,!1)}deselectAllHandles(){return this.handles.forEach(e=>this.deselectHandle(e.name)),this}getHandleElem(e){return this.$handleContainer.find(`.${_i.handle}-${e}`)}updateHandleIcon(e,t){if(this.handleOptions.type==="pie"){const i=e.find(`.${_i.pieSliceImg}`);this.$(i[0]).attr("xlink:href",t||"")}else e.css("background-image",t?`url(${t})`:"")}isRendered(){return this.$handleContainer!=null}isOpen(e){return this.isRendered()?e?this.$pieToggles[e].hasClass(_i.pieToggleOpened):this.$handleContainer.hasClass(`${_i.pieOpended}`):!1}toggleState(e){if(this.isRendered()){const t=this.$handleContainer;if(Object.keys(this.$pieToggles).forEach(i=>{this.$pieToggles[i].removeClass(_i.pieToggleOpened)}),this.isOpen())this.trigger("pie:close",{name:e}),t.removeClass(_i.pieOpended);else{if(this.trigger("pie:open",{name:e}),e){const i=this.pie.toggles,a=i&&i.find(d=>d.name===e);a&&t.attr({"data-pie-toggle-name":a.name,"data-pie-toggle-position":a.position}),this.$pieToggles[e].addClass(_i.pieToggleOpened)}t.addClass(_i.pieOpended)}}}applyAttrs(e,t){if(t){const i=ii.$(e);Object.keys(t).forEach(a=>{const d=i.find(a).addBack().filter(a),f=t[a],{class:m}=f,y=Cy(f,["class"]);m&&d.addClass(m),d.attr(y)})}}}(function(c){c.defaultPieOptions={innerRadius:20,outerRadius:50,sliceAngle:45,startAngle:0,iconSize:14,toggles:[{name:"default",position:"e"}]}})(Gd||(Gd={}));var _i;(function(c){c.handle=ii.prototype.prefixClassName("widget-handle"),c.wrap=`${c.handle}-wrap`,c.animate=`${c.handle}-animate`,c.pieOpended=`${c.handle}-pie-opened`,c.pieToggle=`${c.handle}-pie-toggle`,c.pieToggleOpened=`${c.handle}-pie-toggle-opened`,c.pieSlice=`${c.handle}-pie-slice`,c.pieSliceImg=`${c.handle}-pie-slice-img`})(_i||(_i={}));var Jx=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},Qx=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class fp extends ii{constructor(e){super();const t=e,{view:i,cell:a,node:d,edge:f,graph:m}=t,y=Qx(t,["view","cell","node","edge","graph"]);i?(this.view=i,this.cell=i.cell,this.graph=i.graph,this.model=this.graph.model):(a||f||d)&&m&&(this.cell=d||f||a,this.view=m.renderer.findViewByCell(this.cell),this.graph=m,this.model=this.graph.model);const x=this.constructor;e.clearAll!==!1&&x.removeInstances(this.graph),x.register(this),this.init(y)}static ensureCache(){return this.instanceCache.has(this)||this.instanceCache.set(this,{}),this.instanceCache.get(this)}static register(e,t){t==null&&(t=e.graph);const i=this.ensureCache();let a=i[t.view.cid];a==null&&(a=i[t.view.cid]={}),a[e.cid]=e}static unregister(e,t){t==null&&(t=e.graph);const i=this.ensureCache();i[t.view.cid]&&delete i[t.view.cid][e.cid]}static removeInstances(e){const i=this.ensureCache()[e.view.cid];i&&Object.keys(i).forEach(a=>{const d=i[a];d&&d.remove()})}static getInstances(e){return this.ensureCache()[e.view.cid]||{}}init(e){}render(){return this}startListening(){this.options.clearOnBlankMouseDown!==!1&&this.graph.on("blank:mousedown",this.remove,this)}stopListening(){this.options.clearOnBlankMouseDown!==!1&&this.graph.off("blank:mousedown",this.remove,this)}remove(){return this.stopListening(),this.constructor.unregister(this),super.remove()}dispose(){this.remove()}}fp.instanceCache=new WeakMap,Jx([ii.dispose()],fp.prototype,"dispose",null);class wy extends fp{get node(){return this.cell}get metadata(){const e=this.cell.prop("knob");return Array.isArray(e)?this.options.index!=null?e[this.options.index]:null:e}init(e){this.options=Object.assign({},e),this.render(),this.startListening()}startListening(){this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.model.on("reseted",this.remove,this),this.node.on("removed",this.remove,this),this.view.on("node:resize:mousedown",this.onTransform,this),this.view.on("node:rotate:mousedown",this.onTransform,this),this.view.on("node:resize:mouseup",this.onTransformed,this),this.view.on("node:rotate:mouseup",this.onTransformed,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this),super.startListening()}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.model.off("reseted",this.remove,this),this.node.off("removed",this.remove,this),this.view.off("node:resize:mousedown",this.onTransform,this),this.view.off("node:rotate:mousedown",this.onTransform,this),this.view.off("node:resize:mouseup",this.onTransformed,this),this.view.off("node:rotate:mouseup",this.onTransformed,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this),super.stopListening()}render(){return this.container=document.createElement("div"),vi(this.container,this.prefixClassName("widget-knob")),this.options.className&&vi(this.container,this.options.className),this.view.addClass(Bd.KNOB),this.graph.container.appendChild(this.container),this.update(),this}remove(){return this.view.removeClass(Bd.KNOB),super.remove()}update(){if(this.metadata){const{update:e,position:t}=this.metadata,i={knob:this,cell:this.cell,node:this.node};if(t){const a=t.call(this.graph,Object.assign({},i));if(a){const d=this.graph.matrix(),f=this.node.getBBox(),m=ri.normalize(this.node.getAngle()),y=Oe.create(a);m!==0&&y.rotate(-m,{x:f.width/2,y:f.height/2}),y.translate(f).scale(d.a,d.d).translate(d.e,d.f),this.container.style.left=`${y.x}px`,this.container.style.top=`${y.y}px`}}e&&e.call(this.graph,Object.assign({},i))}}hide(){this.container.style.display="none"}show(){this.container.style.display=""}onTransform(){this.hide()}onTransformed(){this.show()}onKnobMouseDown({knob:e}){this.cid!==e.cid&&this.hide()}onKnobMouseUp(){this.show()}notify(e,t){if(this.view){const i=this.view.normalizeEvent(t),a=this.graph.snapToGrid(i.clientX,i.clientY);this.view.notify(`cell:${e}`,{e:i,view:this.view,node:this.node,cell:this.cell,x:a.x,y:a.y,knob:this}),this.cell.isNode()?this.view.notify(`node:${e}`,{e:i,view:this.view,node:this.node,cell:this.cell,x:a.x,y:a.y,knob:this}):this.cell.isEdge()&&this.view.notify(`edge:${e}`,{e:i,view:this.view,edge:this.cell,cell:this.cell,x:a.x,y:a.y,knob:this})}}onMouseDown(e){e.stopPropagation(),this.setEventData(e,{knobbing:!1,originX:e.clientX,originY:e.clientY,clientX:e.clientX,clientY:e.clientY}),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(Bd.documentEvents,e.data),this.metadata&&this.metadata.onMouseDown&&this.metadata.onMouseDown.call(this.graph,{e,data:this.getEventData(e),knob:this,cell:this.cell,node:this.node}),this.notify("knob:mousedown",e)}onMouseMove(e){const t=this.getEventData(e),i=this.graph.findViewByCell(this.node);if(t.knobbing||(t.knobbing=!0,i&&(i.addClass(Bd.KNOBBING),this.notify("knob",e)),this.model.startBatch("knob",{cid:this.cid})),t.clientX=e.clientX,t.clientY=e.clientY,this.metadata&&this.metadata.onMouseMove){const a=this.graph.matrix(),d=(e.clientX-t.originX)/a.a,f=(e.clientY-t.originY)/a.d,m=this.node.getAngle(),y=new Oe(d,f).rotate(m);this.metadata.onMouseMove.call(this.graph,{e,data:t,deltaX:y.x,deltaY:y.y,knob:this,cell:this.cell,node:this.node})}this.notify("knobbing",e),this.notify("knob:mousemove",e)}onMouseUp(e){this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const t=this.getEventData(e),i=this.graph.findViewByCell(this.node);t.knobbing&&(i&&i.removeClass(Bd.KNOBBING),this.metadata&&this.metadata.onMouseUp&&this.metadata.onMouseUp.call(this.graph,{e,data:t,knob:this,cell:this.cell,node:this.node}),this.model.stopBatch("knob",{cid:this.cid}),this.notify("knobbed",e)),this.notify("knob:mouseup",e)}}var Bd;(function(c){c.KNOB="has-widget-knob",c.KNOBBING="node-knobbing",c.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"}})(Bd||(Bd={}));var eC=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},pp;(function(c){c.root="widget-minimap",c.viewport=`${c.root}-viewport`,c.zoom=`${c.viewport}-zoom`})(pp||(pp={}));class Ey extends ii{constructor(e){super(),this.options=Object.assign(Object.assign({},Ng.defaultOptions),e),this.updateViewport=dv.Z(this.updateViewport.bind(this),0),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(pp.root));const t=document.createElement("div");this.container.appendChild(t),this.$viewport=this.$("<div>").addClass(this.prefixClassName(pp.viewport)),this.options.scalable&&(this.zoomHandle=this.$("<div>").addClass(this.prefixClassName(pp.zoom)).appendTo(this.$viewport).get(0)),this.$container.append(this.$viewport).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.options.container&&this.options.container.appendChild(this.container),this.sourceGraph=this.graph;const i=Object.assign(Object.assign({},this.options.graphOptions),{container:t,model:this.sourceGraph.model,frozen:!0,async:this.sourceGraph.isAsync(),interacting:!1,grid:!1,background:!1,rotating:!1,resizing:!1,embedding:!1,selecting:!1,snapline:!1,clipboard:!1,history:!1,scroller:!1});this.targetGraph=this.options.createGraph?this.options.createGraph(i):new Ci(i),this.targetGraph.renderer.unfreeze(),this.updatePaper(this.sourceGraph.options.width,this.sourceGraph.options.height),this.startListening()}get graph(){return this.options.graph}get scroller(){return this.graph.scroller.widget}get graphContainer(){return this.scroller?this.scroller.container:this.graph.container}get $graphContainer(){return this.scroller?this.scroller.$container:this.$(this.graph.container)}startListening(){this.scroller?this.$graphContainer.on(`scroll${this.getEventNamespace()}`,this.updateViewport):(this.sourceGraph.on("translate",this.onTransform,this),this.sourceGraph.on("scale",this.onTransform,this),this.sourceGraph.on("model:updated",this.onModelUpdated,this)),this.sourceGraph.on("resize",this.updatePaper,this),this.delegateEvents({mousedown:"startAction",touchstart:"startAction",[`mousedown .${this.prefixClassName("graph")}`]:"scrollTo",[`touchstart .${this.prefixClassName("graph")}`]:"scrollTo"})}stopListening(){this.scroller?this.$graphContainer.off(this.getEventNamespace()):(this.sourceGraph.off("translate",this.onTransform,this),this.sourceGraph.off("scale",this.onTransform,this),this.sourceGraph.off("model:updated",this.onModelUpdated,this)),this.sourceGraph.off("resize",this.updatePaper,this),this.undelegateEvents()}onRemove(){this.targetGraph.view.remove(),this.stopListening(),this.targetGraph.dispose()}onTransform(e){(e.ui||this.targetGraphTransforming)&&this.updateViewport()}onModelUpdated(){this.targetGraph.zoomToFit()}updatePaper(e,t){let i,a;typeof e=="object"?(i=e.width,a=e.height):(i=e,a=t);const d=this.sourceGraph.options,f=this.sourceGraph.transform.getScale(),m=this.options.width-2*this.options.padding,y=this.options.height-2*this.options.padding;i/=f.sx,a/=f.sy,this.ratio=Math.min(m/i,y/a);const x=this.ratio,E=d.x*x/f.sx,S=d.y*x/f.sy;return i*=x,a*=x,this.targetGraph.resizeGraph(i,a),this.targetGraph.translate(E,S),this.scroller?this.targetGraph.scale(x,x):this.targetGraph.zoomToFit(),this.updateViewport(),this}updateViewport(){const e=this.sourceGraph.transform.getScale(),t=this.targetGraph.transform.getScale();let i=null;this.scroller?i=this.scroller.clientToLocalPoint(0,0):i=this.graph.graphToLocal(0,0);const a=this.$(this.targetGraph.container).position(),d=this.targetGraph.translate();d.ty=d.ty||0,this.geometry={top:a.top+i.y*t.sy+d.ty,left:a.left+i.x*t.sx+d.tx,width:this.$graphContainer.innerWidth()*t.sx/e.sx,height:this.$graphContainer.innerHeight()*t.sy/e.sy},this.$viewport.css(this.geometry)}startAction(e){const t=this.normalizeEvent(e),i=t.target===this.zoomHandle?"zooming":"panning",{tx:a,ty:d}=this.sourceGraph.translate(),f={action:i,clientX:t.clientX,clientY:t.clientY,scrollLeft:this.graphContainer.scrollLeft,scrollTop:this.graphContainer.scrollTop,zoom:this.sourceGraph.zoom(),scale:this.sourceGraph.transform.getScale(),geometry:this.geometry,translateX:a,translateY:d};this.targetGraphTransforming=!0,this.delegateDocumentEvents(Ng.documentEvents,f)}doAction(e){const t=this.normalizeEvent(e),i=t.clientX,a=t.clientY,d=t.data;switch(d.action){case"panning":{const f=this.sourceGraph.transform.getScale(),m=(i-d.clientX)*f.sx,y=(a-d.clientY)*f.sy;this.scroller?(this.graphContainer.scrollLeft=d.scrollLeft+m/this.ratio,this.graphContainer.scrollTop=d.scrollTop+y/this.ratio):this.sourceGraph.translate(d.translateX-m/this.ratio,d.translateY-y/this.ratio);break}case"zooming":{const f=d.scale,m=d.geometry,y=1+(d.clientX-i)/m.width/f.sx;d.frameId&&cancelAnimationFrame(d.frameId),d.frameId=requestAnimationFrame(()=>{this.sourceGraph.zoom(y*d.zoom,{absolute:!0,minScale:this.options.minScale,maxScale:this.options.maxScale})});break}default:break}}stopAction(){this.undelegateDocumentEvents(),this.targetGraphTransforming=!1}scrollTo(e){const t=this.normalizeEvent(e);let i,a;const d=this.targetGraph.translate();if(d.ty=d.ty||0,t.offsetX==null){const y=this.$(this.targetGraph.container).offset();i=t.pageX-y.left,a=t.pageY-y.top}else i=t.offsetX,a=t.offsetY;const f=(i-d.tx)/this.ratio,m=(a-d.ty)/this.ratio;this.sourceGraph.centerPoint(f,m)}dispose(){this.remove()}}eC([ii.dispose()],Ey.prototype,"dispose",null);var Ng;(function(c){c.defaultOptions={width:300,height:200,padding:10,scalable:!0,minScale:.01,maxScale:16,graphOptions:{},createGraph:e=>new Ci(e)},c.documentEvents={mousemove:"doAction",touchmove:"doAction",mouseup:"stopAction",touchend:"stopAction"}})(Ng||(Ng={}));var gp=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},tC=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Sy extends ii{constructor(e){super();const{graph:t}=e,i=tC(e,["graph"]);this.graph=t,this.options=Object.assign({tolerance:10},i),this.offset={x:0,y:0},this.render(),this.parseFilter(),this.disabled||this.startListening()}get model(){return this.graph.model}get containerClassName(){return this.prefixClassName("widget-snapline")}get verticalClassName(){return`${this.containerClassName}-vertical`}get horizontalClassName(){return`${this.containerClassName}-horizontal`}get disabled(){return this.options.enabled!==!0||this.graph.options.snapline.enabled!==!0}enable(){this.disabled&&(this.options.enabled=!0,this.graph.options.snapline.enabled=!0,this.startListening())}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.snapline.enabled=!1,this.stopListening())}setFilter(e){this.options.filter=e,this.parseFilter()}render(){const e=this.containerWrapper=new In("svg"),t=this.horizontal=new In("path"),i=this.vertical=new In("path");e.addClass(this.containerClassName),t.addClass(this.horizontalClassName),i.addClass(this.verticalClassName),e.setAttribute("width","100%"),e.setAttribute("height","100%"),t.setAttribute("display","none"),i.setAttribute("display","none"),e.append([t,i]),this.options.className&&e.addClass(this.options.className),this.container=this.containerWrapper.node}startListening(){this.stopListening(),this.graph.on("node:mousedown",this.captureCursorOffset,this),this.graph.on("node:mousemove",this.snapOnMoving,this),this.model.on("batch:stop",this.onBatchStop,this),this.delegateDocumentEvents({mouseup:"hide",touchend:"hide"})}stopListening(){this.graph.off("node:mousedown",this.captureCursorOffset,this),this.graph.off("node:mousemove",this.snapOnMoving,this),this.model.off("batch:stop",this.onBatchStop,this),this.undelegateDocumentEvents()}parseFilter(){this.filterShapes={},this.filterCells={},this.filterFunction=null;const e=this.options.filter;Array.isArray(e)?e.forEach(t=>{typeof t=="string"?this.filterShapes[t]=!0:this.filterCells[t.id]=!0}):typeof e=="function"&&(this.filterFunction=e)}onBatchStop({name:e,data:t}){e==="resize"&&this.snapOnResizing(t.cell,t)}captureCursorOffset({view:e,x:t,y:i}){const a=e.getDelegatedView();if(a&&this.isNodeMovable(a)){const d=e.cell.getPosition();this.offset={x:t-d.x,y:i-d.y}}}isNodeMovable(e){return e&&e.cell.isNode()&&e.can("nodeMovable")}snapOnResizing(e,t){if(this.options.resizing&&!t.snapped&&t.ui&&t.direction&&t.trueDirection){const i=this.graph.renderer.findViewByCell(e);if(i&&i.cell.isNode()){const a=e.getBBox(),d=a.bbox(e.getAngle()),f=d.getTopLeft(),m=d.getBottomRight(),y=ri.normalize(e.getAngle()),x=this.options.tolerance||0;let E,S,T,R,V,j;const q={vertical:0,horizontal:0},ue=t.direction,be=t.trueDirection,se=t.relativeDirection;be.indexOf("right")!==-1?q.vertical=m.x:q.vertical=f.x,be.indexOf("bottom")!==-1?q.horizontal=m.y:q.horizontal=f.y,this.model.getNodes().some(on=>{if(this.isIgnored(e,on))return!1;const fr=on.getBBox().bbox(on.getAngle()),Cr=fr.getTopLeft(),St=fr.getBottomRight(),dn={vertical:[Cr.x,St.x],horizontal:[Cr.y,St.y]},ur={};return Object.keys(dn).forEach(Ni=>{const Gi=Ni,cs=dn[Gi].map(_o=>({position:_o,distance:Math.abs(_o-q[Gi])})).filter(_o=>_o.distance<=x);ur[Gi]=ju(cs,_o=>_o.distance)}),E==null&&ur.vertical.length>0&&(E=ur.vertical[0].position,S=Math.min(d.y,fr.y),T=Math.max(m.y,St.y)-S),R==null&&ur.horizontal.length>0&&(R=ur.horizontal[0].position,V=Math.min(d.x,fr.x),j=Math.max(m.x,St.x)-V),E!=null&&R!=null}),this.hide();let Pe=0,He=0;(R!=null||E!=null)&&(E!=null&&(Pe=be.indexOf("right")!==-1?E-m.x:f.x-E),R!=null&&(He=be.indexOf("bottom")!==-1?R-m.y:f.y-R));let ft=0,pt=0;if(y%90===0)y===90||y===270?(ft=He,pt=Pe):(ft=Pe,pt=He);else{const on=y>=0&&y<90?1:y>=90&&y<180?4:y>=180&&y<270?3:2;R!=null&&E!=null&&(Pe<He?(He=0,R=void 0):(Pe=0,E=void 0));const fr=ri.toRad(y%90);Pe&&(ft=on===3?Pe/Math.cos(fr):Pe/Math.sin(fr)),He&&(pt=on===3?He/Math.cos(fr):He/Math.sin(fr));const Cr=on===1||on===3;switch(se){case"top":case"bottom":pt=He?He/(Cr?Math.cos(fr):Math.sin(fr)):Pe/(Cr?Math.sin(fr):Math.cos(fr));break;case"left":case"right":ft=Pe?Pe/(Cr?Math.cos(fr):Math.sin(fr)):He/(Cr?Math.sin(fr):Math.cos(fr));break;default:break}}switch(se){case"top":case"bottom":ft=0;break;case"left":case"right":pt=0;break;default:break}const kt=this.graph.getGridSize();let cn=Math.max(a.width+ft,kt),Bt=Math.max(a.height+pt,kt);t.minWidth&&t.minWidth>kt&&(cn=Math.max(cn,t.minWidth)),t.minHeight&&t.minHeight>kt&&(Bt=Math.max(Bt,t.minHeight)),t.maxWidth&&(cn=Math.min(cn,t.maxWidth)),t.maxHeight&&(Bt=Math.min(Bt,t.maxHeight)),t.preserveAspectRatio&&(pt<ft?Bt=cn*(a.height/a.width):cn=Bt*(a.width/a.height)),(cn!==a.width||Bt!==a.height)&&(e.resize(cn,Bt,{direction:ue,relativeDirection:se,trueDirection:be,snapped:!0,snaplines:this.cid,restrict:this.graph.hook.getRestrictArea(i)}),T&&(T+=Bt-a.height),j&&(j+=cn-a.width));const Xt=e.getBBox().bbox(y);E&&Math.abs(Xt.x-E)>1&&Math.abs(Xt.width+Xt.x-E)>1&&(E=void 0),R&&Math.abs(Xt.y-R)>1&&Math.abs(Xt.height+Xt.y-R)>1&&(R=void 0),this.update({verticalLeft:E,verticalTop:S,verticalHeight:T,horizontalTop:R,horizontalLeft:V,horizontalWidth:j})}}}snapOnMoving({view:e,e:t,x:i,y:a}){const d=e.getEventData(t).delegatedView||e;if(!this.isNodeMovable(d))return;const f=d.cell,m=f.getSize(),y=f.getPosition(),x=new gn(i-this.offset.x,a-this.offset.y,m.width,m.height),E=f.getAngle(),S=x.getCenter(),T=x.bbox(E),R=T.getTopLeft(),V=T.getBottomRight(),j=this.options.tolerance||0;let q,ue,be,se,Pe,He,ft=0,pt=0;if(this.model.getNodes().some(kt=>{if(this.isIgnored(f,kt))return!1;const cn=kt.getBBox().bbox(kt.getAngle()),Bt=cn.getCenter(),Xt=cn.getTopLeft(),on=cn.getBottomRight();return q==null&&(Math.abs(Bt.x-S.x)<j?(q=Bt.x,ft=.5):Math.abs(Xt.x-R.x)<j?(q=Xt.x,ft=0):Math.abs(Xt.x-V.x)<j?(q=Xt.x,ft=1):Math.abs(on.x-V.x)<j?(q=on.x,ft=1):Math.abs(on.x-R.x)<j&&(q=on.x),q!=null&&(ue=Math.min(T.y,cn.y),be=Math.max(V.y,on.y)-ue)),se==null&&(Math.abs(Bt.y-S.y)<j?(se=Bt.y,pt=.5):Math.abs(Xt.y-R.y)<j?se=Xt.y:Math.abs(Xt.y-V.y)<j?(se=Xt.y,pt=1):Math.abs(on.y-V.y)<j?(se=on.y,pt=1):Math.abs(on.y-R.y)<j&&(se=on.y),se!=null&&(Pe=Math.min(T.x,cn.x),He=Math.max(V.x,on.x)-Pe)),q!=null&&se!=null}),this.hide(),se!=null||q!=null){se!=null&&(T.y=se-pt*T.height),q!=null&&(T.x=q-ft*T.width);const kt=T.getCenter(),cn=kt.x-x.width/2,Bt=kt.y-x.height/2,Xt=cn-y.x,on=Bt-y.y;(Xt!==0||on!==0)&&(f.translate(Xt,on,{snapped:!0,restrict:this.graph.hook.getRestrictArea(d)}),He&&(He+=Xt),be&&(be+=on)),this.update({verticalLeft:q,verticalTop:ue,verticalHeight:be,horizontalTop:se,horizontalLeft:Pe,horizontalWidth:He})}}isIgnored(e,t){return t.id===e.id||t.isDescendantOf(e)||this.filterShapes[t.shape]||this.filterCells[t.id]||this.filterFunction&&Pn(this.filterFunction,this.graph,t)}update(e){if(e.horizontalTop){const t=this.graph.localToGraph(new Oe(e.horizontalLeft,e.horizontalTop)),i=this.graph.localToGraph(new Oe(e.horizontalLeft+e.horizontalWidth,e.horizontalTop));this.horizontal.setAttributes({d:`M ${t.x},${t.y} L ${i.x},${i.y}`,display:"inherit"})}else this.horizontal.setAttribute("display","none");if(e.verticalLeft){const t=this.graph.localToGraph(new Oe(e.verticalLeft,e.verticalTop)),i=this.graph.localToGraph(new Oe(e.verticalLeft,e.verticalTop+e.verticalHeight));this.vertical.setAttributes({d:`M ${t.x},${t.y} L ${i.x},${i.y}`,display:"inherit"})}else this.vertical.setAttribute("display","none");this.show()}resetTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}show(){return this.resetTimer(),this.container.parentNode==null&&this.graph.container.appendChild(this.container),this}hide(){this.resetTimer(),this.vertical.setAttribute("display","none"),this.horizontal.setAttribute("display","none");const e=this.options.clean,t=typeof e=="number"?e:e!==!1?3e3:0;return t>0&&(this.timer=window.setTimeout(()=>{this.container.parentNode!==null&&this.unmount()},t)),this}onRemove(){this.stopListening(),this.hide()}dispose(){this.remove()}}gp([ii.dispose()],Sy.prototype,"dispose",null);var nC=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class bi extends Di{init(){this.resetUpdates(),this.startListening(),this.resetViews(this.model.getCells()),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()}startListening(){this.model.on("sorted",this.onSortModel,this),this.model.on("reseted",this.onModelReseted,this),this.model.on("batch:stop",this.onBatchStop,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("sorted",this.onSortModel,this),this.model.off("reseted",this.onModelReseted,this),this.model.off("batch:stop",this.onBatchStop,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}resetUpdates(){this.updates={priorities:[{},{},{}],mounted:{},mountedCids:[],unmounted:{},unmountedCids:[],count:0,sort:!1,frozen:!1,freezeKey:null,animationId:null}}onSortModel(){this.model.hasActiveBatch(bi.SORT_DELAYING_BATCHES)||this.sortViews()}onModelReseted({options:e}){this.removeZPivots(),this.resetViews(this.model.getCells(),e)}onBatchStop({name:e,data:t}){if(this.isFrozen())return;const i=this.model;if(!this.isAsync()){const d=bi.UPDATE_DELAYING_BATCHES;d.includes(e)&&!i.hasActiveBatch(d)&&this.updateViews(t)}const a=bi.SORT_DELAYING_BATCHES;a.includes(e)&&!i.hasActiveBatch(a)&&this.sortViews()}onCellAdded({cell:e,options:t}){const i=t.position;this.isAsync()||typeof i!="number"?this.renderView(e,t):(t.maxPosition===i&&this.freeze({key:"addCells"}),this.renderView(e,t),i===0&&this.unfreeze({key:"addCells"}))}onCellRemoved({cell:e,options:t}){const i=this.findViewByCell(e);i&&this.requestViewUpdate(i,bi.FLAG_REMOVE,i.priority,t)}onCellZIndexChanged({cell:e,options:t}){if(this.options.sorting==="approx"){const i=this.findViewByCell(e);i&&this.requestViewUpdate(i,bi.FLAG_INSERT,i.priority,t)}}onCellVisibleChanged({cell:e,current:t,options:i}){t||this.processEdgeOnTerminalVisibleChanged(e,!1);const a=this.findViewByCell(e);!t&&a?this.removeView(e):t&&a==null&&this.renderView(e,i),t&&this.processEdgeOnTerminalVisibleChanged(e,!0)}processEdgeOnTerminalVisibleChanged(e,t){const i=(a,d)=>a.getSourceCellId()!==d.id?a.getSourceCell():a.getTargetCellId()!==d.id?a.getTargetCell():null;this.model.getConnectedEdges(e).forEach(a=>{const d=i(a,e);(d==null||d.isVisible())&&(t?a.show():a.hide())})}isEdgeTerminalVisible(e,t){const i=t==="source"?e.getSourceCellId():e.getTargetCellId(),a=i?this.model.getCell(i):null;return!(a&&!a.isVisible())}requestConnectedEdgesUpdate(e,t={}){if(xo.isCellView(e)){const i=e.cell,a=this.model.getConnectedEdges(i);for(let d=0,f=a.length;d<f;d+=1){const m=a[d],y=this.findViewByCell(m);if(!y)continue;const x=["update"];m.getTargetCell()===i&&x.push("target"),m.getSourceCell()===i&&x.push("source"),this.scheduleViewUpdate(y,y.getFlag(x),y.priority,t)}}}forcePostponedViewUpdate(e,t){if(!e||!xo.isCellView(e))return!1;const i=e.cell;if(i.isNode())return!1;const a=e;if(i.isEdge()&&(t&e.getFlag(["source","target"]))===0){let d=0;const f=this.findViewByCell(i.getSourceCell());f&&!this.isViewMounted(f)&&(d=this.dumpView(f),a.updateTerminalMagnet("source"));let m=0;const y=this.findViewByCell(i.getTargetCell());if(y&&!this.isViewMounted(y)&&(m=this.dumpView(y),a.updateTerminalMagnet("target")),d===0&&m===0)return!this.dumpView(a)}return!1}scheduleViewUpdate(e,t,i,a={}){const d=e.cid,f=this.updates;let m=f.priorities[i];m||(m=f.priorities[i]={});const y=m[d]||0;(y&t)!==t&&(y||(f.count+=1),t&bi.FLAG_REMOVE&&y&bi.FLAG_INSERT?m[d]^=bi.FLAG_INSERT:t&bi.FLAG_INSERT&&y&bi.FLAG_REMOVE&&(m[d]^=bi.FLAG_REMOVE),m[d]|=t,this.graph.hook.onViewUpdated(e,t,a))}requestViewUpdate(e,t,i,a={}){this.scheduleViewUpdate(e,t,i,a);const d=this.isAsync();if(this.isFrozen()||d&&a.async!==!1||this.model.hasActiveBatch(bi.UPDATE_DELAYING_BATCHES))return;const f=this.updateViews(a);d&&this.graph.trigger("render:done",{stats:f,options:a})}dumpView(e,t={}){if(e==null)return 0;const i=e.cid,d=this.updates.priorities[e.priority],f=this.registerMountedView(e)|d[i];return delete d[i],f?this.updateView(e,f,t):0}dumpViews(e={}){this.checkView(e),this.updateViews(e)}requireView(e,t={}){const i=this.findViewByCell(e);return i==null?null:(this.dumpView(i,t),i)}updateView(e,t,i={}){if(e==null)return 0;if(xo.isCellView(e)){if(t&bi.FLAG_REMOVE)return this.removeView(e.cell),0;t&bi.FLAG_INSERT&&(this.insertView(e),t^=bi.FLAG_INSERT)}return t?e.confirmUpdate(t,i):0}updateViews(e={}){let t,i=0,a=0,d=bi.MIN_PRIORITY;do t=this.updateViewsBatch(e),i+=1,a+=t.updatedCount,d=Math.min(t.priority,d);while(!t.empty);return{priority:d,batchCount:i,updatedCount:a}}updateViewsBatch(e={}){const t=this.updates,i=t.priorities,a=e.batchSize||bi.UPDATE_BATCH_SIZE;let d=!0,f=bi.MIN_PRIORITY,m=0,y=0,x=0,E=0,S=e.checkView||this.options.checkView;typeof S!="function"&&(S=null);e:for(let T=0,R=i.length;T<R;T+=1){const V=i[T];for(const j in V){if(x>=a){d=!1;break e}const q=ii.views[j];if(!q){delete V[j];continue}let ue=V[j];if((ue&bi.FLAG_REMOVE)===0){const Pe=j in t.unmounted;if(S&&!Pn(S,this.graph,{view:q,unmounted:Pe})){Pe||(this.registerUnmountedView(q),q.unmount()),t.unmounted[j]|=ue,delete V[j],y+=1;continue}Pe&&(ue|=bi.FLAG_INSERT,m+=1),ue|=this.registerMountedView(q)}const be=q;let se=this.updateView(q,ue,e);if(se>0){const Pe=be.cell;Pe&&Pe.isEdge()&&(be.hasAction(se,"source")&&!this.isEdgeTerminalVisible(Pe,"source")&&(se=be.removeAction(se,"source"),se|=bi.FLAG_REMOVE),be.hasAction(se,"target")&&!this.isEdgeTerminalVisible(Pe,"target")&&(se=be.removeAction(se,"target"),se|=bi.FLAG_REMOVE))}if(se>0&&(V[j]=se,!this.graph.hook.onViewPostponed(be,se,e)||V[j])){E+=1,d=!1;continue}f>T&&(f=T),x+=1,delete V[j]}}return{empty:d,priority:f,mountedCount:m,unmountedCount:y,updatedCount:x,postponedCount:E}}updateViewsAsync(e={},t={processed:0,priority:bi.MIN_PRIORITY}){const i=this.updates,a=i.animationId;if(a){if(Um(a),t.processed===0){const T=e.before;typeof T=="function"&&Pn(T,this.graph,this.graph)}const d=this.updateViewsBatch(e),f=this.checkViewImpl({checkView:e.checkView,mountedBatchSize:bi.MOUNT_BATCH_SIZE-d.mountedCount,unmountedBatchSize:bi.MOUNT_BATCH_SIZE-d.unmountedCount});let m=t.processed;const y=i.count,x=f.mountedCount,E=f.unmountedCount;d.updatedCount>0&&(m+=d.updatedCount+d.unmountedCount,t.priority=Math.min(d.priority,t.priority),d.empty&&x===0?(d.priority=t.priority,d.mountedCount+=x,d.unmountedCount+=E,this.graph.trigger("render:done",{stats:d,options:e}),t.processed=0,i.count=0):t.processed=m);const S=e.progress;if(y&&typeof S=="function"&&Pn(S,this.graph,{total:y,done:d.empty,current:m}),i.animationId!==a)return}i.animationId=qf(()=>{this.updateViewsAsync(e,t)})}registerMountedView(e){const t=e.cid,i=this.updates;if(t in i.mounted)return 0;i.mounted[t]=!0,i.mountedCids.push(t);const a=i.unmounted[t]||0;return delete i.unmounted[t],a}registerUnmountedView(e){const t=e.cid,i=this.updates;if(t in i.unmounted)return 0;i.unmounted[t]|=bi.FLAG_INSERT;const a=i.unmounted[t];return i.unmountedCids.push(t),delete i.mounted[t],a}isViewMounted(e){return e==null?!1:e.cid in this.updates.mounted}getMountedViews(){return Object.keys(this.updates.mounted).map(e=>xo.views[e])}getUnmountedViews(){return Object.keys(this.updates.unmounted).map(e=>xo.views[e])}checkMountedViews(e,t){let i=0;if(typeof e!="function")return i;const a=this.updates,d=a.mounted,f=a.mountedCids,m=t==null?f.length:Math.min(f.length,t);for(let y=0;y<m;y+=1){const x=f[y];if(!(x in d))continue;const E=xo.views[x];if(E==null)continue;if(Pn(e,this.graph,{view:E,unmounted:!0})){f.push(x);continue}i+=1,this.registerUnmountedView(E)&&E.unmount()}return f.splice(0,m),i}checkUnmountedViews(e,t){let i=0;typeof e!="function"&&(e=null);const a=this.updates,d=a.unmounted,f=a.unmountedCids,m=t==null?f.length:Math.min(f.length,t);for(let y=0;y<m;y+=1){const x=f[y];if(!(x in d))continue;const E=xo.views[x];if(E==null)continue;if(e&&!Pn(e,this.graph,{view:E,unmounted:!1})){f.push(x);continue}i+=1;const S=this.registerMountedView(E);S&&this.scheduleViewUpdate(E,S,E.priority,{mounting:!0})}return f.splice(0,m),i}checkViewImpl(e={mountedBatchSize:Number.MAX_SAFE_INTEGER,unmountedBatchSize:Number.MAX_SAFE_INTEGER}){const t=e.checkView||this.options.checkView,i=this.checkMountedViews(t,e.unmountedBatchSize);return{mountedCount:this.checkUnmountedViews(t,i>0?Math.min(this.updates.unmountedCids.length-i,e.mountedBatchSize):e.mountedBatchSize),unmountedCount:i}}checkView(e={}){return this.checkViewImpl(e)}isFrozen(){return!!this.options.frozen}freeze(e={}){const t=e.key,i=this.updates,a=this.options.frozen,d=i.freezeKey;if(t&&t!==d){if(a&&d)return;i.frozen=a,i.freezeKey=t}this.options.frozen=!0;const f=i.animationId;i.animationId=null,this.isAsync()&&f!=null&&Um(f),this.graph.trigger("freeze",{key:t})}unfreeze(e={}){const t=e.key,i=this.updates,a=i.freezeKey;if(t&&a&&t!==a||(i.freezeKey=null,t&&t===a&&i.frozen))return;const d=()=>{this.options.frozen=i.frozen=!1,i.sort&&(this.sortViews(),i.sort=!1);const f=e.after;f&&Pn(f,this.graph,this.graph),this.graph.trigger("unfreeze",{key:t})};if(this.isAsync()){this.freeze();const f=e.progress;this.updateViewsAsync(Object.assign(Object.assign({},e),{progress:({done:m,current:y,total:x})=>{f&&Pn(f,this.graph,{done:m,current:y,total:x}),m&&d()}}))}else this.updateViews(e),d()}isAsync(){return!!this.options.async}setAsync(e){this.options.async=e}onRemove(){this.freeze(),this.removeViews()}resetViews(e=[],t={}){this.resetUpdates(),this.removeViews(),this.freeze({key:"reset"});for(let i=0,a=e.length;i<a;i+=1)this.renderView(e[i],t);this.unfreeze({key:"reset"}),this.sortViews()}removeView(e){const t=this.views[e.id];if(t){const i=t.cid,a=this.updates,d=a.mounted,f=a.unmounted;t.remove(),delete this.views[e.id],delete d[i],delete f[i]}return t}removeViews(){this.views&&Object.keys(this.views).forEach(e=>{const t=this.views[e];t&&this.removeView(t.cell)}),this.views={}}renderView(e,t={}){const i=e.id,a=this.views;let d=0,f=a[i];if(!!e.isVisible()&&!(e.isEdge()&&(!this.isEdgeTerminalVisible(e,"source")||!this.isEdgeTerminalVisible(e,"target")))){if(f)d=bi.FLAG_INSERT;else{const m=this.graph.hook.createCellView(e);m&&(f=a[e.id]=m,f.graph=this.graph,d=this.registerUnmountedView(f)|f.getBootstrapFlag())}f&&this.requestViewUpdate(f,d,f.priority,t)}}isExactSorting(){return this.options.sorting==="exact"}sortViews(){if(!!this.isExactSorting()){if(this.isFrozen()){this.updates.sort=!0;return}this.sortViewsExact()}}sortElements(e,t){const i=e.map(a=>{const d=a.parentNode,f=d.insertBefore(document.createTextNode(""),a.nextSibling);return m=>{if(d===m)throw new Error("You can't sort elements if any one is a descendant of another.");d.insertBefore(m,f),d.removeChild(f)}});e.sort(t).forEach((a,d)=>i[d](a))}sortViewsExact(){const e=this.view.$(this.view.stage).children("[data-cell-id]").toArray(),t=this.model;this.sortElements(e,(i,a)=>{const d=t.getCell(i.getAttribute("data-cell-id")||""),f=t.getCell(a.getAttribute("data-cell-id")||""),m=d.getZIndex()||0,y=f.getZIndex()||0;return m===y?0:m<y?-1:1})}addZPivot(e=0){this.zPivots==null&&(this.zPivots={});const t=this.zPivots;let i=t[e];if(i)return i;i=t[e]=document.createComment(`z-index:${e+1}`);let a=-1/0;for(const f in t){const m=+f;m<e&&m>a&&(a=m,e-1)}const d=this.view.stage;if(a!==-1/0){const f=t[a];d.insertBefore(i,f.nextSibling)}else d.insertBefore(i,d.firstChild);return i}removeZPivots(){this.zPivots&&Object.keys(this.zPivots).forEach(e=>{const t=this.zPivots[e];t&&t.parentNode&&t.parentNode.removeChild(t)}),this.zPivots={}}insertView(e){const t=this.view.stage;switch(this.options.sorting){case"approx":{const i=e.cell.getZIndex(),a=this.addZPivot(i);t.insertBefore(e.container,a);break}case"exact":default:t.appendChild(e.container);break}}findViewByCell(e){if(e==null)return null;const t=Xr.isCell(e)?e.id:e;return this.views[t]}findViewByElem(e){if(e==null)return null;const t=typeof e=="string"?this.view.stage.querySelector(e):e instanceof Element?e:e[0];if(t){const i=this.view.findAttr("data-cell-id",t);if(i)return this.views[i]}return null}findViewsFromPoint(e){const t={x:e.x,y:e.y};return this.model.getCells().map(i=>this.findViewByCell(i)).filter(i=>i!=null?Pr(i.container,{target:this.view.stage}).containsPoint(t):!1)}findEdgeViewsInArea(e,t={}){const i=gn.create(e);return this.model.getEdges().map(a=>this.findViewByCell(a)).filter(a=>{if(a){const d=Pr(a.container,{target:this.view.stage});return d.width===0?d.inflate(1,0):d.height===0&&d.inflate(0,1),t.strict?i.containsRect(d):i.isIntersectWithRect(d)}return!1})}findViewsInArea(e,t={}){const i=gn.create(e);return this.model.getNodes().map(a=>this.findViewByCell(a)).filter(a=>{if(a){const d=Pr(a.container,{target:this.view.stage});return t.strict?i.containsRect(d):i.isIntersectWithRect(d)}return!1})}dispose(){this.resetUpdates(),this.stopListening()}}nC([Di.dispose()],bi.prototype,"dispose",null),function(c){c.FLAG_INSERT=1<<30,c.FLAG_REMOVE=1<<29,c.MOUNT_BATCH_SIZE=1e3,c.UPDATE_BATCH_SIZE=1e3,c.MIN_PRIORITY=2,c.SORT_DELAYING_BATCHES=["add","to-front","to-back"],c.UPDATE_DELAYING_BATCHES=["translate"]}(bi||(bi={}));var v0=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class kg extends Di{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(e={}){let t=e.size||"auto auto",i=e.position||"center";const a=this.graph.transform.getScale(),d=this.graph.translate();if(typeof i=="object"){const f=d.tx+a.sx*(i.x||0),m=d.ty+a.sy*(i.y||0);i=`${f}px ${m}px`}typeof t=="object"&&(t=gn.fromSize(t).scale(a.sx,a.sy),t=`${t.width}px ${t.height}px`),this.elem.style.backgroundSize=t,this.elem.style.backgroundPosition=i}drawBackgroundImage(e,t={}){if(!(e instanceof HTMLImageElement)){this.elem.style.backgroundImage="";return}const i=this.optionsCache;if(i&&i.image!==t.image)return;let a;const d=t.opacity,f=t.size;let m=t.repeat||"no-repeat";const y=Lh.registry.get(m);if(typeof y=="function"){const E=t.quality||1;e.width*=E,e.height*=E;const S=y(e,t);if(!(S instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");a=S.toDataURL("image/png"),t.repeat&&m!==t.repeat?m=t.repeat:m="repeat",typeof f=="object"?(f.width*=S.width/e.width,f.height*=S.height/e.height):f===void 0&&(t.size={width:S.width/E,height:S.height/E})}else a=e.src,f===void 0&&(t.size={width:e.width,height:e.height});i!=null&&typeof t.size=="object"&&t.image===i.image&&t.repeat===i.repeat&&t.quality===i.quality&&(i.size=au(t.size));const x=this.elem.style;x.backgroundImage=`url(${a})`,x.backgroundRepeat=m,x.opacity=d==null||d>=1?"":`${d}`,this.updateBackgroundImage(t)}updateBackgroundColor(e){this.elem.style.backgroundColor=e||""}updateBackgroundOptions(e){this.graph.options.background=e}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(e){const t=e||{};if(this.updateBackgroundOptions(e),this.updateBackgroundColor(t.color),t.image){this.optionsCache=au(t);const i=document.createElement("img");i.onload=()=>this.drawBackgroundImage(i,e),i.setAttribute("crossorigin","anonymous"),i.src=t.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}v0([Di.dispose()],kg.prototype,"dispose",null);var zd=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},zE=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class mp extends ii{constructor(e){super(),this.padding={left:0,top:0,right:0,bottom:0},this.options=Sl.getOptions(e);const t=this.graph.transform.getScale();this.sx=t.sx,this.sy=t.sy;const i=this.options.width||this.graph.options.width,a=this.options.height||this.graph.options.height;this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(Sl.containerClass)).css({width:i,height:a}),this.options.pageVisible&&this.$container.addClass(this.prefixClassName(Sl.pagedClass)),this.options.className&&this.$container.addClass(this.options.className);const d=this.graph.container;d.parentNode&&this.$container.insertBefore(d);const f=d.getAttribute("style");if(f){const m={};f.split(";").forEach(x=>{const E=x.trim();if(E){const S=E.split(":");S.length&&(m[S[0].trim()]=S[1]?S[1].trim():"")}}),Object.keys(m).forEach(x=>{x==="width"||x==="height"||(d.style[x]="",this.container.style[x]=m[x])})}this.content=document.createElement("div"),this.$content=this.$(this.content).addClass(this.prefixClassName(Sl.contentClass)).css({width:this.graph.options.width,height:this.graph.options.height}),this.background=document.createElement("div"),this.$background=this.$(this.background).addClass(this.prefixClassName(Sl.backgroundClass)),this.$content.append(this.background),this.options.pageVisible||this.$content.append(this.graph.view.grid),this.$content.append(d),this.$content.appendTo(this.container),this.startListening(),this.options.pageVisible||this.graph.grid.update(),this.backgroundManager=new mp.Background(this),this.options.autoResize||this.update()}get graph(){return this.options.graph}get model(){return this.graph.model}startListening(){const e=this.graph,t=this.model;e.on("scale",this.onScale,this),e.on("resize",this.onResize,this),e.on("before:print",this.storeScrollPosition,this),e.on("before:export",this.storeScrollPosition,this),e.on("after:print",this.restoreScrollPosition,this),e.on("after:export",this.restoreScrollPosition,this),e.on("render:done",this.onRenderDone,this),e.on("unfreeze",this.onUpdate,this),t.on("reseted",this.onUpdate,this),t.on("cell:added",this.onUpdate,this),t.on("cell:removed",this.onUpdate,this),t.on("cell:changed",this.onUpdate,this),t.on("batch:stop",this.onBatchStop,this),this.delegateBackgroundEvents()}stopListening(){const e=this.graph,t=this.model;e.off("scale",this.onScale,this),e.off("resize",this.onResize,this),e.off("beforeprint",this.storeScrollPosition,this),e.off("beforeexport",this.storeScrollPosition,this),e.off("afterprint",this.restoreScrollPosition,this),e.off("afterexport",this.restoreScrollPosition,this),e.off("render:done",this.onRenderDone,this),e.off("unfreeze",this.onUpdate,this),t.off("reseted",this.onUpdate,this),t.off("cell:added",this.onUpdate,this),t.off("cell:removed",this.onUpdate,this),t.off("cell:changed",this.onUpdate,this),t.off("batch:stop",this.onBatchStop,this),this.undelegateBackgroundEvents()}enableAutoResize(){this.options.autoResize=!0}disableAutoResize(){this.options.autoResize=!1}onUpdate(){this.graph.isAsync()||!this.options.autoResize||this.update()}onBatchStop(e){this.graph.isAsync()||!this.options.autoResize||bi.UPDATE_DELAYING_BATCHES.includes(e.name)&&this.update()}delegateBackgroundEvents(e){const t=e||El.events;this.delegatedHandlers=Object.keys(t).reduce((i,a)=>{const d=t[a];if(a.indexOf(" ")===-1)if(typeof d=="function")i[a]=d;else{let f=this.graph.view[d];typeof f=="function"&&(f=f.bind(this.graph.view),i[a]=f)}return i},{}),this.onBackgroundEvent=this.onBackgroundEvent.bind(this),Object.keys(this.delegatedHandlers).forEach(i=>{this.delegateEvent(i,{guarded:!1},this.onBackgroundEvent)})}undelegateBackgroundEvents(){Object.keys(this.delegatedHandlers).forEach(e=>{this.undelegateEvent(e,this.onBackgroundEvent)})}onBackgroundEvent(e){let t=!1;const i=e.target;if(this.options.pageVisible)this.options.background?t=this.background===i:t=this.content===i;else{const a=this.graph.view;t=a.background===i||a.grid===i}if(t){const a=this.delegatedHandlers[e.type];typeof a=="function"&&a.apply(this.graph,arguments)}}onRenderDone({stats:e}){this.options.autoResize&&e.priority<2&&this.update()}onResize(){this.cachedCenterPoint&&(this.centerPoint(this.cachedCenterPoint.x,this.cachedCenterPoint.y),this.updatePageBreak())}onScale({sx:e,sy:t,ox:i,oy:a}){this.updateScale(e,t),(i||a)&&(this.centerPoint(i,a),this.updatePageBreak()),typeof(this.options.autoResizeOptions||this.options.fitTocontentOptions)=="function"&&this.update()}storeScrollPosition(){this.cachedScrollLeft=this.container.scrollLeft,this.cachedScrollTop=this.container.scrollTop}restoreScrollPosition(){this.container.scrollLeft=this.cachedScrollLeft,this.container.scrollTop=this.cachedScrollTop,this.cachedScrollLeft=null,this.cachedScrollTop=null}storeClientSize(){this.cachedClientSize={width:this.container.clientWidth,height:this.container.clientHeight}}restoreClientSize(){this.cachedClientSize=null}beforeManipulation(){(xt.IS_IE||xt.IS_EDGE)&&this.$container.css("visibility","hidden")}afterManipulation(){(xt.IS_IE||xt.IS_EDGE)&&this.$container.css("visibility","visible")}updatePageSize(e,t){e!=null&&(this.options.pageWidth=e),t!=null&&(this.options.pageHeight=t),this.updatePageBreak()}updatePageBreak(){if(this.pageBreak&&this.pageBreak.parentNode&&this.pageBreak.parentNode.removeChild(this.pageBreak),this.pageBreak=null,this.options.pageVisible&&this.options.pageBreak){const e=this.graph.options.width,t=this.graph.options.height,i=this.options.pageWidth*this.sx,a=this.options.pageHeight*this.sy;if(e>i||t>a){let d=!1;const f=document.createElement("div");for(let m=1,y=Math.floor(e/i);m<y;m+=1)this.$("<div/>").addClass(this.prefixClassName("graph-pagebreak-vertical")).css({left:m*i}).appendTo(f),d=!0;for(let m=1,y=Math.floor(t/a);m<y;m+=1)this.$("<div/>").addClass(this.prefixClassName("graph-pagebreak-horizontal")).css({top:m*a}).appendTo(f),d=!0;d&&(vi(f,this.prefixClassName("graph-pagebreak")),this.$(this.graph.view.grid).after(f),this.pageBreak=f)}}}update(){const e=this.getClientSize();this.cachedCenterPoint=this.clientToLocalPoint(e.width/2,e.height/2);let t=this.options.autoResizeOptions||this.options.fitTocontentOptions;typeof t=="function"&&(t=Pn(t,this,this));const i=Object.assign({gridWidth:this.options.pageWidth,gridHeight:this.options.pageHeight,allowNewOrigin:"negative"},t);this.graph.fitToContent(this.getFitToContentOptions(i))}getFitToContentOptions(e){const t=this.sx,i=this.sy;return e.gridWidth&&(e.gridWidth*=t),e.gridHeight&&(e.gridHeight*=i),e.minWidth&&(e.minWidth*=t),e.minHeight&&(e.minHeight*=i),typeof e.padding=="object"?e.padding={left:(e.padding.left||0)*t,right:(e.padding.right||0)*t,top:(e.padding.top||0)*i,bottom:(e.padding.bottom||0)*i}:typeof e.padding=="number"&&(e.padding*=t),this.options.autoResize||(e.contentArea=gn.create()),e}updateScale(e,t){const i=this.graph.options,a=e/this.sx,d=t/this.sy;this.sx=e,this.sy=t,this.graph.translate(i.x*a,i.y*d),this.graph.resizeGraph(i.width*a,i.height*d)}scrollbarPosition(e,t,i){if(e==null&&t==null)return{left:this.container.scrollLeft,top:this.container.scrollTop};const a={};return typeof e=="number"&&(a.scrollLeft=e),typeof t=="number"&&(a.scrollTop=t),i&&i.animation?this.$container.animate(a,i.animation):this.$container.prop(a),this}scrollToPoint(e,t,i){const a=this.getClientSize(),d=this.graph.matrix(),f={};return typeof e=="number"&&(f.scrollLeft=e-a.width/2+d.e+(this.padding.left||0)),typeof t=="number"&&(f.scrollTop=t-a.height/2+d.f+(this.padding.top||0)),i&&i.animation?this.$container.animate(f,i.animation):this.$container.prop(f),this}scrollToContent(e){const t=this.sx,i=this.sy,a=this.graph.getContentArea().getCenter();return this.scrollToPoint(a.x*t,a.y*i,e)}scrollToCell(e,t){const i=this.sx,a=this.sy,d=e.getBBox().getCenter();return this.scrollToPoint(d.x*i,d.y*a,t)}center(e){return this.centerPoint(e)}centerPoint(e,t,i){const a=this.graph.matrix(),d=a.a,f=a.d,m=-a.e,y=-a.f,x=m+this.graph.options.width,E=y+this.graph.options.height;let S;if(this.storeClientSize(),typeof e=="number"||typeof t=="number"){S=i;const He=this.getVisibleArea().getCenter();typeof e=="number"?e*=d:e=He.x,typeof t=="number"?t*=f:t=He.y}else S=e,e=(m+x)/2,t=(y+E)/2;if(S&&S.padding)return this.positionPoint({x:e,y:t},"50%","50%",S);const T=this.getPadding(),R=this.getClientSize(),V=R.width/2,j=R.height/2,q=V-T.left-e+m,ue=V-T.right+e-x,be=j-T.top-t+y,se=j-T.bottom+t-E;this.addPadding(Math.max(q,0),Math.max(ue,0),Math.max(be,0),Math.max(se,0));const Pe=this.scrollToPoint(e,t,S||void 0);return this.restoreClientSize(),Pe}centerContent(e){return this.positionContent("center",e)}centerCell(e,t){return this.positionCell(e,"center",t)}positionContent(e,t){const i=this.graph.getContentArea(t);return this.positionRect(i,e,t)}positionCell(e,t,i){const a=e.getBBox();return this.positionRect(a,t,i)}positionRect(e,t,i){const a=gn.create(e);switch(t){case"center":return this.positionPoint(a.getCenter(),"50%","50%",i);case"top":return this.positionPoint(a.getTopCenter(),"50%",0,i);case"top-right":return this.positionPoint(a.getTopRight(),"100%",0,i);case"right":return this.positionPoint(a.getRightMiddle(),"100%","50%",i);case"bottom-right":return this.positionPoint(a.getBottomRight(),"100%","100%",i);case"bottom":return this.positionPoint(a.getBottomCenter(),"50%","100%",i);case"bottom-left":return this.positionPoint(a.getBottomLeft(),0,"100%",i);case"left":return this.positionPoint(a.getLeftMiddle(),0,"50%",i);case"top-left":return this.positionPoint(a.getTopLeft(),0,0,i);default:return this}}positionPoint(e,t,i,a={}){const{padding:d}=a,f=zE(a,["padding"]),m=Ma(d),y=gn.fromSize(this.getClientSize()),x=y.clone().moveAndExpand({x:m.left,y:m.top,width:-m.right-m.left,height:-m.top-m.bottom});t=Lc(t,Math.max(0,x.width)),t<0&&(t=x.width+t),i=Lc(i,Math.max(0,x.height)),i<0&&(i=x.height+i);const E=x.getTopLeft().translate(t,i),S=y.getCenter().diff(E),T=this.zoom(),R=S.scale(1/T,1/T),V=Oe.create(e).translate(R);return this.centerPoint(V.x,V.y,f)}zoom(e,t){if(e==null)return this.sx;t=t||{};let i,a;const d=this.getClientSize(),f=this.clientToLocalPoint(d.width/2,d.height/2);let m=e,y=e;if(t.absolute||(m+=this.sx,y+=this.sy),t.scaleGrid&&(m=Math.round(m/t.scaleGrid)*t.scaleGrid,y=Math.round(y/t.scaleGrid)*t.scaleGrid),t.maxScale&&(m=Math.min(t.maxScale,m),y=Math.min(t.maxScale,y)),t.minScale&&(m=Math.max(t.minScale,m),y=Math.max(t.minScale,y)),m=this.graph.transform.clampScale(m),y=this.graph.transform.clampScale(y),t.center){const x=m/this.sx,E=y/this.sy;i=t.center.x-(t.center.x-f.x)/x,a=t.center.y-(t.center.y-f.y)/E}else i=f.x,a=f.y;return this.beforeManipulation(),this.graph.transform.scale(m,y),this.centerPoint(i,a),this.afterManipulation(),this}zoomToRect(e,t={}){const i=gn.create(e),a=this.graph;t.contentArea=i,t.viewportArea==null&&(t.viewportArea={x:a.options.x,y:a.options.y,width:this.$container.width(),height:this.$container.height()}),this.beforeManipulation(),a.transform.scaleContentToFitImpl(t,!1);const d=i.getCenter();return this.centerPoint(d.x,d.y),this.afterManipulation(),this}zoomToFit(e={}){return this.zoomToRect(this.graph.getContentArea(e),e)}transitionToPoint(e,t,i){typeof e=="object"?(i=t,t=e.y,e=e.x):t=t,i==null&&(i={});let a,d;const f=this.sx,m=Math.max(i.scale||f,1e-6),y=this.getClientSize(),x=new Oe(e,t),E=this.clientToLocalPoint(y.width/2,y.height/2);if(f===m){const T=E.diff(x).scale(f,f).round();a=`translate(${T.x}px,${T.y}px)`}else{const T=m/(f-m)*x.distance(E),R=E.clone().move(x,T),V=this.localToBackgroundPoint(R).round();a=`scale(${m/f})`,d=`${V.x}px ${V.y}px`}const S=i.onTransitionEnd;return this.$container.addClass(Sl.transitionClassName),this.$content.off(Sl.transitionEventName).on(Sl.transitionEventName,T=>{this.syncTransition(m,{x:e,y:t}),typeof S=="function"&&Pn(S,this,T.originalEvent)}).css({transform:a,transformOrigin:d,transition:"transform",transitionDuration:i.duration||"1s",transitionDelay:i.delay,transitionTimingFunction:i.timing}),this}syncTransition(e,t){return this.beforeManipulation(),this.graph.scale(e),this.removeTransition(),this.centerPoint(t.x,t.y),this.afterManipulation(),this}removeTransition(){return this.$container.removeClass(Sl.transitionClassName),this.$content.off(Sl.transitionEventName).css({transform:"",transformOrigin:"",transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:""}),this}transitionToRect(e,t={}){const i=gn.create(e),a=t.maxScale||1/0,d=t.minScale||Number.MIN_VALUE,f=t.scaleGrid||null,m=t.visibility||1,y=t.center?Oe.create(t.center):i.getCenter(),x=this.getClientSize(),E=x.width*m,S=x.height*m;let T=new gn(y.x-E/2,y.y-S/2,E,S).getMaxUniformScaleToFit(i,y);return T=Math.min(T,a),f&&(T=Math.floor(T/f)*f),T=Math.max(d,T),this.transitionToPoint(y,Object.assign({scale:T},t))}startPanning(e){const t=this.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.trigger("pan:start",{e:t}),this.$(document.body).on({"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),this.$(window).on("mouseup.panning",this.stopPanning.bind(this))}pan(e){const t=this.normalizeEvent(e),i=t.clientX-this.clientX,a=t.clientY-this.clientY;this.container.scrollTop-=a,this.container.scrollLeft-=i,this.clientX=t.clientX,this.clientY=t.clientY,this.trigger("panning",{e:t})}stopPanning(e){this.$(document.body).off(".panning"),this.$(window).off(".panning"),this.trigger("pan:stop",{e})}clientToLocalPoint(e,t){let i=typeof e=="object"?e.x:e,a=typeof e=="object"?e.y:t;const d=this.graph.matrix();return i+=this.container.scrollLeft-this.padding.left-d.e,a+=this.container.scrollTop-this.padding.top-d.f,new Oe(i/d.a,a/d.d)}localToBackgroundPoint(e,t){const i=typeof e=="object"?Oe.create(e):new Oe(e,t),a=this.graph.matrix(),d=this.padding;return Pt(i,a).translate(d.left,d.top)}resize(e,t){let i=e??this.container.offsetWidth,a=t??this.container.offsetHeight;typeof i=="number"&&(i=Math.round(i)),typeof a=="number"&&(a=Math.round(a)),this.options.width=i,this.options.height=a,this.$container.css({width:i,height:a}),this.update()}getClientSize(){return this.cachedClientSize?this.cachedClientSize:{width:this.container.clientWidth,height:this.container.clientHeight}}autoScroll(e,t){const a=this.container,d=a.getBoundingClientRect();let f=0,m=0;return e<=d.left+10&&(f=-10),t<=d.top+10&&(m=-10),e>=d.right-10&&(f=10),t>=d.bottom-10&&(m=10),f!==0&&(a.scrollLeft+=f),m!==0&&(a.scrollTop+=m),{scrollerX:f,scrollerY:m}}addPadding(e,t,i,a){let d=this.getPadding();this.padding={left:Math.round(d.left+(e||0)),top:Math.round(d.top+(i||0)),bottom:Math.round(d.bottom+(a||0)),right:Math.round(d.right+(t||0))},d=this.padding,this.$content.css({width:d.left+this.graph.options.width+d.right,height:d.top+this.graph.options.height+d.bottom});const f=this.graph.container;return f.style.left=`${this.padding.left}px`,f.style.top=`${this.padding.top}px`,this}getPadding(){const e=this.options.padding;return Ma(typeof e=="function"?Pn(e,this,this):e)}getVisibleArea(){const e=this.graph.matrix(),t=this.getClientSize(),i={x:this.container.scrollLeft||0,y:this.container.scrollTop||0,width:t.width,height:t.height},a=va(i,e.inverse());return a.x-=(this.padding.left||0)/this.sx,a.y-=(this.padding.top||0)/this.sy,a}isCellVisible(e,t={}){const i=e.getBBox(),a=this.getVisibleArea();return t.strict?a.containsRect(i):a.isIntersectWithRect(i)}isPointVisible(e){return this.getVisibleArea().containsPoint(e)}lock(){return this.$container.css("overflow","hidden"),this}unlock(){return this.$container.css("overflow","scroll"),this}onRemove(){this.stopListening()}dispose(){this.$(this.graph.container).insertBefore(this.$container),this.remove()}}zd([ii.dispose()],mp.prototype,"dispose",null),function(c){class e extends kg{constructor(i){super(i.graph),this.scroller=i,i.options.background&&this.draw(i.options.background)}get elem(){return this.scroller.background}init(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}updateBackgroundOptions(i){this.scroller.options.background=i}}c.Background=e}(mp||(mp={}));var Sl;(function(c){c.containerClass="graph-scroller",c.panningClass=`${c.containerClass}-panning`,c.pannableClass=`${c.containerClass}-pannable`,c.pagedClass=`${c.containerClass}-paged`,c.contentClass=`${c.containerClass}-content`,c.backgroundClass=`${c.containerClass}-background`,c.transitionClassName="transition-in-progress",c.transitionEventName="transitionend.graph-scroller-transition",c.defaultOptions={padding(){const t=this.getClientSize(),i=Math.max(this.options.minVisibleWidth||0,1)||1,a=Math.max(this.options.minVisibleHeight||0,1)||1,d=Math.max(t.width-i,0),f=Math.max(t.height-a,0);return{left:d,top:f,right:d,bottom:f}},minVisibleWidth:50,minVisibleHeight:50,pageVisible:!1,pageBreak:!1,autoResize:!0};function e(t){const i=Pi.Z({},c.defaultOptions,t);return i.pageWidth==null&&(i.pageWidth=t.graph.options.width),i.pageHeight==null&&(i.pageHeight=t.graph.options.height),i}c.getOptions=e})(Sl||(Sl={}));function Wi(c,e,t,i={}){if(t){const a=t.graph,d=a.view.normalizeEvent(e),f=a.snapToGrid(d.clientX,d.clientY);t.notify(c,Object.assign({e:d,view:t,node:t.cell,cell:t.cell,x:f.x,y:f.y},i))}}var Rg=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class rc extends ii{constructor(e){super(),this.options=Pi.Z({},co.defaultOptions,e),this.options.model&&(this.options.collection=this.options.model.collection),this.options.collection?this.collection=this.options.collection:(this.collection=new Zx([],{comparator:co.depthComparator}),this.options.collection=this.collection),this.boxCount=0,this.createContainer(),this.initHandles(),this.startListening()}get graph(){return this.options.graph}get boxClassName(){return this.prefixClassName(co.classNames.box)}get $boxes(){return this.$container.children(`.${this.boxClassName}`)}get handleOptions(){return this.options}startListening(){const e=this.graph,t=this.collection;this.delegateEvents({[`mousedown .${this.boxClassName}`]:"onSelectionBoxMouseDown",[`touchstart .${this.boxClassName}`]:"onSelectionBoxMouseDown"},!0),e.on("scale",this.onGraphTransformed,this),e.on("translate",this.onGraphTransformed,this),e.model.on("updated",this.onModelUpdated,this),t.on("added",this.onCellAdded,this),t.on("removed",this.onCellRemoved,this),t.on("reseted",this.onReseted,this),t.on("updated",this.onCollectionUpdated,this),t.on("node:change:position",this.onNodePositionChanged,this),t.on("cell:changed",this.onCellChanged,this)}stopListening(){const e=this.graph,t=this.collection;this.undelegateEvents(),e.off("scale",this.onGraphTransformed,this),e.off("translate",this.onGraphTransformed,this),e.model.off("updated",this.onModelUpdated,this),t.off("added",this.onCellAdded,this),t.off("removed",this.onCellRemoved,this),t.off("reseted",this.onReseted,this),t.off("updated",this.onCollectionUpdated,this),t.off("node:change:position",this.onNodePositionChanged,this),t.off("cell:changed",this.onCellChanged,this)}onRemove(){this.stopListening()}onGraphTransformed(){this.updateSelectionBoxes({async:!1})}onCellChanged(){this.updateSelectionBoxes()}onNodePositionChanged({node:e,options:t}){const{showNodeSelectionBox:i,pointerEvents:a}=this.options,{ui:d,selection:f,translateBy:m}=t;let y=!this.translating;if(y=y&&(i!==!0||a==="none"),y=y&&d&&!f,y=y&&m&&e.id===m,y){this.translating=!0;const x=e.position(),E=e.previous("position"),S=x.x-E.x,T=x.y-E.y;(S!==0||T!==0)&&this.translateSelectedNodes(S,T,e,t),this.translating=!1}}onModelUpdated({removed:e}){e&&e.length&&this.unselect(e)}isEmpty(){return this.length<=0}isSelected(e){return this.collection.has(e)}get length(){return this.collection.length}get cells(){return this.collection.toArray()}select(e,t={}){t.dryrun=!0;const i=this.filter(Array.isArray(e)?e:[e]);return this.collection.add(i,t),this}unselect(e,t={}){return t.dryrun=!0,this.collection.remove(Array.isArray(e)?e:[e],t),this}reset(e,t={}){if(e){if(t.batch){const x=this.filter(Array.isArray(e)?e:[e]);return this.collection.reset(x,Object.assign(Object.assign({},t),{ui:!0})),this}const i=this.cells,a=this.filter(Array.isArray(e)?e:[e]),d={},f={};i.forEach(x=>d[x.id]=x),a.forEach(x=>f[x.id]=x);const m=[],y=[];return a.forEach(x=>{d[x.id]||m.push(x)}),i.forEach(x=>{f[x.id]||y.push(x)}),y.length&&this.unselect(y,Object.assign(Object.assign({},t),{ui:!0})),m.length&&this.select(m,Object.assign(Object.assign({},t),{ui:!0})),y.length===0&&m.length===0&&this.updateContainer(),this}return this.clean(t)}clean(e={}){return this.length&&(e.batch===!1?this.unselect(this.cells,e):this.collection.reset([],Object.assign(Object.assign({},e),{ui:!0}))),this}setFilter(e){this.options.filter=e}setContent(e){this.options.content=e}startSelecting(e){e=this.normalizeEvent(e),this.clean();let t,i;const a=this.graph.container;if(e.offsetX!=null&&e.offsetY!=null&&a.contains(e.target))t=e.offsetX,i=e.offsetY;else{const d=this.$(a).offset(),f=a.scrollLeft,m=a.scrollTop;t=e.clientX-d.left+window.pageXOffset+f,i=e.clientY-d.top+window.pageYOffset+m}this.$container.css({top:i,left:t,width:1,height:1}),this.setEventData(e,{action:"selecting",clientX:e.clientX,clientY:e.clientY,offsetX:t,offsetY:i,scrollerX:0,scrollerY:0}),this.delegateDocumentEvents(co.documentEvents,e.data)}filter(e){const t=this.options.filter;return Array.isArray(t)?e.filter(i=>!t.includes(i)&&!t.includes(i.shape)):typeof t=="function"?e.filter(i=>Pn(t,this.graph,i)):e}stopSelecting(e){const t=this.graph,i=this.getEventData(e);switch(i.action){case"selecting":{let d=this.$container.width(),f=this.$container.height();const m=this.$container.offset(),y=t.pageToLocal(m.left,m.top),x=t.transform.getScale();d/=x.sx,f/=x.sy;const E=new gn(y.x,y.y,d,f),S=this.getCellViewsInArea(E).map(T=>T.cell);this.reset(S,{batch:!0}),this.hideRubberband();break}case"translating":{const d=t.snapToGrid(e.clientX,e.clientY);if(!this.options.following){const f=i;this.updateSelectedNodesPosition({dx:f.clientX-f.originX,dy:f.clientY-f.originY})}this.graph.model.stopBatch("move-selection"),this.notifyBoxEvent("box:mouseup",e,d.x,d.y);break}default:{this.clean();break}}}onMouseUp(e){this.getEventData(e).action&&(this.stopSelecting(e),this.undelegateDocumentEvents())}onSelectionBoxMouseDown(e){this.options.following||e.stopPropagation();const t=this.normalizeEvent(e);this.options.movable&&this.startTranslating(t);const i=this.getCellViewFromElem(t.target);this.setEventData(t,{activeView:i});const a=this.graph.snapToGrid(t.clientX,t.clientY);this.notifyBoxEvent("box:mousedown",t,a.x,a.y),this.delegateDocumentEvents(co.documentEvents,t.data)}startTranslating(e){this.graph.model.startBatch("move-selection");const t=this.graph.snapToGrid(e.clientX,e.clientY);this.setEventData(e,{action:"translating",clientX:t.x,clientY:t.y,originX:t.x,originY:t.y})}getSelectionOffset(e,t){let i=e.x-t.clientX,a=e.y-t.clientY;const d=this.graph.hook.getRestrictArea();if(d){const f=this.collection.toArray(),m=Xr.getCellsBBox(f,{deep:!0})||gn.create(),y=d.x-m.x,x=d.y-m.y,E=d.x+d.width-(m.x+m.width),S=d.y+d.height-(m.y+m.height);if(i<y&&(i=y),a<x&&(a=x),E<i&&(i=E),S<a&&(a=S),!this.options.following){const T=e.x-t.originX,R=e.y-t.originY;i=T<=y||T>=E?0:i,a=R<=x||R>=S?0:a}}return{dx:i,dy:a}}updateSelectedNodesPosition(e){const{dx:t,dy:i}=e;if(t||i)if(this.translateSelectedNodes(t,i),this.boxesUpdated)this.collection.length>1&&this.updateSelectionBoxes();else{const a=this.graph.transform.getScale();this.$boxes.add(this.$selectionContainer).css({left:`+=${t*a.sx}`,top:`+=${i*a.sy}`})}}autoScrollGraph(e,t){const i=this.graph.scroller.widget;return i?i.autoScroll(e,t):{scrollerX:0,scrollerY:0}}adjustSelection(e){const t=this.normalizeEvent(e),i=this.getEventData(t);switch(i.action){case"selecting":{const d=i;d.moving!==!0&&(this.$container.appendTo(this.graph.container),this.showRubberband(),d.moving=!0);const{scrollerX:f,scrollerY:m}=this.autoScrollGraph(t.clientX,t.clientY);d.scrollerX+=f,d.scrollerY+=m;const y=t.clientX-d.clientX+d.scrollerX,x=t.clientY-d.clientY+d.scrollerY,E=parseInt(this.$container.css("left"),10),S=parseInt(this.$container.css("top"),10);this.$container.css({left:y<0?d.offsetX+y:E,top:x<0?d.offsetY+x:S,width:Math.abs(y),height:Math.abs(x)});break}case"translating":{const d=this.graph.snapToGrid(t.clientX,t.clientY),f=i,m=this.getSelectionOffset(d,f);this.options.following?this.updateSelectedNodesPosition(m):this.updateContainerPosition(m),m.dx&&(f.clientX=d.x),m.dy&&(f.clientY=d.y),this.notifyBoxEvent("box:mousemove",e,d.x,d.y);break}default:break}this.boxesUpdated=!1}translateSelectedNodes(e,t,i,a){const d={},f=[];if(i&&(d[i.id]=!0),this.collection.toArray().forEach(m=>{m.getDescendants({deep:!0}).forEach(y=>{d[y.id]=!0})}),a&&a.translateBy){const m=this.graph.getCellById(a.translateBy);m&&(d[m.id]=!0,m.getDescendants({deep:!0}).forEach(y=>{d[y.id]=!0}),f.push(m))}this.collection.toArray().forEach(m=>{if(!d[m.id]){const y=Object.assign(Object.assign({},a),{selection:this.cid,exclude:f});m.translate(e,t,y),this.graph.model.getConnectedEdges(m).forEach(x=>{d[x.id]||(x.translate(e,t,y),d[x.id]=!0)})}})}getCellViewsInArea(e){const t=this.graph,i={strict:this.options.strict};let a=[];return this.options.rubberNode&&(this.options.useCellGeometry?a=a.concat(t.model.getNodesInArea(e,i).map(d=>t.renderer.findViewByCell(d)).filter(d=>d!=null)):a=a.concat(t.renderer.findViewsInArea(e,i))),this.options.rubberEdge&&(this.options.useCellGeometry?a=a.concat(t.model.getEdgesInArea(e,i).map(d=>t.renderer.findViewByCell(d)).filter(d=>d!=null)):a=a.concat(t.renderer.findEdgeViewsInArea(e,i))),a}notifyBoxEvent(e,t,i,a){const f=this.getEventData(t).activeView;this.trigger(e,{e:t,view:f,x:i,y:a,cell:f.cell})}getSelectedClassName(e){return this.prefixClassName(`${e.isNode()?"node":"edge"}-selected`)}addCellSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.addClass(this.getSelectedClassName(e))}removeCellUnSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.removeClass(this.getSelectedClassName(e))}destroySelectionBox(e){this.removeCellUnSelectedClassName(e),this.canShowSelectionBox(e)&&(this.$container.find(`[data-cell-id="${e.id}"]`).remove(),this.$boxes.length===0&&this.hide(),this.boxCount=Math.max(0,this.boxCount-1))}destroyAllSelectionBoxes(e){e.forEach(t=>this.removeCellUnSelectedClassName(t)),this.hide(),this.$boxes.remove(),this.boxCount=0}hide(){this.$container.removeClass(this.prefixClassName(co.classNames.rubberband)).removeClass(this.prefixClassName(co.classNames.selected))}showRubberband(){this.$container.addClass(this.prefixClassName(co.classNames.rubberband))}hideRubberband(){this.$container.removeClass(this.prefixClassName(co.classNames.rubberband))}showSelected(){this.$container.removeAttr("style").addClass(this.prefixClassName(co.classNames.selected))}createContainer(){this.container=document.createElement("div"),this.$container=this.$(this.container),this.$container.addClass(this.prefixClassName(co.classNames.root)),this.options.className&&this.$container.addClass(this.options.className),this.$selectionContainer=this.$("<div/>").addClass(this.prefixClassName(co.classNames.inner)),this.$selectionContent=this.$("<div/>").addClass(this.prefixClassName(co.classNames.content)),this.$selectionContainer.append(this.$selectionContent),this.$selectionContainer.attr("data-selection-length",this.collection.length),this.$container.prepend(this.$selectionContainer),this.$handleContainer=this.$selectionContainer}updateContainerPosition(e){(e.dx||e.dy)&&this.$selectionContainer.css({left:`+=${e.dx}`,top:`+=${e.dy}`})}updateContainer(){const e={x:1/0,y:1/0},t={x:0,y:0};this.collection.toArray().filter(d=>this.canShowSelectionBox(d)).forEach(d=>{const f=this.graph.renderer.findViewByCell(d);if(f){const m=f.getBBox({useCellGeometry:this.options.useCellGeometry});e.x=Math.min(e.x,m.x),e.y=Math.min(e.y,m.y),t.x=Math.max(t.x,m.x+m.width),t.y=Math.max(t.y,m.y+m.height)}}),this.$selectionContainer.css({position:"absolute",pointerEvents:"none",left:e.x,top:e.y,width:t.x-e.x,height:t.y-e.y}).attr("data-selection-length",this.collection.length);const a=this.options.content;if(a)if(typeof a=="function"){const d=Pn(a,this.graph,this,this.$selectionContent[0]);d&&this.$selectionContent.html(d)}else this.$selectionContent.html(a);this.collection.length>0&&!this.container.parentNode?this.$container.appendTo(this.graph.container):this.collection.length<=0&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}canShowSelectionBox(e){return e.isNode()&&this.options.showNodeSelectionBox===!0||e.isEdge()&&this.options.showEdgeSelectionBox===!0}createSelectionBox(e){if(this.addCellSelectedClassName(e),this.canShowSelectionBox(e)){const t=this.graph.renderer.findViewByCell(e);if(t){const i=t.getBBox({useCellGeometry:this.options.useCellGeometry}),a=this.boxClassName;this.$("<div/>").addClass(a).addClass(`${a}-${e.isNode()?"node":"edge"}`).attr("data-cell-id",e.id).css({position:"absolute",left:i.x,top:i.y,width:i.width,height:i.height,pointerEvents:this.options.pointerEvents||"auto"}).appendTo(this.container),this.showSelected(),this.boxCount+=1}}}updateSelectionBoxes(e={}){this.collection.length>0&&(this.boxesUpdated=!0,this.graph.renderer.requestViewUpdate(this,1,2,e))}confirmUpdate(){return this.boxCount&&(this.hide(),this.$boxes.each((e,t)=>{const i=this.$(t).remove().attr("data-cell-id"),a=this.collection.get(i);a&&this.createSelectionBox(a)}),this.updateContainer()),0}getCellViewFromElem(e){const t=e.getAttribute("data-cell-id");if(t){const i=this.collection.get(t);if(i)return this.graph.renderer.findViewByCell(i)}return null}onCellRemoved({cell:e}){this.destroySelectionBox(e),this.updateContainer()}onReseted({previous:e,current:t}){this.destroyAllSelectionBoxes(e),t.forEach(i=>{this.listenCellRemoveEvent(i),this.createSelectionBox(i)}),this.updateContainer()}onCellAdded({cell:e}){this.listenCellRemoveEvent(e),this.createSelectionBox(e),this.updateContainer()}listenCellRemoveEvent(e){e.off("removed",this.onCellRemoved,this),e.on("removed",this.onCellRemoved,this)}onCollectionUpdated({added:e,removed:t,options:i}){e.forEach(d=>{this.trigger("cell:selected",{cell:d,options:i}),this.graph.trigger("cell:selected",{cell:d,options:i}),d.isNode()?(this.trigger("node:selected",{cell:d,options:i,node:d}),this.graph.trigger("node:selected",{cell:d,options:i,node:d})):d.isEdge()&&(this.trigger("edge:selected",{cell:d,options:i,edge:d}),this.graph.trigger("edge:selected",{cell:d,options:i,edge:d}))}),t.forEach(d=>{this.trigger("cell:unselected",{cell:d,options:i}),this.graph.trigger("cell:unselected",{cell:d,options:i}),d.isNode()?(this.trigger("node:unselected",{cell:d,options:i,node:d}),this.graph.trigger("node:unselected",{cell:d,options:i,node:d})):d.isEdge()&&(this.trigger("edge:unselected",{cell:d,options:i,edge:d}),this.graph.trigger("edge:unselected",{cell:d,options:i,edge:d}))});const a={added:e,removed:t,options:i,selected:this.cells.filter(d=>!!this.graph.getCellById(d.id))};this.trigger("selection:changed",a),this.graph.trigger("selection:changed",a)}deleteSelectedCells(){const e=this.collection.toArray();this.clean(),this.graph.model.removeCells(e,{selection:this.cid})}startRotate({e}){const t=this.collection.toArray(),i=Xr.getCellsBBox(t).getCenter(),a=this.graph.snapToGrid(e.clientX,e.clientY),d=t.reduce((f,m)=>(f[m.id]=ri.normalize(m.getAngle()),f),{});this.setEventData(e,{center:i,angles:d,start:a.theta(i)})}doRotate({e}){const t=this.getEventData(e),i=this.graph.options.rotating.grid,a=typeof i=="function"?Pn(i,this.graph,null):i,d=this.graph.snapToGrid(e.clientX,e.clientY),f=t.start-d.theta(t.center);t.rotated||(t.rotated=!0),Math.abs(f)>.001&&(this.collection.toArray().forEach(m=>{const y=Bo.snapToGrid(t.angles[m.id]+f,a||15);m.rotate(y,{absolute:!0,center:t.center,selection:this.cid})}),this.updateSelectionBoxes())}stopRotate({e}){const t=this.getEventData(e);t.rotated&&(t.rotated=!1,this.collection.toArray().forEach(i=>{Wi("node:rotated",e,this.graph.findViewByCell(i))}))}startResize({e}){const t=this.graph.getGridSize(),i=this.collection.toArray(),a=Xr.getCellsBBox(i),d=i.map(y=>y.getBBox()),f=d.reduce((y,x)=>x.width<y?x.width:y,1/0),m=d.reduce((y,x)=>x.height<y?x.height:y,1/0);this.setEventData(e,{bbox:a,cells:this.graph.model.getSubGraph(i),minWidth:t*a.width/f,minHeight:t*a.height/m})}doResize({e,dx:t,dy:i}){const a=this.eventData(e),d=a.bbox,f=d.width,m=d.height,y=Math.max(f+t,a.minWidth),x=Math.max(m+i,a.minHeight);a.resized||(a.resized=!0),(Math.abs(f-y)>.001||Math.abs(m-x)>.001)&&(this.graph.model.resizeCells(y,x,a.cells,{selection:this.cid}),d.width=y,d.height=x,this.updateSelectionBoxes())}stopResize({e}){const t=this.eventData(e);t.resized&&(t.resized=!1,this.collection.toArray().forEach(i=>{Wi("node:resized",e,this.graph.findViewByCell(i))}))}dispose(){this.clean(),this.remove()}}Rg([ii.dispose()],rc.prototype,"dispose",null),Ef(rc,Gd);var co;(function(c){const e="widget-selection";c.classNames={root:e,inner:`${e}-inner`,box:`${e}-box`,content:`${e}-content`,rubberband:`${e}-rubberband`,selected:`${e}-selected`},c.documentEvents={mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},c.defaultOptions={movable:!0,following:!0,strict:!1,useCellGeometry:!1,content(i){return Tt('<%= length %> node<%= length > 1 ? "s":"" %> selected.')({length:i.length})},handles:[{name:"remove",position:"nw",events:{mousedown:"deleteSelectedCells"}},{name:"rotate",position:"sw",events:{mousedown:"startRotate",mousemove:"doRotate",mouseup:"stopRotate"}},{name:"resize",position:"se",events:{mousedown:"startResize",mousemove:"doResize",mouseup:"stopResize"}}]};function t(i){return i.getAncestors().length}c.depthComparator=t})(co||(co={}));class vp extends fp{get node(){return this.cell}get containerClassName(){return this.prefixClassName("widget-transform")}get resizeClassName(){return`${this.containerClassName}-resize`}get rotateClassName(){return`${this.containerClassName}-rotate`}init(e){this.options=Object.assign(Object.assign({},uo.defaultOptions),e),this.render(),this.startListening()}startListening(){this.delegateEvents({[`mousedown .${this.resizeClassName}`]:"startResizing",[`touchstart .${this.resizeClassName}`]:"startResizing",[`mousedown .${this.rotateClassName}`]:"startRotating",[`touchstart .${this.rotateClassName}`]:"startRotating"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.node.on("removed",this.remove,this),this.model.on("reseted",this.remove,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this),super.startListening()}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.node.off("removed",this.remove,this),this.model.off("reseted",this.remove,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this),super.stopListening()}renderHandles(){this.container=document.createElement("div"),this.$container=this.$(this.container);const e=this.$("<div/>").prop("draggable",!1),t=e.clone().addClass(this.rotateClassName),i=uo.POSITIONS.map(a=>e.clone().addClass(this.resizeClassName).attr("data-position",a));this.empty(),this.$container.append(i,t)}render(){return this.renderHandles(),this.view.addClass(uo.NODE_CLS),this.$container.addClass(this.containerClassName).toggleClass("no-orth-resize",this.options.preserveAspectRatio||!this.options.orthogonalResizing).toggleClass("no-resize",!this.options.resizable).toggleClass("no-rotate",!this.options.rotatable),this.options.className&&this.$container.addClass(this.options.className),this.graph.container.appendChild(this.container),this.update()}update(){const e=this.graph.matrix(),t=this.node.getBBox();t.x*=e.a,t.x+=e.e,t.y*=e.d,t.y+=e.f,t.width*=e.a,t.height*=e.d;const i=ri.normalize(this.node.getAngle()),a=i!==0?`rotate(${i}deg)`:"";return this.$container.css({transform:a,width:t.width,height:t.height,left:t.x,top:t.y}),this.updateResizerDirections(),this}remove(){return this.view.removeClass(uo.NODE_CLS),super.remove()}onKnobMouseDown(){this.startHandle()}onKnobMouseUp(){this.stopHandle()}updateResizerDirections(){const e=ri.normalize(this.node.getAngle()),t=Math.floor(e*(uo.DIRECTIONS.length/360));if(t!==this.prevShift){const i=uo.DIRECTIONS.slice(t).concat(uo.DIRECTIONS.slice(0,t)),a=d=>`${this.containerClassName}-cursor-${d}`;this.$container.find(`.${this.resizeClassName}`).removeClass(uo.DIRECTIONS.map(d=>a(d)).join(" ")).each((d,f)=>{this.$(f).addClass(a(i[d]))}),this.prevShift=t}}getTrueDirection(e){const t=ri.normalize(this.node.getAngle());let i=uo.POSITIONS.indexOf(e);return i+=Math.floor(t*(uo.POSITIONS.length/360)),i%=uo.POSITIONS.length,uo.POSITIONS[i]}toValidResizeDirection(e){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[e]||e}startResizing(e){e.stopPropagation(),this.model.startBatch("resize",{cid:this.cid});const t=this.$(e.target).attr("data-position"),i=this.graph.findViewByCell(this.node);this.prepareResizing(e,t),this.startAction(e),Wi("node:resize:mousedown",e,i)}prepareResizing(e,t){const i=this.getTrueDirection(t);let a=0,d=0;t.split("-").forEach(x=>{a={left:-1,right:1}[x]||a,d={top:-1,bottom:1}[x]||d});const f=this.toValidResizeDirection(t),m={"top-right":"bottomLeft","top-left":"bottomRight","bottom-left":"topRight","bottom-right":"topLeft"}[f],y=ri.normalize(this.node.getAngle());this.setEventData(e,{selector:m,direction:f,trueDirection:i,relativeDirection:t,angle:y,resizeX:a,resizeY:d,action:"resizing"})}startRotating(e){e.stopPropagation(),this.model.startBatch("rotate",{cid:this.cid});const t=this.graph.findViewByCell(this.node),i=this.node.getBBox().getCenter(),a=this.normalizeEvent(e),d=this.graph.snapToGrid(a.clientX,a.clientY);this.setEventData(e,{center:i,action:"rotating",angle:ri.normalize(this.node.getAngle()),start:Oe.create(d).theta(i)}),this.startAction(e),Wi("node:rotate:mousedown",e,t)}onMouseMove(e){const t=this.graph.findViewByCell(this.node);let i=this.getEventData(e);if(i.action){const a=this.normalizeEvent(e);let d=a.clientX,f=a.clientY;const m=this.graph.scroller.widget,y=this.options.restrictedResizing;if(y===!0||typeof y=="number"){const R=y===!0?0:y,V=m?Math.max(R,8):R,j=this.graph.container.getBoundingClientRect();d=Ta(d,j.left+V,j.right-V),f=Ta(f,j.top+V,j.bottom-V)}else this.options.autoScrollOnResizing&&m&&m.autoScroll(d,f);const x=this.graph.snapToGrid(d,f),E=this.graph.getGridSize(),S=this.node,T=this.options;if(i.action==="resizing"){i=i,i.resized||(t&&(t.addClass("node-resizing"),Wi("node:resize",e,t)),i.resized=!0);const R=S.getBBox(),V=Oe.create(x).rotate(i.angle,R.getCenter()).diff(R[i.selector]);let j=i.resizeX?V.x*i.resizeX:R.width,q=i.resizeY?V.y*i.resizeY:R.height;const ue=j,be=q;if(j=Bo.snapToGrid(j,E),q=Bo.snapToGrid(q,E),j=Math.max(j,T.minWidth||E),q=Math.max(q,T.minHeight||E),j=Math.min(j,T.maxWidth||1/0),q=Math.min(q,T.maxHeight||1/0),T.preserveAspectRatio){const Pe=R.width*q/R.height,He=R.height*j/R.width;j<Pe?q=He:j=Pe}const se=i.relativeDirection;if(T.allowReverse&&(ue<=-j||be<=-q)){let Pe;se==="left"?ue<=-j&&(Pe="right"):se==="right"?ue<=-j&&(Pe="left"):se==="top"?be<=-q&&(Pe="bottom"):se==="bottom"?be<=-q&&(Pe="top"):se==="top-left"?ue<=-j&&be<=-q?Pe="bottom-right":ue<=-j?Pe="top-right":be<=-q&&(Pe="bottom-left"):se==="top-right"?ue<=-j&&be<=-q?Pe="bottom-left":ue<=-j?Pe="top-left":be<=-q&&(Pe="bottom-right"):se==="bottom-left"?ue<=-j&&be<=-q?Pe="top-right":ue<=-j?Pe="bottom-right":be<=-q&&(Pe="top-left"):se==="bottom-right"&&(ue<=-j&&be<=-q?Pe="top-left":ue<=-j?Pe="bottom-left":be<=-q&&(Pe="top-right"));const He=Pe;this.stopHandle();const ft=this.$container.find(`.${this.resizeClassName}[data-position="${He}"]`);this.startHandle(ft[0]),this.prepareResizing(e,He),this.onMouseMove(e)}if(R.width!==j||R.height!==q){const Pe={ui:!0,direction:i.direction,relativeDirection:i.relativeDirection,trueDirection:i.trueDirection,minWidth:T.minWidth,minHeight:T.minHeight,maxWidth:T.maxWidth,maxHeight:T.maxHeight,preserveAspectRatio:T.preserveAspectRatio===!0};S.resize(j,q,Pe),Wi("node:resizing",e,t)}Wi("node:resize:mousemove",e,t)}else if(i.action==="rotating"){i=i,i.rotated||(t&&(t.addClass("node-rotating"),Wi("node:rotate",e,t)),i.rotated=!0);const R=S.getAngle(),V=i.start-Oe.create(x).theta(i.center);let j=i.angle+V;T.rotateGrid&&(j=Bo.snapToGrid(j,T.rotateGrid)),j=ri.normalize(j),R!==j&&(S.rotate(j,{absolute:!0}),Wi("node:rotating",e,t)),Wi("node:rotate:mousemove",e,t)}}}onMouseUp(e){const t=this.graph.findViewByCell(this.node),i=this.getEventData(e);i.action&&(this.stopAction(e),this.model.stopBatch(i.action==="resizing"?"resize":"rotate",{cid:this.cid}),i.action==="resizing"?Wi("node:resize:mouseup",e,t):i.action==="rotating"&&Wi("node:rotate:mouseup",e,t))}startHandle(e){if(this.handle=e||null,this.$container.addClass(`${this.containerClassName}-active`),e){this.$(e).addClass(`${this.containerClassName}-active-handle`);const t=e.getAttribute("data-position");if(t){const i=uo.DIRECTIONS[uo.POSITIONS.indexOf(t)];this.$container.addClass(`${this.containerClassName}-cursor-${i}`)}}}stopHandle(){if(this.$container.removeClass(`${this.containerClassName}-active`),this.handle){this.$(this.handle).removeClass(`${this.containerClassName}-active-handle`);const e=this.handle.getAttribute("data-position");if(e){const t=uo.DIRECTIONS[uo.POSITIONS.indexOf(e)];this.$container.removeClass(`${this.containerClassName}-cursor-${t}`)}this.handle=null}}startAction(e){this.startHandle(e.target),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(uo.documentEvents,e.data)}stopAction(e){this.stopHandle(),this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const t=this.graph.findViewByCell(this.node),i=this.getEventData(e);t&&(t.removeClass(`node-${i.action}`),i.action==="resizing"&&i.resized?Wi("node:resized",e,t):i.action==="rotating"&&i.rotated&&Wi("node:rotated",e,t))}}var uo;(function(c){c.NODE_CLS="has-widget-transform",c.DIRECTIONS=["nw","n","ne","e","se","s","sw","w"],c.POSITIONS=["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],c.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"},c.defaultOptions={minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,rotateGrid:15,rotatable:!0,preserveAspectRatio:!1,orthogonalResizing:!0,restrictedResizing:!1,autoScrollOnResizing:!0,allowReverse:!0}})(uo||(uo={}));var Ig=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t},Da;(function(c){function e(t,i,a){const d={};return Object.keys(a||{}).forEach(f=>{const m=a[f];d[f]=typeof m=="function"?m.call(t,i):m}),d}c.parseOptionGroup=e})(Da||(Da={})),function(c){function e(t){const{grid:i,panning:a,selecting:d,embedding:f,snapline:m,resizing:y,rotating:x,knob:E,clipboard:S,history:T,scroller:R,minimap:V,keyboard:j,mousewheel:q}=t,ue=Ig(t,["grid","panning","selecting","embedding","snapline","resizing","rotating","knob","clipboard","history","scroller","minimap","keyboard","mousewheel"]),be=t.container;if(be!=null)ue.width==null&&(ue.width=be.clientWidth),ue.height==null&&(ue.height=be.clientHeight);else throw new Error("Ensure the container of the graph is specified and valid");const se=Pi.Z({},c.defaults,ue),Pe={size:10,visible:!1};return typeof i=="number"?se.grid={size:i,visible:!1}:typeof i=="boolean"?se.grid=Object.assign(Object.assign({},Pe),{visible:i}):se.grid=Object.assign(Object.assign({},Pe),i),["panning","selecting","embedding","snapline","resizing","rotating","knob","clipboard","history","scroller","minimap","keyboard","mousewheel"].forEach(ft=>{const pt=t[ft];typeof pt=="boolean"?se[ft].enabled=pt:se[ft]=Object.assign(Object.assign({},se[ft]),pt)}),se.background&&se.scroller.enabled&&se.scroller.background==null&&(se.scroller.background=se.background,delete se.background),se}c.get=e}(Da||(Da={})),function(c){c.defaults={x:0,y:0,grid:{size:10,visible:!1},scaling:{min:.01,max:16},background:!1,highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:Bo.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:Bo.prefix("available-magnet")}}},connecting:{snap:!1,multi:!0,dangling:!0,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",strategy:null,router:"normal",connector:"normal",validateConnection({type:e,sourceView:t,targetView:i}){return(e==="target"?i:t)!=null},createEdge(){return new m0}},transforming:{clearAll:!0,clearOnBlankMouseDown:!0},resizing:{enabled:!1,minWidth:0,minHeight:0,maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,orthogonal:!0,restricted:!1,autoScroll:!0,preserveAspectRatio:!1,allowReverse:!0},rotating:{enabled:!1,grid:15},translating:{restrict:!1},knob:{enabled:!1,clearAll:!0,clearOnBlankMouseDown:!0},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},selecting:{enabled:!1,rubberband:!1,rubberNode:!0,rubberEdge:!1,pointerEvents:"auto",multiple:!0,multipleSelectionModifiers:["ctrl","meta"],movable:!0,strict:!1,useCellGeometry:!1,selectCellOnMoved:!1,selectNodeOnMoved:!1,selectEdgeOnMoved:!1,content:null,handles:null},panning:{enabled:!1,eventTypes:["leftMouseDown"]},snapline:{enabled:!1},clipboard:{enabled:!1},history:{enabled:!1},scroller:{enabled:!1},keyboard:{enabled:!1},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},async:!1,frozen:!1,sorting:"exact",moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},guard:()=>!1}}(Da||(Da={}));var ic=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Ud extends Di{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(e){return this.svg.getElementById(e)!=null}filter(e){let t=e.id;const i=e.name;if(t||(t=`filter-${i}-${this.cid}-${ig(JSON.stringify(e))}`),!this.isDefined(t)){const a=Od.registry.get(i);if(a==null)return Od.registry.onNotFound(i);const d=a(e.args||{}),f=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},e.attrs),{id:t});In.create(li.sanitize(d),f).appendTo(this.defs)}return t}gradient(e){let t=e.id;const i=e.type;if(t||(t=`gradient-${i}-${this.cid}-${ig(JSON.stringify(e))}`),!this.isDefined(t)){const d=e.stops.map(y=>{const x=y.opacity!=null&&Number.isFinite(y.opacity)?y.opacity:1;return`<stop offset="${y.offset}" stop-color="${y.color}" stop-opacity="${x}"/>`}),f=`<${i}>${d.join("")}</${i}>`,m=Object.assign({id:t},e.attrs);In.create(f,m).appendTo(this.defs)}return t}marker(e){const{id:t,refX:i,refY:a,markerUnits:d,markerOrient:f,tagName:m,children:y}=e,x=ic(e,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let E=t;if(E||(E=`marker-${this.cid}-${ig(JSON.stringify(e))}`),!this.isDefined(E)){m!=="path"&&delete x.d;const S=In.create("marker",{refX:i,refY:a,id:E,overflow:"visible",orient:f??"auto",markerUnits:d||"userSpaceOnUse"},y?y.map(T=>{var{tagName:R}=T,V=ic(T,["tagName"]);return In.create(`${R}`||"path",Kf(Object.assign(Object.assign({},x),V)))}):[In.create(m||"path",Kf(x))]);this.defs.appendChild(S.node)}return E}remove(e){const t=this.svg.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)}}var Ws=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},jc=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Al extends Di{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(e){this.grid.visible!==e&&(this.grid.visible=e,this.update())}getGridSize(){return this.grid.size}setGridSize(e){this.grid.size=Math.max(e,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(e){this.clear(),this.instance=null,Object.assign(this.grid,e),this.patterns=this.resolveGrid(e),this.update()}update(e={}){const t=this.grid.size;if(t<=1||!this.grid.visible)return this.clear();const i=this.graph.matrix(),a=this.getInstance(),d=Array.isArray(e)?e:[e];this.patterns.forEach((y,x)=>{const E=`pattern_${x}`,S=i.a||1,T=i.d||1,{update:R,markup:V}=y,j=jc(y,["update","markup"]),q=Object.assign(Object.assign(Object.assign({},j),d[x]),{sx:S,sy:T,ox:i.e||0,oy:i.f||0,width:t*S,height:t*T});a.has(E)||a.add(E,In.create("pattern",{id:E,patternUnits:"userSpaceOnUse"},In.createVectors(V)).node);const ue=a.get(E);typeof R=="function"&&R(ue.childNodes[0],q);let be=q.ox%q.width;be<0&&(be+=q.width);let se=q.oy%q.height;se<0&&(se+=q.height),yi(ue,{x:be,y:se,width:q.width,height:q.height})});const f=new XMLSerializer().serializeToString(a.root),m=`url(data:image/svg+xml;base64,${btoa(f)})`;this.elem.style.backgroundImage=m}getInstance(){return this.instance||(this.instance=new Gc),this.instance}resolveGrid(e){if(!e)return[];const t=e.type;if(t==null)return[Object.assign(Object.assign({},Gc.presets.dot),e.args)];const i=Gc.registry.get(t);if(i){let a=e.args||[];return Array.isArray(a)||(a=[a]),Array.isArray(i)?i.map((d,f)=>Object.assign(Object.assign({},d),a[f])):[Object.assign(Object.assign({},i),a[0])]}return Gc.registry.onNotFound(t)}dispose(){this.stopListening(),this.clear()}}Ws([Di.dispose()],Al.prototype,"dispose",null);class Lg extends Di{getClientMatrix(){return On(this.view.stage.getScreenCTM())}getClientOffset(){const e=this.view.svg.getBoundingClientRect();return new Oe(e.left,e.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(e,t){return(typeof e=="number"?this.clientToLocalPoint(e,t):this.clientToLocalPoint(e.x,e.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(e,t){const i=Oe.create(e,t);return Pt(i,this.graph.matrix())}localToClientPoint(e,t){const i=Oe.create(e,t);return Pt(i,this.getClientMatrix())}localToPagePoint(e,t){return(typeof e=="number"?this.localToGraphPoint(e,t):this.localToGraphPoint(e)).translate(this.getPageOffset())}localToGraphRect(e,t,i,a){const d=gn.create(e,t,i,a);return va(d,this.graph.matrix())}localToClientRect(e,t,i,a){const d=gn.create(e,t,i,a);return va(d,this.getClientMatrix())}localToPageRect(e,t,i,a){return(typeof e=="number"?this.localToGraphRect(e,t,i,a):this.localToGraphRect(e)).translate(this.getPageOffset())}graphToLocalPoint(e,t){const i=Oe.create(e,t);return Pt(i,this.graph.matrix().inverse())}clientToLocalPoint(e,t){const i=Oe.create(e,t);return Pt(i,this.getClientMatrix().inverse())}clientToGraphPoint(e,t){const i=Oe.create(e,t);return Pt(i,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(e,t){const a=Oe.create(e,t).diff(this.getPageOffset());return this.graphToLocalPoint(a)}graphToLocalRect(e,t,i,a){const d=gn.create(e,t,i,a);return va(d,this.graph.matrix().inverse())}clientToLocalRect(e,t,i,a){const d=gn.create(e,t,i,a);return va(d,this.getClientMatrix().inverse())}clientToGraphRect(e,t,i,a){const d=gn.create(e,t,i,a);return va(d,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(e,t,i,a){const d=gn.create(e,t,i,a),f=this.getPageOffset();return d.x-=f.x,d.y-=f.y,this.graphToLocalRect(d)}}var UE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class y0 extends Di{constructor(){super(...arguments),this.widget=this.graph.hook.createSnapline()}dispose(){this.widget.dispose()}}UE([Di.dispose()],y0.prototype,"dispose",null);var Hc;(function(c){function e(a){const d=[],f=[];return Array.isArray(a)?d.push(...a):a.split("|").forEach(m=>{m.indexOf("&")===-1?d.push(m):f.push(...m.split("&"))}),{or:d,and:f}}c.parse=e;function t(a,d){if(a!=null&&d!=null){const f=e(a),m=e(d),y=f.or.sort(),x=m.or.sort(),E=f.and.sort(),S=m.and.sort(),T=(R,V)=>R.length===V.length&&(R.length===0||R.every((j,q)=>j===V[q]));return T(y,x)&&T(E,S)}return a==null&&d==null}c.equals=t;function i(a,d,f){if(d==null||Array.isArray(d)&&d.length===0)return f?a.altKey!==!0&&a.ctrlKey!==!0&&a.metaKey!==!0&&a.shiftKey!==!0:!0;const{or:m,and:y}=e(d),x=E=>{const S=`${E.toLowerCase()}Key`;return a[S]===!0};return m.some(E=>x(E))&&y.every(E=>x(E))}c.isMatch=i})(Hc||(Hc={}));var VE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class Ay extends Di{get widgetOptions(){return this.options.scroller}get pannable(){return this.widgetOptions?typeof this.widgetOptions.pannable=="object"?this.widgetOptions.pannable.enabled:!!this.widgetOptions.pannable:!1}init(){this.widget=this.graph.hook.createScroller(),this.startListening(),this.updateClassName(),this.widget&&this.widget.center()}startListening(){let e=[];const t=this.widgetOptions.pannable;typeof t=="object"?e=t.eventTypes||[]:e=["leftMouseDown"],e.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),this.view.$(this.widget.container).on("mousedown",this.onRightMouseDown))}stopListening(){let e=[];const t=this.widgetOptions.pannable;typeof t=="object"?e=t.eventTypes||[]:e=["leftMouseDown"],e.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&this.view.$(this.widget.container).off("mousedown",this.onRightMouseDown)}onRightMouseDown(e){e.button===2&&this.allowPanning(e,!0)&&this.widget&&(this.updateClassName(!0),this.widget.startPanning(e),this.widget.once("pan:stop",()=>this.updateClassName(!1)))}preparePanning({e}){this.widget&&(this.allowPanning(e,!0)||this.allowPanning(e)&&!this.graph.selection.allowRubberband(e,!0))&&(this.updateClassName(!0),this.widget.startPanning(e),this.widget.once("pan:stop",()=>this.updateClassName(!1)))}allowPanning(e,t){return this.widget&&this.pannable&&Hc.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowPanning(e)}updateClassName(e){if(this.widget==null)return;const t=this.widget.container,i=this.view.prefixClassName("graph-scroller-pannable");this.pannable?(vi(t,i),t.dataset.panning=(!!e).toString()):Wa(t,i)}enablePanning(){this.pannable||(this.widgetOptions.pannable=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.pannable=!1,this.updateClassName())}lock(){this.widget&&this.widget.lock()}unlock(){this.widget&&this.widget.unlock()}update(){this.widget&&this.widget.update()}enableAutoResize(){this.widget&&this.widget.enableAutoResize()}disableAutoResize(){this.widget&&this.widget.disableAutoResize()}resize(e,t){this.widget&&this.widget.resize(e,t)}dispose(){this.widget&&this.widget.dispose(),this.stopListening()}}VE([Di.dispose()],Ay.prototype,"dispose",null);var rC=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},iC=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Ty extends Di{get commonOptions(){const e=this.instanceOptions,{enabled:t}=e;return iC(e,["enabled"])}get instanceOptions(){return this.options.clipboard}get cells(){return this.widget.cells}get disabled(){return this.instanceOptions.enabled!==!0}init(){this.widget=this.graph.hook.createClipboard(),this.widget.deserialize(this.instanceOptions)}enable(){this.disabled&&(this.instanceOptions.enabled=!0)}disable(){this.disabled||(this.instanceOptions.enabled=!1)}copy(e,t={}){this.disabled||(this.widget.copy(e,this.graph,Object.assign(Object.assign({},this.commonOptions),t)),this.graph.trigger("clipboard:changed",{cells:e}))}cut(e,t={}){this.disabled||(this.widget.cut(e,this.graph,Object.assign(Object.assign({},this.commonOptions),t)),this.graph.trigger("clipboard:changed",{cells:e}))}paste(e={},t=this.graph){return this.disabled?[]:this.widget.paste(t,Object.assign(Object.assign({},this.commonOptions),e))}clean(e){(!this.disabled||e)&&(this.widget.clean(),this.graph.trigger("clipboard:changed",{cells:[]}))}isEmpty(){return this.widget.isEmpty()}dispose(){this.clean(!0)}}rC([Di.dispose()],Ty.prototype,"dispose",null);var jE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class Fg extends Di{constructor(){super(...arguments),this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:e,magnet:t,options:i={}}){const a=this.resolveHighlighter(i);if(!a)return;const d=this.getHighlighterId(t,a);if(!this.highlights[d]){const f=a.highlighter;f.highlight(e,t,Object.assign({},a.args)),this.highlights[d]={cellView:e,magnet:t,highlighter:f,args:a.args}}}onCellUnhighlight({magnet:e,options:t={}}){const i=this.resolveHighlighter(t);if(!i)return;const a=this.getHighlighterId(e,i);this.unhighlight(a)}resolveHighlighter(e){const t=this.options;let i=e.highlighter;if(i==null){const m=e.type;i=m&&t.highlighting[m]||t.highlighting.default}if(i==null)return null;const a=typeof i=="string"?{name:i}:i,d=a.name,f=Xa.registry.get(d);return f==null?Xa.registry.onNotFound(d):(Xa.check(d,f),{name:d,highlighter:f,args:a.args||{}})}getHighlighterId(e,t){return Ph(e),t.name+e.id+JSON.stringify(t.args)}unhighlight(e){const t=this.highlights[e];t&&(t.highlighter.unhighlight(t.cellView,t.magnet,t.args),delete this.highlights[e])}dispose(){Object.keys(this.highlights).forEach(e=>this.unhighlight(e)),this.stopListening()}}jE([Fg.dispose()],Fg.prototype,"dispose",null);var b0=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class x0 extends Di{constructor(){super(...arguments),this.widgets=new Map}get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get isSelectionEnabled(){return this.options.selecting.enabled===!0}init(){this.startListening(),this.resize()}startListening(){this.graph.on("node:mouseup",this.onNodeMouseUp,this),this.graph.on("node:selected",this.onNodeSelected,this),this.graph.on("node:unselected",this.onNodeUnSelected,this)}stopListening(){this.graph.off("node:mouseup",this.onNodeMouseUp,this),this.graph.off("node:selected",this.onNodeSelected,this),this.graph.off("node:unselected",this.onNodeUnSelected,this)}onNodeMouseUp({node:e}){if(!this.isSelectionEnabled){const t=this.graph.hook.createTransform(e,{clearAll:!0});t&&this.widgets.set(e,t)}}onNodeSelected({node:e}){if(this.isSelectionEnabled){const t=this.graph.hook.createTransform(e,{clearAll:!1});t&&this.widgets.set(e,t)}}onNodeUnSelected({node:e}){if(this.isSelectionEnabled){const t=this.widgets.get(e);t&&t.dispose(),this.widgets.delete(e)}}getMatrix(){const e=this.viewport.getAttribute("transform");return e!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=e),On(this.viewportMatrix)}setMatrix(e){const t=On(e),i=Zr(t);this.viewport.setAttribute("transform",i),this.viewportMatrix=t,this.viewportTransformString=i}resize(e,t){let i=e===void 0?this.options.width:e,a=t===void 0?this.options.height:t;this.options.width=i,this.options.height=a,typeof i=="number"&&(i=Math.round(i)),typeof a=="number"&&(a=Math.round(a)),this.container.style.width=i==null?"":`${i}px`,this.container.style.height=a==null?"":`${a}px`;const d=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},d)),this}getComputedSize(){let e=this.options.width,t=this.options.height;return av(e)||(e=this.container.clientWidth),av(t)||(t=this.container.clientHeight),{width:e,height:t}}getScale(){return Td(this.getMatrix())}scale(e,t=e,i=0,a=0,d={}){if(e=this.clampScale(e),t=this.clampScale(t),i||a){const m=this.getTranslation(),y=m.tx-i*(e-1),x=m.ty-a*(t-1);(y!==m.tx||x!==m.ty)&&this.translate(y,x)}const f=this.getMatrix();return f.a=e,f.d=t,this.setMatrix(f),this.graph.trigger("scale",Object.assign({sx:e,sy:t,ox:i,oy:a},d)),this}clampScale(e){const t=this.graph.options.scaling;return Ta(e,t.min||.01,t.max||16)}getZoom(){return this.getScale().sx}zoom(e,t){t=t||{};let i=e,a=e;const d=this.getScale(),f=this.getComputedSize();let m=f.width/2,y=f.height/2;if(t.absolute||(i+=d.sx,a+=d.sy),t.scaleGrid&&(i=Math.round(i/t.scaleGrid)*t.scaleGrid,a=Math.round(a/t.scaleGrid)*t.scaleGrid),t.maxScale&&(i=Math.min(t.maxScale,i),a=Math.min(t.maxScale,a)),t.minScale&&(i=Math.max(t.minScale,i),a=Math.max(t.minScale,a)),t.center&&(m=t.center.x,y=t.center.y),i=this.clampScale(i),a=this.clampScale(a),m||y){const x=this.getTranslation(),E=m-(m-x.tx)*(i/d.sx),S=y-(y-x.ty)*(a/d.sy);(E!==x.tx||S!==x.ty)&&this.translate(E,S,{ui:t.ui})}return this.scale(i,a,0,0,{ui:t.ui}),this}getRotation(){return Md(this.getMatrix())}rotate(e,t,i){if(t==null||i==null){const d=Pr(this.graph.view.stage);t=d.width/2,i=d.height/2}const a=this.getMatrix().translate(t,i).rotate(e).translate(-t,-i);return this.setMatrix(a),this}getTranslation(){return _h(this.getMatrix())}translate(e,t,i={}){const a=this.getMatrix();a.e=e||0,a.f=t||0,this.setMatrix(a);const d=this.getTranslation();return this.options.x=d.tx,this.options.y=d.ty,this.graph.trigger("translate",Object.assign(Object.assign({},d),i)),this}setOrigin(e,t){return this.translate(e||0,t||0)}fitToContent(e,t,i,a){if(typeof e=="object"){const se=e;e=se.gridWidth||1,t=se.gridHeight||1,i=se.padding||0,a=se}else e=e||1,t=t||1,i=i||0,a==null&&(a={});const d=Ma(i),f=a.border||0,m=a.contentArea?gn.create(a.contentArea):this.getContentArea(a);f>0&&m.inflate(f);const y=this.getScale(),x=this.getTranslation(),E=y.sx,S=y.sy;m.x*=E,m.y*=S,m.width*=E,m.height*=S;let T=Math.max(Math.ceil((m.width+m.x)/e),1)*e,R=Math.max(Math.ceil((m.height+m.y)/t),1)*t,V=0,j=0;(a.allowNewOrigin==="negative"&&m.x<0||a.allowNewOrigin==="positive"&&m.x>=0||a.allowNewOrigin==="any")&&(V=Math.ceil(-m.x/e)*e,V+=d.left,T+=V),(a.allowNewOrigin==="negative"&&m.y<0||a.allowNewOrigin==="positive"&&m.y>=0||a.allowNewOrigin==="any")&&(j=Math.ceil(-m.y/t)*t,j+=d.top,R+=j),T+=d.right,R+=d.bottom,T=Math.max(T,a.minWidth||0),R=Math.max(R,a.minHeight||0),T=Math.min(T,a.maxWidth||Number.MAX_SAFE_INTEGER),R=Math.min(R,a.maxHeight||Number.MAX_SAFE_INTEGER);const q=this.getComputedSize(),ue=T!==q.width||R!==q.height;return(V!==x.tx||j!==x.ty)&&this.translate(V,j),ue&&this.resize(T,R),new gn(-V/E,-j/S,T/E,R/S)}scaleContentToFit(e={}){this.scaleContentToFitImpl(e)}scaleContentToFitImpl(e={},t=!0){let i,a;if(e.contentArea){const ue=e.contentArea;i=this.graph.localToGraph(ue),a=Oe.create(ue)}else i=this.getContentBBox(e),a=this.graph.graphToLocal(i);if(!i.width||!i.height)return;const d=Ma(e.padding),f=e.minScale||0,m=e.maxScale||Number.MAX_SAFE_INTEGER,y=e.minScaleX||f,x=e.maxScaleX||m,E=e.minScaleY||f,S=e.maxScaleY||m;let T;if(e.viewportArea)T=e.viewportArea;else{const ue=this.getComputedSize(),be=this.getTranslation();T={x:be.tx,y:be.ty,width:ue.width,height:ue.height}}T=gn.create(T).moveAndExpand({x:d.left,y:d.top,width:-d.left-d.right,height:-d.top-d.bottom});const R=this.getScale();let V=T.width/i.width*R.sx,j=T.height/i.height*R.sy;e.preserveAspectRatio!==!1&&(V=j=Math.min(V,j));const q=e.scaleGrid;if(q&&(V=q*Math.floor(V/q),j=q*Math.floor(j/q)),V=Ta(V,y,x),j=Ta(j,E,S),this.scale(V,j),t){const ue=this.options,be=T.x-a.x*V-ue.x,se=T.y-a.y*j-ue.y;this.translate(be,se)}}getContentArea(e={}){return e.useCellGeometry?this.model.getAllCellsBBox()||new gn:Pr(this.graph.view.stage)}getContentBBox(e={}){return this.graph.localToGraph(this.getContentArea(e))}getGraphArea(){const e=gn.fromSize(this.getComputedSize());return this.graph.graphToLocal(e)}zoomToRect(e,t={}){const i=gn.create(e),a=this.graph;t.contentArea=i,t.viewportArea==null&&(t.viewportArea={x:a.options.x,y:a.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(t,!1);const d=i.getCenter();return this.centerPoint(d.x,d.y),this}zoomToFit(e={}){return this.zoomToRect(this.getContentArea(e),e)}centerPoint(e,t){const i=this.getComputedSize(),a=this.getScale(),d=this.getTranslation(),f=i.width/2,m=i.height/2;e=typeof e=="number"?e:f,t=typeof t=="number"?t:m,e=f-e*a.sx,t=m-t*a.sy,(d.tx!==e||d.ty!==t)&&this.translate(e,t)}centerContent(e){const i=this.graph.getContentArea(e).getCenter();this.centerPoint(i.x,i.y)}centerCell(e){return this.positionCell(e,"center")}positionPoint(e,t,i){const a=this.getComputedSize();t=Lc(t,Math.max(0,a.width)),t<0&&(t=a.width+t),i=Lc(i,Math.max(0,a.height)),i<0&&(i=a.height+i);const d=this.getTranslation(),f=this.getScale(),m=t-e.x*f.sx,y=i-e.y*f.sy;(d.tx!==m||d.ty!==y)&&this.translate(m,y)}positionRect(e,t){const i=gn.create(e);switch(t){case"center":return this.positionPoint(i.getCenter(),"50%","50%");case"top":return this.positionPoint(i.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(i.getTopRight(),"100%",0);case"right":return this.positionPoint(i.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(i.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(i.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(i.getBottomLeft(),0,"100%");case"left":return this.positionPoint(i.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(i.getTopLeft(),0,0);default:return this}}positionCell(e,t){const i=e.getBBox();return this.positionRect(i,t)}positionContent(e,t){const i=this.graph.getContentArea(t);return this.positionRect(i,e)}dispose(){this.widgets.forEach(e=>e.dispose()),this.widgets.clear(),this.stopListening()}}b0([x0.dispose()],x0.prototype,"dispose",null);var yp=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class My extends Di{constructor(){super(...arguments),this.movedMap=new WeakMap,this.unselectMap=new WeakMap}get widgetOptions(){return this.options.selecting}get rubberbandDisabled(){return this.widgetOptions.enabled!==!0||this.widgetOptions.rubberband!==!0}get disabled(){return this.widgetOptions.enabled!==!0}get length(){return this.widget.length}get cells(){return this.widget.cells}init(){this.widget=this.graph.hook.createSelection(),this.startListening()}startListening(){this.graph.on("blank:mousedown",this.onBlankMouseDown,this),this.graph.on("blank:click",this.onBlankClick,this),this.graph.on("cell:mousemove",this.onCellMouseMove,this),this.graph.on("cell:mouseup",this.onCellMouseUp,this),this.widget.on("box:mousedown",this.onBoxMouseDown,this)}stopListening(){this.graph.off("blank:mousedown",this.onBlankMouseDown,this),this.graph.off("blank:click",this.onBlankClick,this),this.graph.off("cell:mousemove",this.onCellMouseMove,this),this.graph.off("cell:mouseup",this.onCellMouseUp,this),this.widget.off("box:mousedown",this.onBoxMouseDown,this)}onBlankMouseDown({e}){(this.allowRubberband(e,!0)||this.allowRubberband(e)&&!this.graph.scroller.allowPanning(e,!0)&&!this.graph.panning.allowPanning(e,!0))&&this.startRubberband(e)}onBlankClick(){this.clean()}allowRubberband(e,t){return!this.rubberbandDisabled&&Hc.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowRubberband(e)}allowMultipleSelection(e){return this.isMultiple()&&Hc.isMatch(e,this.widgetOptions.multipleSelectionModifiers)}onCellMouseMove({cell:e}){this.movedMap.set(e,!0)}onCellMouseUp({e,cell:t}){const i=this.widgetOptions;let a=this.disabled;!a&&this.movedMap.has(t)&&(a=i.selectCellOnMoved===!1,a||(a=i.selectNodeOnMoved===!1&&t.isNode()),a||(a=i.selectEdgeOnMoved===!1&&t.isEdge())),a||(this.allowMultipleSelection(e)?this.unselectMap.has(t)?this.unselectMap.delete(t):this.isSelected(t)?this.unselect(t):this.select(t):this.reset(t)),this.movedMap.delete(t)}onBoxMouseDown({e,cell:t}){this.disabled||this.allowMultipleSelection(e)&&(this.unselect(t),this.unselectMap.set(t,!0))}isEmpty(){return this.length<=0}isSelected(e){return this.widget.isSelected(e)}getCells(e){return(Array.isArray(e)?e:[e]).map(t=>typeof t=="string"?this.graph.getCellById(t):t).filter(t=>t!=null)}select(e,t={}){const i=this.getCells(e);return i.length&&(this.isMultiple()?this.widget.select(i,t):this.reset(i.slice(0,1),t)),this}unselect(e,t={}){return this.widget.unselect(this.getCells(e),t),this}reset(e,t={}){return this.widget.reset(e?this.getCells(e):[],t),this}clean(e={}){return this.widget.clean(e),this}enable(){return this.disabled&&(this.widgetOptions.enabled=!0),this}disable(){return this.disabled||(this.widgetOptions.enabled=!1),this}startRubberband(e){return this.rubberbandDisabled||this.widget.startSelecting(e),this}enableRubberband(){return this.rubberbandDisabled&&(this.widgetOptions.rubberband=!0),this}disableRubberband(){return this.rubberbandDisabled||(this.widgetOptions.rubberband=!1),this}isMultiple(){return this.widgetOptions.multiple!==!1}enableMultiple(){return this.widgetOptions.multiple=!0,this}disableMultiple(){return this.widgetOptions.multiple=!1,this}setModifiers(e){return this.widgetOptions.modifiers=e,this}setContent(e){return this.widget.setContent(e),this}setFilter(e){return this.widget.setFilter(e),this}dispose(){this.stopListening(),this.widget.dispose()}}yp([Di.dispose()],My.prototype,"dispose",null);var oC=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},Yo=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t};class Zh extends Is{constructor(e){super(),this.batchCommands=null,this.batchLevel=0,this.lastBatchIndex=-1,this.freezed=!1,this.handlers=[],this.graph=e.graph,this.model=e.graph.model,this.options=zo.getOptions(e),this.validator=new Zh.Validator({history:this,cancelInvalid:this.options.cancelInvalid}),this.clean(),this.startListening()}get disabled(){return this.options.enabled!==!0}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}undo(e={}){if(!this.disabled){const t=this.undoStack.pop();t&&(this.revertCommand(t,e),this.redoStack.push(t),this.notify("undo",t,e))}return this}redo(e={}){if(!this.disabled){const t=this.redoStack.pop();t&&(this.applyCommand(t,e),this.undoStack.push(t),this.notify("redo",t,e))}return this}cancel(e={}){if(!this.disabled){const t=this.undoStack.pop();t&&(this.revertCommand(t,e),this.redoStack=[],this.notify("cancel",t,e))}return this}clean(e={}){return this.undoStack=[],this.redoStack=[],this.notify("clean",null,e),this}canUndo(){return!this.disabled&&this.undoStack.length>0}canRedo(){return!this.disabled&&this.redoStack.length>0}validate(e,...t){return this.validator.validate(e,...t),this}dispose(){this.validator.dispose(),this.clean(),this.stopListening()}startListening(){this.model.on("batch:start",this.initBatchCommand,this),this.model.on("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&this.options.eventNames.forEach((e,t)=>{this.handlers[t]=this.addCommand.bind(this,e),this.model.on(e,this.handlers[t])}),this.validator.on("invalid",e=>this.trigger("invalid",e))}stopListening(){this.model.off("batch:start",this.initBatchCommand,this),this.model.off("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&(this.options.eventNames.forEach((e,t)=>{this.model.off(e,this.handlers[t])}),this.handlers.length=0),this.validator.off("invalid")}createCommand(e){return{batch:e?e.batch:!1,data:{}}}revertCommand(e,t){this.freezed=!0;const i=Array.isArray(e)?zo.sortBatchCommands(e):[e];for(let a=i.length-1;a>=0;a-=1){const d=i[a],f=Object.assign(Object.assign({},t),fc(d.options,this.options.revertOptionsList||[]));this.executeCommand(d,!0,f)}this.freezed=!1}applyCommand(e,t){this.freezed=!0;const i=Array.isArray(e)?zo.sortBatchCommands(e):[e];for(let a=0;a<i.length;a+=1){const d=i[a],f=Object.assign(Object.assign({},t),fc(d.options,this.options.applyOptionsList||[]));this.executeCommand(d,!1,f)}this.freezed=!1}executeCommand(e,t,i){const a=this.model,d=a.getCell(e.data.id),f=e.event;if(zo.isAddEvent(f)&&t||zo.isRemoveEvent(f)&&!t)d.remove(i);else if(zo.isAddEvent(f)&&!t||zo.isRemoveEvent(f)&&t){const m=e.data;m.node?a.addNode(m.props,i):m.edge&&a.addEdge(m.props,i)}else if(zo.isChangeEvent(f)){const m=e.data,y=m.key;if(y){const x=t?m.prev[y]:m.next[y];d.prop(y,x,i)}}else{const m=this.options.executeCommand;m&&Pn(m,this,e,t,i)}}addCommand(e,t){if(this.freezed||this.disabled)return;const i=t,a=i.options||{};if(a.dryrun||zo.isAddEvent(e)&&this.options.ignoreAdd||zo.isRemoveEvent(e)&&this.options.ignoreRemove||zo.isChangeEvent(e)&&this.options.ignoreChange)return;const d=this.options.beforeAddCommand;if(d!=null&&Pn(d,this,e,t)===!1)return;e==="cell:change:*"&&(e=`cell:change:${i.key}`);const f=i.cell,m=$s.isModel(f);let y;if(this.batchCommands){y=this.batchCommands[Math.max(this.lastBatchIndex,0)];const E=m&&!y.modelChange||y.data.id!==f.id,S=y.event!==e;if(this.lastBatchIndex>=0&&(E||S)){const T=this.batchCommands.findIndex(R=>(m&&R.modelChange||R.data.id===f.id)&&R.event===e);T<0||zo.isAddEvent(e)||zo.isRemoveEvent(e)?y=this.createCommand({batch:!0}):(y=this.batchCommands[T],this.batchCommands.splice(T,1)),this.batchCommands.push(y),this.lastBatchIndex=this.batchCommands.length-1}}else y=this.createCommand({batch:!1});if(zo.isAddEvent(e)||zo.isRemoveEvent(e)){const E=y.data;return y.event=e,y.options=a,E.id=f.id,E.props=qi(f.toJSON()),f.isEdge()?E.edge=!0:f.isNode()&&(E.node=!0),this.push(y,a)}if(zo.isChangeEvent(e)){const E=t.key,S=y.data;return(!y.batch||!y.event)&&(y.event=e,y.options=a,S.key=E,S.prev==null&&(S.prev={}),S.prev[E]=au(f.previous(E)),m?y.modelChange=!0:S.id=f.id),S.next==null&&(S.next={}),S.next[E]=au(f.prop(E)),this.push(y,a)}const x=this.options.afterAddCommand;x&&Pn(x,this,e,t,y),this.push(y,a)}initBatchCommand(e){this.freezed||(this.batchCommands?this.batchLevel+=1:(this.batchCommands=[this.createCommand({batch:!0})],this.batchLevel=0,this.lastBatchIndex=-1))}storeBatchCommand(e){if(!this.freezed)if(this.batchCommands&&this.batchLevel<=0){const t=this.filterBatchCommand(this.batchCommands);t.length>0&&(this.redoStack=[],this.undoStack.push(t),this.notify("add",t,e)),this.batchCommands=null,this.lastBatchIndex=-1,this.batchLevel=0}else this.batchCommands&&this.batchLevel>0&&(this.batchLevel-=1)}filterBatchCommand(e){let t=e.slice();const i=[];for(;t.length>0;){const a=t.shift(),d=a.event,f=a.data.id;if(d!=null&&(f!=null||a.modelChange)){if(zo.isAddEvent(d)){const m=t.findIndex(y=>zo.isRemoveEvent(y.event)&&y.data.id===f);if(m>=0){t=t.filter((y,x)=>m<x||y.data.id!==f);continue}}else if(zo.isRemoveEvent(d)){const m=t.findIndex(y=>zo.isAddEvent(y.event)&&y.data.id===f);if(m>=0){t.splice(m,1);continue}}else if(zo.isChangeEvent(d)){const m=a.data;if(ea(m.prev,m.next))continue}i.push(a)}}return i}notify(e,t,i){const a=t==null?null:Array.isArray(t)?t:[t];this.emit(e,{cmds:a,options:i}),this.emit("change",{cmds:a,options:i})}push(e,t){this.redoStack=[],e.batch?(this.lastBatchIndex=Math.max(this.lastBatchIndex,0),this.emit("batch",{cmd:e,options:t})):(this.undoStack.push(e),this.notify("add",e,t))}}oC([Is.dispose()],Zh.prototype,"dispose",null),function(c){class e extends Is{constructor(i){super(),this.map={},this.command=i.history,this.cancelInvalid=i.cancelInvalid!==!1,this.command.on("add",this.onCommandAdded,this)}onCommandAdded({cmds:i}){return Array.isArray(i)?i.every(a=>this.isValidCommand(a)):this.isValidCommand(i)}isValidCommand(i){if(i.options&&i.options.validation===!1)return!0;const a=i.event&&this.map[i.event]||[];let d=null;return a.forEach(f=>{let m=0;const y=x=>{const E=f[m];m+=1;try{if(E)E(x,i,y);else{d=x;return}}catch(S){y(S)}};y(d)}),d?(this.cancelInvalid&&this.command.cancel(),this.emit("invalid",{err:d}),!1):!0}validate(i,...a){const d=Array.isArray(i)?i:i.split(/\s+/);return a.forEach(f=>{if(typeof f!="function")throw new Error(`${d.join(" ")} requires callback functions.`)}),d.forEach(f=>{this.map[f]==null&&(this.map[f]=[]),this.map[f].push(a)}),this}dispose(){this.command.off("add",this.onCommandAdded,this)}}oC([Is.dispose()],e.prototype,"dispose",null),c.Validator=e}(Zh||(Zh={}));var zo;(function(c){function e(f){return f==="cell:added"}c.isAddEvent=e;function t(f){return f==="cell:removed"}c.isRemoveEvent=t;function i(f){return f!=null&&f.startsWith("cell:change:")}c.isChangeEvent=i;function a(f){const{graph:m}=f,y=Yo(f,["graph"]),x=["cell:added","cell:removed","cell:change:*"],E=["batch:start","batch:stop"],S=f.eventNames?f.eventNames.filter(T=>!(c.isChangeEvent(T)||x.includes(T)||E.includes(T))):x;return Object.assign(Object.assign({},y),{eventNames:S,applyOptionsList:f.applyOptionsList||["propertyPath"],revertOptionsList:f.revertOptionsList||["propertyPath"]})}c.getOptions=a;function d(f){const m=[];for(let y=0,x=f.length;y<x;y+=1){const E=f[y];let S=null;if(c.isAddEvent(E.event)){const T=E.data.id;for(let R=0;R<y;R+=1)if(f[R].data.id===T){S=R;break}}S!==null?m.splice(S,0,E):m.push(E)}return m}c.sortBatchCommands=d})(zo||(zo={}));var HE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class Py extends Di{get widgetOptions(){return this.options.minimap}init(){this.widget=this.graph.hook.createMiniMap()}dispose(){this.widget&&this.widget.dispose()}}HE([Di.dispose()],Py.prototype,"dispose",null);var $E=P(42441),WE=P.n($E),ZE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class Xh extends xl{constructor(e){super(),this.options=e;const t=this.graph.scroller.widget;this.container=t?t.container:this.graph.container,e.global?this.target=document:(this.target=this.container,this.disabled||this.target.setAttribute("tabindex","-1"),this.graph.on("cell:mouseup",this.focus,this),this.graph.on("blank:mouseup",this.focus,this)),this.mousetrap=Xh.createMousetrap(this)}get graph(){return this.options.graph}get disabled(){return this.options.enabled!==!0}enable(){this.disabled&&(this.options.enabled=!0,this.graph.options.keyboard.enabled=!0,this.target instanceof HTMLElement&&this.target.setAttribute("tabindex","-1"))}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.keyboard.enabled=!1,this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))}on(e,t,i){this.mousetrap.bind(this.getKeys(e),t,i)}off(e,t){this.mousetrap.unbind(this.getKeys(e),t)}focus(e){if(this.isInputEvent(e.e))return;this.target.focus({preventScroll:!0})}getKeys(e){return(Array.isArray(e)?e:[e]).map(t=>this.formatkey(t))}formatkey(e){const t=e.toLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command"),i=this.options.format;return i?Pn(i,this.graph,t):t}isGraphEvent(e){const t=e.srcElement||e.target,i=e.currentTarget;return t?t===this.target||i===this.target||t===document.body?!0:Rm(this.container,t):!1}isInputEvent(e){const t=e.target,i=t&&t.tagName.toLowerCase();return["input","textarea"].includes(i)}isEnabledForEvent(e){const t=!this.disabled&&this.isGraphEvent(e),i=this.isInputEvent(e);if(t){const a=e.keyCode||e.which;if(i&&(a===8||a===46))return!1;if(this.options.guard)return Pn(this.options.guard,this.graph,e)}return t}dispose(){this.mousetrap.reset()}}ZE([xl.dispose()],Xh.prototype,"dispose",null),function(c){function e(t){const i=new(WE())(t.target),a=i.stopCallback;return i.stopCallback=(d,f,m)=>t.isEnabledForEvent(d)?a?a.call(i,d,f,m):!1:!0,i}c.createMousetrap=e}(Xh||(Xh={}));var XE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class Oy extends xl{constructor(e){super(),this.options=e,this.cumulatedFactor=1;const t=this.graph.scroller.widget;this.container=t?t.container:this.graph.container,this.target=this.options.global?document:this.container,this.mousewheelHandle=new yo(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.options.enabled&&this.enable(!0)}get graph(){return this.options.graph}get disabled(){return this.options.enabled!==!0}enable(e){(this.disabled||e)&&(this.options.enabled=!0,this.graph.options.mousewheel.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.mousewheel.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(e){const t=e.originalEvent||e,i=this.options.guard;return(i==null||i.call(this.graph,t))&&Hc.isMatch(t,this.options.modifiers)}onMouseWheel(e){const t=e.originalEvent||e,i=this.options.guard;if((i==null||i.call(this.graph,t))&&Hc.isMatch(t,this.options.modifiers)){const a=this.options.factor||1.2;this.currentScale==null&&(this.startPos={x:e.clientX,y:e.clientY},this.currentScale=this.graph.scroller.widget?this.graph.scroller.widget.zoom():this.graph.transform.getScale().sx),e.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:this.cumulatedFactor=Math.round(this.currentScale*a*20)/20/this.currentScale:this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:this.cumulatedFactor=Math.round(this.currentScale*(1/a)*20)/20/this.currentScale,this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const f=this.graph.scroller.widget,m=this.currentScale;let y=this.graph.transform.clampScale(m*this.cumulatedFactor);const x=this.options.minScale||Number.MIN_SAFE_INTEGER,E=this.options.maxScale||Number.MAX_SAFE_INTEGER;if(y=Ta(y,x,E),y!==m)if(f)if(this.options.zoomAtMousePosition){const S=this.graph.coord.clientToLocalPoint(this.startPos);f.zoom(y,{absolute:!0,center:S.clone()})}else f.zoom(y,{absolute:!0});else if(this.options.zoomAtMousePosition){const S=this.graph.coord.clientToGraphPoint(this.startPos);this.graph.transform.zoom(y,{absolute:!0,center:S.clone(),ui:!0})}else this.graph.transform.zoom(y,{absolute:!0,ui:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}XE([xl.dispose()],Oy.prototype,"dispose",null);var YE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class Yh extends Di{show(e={}){const t=Object.assign(Object.assign({},Yh.defaultOptions),e),i=this.createPrintPages(t);t.ready(i,a=>this.showPrintWindow(a,t),{sheetSize:this.getSheetSize(t)})}get className(){return this.view.prefixClassName("graph-print")}showPrintWindow(e,t){if(e){const i=N()(document.body),a=N()(this.view.container),d=this.view.prefixClassName("graph-printing");i.addClass(d);const f=a.children().detach();e.forEach(x=>{x.removeClass(`${this.className}-preview`).addClass(`${this.className}-ready`).appendTo(i)});let m=!1;const y=()=>{m||(m=!0,i.removeClass(d),e.forEach(x=>x.remove()),a.append(f),N()(`#${this.styleSheetId}`).remove(),this.graph.trigger("after:print",t),N()(window).off("afterprint",y))};N()(window).one("afterprint",y),setTimeout(y,200),window.print()}}createPrintPage(e,t){this.graph.trigger("before:print",t);const i=N()("<div/>").addClass(this.className),a=N()("<div/>").addClass(this.view.prefixClassName("graph-print-inner")).css("position","relative");t.size&&i.addClass(`${this.className}-size-${t.size}`);const d=In.create(this.view.svg).clone(),f=d.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`);a.append(d.node);const m=this.getSheetSize(t),y=this.graph.transform.getGraphArea(),x=this.graph.transform.getScale(),E=this.graph.translate(),S=On().translate(E.tx/x.sx,E.ty/x.sy),T=this.getPageInfo(y,e,m),R=T.scale,V=T.bbox;return a.css({left:0,top:0}),d.attr({width:V.width*R,height:V.height*R,style:"position:relative",viewBox:[V.x,V.y,V.width,V.height].join(" ")}),f.attr("transform",Zr(S)),i.append(a),i.addClass(`${this.className}-preview`),{$page:i,sheetSize:m}}createPrintPages(e){let t;const i=this.getPrintArea(e),a=[];if(e.page){const d=this.getPageSize(i,e.page);this.getPageAreas(i,d).forEach(m=>{t=this.createPrintPage(m,e),a.push(t.$page)})}else t=this.createPrintPage(i,e),a.push(t.$page);if(t){const d={width:t.sheetSize.cssWidth,height:t.sheetSize.cssHeight};this.updatePrintStyle(d,e)}return a}get styleSheetId(){return this.view.prefixClassName("graph-print-style")}updatePrintStyle(e,t){const i=Object.keys(e).reduce((E,S)=>`${E} ${S}:${e[S]};`,""),a=Ma(t.margin),d=t.marginUnit||"",f=t.sheetUnit||"",m=`
      @media print {
        .${this.className}.${this.className}-ready {
          ${i}
        }

        @page {
          margin:
          ${[a.top+d,a.right+d,a.bottom+d,a.left+d].join(" ")};
          size: ${t.sheet.width+f} ${t.sheet.height+f};

        .${this.className}.${this.className}-preview {
          ${i}
        }
      }`,y=this.styleSheetId,x=N()(`#${y}`);x.length?x.html(m):N()("head").append(`'<style type="text/css" id="${y}">${m}</style>'`)}getPrintArea(e){let t=e.area;if(!t){const i=Ma(e.padding);t=this.graph.getContentArea().moveAndExpand({x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom})}return t}getPageSize(e,t){if(typeof t=="object"){const i=t,a={width:i.width,height:i.height};return a.width==null&&(a.width=Math.ceil(e.width/(i.columns||1))),a.height==null&&(a.height=Math.ceil(e.height/(i.rows||1))),a}return{width:e.width,height:e.height}}getPageAreas(e,t){const i=[],a=t.width,d=t.height;for(let f=0,m=0;f<e.height&&m<200;f+=d,m+=1)for(let y=0,x=0;y<e.width&&x<200;y+=a,x+=1)i.push(new gn(e.x+y,e.y+f,a,d));return i}getSheetSize(e){const t=e.sheet,i=Ma(e.margin),a=e.marginUnit||"",d=e.sheetUnit||"",f=`calc(${t.width}${d} - ${i.left+i.right}${a})`,m=`calc(${t.height}${d} - ${i.top+i.bottom}${a})`,y=hg.measure(f,m);return{cssWidth:f,cssHeight:m,width:y.width,height:y.height}}getPageInfo(e,t,i){const a=new gn(t.x-e.x,t.y-e.y,t.width,t.height),d=a.width/a.height,f=i.width/i.height;return{bbox:a,scale:f<d?i.width/a.width:i.height/a.height,fitHorizontal:f<d}}dispose(){}}YE([Di.dispose()],Yh.prototype,"dispose",null),function(c){c.defaultOptions={page:!1,sheet:{width:210,height:297},sheetUnit:"mm",margin:.4,marginUnit:"in",padding:5,ready:(e,t)=>t(e)}}(Yh||(Yh={}));class sC extends Di{toSVG(e,t={}){this.graph.trigger("before:export",t);const i=this.view.svg,a=In.create(i).clone();let d=a.node;const f=a.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`),m=t.viewBox||this.graph.graphToLocal(this.graph.getContentBBox()),y=t.preserveDimensions;if(y){const S=typeof y=="boolean"?m:y;a.attr({width:S.width,height:S.height})}if(a.removeAttribute("style").attr("viewBox",[m.x,m.y,m.width,m.height].join(" ")),f.removeAttribute("transform"),t.copyStyles!==!1){const S=i.ownerDocument,T=Array.from(i.querySelectorAll("*")),R=Array.from(d.querySelectorAll("*")),V=S.styleSheets.length,j=[];for(let be=V-1;be>=0;be-=1)j[be]=S.styleSheets[be],S.styleSheets[be].disabled=!0;const q={};T.forEach((be,se)=>{const Pe=window.getComputedStyle(be,null),He={};Object.keys(Pe).forEach(ft=>{He[ft]=Pe.getPropertyValue(ft)}),q[se]=He}),V!==S.styleSheets.length&&j.forEach((be,se)=>{S.styleSheets[se]=be});for(let be=0;be<V;be+=1)S.styleSheets[be].disabled=!1;const ue={};T.forEach((be,se)=>{const Pe=window.getComputedStyle(be,null),He=q[se],ft={};Object.keys(Pe).forEach(pt=>{!Db(pt)&&Pe.getPropertyValue(pt)!==He[pt]&&(ft[pt]=Pe.getPropertyValue(pt))}),ue[se]=ft}),R.forEach((be,se)=>{N()(be).css(ue[se])})}const x=t.stylesheet;if(typeof x=="string"){const S=i.ownerDocument.implementation.createDocument(null,"xml",null).createCDATASection(x);a.prepend(In.create("style",{type:"text/css"},[S]))}const E=()=>{const S=t.beforeSerialize;if(typeof S=="function"){const R=Pn(S,this.graph,d);R instanceof SVGSVGElement&&(d=R)}const T=new XMLSerializer().serializeToString(d).replace(/&nbsp;/g,"\xA0");this.graph.trigger("after:export",t),e(T)};if(t.serializeImages){const S=a.find("image").map(T=>new Promise(R=>{const V=T.attr("xlink:href")||T.attr("href");vv.imageToDataUri(V,(j,q)=>{!j&&q&&T.attr("xlink:href",q),R()})}));Promise.all(S).then(E)}else E()}toDataURL(e,t){let i=t.viewBox||this.graph.getContentBBox();const a=Ma(t.padding);t.width&&t.height&&(a.left+a.right>=t.width&&(a.left=a.right=0),a.top+a.bottom>=t.height&&(a.top=a.bottom=0));const d=new gn(-a.left,-a.top,a.left+a.right,a.top+a.bottom);if(t.width&&t.height){const E=i.width+a.left+a.right,S=i.height+a.top+a.bottom;d.scale(E/t.width,S/t.height)}i=gn.create(i).moveAndExpand(d);const f=typeof t.width=="number"&&typeof t.height=="number"?{width:t.width,height:t.height}:i;let m=t.ratio?parseFloat(t.ratio):1;(!Number.isFinite(m)||m===0)&&(m=1);const y={width:Math.max(Math.round(f.width*m),1),height:Math.max(Math.round(f.height*m),1)};{const E=document.createElement("canvas"),S=E.getContext("2d");E.width=y.width,E.height=y.height;const T=y.width-1,R=y.height-1;S.fillStyle="rgb(1,1,1)",S.fillRect(T,R,1,1);const V=S.getImageData(T,R,1,1).data;if(V[0]!==1||V[1]!==1||V[2]!==1)throw new Error("size exceeded")}const x=new Image;x.onload=()=>{const E=document.createElement("canvas");E.width=y.width,E.height=y.height;const S=E.getContext("2d");S.fillStyle=t.backgroundColor||"white",S.fillRect(0,0,y.width,y.height);try{S.drawImage(x,0,0,y.width,y.height);const T=E.toDataURL(t.type,t.quality);e(T)}catch{}},this.toSVG(E=>{x.src=`data:image/svg+xml,${encodeURIComponent(E)}`},Object.assign(Object.assign({},t),{viewBox:i,serializeImages:!0,preserveDimensions:Object.assign({},y)}))}toPNG(e,t={}){this.toDataURL(e,Object.assign(Object.assign({},t),{type:"image/png"}))}toJPEG(e,t={}){this.toDataURL(e,Object.assign(Object.assign({},t),{type:"image/jpeg"}))}}class KE extends Di{constructor(){super(...arguments),this.widgets=new Map}get isSelectionEnabled(){return this.options.selecting.enabled===!0}init(){this.startListening()}startListening(){this.graph.on("node:mouseup",this.onNodeMouseUp,this),this.graph.on("node:selected",this.onNodeSelected,this),this.graph.on("node:unselected",this.onNodeUnSelected,this)}stopListening(){this.graph.off("node:mouseup",this.onNodeMouseUp,this),this.graph.off("node:selected",this.onNodeSelected,this),this.graph.off("node:unselected",this.onNodeUnSelected,this)}onNodeMouseUp({node:e}){if(!this.isSelectionEnabled){const t=this.graph.hook.createKnob(e,{clearAll:!0});t&&this.widgets.set(e,t)}}onNodeSelected({node:e}){if(this.isSelectionEnabled){const t=this.graph.hook.createKnob(e,{clearAll:!1});t&&this.widgets.set(e,t)}}onNodeUnSelected({node:e}){if(this.isSelectionEnabled){const t=this.widgets.get(e);t&&t.forEach(i=>i.dispose()),this.widgets.delete(e)}}}var qE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class aC extends Di{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&this.widgetOptions.enabled===!0}init(){this.startListening(),this.updateClassName()}startListening(){const e=this.widgetOptions.eventTypes;!e||(e.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),this.view.$(this.graph.container).on("mousedown",this.onRightMouseDown)),e.includes("mouseWheel")&&(this.mousewheelHandle=new yo(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()))}stopListening(){const e=this.widgetOptions.eventTypes;!e||(e.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),e.includes("rightMouseDown")&&this.view.$(this.graph.container).off("mousedown",this.onRightMouseDown),e.includes("mouseWheel")&&this.mousewheelHandle&&this.mousewheelHandle.disable())}preparePanning({e}){(this.allowPanning(e,!0)||this.allowPanning(e)&&!this.graph.selection.allowRubberband(e,!0))&&this.startPanning(e)}allowPanning(e,t){return this.pannable&&Hc.isMatch(e,this.widgetOptions.modifiers,t)&&this.graph.hook.allowPanning(e)}startPanning(e){const t=this.view.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.panning=!0,this.updateClassName(),this.view.$(document.body).on({"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),this.view.$(window).on("mouseup.panning",this.stopPanning.bind(this))}pan(e){const t=this.view.normalizeEvent(e),i=t.clientX-this.clientX,a=t.clientY-this.clientY;this.clientX=t.clientX,this.clientY=t.clientY;const d=this.graph.transform.getTranslation(),f=d.tx+i,m=d.ty+a;this.graph.transform.translate(f,m,{ui:!0})}stopPanning(e){this.panning=!1,this.updateClassName(),this.view.$(document.body).off(".panning"),this.view.$(window).off(".panning")}updateClassName(){const e=this.view.container,t=this.view.prefixClassName("graph-panning"),i=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(vi(e,t),Wa(e,i)):(Wa(e,t),vi(e,i)):(Wa(e,t),Wa(e,i))}onRightMouseDown(e){e.button===2&&this.allowPanning(e,!0)&&this.startPanning(e)}allowMouseWheel(e){return this.pannable&&!e.ctrlKey}onMouseWheel(e,t,i){e.ctrlKey||this.graph.translateBy(-t,-i)}autoPanning(e,t){const a=this.graph.getGraphArea();let d=0,f=0;e<=a.left+10&&(d=-10),t<=a.top+10&&(f=-10),e>=a.right-10&&(d=10),t>=a.bottom-10&&(f=10),(d!==0||f!==0)&&this.graph.translateBy(-d,-f)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}qE([Di.dispose()],aC.prototype,"dispose",null);var JE=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class lC extends Di{hasScroller(){return this.graph.scroller.widget!=null}getContainer(){return this.hasScroller()?this.graph.scroller.widget.container:this.graph.container}init(){const e=this.options.autoResize;if(e){const t=typeof e=="boolean"?this.getContainer():e;qm.bind(t,()=>{const i=this.getContainer(),a=i.offsetWidth,d=i.offsetHeight;this.resize(a,d)})}}resize(e,t){this.hasScroller()?this.resizeScroller(e,t):this.resizeGraph(e,t)}resizeGraph(e,t){this.graph.transform.resize(e,t)}resizeScroller(e,t){this.graph.scroller.resize(e,t)}resizePage(e,t){const i=this.graph.scroller.widget;i&&i.updatePageSize(e,t)}dispose(){qm.clear(this.getContainer())}}JE([Di.dispose()],lC.prototype,"dispose",null);var ci=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},QE=function(c,e){var t={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&e.indexOf(i)<0&&(t[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(c);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(c,i[a])&&(t[i[a]]=c[i[a]]);return t},qr;(function(c){function e(i,a){return(d,f,m)=>{const y=m.value,x=a||f;m.value=function(...E){const S=this.options[x];if(S!=null){this.getNativeValue=y.bind(this,...E);const T=Pn(S,this.graph,...E);if(this.getNativeValue=null,T!=null||i===!0&&T===null)return T}return y.call(this,...E)}}}c.hook=e;function t(i){return(a,d,f)=>{const m=f.value,y=i||d;f.value=function(...x){let E=m.call(this,...x);const S=this.options[y];return S!=null&&(E=Pn(S,this.graph,...x)&&E),E}}}c.after=t})(qr||(qr={}));class Jr extends Di{createModel(){if(this.options.model)return this.options.model;const e=new $s;return e.graph=this.graph,e}createView(){return new El(this.graph)}createRenderer(){return new bi(this.graph)}createDefsManager(){return new Ud(this.graph)}createGridManager(){return new Al(this.graph)}createCoordManager(){return new Lg(this.graph)}createKnobManager(){return new KE(this.graph)}createTransform(e,t){const i=this.getTransformOptions(e);return i.resizable||i.rotatable?new vp(Object.assign(Object.assign({node:e,graph:this.graph},i),t)):(i.clearAll&&vp.removeInstances(this.graph),null)}createKnob(e,t){const i=Da.parseOptionGroup(this.graph,e,this.options.knob),a=Object.assign(Object.assign({},i),t);a.clearAll&&wy.removeInstances(this.graph),a.clearAll=!1;const d=e.prop("knob"),f=[];return(Array.isArray(d)?d:[d]).forEach((y,x)=>{if(y){if(y.enabled===!1||typeof y.enabled=="function"&&y.enabled.call(this.graph,e)===!1)return}else return;i.enabled&&f.push(new wy(Object.assign({node:e,index:x,graph:this.graph},a)))}),f}getTransformOptions(e){const t=Da.parseOptionGroup(this.graph,e,this.options.resizing),i=Da.parseOptionGroup(this.graph,e,this.options.rotating),a=Da.parseOptionGroup(this.graph,e,this.options.transforming);return Object.assign(Object.assign({},a),{resizable:t.enabled,minWidth:t.minWidth,maxWidth:t.maxWidth,minHeight:t.minHeight,maxHeight:t.maxHeight,orthogonalResizing:t.orthogonal,restrictedResizing:t.restrict!=null?t.restrict:t.restricted,autoScrollOnResizing:t.autoScroll,preserveAspectRatio:t.preserveAspectRatio,allowReverse:t.allowReverse,rotatable:i.enabled,rotateGrid:i.grid})}createTransformManager(){return new x0(this.graph)}createHighlightManager(){return new Fg(this.graph)}createBackgroundManager(){return new kg(this.graph)}createClipboard(){return new eS}createClipboardManager(){return new Ty(this.graph)}createSnapline(){return new Sy(Object.assign({graph:this.graph},this.options.snapline))}createSnaplineManager(){return new y0(this.graph)}createSelection(){return new rc(Object.assign({graph:this.graph},this.options.selecting))}createSelectionManager(){return new My(this.graph)}allowRubberband(e){return!0}createHistoryManager(){return new Zh(Object.assign({graph:this.graph},this.options.history))}createScroller(){return this.options.scroller.enabled?new mp(Object.assign({graph:this.graph},this.options.scroller)):null}createScrollerManager(){return new Ay(this.graph)}allowPanning(e){return!0}createMiniMap(){const e=this.options.minimap,{enabled:t}=e,i=QE(e,["enabled"]);return t?new Ey(Object.assign({graph:this.graph},i)):null}createMiniMapManager(){return new Py(this.graph)}createKeyboard(){return new Xh(Object.assign({graph:this.graph},this.options.keyboard))}createMouseWheel(){return new Oy(Object.assign({graph:this.graph},this.options.mousewheel))}createPrintManager(){return new Yh(this.graph)}createFormatManager(){return new sC(this.graph)}createPanningManager(){return new aC(this.graph)}createSizeManager(){return new lC(this.graph)}allowConnectToBlank(e){const t=this.options.connecting,i=t.allowBlank!=null?t.allowBlank:t.dangling;if(typeof i!="function")return!!i;const a=this.graph.findViewByCell(e),d=e.getSourceCell(),f=e.getTargetCell(),m=this.graph.findViewByCell(d),y=this.graph.findViewByCell(f);return Pn(i,this.graph,{edge:e,edgeView:a,sourceCell:d,targetCell:f,sourceView:m,targetView:y,sourcePort:e.getSourcePortId(),targetPort:e.getTargetPortId(),sourceMagnet:a.sourceMagnet,targetMagnet:a.targetMagnet})}validateEdge(e,t,i){if(!this.allowConnectToBlank(e)){const d=e.getSourceCellId(),f=e.getTargetCellId();if(!(d&&f))return!1}const a=this.options.connecting.validateEdge;return a?Pn(a,this.graph,{edge:e,type:t,previous:i}):!0}validateMagnet(e,t,i){if(t.getAttribute("magnet")!=="passive"){const a=this.options.connecting.validateMagnet;return a?Pn(a,this.graph,{e:i,magnet:t,view:e,cell:e.cell}):!0}return!1}getDefaultEdge(e,t){let i;const a=this.options.connecting.createEdge;return a&&(i=Pn(a,this.graph,{sourceMagnet:t,sourceView:e,sourceCell:e.cell})),i==null&&(i=new m0),i}validateConnection(e,t,i,a,d,f,m){const y=this.options.connecting,x=y.allowLoop,E=y.allowNode,S=y.allowEdge,T=y.allowPort,R=y.allowMulti!=null?y.allowMulti:y.multi,V=y.validateConnection,j=f?f.cell:null,q=d==="target"?i:e,ue=d==="target"?a:t;let be=!0;const se=Pe=>{const He=d==="source"?m?m.port:null:j?j.getSourcePortId():null,ft=d==="target"?m?m.port:null:j?j.getTargetPortId():null;return Pn(Pe,this.graph,{edge:j,edgeView:f,sourceView:e,targetView:i,sourcePort:He,targetPort:ft,sourceMagnet:t,targetMagnet:a,sourceCell:e?e.cell:null,targetCell:i?i.cell:null,type:d})};if(x!=null&&(typeof x=="boolean"?!x&&e===i&&(be=!1):be=se(x)),be&&T!=null&&(typeof T=="boolean"?!T&&ue&&(be=!1):be=se(T)),be&&S!=null&&(typeof S=="boolean"?!S&&_u.isEdgeView(q)&&(be=!1):be=se(S)),be&&E!=null&&ue==null&&(typeof E=="boolean"?!E&&aa.isNodeView(q)&&(be=!1):be=se(E)),be&&R!=null&&f){const Pe=f.cell,He=d==="source"?m:Pe.getSource(),ft=d==="target"?m:Pe.getTarget(),pt=m?this.graph.getCellById(m.cell):null;if(He&&ft&&He.cell&&ft.cell&&pt)if(typeof R=="function")be=se(R);else{const kt=this.model.getConnectedEdges(pt,{outgoing:d==="source",incoming:d==="target"});kt.length&&(R==="withPort"?kt.some(Bt=>{const Xt=Bt.getSource(),on=Bt.getTarget();return Xt&&on&&Xt.cell===He.cell&&on.cell===ft.cell&&Xt.port!=null&&Xt.port===He.port&&on.port!=null&&on.port===ft.port})&&(be=!1):R||kt.some(Bt=>{const Xt=Bt.getSource(),on=Bt.getTarget();return Xt&&on&&Xt.cell===He.cell&&on.cell===ft.cell})&&(be=!1))}}return be&&V!=null&&(be=se(V)),be}getRestrictArea(e){const t=this.options.translating.restrict,i=typeof t=="function"?Pn(t,this.graph,e):t;return typeof i=="number"?this.graph.transform.getGraphArea().inflate(i):i===!0?this.graph.transform.getGraphArea():i||null}onViewUpdated(e,t,i){t&bi.FLAG_INSERT||i.mounting||this.graph.renderer.requestConnectedEdgesUpdate(e,i)}onViewPostponed(e,t,i){return this.graph.renderer.forcePostponedViewUpdate(e,t)}getCellView(e){return null}createCellView(e){const t={graph:this.graph},i=this.getCellView(e);if(i)return new i(e,t);const a=e.view;if(a!=null&&typeof a=="string"){const d=xo.registry.get(a);return d?new d(e,t):xo.registry.onNotFound(a)}return e.isNode()?new aa(e,t):e.isEdge()?new _u(e,t):null}getHTMLComponent(e){let t=e.getHTML();return typeof t=="string"&&(t=Ya.componentRegistry.get(t)||t),Ge.Z(t)&&(t=t.render),typeof t=="function"?Pn(t,this.graph,e):t}shouldUpdateHTMLComponent(e){let t=e.getHTML();if(typeof t=="string"&&(t=Ya.componentRegistry.get(t)||t),Ge.Z(t)){const i=t.shouldComponentUpdate;return typeof i=="function"?Pn(i,this.graph,e):!!i}return!1}onEdgeLabelRendered(e){}onPortRendered(e){}onToolItemCreated(e){}}ci([qr.hook()],Jr.prototype,"createModel",null),ci([qr.hook()],Jr.prototype,"createView",null),ci([qr.hook()],Jr.prototype,"createRenderer",null),ci([qr.hook()],Jr.prototype,"createDefsManager",null),ci([qr.hook()],Jr.prototype,"createGridManager",null),ci([qr.hook()],Jr.prototype,"createCoordManager",null),ci([qr.hook()],Jr.prototype,"createKnobManager",null),ci([qr.hook()],Jr.prototype,"createTransform",null),ci([qr.hook()],Jr.prototype,"createKnob",null),ci([qr.hook()],Jr.prototype,"createTransformManager",null),ci([qr.hook()],Jr.prototype,"createHighlightManager",null),ci([qr.hook()],Jr.prototype,"createBackgroundManager",null),ci([qr.hook()],Jr.prototype,"createClipboard",null),ci([qr.hook()],Jr.prototype,"createClipboardManager",null),ci([qr.hook()],Jr.prototype,"createSnapline",null),ci([qr.hook()],Jr.prototype,"createSnaplineManager",null),ci([qr.hook()],Jr.prototype,"createSelection",null),ci([qr.hook()],Jr.prototype,"createSelectionManager",null),ci([qr.hook()],Jr.prototype,"allowRubberband",null),ci([qr.hook()],Jr.prototype,"createHistoryManager",null),ci([qr.hook()],Jr.prototype,"createScroller",null),ci([qr.hook()],Jr.prototype,"createScrollerManager",null),ci([qr.hook()],Jr.prototype,"allowPanning",null),ci([qr.hook()],Jr.prototype,"createMiniMap",null),ci([qr.hook()],Jr.prototype,"createMiniMapManager",null),ci([qr.hook()],Jr.prototype,"createKeyboard",null),ci([qr.hook()],Jr.prototype,"createMouseWheel",null),ci([qr.hook()],Jr.prototype,"createPrintManager",null),ci([qr.hook()],Jr.prototype,"createFormatManager",null),ci([qr.hook()],Jr.prototype,"createPanningManager",null),ci([qr.hook()],Jr.prototype,"createSizeManager",null),ci([qr.after()],Jr.prototype,"onViewUpdated",null),ci([qr.after()],Jr.prototype,"onViewPostponed",null),ci([qr.hook()],Jr.prototype,"getCellView",null),ci([qr.hook(!0)],Jr.prototype,"createCellView",null),ci([qr.hook()],Jr.prototype,"getHTMLComponent",null),ci([qr.hook()],Jr.prototype,"shouldUpdateHTMLComponent",null),ci([qr.hook()],Jr.prototype,"onEdgeLabelRendered",null),ci([qr.hook()],Jr.prototype,"onPortRendered",null),ci([qr.hook()],Jr.prototype,"onToolItemCreated",null);var oc=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class Ci extends Is{constructor(e){super(),this.options=Da.get(e),this.css=new ku(this),this.hook=new Jr(this),this.view=this.hook.createView(),this.defs=this.hook.createDefsManager(),this.coord=this.hook.createCoordManager(),this.transform=this.hook.createTransformManager(),this.knob=this.hook.createKnobManager(),this.highlight=this.hook.createHighlightManager(),this.grid=this.hook.createGridManager(),this.background=this.hook.createBackgroundManager(),this.model=this.hook.createModel(),this.renderer=this.hook.createRenderer(),this.clipboard=this.hook.createClipboardManager(),this.snapline=this.hook.createSnaplineManager(),this.selection=this.hook.createSelectionManager(),this.history=this.hook.createHistoryManager(),this.scroller=this.hook.createScrollerManager(),this.minimap=this.hook.createMiniMapManager(),this.keyboard=this.hook.createKeyboard(),this.mousewheel=this.hook.createMouseWheel(),this.print=this.hook.createPrintManager(),this.format=this.hook.createFormatManager(),this.panning=this.hook.createPanningManager(),this.size=this.hook.createSizeManager()}get container(){return this.view.container}get[Symbol.toStringTag](){return Ci.toStringTag}isNode(e){return e.isNode()}isEdge(e){return e.isEdge()}resetCells(e,t={}){return this.model.resetCells(e,t),this}clearCells(e={}){return this.model.clear(e),this}toJSON(e={}){return this.model.toJSON(e)}parseJSON(e){return this.model.parseJSON(e)}fromJSON(e,t={}){return this.model.fromJSON(e,t),this}getCellById(e){return this.model.getCell(e)}addNode(e,t={}){return this.model.addNode(e,t)}addNodes(e,t={}){return this.addCell(e.map(i=>Si.isNode(i)?i:this.createNode(i)),t)}createNode(e){return this.model.createNode(e)}removeNode(e,t={}){return this.model.removeCell(e,t)}addEdge(e,t={}){return this.model.addEdge(e,t)}addEdges(e,t={}){return this.addCell(e.map(i=>Qi.isEdge(i)?i:this.createEdge(i)),t)}removeEdge(e,t={}){return this.model.removeCell(e,t)}createEdge(e){return this.model.createEdge(e)}addCell(e,t={}){return this.model.addCell(e,t),this}removeCell(e,t={}){return this.model.removeCell(e,t)}removeCells(e,t={}){return this.model.removeCells(e,t)}removeConnectedEdges(e,t={}){return this.model.removeConnectedEdges(e,t)}disconnectConnectedEdges(e,t={}){return this.model.disconnectConnectedEdges(e,t),this}hasCell(e){return this.model.has(e)}getCell(e){return this.model.getCell(e)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(e){return this.model.getOutgoingEdges(e)}getIncomingEdges(e){return this.model.getIncomingEdges(e)}getConnectedEdges(e,t={}){return this.model.getConnectedEdges(e,t)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(e){return this.model.isRoot(e)}isLeafNode(e){return this.model.isLeaf(e)}getNeighbors(e,t={}){return this.model.getNeighbors(e,t)}isNeighbor(e,t,i={}){return this.model.isNeighbor(e,t,i)}getSuccessors(e,t={}){return this.model.getSuccessors(e,t)}isSuccessor(e,t,i={}){return this.model.isSuccessor(e,t,i)}getPredecessors(e,t={}){return this.model.getPredecessors(e,t)}isPredecessor(e,t,i={}){return this.model.isPredecessor(e,t,i)}getCommonAncestor(...e){return this.model.getCommonAncestor(...e)}getSubGraph(e,t={}){return this.model.getSubGraph(e,t)}cloneSubGraph(e,t={}){return this.model.cloneSubGraph(e,t)}cloneCells(e){return this.model.cloneCells(e)}getNodesFromPoint(e,t){return this.model.getNodesFromPoint(e,t)}getNodesInArea(e,t,i,a,d){return this.model.getNodesInArea(e,t,i,a,d)}getNodesUnderNode(e,t={}){return this.model.getNodesUnderNode(e,t)}searchCell(e,t,i={}){return this.model.search(e,t,i),this}getShortestPath(e,t,i={}){return this.model.getShortestPath(e,t,i)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(e,t={}){return this.model.getCellsBBox(e,t)}startBatch(e,t={}){this.model.startBatch(e,t)}stopBatch(e,t={}){this.model.stopBatch(e,t)}batchUpdate(e,t,i){const a=typeof e=="string"?e:"update",d=typeof e=="string"?t:e,f=typeof t=="function"?i:t;this.startBatch(a,f);const m=d();return this.stopBatch(a,f),m}updateCellId(e,t){return this.model.updateCellId(e,t)}isFrozen(){return this.renderer.isFrozen()}freeze(e={}){return this.renderer.freeze(e),this}unfreeze(e={}){return this.renderer.unfreeze(e),this}isAsync(){return this.renderer.isAsync()}setAsync(e){return this.renderer.setAsync(e),this}findView(e){return Xr.isCell(e)?this.findViewByCell(e):this.findViewByElem(e)}findViews(e){return gn.isRectangleLike(e)?this.findViewsInArea(e):Oe.isPointLike(e)?this.findViewsFromPoint(e):[]}findViewByCell(e){return this.renderer.findViewByCell(e)}findViewByElem(e){return this.renderer.findViewByElem(e)}findViewsFromPoint(e,t){const i=typeof e=="number"?{x:e,y:t}:e;return this.renderer.findViewsFromPoint(i)}findViewsInArea(e,t,i,a,d){const f=typeof e=="number"?{x:e,y:t,width:i,height:a}:e,m=typeof e=="number"?d:t;return this.renderer.findViewsInArea(f,m)}isViewMounted(e){return this.renderer.isViewMounted(e)}getMountedViews(){return this.renderer.getMountedViews()}getUnmountedViews(){return this.renderer.getUnmountedViews()}matrix(e){return typeof e>"u"?this.transform.getMatrix():(this.transform.setMatrix(e),this)}resize(e,t){return this.size.resize(e,t),this}resizeGraph(e,t){return this.size.resizeGraph(e,t),this}resizeScroller(e,t){return this.size.resizeScroller(e,t),this}resizePage(e,t){return this.size.resizePage(e,t),this}scale(e,t=e,i=0,a=0){return typeof e>"u"?this.transform.getScale():(this.transform.scale(e,t,i,a),this)}zoom(e,t){const i=this.scroller.widget;if(i){if(typeof e>"u")return i.zoom();i.zoom(e,t)}else{if(typeof e>"u")return this.transform.getZoom();this.transform.zoom(e,t)}return this}zoomTo(e,t={}){const i=this.scroller.widget;return i?i.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})):this.transform.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})),this}zoomToRect(e,t={}){const i=this.scroller.widget;return i?i.zoomToRect(e,t):this.transform.zoomToRect(e,t),this}zoomToFit(e={}){const t=this.scroller.widget;return t?t.zoomToFit(e):this.transform.zoomToFit(e),this}rotate(e,t,i){return typeof e>"u"?this.transform.getRotation():(this.transform.rotate(e,t,i),this)}translate(e,t){return typeof e>"u"?this.transform.getTranslation():(this.transform.translate(e,t),this)}translateBy(e,t){const i=this.translate(),a=i.tx+e,d=i.ty+t;return this.translate(a,d)}getArea(){return this.transform.getGraphArea()}getGraphArea(){return this.transform.getGraphArea()}getContentArea(e={}){return this.transform.getContentArea(e)}getContentBBox(e={}){return this.transform.getContentBBox(e)}fitToContent(e,t,i,a){return this.transform.fitToContent(e,t,i,a)}scaleContentToFit(e={}){return this.transform.scaleContentToFit(e),this}center(e){return this.centerPoint(e)}centerPoint(e,t,i){const a=this.scroller.widget;return a?a.centerPoint(e,t,i):this.transform.centerPoint(e,t),this}centerContent(e){const t=this.scroller.widget;return t?t.centerContent(e):this.transform.centerContent(e),this}centerCell(e,t){const i=this.scroller.widget;return i?i.centerCell(e,t):this.transform.centerCell(e),this}positionPoint(e,t,i,a={}){const d=this.scroller.widget;return d?d.positionPoint(e,t,i,a):this.transform.positionPoint(e,t,i),this}positionRect(e,t,i){const a=this.scroller.widget;return a?a.positionRect(e,t,i):this.transform.positionRect(e,t),this}positionCell(e,t,i){const a=this.scroller.widget;return a?a.positionCell(e,t,i):this.transform.positionCell(e,t),this}positionContent(e,t){const i=this.scroller.widget;return i?i.positionContent(e,t):this.transform.positionContent(e,t),this}getClientMatrix(){return this.coord.getClientMatrix()}getClientOffset(){return this.coord.getClientOffset()}getPageOffset(){return this.coord.getPageOffset()}snapToGrid(e,t){return this.coord.snapToGrid(e,t)}pageToLocal(e,t,i,a){return gn.isRectangleLike(e)?this.coord.pageToLocalRect(e):typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof a=="number"?this.coord.pageToLocalRect(e,t,i,a):this.coord.pageToLocalPoint(e,t)}localToPage(e,t,i,a){return gn.isRectangleLike(e)?this.coord.localToPageRect(e):typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof a=="number"?this.coord.localToPageRect(e,t,i,a):this.coord.localToPagePoint(e,t)}clientToLocal(e,t,i,a){return gn.isRectangleLike(e)?this.coord.clientToLocalRect(e):typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof a=="number"?this.coord.clientToLocalRect(e,t,i,a):this.coord.clientToLocalPoint(e,t)}localToClient(e,t,i,a){return gn.isRectangleLike(e)?this.coord.localToClientRect(e):typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof a=="number"?this.coord.localToClientRect(e,t,i,a):this.coord.localToClientPoint(e,t)}localToGraph(e,t,i,a){return gn.isRectangleLike(e)?this.coord.localToGraphRect(e):typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof a=="number"?this.coord.localToGraphRect(e,t,i,a):this.coord.localToGraphPoint(e,t)}graphToLocal(e,t,i,a){return gn.isRectangleLike(e)?this.coord.graphToLocalRect(e):typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof a=="number"?this.coord.graphToLocalRect(e,t,i,a):this.coord.graphToLocalPoint(e,t)}clientToGraph(e,t,i,a){return gn.isRectangleLike(e)?this.coord.clientToGraphRect(e):typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof a=="number"?this.coord.clientToGraphRect(e,t,i,a):this.coord.clientToGraphPoint(e,t)}defineFilter(e){return this.defs.filter(e)}defineGradient(e){return this.defs.gradient(e)}defineMarker(e){return this.defs.marker(e)}getGridSize(){return this.grid.getGridSize()}setGridSize(e){return this.grid.setGridSize(e),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(e){return this.grid.draw(e),this}updateBackground(){return this.background.update(),this}drawBackground(e,t){const i=this.scroller.widget;return i!=null&&(this.options.background==null||!t)?i.backgroundManager.draw(e):this.background.draw(e),this}clearBackground(e){const t=this.scroller.widget;return t!=null&&(this.options.background==null||!e)?t.backgroundManager.clear():this.background.clear(),this}isClipboardEnabled(){return!this.clipboard.disabled}enableClipboard(){return this.clipboard.enable(),this}disableClipboard(){return this.clipboard.disable(),this}toggleClipboard(e){return e!=null?e!==this.isClipboardEnabled()&&(e?this.enableClipboard():this.disableClipboard()):this.isClipboardEnabled()?this.disableClipboard():this.enableClipboard(),this}isClipboardEmpty(){return this.clipboard.isEmpty()}getCellsInClipboard(){return this.clipboard.cells}cleanClipboard(){return this.clipboard.clean(),this}copy(e,t={}){return this.clipboard.copy(e,t),this}cut(e,t={}){return this.clipboard.cut(e,t),this}paste(e={},t=this){return this.clipboard.paste(e,t)}isHistoryEnabled(){return!this.history.disabled}enableHistory(){return this.history.enable(),this}disableHistory(){return this.history.disable(),this}toggleHistory(e){return e!=null?e!==this.isHistoryEnabled()&&(e?this.enableHistory():this.disableHistory()):this.isHistoryEnabled()?this.disableHistory():this.enableHistory(),this}undo(e={}){return this.history.undo(e),this}undoAndCancel(e={}){return this.history.cancel(e),this}redo(e={}){return this.history.redo(e),this}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}cleanHistory(e={}){this.history.clean(e)}isKeyboardEnabled(){return!this.keyboard.disabled}enableKeyboard(){return this.keyboard.enable(),this}disableKeyboard(){return this.keyboard.disable(),this}toggleKeyboard(e){return e!=null?e!==this.isKeyboardEnabled()&&(e?this.enableKeyboard():this.disableKeyboard()):this.isKeyboardEnabled()?this.disableKeyboard():this.enableKeyboard(),this}bindKey(e,t,i){return this.keyboard.on(e,t,i),this}unbindKey(e,t){return this.keyboard.off(e,t),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(e){return e==null?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():e?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){return this.scroller.widget?this.scroller.pannable:this.panning.pannable}enablePanning(){return this.scroller.widget?this.scroller.enablePanning():this.panning.enablePanning(),this}disablePanning(){return this.scroller.widget?this.scroller.disablePanning():this.panning.disablePanning(),this}togglePanning(e){return e==null?this.isPannable()?this.disablePanning():this.enablePanning():e!==this.isPannable()&&(e?this.enablePanning():this.disablePanning()),this}lockScroller(){var e;(e=this.scroller.widget)===null||e===void 0||e.lock()}unlockScroller(){var e;(e=this.scroller.widget)===null||e===void 0||e.unlock()}updateScroller(){var e;(e=this.scroller.widget)===null||e===void 0||e.update()}getScrollbarPosition(){return this.scroller.widget.scrollbarPosition()}setScrollbarPosition(e,t,i){return this.scroller.widget.scrollbarPosition(e,t,i),this}scrollToPoint(e,t,i){return this.scroller.widget.scrollToPoint(e,t,i),this}scrollToContent(e){return this.scroller.widget.scrollToContent(e),this}scrollToCell(e,t){return this.scroller.widget.scrollToCell(e,t),this}transitionToPoint(e,t,i){return this.scroller.widget.transitionToPoint(e,t,i),this}transitionToRect(e,t={}){return this.scroller.widget.transitionToRect(e,t),this}isSelectionEnabled(){return!this.selection.disabled}enableSelection(){return this.selection.enable(),this}disableSelection(){return this.selection.disable(),this}toggleSelection(e){return e!=null?e!==this.isSelectionEnabled()&&(e?this.enableSelection():this.disableSelection()):this.isSelectionEnabled()?this.disableSelection():this.enableSelection(),this}isMultipleSelection(){return this.selection.isMultiple()}enableMultipleSelection(){return this.selection.enableMultiple(),this}disableMultipleSelection(){return this.selection.disableMultiple(),this}toggleMultipleSelection(e){return e!=null?e!==this.isMultipleSelection()&&(e?this.enableMultipleSelection():this.disableMultipleSelection()):this.isMultipleSelection()?this.disableMultipleSelection():this.enableMultipleSelection(),this}isSelectionMovable(){return this.selection.widget.options.movable!==!1}enableSelectionMovable(){return this.selection.widget.options.movable=!0,this}disableSelectionMovable(){return this.selection.widget.options.movable=!1,this}toggleSelectionMovable(e){return e!=null?e!==this.isSelectionMovable()&&(e?this.enableSelectionMovable():this.disableSelectionMovable()):this.isSelectionMovable()?this.disableSelectionMovable():this.enableSelectionMovable(),this}isRubberbandEnabled(){return!this.selection.rubberbandDisabled}enableRubberband(){return this.selection.enableRubberband(),this}disableRubberband(){return this.selection.disableRubberband(),this}toggleRubberband(e){return e!=null?e!==this.isRubberbandEnabled()&&(e?this.enableRubberband():this.disableRubberband()):this.isRubberbandEnabled()?this.disableRubberband():this.enableRubberband(),this}isStrictRubberband(){return this.selection.widget.options.strict===!0}enableStrictRubberband(){return this.selection.widget.options.strict=!0,this}disableStrictRubberband(){return this.selection.widget.options.strict=!1,this}toggleStrictRubberband(e){return e!=null?e!==this.isStrictRubberband()&&(e?this.enableStrictRubberband():this.disableStrictRubberband()):this.isStrictRubberband()?this.disableStrictRubberband():this.enableStrictRubberband(),this}setRubberbandModifiers(e){this.selection.setModifiers(e)}setSelectionFilter(e){return this.selection.setFilter(e),this}setSelectionDisplayContent(e){return this.selection.setContent(e),this}isSelectionEmpty(){return this.selection.isEmpty()}cleanSelection(e){return this.selection.clean(e),this}resetSelection(e,t){return this.selection.reset(e,t),this}getSelectedCells(){return this.selection.cells}getSelectedCellCount(){return this.selection.length}isSelected(e){return this.selection.isSelected(e)}select(e,t){return this.selection.select(e,t),this}unselect(e,t){return this.selection.unselect(e,t),this}isSnaplineEnabled(){return!this.snapline.widget.disabled}enableSnapline(){return this.snapline.widget.enable(),this}disableSnapline(){return this.snapline.widget.disable(),this}toggleSnapline(e){if(e!=null)e!==this.isSnaplineEnabled()&&(e?this.enableSnapline():this.disableSnapline());else return this.isSnaplineEnabled()?this.disableSnapline():this.enableSnapline(),this}hideSnapline(){return this.snapline.widget.hide(),this}setSnaplineFilter(e){return this.snapline.widget.setFilter(e),this}isSnaplineOnResizingEnabled(){return this.snapline.widget.options.resizing===!0}enableSnaplineOnResizing(){return this.snapline.widget.options.resizing=!0,this}disableSnaplineOnResizing(){return this.snapline.widget.options.resizing=!1,this}toggleSnaplineOnResizing(e){return e!=null?e!==this.isSnaplineOnResizingEnabled()&&(e?this.enableSnaplineOnResizing():this.disableSnaplineOnResizing()):this.isSnaplineOnResizingEnabled()?this.disableSnaplineOnResizing():this.enableSnaplineOnResizing(),this}isSharpSnapline(){return this.snapline.widget.options.sharp===!0}enableSharpSnapline(){return this.snapline.widget.options.sharp=!0,this}disableSharpSnapline(){return this.snapline.widget.options.sharp=!1,this}toggleSharpSnapline(e){return e!=null?e!==this.isSharpSnapline()&&(e?this.enableSharpSnapline():this.disableSharpSnapline()):this.isSharpSnapline()?this.disableSharpSnapline():this.enableSharpSnapline(),this}getSnaplineTolerance(){return this.snapline.widget.options.tolerance}setSnaplineTolerance(e){return this.snapline.widget.options.tolerance=e,this}removeTools(){return this.emit("tools:remove"),this}hideTools(){return this.emit("tools:hide"),this}showTools(){return this.emit("tools:show"),this}toSVG(e,t={}){this.format.toSVG(e,t)}toDataURL(e,t){this.format.toDataURL(e,t)}toPNG(e,t={}){this.format.toPNG(e,t)}toJPEG(e,t={}){this.format.toJPEG(e,t)}printPreview(e){this.print.show(e)}dispose(){this.clearCells(),this.off(),this.css.dispose(),this.hook.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.knob.dispose(),this.highlight.dispose(),this.background.dispose(),this.clipboard.dispose(),this.snapline.dispose(),this.selection.dispose(),this.history.dispose(),this.keyboard.dispose(),this.mousewheel.dispose(),this.print.dispose(),this.format.dispose(),this.minimap.dispose(),this.panning.dispose(),this.scroller.dispose(),this.view.dispose(),this.renderer.dispose(),this.size.dispose()}}oc([Ka.checkScroller()],Ci.prototype,"lockScroller",null),oc([Ka.checkScroller()],Ci.prototype,"unlockScroller",null),oc([Ka.checkScroller()],Ci.prototype,"updateScroller",null),oc([Ka.checkScroller()],Ci.prototype,"getScrollbarPosition",null),oc([Ka.checkScroller()],Ci.prototype,"setScrollbarPosition",null),oc([Ka.checkScroller()],Ci.prototype,"scrollToPoint",null),oc([Ka.checkScroller()],Ci.prototype,"scrollToContent",null),oc([Ka.checkScroller()],Ci.prototype,"scrollToCell",null),oc([Ka.checkScroller()],Ci.prototype,"transitionToPoint",null),oc([Ka.checkScroller()],Ci.prototype,"transitionToRect",null),oc([Is.dispose()],Ci.prototype,"dispose",null),function(c){c.View=El,c.Hook=Jr,c.Renderer=bi,c.Keyboard=Xh,c.MouseWheel=Oy,c.BaseManager=Di,c.DefsManager=Ud,c.GridManager=Al,c.CoordManager=Lg,c.PrintManager=Yh,c.FormatManager=sC,c.MiniMapManager=Py,c.HistoryManager=Zh,c.SnaplineManager=y0,c.ScrollerManager=Ay,c.ClipboardManager=Ty,c.TransformManager=x0,c.HighlightManager=Fg,c.BackgroundManager=kg,c.SelectionManager=My}(Ci||(Ci={})),function(c){c.toStringTag=`X6.${c.name}`;function e(t){if(t==null)return!1;if(t instanceof c)return!0;const i=t[Symbol.toStringTag],a=t;return(i==null||i===c.toStringTag)&&a.hook!=null&&a.view!=null&&a.model!=null}c.isGraph=e}(Ci||(Ci={})),function(c){function e(t,i){const a=t instanceof HTMLElement?new c({container:t}):new c(t);return i!=null&&a.fromJSON(i),a}c.render=e}(Ci||(Ci={})),function(c){c.registerNode=Si.registry.register,c.registerEdge=Qi.registry.register,c.registerView=xo.registry.register,c.registerAttr=yl.registry.register,c.registerGrid=Gc.registry.register,c.registerFilter=Od.registry.register,c.registerNodeTool=sp.registry.register,c.registerEdgeTool=Gh.registry.register,c.registerBackground=Lh.registry.register,c.registerHighlighter=Xa.registry.register,c.registerPortLayout=Au.registry.register,c.registerPortLabelLayout=Fh.registry.register,c.registerMarker=ia.registry.register,c.registerRouter=Id.registry.register,c.registerConnector=Du.registry.register,c.registerAnchor=ap.registry.register,c.registerEdgeAnchor=Bh.registry.register,c.registerConnectionPoint=zh.registry.register,c.registerConnectionStrategy=kd.registry.register,c.registerHTMLComponent=Ya.componentRegistry.register}(Ci||(Ci={})),function(c){c.unregisterNode=Si.registry.unregister,c.unregisterEdge=Qi.registry.unregister,c.unregisterView=xo.registry.unregister,c.unregisterAttr=yl.registry.unregister,c.unregisterGrid=Gc.registry.unregister,c.unregisterFilter=Od.registry.unregister,c.unregisterNodeTool=sp.registry.unregister,c.unregisterEdgeTool=Gh.registry.unregister,c.unregisterBackground=Lh.registry.unregister,c.unregisterHighlighter=Xa.registry.unregister,c.unregisterPortLayout=Au.registry.unregister,c.unregisterPortLabelLayout=Fh.registry.unregister,c.unregisterMarker=ia.registry.unregister,c.unregisterRouter=Id.registry.unregister,c.unregisterConnector=Du.registry.unregister,c.unregisterAnchor=ap.registry.unregister,c.unregisterEdgeAnchor=Bh.registry.unregister,c.unregisterConnectionPoint=zh.registry.unregister,c.unregisterConnectionStrategy=kd.registry.unregister,c.unregisterHTMLComponent=Ya.componentRegistry.unregister}(Ci||(Ci={}));class eS{constructor(){this.cells=[]}copy(e,t,i={}){this.options=Object.assign({},i);const d=($s.isModel(t)?t:t.model).cloneSubGraph(e,i);this.cells=ju(Object.keys(d).map(f=>d[f]),f=>f.isEdge()?2:1),this.serialize(i)}cut(e,t,i={}){this.copy(e,t,i),(Ci.isGraph(t)?t.model:t).batchUpdate("cut",()=>{e.forEach(d=>d.remove())})}paste(e,t={}){const i=Object.assign(Object.assign({},this.options),t),{offset:a,edgeProps:d,nodeProps:f}=i;let m=20,y=20;a&&(m=typeof a=="number"?a:a.dx,y=typeof a=="number"?a:a.dy),this.deserialize(i);const x=this.cells;x.forEach(S=>{S.model=null,S.removeProp("zIndex"),(m||y)&&S.translate(m,y),f&&S.isNode()&&S.prop(f),d&&S.isEdge()&&S.prop(d)});const E=Ci.isGraph(e)?e.model:e;return E.batchUpdate("paste",()=>{E.addCells(this.cells)}),this.copy(x,e,t),x}serialize(e){e.useLocalStorage!==!1&&ji.save(this.cells)}deserialize(e){if(e.useLocalStorage){const t=ji.fetch();t&&(this.cells=t)}}isEmpty(){return this.cells.length<=0}clean(){this.options={},this.cells=[],ji.clean()}}var ji;(function(c){const e=`${Hs.prefixCls}.clipboard.cells`;function t(d){if(window.localStorage){const f=d.map(m=>m.toJSON());localStorage.setItem(e,JSON.stringify(f))}}c.save=t;function i(){if(window.localStorage){const d=localStorage.getItem(e),f=d?JSON.parse(d):[];if(f)return $s.fromJSON(f)}}c.fetch=i;function a(){window.localStorage&&localStorage.removeItem(e)}c.clean=a})(ji||(ji={}));class VA{constructor(e){this.halo=e}get options(){return this.halo.options}get graph(){return this.halo.graph}get model(){return this.halo.model}get view(){return this.halo.view}get cell(){return this.halo.cell}get node(){return this.cell}getPresets(){return{className:"type-node",handles:[{name:"remove",position:"nw",events:{mousedown:this.removeCell.bind(this)},icon:null},{name:"resize",position:"se",events:{mousedown:this.startResize.bind(this),mousemove:this.doResize.bind(this),mouseup:this.stopResize.bind(this)},icon:null},{name:"clone",position:"n",events:{mousedown:this.startClone.bind(this),mousemove:this.doClone.bind(this),mouseup:this.stopClone.bind(this)},icon:null},{name:"link",position:"e",events:{mousedown:this.startLink.bind(this),mousemove:this.doLink.bind(this),mouseup:this.stopLink.bind(this)},icon:null},{name:"fork",position:"ne",events:{mousedown:this.startFork.bind(this),mousemove:this.doFork.bind(this),mouseup:this.stopFork.bind(this)},icon:null},{name:"unlink",position:"w",events:{mousedown:this.unlink.bind(this)},icon:null},{name:"rotate",position:"sw",events:{mousedown:this.startRotate.bind(this),mousemove:this.doRotate.bind(this),mouseup:this.stopRotate.bind(this)},icon:null}],bbox(e){return this.options.useCellGeometry?e.cell.getBBox():e.getBBox()},content(e){const t=Tt("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),i=e.cell,a=i.getBBox();return t({x:Math.floor(a.x),y:Math.floor(a.y),width:Math.floor(a.width),height:Math.floor(a.height),angle:Math.floor(i.getAngle())})},magnet(e){return e.container},tinyThreshold:40,smallThreshold:80,loopEdgePreferredSide:"top",loopEdgeWidth:40,rotateGrid:15,rotateEmbeds:!1}}removeCell(){this.model.removeConnectedEdges(this.cell),this.cell.remove()}startLink({x:e,y:t}){this.halo.startBatch();const i=this.graph,a=this.createEdgeConnectedToSource();a.setTarget({x:e,y:t}),this.model.addEdge(a,{validation:!1,halo:this.halo.cid,async:!1}),i.view.undelegateEvents(),this.edgeView=i.renderer.findViewByCell(a),this.edgeView.prepareArrowheadDragging("target",{x:e,y:t,fallbackAction:"remove"})}createEdgeConnectedToSource(){const e=this.getMagnet(this.view,"source"),t=this.getEdgeTerminal(this.view,e),i=this.graph.hook.getDefaultEdge(this.view,e);return i.setSource(t),i}getMagnet(e,t){const i=this.options.magnet;if(typeof i=="function"){const a=Pn(i,this.halo,e,t);if(a instanceof SVGElement)return a}throw new Error("`magnet()` has to return an SVGElement")}getEdgeTerminal(e,t){const i={cell:e.cell.id};if(t!==e.container){const a=t.getAttribute("port");a?i.port=a:i.selector=e.getSelector(t)}return i}doLink({e,x:t,y:i}){this.edgeView&&this.edgeView.onMouseMove(e,t,i)}stopLink({e,x:t,y:i}){const a=this.edgeView;if(a){a.onMouseUp(e,t,i);const d=a.cell;d.hasLoop()&&this.makeLoopEdge(d),this.halo.stopBatch(),this.halo.trigger("action:edge:addde",{edge:d}),this.edgeView=null}this.graph.view.delegateEvents()}makeLoopEdge(e){let t=null,i=null;const a=this.options.loopEdgeWidth,d=this.graph.options,f=new gn(0,0,d.width,d.height),m=this.graph.graphToLocal(this.view.getBBox());[this.options.loopEdgePreferredSide,"top","bottom","left","right"].some(x=>{let E=null,S=0,T=0;switch(x){case"top":E=new Oe(m.x+m.width/2,m.y-a),S=a/2;break;case"bottom":E=new Oe(m.x+m.width/2,m.y+m.height+a),S=a/2;break;case"left":E=new Oe(m.x-a,m.y+m.height/2),T=a/2;break;case"right":E=new Oe(m.x+m.width+a,m.y+m.height/2),T=a/2;break;default:break}return E?(t=E.translate(-S,-T),i=E.translate(S,T),f.containsPoint(t)&&f.containsPoint(i)):!1})&&t&&i&&e.setVertices([t,i])}startResize({e}){this.halo.startBatch(),this.flip=[1,0,0,1,1,0,0,1][Math.floor(ri.normalize(this.node.getAngle())/45)],this.view.addClass("node-resizing"),Wi("node:resize",e,this.view)}doResize({e,dx:t,dy:i}){const a=this.node.getSize(),d=Math.max(a.width+(this.flip?t:i),1),f=Math.max(a.height+(this.flip?i:t),1);this.node.resize(d,f,{absolute:!0}),Wi("node:resizing",e,this.view)}stopResize({e}){this.view.removeClass("node-resizing"),Wi("node:resized",e,this.view),this.halo.stopBatch()}startClone({e,x:t,y:i}){this.halo.startBatch();const d=this.options.clone(this.cell,{clone:!0});if(!Xr.isCell(d))throw new Error("option 'clone()' has to return a cell");this.centerNodeAtCursor(d,t,i),this.model.addCell(d,{halo:this.halo.cid,async:!1});const f=this.graph.renderer.findViewByCell(d);f.onMouseDown(e,t,i),this.halo.setEventData(e,{cloneView:f})}centerNodeAtCursor(e,t,i){const a=e.getBBox().getCenter(),d=t-a.x,f=i-a.y;e.translate(d,f)}doClone({e,x:t,y:i}){const a=this.halo.getEventData(e).cloneView;a&&a.onMouseMove(e,t,i)}stopClone({e,x:t,y:i}){const a=this.halo.getEventData(e).cloneView;a&&a.onMouseUp(e,t,i),this.halo.stopBatch()}startFork({e,x:t,y:i}){this.halo.startBatch();const a=this.options.clone(this.cell,{fork:!0});if(!Xr.isCell(a))throw new Error("option 'clone()' has to return a cell");this.centerNodeAtCursor(a,t,i),this.model.addCell(a,{halo:this.halo.cid,async:!1});const d=this.createEdgeConnectedToSource(),f=this.graph.renderer.findViewByCell(a),m=this.getMagnet(f,"target"),y=this.getEdgeTerminal(f,m);d.setTarget(y),this.model.addEdge(d,{halo:this.halo.cid,async:!1}),f.onMouseDown(e,t,i),this.halo.setEventData(e,{cloneView:f})}doFork({e,x:t,y:i}){const a=this.halo.getEventData(e).cloneView;a&&a.onMouseMove(e,t,i)}stopFork({e,x:t,y:i}){const a=this.halo.getEventData(e).cloneView;a&&a.onMouseUp(e,t,i),this.halo.stopBatch()}startRotate({e,x:t,y:i}){this.halo.startBatch();const a=this.node.getBBox().getCenter(),d=[this.node];this.options.rotateEmbeds&&this.node.getDescendants({deep:!0}).reduce((f,m)=>(m.isNode()&&f.push(m),f),d),this.halo.setEventData(e,{center:a,nodes:d,rotateStartAngles:d.map(f=>f.getAngle()),clientStartAngle:new Oe(t,i).theta(a)}),d.forEach(f=>{const m=this.graph.findViewByCell(f);m&&(m.addClass("node-rotating"),Wi("node:rotate",e,m))})}doRotate({e,x:t,y:i}){const a=this.halo.getEventData(e),d=a.clientStartAngle-new Oe(t,i).theta(a.center);a.nodes.forEach((f,m)=>{const y=a.rotateStartAngles[m],x=Bo.snapToGrid(y+d,this.options.rotateGrid);f.rotate(x,{absolute:!0,center:a.center,halo:this.halo.cid}),Wi("node:rotating",e,this.graph.findViewByCell(f))})}stopRotate({e}){this.halo.getEventData(e).nodes.forEach(i=>{const a=this.graph.findViewByCell(i);a.removeClass("node-rotating"),Wi("node:rotated",e,a)}),this.halo.stopBatch()}unlink(){this.halo.startBatch(),this.model.removeConnectedEdges(this.cell),this.halo.stopBatch()}}class tS{constructor(e){this.halo=e}get options(){return this.halo.options}get graph(){return this.halo.graph}get model(){return this.halo.model}get view(){return this.halo.view}get cell(){return this.halo.cell}get edge(){return this.cell}getPresets(){return{className:"type-edge",handles:[{name:"remove",position:"nw",icon:null,events:{mousedown:this.removeEdge.bind(this)}},{name:"direction",position:"se",icon:null,events:{mousedown:this.directionSwap.bind(this)}}],content:!1,bbox(e){return e.graph.localToGraph(e.getPointAtRatio(.5))},tinyThreshold:-1,smallThreshold:-1}}removeEdge(){this.cell.remove()}directionSwap(){const e=this.edge.getSource(),t=this.edge.getTarget();this.edge.prop({source:t,target:e})}}class Gg extends fp{get type(){return this.options.type||"surround"}get handleOptions(){return this.options}init(e){this.options=Pi.Z(Gg.defaultOptions,this.cell.isNode()?new VA(this).getPresets():this.cell.isEdge()?new tS(this).getPresets():null,e),this.render(),this.initHandles(),this.update(),this.startListening()}startListening(){const e=this.model,t=this.graph;this.view.cell.on("removed",this.remove,this),e.on("reseted",this.remove,this),t.on("halo:destroy",this.remove,this),e.on("*",this.update,this),t.on("scale",this.update,this),t.on("translate",this.update,this),super.startListening()}stopListening(){const e=this.model,t=this.graph,i=this.view.cell;this.undelegateEvents(),i.off("removed",this.remove,this),e.off("reseted",this.remove,this),t.off("halo:destroy",this.remove,this),e.off("*",this.update,this),t.off("scale",this.update,this),t.off("translate",this.update,this),super.stopListening()}render(){const e=this.options,t=this.prefixClassName("widget-halo");return this.view.addClass(C0.NODE_CLS),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(t).attr("data-shape",this.view.cell.shape),e.className&&this.$container.addClass(e.className),this.$handleContainer=this.$("<div/>").addClass(`${t}-handles`).appendTo(this.container),this.$content=this.$("<div/>").addClass(`${t}-content`).appendTo(this.container),this.$container.appendTo(this.graph.container),this}remove(){return this.stopBatch(),this.view.removeClass(C0.NODE_CLS),super.remove()}update(){if(this.isRendered()){this.updateContent();const e=this.getBBox(),t=this.options.tinyThreshold||0,i=this.options.smallThreshold||0;this.$handleContainer.toggleClass(`${this.handleClassName}-tiny`,e.width<t&&e.height<t);const a=`${this.handleClassName}-small`;this.$handleContainer.toggleClass(a,!this.$handleContainer.hasClass(a)&&e.width<i&&e.height<i),this.$container.css({width:e.width,height:e.height,left:e.x,top:e.y}),this.hasHandle("unlink")&&this.toggleUnlink(),(this.type==="surround"||this.type==="toolbar")&&this.hasHandle("fork")&&this.toggleFork()}}updateContent(){const e=this.options.content;if(typeof e=="function"){const t=Pn(e,this,this.view,this.$content[0]);t&&this.$content.html(t)}else e?this.$content.html(e):this.$content.remove()}getBBox(){const e=this.view,t=this.options.bbox,i=typeof t=="function"?Pn(t,this,e):t;return gn.create(Object.assign({x:0,y:0,width:1,height:1},i))}removeCell(){this.cell.remove()}toggleFork(){const e=this.view.cell.clone(),t=this.graph.hook.createCellView(e),i=this.graph.hook.validateConnection(this.view,null,t,null,"target");this.$handleContainer.children(".fork").toggleClass("hidden",!i),t.remove()}toggleUnlink(){const e=this.model.getConnectedEdges(this.view.cell).length>0;this.$handleContainer.children(".unlink").toggleClass("hidden",!e)}startBatch(){this.model.startBatch("halo",{halo:this.cid})}stopBatch(){this.model.hasActiveBatch("halo")&&this.model.stopBatch("halo",{halo:this.cid})}}(function(c){c.defaultOptions={type:"surround",clearAll:!0,clearOnBlankMouseDown:!0,useCellGeometry:!1,clone:e=>e.clone().removeZIndex()}})(Gg||(Gg={})),Object.getOwnPropertyNames(Gd.prototype).forEach(c=>{c!=="constructor"&&Object.defineProperty(Gg.prototype,c,Object.getOwnPropertyDescriptor(Gd.prototype,c))});var C0;(function(c){c.NODE_CLS="has-widget-halo"})(C0||(C0={}));var nS=function(c,e,t,i){var a=arguments.length,d=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,t,i);else for(var m=c.length-1;m>=0;m--)(f=c[m])&&(d=(a<3?f(d):a>3?f(e,t,d):f(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};class Ru extends ii{constructor(e){super(),this.options=Object.assign(Object.assign({},Ru.defaults),e),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName("widget-dnd")),this.draggingGraph=new Ci(Object.assign(Object.assign({},this.options.delegateGraphOptions),{container:document.createElement("div"),width:1,height:1})),this.$container.append(this.draggingGraph.container)}get targetScroller(){const e=this.options.target;return Ci.isGraph(e)?e.scroller.widget:e}get targetGraph(){const e=this.options.target;return Ci.isGraph(e)?e:e.graph}get targetModel(){return this.targetGraph.model}get snapline(){return this.targetGraph.snapline.widget}start(e,t){const i=t;i.preventDefault(),this.targetModel.startBatch("dnd"),this.$container.addClass("dragging").appendTo(this.options.containerParent||document.body),this.sourceNode=e,this.prepareDragging(e,i.clientX,i.clientY);const a=this.updateNodePosition(i.clientX,i.clientY);this.isSnaplineEnabled()&&(this.snapline.captureCursorOffset({e:i,node:e,cell:e,view:this.draggingView,x:a.x,y:a.y}),this.draggingNode.on("change:position",this.snap,this)),this.delegateDocumentEvents(Ru.documentEvents,i.data)}isSnaplineEnabled(){return this.snapline&&!this.snapline.disabled}prepareDragging(e,t,i){const a=this.draggingGraph,d=a.model,f=this.options.getDragNode(e,{sourceNode:e,draggingGraph:a,targetGraph:this.targetGraph});f.position(0,0);let m=5;if(this.isSnaplineEnabled()&&(m+=this.snapline.options.tolerance||0),this.isSnaplineEnabled()||this.options.scaled){const E=this.targetGraph.transform.getScale();a.scale(E.sx,E.sy),m*=Math.max(E.sx,E.sy)}else a.scale(1,1);this.clearDragging(),this.options.animation&&this.$container.stop(!0,!0),d.resetCells([f]);const y=a.findViewByCell(f);y.undelegateEvents(),y.cell.off("changed"),a.fitToContent({padding:m,allowNewOrigin:"any"});const x=y.getBBox();this.geometryBBox=y.getBBox({useCellGeometry:!0}),this.delta=this.geometryBBox.getTopLeft().diff(x.getTopLeft()),this.draggingNode=f,this.draggingView=y,this.draggingBBox=f.getBBox(),this.padding=m,this.originOffset=this.updateGraphPosition(t,i)}updateGraphPosition(e,t){const i=document.body.scrollTop||document.documentElement.scrollTop,a=this.delta,d=this.geometryBBox,f=this.padding||5,m={left:e-a.x-d.width/2-f,top:t-a.y-d.height/2-f+i};return this.draggingGraph&&this.$container.offset(m),m}updateNodePosition(e,t){const i=this.targetGraph.clientToLocal(e,t),a=this.draggingBBox;return i.x-=a.width/2,i.y-=a.height/2,this.draggingNode.position(i.x,i.y),i}snap({cell:e,current:t,options:i}){const a=e;if(i.snapped){const d=this.draggingBBox;a.position(d.x+i.tx,d.y+i.ty,{silent:!0}),this.draggingView.translate(),a.position(t.x,t.y,{silent:!0}),this.snapOffset={x:i.tx,y:i.ty}}else this.snapOffset=null}onDragging(e){const t=this.draggingView;if(t){e.preventDefault();const i=this.normalizeEvent(e),a=i.clientX,d=i.clientY;this.updateGraphPosition(a,d);const f=this.updateNodePosition(a,d),m=this.targetGraph.options.embedding.enabled,y=(m||this.isSnaplineEnabled())&&this.isInsideValidArea({x:a,y:d});if(m){t.setEventData(i,{graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView});const x=t.getEventData(i);y?t.processEmbedding(i,x):t.clearEmbedding(x),this.candidateEmbedView=x.candidateEmbedView}this.isSnaplineEnabled()&&(y?this.snapline.snapOnMoving({e:i,view:t,x:f.x,y:f.y}):this.snapline.hide())}}onDragEnd(e){const t=this.draggingNode;if(t){const i=this.normalizeEvent(e),a=this.draggingView,d=this.draggingBBox,f=this.snapOffset;let m=d.x,y=d.y;f&&(m+=f.x,y+=f.y),t.position(m,y,{silent:!0});const x=this.drop(t,{x:i.clientX,y:i.clientY}),E=S=>{S?(this.onDropped(t),this.targetGraph.options.embedding.enabled&&a&&(a.setEventData(i,{cell:S,graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView}),a.finalizeEmbedding(i,a.getEventData(i)))):this.onDropInvalid(),this.candidateEmbedView=null,this.targetModel.stopBatch("dnd")};Mm(x)?(this.undelegateDocumentEvents(),x.then(E)):E(x)}}clearDragging(){this.draggingNode&&(this.sourceNode=null,this.draggingNode.remove(),this.draggingNode=null,this.draggingView=null,this.delta=null,this.padding=null,this.snapOffset=null,this.originOffset=null,this.undelegateDocumentEvents())}onDropped(e){this.draggingNode===e&&(this.clearDragging(),this.$container.removeClass("dragging").remove())}onDropInvalid(){const e=this.draggingNode;if(e){const t=this.options.animation;if(t){const i=typeof t=="object"&&t.duration||150,a=typeof t=="object"&&t.easing||"swing";this.draggingView=null,this.$container.animate(this.originOffset,i,a,()=>this.onDropped(e))}else this.onDropped(e)}}isInsideValidArea(e){let t;const i=this.targetGraph,a=this.targetScroller;if(a)if(a.options.autoResize)t=this.getDropArea(a.container);else{const d=this.getDropArea(a.container);t=this.getDropArea(i.container).intersectsWithRect(d)}else t=this.getDropArea(i.container);return t&&t.containsPoint(e)}getDropArea(e){const t=this.$(e),i=t.offset(),a=document.body.scrollTop||document.documentElement.scrollTop,d=document.body.scrollLeft||document.documentElement.scrollLeft;return gn.create({x:i.left+parseInt(t.css("border-left-width"),10)-d,y:i.top+parseInt(t.css("border-top-width"),10)-a,width:t.innerWidth(),height:t.innerHeight()})}drop(e,t){if(this.isInsideValidArea(t)){const i=this.targetGraph,a=i.model,d=i.clientToLocal(t),f=this.sourceNode,m=this.options.getDropNode(e,{sourceNode:f,draggingNode:e,targetGraph:this.targetGraph,draggingGraph:this.draggingGraph}),y=m.getBBox();d.x+=y.x-y.width/2,d.y+=y.y-y.height/2;const x=this.snapOffset?1:i.getGridSize();m.position(Bo.snapToGrid(d.x,x),Bo.snapToGrid(d.y,x)),m.removeZIndex();const E=this.options.validateNode,S=E?E(m,{sourceNode:f,draggingNode:e,droppingNode:m,targetGraph:i,draggingGraph:this.draggingGraph}):!0;return typeof S=="boolean"?S?(a.addCell(m,{stencil:this.cid}),m):null:hv(S).then(T=>T?(a.addCell(m,{stencil:this.cid}),m):null)}return null}onRemove(){this.draggingGraph&&(this.draggingGraph.view.remove(),this.draggingGraph.dispose())}dispose(){this.remove()}}nS([ii.dispose()],Ru.prototype,"dispose",null),function(c){c.defaults={animation:!1,getDragNode:e=>e.clone(),getDropNode:e=>e.clone()},c.documentEvents={mousemove:"onDragging",touchmove:"onDragging",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"}}(Ru||(Ru={}));function Dy(c,e={}){const t=$s.isModel(c)?c:new $s().resetCells(c,{sort:!1,dryrun:!0}),i=t.getNodes(),a=e.columns||1,d=Math.ceil(i.length/a),f=e.dx||0,m=e.dy||0,y=e.center!==!1,x=e.resizeToFit===!0,E=e.marginX||0,S=e.marginY||0,T=[];let R=e.columnWidth;if(R==="compact")for(let be=0;be<a;be+=1){const se=sc.getNodesInColumn(i,be,a);T.push(sc.getMaxDim(se,"width")+f)}else{(R==null||R==="auto")&&(R=sc.getMaxDim(i,"width")+f);for(let be=0;be<a;be+=1)T.push(R)}const V=sc.accumulate(T,E),j=[];let q=e.rowHeight;if(q==="compact")for(let be=0;be<d;be+=1){const se=sc.getNodesInRow(i,be,a);j.push(sc.getMaxDim(se,"height")+m)}else{(q==null||q==="auto")&&(q=sc.getMaxDim(i,"height")+m);for(let be=0;be<d;be+=1)j.push(q)}const ue=sc.accumulate(j,S);t.startBatch("layout"),i.forEach((be,se)=>{const Pe=se%a,He=Math.floor(se/a),ft=T[Pe],pt=j[He];let kt=0,cn=0,Bt=be.getSize();if(x){let Xt=ft-2*f,on=pt-2*m;const fr=Bt.height*(Bt.width?Xt/Bt.width:1),Cr=Bt.width*(Bt.height?on/Bt.height:1);pt<fr?Xt=Cr:on=fr,Bt={width:Xt,height:on},be.setSize(Bt,e)}y&&(kt=(ft-Bt.width)/2,cn=(pt-Bt.height)/2),be.position(V[Pe]+f+kt,ue[He]+m+cn,e)}),t.stopBatch("layout")}var sc;(function(c){function e(d,f){return d.reduce((m,y)=>Math.max(y.getSize()[f],m),0)}c.getMaxDim=e;function t(d,f,m){const y=[];for(let x=m*f,E=x+m;x<E;x+=1)y.push(d[x]);return y}c.getNodesInRow=t;function i(d,f,m){const y=[];for(let x=f,E=d.length;x<E;x+=m)y.push(d[x]);return y}c.getNodesInColumn=i;function a(d,f){return d.reduce((m,y,x)=>(m.push(m[x]+y),m),[f||0])}c.accumulate=a})(sc||(sc={}));class Bg extends ii{constructor(e){super(),this.graphs={},this.$groups={},this.options=Object.assign(Object.assign({},Bg.defaultOptions),e),this.dnd=new Ru(this.options),this.onSearch=dv.Z(this.onSearch,200),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(_a.base)).attr("data-not-found-text",this.options.notFoundText||"No matches found"),this.options.collapsable=e.collapsable&&e.groups&&e.groups.some(i=>i.collapsable!==!1),this.options.collapsable&&(this.$container.addClass("collapsable"),e.groups&&e.groups.every(a=>a.collapsed||a.collapsable===!1)&&this.$container.addClass("collapsed")),this.$("<div/>").addClass(this.prefixClassName(_a.title)).html(this.options.title).appendTo(this.$container),e.search&&this.$container.addClass("searchable").append(this.renderSearch()),this.$content=this.$("<div/>").addClass(this.prefixClassName(_a.content)).appendTo(this.$container);const t=e.stencilGraphOptions||{};if(e.groups&&e.groups.length)e.groups.forEach(i=>{const a=this.$("<div/>").addClass(this.prefixClassName(_a.group)).attr("data-name",i.name);(i.collapsable==null&&e.collapsable||i.collapsable!==!1)&&a.addClass("collapsable"),a.toggleClass("collapsed",i.collapsed===!0);const d=this.$("<h3/>").addClass(this.prefixClassName(_a.groupTitle)).html(i.title||i.name),f=this.$("<div/>").addClass(this.prefixClassName(_a.groupContent)),m=i.graphOptions,y=new Ci(Object.assign(Object.assign(Object.assign({},t),m),{container:document.createElement("div"),model:t.model||new $s,width:i.graphWidth||e.stencilGraphWidth,height:i.graphHeight||e.stencilGraphHeight,interacting:!1,preventDefaultBlankAction:!1}));f.append(y.container),a.append(d,f).appendTo(this.$content),this.$groups[i.name]=a,this.graphs[i.name]=y});else{const i=new Ci(Object.assign(Object.assign({},t),{container:document.createElement("div"),model:t.model||new $s,width:e.stencilGraphWidth,height:e.stencilGraphHeight,interacting:!1,preventDefaultBlankAction:!1}));this.$content.append(i.container),this.graphs[bp.defaultGroupName]=i}return this.startListening(),this}get targetScroller(){const e=this.options.target;return Ci.isGraph(e)?e.scroller.widget:e}get targetGraph(){const e=this.options.target;return Ci.isGraph(e)?e:e.graph}get targetModel(){return this.targetGraph.model}renderSearch(){return this.$("<div/>").addClass(this.prefixClassName(_a.search)).append(this.$("<input/>").attr({type:"search",placeholder:this.options.placeholder||"Search"}).addClass(this.prefixClassName(_a.searchText)))}startListening(){const e=this.prefixClassName(_a.title),t=this.prefixClassName(_a.searchText),i=this.prefixClassName(_a.groupTitle);this.delegateEvents({[`click .${e}`]:"onTitleClick",[`touchstart .${e}`]:"onTitleClick",[`click .${i}`]:"onGroupTitleClick",[`touchstart .${i}`]:"onGroupTitleClick",[`input .${t}`]:"onSearch",[`focusin .${t}`]:"onSearchFocusIn",[`focusout .${t}`]:"onSearchFocusOut"}),Object.keys(this.graphs).forEach(a=>{this.graphs[a].on("cell:mousedown",this.onDragStart,this)})}stopListening(){this.undelegateEvents(),Object.keys(this.graphs).forEach(e=>{this.graphs[e].off("cell:mousedown",this.onDragStart,this)})}load(e,t){return Array.isArray(e)?this.loadGroup(e,t):this.options.groups&&Object.keys(this.options.groups).forEach(i=>{e[i]&&this.loadGroup(e[i],i)}),this}loadGroup(e,t){const i=this.getModel(t);if(i){const m=e.map(y=>Si.isNode(y)?y:Si.create(y));i.resetCells(m)}const a=this.getGroup(t);let d=this.options.stencilGraphHeight;a&&a.graphHeight!=null&&(d=a.graphHeight);const f=a&&a.layout||this.options.layout;if(f&&i&&Pn(f,this,i,a),!d){const m=this.getGraph(t);m.fitToContent({minWidth:m.options.width,gridHeight:1,padding:a&&a.graphPadding||this.options.stencilGraphPadding||10})}return this}onDragStart(e){const{e:t,node:i}=e;this.dnd.start(i,t)}filter(e,t){const i=Object.keys(this.graphs).reduce((a,d)=>{const f=this.graphs[d],m=d===bp.defaultGroupName?null:d,y=f.model.getNodes().filter(T=>{let R=!1;typeof t=="function"?R=Pn(t,this,T,e,m,this):typeof t=="boolean"?R=t:R=this.isCellMatched(T,e,t,e.toLowerCase()!==e);const V=f.renderer.findViewByCell(T);return V&&V.$(V.container).toggleClass("unmatched",!R),R}),x=y.length>0,E=this.options,S=new $s;return S.resetCells(y),E.layout&&Pn(E.layout,this,S,this.getGroup(d)),this.$groups[d]&&this.$groups[d].toggleClass("unmatched",!x),f.fitToContent({gridWidth:1,gridHeight:1,padding:E.stencilGraphPadding||10}),a||x},!1);this.$container.toggleClass("not-found",!i)}isCellMatched(e,t,i,a){return t&&i?Object.keys(i).some(d=>{if(d==="*"||e.shape===d){const f=i[d];return typeof f=="boolean"?f:(Array.isArray(f)?f:[f]).some(y=>{let x=e.getPropByPath(y);return x!=null?(x=`${x}`,a||(x=x.toLowerCase()),x.indexOf(t)>=0):!1})}return!1}):!0}onSearch(e){this.filter(e.target.value,this.options.search)}onSearchFocusIn(){this.$container.addClass("is-focused")}onSearchFocusOut(){this.$container.removeClass("is-focused")}onTitleClick(){this.options.collapsable&&(this.$container.toggleClass("collapsed"),this.$container.hasClass("collapsed")?this.collapseGroups():this.expandGroups())}onGroupTitleClick(e){const t=this.$(e.target).closest(`.${this.prefixClassName(_a.group)}`);this.toggleGroup(t.attr("data-name")||"");const i=Object.keys(this.$groups).every(a=>{const d=this.getGroup(a),f=this.$groups[a];return d&&d.collapsable===!1||f.hasClass("collapsed")});this.$container.toggleClass("collapsed",i)}getModel(e){const t=this.getGraph(e);return t?t.model:null}getGraph(e){return this.graphs[e||bp.defaultGroupName]}getGroup(e){const t=this.options.groups;return e!=null&&t&&t.length?t.find(i=>i.name===e):null}toggleGroup(e){return this.isGroupCollapsed(e)?this.expandGroup(e):this.collapseGroup(e),this}collapseGroup(e){if(this.isGroupCollapsable(e)){const t=this.$groups[e];t&&!this.isGroupCollapsed(e)&&(this.trigger("group:collapse",{name:e}),t.addClass("collapsed"))}return this}expandGroup(e){if(this.isGroupCollapsable(e)){const t=this.$groups[e];t&&this.isGroupCollapsed(e)&&(this.trigger("group:expand",{name:e}),t.removeClass("collapsed"))}return this}isGroupCollapsable(e){return this.$groups[e].hasClass("collapsable")}isGroupCollapsed(e){const t=this.$groups[e];return t&&t.hasClass("collapsed")}collapseGroups(){return Object.keys(this.$groups).forEach(e=>this.collapseGroup(e)),this}expandGroups(){return Object.keys(this.$groups).forEach(e=>this.expandGroup(e)),this}resizeGroup(e,t){const i=this.graphs[e];return i&&i.resize(t.width,t.height),this}onRemove(){Object.keys(this.graphs).forEach(e=>{this.graphs[e].view.remove(),delete this.graphs[e]}),this.dnd.remove(),this.stopListening(),this.undelegateDocumentEvents()}}(function(c){c.defaultOptions=Object.assign({stencilGraphWidth:200,stencilGraphHeight:800,title:"Stencil",collapsable:!1,placeholder:"Search",notFoundText:"No matches found",layout(e,t){const i={columnWidth:this.options.stencilGraphWidth/2-10,columns:2,rowHeight:80,resizeToFit:!1,dx:10,dy:10};Dy(e,Object.assign(Object.assign(Object.assign({},i),this.options.layoutOptions),t?t.layoutOptions:{}))}},Ru.defaults)})(Bg||(Bg={}));var _a;(function(c){c.base="widget-stencil",c.title=`${c.base}-title`,c.search=`${c.base}-search`,c.searchText=`${c.search}-text`,c.content=`${c.base}-content`,c.group=`${c.base}-group`,c.groupTitle=`${c.group}-title`,c.groupContent=`${c.group}-content`})(_a||(_a={}));var bp;(function(c){c.defaultGroupName="__default__"})(bp||(bp={}));const w0="1.33.1";function rS(){if(Hs.trackable){const c="https://kcart.alipay.com/web/bi.do",e=new Image,t=Object.assign(Object.assign({},Hs.trackInfo),{version:w0,pg:document.URL,r:new Date().getTime(),x6:!0,page_type:"syslog"}),i=encodeURIComponent(JSON.stringify([t]));e.src=`${c}?BIProfile=merge&d=${i}`}}Hs.trackable&&setTimeout(rS,3e3)},508:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.AlphaPicker=void 0;var Z=Object.assign||function(ee){for(var oe=1;oe<arguments.length;oe++){var Ae=arguments[oe];for(var X in Ae)Object.prototype.hasOwnProperty.call(Ae,X)&&(ee[X]=Ae[X])}return ee},H=P(67294),J=Me(H),U=P(79941),pe=Me(U),ke=P(17840),Ce=P(25532),ge=Me(Ce);function Me(ee){return ee&&ee.__esModule?ee:{default:ee}}var Se=$.AlphaPicker=function(oe){var Ae=oe.rgb,X=oe.hsl,le=oe.width,Q=oe.height,ne=oe.onChange,he=oe.direction,Ue=oe.style,ce=oe.renderers,De=oe.pointer,_t=oe.className,N=_t===void 0?"":_t,ze=(0,pe.default)({default:{picker:{position:"relative",width:le,height:Q},alpha:{radius:"2px",style:Ue}}});return J.default.createElement("div",{style:ze.picker,className:"alpha-picker "+N},J.default.createElement(ke.Alpha,Z({},ze.alpha,{rgb:Ae,hsl:X,pointer:De,renderers:ce,onChange:ne,direction:he})))};Se.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:ge.default},$.default=(0,ke.ColorWrap)(Se)},25532:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.AlphaPointer=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.AlphaPointer=function(ge){var Me=ge.direction,Se=(0,U.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:Me==="vertical"});return H.default.createElement("div",{style:Se.picker})};$.default=ke},46835:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Block=void 0;var Z=P(67294),H=X(Z),J=P(45697),U=X(J),pe=P(79941),ke=X(pe),Ce=P(82492),ge=X(Ce),Me=P(27200),Se=X(Me),ee=P(17840),oe=P(68959),Ae=X(oe);function X(Q){return Q&&Q.__esModule?Q:{default:Q}}var le=$.Block=function(ne){var he=ne.onChange,Ue=ne.onSwatchHover,ce=ne.hex,De=ne.colors,_t=ne.width,N=ne.triangle,ze=ne.styles,Ze=ze===void 0?{}:ze,xt=ne.className,Zt=xt===void 0?"":xt,Kn=ce==="transparent",we=function(nn,Dn){Se.default.isValidHex(nn)&&he({hex:nn,source:"hex"},Dn)},Bn=(0,ke.default)((0,ge.default)({default:{card:{width:_t,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:ce,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:Se.default.getContrastingColor(ce),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+ce+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},Ze),{"hide-triangle":N==="hide"});return H.default.createElement("div",{style:Bn.card,className:"block-picker "+Zt},H.default.createElement("div",{style:Bn.triangle}),H.default.createElement("div",{style:Bn.head},Kn&&H.default.createElement(ee.Checkboard,{borderRadius:"6px 6px 0 0"}),H.default.createElement("div",{style:Bn.label},ce)),H.default.createElement("div",{style:Bn.body},H.default.createElement(Ae.default,{colors:De,onClick:we,onSwatchHover:Ue}),H.default.createElement(ee.EditableInput,{style:{input:Bn.input},value:ce,onChange:we})))};le.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),colors:U.default.arrayOf(U.default.string),triangle:U.default.oneOf(["top","hide"]),styles:U.default.object},le.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}},$.default=(0,ee.ColorWrap)(le)},68959:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.BlockSwatches=void 0;var Z=P(67294),H=ge(Z),J=P(79941),U=ge(J),pe=P(35161),ke=ge(pe),Ce=P(17840);function ge(Se){return Se&&Se.__esModule?Se:{default:Se}}var Me=$.BlockSwatches=function(ee){var oe=ee.colors,Ae=ee.onClick,X=ee.onSwatchHover,le=(0,U.default)({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return H.default.createElement("div",{style:le.swatches},(0,ke.default)(oe,function(Q){return H.default.createElement(Ce.Swatch,{key:Q,color:Q,style:le.swatch,onClick:Ae,onHover:X,focusStyle:{boxShadow:"0 0 4px "+Q}})}),H.default.createElement("div",{style:le.clear}))};$.default=Me},17339:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Chrome=void 0;var Z=P(67294),H=Q(Z),J=P(45697),U=Q(J),pe=P(79941),ke=Q(pe),Ce=P(82492),ge=Q(Ce),Me=P(17840),Se=P(4575),ee=Q(Se),oe=P(37634),Ae=Q(oe),X=P(36052),le=Q(X);function Q(he){return he&&he.__esModule?he:{default:he}}var ne=$.Chrome=function(Ue){var ce=Ue.width,De=Ue.onChange,_t=Ue.disableAlpha,N=Ue.rgb,ze=Ue.hsl,Ze=Ue.hsv,xt=Ue.hex,Zt=Ue.renderers,Kn=Ue.styles,we=Kn===void 0?{}:Kn,Bn=Ue.className,Fr=Bn===void 0?"":Bn,nn=(0,ke.default)((0,ge.default)({default:{picker:{width:ce,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+N.r+", "+N.g+", "+N.b+", "+N.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},we),{disableAlpha:_t});return H.default.createElement("div",{style:nn.picker,className:"chrome-picker "+Fr},H.default.createElement("div",{style:nn.saturation},H.default.createElement(Me.Saturation,{style:nn.Saturation,hsl:ze,hsv:Ze,pointer:le.default,onChange:De})),H.default.createElement("div",{style:nn.body},H.default.createElement("div",{style:nn.controls,className:"flexbox-fix"},H.default.createElement("div",{style:nn.color},H.default.createElement("div",{style:nn.swatch},H.default.createElement("div",{style:nn.active}),H.default.createElement(Me.Checkboard,{renderers:Zt}))),H.default.createElement("div",{style:nn.toggles},H.default.createElement("div",{style:nn.hue},H.default.createElement(Me.Hue,{style:nn.Hue,hsl:ze,pointer:Ae.default,onChange:De})),H.default.createElement("div",{style:nn.alpha},H.default.createElement(Me.Alpha,{style:nn.Alpha,rgb:N,hsl:ze,pointer:Ae.default,renderers:Zt,onChange:De})))),H.default.createElement(ee.default,{rgb:N,hsl:ze,hex:xt,onChange:De,disableAlpha:_t})))};ne.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),disableAlpha:U.default.bool,styles:U.default.object},ne.defaultProps={width:225,disableAlpha:!1,styles:{}},$.default=(0,Me.ColorWrap)(ne)},4575:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.ChromeFields=void 0;var Z=function(){function Q(ne,he){for(var Ue=0;Ue<he.length;Ue++){var ce=he[Ue];ce.enumerable=ce.enumerable||!1,ce.configurable=!0,"value"in ce&&(ce.writable=!0),Object.defineProperty(ne,ce.key,ce)}}return function(ne,he,Ue){return he&&Q(ne.prototype,he),Ue&&Q(ne,Ue),ne}}(),H=P(67294),J=ee(H),U=P(79941),pe=ee(U),ke=P(27200),Ce=ee(ke),ge=P(17840),Me=P(43891),Se=ee(Me);function ee(Q){return Q&&Q.__esModule?Q:{default:Q}}function oe(Q,ne){if(!(Q instanceof ne))throw new TypeError("Cannot call a class as a function")}function Ae(Q,ne){if(!Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne&&(typeof ne=="object"||typeof ne=="function")?ne:Q}function X(Q,ne){if(typeof ne!="function"&&ne!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ne);Q.prototype=Object.create(ne&&ne.prototype,{constructor:{value:Q,enumerable:!1,writable:!0,configurable:!0}}),ne&&(Object.setPrototypeOf?Object.setPrototypeOf(Q,ne):Q.__proto__=ne)}var le=$.ChromeFields=function(Q){X(ne,Q);function ne(){var he,Ue,ce,De;oe(this,ne);for(var _t=arguments.length,N=Array(_t),ze=0;ze<_t;ze++)N[ze]=arguments[ze];return De=(Ue=(ce=Ae(this,(he=ne.__proto__||Object.getPrototypeOf(ne)).call.apply(he,[this].concat(N))),ce),ce.state={view:""},ce.toggleViews=function(){ce.state.view==="hex"?ce.setState({view:"rgb"}):ce.state.view==="rgb"?ce.setState({view:"hsl"}):ce.state.view==="hsl"&&(ce.props.hsl.a===1?ce.setState({view:"hex"}):ce.setState({view:"rgb"}))},ce.handleChange=function(Ze,xt){Ze.hex?Ce.default.isValidHex(Ze.hex)&&ce.props.onChange({hex:Ze.hex,source:"hex"},xt):Ze.r||Ze.g||Ze.b?ce.props.onChange({r:Ze.r||ce.props.rgb.r,g:Ze.g||ce.props.rgb.g,b:Ze.b||ce.props.rgb.b,source:"rgb"},xt):Ze.a?(Ze.a<0?Ze.a=0:Ze.a>1&&(Ze.a=1),ce.props.onChange({h:ce.props.hsl.h,s:ce.props.hsl.s,l:ce.props.hsl.l,a:Math.round(Ze.a*100)/100,source:"rgb"},xt)):(Ze.h||Ze.s||Ze.l)&&(typeof Ze.s=="string"&&Ze.s.includes("%")&&(Ze.s=Ze.s.replace("%","")),typeof Ze.l=="string"&&Ze.l.includes("%")&&(Ze.l=Ze.l.replace("%","")),ce.props.onChange({h:Ze.h||ce.props.hsl.h,s:Number(Ze.s&&Ze.s||ce.props.hsl.s),l:Number(Ze.l&&Ze.l||ce.props.hsl.l),source:"hsl"},xt))},ce.showHighlight=function(Ze){Ze.currentTarget.style.background="#eee"},ce.hideHighlight=function(Ze){Ze.currentTarget.style.background="transparent"},Ue),Ae(ce,De)}return Z(ne,[{key:"componentDidMount",value:function(){this.props.hsl.a===1&&this.state.view!=="hex"?this.setState({view:"hex"}):this.state.view!=="rgb"&&this.state.view!=="hsl"&&this.setState({view:"rgb"})}},{key:"componentWillReceiveProps",value:function(Ue){Ue.hsl.a!==1&&this.state.view==="hex"&&this.setState({view:"rgb"})}},{key:"render",value:function(){var Ue=this,ce=(0,pe.default)({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),De=void 0;return this.state.view==="hex"?De=J.default.createElement("div",{style:ce.fields,className:"flexbox-fix"},J.default.createElement("div",{style:ce.field},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?De=J.default.createElement("div",{style:ce.fields,className:"flexbox-fix"},J.default.createElement("div",{style:ce.field},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),J.default.createElement("div",{style:ce.field},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),J.default.createElement("div",{style:ce.field},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),J.default.createElement("div",{style:ce.alpha},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(De=J.default.createElement("div",{style:ce.fields,className:"flexbox-fix"},J.default.createElement("div",{style:ce.field},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),J.default.createElement("div",{style:ce.field},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),J.default.createElement("div",{style:ce.field},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),J.default.createElement("div",{style:ce.alpha},J.default.createElement(ge.EditableInput,{style:{input:ce.input,label:ce.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),J.default.createElement("div",{style:ce.wrap,className:"flexbox-fix"},De,J.default.createElement("div",{style:ce.toggle},J.default.createElement("div",{style:ce.icon,onClick:this.toggleViews,ref:function(N){return Ue.icon=N}},J.default.createElement(Se.default,{style:ce.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}]),ne}(J.default.Component);$.default=le},37634:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.ChromePointer=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.ChromePointer=function(){var ge=(0,U.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return H.default.createElement("div",{style:ge.picker})};$.default=ke},36052:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.ChromePointerCircle=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.ChromePointerCircle=function(){var ge=(0,U.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return H.default.createElement("div",{style:ge.picker})};$.default=ke},93545:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Circle=void 0;var Z=P(67294),H=ne(Z),J=P(45697),U=ne(J),pe=P(79941),ke=ne(pe),Ce=P(35161),ge=ne(Ce),Me=P(82492),Se=ne(Me),ee=P(53893),oe=Q(ee),Ae=P(17840),X=P(136),le=ne(X);function Q(Ue){if(Ue&&Ue.__esModule)return Ue;var ce={};if(Ue!=null)for(var De in Ue)Object.prototype.hasOwnProperty.call(Ue,De)&&(ce[De]=Ue[De]);return ce.default=Ue,ce}function ne(Ue){return Ue&&Ue.__esModule?Ue:{default:Ue}}var he=$.Circle=function(ce){var De=ce.width,_t=ce.onChange,N=ce.onSwatchHover,ze=ce.colors,Ze=ce.hex,xt=ce.circleSize,Zt=ce.styles,Kn=Zt===void 0?{}:Zt,we=ce.circleSpacing,Bn=ce.className,Fr=Bn===void 0?"":Bn,nn=(0,ke.default)((0,Se.default)({default:{card:{width:De,display:"flex",flexWrap:"wrap",marginRight:-we,marginBottom:-we}}},Kn)),Dn=function(Rt,Sr){return _t({hex:Rt,source:"hex"},Sr)};return H.default.createElement("div",{style:nn.card,className:"circle-picker "+Fr},(0,ge.default)(ze,function(yn){return H.default.createElement(le.default,{key:yn,color:yn,onClick:Dn,onSwatchHover:N,active:Ze===yn.toLowerCase(),circleSize:xt,circleSpacing:we})}))};he.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),circleSize:U.default.number,circleSpacing:U.default.number,styles:U.default.object},he.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[oe.red[500],oe.pink[500],oe.purple[500],oe.deepPurple[500],oe.indigo[500],oe.blue[500],oe.lightBlue[500],oe.cyan[500],oe.teal[500],oe.green[500],oe.lightGreen[500],oe.lime[500],oe.yellow[500],oe.amber[500],oe.orange[500],oe.deepOrange[500],oe.brown[500],oe.blueGrey[500]],styles:{}},$.default=(0,Ae.ColorWrap)(he)},136:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.CircleSwatch=void 0;var Z=P(67294),H=ke(Z),J=P(79941),U=ke(J),pe=P(17840);function ke(ge){return ge&&ge.__esModule?ge:{default:ge}}var Ce=$.CircleSwatch=function(Me){var Se=Me.color,ee=Me.onClick,oe=Me.onSwatchHover,Ae=Me.hover,X=Me.active,le=Me.circleSize,Q=Me.circleSpacing,ne=(0,U.default)({default:{swatch:{width:le,height:le,marginRight:Q,marginBottom:Q,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+le/2+"px "+Se,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+Se}}},{hover:Ae,active:X});return H.default.createElement("div",{style:ne.swatch},H.default.createElement(pe.Swatch,{style:ne.Swatch,color:Se,onClick:ee,onHover:oe,focusStyle:{boxShadow:ne.Swatch.boxShadow+", 0 0 5px "+Se}}))};Ce.defaultProps={circleSize:28,circleSpacing:14},$.default=(0,J.handleHover)(Ce)},38785:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Alpha=void 0;var Z=Object.assign||function(ne){for(var he=1;he<arguments.length;he++){var Ue=arguments[he];for(var ce in Ue)Object.prototype.hasOwnProperty.call(Ue,ce)&&(ne[ce]=Ue[ce])}return ne},H=function(){function ne(he,Ue){for(var ce=0;ce<Ue.length;ce++){var De=Ue[ce];De.enumerable=De.enumerable||!1,De.configurable=!0,"value"in De&&(De.writable=!0),Object.defineProperty(he,De.key,De)}}return function(he,Ue,ce){return Ue&&ne(he.prototype,Ue),ce&&ne(he,ce),he}}(),J=P(67294),U=oe(J),pe=P(79941),ke=oe(pe),Ce=P(78321),ge=ee(Ce),Me=P(39763),Se=oe(Me);function ee(ne){if(ne&&ne.__esModule)return ne;var he={};if(ne!=null)for(var Ue in ne)Object.prototype.hasOwnProperty.call(ne,Ue)&&(he[Ue]=ne[Ue]);return he.default=ne,he}function oe(ne){return ne&&ne.__esModule?ne:{default:ne}}function Ae(ne,he){if(!(ne instanceof he))throw new TypeError("Cannot call a class as a function")}function X(ne,he){if(!ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return he&&(typeof he=="object"||typeof he=="function")?he:ne}function le(ne,he){if(typeof he!="function"&&he!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof he);ne.prototype=Object.create(he&&he.prototype,{constructor:{value:ne,enumerable:!1,writable:!0,configurable:!0}}),he&&(Object.setPrototypeOf?Object.setPrototypeOf(ne,he):ne.__proto__=he)}var Q=$.Alpha=function(ne){le(he,ne);function he(){var Ue,ce,De,_t;Ae(this,he);for(var N=arguments.length,ze=Array(N),Ze=0;Ze<N;Ze++)ze[Ze]=arguments[Ze];return _t=(ce=(De=X(this,(Ue=he.__proto__||Object.getPrototypeOf(he)).call.apply(Ue,[this].concat(ze))),De),De.handleChange=function(xt){var Zt=ge.calculateChange(xt,De.props.hsl,De.props.direction,De.props.a,De.container);Zt&&typeof De.props.onChange=="function"&&De.props.onChange(Zt,xt)},De.handleMouseDown=function(xt){De.handleChange(xt),window.addEventListener("mousemove",De.handleChange),window.addEventListener("mouseup",De.handleMouseUp)},De.handleMouseUp=function(){De.unbindEventListeners()},De.unbindEventListeners=function(){window.removeEventListener("mousemove",De.handleChange),window.removeEventListener("mouseup",De.handleMouseUp)},ce),X(De,_t)}return H(he,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var ce=this,De=this.props.rgb,_t=(0,ke.default)({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+De.r+","+De.g+","+De.b+`, 0) 0%,
           rgba(`+De.r+","+De.g+","+De.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:De.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+De.r+","+De.g+","+De.b+`, 0) 0%,
           rgba(`+De.r+","+De.g+","+De.b+", 1) 100%)"},pointer:{left:0,top:De.a*100+"%"}},overwrite:Z({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return U.default.createElement("div",{style:_t.alpha},U.default.createElement("div",{style:_t.checkboard},U.default.createElement(Se.default,{renderers:this.props.renderers})),U.default.createElement("div",{style:_t.gradient}),U.default.createElement("div",{style:_t.container,ref:function(ze){return ce.container=ze},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},U.default.createElement("div",{style:_t.pointer},this.props.pointer?U.default.createElement(this.props.pointer,this.props):U.default.createElement("div",{style:_t.slider}))))}}]),he}(J.PureComponent||J.Component);$.default=Q},39763:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Checkboard=void 0;var Z=P(67294),H=ge(Z),J=P(79941),U=ge(J),pe=P(69433),ke=Ce(pe);function Ce(Se){if(Se&&Se.__esModule)return Se;var ee={};if(Se!=null)for(var oe in Se)Object.prototype.hasOwnProperty.call(Se,oe)&&(ee[oe]=Se[oe]);return ee.default=Se,ee}function ge(Se){return Se&&Se.__esModule?Se:{default:Se}}var Me=$.Checkboard=function(ee){var oe=ee.white,Ae=ee.grey,X=ee.size,le=ee.renderers,Q=ee.borderRadius,ne=ee.boxShadow,he=(0,U.default)({default:{grid:{borderRadius:Q,boxShadow:ne,absolute:"0px 0px 0px 0px",background:"url("+ke.get(oe,Ae,X,le.canvas)+") center left"}}});return H.default.createElement("div",{style:he.grid})};Me.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}},$.default=Me},88238:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.ColorWrap=void 0;var Z=Object.assign||function(X){for(var le=1;le<arguments.length;le++){var Q=arguments[le];for(var ne in Q)Object.prototype.hasOwnProperty.call(Q,ne)&&(X[ne]=Q[ne])}return X},H=function(){function X(le,Q){for(var ne=0;ne<Q.length;ne++){var he=Q[ne];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(le,he.key,he)}}return function(le,Q,ne){return Q&&X(le.prototype,Q),ne&&X(le,ne),le}}(),J=P(67294),U=Me(J),pe=P(23279),ke=Me(pe),Ce=P(27200),ge=Me(Ce);function Me(X){return X&&X.__esModule?X:{default:X}}function Se(X,le){if(!(X instanceof le))throw new TypeError("Cannot call a class as a function")}function ee(X,le){if(!X)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return le&&(typeof le=="object"||typeof le=="function")?le:X}function oe(X,le){if(typeof le!="function"&&le!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof le);X.prototype=Object.create(le&&le.prototype,{constructor:{value:X,enumerable:!1,writable:!0,configurable:!0}}),le&&(Object.setPrototypeOf?Object.setPrototypeOf(X,le):X.__proto__=le)}var Ae=$.ColorWrap=function(le){var Q=function(ne){oe(he,ne);function he(Ue){Se(this,he);var ce=ee(this,(he.__proto__||Object.getPrototypeOf(he)).call(this));return ce.handleChange=function(De,_t){var N=ge.default.simpleCheckForValidColor(De);if(N){var ze=ge.default.toState(De,De.h||ce.state.oldHue);ce.setState(ze),ce.props.onChangeComplete&&ce.debounce(ce.props.onChangeComplete,ze,_t),ce.props.onChange&&ce.props.onChange(ze,_t)}},ce.handleSwatchHover=function(De,_t){var N=ge.default.simpleCheckForValidColor(De);if(N){var ze=ge.default.toState(De,De.h||ce.state.oldHue);ce.setState(ze),ce.props.onSwatchHover&&ce.props.onSwatchHover(ze,_t)}},ce.state=Z({},ge.default.toState(Ue.color,0)),ce.debounce=(0,ke.default)(function(De,_t,N){De(_t,N)},100),ce}return H(he,[{key:"componentWillReceiveProps",value:function(ce){this.setState(Z({},ge.default.toState(ce.color,this.state.oldHue)))}},{key:"render",value:function(){var ce={};return this.props.onSwatchHover&&(ce.onSwatchHover=this.handleSwatchHover),U.default.createElement(le,Z({},this.props,this.state,{onChange:this.handleChange},ce))}}]),he}(J.PureComponent||J.Component);return Q.propTypes=Z({},le.propTypes),Q.defaultProps=Z({},le.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),Q};$.default=Ae},55326:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.EditableInput=void 0;var Z=function(){function ce(De,_t){for(var N=0;N<_t.length;N++){var ze=_t[N];ze.enumerable=ze.enumerable||!1,ze.configurable=!0,"value"in ze&&(ze.writable=!0),Object.defineProperty(De,ze.key,ze)}}return function(De,_t,N){return _t&&ce(De.prototype,_t),N&&ce(De,N),De}}(),H=P(67294),J=ke(H),U=P(79941),pe=ke(U);function ke(ce){return ce&&ce.__esModule?ce:{default:ce}}function Ce(ce,De,_t){return De in ce?Object.defineProperty(ce,De,{value:_t,enumerable:!0,configurable:!0,writable:!0}):ce[De]=_t,ce}function ge(ce,De){if(!(ce instanceof De))throw new TypeError("Cannot call a class as a function")}function Me(ce,De){if(!ce)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return De&&(typeof De=="object"||typeof De=="function")?De:ce}function Se(ce,De){if(typeof De!="function"&&De!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof De);ce.prototype=Object.create(De&&De.prototype,{constructor:{value:ce,enumerable:!1,writable:!0,configurable:!0}}),De&&(Object.setPrototypeOf?Object.setPrototypeOf(ce,De):ce.__proto__=De)}var ee=1,oe=38,Ae=40,X=[oe,Ae],le=function(De){return X.indexOf(De)>-1},Q=function(De){return De+"%"},ne=function(De){return Number(String(De).replace(/%/g,""))},he=function(De){return String(De).indexOf("%")>-1},Ue=$.EditableInput=function(ce){Se(De,ce);function De(_t){ge(this,De);var N=Me(this,(De.__proto__||Object.getPrototypeOf(De)).call(this));return N.handleBlur=function(){N.state.blurValue&&N.setState({value:N.state.blurValue,blurValue:null})},N.handleChange=function(ze){N.setUpdatedValue(ze.target.value,ze)},N.handleKeyDown=function(ze){var Ze=ne(ze.target.value);if(!isNaN(Ze)&&le(ze.keyCode)){var xt=N.getArrowOffset(),Zt=ze.keyCode===oe?Ze+xt:Ze-xt;N.setUpdatedValue(Zt,ze)}},N.handleDrag=function(ze){if(N.props.dragLabel){var Ze=Math.round(N.props.value+ze.movementX);Ze>=0&&Ze<=N.props.dragMax&&N.props.onChange&&N.props.onChange(N.getValueObjectWithLabel(Ze),ze)}},N.handleMouseDown=function(ze){N.props.dragLabel&&(ze.preventDefault(),N.handleDrag(ze),window.addEventListener("mousemove",N.handleDrag),window.addEventListener("mouseup",N.handleMouseUp))},N.handleMouseUp=function(){N.unbindEventListeners()},N.unbindEventListeners=function(){window.removeEventListener("mousemove",N.handleDrag),window.removeEventListener("mouseup",N.handleMouseUp)},N.state={value:String(_t.value).toUpperCase(),blurValue:String(_t.value).toUpperCase()},N}return Z(De,[{key:"componentWillReceiveProps",value:function(N){var ze=this.input;N.value!==this.state.value&&(ze===document.activeElement?this.setState({blurValue:String(N.value).toUpperCase()}):this.setState({value:String(N.value).toUpperCase(),blurValue:!this.state.blurValue&&String(N.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(N){return Ce({},this.props.label,N)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||ee}},{key:"setUpdatedValue",value:function(N,ze){var Ze=this.props.label!==null?this.getValueObjectWithLabel(N):N;this.props.onChange&&this.props.onChange(Ze,ze);var xt=he(ze.target.value);this.setState({value:xt?Q(N):N})}},{key:"render",value:function(){var N=this,ze=(0,pe.default)({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return J.default.createElement("div",{style:ze.wrap},J.default.createElement("input",{style:ze.input,ref:function(xt){return N.input=xt},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?J.default.createElement("span",{style:ze.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),De}(H.PureComponent||H.Component);$.default=Ue},36159:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Hue=void 0;var Z=function(){function X(le,Q){for(var ne=0;ne<Q.length;ne++){var he=Q[ne];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(le,he.key,he)}}return function(le,Q,ne){return Q&&X(le.prototype,Q),ne&&X(le,ne),le}}(),H=P(67294),J=Me(H),U=P(79941),pe=Me(U),ke=P(19800),Ce=ge(ke);function ge(X){if(X&&X.__esModule)return X;var le={};if(X!=null)for(var Q in X)Object.prototype.hasOwnProperty.call(X,Q)&&(le[Q]=X[Q]);return le.default=X,le}function Me(X){return X&&X.__esModule?X:{default:X}}function Se(X,le){if(!(X instanceof le))throw new TypeError("Cannot call a class as a function")}function ee(X,le){if(!X)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return le&&(typeof le=="object"||typeof le=="function")?le:X}function oe(X,le){if(typeof le!="function"&&le!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof le);X.prototype=Object.create(le&&le.prototype,{constructor:{value:X,enumerable:!1,writable:!0,configurable:!0}}),le&&(Object.setPrototypeOf?Object.setPrototypeOf(X,le):X.__proto__=le)}var Ae=$.Hue=function(X){oe(le,X);function le(){var Q,ne,he,Ue;Se(this,le);for(var ce=arguments.length,De=Array(ce),_t=0;_t<ce;_t++)De[_t]=arguments[_t];return Ue=(ne=(he=ee(this,(Q=le.__proto__||Object.getPrototypeOf(le)).call.apply(Q,[this].concat(De))),he),he.handleChange=function(N){var ze=Ce.calculateChange(N,he.props.direction,he.props.hsl,he.container);ze&&typeof he.props.onChange=="function"&&he.props.onChange(ze,N)},he.handleMouseDown=function(N){he.handleChange(N),window.addEventListener("mousemove",he.handleChange),window.addEventListener("mouseup",he.handleMouseUp)},he.handleMouseUp=function(){he.unbindEventListeners()},ne),ee(he,Ue)}return Z(le,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var ne=this,he=this.props.direction,Ue=he===void 0?"horizontal":he,ce=(0,pe.default)({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:Ue==="vertical"});return J.default.createElement("div",{style:ce.hue},J.default.createElement("div",{className:"hue-"+Ue,style:ce.container,ref:function(_t){return ne.container=_t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},J.default.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),J.default.createElement("div",{style:ce.pointer},this.props.pointer?J.default.createElement(this.props.pointer,this.props):J.default.createElement("div",{style:ce.slider}))))}}]),le}(H.PureComponent||H.Component);$.default=Ae},65117:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Raised=void 0;var Z=P(67294),H=Me(Z),J=P(45697),U=Me(J),pe=P(79941),ke=Me(pe),Ce=P(82492),ge=Me(Ce);function Me(ee){return ee&&ee.__esModule?ee:{default:ee}}var Se=$.Raised=function(oe){var Ae=oe.zDepth,X=oe.radius,le=oe.background,Q=oe.children,ne=oe.styles,he=ne===void 0?{}:ne,Ue=(0,ke.default)((0,ge.default)({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+Ae+"px "+Ae*4+"px rgba(0,0,0,.24)",borderRadius:X,background:le}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},he),{"zDepth-1":Ae===1});return H.default.createElement("div",{style:Ue.wrap},H.default.createElement("div",{style:Ue.bg}),H.default.createElement("div",{style:Ue.content},Q))};Se.propTypes={background:U.default.string,zDepth:U.default.oneOf([0,1,2,3,4,5]),radius:U.default.number,styles:U.default.object},Se.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}},$.default=Se},51849:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Saturation=void 0;var Z=function(){function Q(ne,he){for(var Ue=0;Ue<he.length;Ue++){var ce=he[Ue];ce.enumerable=ce.enumerable||!1,ce.configurable=!0,"value"in ce&&(ce.writable=!0),Object.defineProperty(ne,ce.key,ce)}}return function(ne,he,Ue){return he&&Q(ne.prototype,he),Ue&&Q(ne,Ue),ne}}(),H=P(67294),J=ee(H),U=P(79941),pe=ee(U),ke=P(23493),Ce=ee(ke),ge=P(19723),Me=Se(ge);function Se(Q){if(Q&&Q.__esModule)return Q;var ne={};if(Q!=null)for(var he in Q)Object.prototype.hasOwnProperty.call(Q,he)&&(ne[he]=Q[he]);return ne.default=Q,ne}function ee(Q){return Q&&Q.__esModule?Q:{default:Q}}function oe(Q,ne){if(!(Q instanceof ne))throw new TypeError("Cannot call a class as a function")}function Ae(Q,ne){if(!Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne&&(typeof ne=="object"||typeof ne=="function")?ne:Q}function X(Q,ne){if(typeof ne!="function"&&ne!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ne);Q.prototype=Object.create(ne&&ne.prototype,{constructor:{value:Q,enumerable:!1,writable:!0,configurable:!0}}),ne&&(Object.setPrototypeOf?Object.setPrototypeOf(Q,ne):Q.__proto__=ne)}var le=$.Saturation=function(Q){X(ne,Q);function ne(he){oe(this,ne);var Ue=Ae(this,(ne.__proto__||Object.getPrototypeOf(ne)).call(this,he));return Ue.handleChange=function(ce){typeof Ue.props.onChange=="function"&&Ue.throttle(Ue.props.onChange,Me.calculateChange(ce,Ue.props.hsl,Ue.container),ce)},Ue.handleMouseDown=function(ce){Ue.handleChange(ce),window.addEventListener("mousemove",Ue.handleChange),window.addEventListener("mouseup",Ue.handleMouseUp)},Ue.handleMouseUp=function(){Ue.unbindEventListeners()},Ue.throttle=(0,Ce.default)(function(ce,De,_t){ce(De,_t)},50),Ue}return Z(ne,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var Ue=this,ce=this.props.style||{},De=ce.color,_t=ce.white,N=ce.black,ze=ce.pointer,Ze=ce.circle,xt=(0,pe.default)({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:De,white:_t,black:N,pointer:ze,circle:Ze}},{custom:!!this.props.style});return J.default.createElement("div",{style:xt.color,ref:function(Kn){return Ue.container=Kn},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},J.default.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),J.default.createElement("div",{style:xt.white,className:"saturation-white"},J.default.createElement("div",{style:xt.black,className:"saturation-black"}),J.default.createElement("div",{style:xt.pointer},this.props.pointer?J.default.createElement(this.props.pointer,this.props):J.default.createElement("div",{style:xt.circle}))))}}]),ne}(H.PureComponent||H.Component);$.default=le},50789:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Swatch=void 0;var Z=Object.assign||function(oe){for(var Ae=1;Ae<arguments.length;Ae++){var X=arguments[Ae];for(var le in X)Object.prototype.hasOwnProperty.call(X,le)&&(oe[le]=X[le])}return oe},H=P(67294),J=Me(H),U=P(79941),pe=Me(U),ke=P(28592),Ce=P(39763),ge=Me(Ce);function Me(oe){return oe&&oe.__esModule?oe:{default:oe}}var Se=13,ee=$.Swatch=function(Ae){var X=Ae.color,le=Ae.style,Q=Ae.onClick,ne=Q===void 0?function(){}:Q,he=Ae.onHover,Ue=Ae.title,ce=Ue===void 0?X:Ue,De=Ae.children,_t=Ae.focus,N=Ae.focusStyle,ze=N===void 0?{}:N,Ze=X==="transparent",xt=(0,pe.default)({default:{swatch:Z({background:X,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},le,_t?ze:{})}}),Zt=function(nn){return ne(X,nn)},Kn=function(nn){return nn.keyCode===Se&&ne(X,nn)},we=function(nn){return he(X,nn)},Bn={};return he&&(Bn.onMouseOver=we),J.default.createElement("div",Z({style:xt.swatch,onClick:Zt,title:ce,tabIndex:0,onKeyDown:Kn},Bn),De,Ze&&J.default.createElement(ge.default,{borderRadius:xt.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};$.default=(0,ke.handleFocus)(ee)},17840:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0});var Z=P(38785);Object.defineProperty($,"Alpha",{enumerable:!0,get:function(){return Me(Z).default}});var H=P(39763);Object.defineProperty($,"Checkboard",{enumerable:!0,get:function(){return Me(H).default}});var J=P(55326);Object.defineProperty($,"EditableInput",{enumerable:!0,get:function(){return Me(J).default}});var U=P(36159);Object.defineProperty($,"Hue",{enumerable:!0,get:function(){return Me(U).default}});var pe=P(65117);Object.defineProperty($,"Raised",{enumerable:!0,get:function(){return Me(pe).default}});var ke=P(51849);Object.defineProperty($,"Saturation",{enumerable:!0,get:function(){return Me(ke).default}});var Ce=P(88238);Object.defineProperty($,"ColorWrap",{enumerable:!0,get:function(){return Me(Ce).default}});var ge=P(50789);Object.defineProperty($,"Swatch",{enumerable:!0,get:function(){return Me(ge).default}});function Me(Se){return Se&&Se.__esModule?Se:{default:Se}}},63205:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Compact=void 0;var Z=P(67294),H=he(Z),J=P(45697),U=he(J),pe=P(79941),ke=he(pe),Ce=P(35161),ge=he(Ce),Me=P(82492),Se=he(Me),ee=P(27200),oe=he(ee),Ae=P(17840),X=P(97354),le=he(X),Q=P(27054),ne=he(Q);function he(ce){return ce&&ce.__esModule?ce:{default:ce}}var Ue=$.Compact=function(De){var _t=De.onChange,N=De.onSwatchHover,ze=De.colors,Ze=De.hex,xt=De.rgb,Zt=De.styles,Kn=Zt===void 0?{}:Zt,we=De.className,Bn=we===void 0?"":we,Fr=(0,ke.default)((0,Se.default)({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},Kn)),nn=function(yn,Rt){yn.hex?oe.default.isValidHex(yn.hex)&&_t({hex:yn.hex,source:"hex"},Rt):_t(yn,Rt)};return H.default.createElement(Ae.Raised,{style:Fr.Compact,styles:Kn},H.default.createElement("div",{style:Fr.compact,className:"compact-picker "+Bn},H.default.createElement("div",null,(0,ge.default)(ze,function(Dn){return H.default.createElement(le.default,{key:Dn,color:Dn,active:Dn.toLowerCase()===Ze,onClick:nn,onSwatchHover:N})}),H.default.createElement("div",{style:Fr.clear})),H.default.createElement(ne.default,{hex:Ze,rgb:xt,onChange:nn})))};Ue.propTypes={colors:U.default.arrayOf(U.default.string),styles:U.default.object},Ue.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}},$.default=(0,Ae.ColorWrap)(Ue)},97354:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.CompactColor=void 0;var Z=P(67294),H=ge(Z),J=P(79941),U=ge(J),pe=P(27200),ke=ge(pe),Ce=P(17840);function ge(Se){return Se&&Se.__esModule?Se:{default:Se}}var Me=$.CompactColor=function(ee){var oe=ee.color,Ae=ee.onClick,X=Ae===void 0?function(){}:Ae,le=ee.onSwatchHover,Q=ee.active,ne=(0,U.default)({default:{color:{background:oe,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:ke.default.getContrastingColor(oe),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:Q,"color-#FFFFFF":oe==="#FFFFFF",transparent:oe==="transparent"});return H.default.createElement(Ce.Swatch,{style:ne.color,color:oe,onClick:X,onHover:le,focusStyle:{boxShadow:"0 0 4px "+oe}},H.default.createElement("div",{style:ne.dot}))};$.default=Me},27054:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.CompactFields=void 0;var Z=P(67294),H=ke(Z),J=P(79941),U=ke(J),pe=P(17840);function ke(ge){return ge&&ge.__esModule?ge:{default:ge}}var Ce=$.CompactFields=function(Me){var Se=Me.hex,ee=Me.rgb,oe=Me.onChange,Ae=(0,U.default)({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:Se},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),X=function(Q,ne){Q.r||Q.g||Q.b?oe({r:Q.r||ee.r,g:Q.g||ee.g,b:Q.b||ee.b,source:"rgb"},ne):oe({hex:Q.hex,source:"hex"},ne)};return H.default.createElement("div",{style:Ae.fields,className:"flexbox-fix"},H.default.createElement("div",{style:Ae.active}),H.default.createElement(pe.EditableInput,{style:{wrap:Ae.HEXwrap,input:Ae.HEXinput,label:Ae.HEXlabel},label:"hex",value:Se,onChange:X}),H.default.createElement(pe.EditableInput,{style:{wrap:Ae.RGBwrap,input:Ae.RGBinput,label:Ae.RGBlabel},label:"r",value:ee.r,onChange:X}),H.default.createElement(pe.EditableInput,{style:{wrap:Ae.RGBwrap,input:Ae.RGBinput,label:Ae.RGBlabel},label:"g",value:ee.g,onChange:X}),H.default.createElement(pe.EditableInput,{style:{wrap:Ae.RGBwrap,input:Ae.RGBinput,label:Ae.RGBlabel},label:"b",value:ee.b,onChange:X}))};$.default=Ce},21109:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Github=void 0;var Z=P(67294),H=X(Z),J=P(45697),U=X(J),pe=P(79941),ke=X(pe),Ce=P(35161),ge=X(Ce),Me=P(82492),Se=X(Me),ee=P(17840),oe=P(8745),Ae=X(oe);function X(Q){return Q&&Q.__esModule?Q:{default:Q}}var le=$.Github=function(ne){var he=ne.width,Ue=ne.colors,ce=ne.onChange,De=ne.onSwatchHover,_t=ne.triangle,N=ne.styles,ze=N===void 0?{}:N,Ze=ne.className,xt=Ze===void 0?"":Ze,Zt=(0,ke.default)((0,Se.default)({default:{card:{width:he,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},ze),{"hide-triangle":_t==="hide","top-left-triangle":_t==="top-left","top-right-triangle":_t==="top-right","bottom-left-triangle":_t==="bottom-left","bottom-right-triangle":_t==="bottom-right"}),Kn=function(Bn,Fr){return ce({hex:Bn,source:"hex"},Fr)};return H.default.createElement("div",{style:Zt.card,className:"github-picker "+xt},H.default.createElement("div",{style:Zt.triangleShadow}),H.default.createElement("div",{style:Zt.triangle}),(0,ge.default)(Ue,function(we){return H.default.createElement(Ae.default,{color:we,key:we,onClick:Kn,onSwatchHover:De})}))};le.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),colors:U.default.arrayOf(U.default.string),triangle:U.default.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:U.default.object},le.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}},$.default=(0,ee.ColorWrap)(le)},8745:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.GithubSwatch=void 0;var Z=P(67294),H=ke(Z),J=P(79941),U=ke(J),pe=P(17840);function ke(ge){return ge&&ge.__esModule?ge:{default:ge}}var Ce=$.GithubSwatch=function(Me){var Se=Me.hover,ee=Me.color,oe=Me.onClick,Ae=Me.onSwatchHover,X={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},le=(0,U.default)({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:X}},{hover:Se});return H.default.createElement("div",{style:le.swatch},H.default.createElement(pe.Swatch,{color:ee,onClick:oe,onHover:Ae,focusStyle:X}))};$.default=(0,J.handleHover)(Ce)},31270:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.HuePicker=void 0;var Z=Object.assign||function(le){for(var Q=1;Q<arguments.length;Q++){var ne=arguments[Q];for(var he in ne)Object.prototype.hasOwnProperty.call(ne,he)&&(le[he]=ne[he])}return le},H=P(67294),J=Ae(H),U=P(45697),pe=Ae(U),ke=P(79941),Ce=Ae(ke),ge=P(82492),Me=Ae(ge),Se=P(17840),ee=P(98481),oe=Ae(ee);function Ae(le){return le&&le.__esModule?le:{default:le}}var X=$.HuePicker=function(Q){var ne=Q.width,he=Q.height,Ue=Q.onChange,ce=Q.hsl,De=Q.direction,_t=Q.pointer,N=Q.styles,ze=N===void 0?{}:N,Ze=Q.className,xt=Ze===void 0?"":Ze,Zt=(0,Ce.default)((0,Me.default)({default:{picker:{position:"relative",width:ne,height:he},hue:{radius:"2px"}}},ze)),Kn=function(Bn){return Ue({a:1,h:Bn.h,l:.5,s:1})};return J.default.createElement("div",{style:Zt.picker,className:"hue-picker "+xt},J.default.createElement(Se.Hue,Z({},Zt.hue,{hsl:ce,pointer:_t,onChange:Kn,direction:De})))};X.propTypes={styles:pe.default.object},X.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:oe.default,styles:{}},$.default=(0,Se.ColorWrap)(X)},98481:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.SliderPointer=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.SliderPointer=function(ge){var Me=ge.direction,Se=(0,U.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:Me==="vertical"});return H.default.createElement("div",{style:Se.picker})};$.default=ke},21172:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Material=void 0;var Z=P(67294),H=Se(Z),J=P(79941),U=Se(J),pe=P(82492),ke=Se(pe),Ce=P(27200),ge=Se(Ce),Me=P(17840);function Se(oe){return oe&&oe.__esModule?oe:{default:oe}}var ee=$.Material=function(Ae){var X=Ae.onChange,le=Ae.hex,Q=Ae.rgb,ne=Ae.styles,he=ne===void 0?{}:ne,Ue=Ae.className,ce=Ue===void 0?"":Ue,De=(0,U.default)((0,ke.default)({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+le,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},he)),_t=function(ze,Ze){ze.hex?ge.default.isValidHex(ze.hex)&&X({hex:ze.hex,source:"hex"},Ze):(ze.r||ze.g||ze.b)&&X({r:ze.r||Q.r,g:ze.g||Q.g,b:ze.b||Q.b,source:"rgb"},Ze)};return H.default.createElement(Me.Raised,{styles:he},H.default.createElement("div",{style:De.material,className:"material-picker "+ce},H.default.createElement(Me.EditableInput,{style:{wrap:De.HEXwrap,input:De.HEXinput,label:De.HEXlabel},label:"hex",value:le,onChange:_t}),H.default.createElement("div",{style:De.split,className:"flexbox-fix"},H.default.createElement("div",{style:De.third},H.default.createElement(Me.EditableInput,{style:{wrap:De.RGBwrap,input:De.RGBinput,label:De.RGBlabel},label:"r",value:Q.r,onChange:_t})),H.default.createElement("div",{style:De.third},H.default.createElement(Me.EditableInput,{style:{wrap:De.RGBwrap,input:De.RGBinput,label:De.RGBlabel},label:"g",value:Q.g,onChange:_t})),H.default.createElement("div",{style:De.third},H.default.createElement(Me.EditableInput,{style:{wrap:De.RGBwrap,input:De.RGBinput,label:De.RGBlabel},label:"b",value:Q.b,onChange:_t})))))};$.default=(0,Me.ColorWrap)(ee)},80003:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Photoshop=void 0;var Z=function(){function xt(Zt,Kn){for(var we=0;we<Kn.length;we++){var Bn=Kn[we];Bn.enumerable=Bn.enumerable||!1,Bn.configurable=!0,"value"in Bn&&(Bn.writable=!0),Object.defineProperty(Zt,Bn.key,Bn)}}return function(Zt,Kn,we){return Kn&&xt(Zt.prototype,Kn),we&&xt(Zt,we),Zt}}(),H=P(67294),J=De(H),U=P(45697),pe=De(U),ke=P(79941),Ce=De(ke),ge=P(82492),Me=De(ge),Se=P(17840),ee=P(85198),oe=De(ee),Ae=P(10534),X=De(Ae),le=P(47967),Q=De(le),ne=P(84064),he=De(ne),Ue=P(1988),ce=De(Ue);function De(xt){return xt&&xt.__esModule?xt:{default:xt}}function _t(xt,Zt){if(!(xt instanceof Zt))throw new TypeError("Cannot call a class as a function")}function N(xt,Zt){if(!xt)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Zt&&(typeof Zt=="object"||typeof Zt=="function")?Zt:xt}function ze(xt,Zt){if(typeof Zt!="function"&&Zt!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Zt);xt.prototype=Object.create(Zt&&Zt.prototype,{constructor:{value:xt,enumerable:!1,writable:!0,configurable:!0}}),Zt&&(Object.setPrototypeOf?Object.setPrototypeOf(xt,Zt):xt.__proto__=Zt)}var Ze=$.Photoshop=function(xt){ze(Zt,xt);function Zt(Kn){_t(this,Zt);var we=N(this,(Zt.__proto__||Object.getPrototypeOf(Zt)).call(this));return we.state={currentColor:Kn.hex},we}return Z(Zt,[{key:"render",value:function(){var we=this.props,Bn=we.styles,Fr=Bn===void 0?{}:Bn,nn=we.className,Dn=nn===void 0?"":nn,yn=(0,Ce.default)((0,Me.default)({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},Fr));return J.default.createElement("div",{style:yn.picker,className:"photoshop-picker "+Dn},J.default.createElement("div",{style:yn.head},this.props.header),J.default.createElement("div",{style:yn.body,className:"flexbox-fix"},J.default.createElement("div",{style:yn.saturation},J.default.createElement(Se.Saturation,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:X.default,onChange:this.props.onChange})),J.default.createElement("div",{style:yn.hue},J.default.createElement(Se.Hue,{direction:"vertical",hsl:this.props.hsl,pointer:Q.default,onChange:this.props.onChange})),J.default.createElement("div",{style:yn.controls},J.default.createElement("div",{style:yn.top,className:"flexbox-fix"},J.default.createElement("div",{style:yn.previews},J.default.createElement(ce.default,{rgb:this.props.rgb,currentColor:this.state.currentColor})),J.default.createElement("div",{style:yn.actions},J.default.createElement(he.default,{label:"OK",onClick:this.props.onAccept,active:!0}),J.default.createElement(he.default,{label:"Cancel",onClick:this.props.onCancel}),J.default.createElement(oe.default,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),Zt}(J.default.Component);Ze.propTypes={header:pe.default.string,styles:pe.default.object},Ze.defaultProps={header:"Color Picker",styles:{}},$.default=(0,Se.ColorWrap)(Ze)},84064:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.PhotoshopButton=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.PhotoshopButton=function(ge){var Me=ge.onClick,Se=ge.label,ee=ge.children,oe=ge.active,Ae=(0,U.default)({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:oe});return H.default.createElement("div",{style:Ae.button,onClick:Me},Se||ee)};$.default=ke},85198:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.PhotoshopPicker=void 0;var Z=P(67294),H=ge(Z),J=P(79941),U=ge(J),pe=P(27200),ke=ge(pe),Ce=P(17840);function ge(Se){return Se&&Se.__esModule?Se:{default:Se}}var Me=$.PhotoshopPicker=function(ee){var oe=ee.onChange,Ae=ee.rgb,X=ee.hsv,le=ee.hex,Q=(0,U.default)({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),ne=function(Ue,ce){Ue["#"]?ke.default.isValidHex(Ue["#"])&&oe({hex:Ue["#"],source:"hex"},ce):Ue.r||Ue.g||Ue.b?oe({r:Ue.r||Ae.r,g:Ue.g||Ae.g,b:Ue.b||Ae.b,source:"rgb"},ce):(Ue.h||Ue.s||Ue.v)&&oe({h:Ue.h||X.h,s:Ue.s||X.s,v:Ue.v||X.v,source:"hsv"},ce)};return H.default.createElement("div",{style:Q.fields},H.default.createElement(Ce.EditableInput,{style:{wrap:Q.RGBwrap,input:Q.RGBinput,label:Q.RGBlabel},label:"h",value:Math.round(X.h),onChange:ne}),H.default.createElement(Ce.EditableInput,{style:{wrap:Q.RGBwrap,input:Q.RGBinput,label:Q.RGBlabel},label:"s",value:Math.round(X.s*100),onChange:ne}),H.default.createElement(Ce.EditableInput,{style:{wrap:Q.RGBwrap,input:Q.RGBinput,label:Q.RGBlabel},label:"v",value:Math.round(X.v*100),onChange:ne}),H.default.createElement("div",{style:Q.divider}),H.default.createElement(Ce.EditableInput,{style:{wrap:Q.RGBwrap,input:Q.RGBinput,label:Q.RGBlabel},label:"r",value:Ae.r,onChange:ne}),H.default.createElement(Ce.EditableInput,{style:{wrap:Q.RGBwrap,input:Q.RGBinput,label:Q.RGBlabel},label:"g",value:Ae.g,onChange:ne}),H.default.createElement(Ce.EditableInput,{style:{wrap:Q.RGBwrap,input:Q.RGBinput,label:Q.RGBlabel},label:"b",value:Ae.b,onChange:ne}),H.default.createElement("div",{style:Q.divider}),H.default.createElement(Ce.EditableInput,{style:{wrap:Q.HEXwrap,input:Q.HEXinput,label:Q.HEXlabel},label:"#",value:le.replace("#",""),onChange:ne}),H.default.createElement("div",{style:Q.fieldSymbols},H.default.createElement("div",{style:Q.symbol},"\xB0"),H.default.createElement("div",{style:Q.symbol},"%"),H.default.createElement("div",{style:Q.symbol},"%")))};$.default=Me},47967:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.PhotoshopPointerCircle=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.PhotoshopPointerCircle=function(){var ge=(0,U.default)({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return H.default.createElement("div",{style:ge.pointer},H.default.createElement("div",{style:ge.left},H.default.createElement("div",{style:ge.leftInside})),H.default.createElement("div",{style:ge.right},H.default.createElement("div",{style:ge.rightInside})))};$.default=ke},10534:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.PhotoshopPointerCircle=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.PhotoshopPointerCircle=function(ge){var Me=ge.hsl,Se=(0,U.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":Me.l>.5});return H.default.createElement("div",{style:Se.picker})};$.default=ke},1988:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.PhotoshopPreviews=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.PhotoshopPreviews=function(ge){var Me=ge.rgb,Se=ge.currentColor,ee=(0,U.default)({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+Me.r+","+Me.g+", "+Me.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:Se,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return H.default.createElement("div",null,H.default.createElement("div",{style:ee.label},"new"),H.default.createElement("div",{style:ee.swatches},H.default.createElement("div",{style:ee.new}),H.default.createElement("div",{style:ee.current})),H.default.createElement("div",{style:ee.label},"current"))};$.default=ke},5685:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Sketch=void 0;var Z=Object.assign||function(ne){for(var he=1;he<arguments.length;he++){var Ue=arguments[he];for(var ce in Ue)Object.prototype.hasOwnProperty.call(Ue,ce)&&(ne[ce]=Ue[ce])}return ne},H=P(67294),J=le(H),U=P(45697),pe=le(U),ke=P(79941),Ce=le(ke),ge=P(82492),Me=le(ge),Se=P(17840),ee=P(94282),oe=le(ee),Ae=P(73164),X=le(Ae);function le(ne){return ne&&ne.__esModule?ne:{default:ne}}var Q=$.Sketch=function(he){var Ue=he.width,ce=he.rgb,De=he.hex,_t=he.hsv,N=he.hsl,ze=he.onChange,Ze=he.onSwatchHover,xt=he.disableAlpha,Zt=he.presetColors,Kn=he.renderers,we=he.styles,Bn=we===void 0?{}:we,Fr=he.className,nn=Fr===void 0?"":Fr,Dn=(0,Ce.default)((0,Me.default)({default:Z({picker:{width:Ue,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+ce.r+","+ce.g+","+ce.b+","+ce.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},Bn),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},Bn),{disableAlpha:xt});return J.default.createElement("div",{style:Dn.picker,className:"sketch-picker "+nn},J.default.createElement("div",{style:Dn.saturation},J.default.createElement(Se.Saturation,{style:Dn.Saturation,hsl:N,hsv:_t,onChange:ze})),J.default.createElement("div",{style:Dn.controls,className:"flexbox-fix"},J.default.createElement("div",{style:Dn.sliders},J.default.createElement("div",{style:Dn.hue},J.default.createElement(Se.Hue,{style:Dn.Hue,hsl:N,onChange:ze})),J.default.createElement("div",{style:Dn.alpha},J.default.createElement(Se.Alpha,{style:Dn.Alpha,rgb:ce,hsl:N,renderers:Kn,onChange:ze}))),J.default.createElement("div",{style:Dn.color},J.default.createElement(Se.Checkboard,null),J.default.createElement("div",{style:Dn.activeColor}))),J.default.createElement(oe.default,{rgb:ce,hsl:N,hex:De,onChange:ze,disableAlpha:xt}),J.default.createElement(X.default,{colors:Zt,onClick:ze,onSwatchHover:Ze}))};Q.propTypes={disableAlpha:pe.default.bool,width:pe.default.oneOfType([pe.default.string,pe.default.number]),styles:pe.default.object},Q.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]},$.default=(0,Se.ColorWrap)(Q)},94282:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.SketchFields=void 0;var Z=P(67294),H=ge(Z),J=P(79941),U=ge(J),pe=P(27200),ke=ge(pe),Ce=P(17840);function ge(Se){return Se&&Se.__esModule?Se:{default:Se}}var Me=$.SketchFields=function(ee){var oe=ee.onChange,Ae=ee.rgb,X=ee.hsl,le=ee.hex,Q=ee.disableAlpha,ne=(0,U.default)({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:Q}),he=function(ce,De){ce.hex?ke.default.isValidHex(ce.hex)&&oe({hex:ce.hex,source:"hex"},De):ce.r||ce.g||ce.b?oe({r:ce.r||Ae.r,g:ce.g||Ae.g,b:ce.b||Ae.b,a:Ae.a,source:"rgb"},De):ce.a&&(ce.a<0?ce.a=0:ce.a>100&&(ce.a=100),ce.a/=100,oe({h:X.h,s:X.s,l:X.l,a:ce.a,source:"rgb"},De))};return H.default.createElement("div",{style:ne.fields,className:"flexbox-fix"},H.default.createElement("div",{style:ne.double},H.default.createElement(Ce.EditableInput,{style:{input:ne.input,label:ne.label},label:"hex",value:le.replace("#",""),onChange:he})),H.default.createElement("div",{style:ne.single},H.default.createElement(Ce.EditableInput,{style:{input:ne.input,label:ne.label},label:"r",value:Ae.r,onChange:he,dragLabel:"true",dragMax:"255"})),H.default.createElement("div",{style:ne.single},H.default.createElement(Ce.EditableInput,{style:{input:ne.input,label:ne.label},label:"g",value:Ae.g,onChange:he,dragLabel:"true",dragMax:"255"})),H.default.createElement("div",{style:ne.single},H.default.createElement(Ce.EditableInput,{style:{input:ne.input,label:ne.label},label:"b",value:Ae.b,onChange:he,dragLabel:"true",dragMax:"255"})),H.default.createElement("div",{style:ne.alpha},H.default.createElement(Ce.EditableInput,{style:{input:ne.input,label:ne.label},label:"a",value:Math.round(Ae.a*100),onChange:he,dragLabel:"true",dragMax:"100"})))};$.default=Me},73164:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.SketchPresetColors=void 0;var Z=Object.assign||function(ee){for(var oe=1;oe<arguments.length;oe++){var Ae=arguments[oe];for(var X in Ae)Object.prototype.hasOwnProperty.call(Ae,X)&&(ee[X]=Ae[X])}return ee},H=P(67294),J=Me(H),U=P(45697),pe=Me(U),ke=P(79941),Ce=Me(ke),ge=P(17840);function Me(ee){return ee&&ee.__esModule?ee:{default:ee}}var Se=$.SketchPresetColors=function(oe){var Ae=oe.colors,X=oe.onClick,le=X===void 0?function(){}:X,Q=oe.onSwatchHover,ne=(0,Ce.default)({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!Ae||!Ae.length}),he=function(ce,De){le({hex:ce,source:"hex"},De)};return J.default.createElement("div",{style:ne.colors,className:"flexbox-fix"},Ae.map(function(Ue){var ce=typeof Ue=="string"?{color:Ue}:Ue,De=""+ce.color+(ce.title||"");return J.default.createElement("div",{key:De,style:ne.swatchWrap},J.default.createElement(ge.Swatch,Z({},ce,{style:ne.swatch,onClick:he,onHover:Q,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+ce.color}})))}))};Se.propTypes={colors:pe.default.arrayOf(pe.default.oneOfType([pe.default.string,pe.default.shape({color:pe.default.string,title:pe.default.string})])).isRequired},$.default=Se},18623:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Slider=void 0;var Z=P(67294),H=X(Z),J=P(45697),U=X(J),pe=P(79941),ke=X(pe),Ce=P(82492),ge=X(Ce),Me=P(17840),Se=P(81410),ee=X(Se),oe=P(9610),Ae=X(oe);function X(Q){return Q&&Q.__esModule?Q:{default:Q}}var le=$.Slider=function(ne){var he=ne.hsl,Ue=ne.onChange,ce=ne.pointer,De=ne.styles,_t=De===void 0?{}:De,N=ne.className,ze=N===void 0?"":N,Ze=(0,ke.default)((0,ge.default)({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},_t));return H.default.createElement("div",{style:Ze.wrap||{},className:"slider-picker "+ze},H.default.createElement("div",{style:Ze.hue},H.default.createElement(Me.Hue,{style:Ze.Hue,hsl:he,pointer:ce,onChange:Ue})),H.default.createElement("div",{style:Ze.swatches},H.default.createElement(ee.default,{hsl:he,onClick:Ue})))};le.propTypes={styles:U.default.object},le.defaultProps={pointer:Ae.default,styles:{}},$.default=(0,Me.ColorWrap)(le)},9610:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.SliderPointer=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.SliderPointer=function(){var ge=(0,U.default)({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return H.default.createElement("div",{style:ge.picker})};$.default=ke},14818:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.SliderSwatch=void 0;var Z=P(67294),H=pe(Z),J=P(79941),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}var ke=$.SliderSwatch=function(ge){var Me=ge.hsl,Se=ge.offset,ee=ge.onClick,oe=ee===void 0?function(){}:ee,Ae=ge.active,X=ge.first,le=ge.last,Q=(0,U.default)({default:{swatch:{height:"12px",background:"hsl("+Me.h+", 50%, "+Se*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:Ae,first:X,last:le}),ne=function(Ue){return oe({h:Me.h,s:.5,l:Se,source:"hsl"},Ue)};return H.default.createElement("div",{style:Q.swatch,onClick:ne})};$.default=ke},81410:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.SliderSwatches=void 0;var Z=P(67294),H=Ce(Z),J=P(79941),U=Ce(J),pe=P(14818),ke=Ce(pe);function Ce(Me){return Me&&Me.__esModule?Me:{default:Me}}var ge=$.SliderSwatches=function(Se){var ee=Se.onClick,oe=Se.hsl,Ae=(0,U.default)({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),X=.1;return H.default.createElement("div",{style:Ae.swatches},H.default.createElement("div",{style:Ae.swatch},H.default.createElement(ke.default,{hsl:oe,offset:".80",active:Math.abs(oe.l-.8)<X&&Math.abs(oe.s-.5)<X,onClick:ee,first:!0})),H.default.createElement("div",{style:Ae.swatch},H.default.createElement(ke.default,{hsl:oe,offset:".65",active:Math.abs(oe.l-.65)<X&&Math.abs(oe.s-.5)<X,onClick:ee})),H.default.createElement("div",{style:Ae.swatch},H.default.createElement(ke.default,{hsl:oe,offset:".50",active:Math.abs(oe.l-.5)<X&&Math.abs(oe.s-.5)<X,onClick:ee})),H.default.createElement("div",{style:Ae.swatch},H.default.createElement(ke.default,{hsl:oe,offset:".35",active:Math.abs(oe.l-.35)<X&&Math.abs(oe.s-.5)<X,onClick:ee})),H.default.createElement("div",{style:Ae.swatch},H.default.createElement(ke.default,{hsl:oe,offset:".20",active:Math.abs(oe.l-.2)<X&&Math.abs(oe.s-.5)<X,onClick:ee,last:!0})),H.default.createElement("div",{style:Ae.clear}))};$.default=ge},10576:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Swatches=void 0;var Z=P(67294),H=Ue(Z),J=P(45697),U=Ue(J),pe=P(79941),ke=Ue(pe),Ce=P(35161),ge=Ue(Ce),Me=P(82492),Se=Ue(Me),ee=P(27200),oe=Ue(ee),Ae=P(53893),X=he(Ae),le=P(17840),Q=P(3435),ne=Ue(Q);function he(De){if(De&&De.__esModule)return De;var _t={};if(De!=null)for(var N in De)Object.prototype.hasOwnProperty.call(De,N)&&(_t[N]=De[N]);return _t.default=De,_t}function Ue(De){return De&&De.__esModule?De:{default:De}}var ce=$.Swatches=function(_t){var N=_t.width,ze=_t.height,Ze=_t.onChange,xt=_t.onSwatchHover,Zt=_t.colors,Kn=_t.hex,we=_t.styles,Bn=we===void 0?{}:we,Fr=_t.className,nn=Fr===void 0?"":Fr,Dn=(0,ke.default)((0,Se.default)({default:{picker:{width:N,height:ze},overflow:{height:ze,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},Bn)),yn=function(Sr,pr){oe.default.isValidHex(Sr)&&Ze({hex:Sr,source:"hex"},pr)};return H.default.createElement("div",{style:Dn.picker,className:"swatches-picker "+nn},H.default.createElement(le.Raised,null,H.default.createElement("div",{style:Dn.overflow},H.default.createElement("div",{style:Dn.body},(0,ge.default)(Zt,function(Rt){return H.default.createElement(ne.default,{key:Rt.toString(),group:Rt,active:Kn,onClick:yn,onSwatchHover:xt})}),H.default.createElement("div",{style:Dn.clear})))))};ce.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),height:U.default.oneOfType([U.default.string,U.default.number]),colors:U.default.arrayOf(U.default.arrayOf(U.default.string)),styles:U.default.object},ce.defaultProps={width:320,height:240,colors:[[X.red[900],X.red[700],X.red[500],X.red[300],X.red[100]],[X.pink[900],X.pink[700],X.pink[500],X.pink[300],X.pink[100]],[X.purple[900],X.purple[700],X.purple[500],X.purple[300],X.purple[100]],[X.deepPurple[900],X.deepPurple[700],X.deepPurple[500],X.deepPurple[300],X.deepPurple[100]],[X.indigo[900],X.indigo[700],X.indigo[500],X.indigo[300],X.indigo[100]],[X.blue[900],X.blue[700],X.blue[500],X.blue[300],X.blue[100]],[X.lightBlue[900],X.lightBlue[700],X.lightBlue[500],X.lightBlue[300],X.lightBlue[100]],[X.cyan[900],X.cyan[700],X.cyan[500],X.cyan[300],X.cyan[100]],[X.teal[900],X.teal[700],X.teal[500],X.teal[300],X.teal[100]],["#194D33",X.green[700],X.green[500],X.green[300],X.green[100]],[X.lightGreen[900],X.lightGreen[700],X.lightGreen[500],X.lightGreen[300],X.lightGreen[100]],[X.lime[900],X.lime[700],X.lime[500],X.lime[300],X.lime[100]],[X.yellow[900],X.yellow[700],X.yellow[500],X.yellow[300],X.yellow[100]],[X.amber[900],X.amber[700],X.amber[500],X.amber[300],X.amber[100]],[X.orange[900],X.orange[700],X.orange[500],X.orange[300],X.orange[100]],[X.deepOrange[900],X.deepOrange[700],X.deepOrange[500],X.deepOrange[300],X.deepOrange[100]],[X.brown[900],X.brown[700],X.brown[500],X.brown[300],X.brown[100]],[X.blueGrey[900],X.blueGrey[700],X.blueGrey[500],X.blueGrey[300],X.blueGrey[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}},$.default=(0,le.ColorWrap)(ce)},86226:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.SwatchesColor=void 0;var Z=P(67294),H=Se(Z),J=P(79941),U=Se(J),pe=P(27200),ke=Se(pe),Ce=P(17840),ge=P(70597),Me=Se(ge);function Se(oe){return oe&&oe.__esModule?oe:{default:oe}}var ee=$.SwatchesColor=function(Ae){var X=Ae.color,le=Ae.onClick,Q=le===void 0?function(){}:le,ne=Ae.onSwatchHover,he=Ae.first,Ue=Ae.last,ce=Ae.active,De=(0,U.default)({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:X,marginBottom:"1px"},check:{color:ke.default.getContrastingColor(X),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:he,last:Ue,active:ce,"color-#FFFFFF":X==="#FFFFFF",transparent:X==="transparent"});return H.default.createElement(Ce.Swatch,{color:X,style:De.color,onClick:Q,onHover:ne,focusStyle:{boxShadow:"0 0 4px "+X}},H.default.createElement("div",{style:De.check},H.default.createElement(Me.default,null)))};$.default=ee},3435:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.SwatchesGroup=void 0;var Z=P(67294),H=Me(Z),J=P(79941),U=Me(J),pe=P(35161),ke=Me(pe),Ce=P(86226),ge=Me(Ce);function Me(ee){return ee&&ee.__esModule?ee:{default:ee}}var Se=$.SwatchesGroup=function(oe){var Ae=oe.onClick,X=oe.onSwatchHover,le=oe.group,Q=oe.active,ne=(0,U.default)({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return H.default.createElement("div",{style:ne.group},(0,ke.default)(le,function(he,Ue){return H.default.createElement(ge.default,{key:he,color:he,active:he.toLowerCase()===Q,first:Ue===0,last:Ue===le.length-1,onClick:Ae,onSwatchHover:X})}))};$.default=Se},40318:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.Twitter=void 0;var Z=P(67294),H=X(Z),J=P(45697),U=X(J),pe=P(79941),ke=X(pe),Ce=P(35161),ge=X(Ce),Me=P(82492),Se=X(Me),ee=P(27200),oe=X(ee),Ae=P(17840);function X(Q){return Q&&Q.__esModule?Q:{default:Q}}var le=$.Twitter=function(ne){var he=ne.onChange,Ue=ne.onSwatchHover,ce=ne.hex,De=ne.colors,_t=ne.width,N=ne.triangle,ze=ne.styles,Ze=ze===void 0?{}:ze,xt=ne.className,Zt=xt===void 0?"":xt,Kn=(0,ke.default)((0,Se.default)({default:{card:{width:_t,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},Ze),{"hide-triangle":N==="hide","top-left-triangle":N==="top-left","top-right-triangle":N==="top-right"}),we=function(Fr,nn){oe.default.isValidHex(Fr)&&he({hex:Fr,source:"hex"},nn)};return H.default.createElement("div",{style:Kn.card,className:"twitter-picker "+Zt},H.default.createElement("div",{style:Kn.triangleShadow}),H.default.createElement("div",{style:Kn.triangle}),H.default.createElement("div",{style:Kn.body},(0,ge.default)(De,function(Bn,Fr){return H.default.createElement(Ae.Swatch,{key:Fr,color:Bn,hex:Bn,style:Kn.swatch,onClick:we,onHover:Ue,focusStyle:{boxShadow:"0 0 4px "+Bn}})}),H.default.createElement("div",{style:Kn.hash},"#"),H.default.createElement(Ae.EditableInput,{style:{input:Kn.input},value:ce.replace("#",""),onChange:we}),H.default.createElement("div",{style:Kn.clear})))};le.propTypes={width:U.default.oneOfType([U.default.string,U.default.number]),triangle:U.default.oneOf(["hide","top-left","top-right"]),colors:U.default.arrayOf(U.default.string),styles:U.default.object},le.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}},$.default=(0,Ae.ColorWrap)(le)},78321:function(je,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var P=$.calculateChange=function(H,J,U,pe,ke){H.preventDefault();var Ce=ke.clientWidth,ge=ke.clientHeight,Me=typeof H.pageX=="number"?H.pageX:H.touches[0].pageX,Se=typeof H.pageY=="number"?H.pageY:H.touches[0].pageY,ee=Me-(ke.getBoundingClientRect().left+window.pageXOffset),oe=Se-(ke.getBoundingClientRect().top+window.pageYOffset);if(U==="vertical"){var Ae=void 0;if(oe<0?Ae=0:oe>ge?Ae=1:Ae=Math.round(oe*100/ge)/100,J.a!==Ae)return{h:J.h,s:J.s,l:J.l,a:Ae,source:"rgb"}}else{var X=void 0;if(ee<0?X=0:ee>Ce?X=1:X=Math.round(ee*100/Ce)/100,pe!==X)return{h:J.h,s:J.s,l:J.l,a:X,source:"rgb"}}return null}},69433:function(je,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var P={},Z=$.render=function(U,pe,ke,Ce){if(typeof document>"u"&&!Ce)return null;var ge=Ce?new Ce:document.createElement("canvas");ge.width=ke*2,ge.height=ke*2;var Me=ge.getContext("2d");return Me?(Me.fillStyle=U,Me.fillRect(0,0,ge.width,ge.height),Me.fillStyle=pe,Me.fillRect(0,0,ke,ke),Me.translate(ke,ke),Me.fillRect(0,0,ke,ke),ge.toDataURL()):null},H=$.get=function(U,pe,ke,Ce){var ge=U+"-"+pe+"-"+ke+(Ce?"-server":"");if(P[ge])return P[ge];var Me=Z(U,pe,ke,Ce);return P[ge]=Me,Me}},27200:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.red=void 0;var Z=P(66073),H=pe(Z),J=P(17621),U=pe(J);function pe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}$.default={simpleCheckForValidColor:function(ge){var Me=["r","g","b","a","h","s","l","v"],Se=0,ee=0;return(0,H.default)(Me,function(oe){if(ge[oe]&&(Se+=1,isNaN(ge[oe])||(ee+=1),oe==="s"||oe==="l")){var Ae=/^\d+%$/;Ae.test(ge[oe])&&(ee+=1)}}),Se===ee?ge:!1},toState:function(ge,Me){var Se=ge.hex?(0,U.default)(ge.hex):(0,U.default)(ge),ee=Se.toHsl(),oe=Se.toHsv(),Ae=Se.toRgb(),X=Se.toHex();ee.s===0&&(ee.h=Me||0,oe.h=Me||0);var le=X==="000000"&&Ae.a===0;return{hsl:ee,hex:le?"transparent":"#"+X,rgb:Ae,hsv:oe,oldHue:ge.h||Me||ee.h,source:ge.source}},isValidHex:function(ge){var Me=String(ge).charAt(0)==="#"?1:0;return ge.length!==4+Me&&ge.length<7+Me&&(0,U.default)(ge).isValid()},getContrastingColor:function(ge){if(!ge)return"#fff";var Me=this.toState(ge);if(Me.hex==="transparent")return"rgba(0,0,0,0.4)";var Se=(Me.rgb.r*299+Me.rgb.g*587+Me.rgb.b*114)/1e3;return Se>=128?"#000":"#fff"}};var ke=$.red={hsl:{a:1,h:0,l:.5,s:1},hex:"#ff0000",rgb:{r:255,g:0,b:0,a:1},hsv:{h:0,s:1,v:1,a:1}}},19800:function(je,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var P=$.calculateChange=function(H,J,U,pe){H.preventDefault();var ke=pe.clientWidth,Ce=pe.clientHeight,ge=typeof H.pageX=="number"?H.pageX:H.touches[0].pageX,Me=typeof H.pageY=="number"?H.pageY:H.touches[0].pageY,Se=ge-(pe.getBoundingClientRect().left+window.pageXOffset),ee=Me-(pe.getBoundingClientRect().top+window.pageYOffset);if(J==="vertical"){var oe=void 0;if(ee<0)oe=359;else if(ee>Ce)oe=0;else{var Ae=-(ee*100/Ce)+100;oe=360*Ae/100}if(U.h!==oe)return{h:oe,s:U.s,l:U.l,a:U.a,source:"rgb"}}else{var X=void 0;if(Se<0)X=0;else if(Se>ke)X=359;else{var le=Se*100/ke;X=360*le/100}if(U.h!==X)return{h:X,s:U.s,l:U.l,a:U.a,source:"rgb"}}return null}},28592:function(je,$,P){"use strict";Object.defineProperty($,"__esModule",{value:!0}),$.handleFocus=void 0;var Z=Object.assign||function(Se){for(var ee=1;ee<arguments.length;ee++){var oe=arguments[ee];for(var Ae in oe)Object.prototype.hasOwnProperty.call(oe,Ae)&&(Se[Ae]=oe[Ae])}return Se},H=function(){function Se(ee,oe){for(var Ae=0;Ae<oe.length;Ae++){var X=oe[Ae];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(ee,X.key,X)}}return function(ee,oe,Ae){return oe&&Se(ee.prototype,oe),Ae&&Se(ee,Ae),ee}}(),J=P(67294),U=pe(J);function pe(Se){return Se&&Se.__esModule?Se:{default:Se}}function ke(Se,ee){if(!(Se instanceof ee))throw new TypeError("Cannot call a class as a function")}function Ce(Se,ee){if(!Se)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee&&(typeof ee=="object"||typeof ee=="function")?ee:Se}function ge(Se,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ee);Se.prototype=Object.create(ee&&ee.prototype,{constructor:{value:Se,enumerable:!1,writable:!0,configurable:!0}}),ee&&(Object.setPrototypeOf?Object.setPrototypeOf(Se,ee):Se.__proto__=ee)}var Me=$.handleFocus=function(ee){var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return function(Ae){ge(X,Ae);function X(){var le,Q,ne,he;ke(this,X);for(var Ue=arguments.length,ce=Array(Ue),De=0;De<Ue;De++)ce[De]=arguments[De];return he=(Q=(ne=Ce(this,(le=X.__proto__||Object.getPrototypeOf(X)).call.apply(le,[this].concat(ce))),ne),ne.state={focus:!1},ne.handleFocus=function(){return ne.setState({focus:!0})},ne.handleBlur=function(){return ne.setState({focus:!1})},Q),Ce(ne,he)}return H(X,[{key:"render",value:function(){return U.default.createElement(oe,{onFocus:this.handleFocus,onBlur:this.handleBlur},U.default.createElement(ee,Z({},this.props,this.state)))}}]),X}(U.default.Component)}},19723:function(je,$){"use strict";Object.defineProperty($,"__esModule",{value:!0});var P=$.calculateChange=function(H,J,U){H.preventDefault();var pe=U.getBoundingClientRect(),ke=pe.width,Ce=pe.height,ge=typeof H.pageX=="number"?H.pageX:H.touches[0].pageX,Me=typeof H.pageY=="number"?H.pageY:H.touches[0].pageY,Se=ge-(U.getBoundingClientRect().left+window.pageXOffset),ee=Me-(U.getBoundingClientRect().top+window.pageYOffset);Se<0?Se=0:Se>ke?Se=ke:ee<0?ee=0:ee>Ce&&(ee=Ce);var oe=Se*100/ke,Ae=-(ee*100/Ce)+100;return{h:J.h,s:oe,v:Ae,a:J.a,source:"rgb"}}},48007:function(je,$,P){"use strict";var Z;Z={value:!0},Z=Z=Z=Z=$.xS=Z=Z=Z=Z=Z=Z=Z=Z=Z=Z=void 0;var H=P(508);Z={enumerable:!0,get:function(){return ne(H).default}};var J=P(46835);Z={enumerable:!0,get:function(){return ne(J).default}};var U=P(93545);Z={enumerable:!0,get:function(){return ne(U).default}};var pe=P(17339);Z={enumerable:!0,get:function(){return ne(pe).default}};var ke=P(63205);Z={enumerable:!0,get:function(){return ne(ke).default}};var Ce=P(21109);Z={enumerable:!0,get:function(){return ne(Ce).default}};var ge=P(31270);Z={enumerable:!0,get:function(){return ne(ge).default}};var Me=P(21172);Z={enumerable:!0,get:function(){return ne(Me).default}};var Se=P(80003);Z={enumerable:!0,get:function(){return ne(Se).default}};var ee=P(5685);Object.defineProperty($,"xS",{enumerable:!0,get:function(){return ne(ee).default}});var oe=P(18623);Z={enumerable:!0,get:function(){return ne(oe).default}};var Ae=P(10576);Z={enumerable:!0,get:function(){return ne(Ae).default}};var X=P(40318);Z={enumerable:!0,get:function(){return ne(X).default}};var le=P(88238);Z={enumerable:!0,get:function(){return ne(le).default}};var Q=ne(pe);function ne(he){return he&&he.__esModule?he:{default:he}}Z=Q.default},61934:function(je,$,P){"use strict";P.d($,{g8:function(){return D_},w5:function(){return s_},It:function(){return W_},XS:function(){return n_},xZ:function(){return hP},ce:function(){return q3},BH:function(){return As},K4:function(){return qn},Gn:function(){return Tp},KV:function(){return Br},ko:function(){return jd},Ip:function(){return X3},G7:function(){return YD},dX:function(){return H},Nf:function(){return Z},UI:function(){return e1},zl:function(){return C3},Ak:function(){return fo},yc:function(){return Wc},g:function(){return WM},n1:function(){return dh},ho:function(){return d1},$b:function(){return zi},Gv:function(){return rr},dV:function(){return to},cE:function(){return di},s4:function(){return ID},Kd:function(){return __},Jp:function(){return Nl},vD:function(){return lh},zg:function(){return KD},HJ:function(){return Xp},iR:function(){return fP},XZ:function(){return po},k$:function(){return Ol}});var Z={};P.r(Z),P.d(Z,{Container:function(){return yr},Contribution:function(){return Qr},DefaultContributionProvider:function(){return Mi},GlobalContainer:function(){return Or},Module:function(){return Yi},OptionSymbol:function(){return pr},Provider:function(){return _r},Syringe:function(){return ce},SyringeModule:function(){return Xs},Utils:function(){return De},contrib:function(){return Bi},decorate:function(){return U.GW},inject:function(){return Rt},injectable:function(){return nn},named:function(){return Sr},optional:function(){return U.jt},postConstruct:function(){return U.zY},register:function(){return Co},registerSideOption:function(){return _n},singleton:function(){return Dn},transient:function(){return yn},unmanaged:function(){return U.NT}});var H={};P.r(H),P.d(H,{COMMAND_GLOBALS:function(){return hd},COMMAND_REDOABLE:function(){return ud},COMMAND_UNDOABLE:function(){return dd},CONTEXTMENU_EDGE:function(){return Zp},CONTEXTMENU_NODE:function(){return sl},CONTEXTMENU_TARGET:function(){return rs},GRAPH_ENABLE_MULTI_SELECT:function(){return hu},GRAPH_FULLSCREEN:function(){return fu},GRAPH_META:function(){return Tc},GRAPH_SCALE:function(){return Ua},HISTORY_REDOABLE:function(){return pd},HISTORY_UNDOABLE:function(){return fd},IS_GROUP_SELECTED:function(){return Of},IS_NODE_SELECTED:function(){return Pf},IS_NORMAL_NODES_SELECTED:function(){return Df},SELECTED_CELL:function(){return zl},SELECTED_CELLS:function(){return bs},SELECTED_EDGES:function(){return Wp},SELECTED_GROUPS:function(){return Vl},SELECTED_NODE:function(){return Ul},SELECTED_NODES:function(){return za},getModelUtil:function(){return $i},isModelExistUtil:function(){return nm},useModelValueUtil:function(){return io}});var J={};P.r(J),P.d(J,{ConnectorNode:function(){return bN},DataIONode:function(){return xN},DatabaseNode:function(){return wN},DecisionNode:function(){return yN},DelayNode:function(){return kN},DisplayNode:function(){return IN},DocumentNode:function(){return AN},ExtractNode:function(){return PN},HardDiskNode:function(){return EN},InternalStorageNode:function(){return BN},ManualInputNode:function(){return _N},ManualOperationNode:function(){return RN},MergeNode:function(){return ON},MultiDocumentNode:function(){return TN},NoteLeftNode:function(){return FN},NoteRightNode:function(){return GN},OffPageLinkNode:function(){return LN},OrNode:function(){return DN},PredefinedProcessNode:function(){return MN},PreparationNode:function(){return NN},ProcessNode:function(){return vN},StroedDataNode:function(){return SN},TerminalNode:function(){return CN},TextNode:function(){return zN}});var U=P(86700),pe=P(34155);function ke(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function Ce(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?ke(Object(o),!0).forEach(function(s){oe(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):ke(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}function ge(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ge=function(r){return typeof r}:ge=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ge(n)}function Me(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}function Se(n,r){for(var o=0;o<r.length;o++){var s=r[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}function ee(n,r,o){return r&&Se(n.prototype,r),o&&Se(n,o),n}function oe(n,r,o){return r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n}function Ae(n){return X(n)||le(n)||Q(n)||he()}function X(n){if(Array.isArray(n))return ne(n)}function le(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Q(n,r){if(!!n){if(typeof n=="string")return ne(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);if(o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set")return Array.from(n);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return ne(n,r)}}function ne(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=n[o];return s}function he(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ue;(function(n){(function(r){var o=typeof P.g=="object"?P.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),s=l(n);typeof o.Reflect>"u"?o.Reflect=n:s=l(o.Reflect,s),r(s);function l(u,h){return function(p,g){typeof u[p]!="function"&&Object.defineProperty(u,p,{configurable:!0,writable:!0,value:g}),h&&h(p,g)}}})(function(r){var o=Object.prototype.hasOwnProperty,s=typeof Symbol=="function",l=s&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",u=s&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",h=typeof Object.create=="function",p={__proto__:[]}instanceof Array,g=!h&&!p,v={create:h?function(){return _p(Object.create(null))}:p?function(){return _p({__proto__:null})}:function(){return _p({})},has:g?function(wt,Yt){return o.call(wt,Yt)}:function(wt,Yt){return Yt in wt},get:g?function(wt,Yt){return o.call(wt,Yt)?wt[Yt]:void 0}:function(wt,Yt){return wt[Yt]}},b=Object.getPrototypeOf(Function),w=typeof pe=="object"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",A=!w&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ka(),O=!w&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Hg(),D=!w&&typeof WeakMap=="function"?WeakMap:F0(),_=new D;function I(wt,Yt,bn,Ln){if(Ur(bn)){if(!jo(wt))throw new TypeError;if(!Ui(Yt))throw new TypeError;return bt(wt,Yt)}else{if(!jo(wt))throw new TypeError;if(!hn(Yt))throw new TypeError;if(!hn(Ln)&&!Ur(Ln)&&!Vo(Ln))throw new TypeError;return Vo(Ln)&&(Ln=void 0),bn=Er(bn),jt(wt,Yt,bn,Ln)}}r("decorate",I);function B(wt,Yt){function bn(Ln,vr){if(!hn(Ln))throw new TypeError;if(!Ur(vr)&&!Zc(vr))throw new TypeError;Ei(wt,Yt,Ln,vr)}return bn}r("metadata",B);function G(wt,Yt,bn,Ln){if(!hn(bn))throw new TypeError;return Ur(Ln)||(Ln=Er(Ln)),Ei(wt,Yt,bn,Ln)}r("defineMetadata",G);function K(wt,Yt,bn){if(!hn(Yt))throw new TypeError;return Ur(bn)||(bn=Er(bn)),An(wt,Yt,bn)}r("hasMetadata",K);function ve(wt,Yt,bn){if(!hn(Yt))throw new TypeError;return Ur(bn)||(bn=Er(bn)),Vn(wt,Yt,bn)}r("hasOwnMetadata",ve);function ae(wt,Yt,bn){if(!hn(Yt))throw new TypeError;return Ur(bn)||(bn=Er(bn)),Zn(wt,Yt,bn)}r("getMetadata",ae);function Ye(wt,Yt,bn){if(!hn(Yt))throw new TypeError;return Ur(bn)||(bn=Er(bn)),wi(wt,Yt,bn)}r("getOwnMetadata",Ye);function rt(wt,Yt){if(!hn(wt))throw new TypeError;return Ur(Yt)||(Yt=Er(Yt)),Dr(wt,Yt)}r("getMetadataKeys",rt);function st(wt,Yt){if(!hn(wt))throw new TypeError;return Ur(Yt)||(Yt=Er(Yt)),eo(wt,Yt)}r("getOwnMetadataKeys",st);function tn(wt,Yt,bn){if(!hn(Yt))throw new TypeError;Ur(bn)||(bn=Er(bn));var Ln=et(Yt,bn,!1);if(Ur(Ln)||!Ln.delete(wt))return!1;if(Ln.size>0)return!0;var vr=_.get(Yt);return vr.delete(bn),vr.size>0||_.delete(Yt),!0}r("deleteMetadata",tn);function bt(wt,Yt){for(var bn=wt.length-1;bn>=0;--bn){var Ln=wt[bn],vr=Ln(Yt);if(!Ur(vr)&&!Vo(vr)){if(!Ui(vr))throw new TypeError;Yt=vr}}return Yt}function jt(wt,Yt,bn,Ln){for(var vr=wt.length-1;vr>=0;--vr){var Hn=wt[vr],$r=Hn(Yt,bn,Ln);if(!Ur($r)&&!Vo($r)){if(!hn($r))throw new TypeError;Ln=$r}}return Ln}function et(wt,Yt,bn){var Ln=_.get(wt);if(Ur(Ln)){if(!bn)return;Ln=new A,_.set(wt,Ln)}var vr=Ln.get(Yt);if(Ur(vr)){if(!bn)return;vr=new A,Ln.set(Yt,vr)}return vr}function An(wt,Yt,bn){var Ln=Vn(wt,Yt,bn);if(Ln)return!0;var vr=jg(Yt);return Vo(vr)?!1:An(wt,vr,bn)}function Vn(wt,Yt,bn){var Ln=et(Yt,bn,!1);return Ur(Ln)?!1:ui(Ln.has(wt))}function Zn(wt,Yt,bn){var Ln=Vn(wt,Yt,bn);if(Ln)return wi(wt,Yt,bn);var vr=jg(Yt);if(!Vo(vr))return Zn(wt,vr,bn)}function wi(wt,Yt,bn){var Ln=et(Yt,bn,!1);if(!Ur(Ln))return Ln.get(wt)}function Ei(wt,Yt,bn,Ln){var vr=et(bn,Ln,!0);vr.set(wt,Yt)}function Dr(wt,Yt){var bn=eo(wt,Yt),Ln=jg(wt);if(Ln===null)return bn;var vr=Dr(Ln,Yt);if(vr.length<=0)return bn;if(bn.length<=0)return vr;for(var Hn=new O,$r=[],pi=0,nr=bn;pi<nr.length;pi++){var ki=nr[pi],Ti=Hn.has(ki);Ti||(Hn.add(ki),$r.push(ki))}for(var Es=0,Np=vr;Es<Np.length;Es++){var ki=Np[Es],Ti=Hn.has(ki);Ti||(Hn.add(ki),$r.push(ki))}return $r}function eo(wt,Yt){var bn=[],Ln=et(wt,Yt,!1);if(Ur(Ln))return bn;for(var vr=Ln.keys(),Hn=Op(vr),$r=0;;){var pi=Dp(Hn);if(!pi)return bn.length=$r,bn;var nr=Qh(pi);try{bn[$r]=nr}catch(ki){try{pb(Hn)}finally{throw ki}}$r++}}function Uo(wt){if(wt===null)return 1;switch(typeof wt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return wt===null?1:6;default:return 6}}function Ur(wt){return wt===void 0}function Vo(wt){return wt===null}function gs(wt){return typeof wt=="symbol"}function hn(wt){return typeof wt=="object"?wt!==null:typeof wt=="function"}function Xn(wt,Yt){switch(Uo(wt)){case 0:return wt;case 1:return wt;case 2:return wt;case 3:return wt;case 4:return wt;case 5:return wt}var bn=Yt===3?"string":Yt===5?"number":"default",Ln=Xc(wt,l);if(Ln!==void 0){var vr=Ln.call(wt,bn);if(hn(vr))throw new TypeError;return vr}return oi(wt,bn==="default"?"number":bn)}function oi(wt,Yt){if(Yt==="string"){var bn=wt.toString;if(Zs(bn)){var Ln=bn.call(wt);if(!hn(Ln))return Ln}var vr=wt.valueOf;if(Zs(vr)){var Ln=vr.call(wt);if(!hn(Ln))return Ln}}else{var vr=wt.valueOf;if(Zs(vr)){var Ln=vr.call(wt);if(!hn(Ln))return Ln}var Hn=wt.toString;if(Zs(Hn)){var Ln=Hn.call(wt);if(!hn(Ln))return Ln}}throw new TypeError}function ui(wt){return!!wt}function Ai(wt){return""+wt}function Er(wt){var Yt=Xn(wt,3);return gs(Yt)?Yt:Ai(Yt)}function jo(wt){return Array.isArray?Array.isArray(wt):wt instanceof Object?wt instanceof Array:Object.prototype.toString.call(wt)==="[object Array]"}function Zs(wt){return typeof wt=="function"}function Ui(wt){return typeof wt=="function"}function Zc(wt){switch(Uo(wt)){case 3:return!0;case 4:return!0;default:return!1}}function Xc(wt,Yt){var bn=wt[Yt];if(bn!=null){if(!Zs(bn))throw new TypeError;return bn}}function Op(wt){var Yt=Xc(wt,u);if(!Zs(Yt))throw new TypeError;var bn=Yt.call(wt);if(!hn(bn))throw new TypeError;return bn}function Qh(wt){return wt.value}function Dp(wt){var Yt=wt.next();return Yt.done?!1:Yt}function pb(wt){var Yt=wt.return;Yt&&Yt.call(wt)}function jg(wt){var Yt=Object.getPrototypeOf(wt);if(typeof wt!="function"||wt===b||Yt!==b)return Yt;var bn=wt.prototype,Ln=bn&&Object.getPrototypeOf(bn);if(Ln==null||Ln===Object.prototype)return Yt;var vr=Ln.constructor;return typeof vr!="function"||vr===wt?Yt:vr}function ka(){var wt={},Yt=[],bn=function(){function $r(pi,nr,ki){this._index=0,this._keys=pi,this._values=nr,this._selector=ki}return $r.prototype["@@iterator"]=function(){return this},$r.prototype[u]=function(){return this},$r.prototype.next=function(){var pi=this._index;if(pi>=0&&pi<this._keys.length){var nr=this._selector(this._keys[pi],this._values[pi]);return pi+1>=this._keys.length?(this._index=-1,this._keys=Yt,this._values=Yt):this._index++,{value:nr,done:!1}}return{value:void 0,done:!0}},$r.prototype.throw=function(pi){throw this._index>=0&&(this._index=-1,this._keys=Yt,this._values=Yt),pi},$r.prototype.return=function(pi){return this._index>=0&&(this._index=-1,this._keys=Yt,this._values=Yt),{value:pi,done:!0}},$r}();return function(){function $r(){this._keys=[],this._values=[],this._cacheKey=wt,this._cacheIndex=-2}return Object.defineProperty($r.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),$r.prototype.has=function(pi){return this._find(pi,!1)>=0},$r.prototype.get=function(pi){var nr=this._find(pi,!1);return nr>=0?this._values[nr]:void 0},$r.prototype.set=function(pi,nr){var ki=this._find(pi,!0);return this._values[ki]=nr,this},$r.prototype.delete=function(pi){var nr=this._find(pi,!1);if(nr>=0){for(var ki=this._keys.length,Ti=nr+1;Ti<ki;Ti++)this._keys[Ti-1]=this._keys[Ti],this._values[Ti-1]=this._values[Ti];return this._keys.length--,this._values.length--,pi===this._cacheKey&&(this._cacheKey=wt,this._cacheIndex=-2),!0}return!1},$r.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=wt,this._cacheIndex=-2},$r.prototype.keys=function(){return new bn(this._keys,this._values,Ln)},$r.prototype.values=function(){return new bn(this._keys,this._values,vr)},$r.prototype.entries=function(){return new bn(this._keys,this._values,Hn)},$r.prototype["@@iterator"]=function(){return this.entries()},$r.prototype[u]=function(){return this.entries()},$r.prototype._find=function(pi,nr){return this._cacheKey!==pi&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=pi)),this._cacheIndex<0&&nr&&(this._cacheIndex=this._keys.length,this._keys.push(pi),this._values.push(void 0)),this._cacheIndex},$r}();function Ln($r,pi){return $r}function vr($r,pi){return pi}function Hn($r,pi){return[$r,pi]}}function Hg(){return function(){function wt(){this._map=new A}return Object.defineProperty(wt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),wt.prototype.has=function(Yt){return this._map.has(Yt)},wt.prototype.add=function(Yt){return this._map.set(Yt,Yt),this},wt.prototype.delete=function(Yt){return this._map.delete(Yt)},wt.prototype.clear=function(){this._map.clear()},wt.prototype.keys=function(){return this._map.keys()},wt.prototype.values=function(){return this._map.values()},wt.prototype.entries=function(){return this._map.entries()},wt.prototype["@@iterator"]=function(){return this.keys()},wt.prototype[u]=function(){return this.keys()},wt}()}function F0(){var wt=16,Yt=v.create(),bn=Ln();return function(){function nr(){this._key=Ln()}return nr.prototype.has=function(ki){var Ti=vr(ki,!1);return Ti!==void 0?v.has(Ti,this._key):!1},nr.prototype.get=function(ki){var Ti=vr(ki,!1);return Ti!==void 0?v.get(Ti,this._key):void 0},nr.prototype.set=function(ki,Ti){var Es=vr(ki,!0);return Es[this._key]=Ti,this},nr.prototype.delete=function(ki){var Ti=vr(ki,!1);return Ti!==void 0?delete Ti[this._key]:!1},nr.prototype.clear=function(){this._key=Ln()},nr}();function Ln(){var nr;do nr="@@WeakMap@@"+pi();while(v.has(Yt,nr));return Yt[nr]=!0,nr}function vr(nr,ki){if(!o.call(nr,bn)){if(!ki)return;Object.defineProperty(nr,bn,{value:v.create()})}return nr[bn]}function Hn(nr,ki){for(var Ti=0;Ti<ki;++Ti)nr[Ti]=Math.random()*255|0;return nr}function $r(nr){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(nr)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(nr)):Hn(new Uint8Array(nr),nr):Hn(new Array(nr),nr)}function pi(){var nr=$r(wt);nr[6]=nr[6]&79|64,nr[8]=nr[8]&191|128;for(var ki="",Ti=0;Ti<wt;++Ti){var Es=nr[Ti];(Ti===4||Ti===6||Ti===8)&&(ki+="-"),Es<16&&(ki+="0"),ki+=Es.toString(16).toLowerCase()}return ki}}function _p(wt){return wt.__=void 0,delete wt.__,wt}})})(Ue||(Ue={}));var ce;(function(n){n.defineToken=function(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{multiple:!0};return new n.DefinedToken(l,u)};var r=function l(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Me(this,l),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var p=h.multiple,g=p===void 0?!1:p;this.name=u,this.symbol=Symbol(this.name),this.multiple=g};n.DefinedToken=r;function o(l){return!!l&&ge(l)==="object"&&"id"in l&&"registry"in l}n.isModule=o;var s;(function(l){l.singleton="singleton",l.transient="transient"})(s=n.Lifecycle||(n.Lifecycle={})),n.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),n.DefaultOption={lifecycle:s.transient}})(ce||(ce={}));var De;(function(n){function r(p){return p instanceof Array?p:p!==void 0?[p]:[]}n.maybeArrayToArray=r;function o(p){return!!(p&&typeof p=="function"&&"prototype"in p)}n.isClass=o;function s(p){return!!(p&&ge(p)==="object"&&"symbol"in p&&"multiple"in p)}n.isDefinedToken=s;function l(p){return!!(p&&ge(p)==="object"&&"token"in p)}n.isInjectOption=l;function u(p){return!!(p&&ge(p)==="object"&&"token"in p&&"named"in p)}n.isNamedToken=u;function h(p){return n.isDefinedToken(p)&&p.multiple}n.isMultipleEnabled=h})(De||(De={}));function _t(n){return n.inSingletonScope()}function N(n){return n.inTransientScope()}function ze(n,r){return r.lifecycle===ce.Lifecycle.singleton?_t(n):N(n)}function Ze(n,r){n.whenTargetNamed(we(r))}function xt(n,r){return r.container.bind(Bn(n))}function Zt(n,r){var o=r.container.parent,s=o&&o.isBound(Bn(n));return r.container.isBound(Bn(n))&&!s?r.container.rebind(Bn(n)):r.container.bind(Bn(n))}function Kn(n){return n&&ge(n)==="object"&&"container"in n&&"inversify"in n}function we(n){return De.isDefinedToken(n)?n.symbol:n}function Bn(n){return De.isDefinedToken(n)?n.symbol:n}var Fr=new U.W2;function nn(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=(0,U.b2)();return function(o){Reflect.defineMetadata(ce.ClassOptionSymbol,Ce(Ce({},n),{},{target:o}),o),r(o)}}function Dn(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return nn(Ce(Ce({},n),{},{lifecycle:ce.Lifecycle.singleton}))}function yn(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return nn(Ce(Ce({},n),{},{lifecycle:ce.Lifecycle.transient}))}function Rt(n){return(0,U.f3)(Bn(n))}function Sr(n){return(0,U.t6)(we(n))}var pr=Symbol("SyringeOptionSymbol"),_n=function(r,o){Reflect.defineMetadata(pr,r,o)};function gr(n){var r=De.maybeArrayToArray(n.token),o=De.maybeArrayToArray(n.useClass),s=De.maybeArrayToArray(n.useDynamic),l=De.maybeArrayToArray(n.useFactory),u=De.maybeArrayToArray(n.contrib),h=n.lifecycle||ce.Lifecycle.transient,p={token:r,useClass:o,lifecycle:u.length>0?ce.Lifecycle.singleton:h,contrib:u,useDynamic:s,useFactory:l};return"useValue"in n&&(p.useValue=n.useValue),p}var Nn=function(){function n(r,o,s){Me(this,n),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.context=void 0,this.mutiple=void 0,this.context=r,this.token=o,this.option=s,this.rawToken=De.isNamedToken(o)?o.token:o,this.named=De.isNamedToken(o)?o.named:void 0,this.mutiple=!!this.named||De.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return ee(n,[{key:"resolve",value:function(){var o=this,s=this.context;!Kn(s)||(this.mutiple?this.resolveMutilple(s):(this.resolveMono(s),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach(function(l){De.isMultipleEnabled(l)?xt(l,s).toService(o.generalToken):Zt(l,s).toService(o.generalToken)})))}},{key:"resolveMono",value:function(o){var s=this;if("useValue"in this.option)return Zt(this.generalToken,o).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var l=this.option.useDynamic[this.option.useDynamic.length-1];return ze(Zt(this.generalToken,o).toDynamicValue(function(){return l({container:s.context})}),this.option)}if(this.option.useFactory.length>0){var u=this.option.useFactory[this.option.useFactory.length-1];return Zt(this.generalToken,o).toFactory(function(){return u({container:s.context})})}if(this.option.useClass.length>0){var h=this.option.useClass[this.option.useClass.length-1];return ze(Zt(this.generalToken,o).to(h),this.option)}}},{key:"resolveMutilple",value:function(o){var s=this,l=this.option.useClass.map(function(g){return ze(xt(s.generalToken,o).to(g),s.option)}),u=this.option.useDynamic.map(function(g){return ze(xt(s.generalToken,o).toDynamicValue(function(){return g({container:s.context})}),s.option)}),h=this.option.useFactory.map(function(g){return xt(s.generalToken,o).toFactory(function(){return g({container:s.context})})}),p="useValue"in this.option?xt(this.generalToken,o).toConstantValue(this.option.useValue):void 0;this.named&&(l.forEach(function(g){return s.named&&Ze(g,s.named)}),u.forEach(function(g){return s.named&&Ze(g,s.named)}),h.forEach(function(g){return s.named&&Ze(g,s.named)}),p&&Ze(p,this.named))}}],[{key:"resolveTarget",value:function(o,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};try{try{var u=Reflect.getMetadata(pr,s);u&&n.resolveOption(o,u)}catch{}if(De.isClass(s))if(!l.useClass)l.useClass=[s];else{var h=De.maybeArrayToArray(l.useClass);h.unshift(s),l.useClass=h}var p;try{p=Reflect.getMetadata(ce.ClassOptionSymbol,s)}catch{}if(p=Ce(Ce({},p||{}),l),!p.token)p.token=[s];else{var g=De.maybeArrayToArray(p.token);g.unshift(s),p.token=g}n.resolveOption(o,p)}catch{}}},{key:"resolveOption",value:function(o,s){var l=gr(Ce(Ce({},n.globalConfig),s));l.useClass.length===0&&l.useDynamic.length===0&&l.useFactory.length===0&&!("useValue"in l)||l.token.forEach(function(u){var h=new n(o,u,Ce({},l));h.resolve()})}}]),n}();Nn.globalConfig=ce.DefaultOption;var yr=function(){function n(r){Me(this,n),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,r?this.container=r:this.container=new U.W2}return ee(n,[{key:"load",value:function(o,s){(s||!this.loadedModules.includes(o.id))&&(o.registry(this.register.bind(this),this.resolveContext()),this.loadedModules.push(o.id))}},{key:"remove",value:function(o){return this.container.unbind(Bn(o))}},{key:"get",value:function(o){return this.container.get(Bn(o))}},{key:"getNamed",value:function(o,s){return this.container.getNamed(Bn(o),we(s))}},{key:"getAll",value:function(o){return this.container.getAll(Bn(o))}},{key:"getAllNamed",value:function(o,s){return this.container.getAllNamed(Bn(o),we(s))}},{key:"isBound",value:function(o){return this.container.isBound(Bn(o))}},{key:"isBoundNamed",value:function(o,s){return this.container.isBoundNamed(Bn(o),we(s))}},{key:"createChild",value:function(){var o=this.container.createChild(),s=new n(o);return s.parent=this,s}},{key:"register",value:function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};De.isInjectOption(o)?Nn.resolveOption(this,o):Nn.resolveTarget(this,o,s)}},{key:"resolveContext",value:function(){return{container:this}}}],[{key:"config",value:function(o){Nn.globalConfig=o}}]),n}(),Or=new yr(Fr),Co=Or.register.bind(Or),_r=ce.defineToken("ContributionProvider"),Mi=function(){function n(r,o,s){Me(this,n),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=o,this.serviceIdentifier=r,s&&(this.option=Ce(Ce({},this.option),s))}return ee(n,[{key:"setServices",value:function(o){for(var s=[],l=this.container;l;){if(l.isBound(this.serviceIdentifier)){var u=l.getAll(this.serviceIdentifier);s.push.apply(s,Ae(u))}l=o?l.parent:void 0}return s}},{key:"getContributions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=Ce(Ce({},this.option),o),l=s.cache,u=s.recursive;return(!l||this.services===void 0)&&(this.services=this.setServices(!!u)),this.services}}]),n}();function Xi(n,r){return{token:{token:_r,named:n},useDynamic:function(s){return new Mi(n,s.container,r)},lifecycle:ce.Lifecycle.singleton}}function ms(n,r,o){n({token:{token:_r,named:r},useDynamic:function(l){return new Mi(r,l.container,o)},lifecycle:ce.Lifecycle.singleton})}var Xs=function(){function n(r){Me(this,n),this.id=void 0,this.baseRegistry=void 0,this.optionCollection=void 0,n.moduleId+=1,this.id=n.moduleId,this.baseRegistry=r}return ee(n,[{key:"registry",get:function(){var o=this;return function(s,l){o.baseRegistry&&o.baseRegistry(s,l),o.optionCollection&&o.optionCollection.forEach(function(u){return s(u)})}}},{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var o=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return l.forEach(function(h){return o.options.push(h)}),this}},{key:"contribution",value:function(){for(var o=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return l.forEach(function(h){return o.options.push(Xi(h))}),this}}]),n}();Xs.moduleId=0;function Yi(n){return new Xs(n)}var Bi=function(r){return function(o,s,l){Sr(r)(o,s,l),Rt(_r)(o,s,l)}},Qr;(function(n){n.Provider=_r,n.register=ms})(Qr||(Qr={}));var fo;(function(n){let r;(function(s){s.TOP="top",s.BOTTOM="bottom",s.RIGHT="right",s.LEFT="left"})(r=n.AnchorGroup||(n.AnchorGroup={}));let o;(function(s){s.INPUT="input",s.OUTPUT="output"})(o=n.AnchorType||(n.AnchorType={}))})(fo||(fo={}));var Qn=P(18698),Hr=P.n(Qn);var Ra=function(r,o){return Ra=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)l.hasOwnProperty(u)&&(s[u]=l[u])},Ra(r,o)};function fe(n,r){Ra(n,r);function o(){this.constructor=n}n.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)}var Yc=function(){return Yc=Object.assign||function(o){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(o[h]=s[h])}return o},Yc.apply(this,arguments)};function Bu(n,r){var o={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&r.indexOf(s)<0&&(o[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(n);l<s.length;l++)r.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(n,s[l])&&(o[s[l]]=n[s[l]]);return o}function vt(n,r,o,s){var l=arguments.length,u=l<3?r:s===null?s=Object.getOwnPropertyDescriptor(r,o):s,h;if((typeof Reflect>"u"?"undefined":Hr()(Reflect))==="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,r,o,s);else for(var p=n.length-1;p>=0;p--)(h=n[p])&&(u=(l<3?h(u):l>3?h(r,o,u):h(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u}function Tl(n,r){return function(o,s){r(o,s,n)}}function ct(n,r){if((typeof Reflect>"u"?"undefined":Hr()(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,r)}function Ee(n,r,o,s){function l(u){return u instanceof o?u:new o(function(h){h(u)})}return new(o||(o=Promise))(function(u,h){function p(b){try{v(s.next(b))}catch(w){h(w)}}function g(b){try{v(s.throw(b))}catch(w){h(w)}}function v(b){b.done?u(b.value):l(b.value).then(p,g)}v((s=s.apply(n,r||[])).next())})}function Ho(n,r){var o={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,l,u,h;return h={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function p(v){return function(b){return g([v,b])}}function g(v){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,l&&(u=v[0]&2?l.return:v[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,v[1])).done)return u;switch(l=0,u&&(v=[v[0]&2,u.value]),v[0]){case 0:case 1:u=v;break;case 4:return o.label++,{value:v[1],done:!1};case 5:o.label++,l=v[1],v=[0];continue;case 7:v=o.ops.pop(),o.trys.pop();continue;default:if(u=o.trys,!(u=u.length>0&&u[u.length-1])&&(v[0]===6||v[0]===2)){o=0;continue}if(v[0]===3&&(!u||v[1]>u[0]&&v[1]<u[3])){o.label=v[1];break}if(v[0]===6&&o.label<u[1]){o.label=u[1],u=v;break}if(u&&o.label<u[2]){o.label=u[2],o.ops.push(v);break}u[2]&&o.ops.pop(),o.trys.pop();continue}v=r.call(n,o)}catch(b){v=[6,b],l=0}finally{s=u=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}function ya(n,r,o,s){s===void 0&&(s=o),n[s]=r[o]}function Ys(n,r){for(var o in n)o!=="default"&&!r.hasOwnProperty(o)&&(r[o]=n[o])}function qo(n){var r=typeof Symbol=="function"&&Symbol.iterator,o=r&&n[r],s=0;if(o)return o.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function la(n,r){var o=typeof Symbol=="function"&&n[Symbol.iterator];if(!o)return n;var s=o.call(n),l,u=[],h;try{for(;(r===void 0||r-- >0)&&!(l=s.next()).done;)u.push(l.value)}catch(p){h={error:p}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(h)throw h.error}}return u}function Ss(){for(var n=[],r=0;r<arguments.length;r++)n=n.concat(la(arguments[r]));return n}function Jo(){for(var n=0,r=0,o=arguments.length;r<o;r++)n+=arguments[r].length;for(var s=Array(n),l=0,r=0;r<o;r++)for(var u=arguments[r],h=0,p=u.length;h<p;h++,l++)s[l]=u[h];return s}function Ks(n){return this instanceof Ks?(this.v=n,this):new Ks(n)}function ac(n,r,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=o.apply(n,r||[]),l,u=[];return l={},h("next"),h("throw"),h("return"),l[Symbol.asyncIterator]=function(){return this},l;function h(A){s[A]&&(l[A]=function(O){return new Promise(function(D,_){u.push([A,O,D,_])>1||p(A,O)})})}function p(A,O){try{g(s[A](O))}catch(D){w(u[0][3],D)}}function g(A){A.value instanceof Ks?Promise.resolve(A.value.v).then(v,b):w(u[0][2],A)}function v(A){p("next",A)}function b(A){p("throw",A)}function w(A,O){A(O),u.shift(),u.length&&p(u[0][0],u[0][1])}}function lc(n){var r,o;return r={},s("next"),s("throw",function(l){throw l}),s("return"),r[Symbol.iterator]=function(){return this},r;function s(l,u){r[l]=n[l]?function(h){return(o=!o)?{value:Ks(n[l](h)),done:l==="return"}:u?u(h):h}:u}}function Qo(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n[Symbol.asyncIterator],o;return r?r.call(n):(n=typeof qo=="function"?qo(n):n[Symbol.iterator](),o={},s("next"),s("throw"),s("return"),o[Symbol.asyncIterator]=function(){return this},o);function s(u){o[u]=n[u]&&function(h){return new Promise(function(p,g){h=n[u](h),l(p,g,h.done,h.value)})}}function l(u,h,p,g){Promise.resolve(g).then(function(v){u({value:v,done:p})},h)}}function es(n,r){return Object.defineProperty?Object.defineProperty(n,"raw",{value:r}):n.raw=r,n}function zu(n){if(n&&n.__esModule)return n;var r={};if(n!=null)for(var o in n)Object.hasOwnProperty.call(n,o)&&(r[o]=n[o]);return r.default=n,r}function qs(n){return n&&n.__esModule?n:{default:n}}function ef(n,r){if(!r.has(n))throw new TypeError("attempted to get private field on non-instance");return r.get(n)}function Fp(n,r,o){if(!r.has(n))throw new TypeError("attempted to set private field on non-instance");return r.set(n,o),o}var F=P(67294),No=P(94184),Ii=P.n(No),Zg=P(28660),Yr=P(46754),ca=P(73935),Uu;(function(n){function r(s){return!!s&&typeof s=="object"&&"dispose"in s&&typeof s.dispose=="function"}n.is=r;function o(s){return{dispose:s}}n.create=o,n.NONE=o(()=>{})})(Uu||(Uu={}));let tf;var nf;(function(n){n.None=()=>Uu.NONE;function r(o,s){return(l,u)=>o(h=>l.call(u,s(h)),void 0)}n.map=r})(nf||(nf={})),tf=Symbol.iterator;class rf{constructor(r=!1){this.mono=void 0,this._callbacks=void 0,this.mono=r}get callbacks(){return this._callbacks||(this._callbacks=[]),this._callbacks}get length(){return this.callbacks.length}add(r,o=void 0){this.callbacks.push([r,o])}remove(r,o=void 0){if(this.isEmpty())return;let s=!1;for(let l=0;l<this.length;l+=1)if(this.callbacks[l][0]===r){if(this.callbacks[l][1]===o){this.callbacks.splice(l,1);return}s=!0}if(s)throw new Error("You should remove it with the same context you add it")}[tf](){return this.isEmpty()?[][Symbol.iterator]():this.callbacks.slice(0).map(o=>(...s)=>o[0].apply(o[1],s))[Symbol.iterator]()}invoke(...r){const o=[];for(const s of this)try{o.push(s(...r))}catch(l){console.error(l)}return o}isEmpty(){return this.callbacks.length===0}dispose(){this._callbacks=void 0}}class ba{constructor(r={}){this.options=void 0,this._event=void 0,this._callbacks=void 0,this.disposed=!1,this.options=r}get callbacks(){return this._callbacks||(this._callbacks=new rf),this._callbacks}get event(){return this._event||(this._event=(r,o)=>{this.options.onFirstListenerAdd&&this.callbacks.isEmpty()&&this.options.onFirstListenerAdd(this),this.callbacks.add(r,o);const s={dispose:()=>{s.dispose=ba.noop,this.disposed||(this.callbacks.remove(r,o),s.dispose=ba.noop,this.options.onLastListenerRemove&&this.callbacks.isEmpty()&&this.options.onLastListenerRemove(this))}};return s}),this._event}fire(r){!this._callbacks||this.callbacks.invoke(r)}async sequence(r){for(const o of this.callbacks)if(!await r(o))break}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0),this.disposed=!0}}ba.noop=()=>{};var Rn;(function(n){function r(s){return!!s&&typeof s=="object"&&"dispose"in s&&typeof s.dispose=="function"}n.is=r;function o(s){return{dispose:s}}n.create=o,n.NULL=o(()=>{})})(Rn||(Rn={}));class qn{constructor(...r){this.disposables=[],this.onDisposeEmitter=new ba,this.disposingElements=!1,r.forEach(o=>this.push(o))}get onDispose(){return this.onDisposeEmitter.event}checkDisposed(){this.disposed&&!this.disposingElements&&(this.onDisposeEmitter.fire(void 0),this.onDisposeEmitter.dispose())}get disposed(){return this.disposables.length===0}dispose(){return Ee(this,void 0,void 0,function*(){if(!(this.disposed||this.disposingElements)){for(this.disposingElements=!0;!this.disposed;)try{yield this.disposables.pop().dispose()}catch(r){console.error(r)}this.disposingElements=!1,this.checkDisposed()}})}push(r){const{disposables:o}=this;o.push(r);const s=r.dispose.bind(r),l=Rn.create(()=>{const u=o.indexOf(r);u!==-1&&o.splice(u,1),this.checkDisposed()});return r.dispose=()=>{l.dispose(),s()},l}pushAll(r){return r.map(o=>this.push(o))}}class As{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise((r,o)=>{this.resolve=(...s)=>{this.isResolved=!0,r(...s)},this.reject=(...s)=>{this.isRejected=!0,o(...s)}})}}const Ml="X6_NODE_PORTAL_NODE_VIEW",of="xflow",Vu=.01,Ia=1.5,Pl="XFLOW_DEFAULT_NODE",ju="XFLOW_DEFAULT_GROUP_NODE",sf="XFLOW_DEFAULT_EDGE",cc="XFLOW_COPY_ITEMS",Hd={width:180,height:36};function Ol(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const r=Math.random()*16|0;return(n=="x"?r:r&3|8).toString(16)})}var $d=P(18267),Wd=P(18095);const Kc=F.createContext(null);Kc.displayName="XFlowAppContext";const po=()=>{const n=F.useContext(Kc);return n&&n.getApp?n.getApp():null},Gp=()=>F.useContext(Kc);class Zd{constructor(r=!1){this.cache=null,this.setApp=o=>{this.cache=o,this.onAppChangeCallback&&this.onAppChangeCallback(o)},this.isUserDefined=()=>this.isUserDefinedFlag,this.getApp=()=>this.cache,this.onAppChange=o=>{this.onAppChangeCallback=o},this.dispose=()=>{this.cache=null},this.isUserDefinedFlag=r}}const Xd=n=>{const r=Gp(),[,o]=F.useState(null),s=F.useMemo(()=>r&&r.isUserDefined()?r:new Zd(!1),[]);return s.isUserDefined()||s.onAppChange(()=>o(0)),F.useEffect(()=>{n.app&&s.setApp(n.app)},[n.app]),s.isUserDefined()?F.createElement(F.Fragment,null,n.children):F.createElement(Kc.Provider,{value:Object.assign({},s)},n.children)};Xd.displayName="XFlowAppInternalProvider";const af=({children:n})=>{const[,r]=F.useState(null),o=F.useMemo(()=>new Zd(!0),[]);return o.onAppChange(()=>r(0)),F.createElement(Kc.Provider,{value:Object.assign({},o)},n)};af.displayName="XFlowAppProvider";var di;(function(n){const r="\u8282\u70B9\u64CD\u4F5C";n.ADD_NODE={id:"xflow:add-node",label:"\u6DFB\u52A0\u8282\u70B9",category:r},n.DEL_NODE={id:"xflow:del-node",label:"\u5220\u9664\u8282\u70B9",category:r},n.UPDATE_NODE_PORT={id:"xflow:update-node-port",label:"\u5220\u9664\u8FDE\u63A5\u6869",category:r},n.UPDATE_NODE={id:"xflow:update-node",label:"\u66F4\u65B0\u8282\u70B9",category:r},n.HIGHLIGHT_NODE={id:"xflow:highlight-node",label:"\u9AD8\u4EAE\u8282\u70B9",category:r},n.SELECT_NODE={id:"xflow:select-node",label:"\u9009\u4E2D\u8282\u70B9",category:r},n.MOVE_NODE={id:"xflow:move-node",label:"Move Node",category:r},n.CENTER_NODE={id:"xflow:center-node",label:"\u5C45\u4E2D\u8282\u70B9",category:r},n.FRONT_NODE={id:"xflow:front-node",label:"\u524D\u7F6E\u8282\u70B9",category:r},n.BACK_NODE={id:"xflow:back-node",label:"\u540E\u7F6E\u8282\u70B9",category:r}})(di||(di={}));var zi;(function(n){const r="\u8FB9\u64CD\u4F5C";n.ADD_EDGE={id:"xflow:add-edge",label:"\u6DFB\u52A0\u8FB9",category:r},n.DEL_EDGE={id:"xflow:del-edge",label:"\u5220\u9664\u8FB9",category:r},n.UPDATE_EDGE={id:"xflow:update-edge",label:"\u66F4\u65B0\u8FB9",category:r},n.HIGHLIGHT_EDGE={id:"xflow:highlight-edge",label:"\u9AD8\u4EAE\u8FB9",category:r},n.FRONT_EDGE={id:"xflow:front-edge",label:"\u524D\u7F6E\u53D8",category:r},n.BACK_EDGE={id:"xflow:back-edge",label:"\u540E\u7F6E\u8FB9",category:r}})(zi||(zi={}));var rr;(function(n){const r="\u753B\u5E03\u64CD\u4F5C";n.LOAD_META={id:"xflow:load-meta",label:"\u83B7\u53D6\u5143\u6570\u636E",category:r},n.LOAD_DATA={id:"xflow:load-data",label:"\u83B7\u53D6\u56FE\u6570\u636E",category:r},n.SAVE_GRAPH_DATA={id:"xflow:save-graph-data",label:"\u4FDD\u5B58",category:r},n.GRAPH_LAYOUT={id:"xflow:layout",label:"\u8BA1\u7B97\u5E03\u5C40",category:r},n.GRAPH_RENDER={id:"xflow:graph-render",label:"\u6E32\u67D3\u753B\u5E03",category:r},n.UNDO_CMD={id:"xflow:undo-cmd",label:"\u64A4\u9500",category:r},n.REDO_CMD={id:"xflow:redo-cmd",label:"\u91CD\u505A",category:r},n.GRAPH_INSTANCE_COMMAND={id:"xflow:graph-instacne-cmd",label:"Graph\u901A\u7528Command",category:r},n.GRAPH_ZOOM={id:"xflow:graph-zoom",label:"\u7F29\u653E\u753B\u5E03",category:r},n.GRAPH_FULLSCREEN={id:"xflow:graph-fullscreen",label:"\u5168\u5C4F",category:r},n.GRAPH_RESIZE={id:"xflow:graph-resize",label:"\u8C03\u6574\u7A97\u53E3\u5927\u5C0F",category:r},n.GRAPH_COPY={id:"xflow:graph-copy-selection",label:"\u590D\u5236",category:r},n.GRAPH_PASTE={id:"xflow:graph-paste-selection",label:"\u7C98\u8D34",category:r},n.GRAPH_TOGGLE_MULTI_SELECT={id:"xflow:graph-toggle-multi-select",label:"\u542F\u7528\u6846\u9009",category:r},n.GRAPH_ADD_TOOL={id:"xflow:add-tool",label:"\u6DFB\u52A0\u5DE5\u5177",category:r},n.GRAPH_DEL_TOOL={id:"xflow:del-tool",label:"\u5220\u9664\u5DE5\u5177",category:r},n.GRAPH_HISTORY_UNDO={id:"xflow:history-undo",label:"history undo",category:r},n.GRAPH_HISTORY_REDO={id:"xflow:history-redo",label:"history redo",category:r},n.GRAPH_HISTORY_RESET={id:"xflow:history-reset",label:"history reset",category:r},n.GRAPH_HISTORY_TOGGLE={id:"xflow:history-toggle",label:"history toggle",category:r}})(rr||(rr={}));var Ja;(function(n){const r="\u72B6\u6001\u64CD\u4F5C";n.UPDATE_MODEL={id:"xflow:update-model",label:"\u8BBE\u7F6E\u72B6\u6001\u503C",category:r}})(Ja||(Ja={}));var to;(function(n){const r="\u7FA4\u7EC4\u64CD\u4F5C";n.INIT_GROUP={id:"xflow:init-group",label:"\u521D\u59CB\u5316\u7FA4\u7EC4",category:r},n.ADD_GROUP={id:"xflow:add-group",label:"\u65B0\u5EFA\u7FA4\u7EC4",category:r},n.DEL_GROUP={id:"xflow:del-group",label:"\u89E3\u6563\u7FA4\u7EC4",category:r},n.COLLAPSE_GROUP={id:"xflow:collapse-group",label:"\u6298\u53E0\u7FA4\u7EC4",category:r}})(to||(to={}));const lf=n=>{const{cell:r}=n,o=po(),s=n.data.isCollapsed||!1,l=h=>{h.preventDefault(),o.executeCommand(to.COLLAPSE_GROUP.id,{nodeId:r.id,isCollapsed:!1})},u=h=>{h.preventDefault(),o.executeCommand(to.COLLAPSE_GROUP.id,{nodeId:r.id,isCollapsed:!0,gap:3})};return F.createElement("div",{className:"xflow-default-group-node"},F.createElement("div",{className:"xflow-group-header"},F.createElement("div",{className:"header-left"},n.data.label),F.createElement("div",{className:"header-right"},s&&F.createElement($d.Z,{onClick:l}),!s&&F.createElement(Wd.Z,{onClick:u}))))};lf.displayName="XFlowDefaultGroupNode";var $u=P(32779),Wu=P(73218),cf=P(15873),Yd=P(57119),Dl=P(68628),Kd=P(73888);const uf={fontSize:"16px",color:"#3057e3"};var ko;(function(n){n.SUCCESS="success",n.PROCESSING="processing",n.ERROR="error",n.DEFAULT="default",n.WARNING="warning"})(ko||(ko={}));const df=n=>{if(n.hide)return null;switch(n.status){case ko.PROCESSING:return F.createElement($u.Z,{spin:!0,style:{color:"#c1cdf7",fontSize:"16px"}});case ko.ERROR:return F.createElement(Wu.Z,{style:{color:"#ff4d4f",fontSize:"16px"}});case ko.SUCCESS:return F.createElement(cf.Z,{style:{color:"#39ca74cc",fontSize:"16px"}});case ko.WARNING:return F.createElement(Yd.Z,{style:{color:"#faad14",fontSize:"16px"}});case ko.DEFAULT:return F.createElement(Dl.Z,{style:{color:"#d9d9d9",fontSize:"16px"}});default:return null}},uc=n=>{const r=F.isValidElement(n.data.icon)?n.data.icon:F.createElement(Kd.Z,{style:uf});return F.createElement("div",{className:`xflow-default-node ${n.isNodeTreePanel?"panel-node":""}`},F.createElement("span",{className:"icon"},r),F.createElement("span",{className:"label"},n.data.label),F.createElement("span",{className:"status"},F.createElement(df,{status:n.data&&n.data.status,hide:n.isNodeTreePanel})))};uc.displayName="XFlowDefaultNode";var dc;(function(n){n.CONFIG_TYPE="GraphConfig",n.defaultNodeTypeParser=r=>r.renderKey,n.defaultEdgeTypeParser=r=>r.renderKey,n.defaultNodeMapValue=[[Pl,uc],[ju,lf]]})(dc||(dc={}));class _l{constructor(){this.CONFIG_TYPE=dc.CONFIG_TYPE,this.x6Options=new As,this.rootContainer=new As,this.graphContainer=new As,this.nodeRender=new Map(dc.defaultNodeMapValue),this.edgeRender=new Map,this.nodeTypeParser=dc.defaultNodeTypeParser,this.edgeTypeParser=dc.defaultEdgeTypeParser,this.events=[],this.mergeX6Config=r=>Ee(this,void 0,void 0,function*(){const o=yield this.getX6Config();return Object.assign(o,r)}),this.getX6Config=()=>Ee(this,void 0,void 0,function*(){return yield this.x6Options.promise}),this.setX6Config=r=>{var o;const s=this.getDefaultGraphOptions();(o=this.x6Options)===null||o===void 0||o.resolve(Object.assign(Object.assign({},s),r))},this.setAppContainer=r=>{this.appContainer=r},this.setRootContainer=r=>{r&&(this===null||this===void 0||this.rootContainer.resolve(r))},this.setGraphContainer=r=>{var o;r&&((o=this.graphContainer)===null||o===void 0||o.resolve(r))},this.setEvents=r=>{this.events=r},this.setDefaultNodeRender=r=>{this.nodeRender.set(Pl,r)},this.setDefaultEdgeRender=r=>{this.edgeRender.set(sf,r)},this.setNodeRender=(r,o)=>{this.nodeRender.set(r,o)},this.setEdgeRender=(r,o)=>{this.edgeRender.set(r,o)},this.setNodeTypeParser=r=>{this.nodeTypeParser=r},this.setEdgeTypeParser=r=>{this.edgeTypeParser=r},this.getConfig=()=>Ee(this,void 0,void 0,function*(){const[r,o,s]=yield Promise.all([this.rootContainer.promise,this.graphContainer.promise,this.x6Options.promise]);return{xflowInstanceId:this.xflowInstanceId,graphId:this.graphId,nodeViewId:this.graphId,appContainer:this.appContainer,rootContainer:r,graphContainer:o,x6Options:s,events:this.events,nodeRender:this.nodeRender,edgeRender:this.edgeRender,nodeTypeParser:this.nodeTypeParser,edgeTypeParser:this.edgeTypeParser}}),this.getDefaultGraphOptions=()=>({rotating:!1,resizing:!1,connecting:{snap:!0,dangling:!1,highlight:!1,connectionPoint:"rect",router:{name:"er"},connector:{name:"rounded",args:{radius:15}}},background:{},grid:{visible:!0},selecting:{strict:!0,enabled:!0,multiple:!0,selectCellOnMoved:!0,showNodeSelectionBox:!1,rubberEdge:!0,rubberNode:!0,movable:!0},snapline:{enabled:!1},history:{enabled:!1},clipboard:{enabled:!0,useLocalStorage:!0},scroller:{enabled:!1},mousewheel:{enabled:!0,minScale:Vu,maxScale:Ia,factor:1.1,modifiers:["ctrl","meta"]},panning:{enabled:!0},scaling:{min:Vu,max:Ia},keyboard:{enabled:!0},interacting:{nodeMovable:!0,edgeLabelMovable:!1},async:!1}),this.dispose=()=>{this.rootContainer=new As,this.graphContainer=new As,this.x6Options=new As},this.graphId=Ol()}}const no=Symbol("IGraphOptionProvider"),wo=(n,r)=>{n(no,{lifecycle:ce.Lifecycle.singleton,useDynamic:()=>({getOptions:()=>Ee(void 0,void 0,void 0,function*(){return r.getConfig()})})})},Nl=n=>r=>{const o=F.useMemo(()=>({getValue:()=>({})}),[]);return o.getValue=()=>r,F.useMemo(()=>{const l=new _l;return n(l,o),l},[o])};var Js=function(){return Array.isArray||function(n){return n&&typeof n.length=="number"}}();function qd(n){return n!==null&&typeof n=="object"}function qc(n){return typeof n=="function"}var hc=function(){function n(r){return Error.call(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(o,s){return s+1+") "+o.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r,this}return n.prototype=Object.create(Error.prototype),n}(),Jc=hc,Qa=function(){function n(r){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,r&&(this._ctorUnsubscribe=!0,this._unsubscribe=r)}return n.prototype.unsubscribe=function(){var r;if(!this.closed){var o=this,s=o._parentOrParents,l=o._ctorUnsubscribe,u=o._unsubscribe,h=o._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof n)s.remove(this);else if(s!==null)for(var p=0;p<s.length;++p){var g=s[p];g.remove(this)}if(qc(u)){l&&(this._unsubscribe=void 0);try{u.call(this)}catch(w){r=w instanceof Jc?Zu(w.errors):[w]}}if(Js(h))for(var p=-1,v=h.length;++p<v;){var b=h[p];if(qd(b))try{b.unsubscribe()}catch(A){r=r||[],A instanceof Jc?r=r.concat(Zu(A.errors)):r.push(A)}}if(r)throw new Jc(r)}},n.prototype.add=function(r){var o=r;if(!r)return n.EMPTY;switch(typeof r){case"function":o=new n(r);case"object":if(o===this||o.closed||typeof o.unsubscribe!="function")return o;if(this.closed)return o.unsubscribe(),o;if(!(o instanceof n)){var s=o;o=new n,o._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+r+" added to Subscription.")}var l=o._parentOrParents;if(l===null)o._parentOrParents=this;else if(l instanceof n){if(l===this)return o;o._parentOrParents=[l,this]}else if(l.indexOf(this)===-1)l.push(this);else return o;var u=this._subscriptions;return u===null?this._subscriptions=[o]:u.push(o),o},n.prototype.remove=function(r){var o=this._subscriptions;if(o){var s=o.indexOf(r);s!==-1&&o.splice(s,1)}},n.EMPTY=function(r){return r.closed=!0,r}(new n),n}();function Zu(n){return n.reduce(function(r,o){return r.concat(o instanceof Jc?o.errors:o)},[])}var hf=function(n){fe(r,n);function r(o,s){return n.call(this)||this}return r.prototype.schedule=function(o,s){return s===void 0&&(s=0),this},r}(Qa),Bp=function(n){fe(r,n);function r(o,s){var l=n.call(this,o,s)||this;return l.scheduler=o,l.work=s,l.pending=!1,l}return r.prototype.schedule=function(o,s){if(s===void 0&&(s=0),this.closed)return this;this.state=o;var l=this.id,u=this.scheduler;return l!=null&&(this.id=this.recycleAsyncId(u,l,s)),this.pending=!0,this.delay=s,this.id=this.id||this.requestAsyncId(u,this.id,s),this},r.prototype.requestAsyncId=function(o,s,l){return l===void 0&&(l=0),setInterval(o.flush.bind(o,this),l)},r.prototype.recycleAsyncId=function(o,s,l){if(l===void 0&&(l=0),l!==null&&this.delay===l&&this.pending===!1)return s;clearInterval(s)},r.prototype.execute=function(o,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var l=this._execute(o,s);if(l)return l;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(o,s){var l=!1,u=void 0;try{this.work(o)}catch(h){l=!0,u=!!h&&h||new Error(h)}if(l)return this.unsubscribe(),u},r.prototype._unsubscribe=function(){var o=this.id,s=this.scheduler,l=s.actions,u=l.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,u!==-1&&l.splice(u,1),o!=null&&(this.id=this.recycleAsyncId(s,o,null)),this.delay=null},r}(hf),ff=function(){function n(r,o){o===void 0&&(o=n.now),this.SchedulerAction=r,this.now=o}return n.prototype.schedule=function(r,o,s){return o===void 0&&(o=0),new this.SchedulerAction(this,r).schedule(s,o)},n.now=function(){return Date.now()},n}(),Jd=function(n){fe(r,n);function r(o,s){s===void 0&&(s=ff.now);var l=n.call(this,o,function(){return r.delegate&&r.delegate!==l?r.delegate.now():s()})||this;return l.actions=[],l.active=!1,l.scheduled=void 0,l}return r.prototype.schedule=function(o,s,l){return s===void 0&&(s=0),r.delegate&&r.delegate!==this?r.delegate.schedule(o,s,l):n.prototype.schedule.call(this,o,s,l)},r.prototype.flush=function(o){var s=this.actions;if(this.active){s.push(o);return}var l;this.active=!0;do if(l=o.execute(o.state,o.delay))break;while(o=s.shift());if(this.active=!1,l){for(;o=s.shift();)o.unsubscribe();throw l}},r}(ff),pf=new Jd(Bp),zp=pf,Qd=!1,ua={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){var r=new Error;""+r.stack}Qd=n},get useDeprecatedSynchronousErrorHandling(){return Qd}};function Qs(n){setTimeout(function(){throw n},0)}var fc={closed:!0,next:function(n){},error:function(n){if(ua.useDeprecatedSynchronousErrorHandling)throw n;Qs(n)},complete:function(){}},Xu=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Yu=null,Ki=function(n){fe(r,n);function r(o,s,l){var u=n.call(this)||this;switch(u.syncErrorValue=null,u.syncErrorThrown=!1,u.syncErrorThrowable=!1,u.isStopped=!1,arguments.length){case 0:u.destination=fc;break;case 1:if(!o){u.destination=fc;break}if(typeof o=="object"){o instanceof r?(u.syncErrorThrowable=o.syncErrorThrowable,u.destination=o,o.add(u)):(u.syncErrorThrowable=!0,u.destination=new Ku(u,o));break}default:u.syncErrorThrowable=!0,u.destination=new Ku(u,o,s,l);break}return u}return r.prototype[Xu]=function(){return this},r.create=function(o,s,l){var u=new r(o,s,l);return u.syncErrorThrowable=!1,u},r.prototype.next=function(o){this.isStopped||this._next(o)},r.prototype.error=function(o){this.isStopped||(this.isStopped=!0,this._error(o))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this))},r.prototype._next=function(o){this.destination.next(o)},r.prototype._error=function(o){this.destination.error(o),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var o=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=o,this},r}(Qa),Ku=function(n){fe(r,n);function r(o,s,l,u){var h=n.call(this)||this;h._parentSubscriber=o;var p,g=h;return qc(s)?p=s:s&&(p=s.next,l=s.error,u=s.complete,s!==fc&&(g=Object.create(s),qc(g.unsubscribe)&&h.add(g.unsubscribe.bind(g)),g.unsubscribe=h.unsubscribe.bind(h))),h._context=g,h._next=p,h._error=l,h._complete=u,h}return r.prototype.next=function(o){if(!this.isStopped&&this._next){var s=this._parentSubscriber;!ua.useDeprecatedSynchronousErrorHandling||!s.syncErrorThrowable?this.__tryOrUnsub(this._next,o):this.__tryOrSetError(s,this._next,o)&&this.unsubscribe()}},r.prototype.error=function(o){if(!this.isStopped){var s=this._parentSubscriber,l=ua.useDeprecatedSynchronousErrorHandling;if(this._error)!l||!s.syncErrorThrowable?(this.__tryOrUnsub(this._error,o),this.unsubscribe()):(this.__tryOrSetError(s,this._error,o),this.unsubscribe());else if(s.syncErrorThrowable)l?(s.syncErrorValue=o,s.syncErrorThrown=!0):Qs(o),this.unsubscribe();else{if(this.unsubscribe(),l)throw o;Qs(o)}}},r.prototype.complete=function(){var o=this;if(!this.isStopped){var s=this._parentSubscriber;if(this._complete){var l=function(){return o._complete.call(o._context)};!ua.useDeprecatedSynchronousErrorHandling||!s.syncErrorThrowable?(this.__tryOrUnsub(l),this.unsubscribe()):(this.__tryOrSetError(s,l),this.unsubscribe())}else this.unsubscribe()}},r.prototype.__tryOrUnsub=function(o,s){try{o.call(this._context,s)}catch(l){if(this.unsubscribe(),ua.useDeprecatedSynchronousErrorHandling)throw l;Qs(l)}},r.prototype.__tryOrSetError=function(o,s,l){if(!ua.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{s.call(this._context,l)}catch(u){return ua.useDeprecatedSynchronousErrorHandling?(o.syncErrorValue=u,o.syncErrorThrown=!0,!0):(Qs(u),!0)}return!1},r.prototype._unsubscribe=function(){var o=this._parentSubscriber;this._context=null,this._parentSubscriber=null,o.unsubscribe()},r}(Ki);function qu(n){for(;n;){var r=n,o=r.closed,s=r.destination,l=r.isStopped;if(o||l)return!1;s&&s instanceof Ki?n=s:n=null}return!0}function Pi(n,r,o){if(n){if(n instanceof Ki)return n;if(n[Xu])return n[Xu]()}return!n&&!r&&!o?new Ki(fc):new Ki(n,r,o)}var da=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function kl(n){return n}function Rl(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Qc(n)}function Qc(n){return n.length===0?kl:n.length===1?n[0]:function(o){return n.reduce(function(s,l){return l(s)},o)}}var Ju=function(){function n(r){this._isScalar=!1,r&&(this._subscribe=r)}return n.prototype.lift=function(r){var o=new n;return o.source=this,o.operator=r,o},n.prototype.subscribe=function(r,o,s){var l=this.operator,u=Pi(r,o,s);if(l?u.add(l.call(u,this.source)):u.add(this.source||ua.useDeprecatedSynchronousErrorHandling&&!u.syncErrorThrowable?this._subscribe(u):this._trySubscribe(u)),ua.useDeprecatedSynchronousErrorHandling&&u.syncErrorThrowable&&(u.syncErrorThrowable=!1,u.syncErrorThrown))throw u.syncErrorValue;return u},n.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(o){ua.useDeprecatedSynchronousErrorHandling&&(r.syncErrorThrown=!0,r.syncErrorValue=o),qu(r)?r.error(o):console.warn(o)}},n.prototype.forEach=function(r,o){var s=this;return o=Il(o),new o(function(l,u){var h;h=s.subscribe(function(p){try{r(p)}catch(g){u(g),h&&h.unsubscribe()}},u,l)})},n.prototype._subscribe=function(r){var o=this.source;return o&&o.subscribe(r)},n.prototype[da]=function(){return this},n.prototype.pipe=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return r.length===0?this:Qc(r)(this)},n.prototype.toPromise=function(r){var o=this;return r=Il(r),new r(function(s,l){var u;o.subscribe(function(h){return u=h},function(h){return l(h)},function(){return s(u)})})},n.create=function(r){return new n(r)},n}();function Il(n){if(n||(n=ua.Promise||Promise),!n)throw new Error("no Promise impl found");return n}var ea=function(){function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n}(),el=ea,Qu=function(n){fe(r,n);function r(o,s){var l=n.call(this)||this;return l.subject=o,l.subscriber=s,l.closed=!1,l}return r.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var o=this.subject,s=o.observers;if(this.subject=null,!(!s||s.length===0||o.isStopped||o.closed)){var l=s.indexOf(this.subscriber);l!==-1&&s.splice(l,1)}}},r}(Qa),gf=function(n){fe(r,n);function r(o){var s=n.call(this,o)||this;return s.destination=o,s}return r}(Ki),mf=function(n){fe(r,n);function r(){var o=n.call(this)||this;return o.observers=[],o.closed=!1,o.isStopped=!1,o.hasError=!1,o.thrownError=null,o}return r.prototype[Xu]=function(){return new gf(this)},r.prototype.lift=function(o){var s=new C(this,this);return s.operator=o,s},r.prototype.next=function(o){if(this.closed)throw new el;if(!this.isStopped)for(var s=this.observers,l=s.length,u=s.slice(),h=0;h<l;h++)u[h].next(o)},r.prototype.error=function(o){if(this.closed)throw new el;this.hasError=!0,this.thrownError=o,this.isStopped=!0;for(var s=this.observers,l=s.length,u=s.slice(),h=0;h<l;h++)u[h].error(o);this.observers.length=0},r.prototype.complete=function(){if(this.closed)throw new el;this.isStopped=!0;for(var o=this.observers,s=o.length,l=o.slice(),u=0;u<s;u++)l[u].complete();this.observers.length=0},r.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},r.prototype._trySubscribe=function(o){if(this.closed)throw new el;return n.prototype._trySubscribe.call(this,o)},r.prototype._subscribe=function(o){if(this.closed)throw new el;return this.hasError?(o.error(this.thrownError),Qa.EMPTY):this.isStopped?(o.complete(),Qa.EMPTY):(this.observers.push(o),new Qu(this,o))},r.prototype.asObservable=function(){var o=new Ju;return o.source=this,o},r.create=function(o,s){return new C(o,s)},r}(Ju),C=function(n){fe(r,n);function r(o,s){var l=n.call(this)||this;return l.destination=o,l.source=s,l}return r.prototype.next=function(o){var s=this.destination;s&&s.next&&s.next(o)},r.prototype.error=function(o){var s=this.destination;s&&s.error&&this.destination.error(o)},r.prototype.complete=function(){var o=this.destination;o&&o.complete&&this.destination.complete()},r.prototype._subscribe=function(o){var s=this.source;return s?this.source.subscribe(o):Qa.EMPTY},r}(mf),M=function(n){fe(r,n);function r(o){var s=n.call(this)||this;return s._value=o,s}return Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(o){var s=n.prototype._subscribe.call(this,o);return s&&!s.closed&&o.next(this._value),s},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new el;return this._value},r.prototype.next=function(o){n.prototype.next.call(this,this._value=o)},r}(mf);function k(n,r){return function(o){return o.lift(new L(n,r))}}var L=function(){function n(r,o){this.compare=r,this.keySelector=o}return n.prototype.call=function(r,o){return o.subscribe(new W(r,this.compare,this.keySelector))},n}(),W=function(n){fe(r,n);function r(o,s,l){var u=n.call(this,o)||this;return u.keySelector=l,u.hasKey=!1,typeof s=="function"&&(u.compare=s),u}return r.prototype.compare=function(o,s){return o===s},r.prototype._next=function(o){var s;try{var l=this.keySelector;s=l?l(o):o}catch(p){return this.destination.error(p)}var u=!1;if(this.hasKey)try{var h=this.compare;u=h(this.key,s)}catch(p){return this.destination.error(p)}else this.hasKey=!0;u||(this.key=s,this.destination.next(o))},r}(Ki);function Y(n,r){return function(s){return s.lift(new re(n,r))}}var re=function(){function n(r,o){this.predicate=r,this.thisArg=o}return n.prototype.call=function(r,o){return o.subscribe(new Ge(r,this.predicate,this.thisArg))},n}(),Ge=function(n){fe(r,n);function r(o,s,l){var u=n.call(this,o)||this;return u.predicate=s,u.thisArg=l,u.count=0,u}return r.prototype._next=function(o){var s;try{s=this.predicate.call(this.thisArg,o,this.count++)}catch(l){this.destination.error(l);return}s&&this.destination.next(o)},r}(Ki),Fe=function(n){return function(r){for(var o=0,s=n.length;o<s&&!r.closed;o++)r.next(n[o]);r.complete()}},it=function(n){return function(r){return n.then(function(o){r.closed||(r.next(o),r.complete())},function(o){return r.error(o)}).then(null,Qs),r}};function At(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Qt=At(),Ct=null,It=function(n){return function(r){var o=n[Qt]();do{var s=void 0;try{s=o.next()}catch(l){return r.error(l),r}if(s.done){r.complete();break}if(r.next(s.value),r.closed)break}while(!0);return typeof o.return=="function"&&r.add(function(){o.return&&o.return()}),r}},ir=function(n){return function(r){var o=n[da]();if(typeof o.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return o.subscribe(r)}},Ir=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function er(n){return!!n&&typeof n.subscribe!="function"&&typeof n.then=="function"}var Eo=function(n){if(!!n&&typeof n[da]=="function")return ir(n);if(Ir(n))return Fe(n);if(er(n))return it(n);if(!!n&&typeof n[Qt]=="function")return It(n);var r=qd(n)?"an invalid object":"'"+n+"'",o="You provided "+r+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(o)},So=function(n){fe(r,n);function r(o){var s=n.call(this)||this;return s.parent=o,s}return r.prototype._next=function(o){this.parent.notifyNext(o)},r.prototype._error=function(o){this.parent.notifyError(o),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},r}(Ki),Fs=function(n){fe(r,n);function r(o,s,l){var u=n.call(this)||this;return u.parent=o,u.outerValue=s,u.outerIndex=l,u}return r.prototype._next=function(o){this.parent.notifyNext(this.outerValue,o,this.outerIndex,this)},r.prototype._error=function(o){this.parent.notifyError(o),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},r}(Ki),br=function(n){fe(r,n);function r(){return n!==null&&n.apply(this,arguments)||this}return r.prototype.notifyNext=function(o){this.destination.next(o)},r.prototype.notifyError=function(o){this.destination.error(o)},r.prototype.notifyComplete=function(){this.destination.complete()},r}(Ki),Nr=function(n){fe(r,n);function r(){return n!==null&&n.apply(this,arguments)||this}return r.prototype.notifyNext=function(o,s,l,u){this.destination.next(s)},r.prototype.notifyError=function(o){this.destination.error(o)},r.prototype.notifyComplete=function(o){this.destination.complete()},r}(Ki);function Ts(n,r){if(!r.closed){if(n instanceof Ju)return n.subscribe(r);var o;try{o=Eo(n)(r)}catch(s){r.error(s)}return o}}var Gr={leading:!0,trailing:!1};function Vi(n,r){return r===void 0&&(r=Gr),function(o){return o.lift(new tl(n,!!r.leading,!!r.trailing))}}var tl=null,La=function(n){fe(r,n);function r(o,s,l,u){var h=n.call(this,o)||this;return h.destination=o,h.durationSelector=s,h._leading=l,h._trailing=u,h._hasValue=!1,h}return r.prototype._next=function(o){this._hasValue=!0,this._sendValue=o,this._throttled||(this._leading?this.send():this.throttle(o))},r.prototype.send=function(){var o=this,s=o._hasValue,l=o._sendValue;s&&(this.destination.next(l),this.throttle(l)),this._hasValue=!1,this._sendValue=void 0},r.prototype.throttle=function(o){var s=this.tryDurationSelector(o);s&&this.add(this._throttled=Ts(s,new So(this)))},r.prototype.tryDurationSelector=function(o){try{return this.durationSelector(o)}catch(s){return this.destination.error(s),null}},r.prototype.throttlingDone=function(){var o=this,s=o._throttled,l=o._trailing;s&&s.unsubscribe(),this._throttled=void 0,l&&this.send()},r.prototype.notifyNext=function(){this.throttlingDone()},r.prototype.notifyComplete=function(){this.throttlingDone()},r}(br);function vs(n,r,o){return r===void 0&&(r=zp),o===void 0&&(o=Gr),function(s){return s.lift(new xa(n,r,o.leading,o.trailing))}}var xa=function(){function n(r,o,s,l){this.duration=r,this.scheduler=o,this.leading=s,this.trailing=l}return n.prototype.call=function(r,o){return o.subscribe(new ha(r,this.duration,this.scheduler,this.leading,this.trailing))},n}(),ha=function(n){fe(r,n);function r(o,s,l,u,h){var p=n.call(this,o)||this;return p.duration=s,p.scheduler=l,p.leading=u,p.trailing=h,p._hasTrailingValue=!1,p._trailingValue=null,p}return r.prototype._next=function(o){this.throttled?this.trailing&&(this._trailingValue=o,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(ts,this.duration,{subscriber:this})),this.leading?this.destination.next(o):this.trailing&&(this._trailingValue=o,this._hasTrailingValue=!0))},r.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},r.prototype.clearThrottle=function(){var o=this.throttled;o&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),o.unsubscribe(),this.remove(o),this.throttled=null)},r}(Ki);function ts(n){var r=n.subscriber;r.clearThrottle()}function Li(n){for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];if(!1)var l,u;throw Error("[Immer] minified error nr: "+n+(o.length?" "+o.map(function(h){return"'"+h+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ro(n){return!!n&&!!n[te]}function $o(n){return!!n&&(function(r){if(!r||typeof r!="object")return!1;var o=Object.getPrototypeOf(r);if(o===null)return!0;var s=Object.hasOwnProperty.call(o,"constructor")&&o.constructor;return s===Object||typeof s=="function"&&Function.toString.call(s)===Lt}(n)||Array.isArray(n)||!!n[ou]||!!n.constructor[ou]||Ll(n)||Gs(n))}function Up(n){return ro(n)||Li(23,n),n[te].t}function us(n,r,o){o===void 0&&(o=!1),Ca(n)===0?(o?Object.keys:qe)(n).forEach(function(s){o&&typeof s=="symbol"||r(s,n[s],n)}):n.forEach(function(s,l){return r(l,s,n)})}function Ca(n){var r=n[te];return r?r.i>3?r.i-4:r.i:Array.isArray(n)?1:Ll(n)?2:Gs(n)?3:0}function ei(n,r){return Ca(n)===2?n.has(r):Object.prototype.hasOwnProperty.call(n,r)}function ta(n,r){return Ca(n)===2?n.get(r):n[r]}function pc(n,r,o){var s=Ca(n);s===2?n.set(r,o):s===3?(n.delete(r),n.add(o)):n[r]=o}function gc(n,r){return n===r?n!==0||1/n==1/r:n!=n&&r!=r}function Ll(n){return jp&&n instanceof Map}function Gs(n){return sd&&n instanceof Set}function go(n){return n.o||n.t}function mc(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var r=Gt(n);delete r[te];for(var o=qe(r),s=0;s<o.length;s++){var l=o[s],u=r[l];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(r[l]={configurable:!0,writable:!0,enumerable:u.enumerable,value:n[l]})}return Object.create(Object.getPrototypeOf(n),r)}function eu(n,r){return r===void 0&&(r=!1),ed(n)||ro(n)||!$o(n)||(Ca(n)>1&&(n.set=n.add=n.clear=n.delete=eh),Object.freeze(n),r&&us(n,function(o,s){return eu(s,!0)},!0)),n}function eh(){Li(2)}function ed(n){return n==null||typeof n!="object"||Object.isFrozen(n)}function Ms(n){var r=rn[n];return r||Li(18,n),r}function td(n,r){rn[n]||(rn[n]=r)}function vc(){return rl}function nd(n,r){r&&(Ms("Patches"),n.u=[],n.s=[],n.v=r)}function Fa(n){rd(n),n.p.forEach(Ps),n.p=null}function rd(n){n===rl&&(rl=n.l)}function tu(n){return rl={p:[],l:rl,h:n,m:!0,_:0}}function Ps(n){var r=n[te];r.i===0||r.i===1?r.j():r.O=!0}function Bs(n,r){r._=r.p.length;var o=r.p[0],s=n!==void 0&&n!==o;return r.h.g||Ms("ES5").S(r,n,s),s?(o[te].P&&(Fa(r),Li(4)),$o(n)&&(n=Fl(r,n),r.l||nu(r,n)),r.u&&Ms("Patches").M(o[te].t,n,r.u,r.s)):n=Fl(r,o,[]),Fa(r),r.u&&r.v(r.u,r.s),n!==bc?n:void 0}function Fl(n,r,o){if(ed(r))return r;var s=r[te];if(!s)return us(r,function(u,h){return Gl(n,s,r,u,h,o)},!0),r;if(s.A!==n)return r;if(!s.P)return nu(n,s.t,!0),s.t;if(!s.I){s.I=!0,s.A._--;var l=s.i===4||s.i===5?s.o=mc(s.k):s.o;us(s.i===3?new Set(l):l,function(u,h){return Gl(n,s,l,u,h,o)}),nu(n,l,!1),o&&n.u&&Ms("Patches").R(s,o,n.u,n.s)}return s.o}function Gl(n,r,o,s,l,u){if(ro(l)){var h=Fl(n,l,u&&r&&r.i!==3&&!ei(r.D,s)?u.concat(s):void 0);if(pc(o,s,h),!ro(h))return;n.m=!1}if($o(l)&&!ed(l)){if(!n.h.F&&n._<1)return;Fl(n,l),r&&r.A.l||nu(n,l)}}function nu(n,r,o){o===void 0&&(o=!1),n.h.F&&n.m&&eu(r,o)}function th(n,r){var o=n[te];return(o?go(o):n)[r]}function Oi(n,r){if(r in n)for(var o=Object.getPrototypeOf(n);o;){var s=Object.getOwnPropertyDescriptor(o,r);if(s)return s;o=Object.getPrototypeOf(o)}}function Ro(n){n.P||(n.P=!0,n.l&&Ro(n.l))}function zs(n){n.o||(n.o=mc(n.t))}function ys(n,r,o){var s=Ll(r)?Ms("MapSet").N(r,o):Gs(r)?Ms("MapSet").T(r,o):n.g?function(l,u){var h=Array.isArray(l),p={i:h?1:0,A:u?u.A:vc(),P:!1,I:!1,D:{},l:u,t:l,k:null,o:null,j:null,C:!1},g=p,v=xn;h&&(g=[p],v=Sn);var b=Proxy.revocable(g,v),w=b.revoke,A=b.proxy;return p.k=A,p.j=w,A}(r,o):Ms("ES5").J(r,o);return(o?o.A:vc()).p.push(s),s}function nh(n){return ro(n)||Li(22,n),function r(o){if(!$o(o))return o;var s,l=o[te],u=Ca(o);if(l){if(!l.P&&(l.i<4||!Ms("ES5").K(l)))return l.t;l.I=!0,s=ru(o,u),l.I=!1}else s=ru(o,u);return us(s,function(h,p){l&&ta(l.t,h)===p||pc(s,h,r(p))}),u===3?new Set(s):s}(n)}function ru(n,r){switch(r){case 2:return new Map(n);case 3:return Array.from(n)}return mc(n)}function Vp(){function n(h,p){var g=u[h];return g?g.enumerable=p:u[h]=g={configurable:!0,enumerable:p,get:function(){var v=this[te];return xn.get(v,h)},set:function(v){var b=this[te];xn.set(b,h,v)}},g}function r(h){for(var p=h.length-1;p>=0;p--){var g=h[p][te];if(!g.P)switch(g.i){case 5:s(g)&&Ro(g);break;case 4:o(g)&&Ro(g)}}}function o(h){for(var p=h.t,g=h.k,v=qe(g),b=v.length-1;b>=0;b--){var w=v[b];if(w!==te){var A=p[w];if(A===void 0&&!ei(p,w))return!0;var O=g[w],D=O&&O[te];if(D?D.t!==A:!gc(O,A))return!0}}var _=!!p[te];return v.length!==qe(p).length+(_?0:1)}function s(h){var p=h.k;if(p.length!==h.t.length)return!0;var g=Object.getOwnPropertyDescriptor(p,p.length-1);if(g&&!g.get)return!0;for(var v=0;v<p.length;v++)if(!p.hasOwnProperty(v))return!0;return!1}function l(h){h.O&&Li(3,JSON.stringify(go(h)))}var u={};td("ES5",{J:function(h,p){var g=Array.isArray(h),v=function(w,A){if(w){for(var O=Array(A.length),D=0;D<A.length;D++)Object.defineProperty(O,""+D,n(D,!0));return O}var _=Gt(A);delete _[te];for(var I=qe(_),B=0;B<I.length;B++){var G=I[B];_[G]=n(G,w||!!_[G].enumerable)}return Object.create(Object.getPrototypeOf(A),_)}(g,h),b={i:g?5:4,A:p?p.A:vc(),P:!1,I:!1,D:{},l:p,t:h,k:v,o:null,O:!1,C:!1};return Object.defineProperty(v,te,{value:b,writable:!0}),v},S:function(h,p,g){g?ro(p)&&p[te].A===h&&r(h.p):(h.u&&function v(b){if(b&&typeof b=="object"){var w=b[te];if(w){var A=w.t,O=w.k,D=w.D,_=w.i;if(_===4)us(O,function(ve){ve!==te&&(A[ve]!==void 0||ei(A,ve)?D[ve]||v(O[ve]):(D[ve]=!0,Ro(w)))}),us(A,function(ve){O[ve]!==void 0||ei(O,ve)||(D[ve]=!1,Ro(w))});else if(_===5){if(s(w)&&(Ro(w),D.length=!0),O.length<A.length)for(var I=O.length;I<A.length;I++)D[I]=!1;else for(var B=A.length;B<O.length;B++)D[B]=!0;for(var G=Math.min(O.length,A.length),K=0;K<G;K++)O.hasOwnProperty(K)||(D[K]=!0),D[K]===void 0&&v(O[K])}}}}(h.p[0]),r(h.p))},K:function(h){return h.i===4?o(h):s(h)}})}function nl(){function n(s){if(!$o(s))return s;if(Array.isArray(s))return s.map(n);if(Ll(s))return new Map(Array.from(s.entries()).map(function(h){return[h[0],n(h[1])]}));if(Gs(s))return new Set(Array.from(s).map(n));var l=Object.create(Object.getPrototypeOf(s));for(var u in s)l[u]=n(s[u]);return ei(s,ou)&&(l[ou]=s[ou]),l}function r(s){return ro(s)?n(s):s}var o="add";td("Patches",{$:function(s,l){return l.forEach(function(u){for(var h=u.path,p=u.op,g=s,v=0;v<h.length-1;v++){var b=Ca(g),w=""+h[v];b!==0&&b!==1||w!=="__proto__"&&w!=="constructor"||Li(24),typeof g=="function"&&w==="prototype"&&Li(24),typeof(g=ta(g,w))!="object"&&Li(15,h.join("/"))}var A=Ca(g),O=n(u.value),D=h[h.length-1];switch(p){case"replace":switch(A){case 2:return g.set(D,O);case 3:Li(16);default:return g[D]=O}case o:switch(A){case 1:return D==="-"?g.push(O):g.splice(D,0,O);case 2:return g.set(D,O);case 3:return g.add(O);default:return g[D]=O}case"remove":switch(A){case 1:return g.splice(D,1);case 2:return g.delete(D);case 3:return g.delete(u.value);default:return delete g[D]}default:Li(17,p)}}),s},R:function(s,l,u,h){switch(s.i){case 0:case 4:case 2:return function(p,g,v,b){var w=p.t,A=p.o;us(p.D,function(O,D){var _=ta(w,O),I=ta(A,O),B=D?ei(w,O)?"replace":o:"remove";if(_!==I||B!=="replace"){var G=g.concat(O);v.push(B==="remove"?{op:B,path:G}:{op:B,path:G,value:I}),b.push(B===o?{op:"remove",path:G}:B==="remove"?{op:o,path:G,value:r(_)}:{op:"replace",path:G,value:r(_)})}})}(s,l,u,h);case 5:case 1:return function(p,g,v,b){var w=p.t,A=p.D,O=p.o;if(O.length<w.length){var D=[O,w];w=D[0],O=D[1];var _=[b,v];v=_[0],b=_[1]}for(var I=0;I<w.length;I++)if(A[I]&&O[I]!==w[I]){var B=g.concat([I]);v.push({op:"replace",path:B,value:r(O[I])}),b.push({op:"replace",path:B,value:r(w[I])})}for(var G=w.length;G<O.length;G++){var K=g.concat([G]);v.push({op:o,path:K,value:r(O[G])})}w.length<O.length&&b.push({op:"replace",path:g.concat(["length"]),value:w.length})}(s,l,u,h);case 3:return function(p,g,v,b){var w=p.t,A=p.o,O=0;w.forEach(function(D){if(!A.has(D)){var _=g.concat([O]);v.push({op:"remove",path:_,value:D}),b.unshift({op:o,path:_,value:D})}O++}),O=0,A.forEach(function(D){if(!w.has(D)){var _=g.concat([O]);v.push({op:o,path:_,value:D}),b.unshift({op:"remove",path:_,value:D})}O++})}(s,l,u,h)}},M:function(s,l,u,h){u.push({op:"replace",path:[],value:l===bc?void 0:l}),h.push({op:"replace",path:[],value:s})}})}function id(){function n(p,g){function v(){this.constructor=p}l(p,g),p.prototype=(v.prototype=g.prototype,new v)}function r(p){p.o||(p.D=new Map,p.o=new Map(p.t))}function o(p){p.o||(p.o=new Set,p.t.forEach(function(g){if($o(g)){var v=ys(p.A.h,g,p);p.p.set(g,v),p.o.add(v)}else p.o.add(g)}))}function s(p){p.O&&Li(3,JSON.stringify(go(p)))}var l=function(p,g){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,b){v.__proto__=b}||function(v,b){for(var w in b)b.hasOwnProperty(w)&&(v[w]=b[w])})(p,g)},u=function(){function p(v,b){return this[te]={i:2,l:b,A:b?b.A:vc(),P:!1,I:!1,o:void 0,D:void 0,t:v,k:this,C:!1,O:!1},this}n(p,Map);var g=p.prototype;return Object.defineProperty(g,"size",{get:function(){return go(this[te]).size}}),g.has=function(v){return go(this[te]).has(v)},g.set=function(v,b){var w=this[te];return s(w),go(w).has(v)&&go(w).get(v)===b||(r(w),Ro(w),w.D.set(v,!0),w.o.set(v,b),w.D.set(v,!0)),this},g.delete=function(v){if(!this.has(v))return!1;var b=this[te];return s(b),r(b),Ro(b),b.t.has(v)?b.D.set(v,!1):b.D.delete(v),b.o.delete(v),!0},g.clear=function(){var v=this[te];s(v),go(v).size&&(r(v),Ro(v),v.D=new Map,us(v.t,function(b){v.D.set(b,!1)}),v.o.clear())},g.forEach=function(v,b){var w=this;go(this[te]).forEach(function(A,O){v.call(b,w.get(O),O,w)})},g.get=function(v){var b=this[te];s(b);var w=go(b).get(v);if(b.I||!$o(w)||w!==b.t.get(v))return w;var A=ys(b.A.h,w,b);return r(b),b.o.set(v,A),A},g.keys=function(){return go(this[te]).keys()},g.values=function(){var v,b=this,w=this.keys();return(v={})[Re]=function(){return b.values()},v.next=function(){var A=w.next();return A.done?A:{done:!1,value:b.get(A.value)}},v},g.entries=function(){var v,b=this,w=this.keys();return(v={})[Re]=function(){return b.entries()},v.next=function(){var A=w.next();if(A.done)return A;var O=b.get(A.value);return{done:!1,value:[A.value,O]}},v},g[Re]=function(){return this.entries()},p}(),h=function(){function p(v,b){return this[te]={i:3,l:b,A:b?b.A:vc(),P:!1,I:!1,o:void 0,t:v,k:this,p:new Map,O:!1,C:!1},this}n(p,Set);var g=p.prototype;return Object.defineProperty(g,"size",{get:function(){return go(this[te]).size}}),g.has=function(v){var b=this[te];return s(b),b.o?!!b.o.has(v)||!(!b.p.has(v)||!b.o.has(b.p.get(v))):b.t.has(v)},g.add=function(v){var b=this[te];return s(b),this.has(v)||(o(b),Ro(b),b.o.add(v)),this},g.delete=function(v){if(!this.has(v))return!1;var b=this[te];return s(b),o(b),Ro(b),b.o.delete(v)||!!b.p.has(v)&&b.o.delete(b.p.get(v))},g.clear=function(){var v=this[te];s(v),go(v).size&&(o(v),Ro(v),v.o.clear())},g.values=function(){var v=this[te];return s(v),o(v),v.o.values()},g.entries=function(){var v=this[te];return s(v),o(v),v.o.entries()},g.keys=function(){return this.values()},g[Re]=function(){return this.values()},g.forEach=function(v,b){for(var w=this.values(),A=w.next();!A.done;)v.call(b,A.value,A.value,this),A=w.next()},p}();td("MapSet",{N:function(p,g){return new u(p,g)},T:function(p,g){return new h(p,g)}})}function Bl(){Vp(),id(),nl()}function od(n){return n}function yc(n){return n}var Ga,rl,iu=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",jp=typeof Map<"u",sd=typeof Set<"u",ad=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",bc=iu?Symbol.for("immer-nothing"):((Ga={})["immer-nothing"]=!0,Ga),ou=iu?Symbol.for("immer-draftable"):"__$immer_draftable",te=iu?Symbol.for("immer-state"):"__$immer_state",Re=typeof Symbol<"u"&&Symbol.iterator||"@@iterator",Ke={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(n){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+n},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(n){return"Cannot apply patch, path doesn't resolve: "+n},16:'Sets cannot have "replace" patches.',17:function(n){return"Unsupported patch operation: "+n},18:function(n){return"The plugin for '"+n+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+n+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(n){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+n+"'"},22:function(n){return"'current' expects a draft, got: "+n},23:function(n){return"'original' expects a draft, got: "+n},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},Lt=""+Object.prototype.constructor,qe=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,Gt=Object.getOwnPropertyDescriptors||function(n){var r={};return qe(n).forEach(function(o){r[o]=Object.getOwnPropertyDescriptor(n,o)}),r},rn={},xn={get:function(n,r){if(r===te)return n;var o=go(n);if(!ei(o,r))return function(l,u,h){var p,g=Oi(u,h);return g?"value"in g?g.value:(p=g.get)===null||p===void 0?void 0:p.call(l.k):void 0}(n,o,r);var s=o[r];return n.I||!$o(s)?s:s===th(n.t,r)?(zs(n),n.o[r]=ys(n.A.h,s,n)):s},has:function(n,r){return r in go(n)},ownKeys:function(n){return Reflect.ownKeys(go(n))},set:function(n,r,o){var s=Oi(go(n),r);if(s!=null&&s.set)return s.set.call(n.k,o),!0;if(!n.P){var l=th(go(n),r),u=l==null?void 0:l[te];if(u&&u.t===o)return n.o[r]=o,n.D[r]=!1,!0;if(gc(o,l)&&(o!==void 0||ei(n.t,r)))return!0;zs(n),Ro(n)}return n.o[r]===o&&typeof o!="number"&&(o!==void 0||r in n.o)||(n.o[r]=o,n.D[r]=!0,!0)},deleteProperty:function(n,r){return th(n.t,r)!==void 0||r in n.t?(n.D[r]=!1,zs(n),Ro(n)):delete n.D[r],n.o&&delete n.o[r],!0},getOwnPropertyDescriptor:function(n,r){var o=go(n),s=Reflect.getOwnPropertyDescriptor(o,r);return s&&{writable:!0,configurable:n.i!==1||r!=="length",enumerable:s.enumerable,value:o[r]}},defineProperty:function(){Li(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){Li(12)}},Sn={};us(xn,function(n,r){Sn[n]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}}),Sn.deleteProperty=function(n,r){return Sn.set.call(this,n,r,void 0)},Sn.set=function(n,r,o){return xn.set.call(this,n[0],r,o,n[0])};var dr=function(){function n(o){var s=this;this.g=ad,this.F=!0,this.produce=function(l,u,h){if(typeof l=="function"&&typeof u!="function"){var p=u;u=l;var g=s;return function(_){var I=this;_===void 0&&(_=p);for(var B=arguments.length,G=Array(B>1?B-1:0),K=1;K<B;K++)G[K-1]=arguments[K];return g.produce(_,function(ve){var ae;return(ae=u).call.apply(ae,[I,ve].concat(G))})}}var v;if(typeof u!="function"&&Li(6),h!==void 0&&typeof h!="function"&&Li(7),$o(l)){var b=tu(s),w=ys(s,l,void 0),A=!0;try{v=u(w),A=!1}finally{A?Fa(b):rd(b)}return typeof Promise<"u"&&v instanceof Promise?v.then(function(_){return nd(b,h),Bs(_,b)},function(_){throw Fa(b),_}):(nd(b,h),Bs(v,b))}if(!l||typeof l!="object"){if((v=u(l))===void 0&&(v=l),v===bc&&(v=void 0),s.F&&eu(v,!0),h){var O=[],D=[];Ms("Patches").M(l,v,O,D),h(O,D)}return v}Li(21,l)},this.produceWithPatches=function(l,u){if(typeof l=="function")return function(v){for(var b=arguments.length,w=Array(b>1?b-1:0),A=1;A<b;A++)w[A-1]=arguments[A];return s.produceWithPatches(v,function(O){return l.apply(void 0,[O].concat(w))})};var h,p,g=s.produce(l,u,function(v,b){h=v,p=b});return typeof Promise<"u"&&g instanceof Promise?g.then(function(v){return[v,h,p]}):[g,h,p]},typeof(o==null?void 0:o.useProxies)=="boolean"&&this.setUseProxies(o.useProxies),typeof(o==null?void 0:o.autoFreeze)=="boolean"&&this.setAutoFreeze(o.autoFreeze)}var r=n.prototype;return r.createDraft=function(o){$o(o)||Li(8),ro(o)&&(o=nh(o));var s=tu(this),l=ys(this,o,void 0);return l[te].C=!0,rd(s),l},r.finishDraft=function(o,s){var l=o&&o[te],u=l.A;return nd(u,s),Bs(void 0,u)},r.setAutoFreeze=function(o){this.F=o},r.setUseProxies=function(o){o&&!ad&&Li(20),this.g=o},r.applyPatches=function(o,s){var l;for(l=s.length-1;l>=0;l--){var u=s[l];if(u.path.length===0&&u.op==="replace"){o=u.value;break}}l>-1&&(s=s.slice(l+1));var h=Ms("Patches").$;return ro(o)?h(o,s):this.produce(o,function(p){return h(p,s)})},n}(),jn=new dr,mr=jn.produce,ti=jn.produceWithPatches.bind(jn),gi=jn.setAutoFreeze.bind(jn),Un=jn.setUseProxies.bind(jn),Io=jn.applyPatches.bind(jn),ns=jn.createDraft.bind(jn),Lo=jn.finishDraft.bind(jn),Hi=null;id(),gi(!1);var ds;(function(n){n.EMPTY_VALUE=Symbol("EMPTY_MODEL_VALUE");function r(s){return s!==n.EMPTY_VALUE}n.isValidValue=r;function o(s){return s.pipe(k(),Y(l=>r(l)),vs(17,pf,{leading:!1,trailing:!0}))}n.defaultPipeFunction=o})(ds||(ds={}));class fa{constructor(r=ds.EMPTY_VALUE,o=30){this.toDispose=new qn,this.watch=(s,l=ds.defaultPipeFunction)=>{this.subject$.observers.length+1>this.maxSubscription&&console.warn(`${this.subject$} reach maxSubscription limitation, please check`);const h=(l?l(this.subject$):this.subject$).subscribe(s);return Rn.create(()=>{h.unsubscribe()})},this.getValue=()=>this.subject$.getValue(),this.setValue=s=>{if(!!this.subject$){if(typeof s=="function"){const l=this.subject$.getValue(),u=mr(l,h=>{s(h)});ds.isValidValue(u)&&this.setValue(u);return}this.subject$.next(s)}},this.hasValidValue=()=>{const s=this.getValue();return ds.isValidValue(s)},this.getValidValue=()=>Ee(this,void 0,void 0,function*(){const s=new As;if(this.hasValidValue())return this.getValue();const l=this.watch(u=>{ds.isValidValue(u)&&(s.resolve(u),l.dispose())});return s.promise}),this.dispose=()=>{this.toDispose.dispose()},this.subject$=new M(r||ds.EMPTY_VALUE),this.maxSubscription=o,this.toDispose.push(Rn.create(()=>{this.subject$.complete(),this.subject$.unsubscribe(),this.subject$=null}))}}const Ao=ce.defineToken("IFrontendApplicationContribution"),su=Symbol("IGraphCommandService"),jr=ce.defineToken("ICommandHandler"),Br=Symbol("ICommandContextProvider"),vf=Symbol("IGraphCommandFactory"),yf=ce.defineToken("IGraphCommandContribution");var bf;(function(n){function r(l){return!!l&&l===Object(l)&&"id"in l}n.is=r;function o(l,u){if(l.label&&u.label){const h=(l.category?`${l.category}: ${l.label}`:l.label).toLowerCase(),p=(u.category?`${u.category}: ${u.label}`:u.label).toLowerCase();return h.localeCompare(p)}else return 0}n.compareCommands=o;function s(l,u){return l.id===u.id&&l.label===u.label&&l.iconName===u.iconName&&l.category===u.category}n.equals=s})(bf||(bf={}));let xf=class{constructor(r){this.contributionProvider=r,this.redoStack=[],this.undoStack=[],this.commands=new Map,this.factories=new Map,this.disposables=new Map,this.cmdChangeEvent=new fa(null),this.Globals=new fa(new Map),this.setGlobal=(o,s)=>{this.Globals.setValue(l=>{l.set(o,s)})},this.getGlobal=o=>this.Globals.getValue().get(o),this.undoCommand=()=>Ee(this,void 0,void 0,function*(){const o=this.undoStack.pop();if(!o){console.error("empty undo stack");return}yield o.undo(),this.redoStack.push(o),this.cmdChangeEvent.setValue(null)}),this.redoCommand=()=>Ee(this,void 0,void 0,function*(){const o=this.redoStack.pop();if(!o){console.error("empty undo stack");return}yield o.redo(),this.undoStack.push(o),this.cmdChangeEvent.setValue(null)}),this.registerDisposableCommand=o=>{const s=new qn;return o({registerCommand:(u,h)=>{const p=this.registerCommand(u,h);return s.push(p),p}}),s}}get watchChange(){return this.cmdChangeEvent.watch}onStart(){const r=this.contributionProvider.getContributions();for(const o of r)o.registerGraphCommands(this)}executeCommandPipeline(r){return Ee(this,void 0,void 0,function*(){let o=null;for(const s of r){const l=o==null?void 0:o.contextProvider(),{args:u,hooks:h}=yield s==null?void 0:s.getCommandOption(l);o=yield this.executeCommand(s==null?void 0:s.commandId,u,h)}return this.cmdChangeEvent.setValue(null),o})}executeCommand(r,o,s=[]){return Ee(this,void 0,void 0,function*(){const l=this.getFactory(r);if(l){const u=yield l.createCommand(r,o,s);return yield u.execute(),u.isUndoable()&&this.undoStack.push(u),this.cmdChangeEvent.setValue(null),u}throw Object.assign(new Error(`The command '${r}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})})}executeUndoCommand(r,o,s=[]){return Ee(this,void 0,void 0,function*(){const l=this.getFactory(r);if(l){const u=yield l.createCommand(r,o,s);return yield u.execute(),u}throw Object.assign(new Error(`The command '${r}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})})}createCommand(r,o,s=[]){return Ee(this,void 0,void 0,function*(){const l=this.getFactory(r);if(l)return yield l.createCommand(r,o,s);throw Object.assign(new Error(`The command '${r}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})})}get isUndoable(){return this.undoStack.length>0}get isRedoable(){return this.redoStack.length>0}hasCommand(r){return this.commands.has(r)}getCommand(r){return this.commands.get(r)}registerCommand(r,o){if(this.factories.has(r.id))return console.warn(`A command ${r.id} is already registered.`),Rn.NULL;const s=new qn(this.doRegisterCommand(r),this.registerFactory(r.id,o),Rn.create(()=>this.disposables.delete(r.id)));return this.disposables.set(r.id,s),s}doRegisterCommand(r){return this.commands.set(r.id,r),Rn.create(()=>this.disposables.delete(r.id))}unregisterCommand(r){const o=bf.is(r)?r.id:r,s=this.disposables.get(o);s&&s.dispose()}hasFactory(r){return!!this.factories.get(r)}getFactory(r){return this.factories.get(r)}registerFactory(r,o,s=!1){return this.hasFactory(r)&&s===!1&&console.error("cannot register command:",r),this.factories.set(r,o),Rn.create(()=>{this.factories.delete(r)})}getAllFactories(){return Array.from(this.factories.entries())}};xf=vt([Dn({contrib:[Ao,su]}),Tl(0,Bi(yf)),ct("design:paramtypes",[Object])],xf);const V0=Yi(n=>{Qr.register(n,yf),n(xf)}),mi=ce.defineToken("IModelService"),il=ce.defineToken("IModelContribution"),ol=Symbol("IModelOptionProvider");var Vt=P(70655),ld;(function(n){n.ASYNC_SRRIES="ASYNC_SRRIES",n.ASYNC_PARALLEL="ASYNC_PARALLEL"})(ld||(ld={}));var au=P(94633),Yg=P.n(au),lu;(function(n){let r;(function(l){l.INVALID_HOOK_BEFORE="INVALID_HOOK_BEFORE",l.INVALID_HOOK_AFTER="INVALID_HOOK_AFTER",l.INVALID_HOOK_ARGS_LENGTH="INVALID_HOOK_ARGS_LENGTH"})(r=n.ErrorEnum||(n.ErrorEnum={}));class o extends Error{constructor(u,h,...p){Array.isArray(h)&&(h=h.filter(function(g){return!!g}).join(" ")),super(`${u}: ${h}`),Error.captureStackTrace&&Error.captureStackTrace(this,o),this.code=u,this.contexts={},p.forEach(g=>{typeof g=="object"&&Object.entries(g).forEach(v=>{const[b,w]=v;b!=="key"&&w&&(this.contexts[b]=JSON.parse(JSON.stringify(w)))})})}toString(){return`${this.code}: ${this.message}`}}n.HookError=o;const s=(l,u,...h)=>new o(l,u,...h);n.HookBeforeError=()=>s(r.INVALID_HOOK_BEFORE,["hook require a before dependency but not exist in hookmap"]),n.HookAfterError=()=>s(r.INVALID_HOOK_AFTER,["hook require a after dependency but not exist in hookmap"]),n.InvalidHookArguments=l=>s(r.INVALID_HOOK_ARGS_LENGTH,["hook handlers must have 0 to 2 arguments",`but got ${l.handler.length}`])})(lu||(lu={}));var rh;(function(n){n.normalize=(r=[],o)=>{const s=Array.isArray(r)?r:[r],l=[];return o.forEach(u=>{l.push(u)}),[...l,...s].filter(u=>u&&!!u.handler)},n.sort=(r=[],o)=>{const s=[];return r.forEach(u=>{if(u.before){if(!o.has(u.before))throw lu.HookBeforeError();const h=[u,o.get(u.before)];s.push(h)}if(u.after){if(!o.has(u.after))throw lu.HookBeforeError();const h=[o.get(u.after),u];s.push(h)}}),Yg().array(r,s)}})(rh||(rh={}));class qi{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise((r,o)=>{this.resolve=s=>{this.isResolved=!0,r(s)},this.reject=s=>{this.isRejected=!0,o(s)}})}}class pa{constructor(r){this.scheduleType=ld.ASYNC_SRRIES,this.hasHook=o=>this.hookMap.has(o),this.getHooks=(o=[],s=!0)=>{const l=rh.normalize(o,this.hookMap);return s?rh.sort(l,this.hookMap):l},this.registerHook=o=>(this.hookMap.has(o.name)&&console.error(`${o.name} is duplicated in hookmap`),this.hookMap.set(o.name,o),{dispose:()=>{this.hookMap.delete(o.name)}}),this.call=(o,s=u=>(0,Vt.mG)(this,void 0,void 0,function*(){return u}),l=[])=>(0,Vt.mG)(this,void 0,void 0,function*(){const u=this.getHooks(l,!0),h=this.schedulers[this.scheduleType];return h(o,s,u)}),this.schedulers={[ld.ASYNC_SRRIES]:(o,s,l=[])=>(0,Vt.mG)(this,void 0,void 0,function*(){let u=s;for(const h of l){if([0,1].includes(h.handler.length)){yield h.handler.call(this,o);continue}if([2].includes(h.handler.length)&&u!==null){const g=yield h.handler.call(this,o,u);if(g===null){u=null;break}else if(typeof g=="function"){u=g;continue}}throw lu.InvalidHookArguments(h)}if(u)return yield u.call(this,o)}),[ld.ASYNC_PARALLEL]:(o,s,l=[])=>(0,Vt.mG)(this,void 0,void 0,function*(){const u=l.map(p=>{if([0,1].includes(p.handler.length))return p.handler.call(this,o);if([2].includes(p.handler.length))return p.handler.call(this,o,s);throw lu.InvalidHookArguments(p)}),h=new qi;if(Promise.all(u).then(p=>h.resolve(p)),s)return yield s.call(this,h)})},this.hookMap=new Map,r&&r.type&&(this.scheduleType=r.type)}}const ih=ce.defineToken("IHookService"),ga=ce.defineToken("IHookContribution"),Ba=()=>({graphOptions:new pa,reactNodeRender:new pa,reactEdgeLabelRender:new pa,afterGraphInit:new pa,beforeGraphDestroy:new pa,x6Events:new pa}),Cf=()=>({dispose:()=>{}});var wf;(function(n){n.CONFIG_TYPE="XFlowHook"})(wf||(wf={}));class na{constructor(){this.CONFIG_TYPE=wf.CONFIG_TYPE,this.time=Date.now(),this.setRegisterHook=r=>{this.hookRegisterFunc=r},this.setRegisterHookhub=r=>{this.hookhubRegisterFn=r},this.getConfig=()=>Ee(this,void 0,void 0,function*(){return{CONFIG_TYPE:this.CONFIG_TYPE,hookRegisterFn:this.hookRegisterFunc||Cf,hookhubRegisterFn:this.hookhubRegisterFn||Cf}}),this.dispose=()=>{}}}let cu=class{constructor(){this.toDispose=new qn,this.hookProvider=()=>this.hooks,this.registerHook=r=>r(this.hooks),this.registerHookHub=(r,o)=>(this.hooks[r]=o,{dispose:()=>{delete this.hooks[r]}}),this.onStart=()=>Ee(this,void 0,void 0,function*(){const r=this.contributionProvider.getContributions();for(const o of r)o.registerHookHub(this);for(const o of r)o.registerHook(this.hooks)}),this.hooks=Ba()}onStop(){this.toDispose.dispose()}};vt([Bi(ga),ct("design:type",Object)],cu.prototype,"contributionProvider",void 0),cu=vt([Dn({contrib:[Ao,ih]}),ct("design:paramtypes",[])],cu);var xc;(function(n){n.pluginId="GraphEventPlugin"})(xc||(xc={}));let uu=class{constructor(){this.toDispose=new qn,this.registerHook=r=>Ee(this,void 0,void 0,function*(){const{hookRegisterFn:o}=yield this.hookConfig.getConfig(),s=o(r);return Rn.create(()=>{s.dispose()})}),this.registerHookHub=r=>Ee(this,void 0,void 0,function*(){const{hookhubRegisterFn:o}=yield this.hookConfig.getConfig(),s=o(r);return Rn.create(()=>{s.dispose()})})}};vt([Rt(na),ct("design:type",na)],uu.prototype,"hookConfig",void 0),uu=vt([Dn({contrib:ga})],uu);const Hp={dispose:()=>null};function $p(n,r){let o;return()=>{clearTimeout(o),o=window.setTimeout(n,r)}}function Ef(n){let r;return()=>{r||(r=requestAnimationFrame(()=>{r=null,n()}))}}const Kg=n=>{const r=document.createElement("style");return r.setAttribute("type","text/css"),document.head.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n)),r};function qg(n){return typeof n=="function"&&!!n.prototype.isReactComponent}function H0(n){return typeof n=="function"&&String(n).includes("return React.createElement")}function Sf(n){return qg(n)||H0(n)}var Cc;(function(n){n.pluginId="base-graph-events"})(Cc||(Cc={}));let oh=class{constructor(){this.toDispose=new qn,this.registerHookHub=()=>Ee(this,void 0,void 0,function*(){return Rn.create(()=>{})}),this.registerHook=r=>Ee(this,void 0,void 0,function*(){const o=new qn,s=[r.x6Events.registerHook({name:Cc.pluginId,handler:l=>Ee(this,void 0,void 0,function*(){const{events:u}=yield this.graphOptions.getOptions();u.forEach(h=>{l.push(h)})})}),r.afterGraphInit.registerHook({name:Cc.pluginId,handler:l=>Ee(this,void 0,void 0,function*(){const{commandService:u,modelService:h,graph:p}=l,g=yield r.x6Events.call([],v=>Ee(this,void 0,void 0,function*(){return v.map(b=>{const w=A=>{b.callback(A,u,h,p)};return p.on(b.eventName,w),{dispose:()=>{p.off(b.eventName,w)}}})}));o.pushAll(g)})}),r.afterGraphInit.registerHook({name:"add auto resize event",handler:l=>Ee(this,void 0,void 0,function*(){const{commandService:u,options:h,graph:p}=l,g=Ef(()=>{u.executeCommand(rr.GRAPH_RESIZE.id,{})});window.addEventListener("resize",g);const{rootContainer:v}=h,b=new ResizeObserver(()=>p.resize(v.clientWidth));v&&b.observe(v),o.push(Rn.create(()=>{window.removeEventListener("resize",g)}))})}),r.beforeGraphDestroy.registerHook({name:Cc.pluginId,handler:()=>Ee(this,void 0,void 0,function*(){o.dispose()})})];return o.pushAll(s),o})}};vt([Rt(no),ct("design:type",Object)],oh.prototype,"graphOptions",void 0),oh=vt([Dn({contrib:ga})],oh);const $0=n=>Yi(r=>{Qr.register(r,ga),r(uu),r(oh),r(cu),r(na,{useValue:n})});var wc=P(96486);class Jg{constructor(){this.extensions=[],this.containerClassNames=new Set,this.addCoreModule=r=>(this.extensions.unshift(r),Rn.create(()=>{this.removeExtension(r)})),this.addExtension=r=>(this.extensions.push(r),Rn.create(()=>{this.removeExtension(r)})),this.getExtension=r=>(0,wc.find)(this.extensions,o=>(0,wc.get)(o,"config.CONFIG_TYPE")===r),this.removeExtension=r=>{const o=this.extensions.indexOf(r);o>-1&&this.extensions.splice(o,1)},this.getInstanceId=()=>this.instanceId,this.addContainerClassNames=r=>this.containerClassNames.add(r),this.getContainerClassNames=()=>Array.from(this.containerClassNames),this.getAllExtensions=()=>this.extensions,this.getAllExtensionConfigs=()=>this.extensions.map(r=>r.config),this.instanceId=Ol()}has(r){return this.extensions.some(o=>o.config.CONFIG_TYPE===r)}}const Af=()=>F.useMemo(()=>new Jg,[]),sh=F.createContext({}),Os=()=>F.useContext(sh),ah=n=>{const r=Os(),o=F.useMemo(()=>n.config?n.config:new na,[]);return F.useEffect(()=>{const s=r.addCoreModule({config:o,createModule:$0});return()=>{s.dispose(),o.dispose()}},[r,o]),null},lh=n=>r=>{const o=F.useMemo(()=>({getValue:()=>({})}),[]);return o.getValue=()=>r,F.useMemo(()=>{const l=new na;return n(l,o),l},[o])},cd=F.createContext({cell:null,x6Graph:null,commands:null,modelService:null}),W0=()=>React.useContext(cd);function Qg(n,r,o){return function(s){const l=this,u=s==null?void 0:s.getData(),h=s==null?void 0:s.getSize(),p=s==null?void 0:s.getPosition(),g=()=>F.createElement(cd.Provider,{value:{cell:s,x6Graph:l,commands:r,modelService:o}},F.createElement(n,{cell:s,data:u,size:h,position:p}));return F.createElement(g,null)}}function Z0(n,r,o){return function(s){const l=this,u=s==null?void 0:s.getData(),h=()=>F.createElement(cd.Provider,{value:{cell:s,x6Graph:l,commands:r,modelService:o}},F.createElement(n,{data:u,cell:s}));return F.createElement(h,null)}}const hs=()=>{const[n,r]=React.useState(!1),{x6Graph:o,cell:s}=W0();return React.useEffect(()=>{const l=({added:u,removed:h})=>{if(u.filter(v=>v.isNode()).some(v=>{v.id,s.id})){s.setData(Object.assign(Object.assign({},s.getData()),{isNodeSelected:!0})),r(!0);return}if(h.filter(v=>v.isNode()).some(v=>{v.id,s.id})){s.setData(Object.assign(Object.assign({},s.getData()),{isNodeSelected:!1})),r(!1);return}};return o.on("selection:changed",l),()=>{o.off("selection:changed",l)}},[o]),[n]},Ec=Symbol("IGraphProvider"),Tf=Symbol("ICommandServiceProvider"),em=Symbol("IModelServiceProvider");let Sc=class{constructor(){this.toDispose=new qn,this.graphMap=new Map,this.getGraph=r=>Ee(this,void 0,void 0,function*(){let o=this.graphMap.get(r);if(!o){o=new As,this.graphMap.set(r,o);const s=yield this.optionProvider.getOptions(),l=this.hookService.hookProvider(),u=yield l.graphOptions.call(s.x6Options),{graphContainer:h,edgeRender:p,nodeRender:g,edgeTypeParser:v}=s,b=yield l.reactEdgeLabelRender.call(p);yield l.reactNodeRender.call(g);const{clientHeight:w,clientWidth:A}=h,O=yield this.commandServiceProvider.getCommandService(),D=yield this.modelServiceProvider.getModelService(),_=new Yr.kJ(Object.assign(Object.assign({container:h,width:A,height:w},u),{onEdgeLabelRendered:I=>{const{edge:B,container:G}=I;this.renderEdgeReactLabel({edge:B,container:G,edgeRenderMap:b,edgeTypeParser:v,modelService:D,commandService:O})}}));yield l.afterGraphInit.call({graph:_,commandService:O,modelService:D,options:s}),o.resolve(_),_.on("node:moved",({node:I})=>{const B=I.getData(),G=I.position();I.setData(Object.assign(Object.assign({},B),{x:G==null?void 0:G.x,y:G==null?void 0:G.y}))}),_.on("node:resized",({node:I})=>{const B=I.getData(),G=I.size();I.setData(Object.assign(Object.assign({},B),{width:G==null?void 0:G.width,height:G==null?void 0:G.height}))}),this.toDispose.push(Rn.create(()=>Ee(this,void 0,void 0,function*(){yield l.beforeGraphDestroy.call({graph:_,commandService:O,modelService:D,options:s}),this.graphMap.delete(r),_.dispose()})))}return o.promise}),this.renderEdgeReactLabel=r=>Ee(this,void 0,void 0,function*(){const{container:o,edgeTypeParser:s,edge:l,edgeRenderMap:u,commandService:h,modelService:p}=r,g=s(l==null?void 0:l.data)||sf,v=u.get(g);if(!!v&&l&&(l==null?void 0:l.data)&&v){const b=this.edgeAppendForeignObject(l,o),w=Z0(v,h,p)(l);ca.render(w,b)}})}edgeAppendForeignObject(r,o){const s=Yr.is.createSvgElement("foreignObject"),l=Yr.is.createElementNS("body",Yr.is.ns.xhtml),u=Yr.is.createElementNS("div",Yr.is.ns.xhtml),h=r==null?void 0:r.data,p=(h==null?void 0:h.edgeContentWidth)||100,g=(h==null?void 0:h.edgeContentHeight)||30;return s.setAttribute("width",`${p}`),s.setAttribute("height",`${g}`),s.setAttribute("x",`${-1*p/2}`),s.setAttribute("y",`${-1*g/2}`),l.setAttribute("xhtmls",Yr.is.ns.xhtml),l.style.width="100%",l.style.height="100%",l.style.padding="0",l.style.margin="0",l.style.background="unset",l.style.overflow="visible",l.className="xflow-edge-label-body",u.style.width="100%",u.style.height="100%",l.appendChild(u),s.appendChild(l),o.appendChild(s),u}dispose(){this.toDispose.dispose()}};vt([Rt(no),ct("design:type",Object)],Sc.prototype,"optionProvider",void 0),vt([Rt(ih),ct("design:type",Object)],Sc.prototype,"hookService",void 0),vt([Rt(Tf),ct("design:type",Object)],Sc.prototype,"commandServiceProvider",void 0),vt([Rt(em),ct("design:type",Object)],Sc.prototype,"modelServiceProvider",void 0),Sc=vt([Dn()],Sc);const X0=n=>{n(Sc),n(Ec,{lifecycle:ce.Lifecycle.singleton,useDynamic:r=>({getGraphInstance:()=>Ee(void 0,void 0,void 0,function*(){const o=r.container.get(Sc),s=r.container.get(no),l=yield s==null?void 0:s.getOptions();return yield o==null?void 0:o.getGraph(l.graphId)}),getGraphOptions:()=>Ee(void 0,void 0,void 0,function*(){const o=r.container.get(no);return o==null?void 0:o.getOptions()})})}),n(Tf,{lifecycle:ce.Lifecycle.singleton,useDynamic:r=>({getCommandService:()=>Ee(void 0,void 0,void 0,function*(){return r.container.get(su)})})}),n(em,{lifecycle:ce.Lifecycle.singleton,useDynamic:r=>({getModelService:()=>Ee(void 0,void 0,void 0,function*(){return r.container.get(mi)})})})};var Mf;(function(n){n.CONFIG_TYPE="MODEL_SERVICE_CONFIG"})(Mf||(Mf={}));const Ac=()=>Rn.create(()=>{});class tm{constructor(){this.CONFIG_TYPE=Mf.CONFIG_TYPE,this.registerModelFn=Ac,this.isMounted=new As,this.registerModel=r=>{this.registerModelFn=r},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>Ee(this,void 0,void 0,function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,modelRegisterFunc:this.registerModelFn||Ac}}),this.dispose=()=>{this.registerModelFn=Ac,this.isMounted=new As}}}let du=class{constructor(){this.toDispose=new qn,this.deferredModelMap=new Map,this.registerModel=r=>{const{id:o,getInitialValue:s,modelFactory:l}=r,u=new qn,h=this.ensureModel(o);if(h.isResolved){console.error(r,"model has been registerd");return}const p=s?s():ds.EMPTY_VALUE,g=l?l():new fa(p);return ds.isValidValue(p)&&h.resolve(g),r.watchChange&&r.watchChange(g,this).then(v=>{h.isResolved||h.resolve(g),this.toDispose.pushAll([v,u]),u.push(v)}),u},this.findDeferredModel=r=>this.deferredModelMap.get(r),this.awaitModel=r=>this.ensureModel(r).promise,this.registerRuntimeModel=()=>Ee(this,void 0,void 0,function*(){const{modelRegisterFunc:r}=yield this.modelOptionProvider.getOption(),o=yield this.graphProvider.getGraphInstance();r&&r(this,o)}),this.ensureModel=r=>{const o=this.deferredModelMap.get(r);if(o)return o;const s=new As;return this.deferredModelMap.set(r,s),this.toDispose.push(Rn.create(()=>this.deferredModelMap.delete(r))),s}}onStart(){const r=this.contributionProvider.getContributions();for(const o of r)o.registerModel(this);this.registerRuntimeModel()}onStop(){this.toDispose.dispose()}};vt([Bi(il),ct("design:type",Object)],du.prototype,"contributionProvider",void 0),vt([Rt(ol),ct("design:type",Object)],du.prototype,"modelOptionProvider",void 0),vt([Rt(Ec),ct("design:type",Object)],du.prototype,"graphProvider",void 0),du=vt([Dn({contrib:[Ao,mi]})],du);const nm=n=>r=>{const o=r.findDeferredModel(n);return!!(o&&o.promise)},$i=n=>r=>Ee(void 0,void 0,void 0,function*(){return yield r.awaitModel(n)}),io=n=>r=>Ee(void 0,void 0,void 0,function*(){return(yield r.awaitModel(n)).getValidValue()});var hu;(function(n){n.id="GRAPH_ENABLE_MULTI_SELECT",n.getModel=$i(n.id),n.useValue=io(n.id)})(hu||(hu={}));var fu;(function(n){n.id="GRAPH_FULLSCREEN",n.getModel=$i(n.id),n.useValue=io(n.id)})(fu||(fu={}));var Pf;(function(n){n.id="IS_NODE_SELECTED",n.getModel=$i(n.id),n.useValue=io(n.id)})(Pf||(Pf={}));var Of;(function(n){n.id="IS_GROUP_SELECTED",n.getModel=$i(n.id),n.useValue=io(n.id)})(Of||(Of={}));var Df;(function(n){n.id="IS_NORMAL_NODES_SELECTED",n.getModel=$i(n.id),n.useValue=io(n.id)})(Df||(Df={}));var zl;(function(n){n.id="LAST_SELECTED_CELL",n.getModel=$i(n.id),n.useValue=io(n.id)})(zl||(zl={}));var bs;(function(n){n.id="SELECTED_CELLS",n.getModel=$i(n.id),n.useValue=io(n.id)})(bs||(bs={}));var Ul;(function(n){n.id="LAST_SELECTED_NODE",n.getModel=$i(n.id),n.useValue=io(n.id)})(Ul||(Ul={}));var za;(function(n){n.id="SELECTED_NODES",n.getModel=$i(n.id),n.useValue=io(n.id)})(za||(za={}));var Wp;(function(n){n.id="SELECTED_EDGES",n.getModel=$i(n.id),n.useValue=io(n.id)})(Wp||(Wp={}));var Vl;(function(n){n.id="SELECTED_GROUPS",n.getModel=$i(n.id),n.useValue=io(n.id)})(Vl||(Vl={}));var sl;(function(n){n.id="CONTEXTMENU_NODE",n.getModel=$i(n.id),n.useValue=io(n.id)})(sl||(sl={}));var Zp;(function(n){n.id="CONTEXTMENU_EDGE",n.getModel=$i(n.id),n.useValue=io(n.id)})(Zp||(Zp={}));var rs;(function(n){n.id="CONTEXTMENU_TARGET",n.getModel=$i(n.id),n.useValue=io(n.id)})(rs||(rs={}));var Tc;(function(n){n.id="GRAPH_META",n.getModel=$i(n.id),n.useValue=io(n.id)})(Tc||(Tc={}));var Ua;(function(n){n.id="GRAPH_SCALE",n.getModel=$i(n.id),n.useValue=io(n.id)})(Ua||(Ua={}));var ud;(function(n){n.id="COMMAND_REDOABLE",n.getModel=$i(n.id),n.useValue=io(n.id)})(ud||(ud={}));var dd;(function(n){n.id="COMMAND_UNDOABLE",n.getModel=$i(n.id),n.useValue=io(n.id)})(dd||(dd={}));var hd;(function(n){n.id="COMMAND_GLOBALS",n.getModel=$i(n.id),n.useValue=io(n.id)})(hd||(hd={}));var fd;(function(n){n.id="HISTORY_UNDOABLE",n.getModel=$i(n.id),n.useValue=io(n.id)})(fd||(fd={}));var pd;(function(n){n.id="HISTORY_REDOABLE",n.getModel=$i(n.id),n.useValue=io(n.id)})(pd||(pd={}));let al=class{registerModel(r){r.registerModel({id:ud.id,getInitialValue:()=>this.commands.isRedoable,watchChange:o=>Ee(this,void 0,void 0,function*(){return this.commands.watchChange(()=>{o.setValue(this.commands.isRedoable)})})}),r.registerModel({id:dd.id,getInitialValue:()=>this.commands.isUndoable,watchChange:o=>Ee(this,void 0,void 0,function*(){return this.commands.watchChange(()=>{o.setValue(this.commands.isUndoable)})})}),r.registerModel({id:hd.id,modelFactory:()=>this.commands.Globals})}};vt([Rt(su),ct("design:type",Object)],al.prototype,"commands",void 0),al=vt([Dn({contrib:il})],al);const _f=(n,r,o)=>(n.on(r,o),Rn.create(()=>{n.off(r,o)}));let ch=class{constructor(){this.getGraphInstance=()=>Ee(this,void 0,void 0,function*(){const r=yield this.graphProvider.getGraphInstance(),o=yield this.graphProvider.getGraphOptions();return{graph:r,config:o}})}registerModel(r){r.registerModel({id:Tc.id,getInitialValue:()=>({flowId:"-1"}),watchChange:o=>Ee(this,void 0,void 0,function*(){return Rn.create(()=>{o.setValue({flowId:"-1"})})})}),r.registerModel({id:hu.id,getInitialValue:()=>({isEnable:!1}),watchChange:o=>Ee(this,void 0,void 0,function*(){return Rn.create(()=>{o.setValue({isEnable:!1})})})}),r.registerModel({id:fu.id,getInitialValue:()=>!1,watchChange:(o,s)=>Ee(this,void 0,void 0,function*(){const l=()=>Ee(this,void 0,void 0,function*(){const u=!!document.fullscreenElement;(yield fu.getModel(s)).setValue(u)});return document.addEventListener("fullscreenchange",l,!1),Rn.create(()=>{document.removeEventListener("fullscreenchange",l),o.setValue(!1)})})}),r.registerModel({id:bs.id,getInitialValue:()=>[],watchChange:o=>Ee(this,void 0,void 0,function*(){const{graph:s}=yield this.getGraphInstance(),l=u=>{const{selected:h}=u;o.setValue(h)};return s.on("selection:changed",l),Rn.create(()=>s.off("selection:changed",l))})}),r.registerModel({id:zl.id,watchChange:(o,s)=>Ee(this,void 0,void 0,function*(){return(yield bs.getModel(s)).watch((u=[])=>{o.setValue([...u].pop()||null)})})}),r.registerModel({id:za.id,getInitialValue:()=>[],watchChange:(o,s)=>Ee(this,void 0,void 0,function*(){return(yield bs.getModel(s)).watch((u=[])=>{const h=u.filter(p=>p.isNode());o.setValue(h)})})}),r.registerModel({id:Ul.id,watchChange:(o,s)=>Ee(this,void 0,void 0,function*(){return(yield za.getModel(s)).watch(h=>{o.setValue([...h].pop()||null)})})}),r.registerModel({id:Pf.id,watchChange:(o,s)=>Ee(this,void 0,void 0,function*(){return(yield za.getModel(s)).watch(h=>{o.setValue(h.length>0)})})}),r.registerModel({id:Of.id,getInitialValue:()=>!1,watchChange:(o,s)=>Ee(this,void 0,void 0,function*(){return(yield bs.getModel(s)).watch(h=>{const p=h.every(g=>g&&g.getProp("isGroup")===!0);o.setValue(p)})})}),r.registerModel({id:Vl.id,getInitialValue:()=>[],watchChange:(o,s)=>Ee(this,void 0,void 0,function*(){return(yield za.getModel(s)).watch(h=>{const p=h.filter(g=>g&&g.getProp("isGroup")===!0);o.setValue(p)})})}),r.registerModel({id:Df.id,getInitialValue:()=>!1,watchChange:(o,s)=>Ee(this,void 0,void 0,function*(){return(yield bs.getModel(s)).watch(h=>{const p=h.every(v=>{const b=!(v&&v.getProp("isGroup")),w=!(v&&v.getProp("group"));return b&&w}),g=h.length>0&&p;o.setValue(g)})})}),r.registerModel({id:Ua.id,getInitialValue:()=>({zoomFactor:-1}),watchChange:o=>Ee(this,void 0,void 0,function*(){const{graph:s}=yield this.getGraphInstance(),l=u=>{const h=s.zoom();o.setValue(Object.assign(Object.assign({},u),{zoomFactor:h}))};return s.on("scale",l),Rn.create(()=>s.off("scale",l))})}),r.registerModel({id:rs.id,watchChange:o=>Ee(this,void 0,void 0,function*(){const{graph:s,config:l}=yield this.getGraphInstance(),u=p=>g=>{const{x:v,y:b}=g,w=s.localToClient({x:v,y:b}),A=l.rootContainer.getBoundingClientRect(),O={x:w.x-((A==null?void 0:A.x)||0),y:w.y-((A==null?void 0:A.y)||0)};o.setValue({type:p,anchor:O,data:g,cell:g.cell})},h=new qn;return h.pushAll([_f(s,"node:contextmenu",u("node")),_f(s,"edge:contextmenu",u("edge")),_f(s,"blank:contextmenu",u("blank"))]),h})}),r.registerModel({id:pd.id,getInitialValue:()=>!1,watchChange:o=>Ee(this,void 0,void 0,function*(){const{graph:s}=yield this.getGraphInstance(),l=()=>{const u=s.history.canRedo();o.setValue(u)};return s.history&&s.history.on("change",l),Rn.create(()=>s.history.off("change",l))})}),r.registerModel({id:fd.id,getInitialValue:()=>!1,watchChange:o=>Ee(this,void 0,void 0,function*(){const{graph:s}=yield this.getGraphInstance(),l=()=>{const u=s.history.canUndo();o.setValue(u)};return s.history&&s.history.on("change",l),Rn.create(()=>s.history.off("change",l))})})}};vt([Rt(Ec),ct("design:type",Object)],ch.prototype,"graphProvider",void 0),ch=vt([Dn({contrib:il})],ch);const rm=Yi(n=>{Qr.register(n,il),n(du),n(ch),n(al)}),im=(n,r)=>{n({token:ol,useDynamic:()=>({getOption:()=>Ee(void 0,void 0,void 0,function*(){return r.getConfig()})}),lifecycle:ce.Lifecycle.singleton})},om=n=>Yi(r=>{im(r,n)}),Nf=n=>{const{config:r}=n,o=Os(),s=F.useMemo(()=>r||new tm,[]);return F.useEffect(()=>{const l=o.addCoreModule({config:s,createModule:om});return s.setMountState(),()=>{l.dispose(),s.dispose()}},[]),null};Nf.defaultProps={XFlowModuleType:"ModelServiceConfig"};const Xp=n=>r=>{const o=F.useMemo(()=>({getValue:()=>({})}),[]);return o.getValue=()=>r,F.useMemo(()=>{const l=new tm;return n(l,o),l},[o])},sm=n=>{const r=n.getChildren(),o=n.getSize(),s=n.getData()||{},l=n.getPosition(),u=n.getParentId(),{isCollapsed:h}=s,p=s.groupCollapsedSize||(h?o:null);return Object.assign(Object.assign({},s),{id:n.id,width:o.width,height:o.height,x:l.x,y:l.y,group:u,groupChildren:r?r.map(g=>g.id):null,groupCollapsedSize:p})},am=n=>{const r=n.getData()||{};return Object.assign({id:n.id},r)},Mc=n=>{const r=[],o=[],s=l=>{l.isNode()&&r.push(sm(l)),l.isEdge()&&o.push(am(l))};return n.map(l=>s(l)),{nodes:r,edges:o}},lm=100;let ll=class{constructor(){this.getGraphInstance=()=>this.graphProvider.getGraphInstance(),this.getGraphConfig=()=>this.graphProvider.getGraphOptions(),this.getGraphData=()=>Ee(this,void 0,void 0,function*(){const o=(yield this.graphProvider.getGraphInstance()).getCells();return Mc(o)}),this.getAllNodes=()=>Ee(this,void 0,void 0,function*(){return(yield this.graphProvider.getGraphInstance()).getNodes()}),this.getNodeById=r=>Ee(this,void 0,void 0,function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(r)}),this.getAllEdges=()=>Ee(this,void 0,void 0,function*(){return(yield this.graphProvider.getGraphInstance()).getEdges()}),this.getEdgeById=r=>Ee(this,void 0,void 0,function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(r)}),this.updateNodeAttrs=(r,o)=>Ee(this,void 0,void 0,function*(){r instanceof Yr.NB?r.setAttrs(o):(yield this.getNodeById(r)).setAttrs(o)}),this.updateEdgeAttrs=(r,o)=>Ee(this,void 0,void 0,function*(){r instanceof Yr.kS?r.setAttrs(o):(yield this.getEdgeById(r)).setAttrs(o)}),this.translateGraph=(r,o)=>Ee(this,void 0,void 0,function*(){const s=yield this.graphProvider.getGraphInstance(),l=s.translate();s.translate(l.tx+r,l.ty+o)})}start(){return Ee(this,void 0,void 0,function*(){yield this.startContributions(),this.registerEventListeners()})}executeCommand(r,o,s=[]){return this.commandService.executeCommand(r,o,s)}executeCommandPipeline(r){return this.commandService.executeCommandPipeline(r)}registerEventListeners(){window.addEventListener("unload",()=>{this.stopContributions()})}startContributions(){return Ee(this,void 0,void 0,function*(){console.log(this.contributions.getContributions());for(const r of this.contributions.getContributions())if(r.onStart)try{yield this.measure(`${r.constructor.name}.onStart`,()=>r.onStart(this))}catch(o){console.error("Could not start contribution",o)}})}stopContributions(){console.info(">>> Stopping frontend contributions...");for(const r of this.contributions.getContributions())if(r.onStop)try{r.onStop(this)}catch(o){console.error("Could not stop contribution",o)}console.info("<<< All frontend contributions have been stopped.")}measure(r,o){return Ee(this,void 0,void 0,function*(){const s=`${r}-start`,l=`${r}-end`;performance.mark(s);const u=yield o();performance.mark(l),performance.measure(r,s,l);for(const h of performance.getEntriesByName(r)){const p=`Frontend ${h.name}`;h.duration>lm?console.warn(`${p} is slow, took: ${h.duration.toFixed(1)} ms`):console.debug(`${p} took: ${h.duration.toFixed(1)} ms`)}return performance.clearMeasures(r),u})}};vt([Bi(Ao),ct("design:type",Object)],ll.prototype,"contributions",void 0),vt([Rt(Ec),ct("design:type",Object)],ll.prototype,"graphProvider",void 0),vt([Rt(su),ct("design:type",Object)],ll.prototype,"commandService",void 0),vt([Rt(mi),ct("design:type",Object)],ll.prototype,"modelService",void 0),ll=vt([Dn()],ll);const cm=Yi(n=>{Qr.register(n,Ao),n(ll)}),Yp=n=>{const r=n.getAllExtensions(),o=new yr,s=r.map(u=>{const{createModule:h,config:p}=u;return h(p)});return o.load(cm),o.load(V0),o.load(rm),s.forEach(u=>{o.load(u)}),o.get(ll)};class um{constructor(){this.xflowPrefixCls=XFLOW_PREFIX_CLS,this.getXflowPrefixCls=r=>`${this.xflowPrefixCls}-${r}`,this.setXflowPrefixCls=r=>this.xflowPrefixCls=r}}const kf=F.createContext({configProvider:null}),dm=()=>F.useContext(kf),gd=n=>{const r=dm();return F.useMemo(()=>r.configProvider?r.configProvider.getXflowPrefixCls(n):`${of}-${n}`,[n])};function md(n){const{createModule:r,children:o}=n,s=Os(),l=F.useMemo(()=>n.config||{CONFIG_TYPE:"",getConfig:()=>Ee(this,void 0,void 0,function*(){return{}})},[]);return F.useEffect(()=>{const u=s.addExtension({config:l,createModule:r});return()=>{u.dispose()}},[]),Array.isArray(o)||F.isValidElement(o)?F.createElement(F.Fragment,null," ",o," "):null}const cl=(n={})=>(0,F.useMemo)(()=>{const r=Object.entries(n),o=r.length>0?{position:"absolute"}:{};return r.forEach(([s,l=0])=>{o[s]=`${l}px`}),o},[n]),Kp=n=>Yi(r=>{X0(r),wo(r,n)});var uh=P(48551);const dh=n=>{const r=po(),o=F.useRef(null),s=F.useRef(null),l=Os(),u=F.useMemo(()=>{const w=n.config?n.config:new _l;return w.setX6Config(),w},[]),[h,p]=(0,uh.vI)(u.graphId);F.useEffect(()=>{r&&r.getGraphInstance().then(w=>{p(w)})},[r,p]),F.useEffect(()=>{u.setRootContainer(o.current),u.setGraphContainer(s.current),u.xflowInstanceId=l.getInstanceId(),l.addCoreModule({config:u,createModule:Kp});const w=()=>Ee(void 0,void 0,void 0,function*(){u.dispose()});return()=>{w()}},[]);const g=cl(n.position),v=gd("canvas-root"),b=gd("x6-canvas");return F.createElement(F.Fragment,null,F.createElement("div",{ref:o,className:v,style:g,id:u.graphId,tabIndex:0},F.createElement("div",{ref:s,className:b}),n.children),F.createElement(h,null))};dh.defaultProps={isXFlowCanvas:!0};let Va=class{constructor(){this.toDispose=new qn,this.runtimeHooks=[],this.getX6Graph=()=>Ee(this,void 0,void 0,function*(){if(this.graph)return this.graph;const r=yield this.graphProvider.getGraphInstance();return this.graph=r,r}),this.getGraphConfig=()=>Ee(this,void 0,void 0,function*(){return this.graphProvider.getGraphOptions()}),this.getGraphMeta=()=>Ee(this,void 0,void 0,function*(){const r=this.getModelService();return this.graphMeta||(yield Tc.useValue(r))}),this.setArgs=(r,o=[])=>(this.args=r,this.runtimeHooks=o,{args:r,hooks:o}),this.getArgs=()=>({args:Object.assign(Object.assign({},this.args),{modelService:this.getModelService(),commandService:this.getCommands(),getGraphMeta:this.getGraphMeta,getX6Graph:this.getX6Graph,getGraphConfig:this.getGraphConfig}),hooks:this.runtimeHooks}),this.setResult=r=>(this.result=r,this.result),this.getResult=()=>this.result,this.getHooks=()=>this.hookService.hookProvider(),this.getCommands=()=>this.commandService,this.getModelService=()=>this.modelService,this.addUndo=r=>{if(!Array.isArray(r))return this.addUndo([r]);this.toDispose.pushAll(r)},this.undo=()=>Ee(this,void 0,void 0,function*(){yield this.toDispose.dispose()}),this.isUndoable=()=>!this.toDispose.disposed,this.getDisposables=()=>this.toDispose,this.setGlobal=(r,o)=>{this.commandService.setGlobal(r,o)},this.getGlobal=r=>this.commandService.getGlobal(r)}init(){this.getGraphMeta().then(r=>{this.graphMeta=r})}};vt([Rt(Ec),ct("design:type",Object)],Va.prototype,"graphProvider",void 0),vt([Rt(ih),ct("design:type",Object)],Va.prototype,"hookService",void 0),vt([Rt(su),ct("design:type",Object)],Va.prototype,"commandService",void 0),vt([Rt(mi),ct("design:type",Object)],Va.prototype,"modelService",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Va.prototype,"init",null),Va=vt([nn()],Va);const qp="CommandConfig",pu=()=>[];class jl{constructor(){this.setCommandContributions=r=>{this.getContributions=r},this.getCommandContributions=()=>this.getContributions(),this.registerHook=r=>Ee(this,void 0,void 0,function*(){return this.registerHookFn?this.registerHookFn(r):Hp}),this.registerHookHub=r=>Ee(this,void 0,void 0,function*(){return this.registerHookHubFn?this.registerHookHubFn(r):Hp}),this.CONFIG_TYPE=qp,this.setRegisterHookFn=r=>{this.registerHookFn=r},this.setRegisterHookHubFn=r=>{this.registerHookHubFn=r},this.getConfig=()=>Ee(this,void 0,void 0,function*(){return{registerHookFn:this.registerHookFn,getContributions:this.getContributions,CONFIG_TYPE:this.CONFIG_TYPE}}),this.getContributions=pu}}const Jp=()=>new jl,ul=(n,r)=>{n({token:jl,contrib:[ga],lifecycle:ce.Lifecycle.singleton,useDynamic:()=>r})};var Hl;(function(n){n.command=di.ADD_NODE,n.hookKey="addNode"})(Hl||(Hl={}));let ja=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().addNode.call(o,h=>Ee(this,void 0,void 0,function*(){const{createNodeService:p,cellFactory:g,commandService:v,options:b}=h,w=yield r.getX6Graph();let A=h.nodeConfig;if(p){const I=yield p(h);if(typeof I=="boolean")return{err:"createNodeService rejected"};A=I}const O=yield this.processNodeConfig(A);let D;const _=Object.assign(Object.assign({},b),{isCommand:!0});if(g){const I=yield g(O,this);D=w.addNode(I,_)}else D=w.addNode(O,_);return r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){const I=Object.assign({id:D.id},D.getData());v.executeCommand(di.DEL_NODE.id,{nodeConfig:I})}))),{nodeConfig:O,nodeCell:D}}),s);return r.setResult(u),this}),this.processNodeConfig=r=>Ee(this,void 0,void 0,function*(){const o=this.contextProvider();if(r.data=Object.assign({},r),r.shape)return r;if(!r.view){const s=yield o.getGraphConfig();r.view=s.graphId}if(!r.component){const s=yield this.getNodeReactComponent(r),l=o.getCommands(),u=o.getModelService();r.shape="react-shape",r.component=Qg(s,l,u)}return r}),this.getNodeReactComponent=r=>Ee(this,void 0,void 0,function*(){const o=this.contextProvider(),s=o.getHooks(),l=yield o.getGraphConfig(),u=yield s.reactNodeRender.call(l.nodeRender),h=l.nodeTypeParser(r)||Pl,p=u.get(h);return p||console.error("react node component is missing:",l.nodeRender,h,p),p}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],ja.prototype,"contextProvider",void 0),ja=vt([nn({token:{token:jr,named:Hl.command.id}})],ja);var Pc;(function(n){n.command=di.DEL_NODE,n.hookKey="delNode",n.createHook=()=>new pa})(Pc||(Pc={}));let $l=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().delNode.call(o,h=>Ee(this,void 0,void 0,function*(){const{commandService:p,deleteNodeService:g,options:v}=h,b=yield r.getX6Graph();if(g&&!(yield g(h)))return{err:" service rejected"};const w=(h.x6Node||h.nodeConfig).id,A=b.getCellById(w);if(A&&A.isNode()){const O=[...b.getIncomingEdges(A)||[],...b.getOutgoingEdges(A)||[]];yield Promise.all(O.map(_=>p.executeCommand(zi.DEL_EDGE.id,{x6Edge:_})));const D=A.getData();return A.remove(Object.assign(Object.assign({},v),{isCommand:!0})),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){yield p.executeCommand(di.ADD_NODE.id,{nodeConfig:D})}))),{err:null,nodeConfig:D}}return{err:"node is not exist"}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()&&this.contextProvider().undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],$l.prototype,"contextProvider",void 0),$l=vt([nn({token:{token:jr,named:Pc.command.id}})],$l);var Ha;(function(n){n.command=di.SELECT_NODE,n.hookKey="selectNode"})(Ha||(Ha={}));let $a=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().selectNode.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),p=h.getSelectedCells().map(w=>w.id),{nodeIds:g,resetSelection:v,commandService:b}=u;return v?h.resetSelection(g):h.select(g),this.ctx.addUndo({dispose:()=>{b.executeUndoCommand(di.SELECT_NODE.id,{nodeIds:p,resetSelection:!0})}}),{}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],$a.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],$a.prototype,"init",null),$a=vt([nn({token:{token:jr,named:Ha.command.id}})],$a);var dl;(function(n){n.command=di.MOVE_NODE,n.hookKey="moveNode",n.createHook=()=>new pa})(dl||(dl={}));let gu=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().moveNode.call(o,h=>Ee(this,void 0,void 0,function*(){const{nodePositionService:p}=h;if(p&&!(yield p(h)))return{err:"service rejected"};const{dx:g=0,dy:v=0,x:b,y:w,duration:A=150}=h.position,D=(yield r.getX6Graph()).getCellById(h.id);if(D){let _=b,I=w;const{x:B,y:G}=D.position();let K=()=>{D.position(B,G,{silent:!1})};return g||v?(_=g+B,I=v+G,D.translate(g,v,{transition:{duration:A}}),K=()=>D.translate(-g,-v,{transition:{duration:A}})):D.position(_,I,{silent:!1}),r.addUndo(Rn.create(()=>{K()})),{err:null,nextX:_,nextY:I}}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],gu.prototype,"contextProvider",void 0),gu=vt([nn({token:{token:jr,named:dl.command.id}})],gu);var Rf=P(51584),Oc=P.n(Rf),Wl;(function(n){n.command=di.UPDATE_NODE,n.hookKey="updateNode",n.XFlowNodeSetOptions={overwrite:!0},n.NODE_WIDTH=200,n.NODE_HEIGHT=40})(Wl||(Wl={}));let mu=class{constructor(){this.setNodeConfig=(r,o,s)=>{r.setData(o,s),r.setPosition((o==null?void 0:o.x)||0,(o==null?void 0:o.y)||0),r.setSize((o==null?void 0:o.width)||Wl.NODE_WIDTH,(o==null?void 0:o.height)||Wl.NODE_HEIGHT),r.angle((o==null?void 0:o.angle)||0,{absolute:!0}),Oc()(o==null?void 0:o.visible)&&r.setVisible(o==null?void 0:o.visible),!(r instanceof uh.ep)&&!!r.getAttrByPath("text/text")&&r.setAttrByPath("text/text",o.label),o.attrs&&r.setAttrs(o.attrs),Array.isArray(o.ports)&&r.setPropByPath("ports/items",o.ports,Object.assign({rewrite:!0},s))},this.getNodeConfig=r=>{const o=r.getData(),s=r.getPosition(),l=r.getSize();return Object.assign(Object.assign(Object.assign({},o),s),l)},this.getNodeCell=(r,o)=>{const{nodeConfig:s,setNodeConfig:l}=o;let u="";if(l&&l.node&&typeof l.node=="string"?u=l.node:s&&s.id&&typeof s.id=="string"&&(u=s.id),u)return r==null?void 0:r.getCellById(u);if(l&&l.node instanceof Yr.NB)return l.node},this.getNextNodeConfig=(r,o)=>Ee(this,void 0,void 0,function*(){if(r&&r.setNodeConfig&&r.setNodeConfig.callback){const s=this.getNodeConfig(o);return r.setNodeConfig.callback(s)}return r.nodeConfig}),this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().updateNode.call(r,u=>Ee(this,void 0,void 0,function*(){const{options:h=Wl.XFlowNodeSetOptions}=u,p=yield this.ctx.getX6Graph(),g=this.getNodeCell(p,u),v=yield this.getNextNodeConfig(u,g);return this.setNodeConfig(g,v,h),{nodeConfig:v,nodeCell:g}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],mu.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],mu.prototype,"init",null),mu=vt([nn({token:{token:jr,named:Wl.command.id}})],mu);var wa;(function(n){n.command=di.CENTER_NODE,n.hookKey="centerNode"})(wa||(wa={}));let hl=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().centerNode.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),{nodeConfig:p}=u,g=h==null?void 0:h.getCellById(p==null?void 0:p.id);return h==null||h.centerCell(g),{x6Node:g}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],hl.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],hl.prototype,"init",null),hl=vt([nn({token:{token:jr,named:wa.command.id}})],hl);var If;(function(n){n.command=di.FRONT_NODE,n.hookKey="frontNode"})(If||(If={}));let hh=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().frontNode.call(o,h=>Ee(this,void 0,void 0,function*(){const p=yield this.ctx.getX6Graph(),{nodeId:g}=h,v=p==null?void 0:p.getCellById(g);return v?(v.toFront(),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){h.commandService.executeCommand(di.BACK_NODE.id,{nodeId:g})})))):console.error(g,"this nodeId is not exist"),{}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],hh.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],hh.prototype,"init",null),hh=vt([nn({token:{token:jr,named:If.command.id}})],hh);var fh;(function(n){n.command=di.BACK_NODE,n.hookKey="backNode"})(fh||(fh={}));let vd=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().backNode.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),{nodeId:p}=u,g=h==null?void 0:h.getCellById(p);return g?(g.toBack(),this.ctx.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){u.commandService.executeCommand(di.FRONT_NODE.id,{nodeId:p})})))):console.error(p,"this nodeId is not exist"),{}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],vd.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],vd.prototype,"init",null),vd=vt([nn({token:{token:jr,named:fh.command.id}})],vd);var ph;(function(n){n.command=di.HIGHLIGHT_NODE,n.hookKey="highlightNode"})(ph||(ph={}));let vu=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().highlightNode.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),{nodeId:p,stroke:g,strokeWidth:v}=u,b=h==null?void 0:h.getCellById(p);if(b){if(b==null||b.setAttrs({body:{stroke:g||"#7c68fc",strokeWidth:v||2}}),u!=null&&u.isHighlightRelatedLines){const{edgeStroke:w,edgeStrokeWidth:A}=u;(h==null?void 0:h.getEdges()).forEach(D=>{const _=D==null?void 0:D.getData();u==null||u.commandService.executeCommand(zi.HIGHLIGHT_EDGE.id,{edgeId:_==null?void 0:_.id,strokeColor:w,strokeWidth:A})})}}else return console.error(p,"this nodeId is not exist"),{err:"this nodeId is not exist"};return{err:null}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],vu.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],vu.prototype,"init",null),vu=vt([nn({token:{token:jr,named:ph.command.id}})],vu);var Zl;(function(n){n.command=di.UPDATE_NODE_PORT,n.hookKey="updateNodePort"})(Zl||(Zl={}));let Lf=class{constructor(){this.getCell=(r,o)=>typeof o=="string"?r.getCellById(o):o,this.getNodeConfig=r=>{const o=r.getData(),s=r.getPosition(),l=r.getSize();return Object.assign(Object.assign(Object.assign({},o),s),l)},this.updatePortsOfNodeConfig=(r,o,s)=>{const l=this.getNodeConfig(r);this.isNodeAnchors(l.ports)&&(l.ports=[...o]),this.isPortMetaData(l.ports)&&(l.ports.items=[...o]),r.setData(l,s)},this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),l=r.getHooks(),u=yield r.getX6Graph(),h=yield l.updateNodePort.call(o,p=>Ee(this,void 0,void 0,function*(){const{node:g,updatePorts:v,options:b,commandService:w}=p,A=this.getCell(u,g);if(!A||A.isEdge())return console.error("node_is _not_exsit",g),{err:"node_is _not_exsit"};const O=A.getPorts(),D=yield v([...O],A,u);return D===!1?{err:"service rejected"}:(A.setPropByPath("ports/items",D,Object.assign({rewrite:!0},b)),this.updatePortsOfNodeConfig(A,D,b),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){w.executeCommand(di.UPDATE_NODE_PORT.id,{node:g,updatePorts:()=>Ee(this,void 0,void 0,function*(){return O})})}))),{ports:D})}),s);return r.setResult(h),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isNodeAnchors(r){return Array.isArray(r)}isPortMetaData(r){return r.items&&Array.isArray(r.items)}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Lf.prototype,"contextProvider",void 0),Lf=vt([nn({token:{token:jr,named:Zl.command.id}})],Lf);const Y0=n=>{n(ja),n($l),n($a),n(gu),n(mu),n(hl),n(hh),n(vd),n(vu),n(Lf)},K0=[Hl,Pc,Ha,dl,Wl,wa,If,fh,ph,Zl];var gh;(function(n){n.command=rr.LOAD_META,n.hookKey="graphMeta"})(gh||(gh={}));let yd=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().graphMeta.call(r,p=>Ee(this,void 0,void 0,function*(){const{graphMetaService:g}=p,v=g?yield g(p):Object.assign({},p==null?void 0:p.meta);return Object.assign({flowId:v==null?void 0:v.flowId},v)}),o),u=this.ctx.getModelService();return(yield Tc.getModel(u)).setValue(l),this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],yd.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],yd.prototype,"init",null),yd=vt([nn({token:{token:jr,named:gh.command.id}})],yd);var Ff;(function(n){n.command=rr.SAVE_GRAPH_DATA,n.hookKey="saveGraphData"})(Ff||(Ff={}));let mh=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.ctx,o=r.getArgs();return yield r.getHooks().saveGraphData.call(o.args,l=>Ee(this,void 0,void 0,function*(){const{saveGraphDataService:u,includeAttrs:h}=l,p=yield r.getX6Graph(),g=p.getNodes(),v=p.getEdges(),b=g.map(D=>{const _=D.getData(),I=D.position(),B=D.size(),G=Object.assign(Object.assign(Object.assign({id:D.id},_),I),B);return h&&(G.attrs=D.getAttrs()),G}),w=v.map(D=>{const _=D.getData(),I=Object.assign({id:D.id},_);return h&&(I.attrs=D.getAttrs()),I}),A={nodes:b,edges:w},O=yield this.ctx.getGraphMeta();if(u){const D=yield u(O,A);D&&this.ctx.setResult(D)}return{}}),o.hooks),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],mh.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],mh.prototype,"init",null),mh=vt([nn({token:{token:jr,named:Ff.command.id}})],mh);var Gf;(function(n){n.command=rr.LOAD_DATA,n.hookKey="loadData",n.createHook=()=>new pa})(Gf||(Gf={}));let vh=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().loadData.call(r,u=>Ee(this,void 0,void 0,function*(){const{loadDataService:h}=u,p=yield this.ctx.getGraphMeta();return{graphData:yield h(p)}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],vh.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],vh.prototype,"init",null),vh=vt([nn({token:{token:jr,named:Gf.command.id}})],vh);const yh=n=>typeof n=="string",q0=n=>{const r=Object.create(null);return o=>r[o]||(r[o]=n(o))},Qp=/-(\w)/g,hm=q0(n=>n.replace(Qp,(r,o)=>o?o.toUpperCase():"")),xs=Array.isArray,En=n=>typeof n=="number",Dc=n=>Number.isNaN(Number(n)),Bf=n=>{const r=parseFloat(n);return Dc(r)?n:r},Ea=n=>n!==null&&typeof n=="object",_c=n=>{if(n===null)return n;if(n instanceof Date)return new Date(n.getTime());if(n instanceof Array){const r=[];return n.forEach(o=>{r.push(o)}),r.map(o=>_c(o))}if(typeof n=="object"&&n!=={}){const r=Object.assign({},n);return Object.keys(r).forEach(o=>{r[o]=_c(r[o])}),r}return n},Kr=(n,r)=>{const o=n[r];return Ea(o)?o.cell:o},Nc=(n,r,o)=>{const s=[];for(let l=0;l<n;l++)s[l]=0;return o&&o.forEach(l=>{const u=Kr(l,"source"),h=Kr(l,"target");u&&(s[r[u]]+=1),h&&(s[r[h]]+=1)}),s},bh=n=>{const r=[],o=n.length;for(let s=0;s<o;s+=1){r[s]=[];for(let l=0;l<o;l+=1)s===l?r[s][l]=0:n[s][l]===0||!n[s][l]?r[s][l]=1/0:r[s][l]=n[s][l]}for(let s=0;s<o;s+=1)for(let l=0;l<o;l+=1)for(let u=0;u<o;u+=1)r[l][u]>r[l][s]+r[s][u]&&(r[l][u]=r[l][s]+r[s][u]);return r},zf=(n,r)=>{const{nodes:o,edges:s}=n,l=[],u={};if(!o)throw new Error("invalid nodes data!");return o&&o.forEach((h,p)=>{u[h.id]=p;const g=[];l.push(g)}),s&&s.forEach(h=>{const p=Kr(h,"source"),g=Kr(h,"target"),v=u[p],b=u[g];l[v][b]=1,r||(l[b][v]=1)}),l},xh=(n,r)=>{const o=[];return n.forEach(s=>{const l=[];s.forEach(u=>{l.push(u*r)}),o.push(l)}),o},Ch=(n,r)=>{if(n&&n.children){for(let o=n.children.length-1;o>=0;o--)if(!Ch(n.children[o],r))return}return!!r(n)},yu=(n,r)=>{typeof r=="function"&&Ch(n,r)},Sa=n=>typeof n=="function",Ds=new Map,Uf=(n,r)=>{if(Ds.get(n)&&console.warn(`The layout with the name ${n} exists already, it will be overridden`),isObject(r)){class o extends Base{constructor(l){super();const u=this,h={},p=u.getDefaultCfg();Object.assign(h,p,r,l),Object.keys(h).forEach(g=>{const v=h[g];u[g]=v})}}Ds.set(n,o)}else Ds.set(n,r);return Ds.get(n)},Vf=n=>{Ds.has(n)&&Ds.delete(n)},bu=n=>Ds.has(n)?Ds.get(n):null;class _s{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(r){return this.init(r),this.execute(!0)}init(r){this.nodes=r.nodes||[],this.edges=r.edges||[],this.combos=r.combos||[]}execute(r){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(r){r&&Object.assign(this,r)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}class wh extends _s{constructor(r){super(),this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodeSize=30,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const r=this,o=r.nodes,s=r.edges,l=o.length,u=r.begin;if(l===0)return r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s};if(l===1)return o[0].x=u[0],o[0].y=u[1],r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s};const h=[];o.forEach(b=>{h.push(b)});const p={};if(h.forEach((b,w)=>{p[b.id]=w}),(r.sortBy==="degree"||!yh(r.sortBy)||h[0][r.sortBy]===void 0)&&(r.sortBy="degree",Dc(o[0].degree))){const b=Nc(h.length,p,s);h.forEach((w,A)=>{w.degree=b[A]})}h.sort((b,w)=>w[r.sortBy]-b[r.sortBy]),!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight);const g=r.rows,v=r.cols!=null?r.cols:r.columns;if(r.cells=l,g!=null&&v!=null?(r.rows=g,r.cols=v):g!=null&&v==null?(r.rows=g,r.cols=Math.ceil(r.cells/r.rows)):g==null&&v!=null?(r.cols=v,r.rows=Math.ceil(r.cells/r.cols)):(r.splits=Math.sqrt(r.cells*r.height/r.width),r.rows=Math.round(r.splits),r.cols=Math.round(r.width/r.height*r.splits)),r.cols*r.rows>r.cells){const b=r.small(),w=r.large();(b-1)*w>=r.cells?r.small(b-1):(w-1)*b>=r.cells&&r.large(w-1)}else for(;r.cols*r.rows<r.cells;){const b=r.small(),w=r.large();(w+1)*b>=r.cells?r.large(w+1):r.small(b+1)}r.cellWidth=r.width/r.cols,r.cellHeight=r.height/r.rows,r.condense&&(r.cellWidth=0,r.cellHeight=0),r.preventOverlap&&h.forEach(b=>{(!b.x||!b.y)&&(b.x=0,b.y=0);let w,A;xs(b.size)?(w=b.size[0],A=b.size[1]):En(b.size)?(w=b.size,A=b.size):Ea(b.size)&&(w=b.size.width,A=b.size.height),(w===void 0||A===void 0)&&(xs(r.nodeSize)?(w=r.nodeSize[0],A=r.nodeSize[1]):En(r.nodeSize)?(w=r.nodeSize,A=r.nodeSize):(w=30,A=30));const O=r.preventOverlapPadding,D=w+O,_=A+O;r.cellWidth=Math.max(r.cellWidth,D),r.cellHeight=Math.max(r.cellHeight,_)}),r.cellUsed={},r.row=0,r.col=0,r.id2manPos={};for(let b=0;b<h.length;b++){const w=h[b];let A;if(r.position&&(A=r.position(w)),A&&(A.row!==void 0||A.col!==void 0)){const O={row:A.row,col:A.col};if(O.col===void 0)for(O.col=0;r.used(O.row,O.col);)O.col++;else if(O.row===void 0)for(O.row=0;r.used(O.row,O.col);)O.row++;r.id2manPos[w.id]=O,r.use(O.row,O.col)}r.getPos(w)}return r.onLayoutEnd&&r.onLayoutEnd(),{edges:s,nodes:h}}small(r){const o=this;let s;const l=o.rows||5,u=o.cols||5;return r==null?s=Math.min(l,u):Math.min(l,u)===o.rows?o.rows=r:o.cols=r,s}large(r){const o=this;let s;const l=o.rows||5,u=o.cols||5;return r==null?s=Math.max(l,u):Math.max(l,u)===o.rows?o.rows=r:o.cols=r,s}used(r,o){return this.cellUsed[`c-${r}-${o}`]||!1}use(r,o){const s=this;s.cellUsed[`c-${r}-${o}`]=!0}moveToNextCell(){const r=this,o=r.cols||5;r.col++,r.col>=o&&(r.col=0,r.row++)}getPos(r){const o=this,s=o.begin,l=o.cellWidth,u=o.cellHeight;let h,p;const g=o.id2manPos[r.id];if(g)h=g.col*l+l/2+s[0],p=g.row*u+u/2+s[1];else{for(;o.used(o.row,o.col);)o.moveToNextCell();h=o.col*l+l/2+s[0],p=o.row*u+u/2+s[1],o.use(o.row,o.col),o.moveToNextCell()}r.x=h,r.y=p}getType(){return"grid"}}const Xl=(n,r)=>{let o;return n?En(n)?o=s=>n:o=n:o=s=>r||1,o};class fm extends _s{constructor(r){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(r)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0}}execute(){var r,o;const s=this,l=s.nodes;if(s.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(s.timeInterval),!l||l.length===0){(r=s.onLayoutEnd)===null||r===void 0||r.call(s);return}!s.width&&typeof window<"u"&&(s.width=window.innerWidth),!s.height&&typeof window<"u"&&(s.height=window.innerHeight),s.center||(s.center=[s.width/2,s.height/2]);const u=s.center;if(l.length===1){l[0].x=u[0],l[0].y=u[1],(o=s.onLayoutEnd)===null||o===void 0||o.call(s);return}const h={},p={};l.forEach((w,A)=>{En(w.x)||(w.x=Math.random()*s.width),En(w.y)||(w.y=Math.random()*s.height),h[w.id]=w,p[w.id]=A}),s.nodeMap=h,s.nodeIdxMap=p,s.linkDistance=Xl(s.linkDistance,1),s.nodeStrength=Xl(s.nodeStrength,1),s.edgeStrength=Xl(s.edgeStrength,1);const g=s.nodeSize;let v;if(s.preventOverlap){const w=s.nodeSpacing;let A;En(w)?A=()=>w:Sa(w)?A=w:A=()=>0,g?xs(g)?v=O=>(g[0]>g[1]?g[0]:g[1])+A(O):v=O=>g+A(O):v=O=>O.size?xs(O.size)?(O.size[0]>O.size[1]?O.size[0]:O.size[1])+A(O):Ea(O.size)?(O.size.width>O.size.height?O.size.width:O.size.height)+A(O):O.size+A(O):10+A(O)}s.nodeSize=v;const b=s.edges;s.degrees=Nc(l.length,s.nodeIdxMap,b),s.getMass||(s.getMass=w=>s.degrees[s.nodeIdxMap[w.id]]||1),s.run()}run(){var r;const o=this,{maxIteration:s,nodes:l,workerEnabled:u,minMovement:h}=o;if(!!l)if(u){for(let p=0;p<s;p++){const g=o.runOneStep(p);if(o.reachMoveThreshold(l,g,h))break}(r=o.onLayoutEnd)===null||r===void 0||r.call(o)}else{if(typeof window>"u")return;let p=0;this.timeInterval=window.setInterval(()=>{var g,v;if(!l)return;const b=o.runOneStep(p)||[];o.reachMoveThreshold(l,b,h)&&((g=o.onLayoutEnd)===null||g===void 0||g.call(o),window.clearInterval(o.timeInterval)),p++,p>=s&&((v=o.onLayoutEnd)===null||v===void 0||v.call(o),window.clearInterval(o.timeInterval))},0)}}reachMoveThreshold(r,o,s){let l=0;return r.forEach((u,h)=>{const p=u.x-o[h].x,g=u.y-o[h].y;l+=Math.sqrt(p*p+g*g)}),l/=r.length,l<s}runOneStep(r){var o;const s=this,{nodes:l,edges:u}=s,h=[],p=[];if(!l)return;l.forEach((b,w)=>{h[2*w]=0,h[2*w+1]=0,p[2*w]=0,p[2*w+1]=0}),s.calRepulsive(h,l),u&&s.calAttractive(h,u),s.calGravity(h,l);const g=Math.max(.02,s.interval-r*.002);s.updateVelocity(h,p,g,l);const v=[];return l.forEach(b=>{v.push({x:b.x,y:b.y})}),s.updatePosition(p,g,l),(o=s.tick)===null||o===void 0||o.call(s),v}calRepulsive(r,o){const s=this,l=s.getMass,u=s.nodeStrength,h=s.factor,p=s.coulombDisScale,g=s.preventOverlap,v=s.nodeSize;o.forEach((b,w)=>{const A=l?l(b):1;o.forEach((O,D)=>{if(w>=D)return;const _=b.x-O.x,I=b.y-O.y,B=Math.sqrt(_*_+I*I)+.01,G=(B+.1)*p,K=_/B,ve=I/B,ae=(u(b)+u(O))/2*h/(G*G),Ye=l?l(O):1;if(r[2*w]+=K*ae,r[2*w+1]+=ve*ae,r[2*D]-=K*ae,r[2*D+1]-=ve*ae,g&&B<(v(b)+v(O))/2){const rt=(u(b)+u(O))/2/(B*B);r[2*w]+=K*rt/A,r[2*w+1]+=ve*rt/A,r[2*D]-=K*rt/Ye,r[2*D+1]-=ve*rt/Ye}})})}calAttractive(r,o){const s=this,l=s.nodeMap,u=s.nodeIdxMap,h=s.linkDistance,p=s.edgeStrength,g=s.getMass;o.forEach((v,b)=>{const w=Kr(v,"source"),A=Kr(v,"target"),O=l[w],D=l[A],_=D.x-O.x,I=D.y-O.y,B=Math.sqrt(_*_+I*I)+.01,G=_/B,K=I/B,Ye=((h(v)||1)-B)*p(v),rt=u[w],st=u[A],tn=g?g(O):1,bt=g?g(D):1;r[2*rt]-=G*Ye/tn,r[2*rt+1]-=K*Ye/tn,r[2*st]+=G*Ye/bt,r[2*st+1]+=K*Ye/bt})}calGravity(r,o){const s=this,l=s.center,u=s.gravity,h=s.degrees,p=o.length;for(let g=0;g<p;g++){const v=o[g];let b=v.x-l[0],w=v.y-l[1],A=u;if(s.getCenter){const O=s.getCenter(v,h[g]);O&&En(O[0])&&En(O[1])&&En(O[2])&&(b=v.x-O[0],w=v.y-O[1],A=O[2])}!A||(r[2*g]-=A*b,r[2*g+1]-=A*w)}}updateVelocity(r,o,s,l){const u=this,h=s*u.damping;l.forEach((p,g)=>{let v=r[2*g]*h||.01,b=r[2*g+1]*h||.01;const w=Math.sqrt(v*v+b*b);if(w>u.maxSpeed){const A=u.maxSpeed/w;v=A*v,b=A*b}o[2*g]=v,o[2*g+1]=b})}updatePosition(r,o,s){s.forEach((l,u)=>{if(En(l.fx)&&En(l.fy)){l.x=l.fx,l.y=l.fy;return}const h=r[2*u]*o,p=r[2*u+1]*o;l.x+=h,l.y+=p})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)}destroy(){const r=this;r.stop(),r.tick=null,r.nodes=null,r.edges=null,r.destroyed=!0}getType(){return"gForce"}}function eg(n){const r=+this._x.call(null,n),o=+this._y.call(null,n);return pm(this.cover(r,o),r,o,n)}function pm(n,r,o,s){if(isNaN(r)||isNaN(o))return n;var l,u=n._root,h={data:s},p=n._x0,g=n._y0,v=n._x1,b=n._y1,w,A,O,D,_,I,B,G;if(!u)return n._root=h,n;for(;u.length;)if((_=r>=(w=(p+v)/2))?p=w:v=w,(I=o>=(A=(g+b)/2))?g=A:b=A,l=u,!(u=u[B=I<<1|_]))return l[B]=h,n;if(O=+n._x.call(null,u.data),D=+n._y.call(null,u.data),r===O&&o===D)return h.next=u,l?l[B]=h:n._root=h,n;do l=l?l[B]=new Array(4):n._root=new Array(4),(_=r>=(w=(p+v)/2))?p=w:v=w,(I=o>=(A=(g+b)/2))?g=A:b=A;while((B=I<<1|_)===(G=(D>=A)<<1|O>=w));return l[G]=u,l[B]=h,n}function J0(n){var r,o,s=n.length,l,u,h=new Array(s),p=new Array(s),g=1/0,v=1/0,b=-1/0,w=-1/0;for(o=0;o<s;++o)isNaN(l=+this._x.call(null,r=n[o]))||isNaN(u=+this._y.call(null,r))||(h[o]=l,p[o]=u,l<g&&(g=l),l>b&&(b=l),u<v&&(v=u),u>w&&(w=u));if(g>b||v>w)return this;for(this.cover(g,v).cover(b,w),o=0;o<s;++o)pm(this,h[o],p[o],n[o]);return this}function Q0(n,r){if(isNaN(n=+n)||isNaN(r=+r))return this;var o=this._x0,s=this._y0,l=this._x1,u=this._y1;if(isNaN(o))l=(o=Math.floor(n))+1,u=(s=Math.floor(r))+1;else{for(var h=l-o||1,p=this._root,g,v;o>n||n>=l||s>r||r>=u;)switch(v=(r<s)<<1|n<o,g=new Array(4),g[v]=p,p=g,h*=2,v){case 0:l=o+h,u=s+h;break;case 1:o=l-h,u=s+h;break;case 2:l=o+h,s=u-h;break;case 3:o=l-h,s=u-h;break}this._root&&this._root.length&&(this._root=p)}return this._x0=o,this._y0=s,this._x1=l,this._y1=u,this}function kc(){var n=[];return this.visit(function(r){if(!r.length)do n.push(r.data);while(r=r.next)}),n}function gm(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Ns(n,r,o,s,l){this.node=n,this.x0=r,this.y0=o,this.x1=s,this.y1=l}function mm(n,r,o){var s,l=this._x0,u=this._y0,h,p,g,v,b=this._x1,w=this._y1,A=[],O=this._root,D,_;for(O&&A.push(new Ns(O,l,u,b,w)),o==null?o=1/0:(l=n-o,u=r-o,b=n+o,w=r+o,o*=o);D=A.pop();)if(!(!(O=D.node)||(h=D.x0)>b||(p=D.y0)>w||(g=D.x1)<l||(v=D.y1)<u))if(O.length){var I=(h+g)/2,B=(p+v)/2;A.push(new Ns(O[3],I,B,g,v),new Ns(O[2],h,B,I,v),new Ns(O[1],I,p,g,B),new Ns(O[0],h,p,I,B)),(_=(r>=B)<<1|n>=I)&&(D=A[A.length-1],A[A.length-1]=A[A.length-1-_],A[A.length-1-_]=D)}else{var G=n-+this._x.call(null,O.data),K=r-+this._y.call(null,O.data),ve=G*G+K*K;if(ve<o){var ae=Math.sqrt(o=ve);l=n-ae,u=r-ae,b=n+ae,w=r+ae,s=O.data}}return s}function ev(n){if(isNaN(b=+this._x.call(null,n))||isNaN(w=+this._y.call(null,n)))return this;var r,o=this._root,s,l,u,h=this._x0,p=this._y0,g=this._x1,v=this._y1,b,w,A,O,D,_,I,B;if(!o)return this;if(o.length)for(;;){if((D=b>=(A=(h+g)/2))?h=A:g=A,(_=w>=(O=(p+v)/2))?p=O:v=O,r=o,!(o=o[I=_<<1|D]))return this;if(!o.length)break;(r[I+1&3]||r[I+2&3]||r[I+3&3])&&(s=r,B=I)}for(;o.data!==n;)if(l=o,!(o=o.next))return this;return(u=o.next)&&delete o.next,l?(u?l.next=u:delete l.next,this):r?(u?r[I]=u:delete r[I],(o=r[0]||r[1]||r[2]||r[3])&&o===(r[3]||r[2]||r[1]||r[0])&&!o.length&&(s?s[B]=o:this._root=o),this):(this._root=u,this)}function vm(n){for(var r=0,o=n.length;r<o;++r)this.remove(n[r]);return this}function ym(){return this._root}function fl(){var n=0;return this.visit(function(r){if(!r.length)do++n;while(r=r.next)}),n}function bm(n){var r=[],o,s=this._root,l,u,h,p,g;for(s&&r.push(new Ns(s,this._x0,this._y0,this._x1,this._y1));o=r.pop();)if(!n(s=o.node,u=o.x0,h=o.y0,p=o.x1,g=o.y1)&&s.length){var v=(u+p)/2,b=(h+g)/2;(l=s[3])&&r.push(new Ns(l,v,b,p,g)),(l=s[2])&&r.push(new Ns(l,u,b,v,g)),(l=s[1])&&r.push(new Ns(l,v,h,p,b)),(l=s[0])&&r.push(new Ns(l,u,h,v,b))}return this}function bd(n){var r=[],o=[],s;for(this._root&&r.push(new Ns(this._root,this._x0,this._y0,this._x1,this._y1));s=r.pop();){var l=s.node;if(l.length){var u,h=s.x0,p=s.y0,g=s.x1,v=s.y1,b=(h+g)/2,w=(p+v)/2;(u=l[0])&&r.push(new Ns(u,h,p,b,w)),(u=l[1])&&r.push(new Ns(u,b,p,g,w)),(u=l[2])&&r.push(new Ns(u,h,w,b,v)),(u=l[3])&&r.push(new Ns(u,b,w,g,v))}o.push(s)}for(;s=o.pop();)n(s.node,s.x0,s.y0,s.x1,s.y1);return this}function Yl(n){return n[0]}function xm(n){return arguments.length?(this._x=n,this):this._x}function tg(n){return n[1]}function jf(n){return arguments.length?(this._y=n,this):this._y}function Hf(n,r,o){var s=new fs(r??Yl,o??tg,NaN,NaN,NaN,NaN);return n==null?s:s.addAll(n)}function fs(n,r,o,s,l,u){this._x=n,this._y=r,this._x0=o,this._y0=s,this._x1=l,this._y1=u,this._root=void 0}function Kl(n){for(var r={data:n.data},o=r;n=n.next;)o=o.next={data:n.data};return r}var hi=Hf.prototype=fs.prototype;hi.copy=function(){var n=new fs(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root,o,s;if(!r)return n;if(!r.length)return n._root=Kl(r),n;for(o=[{source:r,target:n._root=new Array(4)}];r=o.pop();)for(var l=0;l<4;++l)(s=r.source[l])&&(s.length?o.push({source:s,target:r.target[l]=new Array(4)}):r.target[l]=Kl(s));return n},hi.add=eg,hi.addAll=J0,hi.cover=Q0,hi.data=kc,hi.extent=gm,hi.find=mm,hi.remove=ev,hi.removeAll=vm,hi.root=ym,hi.size=fl,hi.visit=bm,hi.visitAfter=bd,hi.x=xm,hi.y=jf;function Fi(n){return function(){return n}}function ql(n){return(n()-.5)*1e-6}var tv={value:function(){}};function Cm(){for(var n=0,r=arguments.length,o={},s;n<r;++n){if(!(s=arguments[n]+"")||s in o||/[\s.]/.test(s))throw new Error("illegal type: "+s);o[s]=[]}return new $f(o)}function $f(n){this._=n}function wm(n,r){return n.trim().split(/^|\s+/).map(function(o){var s="",l=o.indexOf(".");if(l>=0&&(s=o.slice(l+1),o=o.slice(0,l)),o&&!r.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:s}})}$f.prototype=Cm.prototype={constructor:$f,on:function(r,o){var s=this._,l=wm(r+"",s),u,h=-1,p=l.length;if(arguments.length<2){for(;++h<p;)if((u=(r=l[h]).type)&&(u=Em(s[u],r.name)))return u;return}if(o!=null&&typeof o!="function")throw new Error("invalid callback: "+o);for(;++h<p;)if(u=(r=l[h]).type)s[u]=Sm(s[u],r.name,o);else if(o==null)for(u in s)s[u]=Sm(s[u],r.name,null);return this},copy:function(){var r={},o=this._;for(var s in o)r[s]=o[s].slice();return new $f(r)},call:function(r,o){if((u=arguments.length-2)>0)for(var s=new Array(u),l=0,u,h;l<u;++l)s[l]=arguments[l+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(h=this._[r],l=0,u=h.length;l<u;++l)h[l].value.apply(o,s)},apply:function(r,o,s){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var l=this._[r],u=0,h=l.length;u<h;++u)l[u].value.apply(o,s)}};function Em(n,r){for(var o=0,s=n.length,l;o<s;++o)if((l=n[o]).name===r)return l.value}function Sm(n,r,o){for(var s=0,l=n.length;s<l;++s)if(n[s].name===r){n[s]=tv,n=n.slice(0,s).concat(n.slice(s+1));break}return o!=null&&n.push({name:r,value:o}),n}var nv=Cm,xd=0,Eh=0,Cd=0,ng=1e3,Sh,wd,Wf=0,xu=0,Ah=0,Rc=typeof performance=="object"&&performance.now?performance:Date,z=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function de(){return xu||(z(_e),xu=Rc.now()+Ah)}function _e(){xu=0}function at(){this._call=this._time=this._next=null}at.prototype=Tt.prototype={constructor:at,restart:function(n,r,o){if(typeof n!="function")throw new TypeError("callback is not a function");o=(o==null?de():+o)+(r==null?0:+r),!this._next&&wd!==this&&(wd?wd._next=this:Sh=this,wd=this),this._call=n,this._time=o,Kt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Kt())}};function Tt(n,r,o){var s=new at;return s.restart(n,r,o),s}function lt(){de(),++xd;for(var n=Sh,r;n;)(r=xu-n._time)>=0&&n._call.call(null,r),n=n._next;--xd}function mt(){xu=(Wf=Rc.now())+Ah,xd=Eh=0;try{lt()}finally{xd=0,Ht(),xu=0}}function zt(){var n=Rc.now(),r=n-Wf;r>ng&&(Ah-=r,Wf=n)}function Ht(){for(var n,r=Sh,o,s=1/0;r;)r._call?(s>r._time&&(s=r._time),n=r,r=r._next):(o=r._next,r._next=null,r=n?n._next=o:Sh=o);wd=n,Kt(s)}function Kt(n){if(!xd){Eh&&(Eh=clearTimeout(Eh));var r=n-xu;r>24?(n<1/0&&(Eh=setTimeout(mt,n-Rc.now()-Ah)),Cd&&(Cd=clearInterval(Cd))):(Cd||(Wf=Rc.now(),Cd=setInterval(zt,ng)),xd=1,z(mt))}}var $t=1664525,sn=1013904223,fn=4294967296;function Ut(){var n=1;return function(){return(n=($t*n+sn)%fn)/fn}}function an(n){return n.x}function Je(n){return n.y}var yt=10,Jt=Math.PI*(3-Math.sqrt(5));function mn(n){var r,o=1,s=.001,l=1-Math.pow(s,1/300),u=0,h=.6,p=new Map,g=Tt(w),v=nv("tick","end"),b=Ut();n==null&&(n=[]);function w(){A(),v.call("tick",r),o<s&&(g.stop(),v.call("end",r))}function A(_){var I,B=n.length,G;_===void 0&&(_=1);for(var K=0;K<_;++K)for(o+=(u-o)*l,p.forEach(function(ve){ve(o)}),I=0;I<B;++I)G=n[I],G.fx==null?G.x+=G.vx*=h:(G.x=G.fx,G.vx=0),G.fy==null?G.y+=G.vy*=h:(G.y=G.fy,G.vy=0);return r}function O(){for(var _=0,I=n.length,B;_<I;++_){if(B=n[_],B.index=_,B.fx!=null&&(B.x=B.fx),B.fy!=null&&(B.y=B.fy),isNaN(B.x)||isNaN(B.y)){var G=yt*Math.sqrt(.5+_),K=_*Jt;B.x=G*Math.cos(K),B.y=G*Math.sin(K)}(isNaN(B.vx)||isNaN(B.vy))&&(B.vx=B.vy=0)}}function D(_){return _.initialize&&_.initialize(n,b),_}return O(),r={tick:A,restart:function(){return g.restart(w),r},stop:function(){return g.stop(),r},nodes:function(I){return arguments.length?(n=I,O(),p.forEach(D),r):n},alpha:function(I){return arguments.length?(o=+I,r):o},alphaMin:function(I){return arguments.length?(s=+I,r):s},alphaDecay:function(I){return arguments.length?(l=+I,r):+l},alphaTarget:function(I){return arguments.length?(u=+I,r):u},velocityDecay:function(I){return arguments.length?(h=1-I,r):1-h},randomSource:function(I){return arguments.length?(b=I,p.forEach(D),r):b},force:function(I,B){return arguments.length>1?(B==null?p.delete(I):p.set(I,D(B)),r):p.get(I)},find:function(I,B,G){var K=0,ve=n.length,ae,Ye,rt,st,tn;for(G==null?G=1/0:G*=G,K=0;K<ve;++K)st=n[K],ae=I-st.x,Ye=B-st.y,rt=ae*ae+Ye*Ye,rt<G&&(tn=st,G=rt);return tn},on:function(I,B){return arguments.length>1?(v.on(I,B),r):v.on(I)}}}function Dt(){var n,r,o,s,l=Fi(-30),u,h=1,p=1/0,g=.81;function v(O){var D,_=n.length,I=Hf(n,an,Je).visitAfter(w);for(s=O,D=0;D<_;++D)r=n[D],I.visit(A)}function b(){if(!!n){var O,D=n.length,_;for(u=new Array(D),O=0;O<D;++O)_=n[O],u[_.index]=+l(_,O,n)}}function w(O){var D=0,_,I,B=0,G,K,ve;if(O.length){for(G=K=ve=0;ve<4;++ve)(_=O[ve])&&(I=Math.abs(_.value))&&(D+=_.value,B+=I,G+=I*_.x,K+=I*_.y);O.x=G/B,O.y=K/B}else{_=O,_.x=_.data.x,_.y=_.data.y;do D+=u[_.data.index];while(_=_.next)}O.value=D}function A(O,D,_,I){if(!O.value)return!0;var B=O.x-r.x,G=O.y-r.y,K=I-D,ve=B*B+G*G;if(K*K/g<ve)return ve<p&&(B===0&&(B=ql(o),ve+=B*B),G===0&&(G=ql(o),ve+=G*G),ve<h&&(ve=Math.sqrt(h*ve)),r.vx+=B*O.value*s/ve,r.vy+=G*O.value*s/ve),!0;if(O.length||ve>=p)return;(O.data!==r||O.next)&&(B===0&&(B=ql(o),ve+=B*B),G===0&&(G=ql(o),ve+=G*G),ve<h&&(ve=Math.sqrt(h*ve)));do O.data!==r&&(K=u[O.data.index]*s/ve,r.vx+=B*K,r.vy+=G*K);while(O=O.next)}return v.initialize=function(O,D){n=O,o=D,b()},v.strength=function(O){return arguments.length?(l=typeof O=="function"?O:Fi(+O),b(),v):l},v.distanceMin=function(O){return arguments.length?(h=O*O,v):Math.sqrt(h)},v.distanceMax=function(O){return arguments.length?(p=O*O,v):Math.sqrt(p)},v.theta=function(O){return arguments.length?(g=O*O,v):Math.sqrt(g)},v}function Cn(n,r){var o,s=1;n==null&&(n=0),r==null&&(r=0);function l(){var u,h=o.length,p,g=0,v=0;for(u=0;u<h;++u)p=o[u],g+=p.x,v+=p.y;for(g=(g/h-n)*s,v=(v/h-r)*s,u=0;u<h;++u)p=o[u],p.x-=g,p.y-=v}return l.initialize=function(u){o=u},l.x=function(u){return arguments.length?(n=+u,l):n},l.y=function(u){return arguments.length?(r=+u,l):r},l.strength=function(u){return arguments.length?(s=+u,l):s},l}function Ft(n){return n.index}function ln(n,r){var o=n.get(r);if(!o)throw new Error("node not found: "+r);return o}function Nt(n){var r=Ft,o=w,s,l=Fi(30),u,h,p,g,v,b=1;n==null&&(n=[]);function w(I){return 1/Math.min(p[I.source.index],p[I.target.index])}function A(I){for(var B=0,G=n.length;B<b;++B)for(var K=0,ve,ae,Ye,rt,st,tn,bt;K<G;++K)ve=n[K],ae=ve.source,Ye=ve.target,rt=Ye.x+Ye.vx-ae.x-ae.vx||ql(v),st=Ye.y+Ye.vy-ae.y-ae.vy||ql(v),tn=Math.sqrt(rt*rt+st*st),tn=(tn-u[K])/tn*I*s[K],rt*=tn,st*=tn,Ye.vx-=rt*(bt=g[K]),Ye.vy-=st*bt,ae.vx+=rt*(bt=1-bt),ae.vy+=st*bt}function O(){if(!!h){var I,B=h.length,G=n.length,K=new Map(h.map(function(ae,Ye){return[r(ae,Ye,h),ae]})),ve;for(I=0,p=new Array(B);I<G;++I)ve=n[I],ve.index=I,Hr()(ve.source)!=="object"&&(ve.source=ln(K,ve.source)),Hr()(ve.target)!=="object"&&(ve.target=ln(K,ve.target)),p[ve.source.index]=(p[ve.source.index]||0)+1,p[ve.target.index]=(p[ve.target.index]||0)+1;for(I=0,g=new Array(G);I<G;++I)ve=n[I],g[I]=p[ve.source.index]/(p[ve.source.index]+p[ve.target.index]);s=new Array(G),D(),u=new Array(G),_()}}function D(){if(!!h)for(var I=0,B=n.length;I<B;++I)s[I]=+o(n[I],I,n)}function _(){if(!!h)for(var I=0,B=n.length;I<B;++I)u[I]=+l(n[I],I,n)}return A.initialize=function(I,B){h=I,v=B,O()},A.links=function(I){return arguments.length?(n=I,O(),A):n},A.id=function(I){return arguments.length?(r=I,A):r},A.iterations=function(I){return arguments.length?(b=+I,A):b},A.strength=function(I){return arguments.length?(o=typeof I=="function"?I:Fi(+I),D(),A):o},A.distance=function(I){return arguments.length?(l=typeof I=="function"?I:Fi(+I),_(),A):l},A}function un(n){return n.x+n.vx}function $n(n){return n.y+n.vy}function lr(n){var r,o,s,l=1,u=1;typeof n!="function"&&(n=Fi(n==null?1:+n));function h(){for(var v,b=r.length,w,A,O,D,_,I,B=0;B<u;++B)for(w=Hf(r,un,$n).visitAfter(p),v=0;v<b;++v)A=r[v],_=o[A.index],I=_*_,O=A.x+A.vx,D=A.y+A.vy,w.visit(G);function G(K,ve,ae,Ye,rt){var st=K.data,tn=K.r,bt=_+tn;if(st){if(st.index>A.index){var jt=O-st.x-st.vx,et=D-st.y-st.vy,An=jt*jt+et*et;An<bt*bt&&(jt===0&&(jt=ql(s),An+=jt*jt),et===0&&(et=ql(s),An+=et*et),An=(bt-(An=Math.sqrt(An)))/An*l,A.vx+=(jt*=An)*(bt=(tn*=tn)/(I+tn)),A.vy+=(et*=An)*bt,st.vx-=jt*(bt=1-bt),st.vy-=et*bt)}return}return ve>O+bt||Ye<O-bt||ae>D+bt||rt<D-bt}}function p(v){if(v.data)return v.r=o[v.data.index];for(var b=v.r=0;b<4;++b)v[b]&&v[b].r>v.r&&(v.r=v[b].r)}function g(){if(!!r){var v,b=r.length,w;for(o=new Array(b),v=0;v<b;++v)w=r[v],o[w.index]=+n(w,v,r)}}return h.initialize=function(v,b){r=v,s=b,g()},h.iterations=function(v){return arguments.length?(u=+v,h):u},h.strength=function(v){return arguments.length?(l=+v,h):l},h.radius=function(v){return arguments.length?(n=typeof v=="function"?v:Fi(+v),g(),h):n},h}function pn(n){var r=Fi(.1),o,s,l;typeof n!="function"&&(n=Fi(n==null?0:+n));function u(p){for(var g=0,v=o.length,b;g<v;++g)b=o[g],b.vx+=(l[g]-b.x)*s[g]*p}function h(){if(!!o){var p,g=o.length;for(s=new Array(g),l=new Array(g),p=0;p<g;++p)s[p]=isNaN(l[p]=+n(o[p],p,o))?0:+r(o[p],p,o)}}return u.initialize=function(p){o=p,h()},u.strength=function(p){return arguments.length?(r=typeof p=="function"?p:Fi(+p),h(),u):r},u.x=function(p){return arguments.length?(n=typeof p=="function"?p:Fi(+p),h(),u):n},u}function en(n){var r=Fi(.1),o,s,l;typeof n!="function"&&(n=Fi(n==null?0:+n));function u(p){for(var g=0,v=o.length,b;g<v;++g)b=o[g],b.vy+=(l[g]-b.y)*s[g]*p}function h(){if(!!o){var p,g=o.length;for(s=new Array(g),l=new Array(g),p=0;p<g;++p)s[p]=isNaN(l[p]=+n(o[p],p,o))?0:+r(o[p],p,o)}}return u.initialize=function(p){o=p,h()},u.strength=function(p){return arguments.length?(r=typeof p=="function"?p:Fi(+p),h(),u):r},u.y=function(p){return arguments.length?(n=typeof p=="function"?p:Fi(+p),h(),u):n},u}function Ot(){function n(hn){return()=>hn}let r=hn=>hn.cluster,o=n(1),s=n(-1),l=n(100),u=n(.1),h=[0,0],p=[],g={},v=[],b=100,w=100,A={none:{x:0,y:0}},O=[],D,_="force",I=!0,B=.1;function G(hn){if(!I)return G;D.tick(),st();for(let Xn=0,oi=p.length,ui,Ai=hn*B;Xn<oi;++Xn)ui=p[Xn],ui.vx+=(A[r(ui)].x-ui.x)*Ai,ui.vy+=(A[r(ui)].y-ui.y)*Ai}function K(){!p||ve()}function ve(){if(!p||!p.length)return;if(r(p[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const hn=ae();D=mn(hn.nodes).force("x",pn(b).strength(.1)).force("y",en(w).strength(.1)).force("collide",lr(Xn=>Xn.r).iterations(4)).force("charge",Dt().strength(s)).force("links",Nt(hn.nodes.length?hn.links:[]).distance(l).strength(u)),O=D.nodes(),st()}function ae(){const hn=[],Xn=[],oi={};let ui=[],Ai={},Er=[];return Ai=Ye(p),Er=rt(v),ui=Object.keys(Ai),ui.forEach((jo,Zs)=>{const Ui=Ai[jo];hn.push({id:jo,size:Ui.count,r:Math.sqrt(Ui.sumforceNodeSize/Math.PI)}),oi[jo]=Zs}),Er.forEach(jo=>{const Zs=Kr(jo,"source"),Ui=Kr(jo,"target"),Zc=oi[Zs],Xc=oi[Ui];Zc!==void 0&&Xc!==void 0&&Xn.push({source:Zc,target:Xc,count:jo.count})}),{nodes:hn,links:Xn}}function Ye(hn){const Xn={};return hn.forEach(oi=>{const ui=r(oi);Xn[ui]||(Xn[ui]={count:0,sumforceNodeSize:0})}),hn.forEach(oi=>{const ui=r(oi),Ai=o(oi),Er=Xn[ui];Er.count=Er.count+1,Er.sumforceNodeSize=Er.sumforceNodeSize+Math.PI*(Ai*Ai)*1.3,Xn[ui]=Er}),Xn}function rt(hn){const Xn={},oi=[];return hn.forEach(Ai=>{const Er=tn(Ai);let jo=0;Xn[Er]!==void 0&&(jo=Xn[Er]),jo+=1,Xn[Er]=jo}),Object.entries(Xn).forEach(([Ai,Er])=>{const jo=Ai.split("~")[0],Zs=Ai.split("~")[1];jo!==void 0&&Zs!==void 0&&oi.push({source:jo,target:Zs,count:Er})}),oi}function st(){return A={none:{x:0,y:0}},O.forEach(hn=>{A[hn.id]={x:hn.x-h[0],y:hn.y-h[1]}}),A}function tn(hn){const Xn=Kr(hn,"source"),oi=Kr(hn,"target"),ui=r(g[Xn]),Ai=r(g[oi]);return ui<=Ai?`${ui}~${Ai}`:`${Ai}~${ui}`}function bt(hn){g={},hn.forEach(Xn=>{g[Xn.id]=Xn})}function jt(hn){return arguments.length?(_=hn,K(),G):_}function et(hn){return arguments.length?typeof hn=="string"?(r=Xn=>Xn[hn],G):(r=hn,G):r}function An(hn){return arguments.length?(I=hn,G):I}function Vn(hn){return arguments.length?(B=hn,G):B}function Zn(hn){return arguments.length?(b=hn,G):b}function wi(hn){return arguments.length?(w=hn,G):w}function Ei(hn){return arguments.length?(bt(hn||[]),p=hn||[],G):p}function Dr(hn){return arguments.length?(v=hn||[],K(),G):v}function eo(hn){return arguments.length?(typeof hn=="function"?o=hn:o=n(+hn),K(),G):o}function Uo(hn){return arguments.length?(typeof hn=="function"?s=hn:s=n(+hn),K(),G):s}function Ur(hn){return arguments.length?(typeof hn=="function"?l=hn:l=n(+hn),K(),G):l}function Vo(hn){return arguments.length?(typeof hn=="function"?u=hn:u=n(+hn),K(),G):u}function gs(hn){return arguments.length?(h=hn,G):h}return G.initialize=hn=>{p=hn,K()},G.template=jt,G.groupBy=et,G.enableGrouping=An,G.strength=Vn,G.centerX=Zn,G.centerY=wi,G.nodes=Ei,G.links=Dr,G.forceNodeSize=eo,G.nodeSize=G.forceNodeSize,G.forceCharge=Uo,G.forceLinkDistance=Ur,G.forceLinkStrength=Vo,G.offset=gs,G.getFocis=st,G}const Jn={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};class Ar extends _s{constructor(r){super(),this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,r&&this.updateCfg(r)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(r){const o=this;o.nodes=r.nodes||[];const s=r.edges||[];o.edges=s.map(l=>{const u={},h=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(l).forEach(p=>{h.indexOf(p)>-1||(u[p]=l[p])}),u}),o.ticking=!1}execute(r){const o=this,s=o.nodes,l=o.edges;if(o.ticking)return;let u=o.forceSimulation;const h=o.alphaMin,p=o.alphaDecay,g=o.alpha;if(u){if(r){if(o.clustering&&o.clusterForce&&(o.clusterForce.nodes(s),o.clusterForce.links(l)),u.nodes(s),l&&o.edgeForce)o.edgeForce.links(l);else if(l&&!o.edgeForce){const v=Nt().id(b=>b.id).links(l);o.edgeStrength&&v.strength(o.edgeStrength),o.linkDistance&&v.distance(o.linkDistance),o.edgeForce=v,u.force("link",v)}}o.preventOverlap&&o.overlapProcess(u),u.alpha(g).restart(),this.ticking=!0}else try{const v=Dt();if(o.nodeStrength&&v.strength(o.nodeStrength),u=mn().nodes(s),o.clustering){const b=Ot();b.centerX(o.center[0]).centerY(o.center[1]).template("force").strength(o.clusterFociStrength),l&&b.links(l),s&&b.nodes(s),b.forceLinkDistance(o.clusterEdgeDistance).forceLinkStrength(o.clusterEdgeStrength).forceCharge(o.clusterNodeStrength).forceNodeSize(o.clusterNodeSize),o.clusterForce=b,u.force("group",b)}if(u.force("center",Cn(o.center[0],o.center[1])).force("charge",v).alpha(g).alphaDecay(p).alphaMin(h),o.preventOverlap&&o.overlapProcess(u),l){const b=Nt().id(w=>w.id).links(l);o.edgeStrength&&b.strength(o.edgeStrength),o.linkDistance&&b.distance(o.linkDistance),o.edgeForce=b,u.force("link",b)}if(o.workerEnabled&&!Lr()&&(o.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!o.workerEnabled)u.on("tick",()=>{o.tick()}).on("end",()=>{o.ticking=!1,o.onLayoutEnd&&o.onLayoutEnd()}),o.ticking=!0;else{u.stop();const b=Mn(u);for(let w=1;w<=b;w++)u.tick(),postMessage({nodes:s,currentTick:w,totalTicks:b,type:Jn.TICK},void 0);o.ticking=!1}o.forceSimulation=u,o.ticking=!0}catch(v){o.ticking=!1,console.warn(v)}}overlapProcess(r){const o=this,s=o.nodeSize,l=o.nodeSpacing;let u,h;const p=o.collideStrength;if(En(l)?h=()=>l:Sa(l)?h=l:h=()=>0,!s)u=g=>g.size?xs(g.size)?(g.size[0]>g.size[1]?g.size[0]:g.size[1])/2+h(g):Ea(g.size)?(g.size.width>g.size.height?g.size.width:g.size.height)/2+h(g):g.size/2+h(g):10+h(g);else if(Sa(s))u=g=>s(g)+h(g);else if(xs(s)){const v=(s[0]>s[1]?s[0]:s[1])/2;u=b=>v+h(b)}else if(En(s)){const g=s/2;u=v=>g+h(v)}else u=()=>10;r.force("collisionForce",lr(u).strength(p))}updateCfg(r){const o=this;o.ticking&&(o.forceSimulation.stop(),o.ticking=!1),o.forceSimulation=null,Object.assign(o,r)}destroy(){const r=this;r.ticking&&(r.forceSimulation.stop(),r.ticking=!1),r.nodes=null,r.edges=null,r.destroyed=!0}}function Mn(n){const r=n.alphaMin(),o=n.alphaTarget(),s=n.alpha(),l=Math.log((r-o)/(s-o))/Math.log(1-n.alphaDecay());return Math.ceil(l)}function Lr(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function hr(n,r,o,s){n.forEach((l,u)=>{n[u].children=[],n[u].parent=[]}),s?r.forEach(l=>{const u=Kr(l,"source"),h=Kr(l,"target");let p=0;u&&(p=o[u]);let g=0;h&&(g=o[h]);const v=n[p].children,b=n[g].parent;v.push(n[g].id),b.push(n[p].id)}):r.forEach(l=>{const u=Kr(l,"source"),h=Kr(l,"target");let p=0;u&&(p=o[u]);let g=0;h&&(g=o[h]);const v=n[p].children,b=n[g].children;v.push(n[g].id),b.push(n[p].id)})}function Mr(n,r,o){const s=o.length;for(let l=0;l<s;l++){const u=Kr(o[l],"source"),h=Kr(o[l],"target");if(n.id===u&&r.id===h||r.id===u&&n.id===h)return!0}return!1}function si(n,r){const o=n.degree,s=r.degree;return o<s?-1:o>s?1:0}class To extends _s{constructor(r){super(),this.radius=null,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(r)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){const r=this,o=r.nodes,s=r.edges,l=o.length;if(l===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const u=r.center;if(l===1){o[0].x=u[0],o[0].y=u[1],r.onLayoutEnd&&r.onLayoutEnd();return}let h=r.radius,p=r.startRadius,g=r.endRadius;const v=r.divisions,b=r.startAngle,w=r.endAngle,A=(w-b)/l,O={};o.forEach((ae,Ye)=>{O[ae.id]=Ye}),r.nodeMap=O;const D=Nc(o.length,O,s);r.degrees=D,!h&&!p&&!g?h=r.height>r.width?r.width/2:r.height/2:!p&&g?p=g:p&&!g&&(g=p);const _=r.angleRatio,I=A*_,B=r.ordering;let G=[];B==="topology"?G=r.topologyOrdering():B==="topology-directed"?G=r.topologyOrdering(!0):B==="degree"?G=r.degreeOrdering():G=o;const K=r.clockwise,ve=Math.ceil(l/v);for(let ae=0;ae<l;++ae){let Ye=h;!Ye&&p!==null&&g!==null&&(Ye=p+ae*(g-p)/(l-1)),Ye||(Ye=10+ae*100/(l-1));let rt=b+ae%ve*I+2*Math.PI/v*Math.floor(ae/ve);K||(rt=w-ae%ve*I-2*Math.PI/v*Math.floor(ae/ve)),G[ae].x=u[0]+Math.cos(rt)*Ye,G[ae].y=u[1]+Math.sin(rt)*Ye,G[ae].weight=D[ae]}return r.onLayoutEnd&&r.onLayoutEnd(),{nodes:G,edges:this.edges}}topologyOrdering(r=!1){const o=this,s=o.degrees,l=o.edges,u=o.nodes,h=_c(u),p=o.nodeMap,g=[h[0]],v=[u[0]],b=[],w=u.length;b[0]=!0,hr(h,l,p,r);let A=0;return h.forEach((O,D)=>{if(D!==0)if((D===w-1||s[D]!==s[D+1]||Mr(g[A],O,l))&&!b[D])g.push(O),v.push(u[p[O.id]]),b[D]=!0,A++;else{const _=g[A].children;let I=!1;for(let G=0;G<_.length;G++){const K=p[_[G]];if(s[K]===s[D]&&!b[K]){g.push(h[K]),v.push(u[p[h[K].id]]),b[K]=!0,I=!0;break}}let B=0;for(;!I&&(b[B]||(g.push(h[B]),v.push(u[p[h[B].id]]),b[B]=!0,I=!0),B++,B!==w););}}),v}degreeOrdering(){const r=this,o=r.nodes,s=[],l=r.degrees;return o.forEach((u,h)=>{u.degree=l[h],s.push(u)}),s.sort(si),s}getType(){return"circular"}}var Wo=P(85788),Vr=P.n(Wo);let oo=Vr();!oo&&typeof window<"u"&&(oo=window.graphlib),Array.prototype.flat||(Array.prototype.flat=function(n){let r=n||1;if(!isFinite(r))return;const o=this.length;let s=[];if(this.length===0)return this;for(;r--;){const l=[];let u=!1;if(s.length===0){u=!0;for(let h=0;h<o;h++)this[h]instanceof Array?s.push(...this[h]):s.push(this[h])}else{for(let h=0;h<s.length;h++)s[h]instanceof Array?(u=!0,l.push(...s[h])):l.push(s[h]);s=l}if(!u&&r===1/0)break}return s});var fi=oo;const so=n=>{n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev},Mo=(n,r)=>{if(n!=="_next"&&n!=="_prev")return r};class Po{constructor(){const r={};r._next=r._prev=r,this.isentinel=r}dequeue(){const r=this.isentinel,o=r._prev;if(o!==r)return so(o),o}enqueue(){const r=this.isentinel,o=r._prev;if(o!==r)return so(o),o}toString(){const r=[],o=this.isentinel;let s=o._prev;for(;s!==o;)r.push(JSON.stringify(s,Mo)),s=s._prev;return`[${r.join(", ")}]`}}var is=Po;const os=fi.Graph,mo=()=>1,wr=(n,r)=>{var o;if(n.nodeCount()<=1)return[];const s=Yn(n,r||mo);return(o=ss(s.graph,s.buckets,s.zeroIdx).map(u=>n.outEdges(u.v,u.w)))===null||o===void 0?void 0:o.flat()},ss=(n,r,o)=>{let s=[];const l=r[r.length-1],u=r[0];let h;for(;n.nodeCount();){for(;h=u.dequeue();)ai(n,r,o,h);for(;h=l.dequeue();)ai(n,r,o,h);if(n.nodeCount()){for(let p=r.length-2;p>0;--p)if(h=r[p].dequeue(),h){s=s.concat(ai(n,r,o,h,!0));break}}}return s},ai=(n,r,o,s,l)=>{var u,h;const p=l?[]:void 0;return(u=n.inEdges(s.v))===null||u===void 0||u.forEach(g=>{const v=n.edge(g),b=n.node(g.v);l&&p.push({v:g.v,w:g.w}),b.out===void 0&&(b.out=0),b.out-=v,kr(r,o,b)}),(h=n.outEdges(s.v))===null||h===void 0||h.forEach(g=>{const v=n.edge(g),b=g.w,w=n.node(b);w.in===void 0&&(w.in=0),w.in-=v,kr(r,o,w)}),n.removeNode(s.v),p},Yn=(n,r)=>{const o=new os;let s=0,l=0;n.nodes().forEach(g=>{o.setNode(g,{v:g,in:0,out:0})}),n.edges().forEach(g=>{const v=o.edge(g.v,g.w)||0,b=r==null?void 0:r(g),w=v+b;o.setEdge(g.v,g.w,w),l=Math.max(l,o.node(g.v).out+=b),s=Math.max(s,o.node(g.w).in+=b)});const u=[],h=l+s+3;for(let g=0;g<h;g++)u.push(new is);const p=s+1;return o.nodes().forEach(g=>{kr(u,p,o.node(g))}),{buckets:u,zeroIdx:p,graph:o}},kr=(n,r,o)=>{o.out?o.in?n[o.out-o.in+r].enqueue(o):n[n.length-1].enqueue(o):n[0].enqueue(o)};var Wr=wr;const ao=n=>{const r=s=>l=>s.edge(l).weight,o=n.graph().acyclicer==="greedy"?Wr(n,r(n)):Us(n);o==null||o.forEach(s=>{const l=n.edge(s);n.removeEdge(s),l.forwardName=s.name,l.reversed=!0,n.setEdge(s.w,s.v,l,`rev-${Math.random()}`)})},Us=n=>{const r=[],o={},s={},l=u=>{var h;s.hasOwnProperty(u)||(s[u]=!0,o[u]=!0,(h=n.outEdges(u))===null||h===void 0||h.forEach(p=>{o.hasOwnProperty(p.w)?r.push(p):l(p.w)}),delete o[u])};return n.nodes().forEach(l),r};var Te={run:ao,undo:n=>{n.edges().forEach(r=>{const o=n.edge(r);if(o.reversed){n.removeEdge(r);const s=o.forwardName;delete o.reversed,delete o.forwardName,n.setEdge(r.w,r.v,o,s)}})}};const ut=fi.Graph,ot=(n,r,o,s)=>{let l;do l=`${s}${Math.random()}`;while(n.hasNode(l));return o.dummy=r,n.setNode(l,o),l},wn=n=>{const r=new ut().setGraph(n.graph());return n.nodes().forEach(o=>{r.setNode(o,n.node(o))}),n.edges().forEach(o=>{const s=r.edge(o.v,o.w)||{weight:0,minlen:1},l=n.edge(o);r.setEdge(o.v,o.w,{weight:s.weight+l.weight,minlen:Math.max(s.minlen,l.minlen)})}),r},Rr=n=>{const r=new ut({multigraph:n.isMultigraph()}).setGraph(n.graph());return n.nodes().forEach(o=>{var s;!((s=n.children(o))===null||s===void 0)&&s.length||r.setNode(o,n.node(o))}),n.edges().forEach(o=>r.setEdge(o,n.edge(o))),r},ye=(n,r)=>{const o={};return n==null||n.forEach((s,l)=>{o[s]=r[l]}),o},ie=n=>{const r=n.nodes().map(o=>{var s;const l={};return(s=n.outEdges(o))===null||s===void 0||s.forEach(u=>{l[u.w]=(l[u.w]||0)+n.edge(u).weight}),l});return ye(n.nodes(),r)},Ie=n=>{const r=n.nodes().map(o=>{var s;const l={};return(s=n.inEdges(o))===null||s===void 0||s.forEach(u=>{l[u.v]=(l[u.v]||0)+n.edge(u).weight}),l});return ye(n.nodes(),r)},Xe=(n,r)=>{const o=n.x,s=n.y,l=r.x-o,u=r.y-s;let h=n.width/2,p=n.height/2;if(!l&&!u)return{x:0,y:0};let g,v;return Math.abs(u)*h>Math.abs(l)*p?(u<0&&(p=-p),g=p*l/u,v=p):(l<0&&(h=-h),g=h,v=h*u/l),{x:o+g,y:s+v}},Qe=n=>{const r=[],o=[],s=xe(n)+1;for(let l=0;l<s;l++)r.push([]),o.push([]);return n.nodes().forEach(l=>{const h=n.node(l).rank;h!==void 0&&r[h]&&o[h].push(l)}),o==null||o.forEach((l,u)=>{l==null||l.sort((h,p)=>{var g,v;return((g=n.node(h))===null||g===void 0?void 0:g.order)-((v=n.node(p))===null||v===void 0?void 0:v.order)}),l.forEach(h=>{r[u].push(h)})}),r},Be=n=>{const r=n.nodes().filter(s=>n.node(s).rank!==void 0).map(s=>n.node(s).rank),o=Math.min(...r);n.nodes().forEach(s=>{const l=n.node(s);l.hasOwnProperty("rank")&&(l.rank||(l.rank=0),l.rank-=o)})},Le=n=>{const r=n.nodes().filter(h=>n.node(h).rank!==void 0).map(h=>n.node(h).rank),o=Math.min(...r),s=[];n.nodes().forEach(h=>{var p;const g=(((p=n.node(h))===null||p===void 0?void 0:p.rank)||0)-o;s[g]||(s[g]=[]),s[g].push(h)});let l=0;const u=n.graph().nodeRankFactor||0;for(let h=0;h<s.length;h++){const p=s[h];p===void 0&&h%u!==0?--l:l&&(p==null||p.forEach(g=>{n.node(g).rank||(n.node(g).rank=0),n.node(g).rank+=l}))}},$e=(n,r,o,s)=>{const l={width:0,height:0};return En(o)&&En(s)&&(l.rank=o,l.order=s),ot(n,"border",l,r)},xe=n=>{const r=n.nodes().map(o=>{const s=n.node(o).rank;return s!==void 0?s:-1/0});return Math.max(...r)},Ne=(n,r)=>{const o={lhs:[],rhs:[]};return n==null||n.forEach(s=>{r(s)?o.lhs.push(s):o.rhs.push(s)}),o},me=(n,r)=>{const o=Date.now();try{return r()}finally{console.log(`${n} time: ${Date.now()-o}ms`)}},We=(n,r)=>r(),nt=(n,r)=>{let o=1/0,s;return n==null||n.forEach(l=>{const u=r(l);o>u&&(o=u,s=l)}),s};var dt={addDummyNode:ot,simplify:wn,asNonCompoundGraph:Rr,successorWeights:ie,predecessorWeights:Ie,intersectRect:Xe,buildLayerMatrix:Qe,normalizeRanks:Be,removeEmptyRanks:Le,addBorderNode:$e,maxRank:xe,partition:Ne,time:me,notime:We,zipObject:ye,minBy:nt};const Mt=n=>{n.graph().dummyChains=[],n.edges().forEach(r=>Et(n,r))},Et=(n,r)=>{var o,s;let l=r.v,u=n.node(l).rank;const h=r.w,p=n.node(h).rank,g=r.name,v=n.edge(r),b=v.labelRank;if(p===u+1)return;n.removeEdge(r);let w,A,O;for(O=0,++u;u<p;++O,++u)v.points=[],A={edgeLabel:v,width:0,height:0,edgeObj:r,rank:u},w=dt.addDummyNode(n,"edge",A,"_d"),u===b&&(A.width=v.width,A.height=v.height,A.dummy="edge-label",A.labelpos=v.labelpos),n.setEdge(l,w,{weight:v.weight},g),O===0&&(n.graph().dummyChains||(n.graph().dummyChains=[]),(s=(o=n.graph())===null||o===void 0?void 0:o.dummyChains)===null||s===void 0||s.push(w)),l=w;n.setEdge(l,h,{weight:v.weight},g)};var Fn={run:Mt,undo:n=>{var r;(r=n.graph().dummyChains)===null||r===void 0||r.forEach(o=>{var s;let l=n.node(o);const u=l.edgeLabel;let h;l.edgeObj&&n.setEdge(l.edgeObj,u);let p=o;for(;l.dummy;)h=(s=n.successors(p))===null||s===void 0?void 0:s[0],n.removeNode(p),u.points.push({x:l.x,y:l.y}),l.dummy==="edge-label"&&(u.x=l.x,u.y=l.y,u.width=l.width,u.height=l.height),p=h,l=n.node(p)})}};const ar=n=>{var r;const o={},s=l=>{var u;const h=n.node(l);if(o.hasOwnProperty(l))return h.rank;o[l]=!0;const p=(u=n.outEdges(l))===null||u===void 0?void 0:u.map(v=>s(v.w)-n.edge(v).minlen||1/0);let g=Math.min(...p);return(g===Number.POSITIVE_INFINITY||g===void 0||g===null)&&(g=0),h.rank=g,g};(r=n.sources())===null||r===void 0||r.forEach(l=>s(l))},Tn=n=>{var r;const o={};let s=0;const l=h=>{var p;const g=n.node(h);if(o.hasOwnProperty(h))return g.rank;o[h]=!0;const v=(p=n.outEdges(h))===null||p===void 0?void 0:p.map(w=>l(w.w)-n.edge(w).minlen||1/0);let b=Math.min(...v);return(b===Number.POSITIVE_INFINITY||b===void 0||b===null)&&(b=0),g.rank=b,s=Math.min(g.rank,s),g.rank};(r=n.sources())===null||r===void 0||r.forEach(h=>l(h)),s+=1;const u=(h,p)=>{var g;const v=n.node(h),b=isNaN(v.layer)?p:v.layer;(v.rank===void 0||v.rank<b)&&(v.rank=b),(g=n.outEdges(h))===null||g===void 0||g.map(w=>{u(w.w,b+n.edge(w).minlen)})};n.nodes().forEach(h=>{const p=n.node(h);isNaN(p.layer)?p.rank-=s:u(h,p.layer)})},Gn=(n,r)=>n.node(r.w).rank-n.node(r.v).rank-n.edge(r).minlen;var xr={longestPath:ar,longestPathWithLayer:Tn,slack:Gn};const ni=fi.Graph,Ji=n=>{const r=new ni({directed:!1}),o=n.nodes()[0],s=n.nodeCount();r.setNode(o,{});let l,u;for(;as(r,n)<s;)l=rg(r,n),u=r.hasNode(l.v)?Gn(n,l):-Gn(n,l),ra(r,n,u);return r},as=(n,r)=>{const o=s=>{r.nodeEdges(s).forEach(l=>{const u=l.v,h=s===u?l.w:u;!n.hasNode(h)&&!Gn(r,l)&&(n.setNode(h,{}),n.setEdge(s,h,{}),o(h))})};return n.nodes().forEach(o),n.nodeCount()},Zf=n=>{const r=new ni({directed:!1}),o=n.nodes()[0],s=n.nodeCount();r.setNode(o,{});let l,u;for(;Aa(r,n)<s;)l=rg(r,n),u=r.hasNode(l.v)?Gn(n,l):-Gn(n,l),ra(r,n,u);return r},Aa=(n,r)=>{const o=s=>{var l;(l=r.nodeEdges(s))===null||l===void 0||l.forEach(u=>{const h=u.v,p=s===h?u.w:h;!n.hasNode(p)&&(r.node(p).layer!==void 0||!Gn(r,u))&&(n.setNode(p,{}),n.setEdge(s,p,{}),o(p))})};return n.nodes().forEach(o),n.nodeCount()},rg=(n,r)=>nt(r.edges(),o=>n.hasNode(o.v)!==n.hasNode(o.w)?Gn(r,o):1/0),ra=(n,r,o)=>{n.nodes().forEach(s=>{r.node(s).rank||(r.node(s).rank=0),r.node(s).rank+=o})};var rv={feasibleTree:Ji,feasibleTreeWithLayer:Zf};const bb=fi.alg,{preorder:Th,postorder:iv}=bb,Ic=n=>{n=wn(n),ar(n);const r=Ji(n);sv(r),ov(r,n);let o,s;for(;o=ig(r);)s=og(r,n,o),Am(r,n,o,s)},ov=(n,r)=>{let o=iv(n,n.nodes());o=o==null?void 0:o.slice(0,(o==null?void 0:o.length)-1),o==null||o.forEach(s=>{R1(n,r,s)})},R1=(n,r,o)=>{const l=n.node(o).parent;n.edge(o,l).cutvalue=xb(n,r,o)},xb=(n,r,o)=>{var s;const u=n.node(o).parent;let h=!0,p=r.edge(o,u),g=0;return p||(h=!1,p=r.edge(u,o)),g=p.weight,(s=r.nodeEdges(o))===null||s===void 0||s.forEach(v=>{const b=v.v===o,w=b?v.w:v.v;if(w!==u){const A=b===h,O=r.edge(v).weight;if(g+=A?O:-O,I1(n,o,w)){const D=n.edge(o,w).cutvalue;g+=A?-D:D}}}),g},sv=(n,r)=>{r!==void 0&&(r=n.nodes()[0]),Cb(n,{},1,r)},Cb=(n,r,o,s,l)=>{var u;const h=o;let p=o;const g=n.node(s);return r[s]=!0,(u=n.neighbors(s))===null||u===void 0||u.forEach(v=>{r.hasOwnProperty(v)||(p=Cb(n,r,p,v,s))}),g.low=h,g.lim=p++,l?g.parent=l:delete g.parent,p},ig=n=>n.edges().find(r=>n.edge(r).cutvalue<0),og=(n,r,o)=>{let s=o.v,l=o.w;r.hasEdge(s,l)||(s=o.w,l=o.v);const u=n.node(s),h=n.node(l);let p=u,g=!1;u.lim>h.lim&&(p=h,g=!0);const v=r.edges().filter(b=>g===Eb(n,n.node(b.v),p)&&g!==Eb(n,n.node(b.w),p));return nt(v,b=>Gn(r,b))},Am=(n,r,o,s)=>{const l=o.v,u=o.w;n.removeEdge(l,u),n.setEdge(s.v,s.w,{}),sv(n),ov(n,r),wb(n,r)},wb=(n,r)=>{const o=n.nodes().find(l=>!r.node(l).parent);let s=Th(n,o);s=s==null?void 0:s.slice(1),s==null||s.forEach(l=>{const u=n.node(l).parent;let h=r.edge(l,u),p=!1;h||(h=r.edge(u,l),p=!0),r.node(l).rank=r.node(u).rank+(p?h.minlen:-h.minlen)})},I1=(n,r,o)=>n.hasEdge(r,o),Eb=(n,r,o)=>o.low<=r.lim&&r.lim<=o.lim;Ic.initLowLimValues=sv,Ic.initCutValues=ov,Ic.calcCutValue=xb,Ic.leaveEdge=ig,Ic.enterEdge=og,Ic.exchangeEdges=Am;var L1=Ic;const av=n=>{switch(n.graph().ranker){case"network-simplex":Sb(n);break;case"tight-tree":G1(n);break;case"longest-path":F1(n);break;default:G1(n)}},F1=ar,G1=n=>{Tn(n),Zf(n)},Sb=n=>{L1(n)};var B1=av;const z1=n=>{var r;const o=U1(n);(r=n.graph().dummyChains)===null||r===void 0||r.forEach(s=>{var l,u;let h=n.node(s);const p=h.edgeObj;if(!p)return;const g=US(n,o,p.v,p.w),v=g.path,b=g.lca;let w=0,A=v[w],O=!0;for(;s!==p.w;){if(h=n.node(s),O){for(;(A=v[w])!==b&&n.node(A).maxRank<h.rank;)w++;A===b&&(O=!1)}if(!O){for(;w<v.length-1&&((l=n.node(A=v[w+1]))===null||l===void 0?void 0:l.minRank)<=h.rank;)w++;A=v[w]}n.setParent(s,A),s=(u=n.successors(s))===null||u===void 0?void 0:u[0]}})},US=(n,r,o,s)=>{const l=[],u=[],h=Math.min(r[o].low,r[s].low),p=Math.max(r[o].lim,r[s].lim);let g,v;g=o;do g=n.parent(g),l.push(g);while(g&&(r[g].low>h||p>r[g].lim));for(v=g,g=s;(g=n.parent(g))!==v;)u.push(g);return{lca:v,path:l.concat(u.reverse())}},U1=n=>{var r;const o={};let s=0;const l=u=>{var h;const p=s;(h=n.children(u))===null||h===void 0||h.forEach(l),o[u]={low:p,lim:s++}};return(r=n.children())===null||r===void 0||r.forEach(l),o};var V1=z1;const Ab=n=>{var r;const o=dt.addDummyNode(n,"root",{},"_root"),s=VS(n),l=Math.max(...Object.values(s))-1,u=2*l+1;n.graph().nestingRoot=o,n.edges().forEach(p=>{n.edge(p).minlen*=u});const h=j1(n)+1;(r=n.children())===null||r===void 0||r.forEach(p=>{Tb(n,o,u,h,l,s,p)}),n.graph().nodeRankFactor=u},Tb=(n,r,o,s,l,u,h)=>{const p=n.children(h);if(!(p!=null&&p.length)){h!==r&&n.setEdge(r,h,{weight:0,minlen:o});return}const g=dt.addBorderNode(n,"_bt"),v=dt.addBorderNode(n,"_bb"),b=n.node(h);n.setParent(g,h),b.borderTop=g,n.setParent(v,h),b.borderBottom=v,p==null||p.forEach(w=>{Tb(n,r,o,s,l,u,w);const A=n.node(w),O=A.borderTop?A.borderTop:w,D=A.borderBottom?A.borderBottom:w,_=A.borderTop?s:2*s,I=O!==D?1:l-u[h]+1;n.setEdge(g,O,{minlen:I,weight:_,nestingEdge:!0}),n.setEdge(D,v,{minlen:I,weight:_,nestingEdge:!0})}),n.parent(h)||n.setEdge(r,g,{weight:0,minlen:l+u[h]})},VS=n=>{var r;const o={},s=(l,u)=>{const h=n.children(l);h==null||h.forEach(p=>s(p,u+1)),o[l]=u};return(r=n.children())===null||r===void 0||r.forEach(l=>s(l,1)),o},j1=n=>{let r=0;return n.edges().forEach(o=>{r+=n.edge(o).weight}),r};var Mb={run:Ab,cleanup:n=>{const r=n.graph();r.nestingRoot&&n.removeNode(r.nestingRoot),delete r.nestingRoot,n.edges().forEach(o=>{n.edge(o).nestingEdge&&n.removeEdge(o)})}};const H1=n=>{var r;const o=s=>{const l=n.children(s),u=n.node(s);if(l!=null&&l.length&&l.forEach(h=>o(h)),u.hasOwnProperty("minRank")){u.borderLeft=[],u.borderRight=[];for(let h=u.minRank,p=u.maxRank+1;h<p;++h)Pb(n,"borderLeft","_bl",s,u,h),Pb(n,"borderRight","_br",s,u,h)}};(r=n.children())===null||r===void 0||r.forEach(s=>o(s))},Pb=(n,r,o,s,l,u)=>{const h={rank:u,width:0,height:0,borderType:r},p=l[r][u-1],g=dt.addDummyNode(n,"border",h,o);l[r][u]=g,n.setParent(g,s),p&&n.setEdge(p,g,{weight:1})};var $1=H1;const W1=n=>{var r;const o=(r=n.graph().rankdir)===null||r===void 0?void 0:r.toLowerCase();(o==="lr"||o==="rl")&&lv(n)},jS=n=>{var r;const o=(r=n.graph().rankdir)===null||r===void 0?void 0:r.toLowerCase();(o==="bt"||o==="rl")&&HS(n),(o==="lr"||o==="rl")&&(Z1(n),lv(n))},lv=n=>{n.nodes().forEach(r=>{Ob(n.node(r))}),n.edges().forEach(r=>{Ob(n.edge(r))})},Ob=n=>{const r=n.width;n.width=n.height,n.height=r},HS=n=>{n.nodes().forEach(r=>{cv(n.node(r))}),n.edges().forEach(r=>{var o;const s=n.edge(r);(o=s.points)===null||o===void 0||o.forEach(l=>cv(l)),s.hasOwnProperty("y")&&cv(s)})},cv=n=>{n.y=-n.y},Z1=n=>{n.nodes().forEach(r=>{uv(n.node(r))}),n.edges().forEach(r=>{var o;const s=n.edge(r);(o=s.points)===null||o===void 0||o.forEach(l=>uv(l)),s.hasOwnProperty("x")&&uv(s)})},uv=n=>{const r=n.x;n.x=n.y,n.y=r};var X1={adjust:W1,undo:jS},Db=n=>{const r={},o=n.nodes().filter(b=>{var w;return!(!((w=n.children(b))===null||w===void 0)&&w.length)}),s=o.map(b=>n.node(b).rank),l=Math.max(...s),u=[];for(let b=0;b<l+1;b++)u.push([]);const h=b=>{var w;if(r.hasOwnProperty(b))return;r[b]=!0;const A=n.node(b);isNaN(A.rank)||u[A.rank].push(b),(w=n.successors(b))===null||w===void 0||w.forEach(O=>h(O))},p=o.sort((b,w)=>n.node(b).rank-n.node(w).rank),v=p.filter(b=>n.node(b).fixorder!==void 0).sort((b,w)=>n.node(b).fixorder-n.node(w).fixorder);return v==null||v.forEach(b=>{isNaN(n.node(b).rank)||u[n.node(b).rank].push(b),r[b]=!0}),p==null||p.forEach(h),u};const $S=(n,r,o)=>{const s=ye(o,o.map((b,w)=>w)),u=r.map(b=>{var w;const A=(w=n.outEdges(b))===null||w===void 0?void 0:w.map(O=>({pos:s[O.w]||0,weight:n.edge(O).weight}));return A==null?void 0:A.sort((O,D)=>O.pos-D.pos)}).flat().filter(b=>b!==void 0);let h=1;for(;h<o.length;)h<<=1;const p=2*h-1;h-=1;const g=Array(p).fill(0,0,p);let v=0;return u==null||u.forEach(b=>{let w=b.pos+h;g[w]+=b.weight;let A=0;for(;w>0;)w%2&&(A+=g[w+1]),w=w-1>>1,g[w]+=b.weight;v+=b.weight*A}),v};var pl=(n,r)=>{let o=0;for(let s=1;s<(r==null?void 0:r.length);++s)o+=$S(n,r[s-1],r[s]);return o};const Lc=fi.Graph,Y1=(n,r,o)=>{const s=Ma(n),l=new Lc({compound:!0}).setGraph({root:s}).setDefaultNodeLabel(u=>n.node(u));return n.nodes().forEach(u=>{const h=n.node(u),p=n.parent(u);(h.rank===r||h.minRank<=r&&r<=h.maxRank)&&(l.setNode(u),l.setParent(u,p||s),n[o](u).forEach(g=>{const v=g.v===u?g.w:g.v,b=l.edge(v,u),w=b!==void 0?b.weight:0;l.setEdge(v,u,{weight:n.edge(g).weight+w})}),h.hasOwnProperty("minRank")&&l.setNode(u,{borderLeft:h.borderLeft[r],borderRight:h.borderRight[r]}))}),l},Ma=n=>{let r;for(;n.hasNode(r=`_root${Math.random()}`););return r};var K1=Y1,q1=(n,r,o)=>{const s={};let l;o==null||o.forEach(u=>{let h=n.parent(u),p,g;for(;h;){if(p=n.parent(h),p?(g=s[p],s[p]=h):(g=l,l=h),g&&g!==h){r.setEdge(g,h);return}h=p}})},J1=(n,r)=>r.map(o=>{const s=n.inEdges(o);if(!(s!=null&&s.length))return{v:o};{const l={sum:0,weight:0};return s==null||s.forEach(u=>{const h=n.edge(u),p=n.node(u.v);l.sum+=h.weight*p.order,l.weight+=h.weight}),{v:o,barycenter:l.sum/l.weight,weight:l.weight}}});const Q1=(n,r)=>{var o,s,l;const u={};n==null||n.forEach((p,g)=>{const v=u[p.v]={i:g,indegree:0,in:[],out:[],vs:[p.v]};p.barycenter!==void 0&&(v.barycenter=p.barycenter,v.weight=p.weight)}),(o=r.edges())===null||o===void 0||o.forEach(p=>{const g=u[p.v],v=u[p.w];g!==void 0&&v!==void 0&&(v.indegree++,g.out.push(u[p.w]))});const h=(l=(s=Object.values(u)).filter)===null||l===void 0?void 0:l.call(s,p=>!p.indegree);return dv(h)},dv=n=>{var r,o;const s=[],l=g=>v=>{v.merged||(v.barycenter===void 0||g.barycenter===void 0||v.barycenter>=g.barycenter)&&ew(g,v)},u=g=>v=>{v.in.push(g),--v.indegree===0&&n.push(v)};for(;n!=null&&n.length;){const g=n.pop();s.push(g),(r=g.in.reverse())===null||r===void 0||r.forEach(v=>l(g)(v)),(o=g.out)===null||o===void 0||o.forEach(v=>u(g)(v))}const h=s.filter(g=>!g.merged),p=["vs","i","barycenter","weight"];return h.map(g=>{const v={};return p==null||p.forEach(b=>{g[b]!==void 0&&(v[b]=g[b])}),v})},ew=(n,r)=>{var o;let s=0,l=0;n.weight&&(s+=n.barycenter*n.weight,l+=n.weight),r.weight&&(s+=r.barycenter*r.weight,l+=r.weight),n.vs=(o=r.vs)===null||o===void 0?void 0:o.concat(n.vs),n.barycenter=s/l,n.weight=l,n.i=Math.min(r.i,n.i),r.merged=!0};var tw=Q1;const nw=(n,r,o)=>{const s=dt.partition(n,w=>w.hasOwnProperty("fixorder")&&!isNaN(w.fixorder)||w.hasOwnProperty("barycenter")),l=s.lhs,u=s.rhs.sort((w,A)=>-w.i- -A.i),h=[];let p=0,g=0,v=0;l==null||l.sort(Nb(!!r,!!o)),v=_b(h,u,v),l==null||l.forEach(w=>{var A;v+=(A=w.vs)===null||A===void 0?void 0:A.length,h.push(w.vs),p+=w.barycenter*w.weight,g+=w.weight,v=_b(h,u,v)});const b={vs:h.flat()};return g&&(b.barycenter=p/g,b.weight=g),b},_b=(n,r,o)=>{let s=o,l;for(;r.length&&(l=r[r.length-1]).i<=s;)r.pop(),n==null||n.push(l.vs),s++;return s},Nb=(n,r)=>(o,s)=>{if(o.fixorder!==void 0&&s.fixorder!==void 0)return o.fixorder-s.fixorder;if(o.barycenter<s.barycenter)return-1;if(o.barycenter>s.barycenter)return 1;if(r&&o.order!==void 0&&s.order!==void 0){if(o.order<s.order)return-1;if(o.order>s.order)return 1}return n?s.i-o.i:o.i-s.i};var Tm=nw;const Pn=(n,r,o,s,l)=>{var u,h,p,g;let v=n.children(r);const b=n.node(r),w=b?b.borderLeft:void 0,A=b?b.borderRight:void 0,O={};w&&(v=v==null?void 0:v.filter(B=>B!==w&&B!==A));const D=J1(n,v||[]);D==null||D.forEach(B=>{var G;if(!((G=n.children(B.v))===null||G===void 0)&&G.length){const K=Pn(n,B.v,o,s);O[B.v]=K,K.hasOwnProperty("barycenter")&&iw(B,K)}});const _=tw(D,o);rw(_,O),(u=_.filter(B=>{var G;return!!B.vs||((G=B.vs)===null||G===void 0?void 0:G.length)>0}))===null||u===void 0||u.forEach(B=>{const G=n.node(B.vs[0]);B.fixorder=G.fixorder,B.order=G.order});const I=Tm(_,s,l);if(w&&(I.vs=[w,I.vs,A].flat(),!((h=n.predecessors(w))===null||h===void 0)&&h.length)){const B=n.node(((p=n.predecessors(w))===null||p===void 0?void 0:p[0])||{}),G=n.node(((g=n.predecessors(A))===null||g===void 0?void 0:g[0])||{});I.hasOwnProperty("barycenter")||(I.barycenter=0,I.weight=0),I.barycenter=(I.barycenter*I.weight+B.order+G.order)/(I.weight+2),I.weight+=2}return I},rw=(n,r)=>{n==null||n.forEach(o=>{var s;const l=(s=o.vs)===null||s===void 0?void 0:s.map(u=>r[u]?r[u].vs:u);o.vs=l.flat()})},iw=(n,r)=>{n.barycenter!==void 0?(n.barycenter=(n.barycenter*n.weight+r.barycenter*r.weight)/(n.weight+r.weight),n.weight+=r.weight):(n.barycenter=r.barycenter,n.weight=r.weight)};var kb=Pn;const Mm=fi.Graph,Pm=n=>{const r=dt.maxRank(n),o=[],s=[];for(let v=1;v<r+1;v++)o.push(v);for(let v=r-1;v>-1;v--)s.push(v);const l=hv(n,o,"inEdges"),u=hv(n,s,"outEdges");let h=Db(n);sg(n,h);let p=Number.POSITIVE_INFINITY,g;for(let v=0,b=0;b<4;++v,++b){Om(v%2?l:u,v%4>=2),h=dt.buildLayerMatrix(n);const w=pl(n,h);w<p&&(b=0,g=_c(h),p=w)}h=Db(n),sg(n,h);for(let v=0,b=0;b<4;++v,++b){Om(v%2?l:u,v%4>=2,!0),h=dt.buildLayerMatrix(n);const w=pl(n,h);w<p&&(b=0,g=_c(h),p=w)}sg(n,g)},hv=(n,r,o)=>r.map(s=>K1(n,s,o)),Om=(n,r,o)=>{const s=new Mm;n==null||n.forEach(l=>{var u;const h=l.graph().root,p=kb(l,h,s,r,o);for(let g=0;g<((u=p.vs)===null||u===void 0?void 0:u.length);g++)l.node(p.vs[g]).order=g;q1(l,s,p.vs)})},sg=(n,r)=>{r==null||r.forEach(o=>{o==null||o.forEach((s,l)=>{n.node(s).order=l})})};var Xf=Pm;const Mh=fi.Graph,Sd=(n,r)=>{const o={},s=(l,u)=>{let h=0,p=0;const g=l.length,v=u==null?void 0:u[(u==null?void 0:u.length)-1];return u==null||u.forEach((b,w)=>{var A;const O=Wa(n,b),D=O?n.node(O).order:g;(O||b===v)&&((A=u.slice(p,w+1))===null||A===void 0||A.forEach(_=>{var I;(I=n.predecessors(_))===null||I===void 0||I.forEach(B=>{const G=n.node(B),K=G.order;(K<h||D<K)&&!(G.dummy&&n.node(_).dummy)&&ag(o,B,_)})}),p=w+1,h=D)}),u};return r!=null&&r.length&&r.reduce(s),o},vi=(n,r)=>{const o={},s=(u,h,p,g,v)=>{let b;const w=[];for(let A=h;A<p;A++)w.push(A);w.forEach(A=>{var O;b=u[A],n.node(b).dummy&&((O=n.predecessors(b))===null||O===void 0||O.forEach(D=>{const _=n.node(D);_.dummy&&(_.order<g||_.order>v)&&ag(o,D,b)}))})},l=(u,h)=>{let p=-1,g,v=0;return h==null||h.forEach((b,w)=>{if(n.node(b).dummy==="border"){const A=n.predecessors(b)||[];A.length&&(g=n.node(A[0]).order,s(h,v,w,p,g),v=w,p=g)}s(h,v,h.length,g,u.length)}),h};return r!=null&&r.length&&r.reduce(l),o},Wa=(n,r)=>{var o;if(n.node(r).dummy)return(o=n.predecessors(r))===null||o===void 0?void 0:o.find(s=>n.node(s).dummy)},ag=(n,r,o)=>{let s=r,l=o;if(s>l){const h=s;s=l,l=h}let u=n[s];u||(n[s]=u={}),u[l]=!0},fv=(n,r,o)=>{let s=r,l=o;if(s>l){const u=r;s=l,l=u}return n[s]&&n[s].hasOwnProperty(l)},Dm=(n,r,o,s)=>{const l={},u={},h={};return r==null||r.forEach(p=>{p==null||p.forEach((g,v)=>{l[g]=g,u[g]=g,h[g]=v})}),r==null||r.forEach(p=>{let g=-1;p==null||p.forEach(v=>{let b=s(v);if(b.length){b=b.sort((A,O)=>h[A]-h[O]);const w=(b.length-1)/2;for(let A=Math.floor(w),O=Math.ceil(w);A<=O;++A){const D=b[A];u[v]===v&&g<h[D]&&!fv(o,v,D)&&(u[D]=v,u[v]=l[v]=l[D],g=h[D])}}})}),{root:l,align:u}},Ph=(n,r,o,s,l)=>{var u;const h={},p=Ad(n,r,o,l),g=l?"borderLeft":"borderRight",v=(A,O)=>{let D=p.nodes(),_=D.pop();const I={};for(;_;)I[_]?A(_):(I[_]=!0,D.push(_),D=D.concat(O(_))),_=D.pop()},b=A=>{h[A]=(p.inEdges(A)||[]).reduce((O,D)=>Math.max(O,(h[D.v]||0)+p.edge(D)),0)},w=A=>{const O=(p.outEdges(A)||[]).reduce((_,I)=>Math.min(_,(h[I.w]||0)-p.edge(I)),Number.POSITIVE_INFINITY),D=n.node(A);O!==Number.POSITIVE_INFINITY&&D.borderType!==g&&(h[A]=Math.max(h[A],O))};return v(b,p.predecessors.bind(p)),v(w,p.successors.bind(p)),(u=Object.values(s))===null||u===void 0||u.forEach(A=>{h[A]=h[o[A]]}),h},Ad=(n,r,o,s)=>{const l=new Mh,u=n.graph(),h=ma(u.nodesep,u.edgesep,s);return r==null||r.forEach(p=>{let g;p==null||p.forEach(v=>{const b=o[v];if(l.setNode(b),g){const w=o[g],A=l.edge(w,b);l.setEdge(w,b,Math.max(h(n,v,g),A||0))}g=v})}),l},Fo=(n,r)=>dt.minBy(Object.values(r),o=>{var s;let l=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;return(s=Object.keys(o))===null||s===void 0||s.forEach(h=>{const p=o[h],g=ug(n,h)/2;l=Math.max(p+g,l),u=Math.min(p-g,u)}),l-u});function lg(n,r){const o=Object.values(r),s=Math.min(...o),l=Math.max(...o);["u","d"].forEach(u=>{["l","r"].forEach(h=>{const p=u+h,g=n[p];let v;if(g===r)return;const b=Object.values(g);v=h==="l"?s-Math.min(...b):l-Math.max(...b),v&&(n[p]={},Object.keys(g).forEach(w=>{n[p][w]=g[w]+v}))})})}const cg=(n,r)=>{const o={};return Object.keys(n.ul).forEach(s=>{if(r)o[s]=n[r.toLowerCase()][s];else{const u=Object.values(n).map(h=>h[s]).sort((h,p)=>h-p);o[s]=(u[1]+u[2])/2}}),o},_m=n=>{const r=dt.buildLayerMatrix(n),o=Object.assign(Sd(n,r),vi(n,r)),s={};let l;["u","d"].forEach(h=>{l=h==="u"?r:Object.values(r).reverse(),["l","r"].forEach(p=>{p==="r"&&(l=l.map(w=>Object.values(w).reverse()));const g=(h==="u"?n.predecessors:n.successors).bind(n),v=Dm(n,l,o,g);let b=Ph(n,l,v.root,v.align,p==="r");p==="r"&&(b=Object.values(b).map(w=>-w)),s[h+p]=b})});const u=Fo(n,s);return lg(s,u),cg(s,n.graph().align)},ma=(n,r,o)=>(s,l,u)=>{const h=s.node(l),p=s.node(u);let g=0,v;if(g+=h.width/2,h.hasOwnProperty("labelpos"))switch((h.labelpos||"").toLowerCase()){case"l":v=-h.width/2;break;case"r":v=h.width/2;break}if(v&&(g+=o?v:-v),v=0,g+=(h.dummy?r:n)/2,g+=(p.dummy?r:n)/2,g+=p.width/2,p.hasOwnProperty("labelpos"))switch((p.labelpos||"").toLowerCase()){case"l":v=p.width/2;break;case"r":v=-p.width/2;break}return v&&(g+=o?v:-v),v=0,g},ug=(n,r)=>{var o;return((o=n.node(r))===null||o===void 0?void 0:o.width)||0};var Rb={positionX:_m,findType1Conflicts:Sd,findType2Conflicts:vi,addConflict:ag,hasConflict:fv,verticalAlignment:Dm,horizontalCompaction:Ph,alignCoordinates:lg,findSmallestWidthAlignment:Fo,balance:cg};const Ib=n=>{const r=dt.buildLayerMatrix(n),o=n.graph().ranksep;let s=0;r==null||r.forEach(l=>{const u=l.map(p=>n.node(p).height),h=Math.max(...u);l==null||l.forEach(p=>{n.node(p).y=s+h/2}),s+=h+o})},Nm=n=>{const r=dt.buildLayerMatrix(n),o=Object.assign(Sd(n,r),vi(n,r)),s={};let l;["u","d"].forEach(h=>{l=h==="u"?r:Object.values(r).reverse(),["l","r"].forEach(p=>{p==="r"&&(l=l.map(w=>Object.values(w).reverse()));const g=(h==="u"?n.predecessors:n.successors).bind(n),v=Dm(n,l,o,g),b=Ph(n,l,v.root,v.align,p==="r");p==="r"&&Object.keys(b).forEach(w=>b[w]=-b[w]),s[h+p]=b})});const u=Fo(n,s);return u&&lg(s,u),cg(s,n.graph().align)};var km=n=>{var r;n=dt.asNonCompoundGraph(n),Ib(n);const o=Nm(n);(r=Object.keys(o))===null||r===void 0||r.forEach(s=>{n.node(s).x=o[s]})},Rm=(n,r)=>{const s=n.nodes().filter(h=>{var p;return!(!((p=n.children(h))===null||p===void 0)&&p.length)}).map(h=>n.node(h).rank),l=Math.max(...s),u=[];for(let h=0;h<l+1;h++)u.push([]);r==null||r.forEach(h=>{const p=n.node(h);!p||p.dummy||isNaN(p.rank)||(p.fixorder=u[p.rank].length,u[p.rank].push(h))})};const Jl=fi.Graph,Im=(n,r)=>{const o=r&&r.debugTiming?dt.time:dt.notime;o("layout",()=>{r&&!r.keepNodeOrder&&r.prevGraph&&o("  inheritOrder",()=>{Fb(n,r.prevGraph)});const s=o("  buildLayoutGraph",()=>mv(n));r&&r.edgeLabelSpace===!1||o("  makeSpaceForEdgeLabels",()=>{Kf(s)});try{o("  runLayout",()=>{Yf(s,o,r)})}catch(l){if(l.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,l);return}throw l}o("  updateInputGraph",()=>{Lm(n,s)})})},Yf=(n,r,o)=>{r("    removeSelfEdges",()=>{vv(n)}),r("    acyclic",()=>{Te.run(n)}),r("    nestingGraph.run",()=>{Mb.run(n)}),r("    rank",()=>{B1(dt.asNonCompoundGraph(n))}),r("    injectEdgeLabelProxies",()=>{dg(n)}),r("    removeEmptyRanks",()=>{Le(n)}),r("    nestingGraph.cleanup",()=>{Mb.cleanup(n)}),r("    normalizeRanks",()=>{Be(n)}),r("    assignRankMinMax",()=>{zm(n)}),r("    removeEdgeLabelProxies",()=>{sw(n)}),r("    normalize.run",()=>{Fn.run(n)}),r("    parentDummyChains",()=>{V1(n)}),r("    addBorderSegments",()=>{$1(n)}),o&&o.keepNodeOrder&&r("    initDataOrder",()=>{Rm(n,o.nodeOrder)}),r("    order",()=>{Xf(n)}),r("    insertSelfEdges",()=>{Oh(n)}),r("    adjustCoordinateSystem",()=>{X1.adjust(n)}),r("    position",()=>{km(n)}),r("    positionSelfEdges",()=>{lw(n)}),r("    removeBorderNodes",()=>{zb(n)}),r("    normalize.undo",()=>{Fn.undo(n)}),r("    fixupEdgeLabelCoords",()=>{KS(n)}),r("    undoCoordinateSystem",()=>{X1.undo(n)}),r("    translateGraph",()=>{XS(n)}),r("    assignNodeIntersects",()=>{YS(n)}),r("    reversePoints",()=>{aw(n)}),r("    acyclic.undo",()=>{Te.undo(n)})},Fb=(n,r)=>{const o=r._nodes||{};n.nodes().forEach(s=>{const l=n.node(s);o[s]!==void 0?(l.fixorder=o[s]._order,delete o[s]._order):delete l.fixorder})},Lm=(n,r)=>{n.nodes().forEach(o=>{var s;const l=n.node(o),u=r.node(o);l&&(l.x=u.x,l.y=u.y,l._order=u.order,l._rank=u.rank,!((s=r.children(o))===null||s===void 0)&&s.length&&(l.width=u.width,l.height=u.height))}),n.edges().forEach(o=>{const s=n.edge(o),l=r.edge(o);s.points=l.points,l.hasOwnProperty("x")&&(s.x=l.x,s.y=l.y)}),n.graph().width=r.graph().width,n.graph().height=r.graph().height},Gb=["nodesep","edgesep","ranksep","marginx","marginy"],Fm={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},pv=["acyclicer","ranker","rankdir","align"],Bb=["width","height","layer","fixorder"],Gm={width:0,height:0},Bm=["minlen","weight","width","height","labeloffset"],gv={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},yi=["labelpos"],mv=n=>{const r=new Jl({multigraph:!0,compound:!0}),o=qf(n.graph()),s={};return pv==null||pv.forEach(l=>{o[l]!==void 0&&(s[l]=o[l])}),r.setGraph(Object.assign({},Fm,hg(o,Gb),s)),n.nodes().forEach(l=>{const u=qf(n.node(l)),h=hg(u,Bb);Object.keys(Gm).forEach(p=>{h[p]===void 0&&(h[p]=Gm[p])}),r.setNode(l,h),r.setParent(l,n.parent(l))}),n.edges().forEach(l=>{const u=qf(n.edge(l)),h={};yi==null||yi.forEach(p=>{u[p]!==void 0&&(h[p]=u[p])}),r.setEdge(l,Object.assign({},gv,hg(u,Bm),h))}),r},Kf=n=>{const r=n.graph();r.ranksep||(r.ranksep=0),r.ranksep/=2,n.nodes().forEach(o=>{const s=n.node(o);isNaN(s.layer)||(s.layer?s.layer*=2:s.layer=0)}),n.edges().forEach(o=>{var s;const l=n.edge(o);l.minlen*=2,((s=l.labelpos)===null||s===void 0?void 0:s.toLowerCase())!=="c"&&(r.rankdir==="TB"||r.rankdir==="BT"?l.width+=l.labeloffset:l.height+=l.labeloffset)})},dg=n=>{n.edges().forEach(r=>{const o=n.edge(r);if(o.width&&o.height){const s=n.node(r.v),l=n.node(r.w),u={e:r,rank:(l.rank-s.rank)/2+s.rank};dt.addDummyNode(n,"edge-proxy",u,"_ep")}})},zm=n=>{let r=0;n.nodes().forEach(o=>{const s=n.node(o);s.borderTop&&(s.minRank=n.node(s.borderTop).rank,s.maxRank=n.node(s.borderBottom).rank,r=Math.max(r,s.maxRank||-1/0))}),n.graph().maxRank=r},sw=n=>{n.nodes().forEach(r=>{const o=n.node(r);o.dummy==="edge-proxy"&&(n.edge(o.e).labelRank=o.rank,n.removeNode(r))})},XS=n=>{let r=Number.POSITIVE_INFINITY,o=0,s=Number.POSITIVE_INFINITY,l=0;const u=n.graph(),h=u.marginx||0,p=u.marginy||0,g=v=>{if(!v)return;const b=v.x,w=v.y,A=v.width,O=v.height;!isNaN(b)&&!isNaN(A)&&(r=Math.min(r,b-A/2),o=Math.max(o,b+A/2)),!isNaN(w)&&!isNaN(O)&&(s=Math.min(s,w-O/2),l=Math.max(l,w+O/2))};n.nodes().forEach(v=>{g(n.node(v))}),n.edges().forEach(v=>{const b=n.edge(v);b.hasOwnProperty("x")&&g(b)}),r-=h,s-=p,n.nodes().forEach(v=>{const b=n.node(v);b.x-=r,b.y-=s}),n.edges().forEach(v=>{var b;const w=n.edge(v);(b=w.points)===null||b===void 0||b.forEach(A=>{A.x-=r,A.y-=s}),w.hasOwnProperty("x")&&(w.x-=r),w.hasOwnProperty("y")&&(w.y-=s)}),u.width=o-r+h,u.height=l-s+p},YS=n=>{n.edges().forEach(r=>{const o=n.edge(r),s=n.node(r.v),l=n.node(r.w);let u,h;o.points?(u=o.points[0],h=o.points[o.points.length-1]):(o.points=[],u=l,h=s),o.points.unshift(dt.intersectRect(s,u)),o.points.push(dt.intersectRect(l,h))})},KS=n=>{n.edges().forEach(r=>{const o=n.edge(r);if(o.hasOwnProperty("x"))switch((o.labelpos==="l"||o.labelpos==="r")&&(o.width-=o.labeloffset),o.labelpos){case"l":o.x-=o.width/2+o.labeloffset;break;case"r":o.x+=o.width/2+o.labeloffset;break}})},aw=n=>{n.edges().forEach(r=>{const o=n.edge(r);o.reversed&&o.points.reverse()})},zb=n=>{n.nodes().forEach(r=>{var o,s,l;if(!((o=n.children(r))===null||o===void 0)&&o.length){const u=n.node(r),h=n.node(u.borderTop),p=n.node(u.borderBottom),g=n.node(u.borderLeft[((s=u.borderLeft)===null||s===void 0?void 0:s.length)-1]),v=n.node(u.borderRight[((l=u.borderRight)===null||l===void 0?void 0:l.length)-1]);u.width=Math.abs((v==null?void 0:v.x)-(g==null?void 0:g.x))||10,u.height=Math.abs((p==null?void 0:p.y)-(h==null?void 0:h.y))||10,u.x=((g==null?void 0:g.x)||0)+u.width/2,u.y=((h==null?void 0:h.y)||0)+u.height/2}}),n.nodes().forEach(r=>{n.node(r).dummy==="border"&&n.removeNode(r)})},vv=n=>{n.edges().forEach(r=>{if(r.v===r.w){const o=n.node(r.v);o.selfEdges||(o.selfEdges=[]),o.selfEdges.push({e:r,label:n.edge(r)}),n.removeEdge(r)}})},Oh=n=>{const r=dt.buildLayerMatrix(n);r==null||r.forEach(o=>{let s=0;o==null||o.forEach((l,u)=>{var h;const p=n.node(l);p.order=u+s,(h=p.selfEdges)===null||h===void 0||h.forEach(g=>{dt.addDummyNode(n,"selfedge",{width:g.label.width,height:g.label.height,rank:p.rank,order:u+ ++s,e:g.e,label:g.label},"_se")}),delete p.selfEdges})})},lw=n=>{n.nodes().forEach(r=>{const o=n.node(r);if(o.dummy==="selfedge"){const s=n.node(o.e.v),l=s.x+s.width/2,u=s.y,h=o.x-l,p=s.height/2;n.setEdge(o.e,o.label),n.removeNode(r),o.label.points=[{x:l+2*h/3,y:u-p},{x:l+5*h/6,y:u-p},{y:u,x:l+h},{x:l+5*h/6,y:u+p},{x:l+2*h/3,y:u+p}],o.label.x=o.x,o.label.y=o.y}})},hg=(n,r)=>{const o={};return r==null||r.forEach(s=>{n[s]!==void 0&&(o[s]=+n[s])}),o},qf=n=>{const r={};return Object.keys(n).forEach(o=>{const s=n[o];r[o.toLowerCase()]=s}),r};var Um=Im,yv={graphlib:fi,layout:Um,util:{time:me,notime:We}};class Ub extends _s{constructor(r){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=o=>{const s=this,{nodes:l}=s,u=l.find(h=>h.id===o);return u?u.layout!==!1:!0},this.updateCfg(r)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1}}execute(){const r=this,{nodes:o,nodeSize:s,rankdir:l,combos:u,begin:h}=r;if(!o)return;const p=r.edges||[],g=new yv.graphlib.Graph({multigraph:!0,compound:!0});let v;s?xs(s)?v=()=>s:v=()=>[s,s]:v=_=>_.size?xs(_.size)?_.size:Ea(_.size)?[_.size.width||40,_.size.height||40]:[_.size,_.size]:[40,40];let b=Jf(r.nodesepFunc,r.nodesep,50),w=Jf(r.ranksepFunc,r.ranksep,50);(l==="LR"||l==="RL")&&(b=Jf(r.ranksepFunc,r.ranksep,50),w=Jf(r.nodesepFunc,r.nodesep,50)),g.setDefaultEdgeLabel(()=>({})),g.setGraph(r);const A={};o.filter(_=>_.layout!==!1).forEach(_=>{const I=v(_),B=w(_),G=b(_),K=I[0]+2*G,ve=I[1]+2*B,ae=_.layer;En(ae)?g.setNode(_.id,{width:K,height:ve,layer:ae}):g.setNode(_.id,{width:K,height:ve}),this.sortByCombo&&_.comboId&&(A[_.comboId]||(A[_.comboId]=!0,g.setNode(_.comboId,{})),g.setParent(_.id,_.comboId))}),this.sortByCombo&&u&&u.forEach(_=>{!_.parentId||(A[_.parentId]||(A[_.parentId]=!0,g.setNode(_.parentId,{})),g.setParent(_.id,_.parentId))}),p.forEach(_=>{const I=Kr(_,"source"),B=Kr(_,"target");this.layoutNode(I)&&this.layoutNode(B)&&g.setEdge(I,B,{weight:_.weight||1})});let O;r.preset&&(O=new yv.graphlib.Graph({multigraph:!0,compound:!0}),r.preset.nodes.forEach(_=>{O==null||O.setNode(_.id,_)})),yv.layout(g,{prevGraph:O,edgeLabelSpace:r.edgeLabelSpace,keepNodeOrder:Boolean(!!r.nodeOrder),nodeOrder:r.nodeOrder});const D=[0,0];if(h){let _=1/0,I=1/0;g.nodes().forEach(B=>{const G=g.node(B);_>G.x&&(_=G.x),I>G.y&&(I=G.y)}),g.edges().forEach(B=>{g.edge(B).points.forEach(K=>{_>K.x&&(_=K.x),I>K.y&&(I=K.y)})}),D[0]=h[0]-_,D[1]=h[1]-I}return g.nodes().forEach(_=>{const I=g.node(_),B=o.findIndex(G=>G.id===_);!o[B]||(o[B].x=I.x+D[0],o[B].y=I.y+D[1],o[B]._order=I._order)}),g.edges().forEach(_=>{const I=g.edge(_),B=p.findIndex(G=>{const K=Kr(G,"source"),ve=Kr(G,"target");return K===_.v&&ve===_.w});r.edgeLabelSpace&&r.controlPoints&&p[B].type!=="loop"&&(p[B].controlPoints=I.points.slice(1,I.points.length-1),p[B].controlPoints.forEach(G=>{G.x+=D[0],G.y+=D[1]}))}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:p}}getType(){return"dagre"}}function Jf(n,r,o){let s;return n?s=n:En(r)?s=()=>r:s=()=>o,s}var Vb=P(94993),jb=P.n(Vb),cw=P(61655),bv=P.n(cw),uw=P(26389),fg=P.n(uw),dw=P(56690),Vm=P.n(dw),ri=P(89728),Fc=P.n(ri);const Hb=Object.prototype.toString;function ks(n){return Hb.call(n).endsWith("Array]")}function xv(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ks(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var o=r.fromIndex,s=o===void 0?0:o,l=r.toIndex,u=l===void 0?n.length:l;if(s<0||s>=n.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(u<=s||u>n.length||!Number.isInteger(u))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var h=n[s],p=s+1;p<u;p++)n[p]>h&&(h=n[p]);return h}function $b(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ks(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var o=r.fromIndex,s=o===void 0?0:o,l=r.toIndex,u=l===void 0?n.length:l;if(s<0||s>=n.length||!Number.isInteger(s))throw new Error("fromIndex must be a positive integer smaller than length");if(u<=s||u>n.length||!Number.isInteger(u))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var h=n[s],p=s+1;p<u;p++)n[p]<h&&(h=n[p]);return h}function Cv(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ks(n)){if(n.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var o;if(r.output!==void 0){if(!ks(r.output))throw new TypeError("output option must be an array if specified");o=r.output}else o=new Array(n.length);var s=$b(n),l=xv(n);if(s===l)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var u=r.min,h=u===void 0?r.autoMinMax?s:0:u,p=r.max,g=p===void 0?r.autoMinMax?l:1:p;if(h>=g)throw new RangeError("min option must be smaller than max option");for(var v=(g-h)/(l-s),b=0;b<n.length;b++)o[b]=(n[b]-s)*v+h;return o}var Ql=" ".repeat(2),Oe=" ".repeat(4);function gn(){return zn(this)}function zn(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.maxRows,s=o===void 0?15:o,l=r.maxColumns,u=l===void 0?10:l,h=r.maxNumSize,p=h===void 0?8:h;return"".concat(n.constructor.name,` {
`).concat(Ql,`[
`).concat(Oe).concat(gl(n,s,u,p),`
`).concat(Ql,`]
`).concat(Ql,"rows: ").concat(n.rows,`
`).concat(Ql,"columns: ").concat(n.columns,`
}`)}function gl(n,r,o,s){for(var l=n.rows,u=n.columns,h=Math.min(l,r),p=Math.min(u,o),g=[],v=0;v<h;v++){for(var b=[],w=0;w<p;w++)b.push(Zo(n.get(v,w),s));g.push("".concat(b.join(" ")))}return p!==u&&(g[g.length-1]+=" ... ".concat(u-o," more columns")),h!==l&&g.push("... ".concat(l-r," more rows")),g.join(`
`.concat(Oe))}function Zo(n,r){var o=String(n);if(o.length<=r)return o.padEnd(r," ");var s=n.toPrecision(r-2);if(s.length<=r)return s;var l=n.toExponential(r-2),u=l.indexOf("e"),h=l.slice(u);return l.slice(0,r-h.length)+h}function Go(n,r){n.prototype.add=function(s){return typeof s=="number"?this.addS(s):this.addM(s)},n.prototype.addS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)+s);return this},n.prototype.addM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)+s.get(l,u));return this},n.add=function(s,l){var u=new r(s);return u.add(l)},n.prototype.sub=function(s){return typeof s=="number"?this.subS(s):this.subM(s)},n.prototype.subS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)-s);return this},n.prototype.subM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)-s.get(l,u));return this},n.sub=function(s,l){var u=new r(s);return u.sub(l)},n.prototype.subtract=n.prototype.sub,n.prototype.subtractS=n.prototype.subS,n.prototype.subtractM=n.prototype.subM,n.subtract=n.sub,n.prototype.mul=function(s){return typeof s=="number"?this.mulS(s):this.mulM(s)},n.prototype.mulS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)*s);return this},n.prototype.mulM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)*s.get(l,u));return this},n.mul=function(s,l){var u=new r(s);return u.mul(l)},n.prototype.multiply=n.prototype.mul,n.prototype.multiplyS=n.prototype.mulS,n.prototype.multiplyM=n.prototype.mulM,n.multiply=n.mul,n.prototype.div=function(s){return typeof s=="number"?this.divS(s):this.divM(s)},n.prototype.divS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)/s);return this},n.prototype.divM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)/s.get(l,u));return this},n.div=function(s,l){var u=new r(s);return u.div(l)},n.prototype.divide=n.prototype.div,n.prototype.divideS=n.prototype.divS,n.prototype.divideM=n.prototype.divM,n.divide=n.div,n.prototype.mod=function(s){return typeof s=="number"?this.modS(s):this.modM(s)},n.prototype.modS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)%s);return this},n.prototype.modM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)%s.get(l,u));return this},n.mod=function(s,l){var u=new r(s);return u.mod(l)},n.prototype.modulus=n.prototype.mod,n.prototype.modulusS=n.prototype.modS,n.prototype.modulusM=n.prototype.modM,n.modulus=n.mod,n.prototype.and=function(s){return typeof s=="number"?this.andS(s):this.andM(s)},n.prototype.andS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)&s);return this},n.prototype.andM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)&s.get(l,u));return this},n.and=function(s,l){var u=new r(s);return u.and(l)},n.prototype.or=function(s){return typeof s=="number"?this.orS(s):this.orM(s)},n.prototype.orS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)|s);return this},n.prototype.orM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)|s.get(l,u));return this},n.or=function(s,l){var u=new r(s);return u.or(l)},n.prototype.xor=function(s){return typeof s=="number"?this.xorS(s):this.xorM(s)},n.prototype.xorS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)^s);return this},n.prototype.xorM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)^s.get(l,u));return this},n.xor=function(s,l){var u=new r(s);return u.xor(l)},n.prototype.leftShift=function(s){return typeof s=="number"?this.leftShiftS(s):this.leftShiftM(s)},n.prototype.leftShiftS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)<<s);return this},n.prototype.leftShiftM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)<<s.get(l,u));return this},n.leftShift=function(s,l){var u=new r(s);return u.leftShift(l)},n.prototype.signPropagatingRightShift=function(s){return typeof s=="number"?this.signPropagatingRightShiftS(s):this.signPropagatingRightShiftM(s)},n.prototype.signPropagatingRightShiftS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)>>s);return this},n.prototype.signPropagatingRightShiftM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)>>s.get(l,u));return this},n.signPropagatingRightShift=function(s,l){var u=new r(s);return u.signPropagatingRightShift(l)},n.prototype.rightShift=function(s){return typeof s=="number"?this.rightShiftS(s):this.rightShiftM(s)},n.prototype.rightShiftS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)>>>s);return this},n.prototype.rightShiftM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,this.get(l,u)>>>s.get(l,u));return this},n.rightShift=function(s,l){var u=new r(s);return u.rightShift(l)},n.prototype.zeroFillRightShift=n.prototype.rightShift,n.prototype.zeroFillRightShiftS=n.prototype.rightShiftS,n.prototype.zeroFillRightShiftM=n.prototype.rightShiftM,n.zeroFillRightShift=n.rightShift,n.prototype.not=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,~this.get(s,l));return this},n.not=function(s){var l=new r(s);return l.not()},n.prototype.abs=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.abs(this.get(s,l)));return this},n.abs=function(s){var l=new r(s);return l.abs()},n.prototype.acos=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.acos(this.get(s,l)));return this},n.acos=function(s){var l=new r(s);return l.acos()},n.prototype.acosh=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.acosh(this.get(s,l)));return this},n.acosh=function(s){var l=new r(s);return l.acosh()},n.prototype.asin=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.asin(this.get(s,l)));return this},n.asin=function(s){var l=new r(s);return l.asin()},n.prototype.asinh=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.asinh(this.get(s,l)));return this},n.asinh=function(s){var l=new r(s);return l.asinh()},n.prototype.atan=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.atan(this.get(s,l)));return this},n.atan=function(s){var l=new r(s);return l.atan()},n.prototype.atanh=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.atanh(this.get(s,l)));return this},n.atanh=function(s){var l=new r(s);return l.atanh()},n.prototype.cbrt=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.cbrt(this.get(s,l)));return this},n.cbrt=function(s){var l=new r(s);return l.cbrt()},n.prototype.ceil=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.ceil(this.get(s,l)));return this},n.ceil=function(s){var l=new r(s);return l.ceil()},n.prototype.clz32=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.clz32(this.get(s,l)));return this},n.clz32=function(s){var l=new r(s);return l.clz32()},n.prototype.cos=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.cos(this.get(s,l)));return this},n.cos=function(s){var l=new r(s);return l.cos()},n.prototype.cosh=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.cosh(this.get(s,l)));return this},n.cosh=function(s){var l=new r(s);return l.cosh()},n.prototype.exp=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.exp(this.get(s,l)));return this},n.exp=function(s){var l=new r(s);return l.exp()},n.prototype.expm1=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.expm1(this.get(s,l)));return this},n.expm1=function(s){var l=new r(s);return l.expm1()},n.prototype.floor=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.floor(this.get(s,l)));return this},n.floor=function(s){var l=new r(s);return l.floor()},n.prototype.fround=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.fround(this.get(s,l)));return this},n.fround=function(s){var l=new r(s);return l.fround()},n.prototype.log=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.log(this.get(s,l)));return this},n.log=function(s){var l=new r(s);return l.log()},n.prototype.log1p=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.log1p(this.get(s,l)));return this},n.log1p=function(s){var l=new r(s);return l.log1p()},n.prototype.log10=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.log10(this.get(s,l)));return this},n.log10=function(s){var l=new r(s);return l.log10()},n.prototype.log2=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.log2(this.get(s,l)));return this},n.log2=function(s){var l=new r(s);return l.log2()},n.prototype.round=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.round(this.get(s,l)));return this},n.round=function(s){var l=new r(s);return l.round()},n.prototype.sign=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.sign(this.get(s,l)));return this},n.sign=function(s){var l=new r(s);return l.sign()},n.prototype.sin=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.sin(this.get(s,l)));return this},n.sin=function(s){var l=new r(s);return l.sin()},n.prototype.sinh=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.sinh(this.get(s,l)));return this},n.sinh=function(s){var l=new r(s);return l.sinh()},n.prototype.sqrt=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.sqrt(this.get(s,l)));return this},n.sqrt=function(s){var l=new r(s);return l.sqrt()},n.prototype.tan=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.tan(this.get(s,l)));return this},n.tan=function(s){var l=new r(s);return l.tan()},n.prototype.tanh=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.tanh(this.get(s,l)));return this},n.tanh=function(s){var l=new r(s);return l.tanh()},n.prototype.trunc=function(){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,Math.trunc(this.get(s,l)));return this},n.trunc=function(s){var l=new r(s);return l.trunc()},n.pow=function(s,l){var u=new r(s);return u.pow(l)},n.prototype.pow=function(s){return typeof s=="number"?this.powS(s):this.powM(s)},n.prototype.powS=function(s){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,Math.pow(this.get(l,u),s));return this},n.prototype.powM=function(s){if(s=r.checkMatrix(s),this.rows!==s.rows||this.columns!==s.columns)throw new RangeError("Matrices dimensions must be equal");for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.set(l,u,Math.pow(this.get(l,u),s.get(l,u)));return this}}function Pa(n,r,o){var s=o?n.rows:n.rows-1;if(r<0||r>s)throw new RangeError("Row index out of range")}function lo(n,r,o){var s=o?n.columns:n.columns-1;if(r<0||r>s)throw new RangeError("Column index out of range")}function ec(n,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==n.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function tc(n,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==n.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function ml(n,r){if(!ks(r))throw new TypeError("row indices must be an array");for(var o=0;o<r.length;o++)if(r[o]<0||r[o]>=n.rows)throw new RangeError("row indices are out of range")}function jm(n,r){if(!ks(r))throw new TypeError("column indices must be an array");for(var o=0;o<r.length;o++)if(r[o]<0||r[o]>=n.columns)throw new RangeError("column indices are out of range")}function wv(n,r,o,s,l){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Hm("startRow",r),Hm("endRow",o),Hm("startColumn",s),Hm("endColumn",l),r>o||s>l||r<0||r>=n.rows||o<0||o>=n.rows||s<0||s>=n.columns||l<0||l>=n.columns)throw new RangeError("Submatrix indices are out of range")}function pg(n){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=[],s=0;s<n;s++)o.push(r);return o}function Hm(n,r){if(typeof r!="number")throw new TypeError("".concat(n," must be a number"))}function Qf(n){if(n.isEmpty())throw new Error("Empty matrix has no elements to index")}function hw(n){for(var r=pg(n.rows),o=0;o<n.rows;++o)for(var s=0;s<n.columns;++s)r[o]+=n.get(o,s);return r}function fw(n){for(var r=pg(n.columns),o=0;o<n.rows;++o)for(var s=0;s<n.columns;++s)r[s]+=n.get(o,s);return r}function pw(n){for(var r=0,o=0;o<n.rows;o++)for(var s=0;s<n.columns;s++)r+=n.get(o,s);return r}function gw(n){for(var r=pg(n.rows,1),o=0;o<n.rows;++o)for(var s=0;s<n.columns;++s)r[o]*=n.get(o,s);return r}function Ev(n){for(var r=pg(n.columns,1),o=0;o<n.rows;++o)for(var s=0;s<n.columns;++s)r[s]*=n.get(o,s);return r}function mw(n){for(var r=1,o=0;o<n.rows;o++)for(var s=0;s<n.columns;s++)r*=n.get(o,s);return r}function Wb(n,r,o){for(var s=n.rows,l=n.columns,u=[],h=0;h<s;h++){for(var p=0,g=0,v=0,b=0;b<l;b++)v=n.get(h,b)-o[h],p+=v,g+=v*v;r?u.push((g-p*p/l)/(l-1)):u.push((g-p*p/l)/l)}return u}function $m(n,r,o){for(var s=n.rows,l=n.columns,u=[],h=0;h<l;h++){for(var p=0,g=0,v=0,b=0;b<s;b++)v=n.get(b,h)-o[h],p+=v,g+=v*v;r?u.push((g-p*p/s)/(s-1)):u.push((g-p*p/s)/s)}return u}function vw(n,r,o){for(var s=n.rows,l=n.columns,u=s*l,h=0,p=0,g=0,v=0;v<s;v++)for(var b=0;b<l;b++)g=n.get(v,b)-o,h+=g,p+=g*g;return r?(p-h*h/u)/(u-1):(p-h*h/u)/u}function sr(n,r){for(var o=0;o<n.rows;o++)for(var s=0;s<n.columns;s++)n.set(o,s,n.get(o,s)-r[o])}function In(n,r){for(var o=0;o<n.rows;o++)for(var s=0;s<n.columns;s++)n.set(o,s,n.get(o,s)-r[s])}function yw(n,r){for(var o=0;o<n.rows;o++)for(var s=0;s<n.columns;s++)n.set(o,s,n.get(o,s)-r)}function bw(n){for(var r=[],o=0;o<n.rows;o++){for(var s=0,l=0;l<n.columns;l++)s+=Math.pow(n.get(o,l),2)/(n.columns-1);r.push(Math.sqrt(s))}return r}function Zb(n,r){for(var o=0;o<n.rows;o++)for(var s=0;s<n.columns;s++)n.set(o,s,n.get(o,s)/r[o])}function Wm(n){for(var r=[],o=0;o<n.columns;o++){for(var s=0,l=0;l<n.rows;l++)s+=Math.pow(n.get(l,o),2)/(n.rows-1);r.push(Math.sqrt(s))}return r}function xw(n,r){for(var o=0;o<n.rows;o++)for(var s=0;s<n.columns;s++)n.set(o,s,n.get(o,s)/r[s])}function Sv(n){for(var r=n.size-1,o=0,s=0;s<n.columns;s++)for(var l=0;l<n.rows;l++)o+=Math.pow(n.get(l,s),2)/r;return Math.sqrt(o)}function Cw(n,r){for(var o=0;o<n.rows;o++)for(var s=0;s<n.columns;s++)n.set(o,s,n.get(o,s)/r)}var ls=function(){function n(){Vm()(this,n)}return Fc()(n,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(o){if(typeof o!="function")throw new TypeError("callback must be a function");for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)o.call(this,s,l);return this}},{key:"to1DArray",value:function(){for(var o=[],s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)o.push(this.get(s,l));return o}},{key:"to2DArray",value:function(){for(var o=[],s=0;s<this.rows;s++){o.push([]);for(var l=0;l<this.columns;l++)o[s].push(this.get(s,l))}return o}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return this.rows===1}},{key:"isColumnVector",value:function(){return this.columns===1}},{key:"isVector",value:function(){return this.rows===1||this.columns===1}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return this.rows===0||this.columns===0}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var o=0;o<this.rows;o++)for(var s=0;s<=o;s++)if(this.get(o,s)!==this.get(s,o))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var o=0,s=0,l=-1,u=!0,h=!1;o<this.rows&&u;){for(s=0,h=!1;s<this.columns&&h===!1;)this.get(o,s)===0?s++:this.get(o,s)===1&&s>l?(h=!0,l=s):(u=!1,h=!0);o++}return u}},{key:"isReducedEchelonForm",value:function(){for(var o=0,s=0,l=-1,u=!0,h=!1;o<this.rows&&u;){for(s=0,h=!1;s<this.columns&&h===!1;)this.get(o,s)===0?s++:this.get(o,s)===1&&s>l?(h=!0,l=s):(u=!1,h=!0);for(var p=s+1;p<this.rows;p++)this.get(o,p)!==0&&(u=!1);o++}return u}},{key:"echelonForm",value:function(){for(var o=this.clone(),s=0,l=0;s<o.rows&&l<o.columns;){for(var u=s,h=s;h<o.rows;h++)o.get(h,l)>o.get(u,l)&&(u=h);if(o.get(u,l)===0)l++;else{o.swapRows(s,u);for(var p=o.get(s,l),g=l;g<o.columns;g++)o.set(s,g,o.get(s,g)/p);for(var v=s+1;v<o.rows;v++){var b=o.get(v,l)/o.get(s,l);o.set(v,l,0);for(var w=l+1;w<o.columns;w++)o.set(v,w,o.get(v,w)-o.get(s,w)*b)}s++,l++}}return o}},{key:"reducedEchelonForm",value:function(){for(var o=this.echelonForm(),s=o.columns,l=o.rows,u=l-1;u>=0;)if(o.maxRow(u)===0)u--;else{for(var h=0,p=!1;h<l&&p===!1;)o.get(u,h)===1?p=!0:h++;for(var g=0;g<u;g++)for(var v=o.get(g,h),b=h;b<s;b++){var w=o.get(g,b)-v*o.get(u,b);o.set(g,b,w)}u--}return o}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Hr()(o)!=="object")throw new TypeError("options must be an object");var s=o.rows,l=s===void 0?1:s,u=o.columns,h=u===void 0?1:u;if(!Number.isInteger(l)||l<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(h)||h<=0)throw new TypeError("columns must be a positive integer");for(var p=new Tr(this.rows*l,this.columns*h),g=0;g<l;g++)for(var v=0;v<h;v++)p.setSubMatrix(this,this.rows*g,this.columns*v);return p}},{key:"fill",value:function(o){for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,o);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(o){Pa(this,o);for(var s=[],l=0;l<this.columns;l++)s.push(this.get(o,l));return s}},{key:"getRowVector",value:function(o){return Tr.rowVector(this.getRow(o))}},{key:"setRow",value:function(o,s){Pa(this,o),s=ec(this,s);for(var l=0;l<this.columns;l++)this.set(o,l,s[l]);return this}},{key:"swapRows",value:function(o,s){Pa(this,o),Pa(this,s);for(var l=0;l<this.columns;l++){var u=this.get(o,l);this.set(o,l,this.get(s,l)),this.set(s,l,u)}return this}},{key:"getColumn",value:function(o){lo(this,o);for(var s=[],l=0;l<this.rows;l++)s.push(this.get(l,o));return s}},{key:"getColumnVector",value:function(o){return Tr.columnVector(this.getColumn(o))}},{key:"setColumn",value:function(o,s){lo(this,o),s=tc(this,s);for(var l=0;l<this.rows;l++)this.set(l,o,s[l]);return this}},{key:"swapColumns",value:function(o,s){lo(this,o),lo(this,s);for(var l=0;l<this.rows;l++){var u=this.get(l,o);this.set(l,o,this.get(l,s)),this.set(l,s,u)}return this}},{key:"addRowVector",value:function(o){o=ec(this,o);for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,this.get(s,l)+o[l]);return this}},{key:"subRowVector",value:function(o){o=ec(this,o);for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,this.get(s,l)-o[l]);return this}},{key:"mulRowVector",value:function(o){o=ec(this,o);for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,this.get(s,l)*o[l]);return this}},{key:"divRowVector",value:function(o){o=ec(this,o);for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,this.get(s,l)/o[l]);return this}},{key:"addColumnVector",value:function(o){o=tc(this,o);for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,this.get(s,l)+o[s]);return this}},{key:"subColumnVector",value:function(o){o=tc(this,o);for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,this.get(s,l)-o[s]);return this}},{key:"mulColumnVector",value:function(o){o=tc(this,o);for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,this.get(s,l)*o[s]);return this}},{key:"divColumnVector",value:function(o){o=tc(this,o);for(var s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)this.set(s,l,this.get(s,l)/o[s]);return this}},{key:"mulRow",value:function(o,s){Pa(this,o);for(var l=0;l<this.columns;l++)this.set(o,l,this.get(o,l)*s);return this}},{key:"mulColumn",value:function(o,s){lo(this,o);for(var l=0;l<this.rows;l++)this.set(l,o,this.get(l,o)*s);return this}},{key:"max",value:function(o){if(this.isEmpty())return NaN;switch(o){case"row":{for(var s=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.get(l,u)>s[l]&&(s[l]=this.get(l,u));return s}case"column":{for(var h=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),p=0;p<this.rows;p++)for(var g=0;g<this.columns;g++)this.get(p,g)>h[g]&&(h[g]=this.get(p,g));return h}case void 0:{for(var v=this.get(0,0),b=0;b<this.rows;b++)for(var w=0;w<this.columns;w++)this.get(b,w)>v&&(v=this.get(b,w));return v}default:throw new Error("invalid option: ".concat(o))}}},{key:"maxIndex",value:function(){Qf(this);for(var o=this.get(0,0),s=[0,0],l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.get(l,u)>o&&(o=this.get(l,u),s[0]=l,s[1]=u);return s}},{key:"min",value:function(o){if(this.isEmpty())return NaN;switch(o){case"row":{for(var s=new Array(this.rows).fill(Number.POSITIVE_INFINITY),l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.get(l,u)<s[l]&&(s[l]=this.get(l,u));return s}case"column":{for(var h=new Array(this.columns).fill(Number.POSITIVE_INFINITY),p=0;p<this.rows;p++)for(var g=0;g<this.columns;g++)this.get(p,g)<h[g]&&(h[g]=this.get(p,g));return h}case void 0:{for(var v=this.get(0,0),b=0;b<this.rows;b++)for(var w=0;w<this.columns;w++)this.get(b,w)<v&&(v=this.get(b,w));return v}default:throw new Error("invalid option: ".concat(o))}}},{key:"minIndex",value:function(){Qf(this);for(var o=this.get(0,0),s=[0,0],l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)this.get(l,u)<o&&(o=this.get(l,u),s[0]=l,s[1]=u);return s}},{key:"maxRow",value:function(o){if(Pa(this,o),this.isEmpty())return NaN;for(var s=this.get(o,0),l=1;l<this.columns;l++)this.get(o,l)>s&&(s=this.get(o,l));return s}},{key:"maxRowIndex",value:function(o){Pa(this,o),Qf(this);for(var s=this.get(o,0),l=[o,0],u=1;u<this.columns;u++)this.get(o,u)>s&&(s=this.get(o,u),l[1]=u);return l}},{key:"minRow",value:function(o){if(Pa(this,o),this.isEmpty())return NaN;for(var s=this.get(o,0),l=1;l<this.columns;l++)this.get(o,l)<s&&(s=this.get(o,l));return s}},{key:"minRowIndex",value:function(o){Pa(this,o),Qf(this);for(var s=this.get(o,0),l=[o,0],u=1;u<this.columns;u++)this.get(o,u)<s&&(s=this.get(o,u),l[1]=u);return l}},{key:"maxColumn",value:function(o){if(lo(this,o),this.isEmpty())return NaN;for(var s=this.get(0,o),l=1;l<this.rows;l++)this.get(l,o)>s&&(s=this.get(l,o));return s}},{key:"maxColumnIndex",value:function(o){lo(this,o),Qf(this);for(var s=this.get(0,o),l=[0,o],u=1;u<this.rows;u++)this.get(u,o)>s&&(s=this.get(u,o),l[0]=u);return l}},{key:"minColumn",value:function(o){if(lo(this,o),this.isEmpty())return NaN;for(var s=this.get(0,o),l=1;l<this.rows;l++)this.get(l,o)<s&&(s=this.get(l,o));return s}},{key:"minColumnIndex",value:function(o){lo(this,o),Qf(this);for(var s=this.get(0,o),l=[0,o],u=1;u<this.rows;u++)this.get(u,o)<s&&(s=this.get(u,o),l[0]=u);return l}},{key:"diag",value:function(){for(var o=Math.min(this.rows,this.columns),s=[],l=0;l<o;l++)s.push(this.get(l,l));return s}},{key:"norm",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"frobenius",s=0;if(o==="max")return this.max();if(o==="frobenius"){for(var l=0;l<this.rows;l++)for(var u=0;u<this.columns;u++)s=s+this.get(l,u)*this.get(l,u);return Math.sqrt(s)}else throw new RangeError("unknown norm type: ".concat(o))}},{key:"cumulativeSum",value:function(){for(var o=0,s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)o+=this.get(s,l),this.set(s,l,o);return this}},{key:"dot",value:function(o){n.isMatrix(o)&&(o=o.to1DArray());var s=this.to1DArray();if(s.length!==o.length)throw new RangeError("vectors do not have the same size");for(var l=0,u=0;u<s.length;u++)l+=s[u]*o[u];return l}},{key:"mmul",value:function(o){o=Tr.checkMatrix(o);for(var s=this.rows,l=this.columns,u=o.columns,h=new Tr(s,u),p=new Float64Array(l),g=0;g<u;g++){for(var v=0;v<l;v++)p[v]=o.get(v,g);for(var b=0;b<s;b++){for(var w=0,A=0;A<l;A++)w+=this.get(b,A)*p[A];h.set(b,g,w)}}return h}},{key:"strassen2x2",value:function(o){o=Tr.checkMatrix(o);var s=new Tr(2,2),l=this.get(0,0),u=o.get(0,0),h=this.get(0,1),p=o.get(0,1),g=this.get(1,0),v=o.get(1,0),b=this.get(1,1),w=o.get(1,1),A=(l+b)*(u+w),O=(g+b)*u,D=l*(p-w),_=b*(v-u),I=(l+h)*w,B=(g-l)*(u+p),G=(h-b)*(v+w),K=A+_-I+G,ve=D+I,ae=O+_,Ye=A-O+D+B;return s.set(0,0,K),s.set(0,1,ve),s.set(1,0,ae),s.set(1,1,Ye),s}},{key:"strassen3x3",value:function(o){o=Tr.checkMatrix(o);var s=new Tr(3,3),l=this.get(0,0),u=this.get(0,1),h=this.get(0,2),p=this.get(1,0),g=this.get(1,1),v=this.get(1,2),b=this.get(2,0),w=this.get(2,1),A=this.get(2,2),O=o.get(0,0),D=o.get(0,1),_=o.get(0,2),I=o.get(1,0),B=o.get(1,1),G=o.get(1,2),K=o.get(2,0),ve=o.get(2,1),ae=o.get(2,2),Ye=(l+u+h-p-g-w-A)*B,rt=(l-p)*(-D+B),st=g*(-O+D+I-B-G-K+ae),tn=(-l+p+g)*(O-D+B),bt=(p+g)*(-O+D),jt=l*O,et=(-l+b+w)*(O-_+G),An=(-l+b)*(_-G),Vn=(b+w)*(-O+_),Zn=(l+u+h-g-v-b-w)*G,wi=w*(-O+_+I-B-G-K+ve),Ei=(-h+w+A)*(B+K-ve),Dr=(h-A)*(B-ve),eo=h*K,Uo=(w+A)*(-K+ve),Ur=(-h+g+v)*(G+K-ae),Vo=(h-v)*(G-ae),gs=(g+v)*(-K+ae),hn=u*I,Xn=v*ve,oi=p*_,ui=b*D,Ai=A*ae,Er=jt+eo+hn,jo=Ye+tn+bt+jt+Ei+eo+Uo,Zs=jt+et+Vn+Zn+eo+Ur+gs,Ui=rt+st+tn+jt+eo+Ur+Vo,Zc=rt+tn+bt+jt+Xn,Xc=eo+Ur+Vo+gs+oi,Op=jt+et+An+wi+Ei+Dr+eo,Qh=Ei+Dr+eo+Uo+ui,Dp=jt+et+An+Vn+Ai;return s.set(0,0,Er),s.set(0,1,jo),s.set(0,2,Zs),s.set(1,0,Ui),s.set(1,1,Zc),s.set(1,2,Xc),s.set(2,0,Op),s.set(2,1,Qh),s.set(2,2,Dp),s}},{key:"mmulStrassen",value:function(o){o=Tr.checkMatrix(o);var s=this.clone(),l=s.rows,u=s.columns,h=o.rows,p=o.columns;u!==h&&console.warn("Multiplying ".concat(l," x ").concat(u," and ").concat(h," x ").concat(p," matrix: dimensions do not match."));function g(A,O,D){var _=A.rows,I=A.columns;if(_===O&&I===D)return A;var B=n.zeros(O,D);return B=B.setSubMatrix(A,0,0),B}var v=Math.max(l,h),b=Math.max(u,p);s=g(s,v,b),o=g(o,v,b);function w(A,O,D,_){if(D<=512||_<=512)return A.mmul(O);D%2===1&&_%2===1?(A=g(A,D+1,_+1),O=g(O,D+1,_+1)):D%2===1?(A=g(A,D+1,_),O=g(O,D+1,_)):_%2===1&&(A=g(A,D,_+1),O=g(O,D,_+1));var I=parseInt(A.rows/2,10),B=parseInt(A.columns/2,10),G=A.subMatrix(0,I-1,0,B-1),K=O.subMatrix(0,I-1,0,B-1),ve=A.subMatrix(0,I-1,B,A.columns-1),ae=O.subMatrix(0,I-1,B,O.columns-1),Ye=A.subMatrix(I,A.rows-1,0,B-1),rt=O.subMatrix(I,O.rows-1,0,B-1),st=A.subMatrix(I,A.rows-1,B,A.columns-1),tn=O.subMatrix(I,O.rows-1,B,O.columns-1),bt=w(n.add(G,st),n.add(K,tn),I,B),jt=w(n.add(Ye,st),K,I,B),et=w(G,n.sub(ae,tn),I,B),An=w(st,n.sub(rt,K),I,B),Vn=w(n.add(G,ve),tn,I,B),Zn=w(n.sub(Ye,G),n.add(K,ae),I,B),wi=w(n.sub(ve,st),n.add(rt,tn),I,B),Ei=n.add(bt,An);Ei.sub(Vn),Ei.add(wi);var Dr=n.add(et,Vn),eo=n.add(jt,An),Uo=n.sub(bt,jt);Uo.add(et),Uo.add(Zn);var Ur=n.zeros(2*Ei.rows,2*Ei.columns);return Ur=Ur.setSubMatrix(Ei,0,0),Ur=Ur.setSubMatrix(Dr,Ei.rows,0),Ur=Ur.setSubMatrix(eo,0,Ei.columns),Ur=Ur.setSubMatrix(Uo,Ei.rows,Ei.columns),Ur.subMatrix(0,D-1,0,_-1)}return w(s,o,v,b)}},{key:"scaleRows",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Hr()(o)!=="object")throw new TypeError("options must be an object");var s=o.min,l=s===void 0?0:s,u=o.max,h=u===void 0?1:u;if(!Number.isFinite(l))throw new TypeError("min must be a number");if(!Number.isFinite(h))throw new TypeError("max must be a number");if(l>=h)throw new RangeError("min must be smaller than max");for(var p=new Tr(this.rows,this.columns),g=0;g<this.rows;g++){var v=this.getRow(g);v.length>0&&Cv(v,{min:l,max:h,output:v}),p.setRow(g,v)}return p}},{key:"scaleColumns",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Hr()(o)!=="object")throw new TypeError("options must be an object");var s=o.min,l=s===void 0?0:s,u=o.max,h=u===void 0?1:u;if(!Number.isFinite(l))throw new TypeError("min must be a number");if(!Number.isFinite(h))throw new TypeError("max must be a number");if(l>=h)throw new RangeError("min must be smaller than max");for(var p=new Tr(this.rows,this.columns),g=0;g<this.columns;g++){var v=this.getColumn(g);v.length&&Cv(v,{min:l,max:h,output:v}),p.setColumn(g,v)}return p}},{key:"flipRows",value:function(){for(var o=Math.ceil(this.columns/2),s=0;s<this.rows;s++)for(var l=0;l<o;l++){var u=this.get(s,l),h=this.get(s,this.columns-1-l);this.set(s,l,h),this.set(s,this.columns-1-l,u)}return this}},{key:"flipColumns",value:function(){for(var o=Math.ceil(this.rows/2),s=0;s<this.columns;s++)for(var l=0;l<o;l++){var u=this.get(l,s),h=this.get(this.rows-1-l,s);this.set(l,s,h),this.set(this.rows-1-l,s,u)}return this}},{key:"kroneckerProduct",value:function(o){o=Tr.checkMatrix(o);for(var s=this.rows,l=this.columns,u=o.rows,h=o.columns,p=new Tr(s*u,l*h),g=0;g<s;g++)for(var v=0;v<l;v++)for(var b=0;b<u;b++)for(var w=0;w<h;w++)p.set(u*g+b,h*v+w,this.get(g,v)*o.get(b,w));return p}},{key:"kroneckerSum",value:function(o){if(o=Tr.checkMatrix(o),!this.isSquare()||!o.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var s=this.rows,l=o.rows,u=this.kroneckerProduct(Tr.eye(l,l)),h=Tr.eye(s,s).kroneckerProduct(o);return u.add(h)}},{key:"transpose",value:function(){for(var o=new Tr(this.columns,this.rows),s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)o.set(l,s,this.get(s,l));return o}},{key:"sortRows",value:function(){for(var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gg,s=0;s<this.rows;s++)this.setRow(s,this.getRow(s).sort(o));return this}},{key:"sortColumns",value:function(){for(var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gg,s=0;s<this.columns;s++)this.setColumn(s,this.getColumn(s).sort(o));return this}},{key:"subMatrix",value:function(o,s,l,u){wv(this,o,s,l,u);for(var h=new Tr(s-o+1,u-l+1),p=o;p<=s;p++)for(var g=l;g<=u;g++)h.set(p-o,g-l,this.get(p,g));return h}},{key:"subMatrixRow",value:function(o,s,l){if(s===void 0&&(s=0),l===void 0&&(l=this.columns-1),s>l||s<0||s>=this.columns||l<0||l>=this.columns)throw new RangeError("Argument out of range");for(var u=new Tr(o.length,l-s+1),h=0;h<o.length;h++)for(var p=s;p<=l;p++){if(o[h]<0||o[h]>=this.rows)throw new RangeError("Row index out of range: ".concat(o[h]));u.set(h,p-s,this.get(o[h],p))}return u}},{key:"subMatrixColumn",value:function(o,s,l){if(s===void 0&&(s=0),l===void 0&&(l=this.rows-1),s>l||s<0||s>=this.rows||l<0||l>=this.rows)throw new RangeError("Argument out of range");for(var u=new Tr(l-s+1,o.length),h=0;h<o.length;h++)for(var p=s;p<=l;p++){if(o[h]<0||o[h]>=this.columns)throw new RangeError("Column index out of range: ".concat(o[h]));u.set(p-s,h,this.get(p,o[h]))}return u}},{key:"setSubMatrix",value:function(o,s,l){if(o=Tr.checkMatrix(o),o.isEmpty())return this;var u=s+o.rows-1,h=l+o.columns-1;wv(this,s,u,l,h);for(var p=0;p<o.rows;p++)for(var g=0;g<o.columns;g++)this.set(s+p,l+g,o.get(p,g));return this}},{key:"selection",value:function(o,s){ml(this,o),jm(this,s);for(var l=new Tr(o.length,s.length),u=0;u<o.length;u++)for(var h=o[u],p=0;p<s.length;p++){var g=s[p];l.set(u,p,this.get(h,g))}return l}},{key:"trace",value:function(){for(var o=Math.min(this.rows,this.columns),s=0,l=0;l<o;l++)s+=this.get(l,l);return s}},{key:"clone",value:function(){for(var o=new Tr(this.rows,this.columns),s=0;s<this.rows;s++)for(var l=0;l<this.columns;l++)o.set(s,l,this.get(s,l));return o}},{key:"sum",value:function(o){switch(o){case"row":return hw(this);case"column":return fw(this);case void 0:return pw(this);default:throw new Error("invalid option: ".concat(o))}}},{key:"product",value:function(o){switch(o){case"row":return gw(this);case"column":return Ev(this);case void 0:return mw(this);default:throw new Error("invalid option: ".concat(o))}}},{key:"mean",value:function(o){var s=this.sum(o);switch(o){case"row":{for(var l=0;l<this.rows;l++)s[l]/=this.columns;return s}case"column":{for(var u=0;u<this.columns;u++)s[u]/=this.rows;return s}case void 0:return s/this.size;default:throw new Error("invalid option: ".concat(o))}}},{key:"variance",value:function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Hr()(o)==="object"&&(s=o,o=void 0),Hr()(s)!=="object")throw new TypeError("options must be an object");var l=s,u=l.unbiased,h=u===void 0?!0:u,p=l.mean,g=p===void 0?this.mean(o):p;if(typeof h!="boolean")throw new TypeError("unbiased must be a boolean");switch(o){case"row":{if(!ks(g))throw new TypeError("mean must be an array");return Wb(this,h,g)}case"column":{if(!ks(g))throw new TypeError("mean must be an array");return $m(this,h,g)}case void 0:{if(typeof g!="number")throw new TypeError("mean must be a number");return vw(this,h,g)}default:throw new Error("invalid option: ".concat(o))}}},{key:"standardDeviation",value:function(o,s){Hr()(o)==="object"&&(s=o,o=void 0);var l=this.variance(o,s);if(o===void 0)return Math.sqrt(l);for(var u=0;u<l.length;u++)l[u]=Math.sqrt(l[u]);return l}},{key:"center",value:function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Hr()(o)==="object"&&(s=o,o=void 0),Hr()(s)!=="object")throw new TypeError("options must be an object");var l=s,u=l.center,h=u===void 0?this.mean(o):u;switch(o){case"row":{if(!ks(h))throw new TypeError("center must be an array");return sr(this,h),this}case"column":{if(!ks(h))throw new TypeError("center must be an array");return In(this,h),this}case void 0:{if(typeof h!="number")throw new TypeError("center must be a number");return yw(this,h),this}default:throw new Error("invalid option: ".concat(o))}}},{key:"scale",value:function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Hr()(o)==="object"&&(s=o,o=void 0),Hr()(s)!=="object")throw new TypeError("options must be an object");var l=s.scale;switch(o){case"row":{if(l===void 0)l=bw(this);else if(!ks(l))throw new TypeError("scale must be an array");return Zb(this,l),this}case"column":{if(l===void 0)l=Wm(this);else if(!ks(l))throw new TypeError("scale must be an array");return xw(this,l),this}case void 0:{if(l===void 0)l=Sv(this);else if(typeof l!="number")throw new TypeError("scale must be a number");return Cw(this,l),this}default:throw new Error("invalid option: ".concat(o))}}},{key:"toString",value:function(o){return zn(this,o)}}],[{key:"from1DArray",value:function(o,s,l){var u=o*s;if(u!==l.length)throw new RangeError("data length does not match given dimensions");for(var h=new Tr(o,s),p=0;p<o;p++)for(var g=0;g<s;g++)h.set(p,g,l[p*s+g]);return h}},{key:"rowVector",value:function(o){for(var s=new Tr(1,o.length),l=0;l<o.length;l++)s.set(0,l,o[l]);return s}},{key:"columnVector",value:function(o){for(var s=new Tr(o.length,1),l=0;l<o.length;l++)s.set(l,0,o[l]);return s}},{key:"zeros",value:function(o,s){return new Tr(o,s)}},{key:"ones",value:function(o,s){return new Tr(o,s).fill(1)}},{key:"rand",value:function(o,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Hr()(l)!=="object")throw new TypeError("options must be an object");for(var u=l.random,h=u===void 0?Math.random:u,p=new Tr(o,s),g=0;g<o;g++)for(var v=0;v<s;v++)p.set(g,v,h());return p}},{key:"randInt",value:function(o,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Hr()(l)!=="object")throw new TypeError("options must be an object");var u=l.min,h=u===void 0?0:u,p=l.max,g=p===void 0?1e3:p,v=l.random,b=v===void 0?Math.random:v;if(!Number.isInteger(h))throw new TypeError("min must be an integer");if(!Number.isInteger(g))throw new TypeError("max must be an integer");if(h>=g)throw new RangeError("min must be smaller than max");for(var w=g-h,A=new Tr(o,s),O=0;O<o;O++)for(var D=0;D<s;D++){var _=h+Math.round(b()*w);A.set(O,D,_)}return A}},{key:"eye",value:function(o,s,l){s===void 0&&(s=o),l===void 0&&(l=1);for(var u=Math.min(o,s),h=this.zeros(o,s),p=0;p<u;p++)h.set(p,p,l);return h}},{key:"diag",value:function(o,s,l){var u=o.length;s===void 0&&(s=u),l===void 0&&(l=s);for(var h=Math.min(u,s,l),p=this.zeros(s,l),g=0;g<h;g++)p.set(g,g,o[g]);return p}},{key:"min",value:function(o,s){o=this.checkMatrix(o),s=this.checkMatrix(s);for(var l=o.rows,u=o.columns,h=new Tr(l,u),p=0;p<l;p++)for(var g=0;g<u;g++)h.set(p,g,Math.min(o.get(p,g),s.get(p,g)));return h}},{key:"max",value:function(o,s){o=this.checkMatrix(o),s=this.checkMatrix(s);for(var l=o.rows,u=o.columns,h=new this(l,u),p=0;p<l;p++)for(var g=0;g<u;g++)h.set(p,g,Math.max(o.get(p,g),s.get(p,g)));return h}},{key:"checkMatrix",value:function(o){return n.isMatrix(o)?o:new Tr(o)}},{key:"isMatrix",value:function(o){return o!=null&&o.klass==="Matrix"}}]),n}();ls.prototype.klass="Matrix",typeof Symbol<"u"&&(ls.prototype[Symbol.for("nodejs.util.inspect.custom")]=gn);function gg(n,r){return n-r}function Vs(n){return n.every(function(r){return typeof r=="number"})}ls.random=ls.rand,ls.randomInt=ls.randInt,ls.diagonal=ls.diag,ls.prototype.diagonal=ls.prototype.diag,ls.identity=ls.eye,ls.prototype.negate=ls.prototype.neg,ls.prototype.tensorProduct=ls.prototype.kroneckerProduct;var Tr=function(n){bv()(o,n);var r=fg()(o);function o(s,l){var u;if(Vm()(this,o),u=r.call(this),o.isMatrix(s))return jb()(u,s.clone());if(Number.isInteger(s)&&s>=0)if(u.data=[],Number.isInteger(l)&&l>=0)for(var h=0;h<s;h++)u.data.push(new Float64Array(l));else throw new TypeError("nColumns must be a positive integer");else if(ks(s)){var p=s;if(s=p.length,l=s?p[0].length:0,typeof l!="number")throw new TypeError("Data must be a 2D array with at least one element");u.data=[];for(var g=0;g<s;g++){if(p[g].length!==l)throw new RangeError("Inconsistent array dimensions");if(!Vs(p[g]))throw new TypeError("Input data contains non-numeric values");u.data.push(Float64Array.from(p[g]))}}else throw new TypeError("First argument must be a positive number or an array");return u.rows=s,u.columns=l,u}return Fc()(o,[{key:"set",value:function(l,u,h){return this.data[l][u]=h,this}},{key:"get",value:function(l,u){return this.data[l][u]}},{key:"removeRow",value:function(l){return Pa(this,l),this.data.splice(l,1),this.rows-=1,this}},{key:"addRow",value:function(l,u){return u===void 0&&(u=l,l=this.rows),Pa(this,l,!0),u=Float64Array.from(ec(this,u)),this.data.splice(l,0,u),this.rows+=1,this}},{key:"removeColumn",value:function(l){lo(this,l);for(var u=0;u<this.rows;u++){for(var h=new Float64Array(this.columns-1),p=0;p<l;p++)h[p]=this.data[u][p];for(var g=l+1;g<this.columns;g++)h[g-1]=this.data[u][g];this.data[u]=h}return this.columns-=1,this}},{key:"addColumn",value:function(l,u){typeof u>"u"&&(u=l,l=this.columns),lo(this,l,!0),u=tc(this,u);for(var h=0;h<this.rows;h++){for(var p=new Float64Array(this.columns+1),g=0;g<l;g++)p[g]=this.data[h][g];for(p[g++]=u[h];g<this.columns+1;g++)p[g]=this.data[h][g-1];this.data[h]=p}return this.columns+=1,this}}]),o}(ls);Go(ls,Tr);var Xb=function(n){bv()(o,n);var r=fg()(o);function o(s){var l;return Vm()(this,o),l=r.call(this),l.data=s,l.rows=s.length,l.columns=s[0].length,l}return Fc()(o,[{key:"set",value:function(l,u,h){return this.data[l][u]=h,this}},{key:"get",value:function(l,u){return this.data[l][u]}}]),o}(ls);function Dh(n,r){var o=0;return Math.abs(n)>Math.abs(r)?(o=r/n,Math.abs(n)*Math.sqrt(1+o*o)):r!==0?(o=n/r,Math.abs(r)*Math.sqrt(1+o*o)):0}var Av=function(){function n(r){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Vm()(this,n),r=Xb.checkMatrix(r),r.isEmpty())throw new Error("Matrix must be non-empty");var s=r.rows,l=r.columns,u=o.computeLeftSingularVectors,h=u===void 0?!0:u,p=o.computeRightSingularVectors,g=p===void 0?!0:p,v=o.autoTranspose,b=v===void 0?!1:v,w=Boolean(h),A=Boolean(g),O=!1,D;if(s<l)if(!b)D=r.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{D=r.transpose(),s=D.rows,l=D.columns,O=!0;var _=w;w=A,A=_}else D=r.clone();for(var I=Math.min(s,l),B=Math.min(s+1,l),G=new Float64Array(B),K=new Tr(s,I),ve=new Tr(l,l),ae=new Float64Array(l),Ye=new Float64Array(s),rt=new Float64Array(B),st=0;st<B;st++)rt[st]=st;for(var tn=Math.min(s-1,l),bt=Math.max(0,Math.min(l-2,s)),jt=Math.max(tn,bt),et=0;et<jt;et++){if(et<tn){G[et]=0;for(var An=et;An<s;An++)G[et]=Dh(G[et],D.get(An,et));if(G[et]!==0){D.get(et,et)<0&&(G[et]=-G[et]);for(var Vn=et;Vn<s;Vn++)D.set(Vn,et,D.get(Vn,et)/G[et]);D.set(et,et,D.get(et,et)+1)}G[et]=-G[et]}for(var Zn=et+1;Zn<l;Zn++){if(et<tn&&G[et]!==0){for(var wi=0,Ei=et;Ei<s;Ei++)wi+=D.get(Ei,et)*D.get(Ei,Zn);wi=-wi/D.get(et,et);for(var Dr=et;Dr<s;Dr++)D.set(Dr,Zn,D.get(Dr,Zn)+wi*D.get(Dr,et))}ae[Zn]=D.get(et,Zn)}if(w&&et<tn)for(var eo=et;eo<s;eo++)K.set(eo,et,D.get(eo,et));if(et<bt){ae[et]=0;for(var Uo=et+1;Uo<l;Uo++)ae[et]=Dh(ae[et],ae[Uo]);if(ae[et]!==0){ae[et+1]<0&&(ae[et]=0-ae[et]);for(var Ur=et+1;Ur<l;Ur++)ae[Ur]/=ae[et];ae[et+1]+=1}if(ae[et]=-ae[et],et+1<s&&ae[et]!==0){for(var Vo=et+1;Vo<s;Vo++)Ye[Vo]=0;for(var gs=et+1;gs<s;gs++)for(var hn=et+1;hn<l;hn++)Ye[gs]+=ae[hn]*D.get(gs,hn);for(var Xn=et+1;Xn<l;Xn++)for(var oi=-ae[Xn]/ae[et+1],ui=et+1;ui<s;ui++)D.set(ui,Xn,D.get(ui,Xn)+oi*Ye[ui])}if(A)for(var Ai=et+1;Ai<l;Ai++)ve.set(Ai,et,ae[Ai])}}var Er=Math.min(l,s+1);if(tn<l&&(G[tn]=D.get(tn,tn)),s<Er&&(G[Er-1]=0),bt+1<Er&&(ae[bt]=D.get(bt,Er-1)),ae[Er-1]=0,w){for(var jo=tn;jo<I;jo++){for(var Zs=0;Zs<s;Zs++)K.set(Zs,jo,0);K.set(jo,jo,1)}for(var Ui=tn-1;Ui>=0;Ui--)if(G[Ui]!==0){for(var Zc=Ui+1;Zc<I;Zc++){for(var Xc=0,Op=Ui;Op<s;Op++)Xc+=K.get(Op,Ui)*K.get(Op,Zc);Xc=-Xc/K.get(Ui,Ui);for(var Qh=Ui;Qh<s;Qh++)K.set(Qh,Zc,K.get(Qh,Zc)+Xc*K.get(Qh,Ui))}for(var Dp=Ui;Dp<s;Dp++)K.set(Dp,Ui,-K.get(Dp,Ui));K.set(Ui,Ui,1+K.get(Ui,Ui));for(var pb=0;pb<Ui-1;pb++)K.set(pb,Ui,0)}else{for(var jg=0;jg<s;jg++)K.set(jg,Ui,0);K.set(Ui,Ui,1)}}if(A)for(var ka=l-1;ka>=0;ka--){if(ka<bt&&ae[ka]!==0)for(var Hg=ka+1;Hg<l;Hg++){for(var F0=0,_p=ka+1;_p<l;_p++)F0+=ve.get(_p,ka)*ve.get(_p,Hg);F0=-F0/ve.get(ka+1,ka);for(var wt=ka+1;wt<l;wt++)ve.set(wt,Hg,ve.get(wt,Hg)+F0*ve.get(wt,ka))}for(var Yt=0;Yt<l;Yt++)ve.set(Yt,ka,0);ve.set(ka,ka,1)}for(var bn=Er-1,Ln=0,vr=Number.EPSILON;Er>0;){var Hn=void 0,$r=void 0;for(Hn=Er-2;Hn>=-1&&Hn!==-1;Hn--){var pi=Number.MIN_VALUE+vr*Math.abs(G[Hn]+Math.abs(G[Hn+1]));if(Math.abs(ae[Hn])<=pi||Number.isNaN(ae[Hn])){ae[Hn]=0;break}}if(Hn===Er-2)$r=4;else{var nr=void 0;for(nr=Er-1;nr>=Hn&&nr!==Hn;nr--){var ki=(nr!==Er?Math.abs(ae[nr]):0)+(nr!==Hn+1?Math.abs(ae[nr-1]):0);if(Math.abs(G[nr])<=vr*ki){G[nr]=0;break}}nr===Hn?$r=3:nr===Er-1?$r=1:($r=2,Hn=nr)}switch(Hn++,$r){case 1:{var Ti=ae[Er-2];ae[Er-2]=0;for(var Es=Er-2;Es>=Hn;Es--){var Np=Dh(G[Es],Ti),IS=G[Es]/Np,LS=Ti/Np;if(G[Es]=Np,Es!==Hn&&(Ti=-LS*ae[Es-1],ae[Es-1]=IS*ae[Es-1]),A)for(var kp=0;kp<l;kp++)Np=IS*ve.get(kp,Es)+LS*ve.get(kp,Er-1),ve.set(kp,Er-1,-LS*ve.get(kp,Es)+IS*ve.get(kp,Er-1)),ve.set(kp,Es,Np)}break}case 2:{var FS=ae[Hn-1];ae[Hn-1]=0;for(var Lu=Hn;Lu<Er;Lu++){var gb=Dh(G[Lu],FS),GS=G[Lu]/gb,BS=FS/gb;if(G[Lu]=gb,FS=-BS*ae[Lu],ae[Lu]=GS*ae[Lu],w)for(var Rp=0;Rp<s;Rp++)gb=GS*K.get(Rp,Lu)+BS*K.get(Rp,Hn-1),K.set(Rp,Hn-1,-BS*K.get(Rp,Lu)+GS*K.get(Rp,Hn-1)),K.set(Rp,Lu,gb)}break}case 3:{var mb=Math.max(Math.abs(G[Er-1]),Math.abs(G[Er-2]),Math.abs(ae[Er-2]),Math.abs(G[Hn]),Math.abs(ae[Hn])),G0=G[Er-1]/mb,QP=G[Er-2]/mb,_1=ae[Er-2]/mb,zS=G[Hn]/mb,wk=ae[Hn]/mb,$g=((QP+G0)*(QP-G0)+_1*_1)/2,N1=G0*_1*(G0*_1),vb=0;($g!==0||N1!==0)&&($g<0?vb=0-Math.sqrt($g*$g+N1):vb=Math.sqrt($g*$g+N1),vb=N1/($g+vb));for(var Wg=(zS+G0)*(zS-G0)+vb,B0=zS*wk,Ri=Hn;Ri<Er-1;Ri++){var qa=Dh(Wg,B0);qa===0&&(qa=Number.MIN_VALUE);var Fu=Wg/qa,Gu=B0/qa;if(Ri!==Hn&&(ae[Ri-1]=qa),Wg=Fu*G[Ri]+Gu*ae[Ri],ae[Ri]=Fu*ae[Ri]-Gu*G[Ri],B0=Gu*G[Ri+1],G[Ri+1]=Fu*G[Ri+1],A)for(var Ip=0;Ip<l;Ip++)qa=Fu*ve.get(Ip,Ri)+Gu*ve.get(Ip,Ri+1),ve.set(Ip,Ri+1,-Gu*ve.get(Ip,Ri)+Fu*ve.get(Ip,Ri+1)),ve.set(Ip,Ri,qa);if(qa=Dh(Wg,B0),qa===0&&(qa=Number.MIN_VALUE),Fu=Wg/qa,Gu=B0/qa,G[Ri]=qa,Wg=Fu*ae[Ri]+Gu*G[Ri+1],G[Ri+1]=-Gu*ae[Ri]+Fu*G[Ri+1],B0=Gu*ae[Ri+1],ae[Ri+1]=Fu*ae[Ri+1],w&&Ri<s-1)for(var Lp=0;Lp<s;Lp++)qa=Fu*K.get(Lp,Ri)+Gu*K.get(Lp,Ri+1),K.set(Lp,Ri+1,-Gu*K.get(Lp,Ri)+Fu*K.get(Lp,Ri+1)),K.set(Lp,Ri,qa)}ae[Er-2]=Wg,Ln=Ln+1;break}case 4:{if(G[Hn]<=0&&(G[Hn]=G[Hn]<0?-G[Hn]:0,A))for(var k1=0;k1<=bn;k1++)ve.set(k1,Hn,-ve.get(k1,Hn));for(;Hn<bn&&!(G[Hn]>=G[Hn+1]);){var yb=G[Hn];if(G[Hn]=G[Hn+1],G[Hn+1]=yb,A&&Hn<l-1)for(var z0=0;z0<l;z0++)yb=ve.get(z0,Hn+1),ve.set(z0,Hn+1,ve.get(z0,Hn)),ve.set(z0,Hn,yb);if(w&&Hn<s-1)for(var U0=0;U0<s;U0++)yb=K.get(U0,Hn+1),K.set(U0,Hn+1,K.get(U0,Hn)),K.set(U0,Hn,yb);Hn++}Ln=0,Er--;break}}}if(O){var Ek=ve;ve=K,K=Ek}this.m=s,this.n=l,this.s=G,this.U=K,this.V=ve}return Fc()(n,[{key:"solve",value:function(o){for(var s=o,l=this.threshold,u=this.s.length,h=Tr.zeros(u,u),p=0;p<u;p++)Math.abs(this.s[p])<=l?h.set(p,p,0):h.set(p,p,1/this.s[p]);for(var g=this.U,v=this.rightSingularVectors,b=v.mmul(h),w=v.rows,A=g.rows,O=Tr.zeros(w,A),D=0;D<w;D++)for(var _=0;_<A;_++){for(var I=0,B=0;B<u;B++)I+=b.get(D,B)*g.get(_,B);O.set(D,_,I)}return O.mmul(s)}},{key:"solveForDiagonal",value:function(o){return this.solve(Tr.diag(o))}},{key:"inverse",value:function(){for(var o=this.V,s=this.threshold,l=o.rows,u=o.columns,h=new Tr(l,this.s.length),p=0;p<l;p++)for(var g=0;g<u;g++)Math.abs(this.s[g])>s&&h.set(p,g,o.get(p,g)/this.s[g]);for(var v=this.U,b=v.rows,w=v.columns,A=new Tr(l,b),O=0;O<l;O++)for(var D=0;D<b;D++){for(var _=0,I=0;I<w;I++)_+=h.get(O,I)*v.get(D,I);A.set(O,D,_)}return A}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var o=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,s=0,l=this.s,u=0,h=l.length;u<h;u++)l[u]>o&&s++;return s}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return Tr.diag(this.s)}}]),n}();class Yb{constructor(r){this.distances=r.distances,this.dimension=r.dimension||2,this.linkDistance=r.linkDistance}layout(){const r=this,{dimension:o,distances:s,linkDistance:l}=r;try{const u=Tr.mul(Tr.pow(s,2),-.5),h=u.mean("row"),p=u.mean("column"),g=u.mean();u.add(g).subRowVector(h).subColumnVector(p);const v=new Av(u),b=Tr.sqrt(v.diagonalMatrix).diagonal();return v.leftSingularVectors.toJSON().map(w=>Tr.mul([w],[b]).toJSON()[0].splice(0,o))}catch{const h=[];for(let p=0;p<s.length;p++){const g=Math.random()*l,v=Math.random()*l;h.push([g,v])}return h}}}const mg=800;class Kb{constructor(r){this.disp=[],this.positions=r.positions,this.adjMatrix=r.adjMatrix,this.focusID=r.focusID,this.radii=r.radii,this.iterations=r.iterations||10,this.height=r.height||10,this.width=r.width||10,this.speed=r.speed||100,this.gravity=r.gravity||10,this.nodeSizeFunc=r.nodeSizeFunc,this.k=r.k||5,this.strictRadial=r.strictRadial,this.nodes=r.nodes}layout(){const r=this,o=r.positions,s=[],l=r.iterations,u=r.width/10;r.maxDisplace=u,r.disp=s;for(let h=0;h<l;h++)o.forEach((p,g)=>{s[g]={x:0,y:0}}),r.getRepulsion(),r.updatePositions();return o}getRepulsion(){const r=this,o=r.positions,s=r.nodes,l=r.disp,u=r.k,h=r.radii||[];o.forEach((p,g)=>{l[g]={x:0,y:0},o.forEach((v,b)=>{if(g===b||h[g]!==h[b])return;let w=p[0]-v[0],A=p[1]-v[1],O=Math.sqrt(w*w+A*A);if(O===0){O=1;const D=g>b?1:-1;w=.01*D,A=.01*D}if(O<r.nodeSizeFunc(s[g])/2+r.nodeSizeFunc(s[b])/2){const D=u*u/O;l[g].x+=w/O*D,l[g].y+=A/O*D}})})}updatePositions(){const r=this,o=r.positions,s=r.disp,l=r.speed,u=r.strictRadial,h=r.focusID,p=r.maxDisplace||r.width/10;u&&s.forEach((v,b)=>{const w=o[b][0]-o[h][0],A=o[b][1]-o[h][1],O=Math.sqrt(w*w+A*A);let D=A/O,_=-w/O;const I=Math.sqrt(v.x*v.x+v.y*v.y);let B=Math.acos((D*v.x+_*v.y)/I);B>Math.PI/2&&(B-=Math.PI/2,D*=-1,_*=-1);const G=Math.cos(B)*I;v.x=D*G,v.y=_*G});const g=r.radii;o.forEach((v,b)=>{if(b===h)return;const w=Math.sqrt(s[b].x*s[b].x+s[b].y*s[b].y);if(w>0&&b!==h){const A=Math.min(p*(l/mg),w);if(v[0]+=s[b].x/w*A,v[1]+=s[b].y/w*A,u){let O=v[0]-o[h][0],D=v[1]-o[h][1];const _=Math.sqrt(O*O+D*D);O=O/_*g[b],D=D/_*g[b],v[0]=o[h][0]+O,v[1]=o[h][1]+D}}})}}function qb(n){const r=n.length,o=n[0].length,s=[];for(let l=0;l<r;l++){const u=[];for(let h=0;h<o;h++)n[l][h]!==0?u.push(1/(n[l][h]*n[l][h])):u.push(0);s.push(u)}return s}function Jb(n,r){let o=-1;return n.forEach((s,l)=>{s.id===r&&(o=l)}),o}function Zm(n,r){return Math.sqrt((n[0]-r[0])*(n[0]-r[0])+(n[1]-r[1])*(n[1]-r[1]))}class Tv extends _s{constructor(r){super(),this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(r)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const r=this,o=r.nodes,s=r.edges||[];if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const l=r.center;if(o.length===1){o[0].x=l[0],o[0].y=l[1],r.onLayoutEnd&&r.onLayoutEnd();return}const u=r.linkDistance;let h=null;if(yh(r.focusNode)){let jt=!1;for(let et=0;et<o.length;et++)o[et].id===r.focusNode&&(h=o[et],r.focusNode=h,jt=!0,et=o.length);jt||(h=null)}else h=r.focusNode;h||(h=o[0],r.focusNode=h);const p=Jb(o,h.id);r.focusIndex=p;const g=zf({nodes:o,edges:s},!1),v=bh(g),b=r.maxToFocus(v,p);r.handleInfinity(v,p,b+1),r.distances=v;const w=v[p],A=r.width||500,O=r.height||500;let D=A-l[0]>l[0]?l[0]:A-l[0],_=O-l[1]>l[1]?l[1]:O-l[1];D===0&&(D=A/2),_===0&&(_=O/2);const I=_>D?D:_,B=Math.max(...w),G=[];w.forEach((jt,et)=>{r.unitRadius||(r.unitRadius=I/B),G[et]=jt*r.unitRadius}),r.radii=G;const K=r.eIdealDisMatrix();r.eIdealDistances=K;const ve=qb(K);r.weights=ve;let Ye=new Yb({linkDistance:u,distances:K}).layout();Ye.forEach(jt=>{Dc(jt[0])&&(jt[0]=Math.random()*u),Dc(jt[1])&&(jt[1]=Math.random()*u)}),r.positions=Ye,Ye.forEach((jt,et)=>{o[et].x=jt[0]+l[0],o[et].y=jt[1]+l[1]}),Ye.forEach(jt=>{jt[0]-=Ye[p][0],jt[1]-=Ye[p][1]}),r.run();const rt=r.preventOverlap,st=r.nodeSize;let tn;const bt=r.strictRadial;if(rt){const jt=r.nodeSpacing;let et;En(jt)?et=()=>jt:Sa(jt)?et=jt:et=()=>0,st?xs(st)?tn=Zn=>(st[0]>st[1]?st[0]:st[1])+et(Zn):tn=Zn=>st+et(Zn):tn=Zn=>Zn.size?xs(Zn.size)?(Zn.size[0]>Zn.size[1]?Zn.size[0]:Zn.size[1])+et(Zn):Ea(Zn.size)?(Zn.size.width>Zn.size.height?Zn.size.width:Zn.size.height)+et(Zn):Zn.size+et(Zn):10+et(Zn);const An={nodes:o,nodeSizeFunc:tn,adjMatrix:g,positions:Ye,radii:G,height:O,width:A,strictRadial:bt,focusID:p,iterations:r.maxPreventOverlapIteration||200,k:Ye.length/4.5};Ye=new Kb(An).layout()}return Ye.forEach((jt,et)=>{o[et].x=jt[0]+l[0],o[et].y=jt[1]+l[1]}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s}}run(){const r=this,o=r.maxIteration,s=r.positions||[],l=r.weights||[],u=r.eIdealDistances||[],h=r.radii||[];for(let p=0;p<=o;p++){const g=p/o;r.oneIteration(g,s,h,u,l)}}oneIteration(r,o,s,l,u){const h=this,p=1-r,g=h.focusIndex;o.forEach((v,b)=>{const w=Zm(v,[0,0]),A=w===0?0:1/w;if(b===g)return;let O=0,D=0,_=0;o.forEach((B,G)=>{if(b===G)return;const K=Zm(v,B),ve=K===0?0:1/K,ae=l[G][b];_+=u[b][G],O+=u[b][G]*(B[0]+ae*(v[0]-B[0])*ve),D+=u[b][G]*(B[1]+ae*(v[1]-B[1])*ve)});const I=s[b]===0?0:1/s[b];_*=p,_+=r*I*I,O*=p,O+=r*I*v[0]*A,v[0]=O/_,D*=p,D+=r*I*v[1]*A,v[1]=D/_})}eIdealDisMatrix(){const r=this,o=r.nodes;if(!o)return[];const s=r.distances,l=r.linkDistance,u=r.radii||[],h=r.unitRadius||50,p=[];return s&&s.forEach((g,v)=>{const b=[];g.forEach((w,A)=>{if(v===A)b.push(0);else if(u[v]===u[A])if(r.sortBy==="data")b.push(w*(Math.abs(v-A)*r.sortStrength)/(u[v]/h));else if(r.sortBy){let O=o[v][r.sortBy]||0,D=o[A][r.sortBy]||0;yh(O)&&(O=O.charCodeAt(0)),yh(D)&&(D=D.charCodeAt(0)),b.push(w*(Math.abs(O-D)*r.sortStrength)/(u[v]/h))}else b.push(w*l/(u[v]/h));else{const O=(l+h)/2;b.push(w*O)}}),p.push(b)}),p}handleInfinity(r,o,s){const l=r.length;for(let u=0;u<l;u++)if(r[o][u]===1/0){r[o][u]=s,r[u][o]=s;for(let h=0;h<l;h++)r[u][h]!==1/0&&r[o][h]===1/0&&(r[o][h]=s+r[u][h],r[h][o]=s+r[u][h])}for(let u=0;u<l;u++)if(u!==o){for(let h=0;h<l;h++)if(r[u][h]===1/0){let p=Math.abs(r[o][u]-r[o][h]);p=p===0?1:p,r[u][h]=p}}}maxToFocus(r,o){let s=0;for(let l=0;l<r[o].length;l++)r[o][l]!==1/0&&(s=r[o][l]>s?r[o][l]:s);return s}getType(){return"radial"}}class Mv extends _s{constructor(r){super(),this.nodeSize=30,this.minNodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=3/2*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){const r=this,o=r.nodes,s=r.edges,l=o.length;if(l===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const u=r.center;if(l===1){o[0].x=u[0],o[0].y=u[1],r.onLayoutEnd&&r.onLayoutEnd();return}const h=[];let p;xs(r.nodeSize)?p=Math.max(r.nodeSize[0],r.nodeSize[1]):p=r.nodeSize,o.forEach(D=>{h.push(D);let _=p;xs(D.size)?_=Math.max(D.size[0],D.size[1]):En(D.size)?_=D.size:Ea(D.size)&&(_=Math.max(D.size.width,D.size.height)),p=Math.max(p,_)}),r.clockwise=r.counterclockwise!==void 0?!r.counterclockwise:r.clockwise;const g={},v={};if(h.forEach((D,_)=>{g[D.id]=D,v[D.id]=_}),(r.sortBy==="degree"||!yh(r.sortBy)||h[0][r.sortBy]===void 0)&&(r.sortBy="degree",!En(o[0].degree))){const D=Nc(o.length,v,s);h.forEach((_,I)=>{_.degree=D[I]})}h.sort((D,_)=>_[r.sortBy]-D[r.sortBy]),r.maxValueNode=h[0],r.maxLevelDiff=r.maxLevelDiff||r.maxValueNode[r.sortBy]/4;const b=[[]];let w=b[0];h.forEach(D=>{if(w.length>0){const _=Math.abs(w[0][r.sortBy]-D[r.sortBy]);r.maxLevelDiff&&_>=r.maxLevelDiff&&(w=[],b.push(w))}w.push(D)});let A=p+r.minNodeSpacing;if(!r.preventOverlap){const D=b.length>0&&b[0].length>1,I=(Math.min(r.width,r.height)/2-A)/(b.length+(D?1:0));A=Math.min(A,I)}let O=0;if(b.forEach(D=>{let _=r.sweep;_===void 0&&(_=2*Math.PI-2*Math.PI/D.length);const I=D.dTheta=_/Math.max(1,D.length-1);if(D.length>1&&r.preventOverlap){const B=Math.cos(I)-Math.cos(0),G=Math.sin(I)-Math.sin(0),K=Math.sqrt(A*A/(B*B+G*G));O=Math.max(K,O)}D.r=O,O+=A}),r.equidistant){let D=0,_=0;for(let I=0;I<b.length;I++){const G=b[I].r-_;D=Math.max(D,G)}_=0,b.forEach((I,B)=>{B===0&&(_=I.r),I.r=_,_+=D})}return b.forEach(D=>{const _=D.dTheta,I=D.r;D.forEach((B,G)=>{const K=r.startAngle+(r.clockwise?1:-1)*_*G;B.x=u[0]+I*Math.cos(K),B.y=u[1]+I*Math.sin(K)})}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s}}getType(){return"concentric"}}class Qb extends _s{constructor(r){super(),this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const r=this,{nodes:o,edges:s=[]}=r,l=r.center;if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}if(o.length===1){o[0].x=l[0],o[0].y=l[1],r.onLayoutEnd&&r.onLayoutEnd();return}const u=r.linkDistance,h=zf({nodes:o,edges:s},!1),p=bh(h);r.handleInfinity(p);const g=xh(p,u);r.scaledDistances=g;const v=r.runMDS();return r.positions=v,v.forEach((b,w)=>{o[w].x=b[0]+l[0],o[w].y=b[1]+l[1]}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:s}}runMDS(){const r=this,o=2,s=r.scaledDistances,l=Tr.mul(Tr.pow(s,2),-.5),u=l.mean("row"),h=l.mean("column"),p=l.mean();l.add(p).subRowVector(u).subColumnVector(h);const g=new Av(l),v=Tr.sqrt(g.diagonalMatrix).diagonal();return g.leftSingularVectors.toJSON().map(b=>Tr.mul([b],[v]).toJSON()[0].splice(0,o))}handleInfinity(r){let o=-999999;r.forEach(s=>{s.forEach(l=>{l!==1/0&&o<l&&(o=l)})}),r.forEach((s,l)=>{s.forEach((u,h)=>{u===1/0&&(r[l][h]=o)})})}getType(){return"mds"}}const vg=800;class ww extends _s{constructor(r){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.updateCfg(r)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){var r,o;const s=this,l=s.nodes;if(s.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(s.timeInterval),!l||l.length===0){(r=s.onLayoutEnd)===null||r===void 0||r.call(s);return}!s.width&&typeof window<"u"&&(s.width=window.innerWidth),!s.height&&typeof window<"u"&&(s.height=window.innerHeight),s.center||(s.center=[s.width/2,s.height/2]);const u=s.center;if(l.length===1){l[0].x=u[0],l[0].y=u[1],(o=s.onLayoutEnd)===null||o===void 0||o.call(s);return}const h={},p={};return l.forEach((g,v)=>{En(g.x)||(g.x=Math.random()*this.width),En(g.y)||(g.y=Math.random()*this.height),h[g.id]=g,p[g.id]=v}),s.nodeMap=h,s.nodeIdxMap=p,s.run()}run(){var r;const o=this,s=o.nodes;if(!s)return;const{edges:l,maxIteration:u,workerEnabled:h,clustering:p}=o,g={};if(p&&s.forEach(v=>{g[v.cluster]===void 0&&(g[v.cluster]={name:v.cluster,cx:0,cy:0,count:0})}),h){for(let v=0;v<u;v++)o.runOneStep(g);(r=o.onLayoutEnd)===null||r===void 0||r.call(o)}else{if(typeof window>"u")return;let v=0;this.timeInterval=window.setInterval(()=>{var b;o.runOneStep(g),v++,v>=u&&((b=o.onLayoutEnd)===null||b===void 0||b.call(o),window.clearInterval(o.timeInterval))},0)}return{nodes:s,edges:l}}runOneStep(r){var o;const s=this,l=s.nodes;if(!l)return;const{edges:u,center:h,gravity:p,speed:g,clustering:v}=s,b=s.height*s.width,w=Math.sqrt(b)/10,A=b/(l.length+1),O=Math.sqrt(A),D=[];if(l.forEach((_,I)=>{D[I]={x:0,y:0}}),s.applyCalculate(l,u,D,O,A),v){for(const I in r)r[I].cx=0,r[I].cy=0,r[I].count=0;l.forEach(I=>{const B=r[I.cluster];En(I.x)&&(B.cx+=I.x),En(I.y)&&(B.cy+=I.y),B.count++});for(const I in r)r[I].cx/=r[I].count,r[I].cy/=r[I].count;const _=s.clusterGravity||p;l.forEach((I,B)=>{if(!En(I.x)||!En(I.y))return;const G=r[I.cluster],K=Math.sqrt((I.x-G.cx)*(I.x-G.cx)+(I.y-G.cy)*(I.y-G.cy)),ve=O*_;D[B].x-=ve*(I.x-G.cx)/K,D[B].y-=ve*(I.y-G.cy)/K})}l.forEach((_,I)=>{if(!En(_.x)||!En(_.y))return;const B=.01*O*p;D[I].x-=B*(_.x-h[0]),D[I].y-=B*(_.y-h[1])}),l.forEach((_,I)=>{if(En(_.fx)&&En(_.fy)){_.x=_.fx,_.y=_.fy;return}if(!En(_.x)||!En(_.y))return;const B=Math.sqrt(D[I].x*D[I].x+D[I].y*D[I].y);if(B>0){const G=Math.min(w*(g/vg),B);_.x+=D[I].x/B*G,_.y+=D[I].y/B*G}}),(o=s.tick)===null||o===void 0||o.call(s)}applyCalculate(r,o,s,l,u){const h=this;h.calRepulsive(r,s,u),o&&h.calAttractive(o,s,l)}calRepulsive(r,o,s){r.forEach((l,u)=>{o[u]={x:0,y:0},r.forEach((h,p)=>{if(u===p||!En(l.x)||!En(h.x)||!En(l.y)||!En(h.y))return;let g=l.x-h.x,v=l.y-h.y,b=g*g+v*v;if(b===0){b=1;const A=u>p?1:-1;g=.01*A,v=.01*A}const w=s/b;o[u].x+=g*w,o[u].y+=v*w})})}calAttractive(r,o,s){r.forEach(l=>{const u=Kr(l,"source"),h=Kr(l,"target");if(!u||!h)return;const p=this.nodeIdxMap[u],g=this.nodeIdxMap[h];if(p===g)return;const v=this.nodeMap[u],b=this.nodeMap[h];if(!En(b.x)||!En(v.x)||!En(b.y)||!En(v.y))return;const w=b.x-v.x,A=b.y-v.y,O=Math.sqrt(w*w+A*A),D=O*O/s;o[g].x-=w/O*D,o[g].y-=A/O*D,o[p].x+=w/O*D,o[p].y+=A/O*D})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)}destroy(){const r=this;r.stop(),r.tick=null,r.nodes=null,r.edges=null,r.destroyed=!0}getType(){return"fruchterman"}}var tr=P(43269),Wn=P(15671),or=P(43144),On=P(53229),ep=P(64687),kn=P.n(ep),Zr=P(15861),yg=-1,Pv=1;function vl(){return Pv++}var Td=function n(r){(0,Wn.Z)(this,n)},Md=function(){function n(r){(0,Wn.Z)(this,n),this.clazz=void 0,this.components=[],this.entities=[],this.lookup={},this.clazz=r}return(0,or.Z)(n,[{key:"clear",value:function(){this.components=[],this.entities=[],this.lookup={}}},{key:"contains",value:function(o){return this.lookup[o]>-1}},{key:"create",value:function(o,s){this.lookup[o]=this.components.length;var l=new this.clazz(s||{});return this.components.push(l),this.entities.push(o),l}},{key:"remove",value:function(o){var s=this.lookup[o];s>-1&&s<this.components.length-1&&(this.components[s]=this.components[this.components.length-1],this.entities[s]=this.entities[this.entities.length-1],this.lookup[this.entities[s]]=s),this.components.pop(),this.entities.pop(),delete this.lookup[o]}},{key:"removeKeepSorted",value:function(o){var s=this.lookup[o];if(s>-1){var l=this.entities[s];if(s<this.components.length-1){for(var u=s+1;u<this.components.length;++u)this.components[u-1]=this.components[u];for(var h=s+1;h<this.entities.length;++h)this.entities[h-1]=this.entities[h],this.lookup[this.entities[h-1]]=h-1}this.components.pop(),this.entities.pop(),delete this.lookup[l]}}},{key:"moveItem",value:function(o,s){if(o!==s){for(var l=this.components[o],u=this.entities[o],h=o<s?1:-1,p=o;p!==s;p+=h){var g=p+h;this.components[p]=this.components[g],this.entities[p]=this.entities[g],this.lookup[this.entities[p]]=p}this.components[s]=l,this.entities[s]=u,this.lookup[u]=s}}},{key:"getEntity",value:function(o){return this.entities[o]}},{key:"getComponent",value:function(o){return this.components[o]}},{key:"getComponentByEntity",value:function(o){var s=this.lookup[o];return s>-1?this.components[s]:null}},{key:"getCount",value:function(){return this.components.length}},{key:"getEntityByComponentIndex",value:function(o){for(var s=0,l=Object.keys(this.lookup);s<l.length;s++){var u=l[s],h=Number(u);if(this.lookup[h]===o)return h}return yg}},{key:"find",value:function(o){for(var s=0;s<this.getCount();s++){var l=this.getComponent(s);if(o(l,s))return l}return null}},{key:"findIndex",value:function(o){for(var s=0;s<this.getCount();s++){var l=this.getComponent(s);if(o(l,s))return s}return-1}},{key:"forEach",value:function(o){for(var s=0,l=Object.keys(this.lookup);s<l.length;s++){var u=l[s],h=Number(u),p=this.lookup[h];o(h,this.getComponent(p))}}},{key:"forEachAsync",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){var u,h,p,g,v;return kn().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:u=0,h=Object.keys(this.lookup);case 1:if(!(u<h.length)){w.next=10;break}return p=h[u],g=Number(p),v=this.lookup[g],w.next=7,l(g,this.getComponent(v));case 7:u++,w.next=1;break;case 10:case"end":return w.stop()}},s,this)}));function o(s){return r.apply(this,arguments)}return o}()},{key:"map",value:function(o){for(var s=[],l=0,u=Object.keys(this.lookup);l<u.length;l++){var h=u[l],p=Number(h),g=this.lookup[p];s.push(o(p,this.getComponent(g)))}return s}}]),n}(),_h=P(29439),Pt={HierarchyComponentManager:Symbol("HierarchyComponentManager"),TransformComponentManager:Symbol("TransformComponentManager"),NameComponentManager:Symbol("NameComponentManager"),SceneGraphSystem:Symbol("SceneGraphSystem"),FrameGraphSystem:Symbol("FrameGraphSystem"),ResourcePool:Symbol("ResourcePool"),ResourceHandleComponentManager:Symbol("ResourceHandleComponentManager"),PassNodeComponentManager:Symbol("PassNodeComponentManager"),RendererSystem:Symbol("RendererSystem"),RenderPass:Symbol("RenderPass"),RenderPassFactory:Symbol("Factory<IRenderPass>"),Renderable:Symbol("Factory<IRenderPass>"),MeshSystem:Symbol("MeshSystem"),MeshComponentManager:Symbol("MeshComponentManager"),CullableComponentManager:Symbol("CullableComponentManager"),Geometry:Symbol("Geometry"),GeometrySystem:Symbol("GeometrySystem"),GeometryComponentManager:Symbol("GeometryComponentManager"),Material:Symbol("Material"),MaterialSystem:Symbol("MaterialSystem"),MaterialComponentManager:Symbol("MaterialComponentManager"),ForwardRenderPath:Symbol("ForwardRenderPath"),ComputeSystem:Symbol("ComputeSystem"),ComputeComponentManager:Symbol("ComputeComponentManager"),ComputeStrategy:Symbol("ComputeStrategy"),Systems:Symbol("Systems"),World:Symbol("World"),RenderEngine:Symbol("RenderEngine"),WebGPUEngine:Symbol("WebGPUEngine"),WebGLEngine:Symbol("WebGLEngine"),ShaderModuleService:Symbol("ShaderModuleService"),ConfigService:Symbol("ConfigService"),InteractorService:Symbol("InteractorService"),IEventEmitter:Symbol("IEventEmitter"),Light:Symbol("Light")},e2=function n(){(0,Wn.Z)(this,n),this.index=void 0},Ew=function n(){(0,Wn.Z)(this,n),this.name=void 0,this.data=void 0,this.execute=void 0,this.tearDown=void 0},va=function(){function n(){(0,Wn.Z)(this,n),this.name=void 0,this.refCount=0,this.hasSideEffect=!1,this.devirtualize=[],this.destroy=[],this.reads=[],this.writes=[]}return(0,or.Z)(n,[{key:"read",value:function(o){return this.reads.find(function(s){return s.index===o.index})||this.reads.push(o),o}},{key:"sample",value:function(o){return this.read(o),o}},{key:"write",value:function(o,s){var l=this.writes.find(function(g){return g.index===s.index});if(l)return s;var u=o.getResourceNode(s);u.resource.version++,u.resource.imported&&(this.hasSideEffect=!0);var h=o.createResourceNode(u.resource),p=o.getResourceNode(h);return p.writer=this,this.writes.push(h),h}}]),n}(),Rs=P(60136),js=P(82963),Pr=P(61120),Sw=function n(){(0,Wn.Z)(this,n),this.first=void 0,this.last=void 0};function Aw(n){var r=Cu();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function Cu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Ov=function(n){(0,Rs.Z)(o,n);var r=Aw(o);function o(){var s;(0,Wn.Z)(this,o);for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];return s=r.call.apply(r,[this].concat(u)),s.version=0,s.refs=0,s.name=void 0,s.imported=void 0,s.priority=void 0,s.discardStart=!0,s.discardEnd=!1,s.descriptor=void 0,s.resource=void 0,s}return(0,or.Z)(o,[{key:"preExecuteDestroy",value:function(){this.discardEnd=!0}},{key:"postExecuteDestroy",value:function(){this.imported}},{key:"postExecuteDevirtualize",value:function(){this.discardStart=!1}},{key:"preExecuteDevirtualize",value:function(){this.imported}}]),o}(Sw),Dv=function n(){(0,Wn.Z)(this,n),this.resource=void 0,this.writer=void 0,this.readerCount=0,this.version=void 0},t2,_v,Nv,Xm,kv,Rv;function Za(n,r){var o;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(o=Nh(n))||r&&n&&typeof n.length=="number"){o&&(n=o);var s=0,l=function(){};return{s:l,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(v){throw v},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=!0,h=!1,p;return{s:function(){o=n[Symbol.iterator]()},n:function(){var v=o.next();return u=v.done,v},e:function(v){h=!0,p=v},f:function(){try{!u&&o.return!=null&&o.return()}finally{if(h)throw p}}}}function Nh(n,r){if(!!n){if(typeof n=="string")return Ym(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);if(o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set")return Array.from(n);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Ym(n,r)}}function Ym(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=n[o];return s}var Km=(t2=(0,U.b2)(),_v=(0,U.f3)(Pt.RenderEngine),t2(Nv=(Xm=(Rv=function(){function n(){(0,Wn.Z)(this,n),this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[],(0,tr.Z)(this,"engine",kv,this)}return(0,or.Z)(n,[{key:"execute",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){return kn().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return this.compile(),h.next=3,this.executePassNodes(l);case 3:case"end":return h.stop()}},s,this)}));function o(s){return r.apply(this,arguments)}return o}()},{key:"tearDown",value:function(){this.frameGraphPasses.forEach(function(o){o.tearDown&&o.tearDown()}),this.reset()}},{key:"addPass",value:function(o,s,l,u){var h=new Ew;h.execute=l,u&&(h.tearDown=u),h.name=o;var p=new va;return p.name=o,this.passNodes.push(p),this.frameGraphPasses.push(h),s(this,p,h),h}},{key:"getPass",value:function(o){return this.frameGraphPasses.find(function(s){return s.name===o})}},{key:"compile",value:function(){var o=this,s=Za(this.passNodes),l;try{for(s.s();!(l=s.n()).done;){var u=l.value;u.refCount=u.writes.length+(u.hasSideEffect?1:0),u.reads.forEach(function(Dr){o.resourceNodes[Dr.index].readerCount++})}}catch(Dr){s.e(Dr)}finally{s.f()}var h=[],p=Za(this.resourceNodes),g;try{for(p.s();!(g=p.n()).done;){var v=g.value;v.readerCount===0&&h.push(v)}}catch(Dr){p.e(Dr)}finally{p.f()}for(;h.length;){var b=h.pop(),w=b&&b.writer;if(w&&--w.refCount===0){var A=Za(w.reads),O;try{for(A.s();!(O=A.n()).done;){var D=O.value,_=this.resourceNodes[D.index];--_.readerCount===0&&h.push(_)}}catch(Dr){A.e(Dr)}finally{A.f()}}}this.resourceNodes.forEach(function(Dr){Dr.resource.refs+=Dr.readerCount});var I=Za(this.passNodes),B;try{for(I.s();!(B=I.n()).done;){var G=B.value;if(!!G.refCount){var K=Za(G.reads),ve;try{for(K.s();!(ve=K.n()).done;){var ae=ve.value,Ye=this.resourceNodes[ae.index].resource;Ye.first=Ye.first?Ye.first:G,Ye.last=G}}catch(Dr){K.e(Dr)}finally{K.f()}var rt=Za(G.writes),st;try{for(rt.s();!(st=rt.n()).done;){var tn=st.value,bt=this.resourceNodes[tn.index].resource;bt.first=bt.first?bt.first:G,bt.last=G}}catch(Dr){rt.e(Dr)}finally{rt.f()}}}}catch(Dr){I.e(Dr)}finally{I.f()}for(var jt=0;jt<2;jt++){var et=Za(this.resourceNodes),An;try{for(et.s();!(An=et.n()).done;){var Vn=An.value,Zn=Vn.resource;if(Zn.priority===jt&&Zn.refs){var wi=Zn.first,Ei=Zn.last;wi&&Ei&&(wi.devirtualize.push(Zn),Ei.destroy.push(Zn))}}}catch(Dr){et.e(Dr)}finally{et.f()}}}},{key:"executePassNodes",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){var u,h,p,g,v,b,w,A,O,D,_,I,B,G,K,ve,ae;return kn().wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:u=Za(this.passNodes.entries()),rt.prev=1,u.s();case 3:if((h=u.n()).done){rt.next=18;break}if(p=(0,_h.Z)(h.value,2),g=p[0],v=p[1],!v.refCount){rt.next=16;break}b=Za(v.devirtualize);try{for(b.s();!(w=b.n()).done;)A=w.value,A.preExecuteDevirtualize(this.engine)}catch(st){b.e(st)}finally{b.f()}O=Za(v.destroy);try{for(O.s();!(D=O.n()).done;)_=D.value,_.preExecuteDestroy(this.engine)}catch(st){O.e(st)}finally{O.f()}return rt.next=12,this.frameGraphPasses[g].execute(this,this.frameGraphPasses[g],l);case 12:I=Za(v.devirtualize);try{for(I.s();!(B=I.n()).done;)G=B.value,G.postExecuteDevirtualize(this.engine)}catch(st){I.e(st)}finally{I.f()}K=Za(v.destroy);try{for(K.s();!(ve=K.n()).done;)ae=ve.value,ae.postExecuteDestroy(this.engine)}catch(st){K.e(st)}finally{K.f()}case 16:rt.next=3;break;case 18:rt.next=23;break;case 20:rt.prev=20,rt.t0=rt.catch(1),u.e(rt.t0);case 23:return rt.prev=23,u.f(),rt.finish(23);case 26:this.reset();case 27:case"end":return rt.stop()}},s,this,[[1,20,23,26]])}));function o(s){return r.apply(this,arguments)}return o}()},{key:"reset",value:function(){this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[]}},{key:"getResourceNode",value:function(o){return this.resourceNodes[o.index]}},{key:"createResourceNode",value:function(o){var s=new Dv;s.resource=o,s.version=o.version,this.resourceNodes.push(s);var l=new e2;return l.index=this.resourceNodes.length-1,l}},{key:"createTexture",value:function(o,s,l){var u=new Ov;return u.name=s,u.descriptor=l,this.createResourceNode(u)}},{key:"createRenderTarget",value:function(o,s,l){var u=new Ov;return u.name=s,u.descriptor=l,this.createResourceNode(u)}},{key:"present",value:function(o){this.addPass("Present",function(s,l){l.read(o),l.hasSideEffect=!0},(0,Zr.Z)(kn().mark(function s(){return kn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:case"end":return u.stop()}},s)})))}}]),n}(),Rv),kv=(0,On.Z)(Xm.prototype,"engine",[_v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xm))||Nv),ht=P(4942),vo=P(97326),yo=P(98333),kh=P(35600),gt=P(77160),Pd=P(71002),n2=9007199254740991,Tw="[object Arguments]",Mw="[object Array]",Pw="[object Boolean]",qm="[object Date]",Jm="[object Error]",Oo="[object Function]",Ow="[object Map]",Dw="[object Number]",r2="[object Object]",i2="[object RegExp]",_w="[object Set]",Nw="[object String]",o2="[object WeakMap]",s2="[object ArrayBuffer]",kw="[object DataView]",Rw="[object Float32Array]",a2="[object Float64Array]",Iw="[object Int8Array]",Lw="[object Int16Array]",Fw="[object Int32Array]",l2="[object Uint8Array]",Gw="[object Uint8ClampedArray]",c2="[object Uint16Array]",Bw="[object Uint32Array]",bo={};bo[Rw]=bo[a2]=bo[Iw]=bo[Lw]=bo[Fw]=bo[l2]=bo[Gw]=bo[c2]=bo[Bw]=!0,bo[Tw]=bo[Mw]=bo[s2]=bo[Pw]=bo[kw]=bo[qm]=bo[Jm]=bo[Oo]=bo[Ow]=bo[Dw]=bo[r2]=bo[i2]=bo[_w]=bo[Nw]=bo[o2]=!1;function qS(n){return function(r){return n(r)}}var zw=Object.prototype,Uw=zw.toString;function Vw(n){return Hw(n)&&jw(n.length)&&!!bo[Uw.call(n)]}function jw(n){return typeof n=="number"&&n>-1&&n%1===0&&n<=n2}function Hw(n){return!!n&&(0,Pd.Z)(n)==="object"}var bg=Vw;function wu(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function Iv(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?wu(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):wu(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}function u2(n){var r=d2();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function d2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var $w=function(n){(0,Rs.Z)(o,n);var r=u2(o);function o(s){var l;return(0,Wn.Z)(this,o),l=r.call(this,s),l.dirty=!0,l.attributes=[],l.indices=void 0,l.indicesBuffer=void 0,l.vertexCount=0,l.maxInstancedCount=void 0,l.aabb=void 0,l.entity=void 0,Object.assign((0,vo.Z)(l),s),l}return(0,or.Z)(o,[{key:"setAttribute",value:function(l,u,h,p){var g=this.attributes.find(function(v){return v.name===l});return g?(g.data=u,g.dirty=!0):this.attributes.push(Iv(Iv({dirty:!0,name:l,data:u},h),{},{bufferGetter:p})),this.dirty=!0,this}},{key:"setIndex",value:function(l){return this.indices=new Uint32Array(l.buffer?l.buffer:l),this.dirty=!0,this}},{key:"applyMatrix",value:function(l){var u=this.attributes.find(function(A){var O=A.name;return O==="position"}),h=this.attributes.find(function(A){var O=A.name;return O==="normal"});if(u&&(u.dirty=!0,u.data&&u.data.length))for(var p=0;p<u.data.length;p+=3){var g=yo.al(u.data[p],u.data[p+1],u.data[p+2],1);yo.fF(g,g,l),bg(u.data)?u.data.set([g[0],g[1],g[2]],p):(u.data[p]=g[0],u.data[p+1]=g[1],u.data[p+2]=g[2])}if(h){var v=kh.XL(kh.Ue(),l);if(h.data&&h.data.length)for(var b=0;b<h.data.length;b+=3){var w=gt.fromValues(h.data[b],h.data[b+1],h.data[b+2]);gt.transformMat3(w,w,v),gt.normalize(w,w),bg(h.data)?h.data.set([w[0],w[1],w[2]],b):(h.data[b]=w[0],h.data[b+1]=w[1],h.data[b+2]=w[2])}}}}]),o}(Td),tt;(function(n){n[n.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",n[n.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",n[n.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.FUNC_ADD=32774]="FUNC_ADD",n[n.BLEND_EQUATION=32777]="BLEND_EQUATION",n[n.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",n[n.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",n[n.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",n[n.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",n[n.MAX_EXT=32776]="MAX_EXT",n[n.MIN_EXT=32775]="MIN_EXT",n[n.BLEND_DST_RGB=32968]="BLEND_DST_RGB",n[n.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",n[n.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",n[n.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",n[n.BLEND_COLOR=32773]="BLEND_COLOR",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",n[n.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",n[n.STREAM_DRAW=35040]="STREAM_DRAW",n[n.STATIC_DRAW=35044]="STATIC_DRAW",n[n.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",n[n.BUFFER_SIZE=34660]="BUFFER_SIZE",n[n.BUFFER_USAGE=34661]="BUFFER_USAGE",n[n.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",n[n.FRONT=1028]="FRONT",n[n.BACK=1029]="BACK",n[n.FRONT_AND_BACK=1032]="FRONT_AND_BACK",n[n.CULL_FACE=2884]="CULL_FACE",n[n.BLEND=3042]="BLEND",n[n.DITHER=3024]="DITHER",n[n.STENCIL_TEST=2960]="STENCIL_TEST",n[n.DEPTH_TEST=2929]="DEPTH_TEST",n[n.SCISSOR_TEST=3089]="SCISSOR_TEST",n[n.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",n[n.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",n[n.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",n[n.NO_ERROR=0]="NO_ERROR",n[n.INVALID_ENUM=1280]="INVALID_ENUM",n[n.INVALID_VALUE=1281]="INVALID_VALUE",n[n.INVALID_OPERATION=1282]="INVALID_OPERATION",n[n.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",n[n.CW=2304]="CW",n[n.CCW=2305]="CCW",n[n.LINE_WIDTH=2849]="LINE_WIDTH",n[n.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",n[n.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",n[n.CULL_FACE_MODE=2885]="CULL_FACE_MODE",n[n.FRONT_FACE=2886]="FRONT_FACE",n[n.DEPTH_RANGE=2928]="DEPTH_RANGE",n[n.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",n[n.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",n[n.DEPTH_FUNC=2932]="DEPTH_FUNC",n[n.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",n[n.STENCIL_FUNC=2962]="STENCIL_FUNC",n[n.STENCIL_FAIL=2964]="STENCIL_FAIL",n[n.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",n[n.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",n[n.STENCIL_REF=2967]="STENCIL_REF",n[n.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",n[n.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",n[n.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",n[n.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",n[n.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",n[n.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",n[n.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",n[n.VIEWPORT=2978]="VIEWPORT",n[n.SCISSOR_BOX=3088]="SCISSOR_BOX",n[n.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",n[n.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",n[n.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",n[n.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",n[n.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",n[n.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",n[n.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",n[n.RED_BITS=3410]="RED_BITS",n[n.GREEN_BITS=3411]="GREEN_BITS",n[n.BLUE_BITS=3412]="BLUE_BITS",n[n.ALPHA_BITS=3413]="ALPHA_BITS",n[n.DEPTH_BITS=3414]="DEPTH_BITS",n[n.STENCIL_BITS=3415]="STENCIL_BITS",n[n.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",n[n.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",n[n.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",n[n.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",n[n.SAMPLES=32937]="SAMPLES",n[n.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",n[n.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",n[n.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",n[n.DONT_CARE=4352]="DONT_CARE",n[n.FASTEST=4353]="FASTEST",n[n.NICEST=4354]="NICEST",n[n.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",n[n.BYTE=5120]="BYTE",n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.SHORT=5122]="SHORT",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.INT=5124]="INT",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.FLOAT=5126]="FLOAT",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.ALPHA=6406]="ALPHA",n[n.RGB=6407]="RGB",n[n.RGBA=6408]="RGBA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",n[n.VERTEX_SHADER=35633]="VERTEX_SHADER",n[n.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",n[n.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",n[n.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",n[n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",n[n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",n[n.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",n[n.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",n[n.SHADER_TYPE=35663]="SHADER_TYPE",n[n.DELETE_STATUS=35712]="DELETE_STATUS",n[n.LINK_STATUS=35714]="LINK_STATUS",n[n.VALIDATE_STATUS=35715]="VALIDATE_STATUS",n[n.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",n[n.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",n[n.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",n[n.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",n[n.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",n[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",n[n.KEEP=7680]="KEEP",n[n.REPLACE=7681]="REPLACE",n[n.INCR=7682]="INCR",n[n.DECR=7683]="DECR",n[n.INVERT=5386]="INVERT",n[n.INCR_WRAP=34055]="INCR_WRAP",n[n.DECR_WRAP=34056]="DECR_WRAP",n[n.VENDOR=7936]="VENDOR",n[n.RENDERER=7937]="RENDERER",n[n.VERSION=7938]="VERSION",n[n.NEAREST=9728]="NEAREST",n[n.LINEAR=9729]="LINEAR",n[n.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",n[n.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",n[n.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",n[n.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",n[n.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",n[n.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",n[n.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",n[n.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE=5890]="TEXTURE",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n[n.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",n[n.TEXTURE0=33984]="TEXTURE0",n[n.TEXTURE1=33985]="TEXTURE1",n[n.TEXTURE2=33986]="TEXTURE2",n[n.TEXTURE3=33987]="TEXTURE3",n[n.TEXTURE4=33988]="TEXTURE4",n[n.TEXTURE5=33989]="TEXTURE5",n[n.TEXTURE6=33990]="TEXTURE6",n[n.TEXTURE7=33991]="TEXTURE7",n[n.TEXTURE8=33992]="TEXTURE8",n[n.TEXTURE9=33993]="TEXTURE9",n[n.TEXTURE10=33994]="TEXTURE10",n[n.TEXTURE11=33995]="TEXTURE11",n[n.TEXTURE12=33996]="TEXTURE12",n[n.TEXTURE13=33997]="TEXTURE13",n[n.TEXTURE14=33998]="TEXTURE14",n[n.TEXTURE15=33999]="TEXTURE15",n[n.TEXTURE16=34e3]="TEXTURE16",n[n.TEXTURE17=34001]="TEXTURE17",n[n.TEXTURE18=34002]="TEXTURE18",n[n.TEXTURE19=34003]="TEXTURE19",n[n.TEXTURE20=34004]="TEXTURE20",n[n.TEXTURE21=34005]="TEXTURE21",n[n.TEXTURE22=34006]="TEXTURE22",n[n.TEXTURE23=34007]="TEXTURE23",n[n.TEXTURE24=34008]="TEXTURE24",n[n.TEXTURE25=34009]="TEXTURE25",n[n.TEXTURE26=34010]="TEXTURE26",n[n.TEXTURE27=34011]="TEXTURE27",n[n.TEXTURE28=34012]="TEXTURE28",n[n.TEXTURE29=34013]="TEXTURE29",n[n.TEXTURE30=34014]="TEXTURE30",n[n.TEXTURE31=34015]="TEXTURE31",n[n.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",n[n.REPEAT=10497]="REPEAT",n[n.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n[n.FLOAT_VEC2=35664]="FLOAT_VEC2",n[n.FLOAT_VEC3=35665]="FLOAT_VEC3",n[n.FLOAT_VEC4=35666]="FLOAT_VEC4",n[n.INT_VEC2=35667]="INT_VEC2",n[n.INT_VEC3=35668]="INT_VEC3",n[n.INT_VEC4=35669]="INT_VEC4",n[n.BOOL=35670]="BOOL",n[n.BOOL_VEC2=35671]="BOOL_VEC2",n[n.BOOL_VEC3=35672]="BOOL_VEC3",n[n.BOOL_VEC4=35673]="BOOL_VEC4",n[n.FLOAT_MAT2=35674]="FLOAT_MAT2",n[n.FLOAT_MAT3=35675]="FLOAT_MAT3",n[n.FLOAT_MAT4=35676]="FLOAT_MAT4",n[n.SAMPLER_2D=35678]="SAMPLER_2D",n[n.SAMPLER_CUBE=35680]="SAMPLER_CUBE",n[n.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",n[n.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",n[n.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",n[n.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",n[n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",n[n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",n[n.COMPILE_STATUS=35713]="COMPILE_STATUS",n[n.LOW_FLOAT=36336]="LOW_FLOAT",n[n.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",n[n.HIGH_FLOAT=36338]="HIGH_FLOAT",n[n.LOW_INT=36339]="LOW_INT",n[n.MEDIUM_INT=36340]="MEDIUM_INT",n[n.HIGH_INT=36341]="HIGH_INT",n[n.FRAMEBUFFER=36160]="FRAMEBUFFER",n[n.RENDERBUFFER=36161]="RENDERBUFFER",n[n.RGBA4=32854]="RGBA4",n[n.RGB5_A1=32855]="RGB5_A1",n[n.RGB565=36194]="RGB565",n[n.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",n[n.STENCIL_INDEX=6401]="STENCIL_INDEX",n[n.STENCIL_INDEX8=36168]="STENCIL_INDEX8",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n[n.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",n[n.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",n[n.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",n[n.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",n[n.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",n[n.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",n[n.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",n[n.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",n[n.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",n[n.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",n[n.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",n[n.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",n[n.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",n[n.NONE=0]="NONE",n[n.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",n[n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",n[n.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",n[n.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",n[n.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",n[n.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",n[n.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",n[n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",n[n.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",n[n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",n[n.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",n[n.COPY_SRC=1]="COPY_SRC",n[n.COPY_DST=2]="COPY_DST",n[n.SAMPLED=4]="SAMPLED",n[n.STORAGE=8]="STORAGE",n[n.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(tt||(tt={}));var Lv,h2,Rh,f2,Qm,p2,g2,m2,Ww=(Lv=(0,U.b2)(),h2=(0,U.f3)(Pt.GeometryComponentManager),Rh=(0,U.f3)(Pt.RenderEngine),Lv(f2=(Qm=(m2=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"geometry",p2,this),(0,tr.Z)(this,"engine",g2,this)}return(0,or.Z)(n,[{key:"execute",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l=this;return kn().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:this.geometry.forEach(function(p,g){g.dirty&&(g.attributes.forEach(function(v){if(v.dirty&&v.data){if(!v.buffer)v.buffer=l.engine.createBuffer({data:v.data,type:tt.FLOAT});else{var b;(b=v.buffer)===null||b===void 0||b.subData({data:v.data,offset:0})}v.dirty=!1}}),g.indices&&(g.indicesBuffer?g.indicesBuffer.subData({data:g.indices,offset:0}):g.indicesBuffer=l.engine.createElements({data:g.indices,count:g.indices.length,type:tt.UNSIGNED_INT,usage:tt.STATIC_DRAW})),g.dirty=!1)});case 1:case"end":return h.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"tearDown",value:function(){this.geometry.forEach(function(o,s){s.indicesBuffer&&s.indicesBuffer.destroy(),s.attributes.forEach(function(l){l.buffer&&l.buffer.destroy()})}),this.geometry.clear()}},{key:"createBufferGeometry",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{vertexCount:3},s=o.vertexCount,l=vl();return this.geometry.create(l,{vertexCount:s})}},{key:"createInstancedBufferGeometry",value:function(o){var s=o.maxInstancedCount,l=o.vertexCount,u=vl();return this.geometry.create(u,{maxInstancedCount:s,vertexCount:l})}}]),n}(),m2),p2=(0,On.Z)(Qm.prototype,"geometry",[h2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g2=(0,On.Z)(Qm.prototype,"engine",[Rh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qm))||f2);function v2(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function y2(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?v2(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):v2(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}function Zw(n){var r=Xw();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function Xw(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var b2=function(n){(0,Rs.Z)(o,n);var r=Zw(o);function o(s){var l;return(0,Wn.Z)(this,o),l=r.call(this,s),l.vertexShaderGLSL=void 0,l.fragmentShaderGLSL=void 0,l.defines={},l.dirty=!0,l.uniforms=[],l.cull={enable:!0,face:tt.BACK},l.depth={enable:!0},l.blend=void 0,l.entity=void 0,l.type=void 0,Object.assign((0,vo.Z)(l),s),l}return(0,or.Z)(o,[{key:"setDefines",value:function(l){return this.defines=y2(y2({},this.defines),l),this}},{key:"setCull",value:function(l){return this.cull=l,this}},{key:"setDepth",value:function(l){return this.depth=l,this}},{key:"setBlend",value:function(l){return this.blend=l,this}},{key:"setUniform",value:function(l,u){var h=this;if(typeof l!="string")return Object.keys(l).forEach(function(g){return h.setUniform(g,l[g])}),this;var p=this.uniforms.find(function(g){return g.name===l});return p?(p.dirty=!0,p.data=u):this.uniforms.push({name:l,dirty:!0,data:u}),this.dirty=!0,this}}]),o}(Td),x2,C2,w2,E2,Eu,tp,S2,A2,Fv,T2;function M2(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function P2(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?M2(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):M2(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}var Yw=(x2=(0,U.b2)(),C2=(0,U.f3)(Pt.MaterialComponentManager),w2=(0,U.f3)(Pt.RenderEngine),E2=(0,U.f3)(Pt.ShaderModuleService),x2(Eu=(tp=(T2=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"material",S2,this),(0,tr.Z)(this,"engine",A2,this),(0,tr.Z)(this,"shaderModule",Fv,this)}return(0,or.Z)(n,[{key:"execute",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){return kn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:case"end":return u.stop()}},s)}));function o(){return r.apply(this,arguments)}return o}()},{key:"tearDown",value:function(){this.material.clear()}},{key:"createShaderMaterial",value:function(o){var s=vl(),l=o.vertexShader,u=o.fragmentShader,h=[];if(!this.engine.supportWebGPU){var p="material-".concat(s);this.shaderModule.registerModule(p,{vs:o.vertexShader,fs:o.fragmentShader});var g=this.shaderModule.getModule(p);l=g.vs,u=g.fs,g.uniforms&&(h=Object.keys(g.uniforms).map(function(v){return{dirty:!0,name:v,data:g.uniforms[v]}}))}return this.material.create(s,P2(P2({vertexShaderGLSL:l,fragmentShaderGLSL:u},o),{},{uniforms:h}))}}]),n}(),T2),S2=(0,On.Z)(tp.prototype,"material",[C2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A2=(0,On.Z)(tp.prototype,"engine",[w2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fv=(0,On.Z)(tp.prototype,"shaderModule",[E2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tp))||Eu);function Kw(n){var r=qw();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function qw(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Gv;(function(n){n[n.Standard=0]="Standard"})(Gv||(Gv={}));var Jw=function(n){(0,Rs.Z)(o,n);var r=Kw(o);function o(s){var l;return(0,Wn.Z)(this,o),l=r.call(this,s),l.strategy=Gv.Standard,l.visibilityPlaneMask=0,l.visible=!1,Object.assign((0,vo.Z)(l),s),l}return o}(Td),e0=function(){function n(r,o){(0,Wn.Z)(this,n),this.center=void 0,this.halfExtents=void 0,this.min=gt.create(),this.max=gt.create(),this.update(r,o)}return(0,or.Z)(n,[{key:"update",value:function(o,s){this.center=o||gt.create(),this.halfExtents=s||gt.fromValues(.5,.5,.5),this.min=gt.sub(this.min,this.center,this.halfExtents),this.max=gt.add(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(o,s){gt.add(this.center,s,o),gt.scale(this.center,this.center,.5),gt.sub(this.halfExtents,s,o),gt.scale(this.halfExtents,this.halfExtents,.5),gt.copy(this.min,o),gt.copy(this.max,s)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(o){var s=this.center,l=s[0],u=s[1],h=s[2],p=this.halfExtents,g=p[0],v=p[1],b=p[2],w=l-g,A=l+g,O=u-v,D=u+v,_=h-b,I=h+b,B=o.center,G=B[0],K=B[1],ve=B[2],ae=o.halfExtents,Ye=ae[0],rt=ae[1],st=ae[2],tn=G-Ye,bt=G+Ye,jt=K-rt,et=K+rt,An=ve-st,Vn=ve+st;tn<w&&(w=tn),bt>A&&(A=bt),jt<O&&(O=jt),et>D&&(D=et),An<_&&(_=An),Vn>I&&(I=Vn),s[0]=(w+A)*.5,s[1]=(O+D)*.5,s[2]=(_+I)*.5,p[0]=(A-w)*.5,p[1]=(D-O)*.5,p[2]=(I-_)*.5,this.min[0]=w,this.min[1]=O,this.min[2]=_,this.max[0]=A,this.max[1]=D,this.max[2]=I}},{key:"intersects",value:function(o){var s=this.getMax(),l=this.getMin(),u=o.getMax(),h=o.getMin();return l[0]<=u[0]&&s[0]>=h[0]&&l[1]<=u[1]&&s[1]>=h[1]&&l[2]<=u[2]&&s[2]>=h[2]}},{key:"containsPoint",value:function(o){var s=this.getMin(),l=this.getMax();return!(o[0]<s[0]||o[0]>l[0]||o[1]<s[1]||o[1]>l[1]||o[2]<s[2]||o[2]>l[2])}},{key:"getNegativeFarPoint",value:function(o){return o.pnVertexFlag===273?gt.copy(gt.create(),this.min):o.pnVertexFlag===272?gt.fromValues(this.min[0],this.min[1],this.max[2]):o.pnVertexFlag===257?gt.fromValues(this.min[0],this.max[1],this.min[2]):o.pnVertexFlag===256?gt.fromValues(this.min[0],this.max[1],this.max[2]):o.pnVertexFlag===17?gt.fromValues(this.max[0],this.min[1],this.min[2]):o.pnVertexFlag===16?gt.fromValues(this.max[0],this.min[1],this.max[2]):o.pnVertexFlag===1?gt.fromValues(this.max[0],this.max[1],this.min[2]):gt.fromValues(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(o){return o.pnVertexFlag===273?gt.copy(gt.create(),this.max):o.pnVertexFlag===272?gt.fromValues(this.max[0],this.max[1],this.min[2]):o.pnVertexFlag===257?gt.fromValues(this.max[0],this.min[1],this.max[2]):o.pnVertexFlag===256?gt.fromValues(this.max[0],this.min[1],this.min[2]):o.pnVertexFlag===17?gt.fromValues(this.min[0],this.max[1],this.max[2]):o.pnVertexFlag===16?gt.fromValues(this.min[0],this.max[1],this.min[2]):o.pnVertexFlag===1?gt.fromValues(this.min[0],this.min[1],this.max[2]):gt.fromValues(this.min[0],this.min[1],this.min[2])}}]),n}();function O2(n){var r=Qw();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function Qw(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var eE=function(n){(0,Rs.Z)(o,n);var r=O2(o);function o(s){var l;return(0,Wn.Z)(this,o),l=r.call(this,s),l.material=void 0,l.geometry=void 0,l.aabb=new e0,l.aabbDirty=!0,l.model=void 0,l.visible=!0,l.children=[],Object.assign((0,vo.Z)(l),s),l}return o}(Td),tE=function(){function n(r,o){(0,Wn.Z)(this,n),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=r||0,this.normal=o||gt.fromValues(0,1,0),this.updatePNVertexFlag()}return(0,or.Z)(n,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(o){return gt.dot(o,this.normal)-this.distance}},{key:"normalize",value:function(){var o=1/gt.len(this.normal);gt.scale(this.normal,this.normal,o),this.distance*=o}},{key:"intersectsLine",value:function(o,s,l){var u=this.distanceToPoint(o),h=this.distanceToPoint(s),p=u/(u-h),g=p>=0&&p<=1;return g&&l&&gt.lerp(l,o,s,p),g}}]),n}(),ia;(function(n){n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE"})(ia||(ia={}));var nE=function(){function n(r){if((0,Wn.Z)(this,n),this.planes=[],r)this.planes=r;else for(var o=0;o<6;o++)this.planes.push(new tE)}return(0,or.Z)(n,[{key:"extractFromVPMatrix",value:function(o){var s=(0,_h.Z)(o,16),l=s[0],u=s[1],h=s[2],p=s[3],g=s[4],v=s[5],b=s[6],w=s[7],A=s[8],O=s[9],D=s[10],_=s[11],I=s[12],B=s[13],G=s[14],K=s[15];gt.set(this.planes[0].normal,p-l,w-g,_-A),this.planes[0].distance=-(K-I),gt.set(this.planes[1].normal,p+l,w+g,_+A),this.planes[1].distance=-(K+I),gt.set(this.planes[2].normal,p+u,w+v,_+O),this.planes[2].distance=-(K+B),gt.set(this.planes[3].normal,p-u,w-v,_-O),this.planes[3].distance=-(K-B),gt.set(this.planes[4].normal,p-h,w-b,_-D),this.planes[4].distance=-(K-G),gt.set(this.planes[5].normal,p+h,w+b,_+D),this.planes[5].distance=-(K+G),this.planes.forEach(function(ve){ve.normalize(),ve.updatePNVertexFlag()})}}]),n}();function D2(n){return typeof n=="number"}function JS(n){return n===void 0?0:n>360||n<-360?n%360:n}function QS(n,r,o){return isNumber(n)?vec3.fromValues(n,r,o):n.length===3?vec3.clone(n):vec3.fromValues(n[0],n[1],n[2])}function rE(n,r){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[4],r[4]=n[5],r[5]=n[6],r[6]=n[8],r[7]=n[9],r[8]=n[10],r}function Bv(n){var r=(0,_h.Z)(n,3),o=r[0],s=r[1],l=r[2],u=o+s*256+l*65536-1;return u}function eA(n){return[n+1&255,n+1>>8&255,n+1>>8>>8&255]}var np,_2,zv,N2,Uv,k2,R2,Ih,xg,yl,I2,L2,F2,G2;function Gc(n,r){var o;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(o=Vv(n))||r&&n&&typeof n.length=="number"){o&&(n=o);var s=0,l=function(){};return{s:l,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(v){throw v},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=!0,h=!1,p;return{s:function(){o=n[Symbol.iterator]()},n:function(){var v=o.next();return u=v.done,v},e:function(v){h=!0,p=v},f:function(){try{!u&&o.return!=null&&o.return()}finally{if(h)throw p}}}}function Vv(n,r){if(!!n){if(typeof n=="string")return Cs(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);if(o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set")return Array.from(n);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Cs(n,r)}}function Cs(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=n[o];return s}var iE=(np=(0,U.b2)(),_2=(0,U.f3)(Pt.MeshComponentManager),zv=(0,U.f3)(Pt.CullableComponentManager),N2=(0,U.f3)(Pt.GeometryComponentManager),Uv=(0,U.f3)(Pt.HierarchyComponentManager),k2=(0,U.f3)(Pt.TransformComponentManager),np(R2=(Ih=(G2=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"mesh",xg,this),(0,tr.Z)(this,"cullable",yl,this),(0,tr.Z)(this,"geometry",I2,this),(0,tr.Z)(this,"hierarchy",L2,this),(0,tr.Z)(this,"transform",F2,this),this.planes=void 0}return(0,or.Z)(n,[{key:"setFrustumPlanes",value:function(o){this.planes=o}},{key:"execute",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){var u,h,p,g,v,b,w,A,O,D,_,I,B,G,K,ve,ae,Ye,rt,st,tn;return kn().wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:u=Gc(l);try{for(u.s();!(h=u.n()).done;){p=h.value,g=p.getScene(),v=p.getCamera(),b=Gc(g.getEntities());try{for(b.s();!(w=b.n()).done;)A=w.value,O=this.mesh.getComponentByEntity(A),O&&(D=this.hierarchy.getComponentByEntity(A),_=this.cullable.getComponentByEntity(A),I=O.geometry,B=this.transform.getComponentByEntity(A),I&&I.aabb&&B&&O.aabbDirty&&(G=B.worldTransform,K=I.aabb,ve=K.center,ae=K.halfExtents,Ye=gt.transformMat4(gt.create(),ve,G),rt=rE(G,kh.Ue()),st=gt.transformMat3(gt.create(),ae,rt),O.aabb.update(Ye,st),O.aabbDirty=!1),_&&I&&(tn=this.cullable.getComponentByEntity((D==null?void 0:D.parentID)||-1),_.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(O.aabb,(tn==null?void 0:tn.visibilityPlaneMask)||ia.INDETERMINATE,this.planes||v.getFrustum().planes),_.visible=_.visibilityPlaneMask!==ia.OUTSIDE))}catch(et){b.e(et)}finally{b.f()}}}catch(et){u.e(et)}finally{u.f()}case 2:case"end":return jt.stop()}},s,this)}));function o(s){return r.apply(this,arguments)}return o}()},{key:"tearDown",value:function(){this.cullable.clear(),this.mesh.clear()}},{key:"computeVisibilityWithPlaneMask",value:function(o,s,l){if(s===ia.OUTSIDE||s===ia.INSIDE)return s;for(var u=ia.INSIDE,h=0,p=l.length;h<p;++h){var g=h<31?1<<h:0;if(!(h<31&&(s&g)===0)){var v=l[h],b=v.normal,w=v.distance;if(gt.dot(b,o.getNegativeFarPoint(l[h]))+w>0)return ia.OUTSIDE;gt.dot(b,o.getPositiveFarPoint(l[h]))+w>0&&(u|=g)}}return u}}]),n}(),G2),xg=(0,On.Z)(Ih.prototype,"mesh",[_2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=(0,On.Z)(Ih.prototype,"cullable",[zv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I2=(0,On.Z)(Ih.prototype,"geometry",[N2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L2=(0,On.Z)(Ih.prototype,"hierarchy",[Uv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F2=(0,On.Z)(Ih.prototype,"transform",[k2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ih))||R2),cr=P(85975),B2,z2,U2,V2,j2,H2,$2,W2,Z2,Od,jv,Hv,bl,X2,Lh,Hs,Bo,$v,Y2,Wv,K2,q2,J2,Su;function Xa(n,r){var o;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(o=Zv(n))||r&&n&&typeof n.length=="number"){o&&(n=o);var s=0,l=function(){};return{s:l,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(v){throw v},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=!0,h=!1,p;return{s:function(){o=n[Symbol.iterator]()},n:function(){var v=o.next();return u=v.done,v},e:function(v){h=!0,p=v},f:function(){try{!u&&o.return!=null&&o.return()}finally{if(h)throw p}}}}function Zv(n,r){if(!!n){if(typeof n=="string")return t0(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);if(o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set")return Array.from(n);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return t0(n,r)}}function t0(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=n[o];return s}var rp=(B2=(0,U.b2)(),z2=(0,U.f3)(Pt.MeshComponentManager),U2=(0,U.f3)(Pt.GeometryComponentManager),V2=(0,U.f3)(Pt.MaterialComponentManager),j2=(0,U.f3)(Pt.CullableComponentManager),H2=(0,U.f3)(Pt.TransformComponentManager),$2=(0,U.f3)(Pt.HierarchyComponentManager),W2=(0,U.f3)(Pt.Systems),Z2=(0,U.t6)(Pt.FrameGraphSystem),Od=(0,U.f3)(Pt.RenderEngine),jv=(0,U.f3)(Pt.ResourcePool),B2(Hv=(bl=(Su=J2=function(){function n(){var r=this;(0,Wn.Z)(this,n),(0,tr.Z)(this,"mesh",X2,this),(0,tr.Z)(this,"geometry",Lh,this),(0,tr.Z)(this,"material",Hs,this),(0,tr.Z)(this,"cullable",Bo,this),(0,tr.Z)(this,"transform",$v,this),(0,tr.Z)(this,"hierarchy",Y2,this),(0,tr.Z)(this,"frameGraphSystem",Wv,this),(0,tr.Z)(this,"engine",K2,this),(0,tr.Z)(this,"resourcePool",q2,this),this.modelCache={},this.setup=function(o,s,l){var u=o.createRenderTarget(s,"color buffer",{width:1,height:1,usage:tt.RENDER_ATTACHMENT|tt.SAMPLED|tt.COPY_SRC});l.data={output:s.write(o,u)}},this.execute=function(){var o=(0,Zr.Z)(kn().mark(function s(l,u,h){var p,g,v,b,w,A;return kn().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:p=l.getResourceNode(u.data.output),g=r.resourcePool.getOrCreateResource(p.resource),v=Xa(h),D.prev=3,v.s();case 5:if((b=v.n()).done){D.next=11;break}return w=b.value,D.next=9,r.initView(w);case 9:D.next=5;break;case 11:D.next=16;break;case 13:D.prev=13,D.t0=D.catch(3),v.e(D.t0);case 16:return D.prev=16,v.f(),D.finish(16);case 19:A=r.engine.getCanvas(),g.resize({width:A.width,height:A.height}),r.engine.setScissor({enable:!1}),r.engine.clear({framebuffer:g,color:h[0].getClearColor(),depth:1}),r.engine.useFramebuffer(g,function(){var _=Xa(h),I;try{for(_.s();!(I=_.n()).done;){var B=I.value;r.renderView(B)}}catch(G){_.e(G)}finally{_.f()}});case 24:case"end":return D.stop()}},s,null,[[3,13,16,19]])}));return function(s,l,u){return o.apply(this,arguments)}}()}return(0,or.Z)(n,[{key:"renderView",value:function(o){var s=o.getScene(),l=o.getCamera(),u=l.getViewTransform(),h=cr.multiply(cr.create(),l.getPerspective(),u);l.getFrustum().extractFromVPMatrix(h);var p=o.getViewport(),g=p.x,v=p.y,b=p.width,w=p.height;this.engine.viewport({x:g,y:v,width:b,height:w});var A=Xa(s.getEntities()),O;try{for(A.s();!(O=A.n()).done;){var D=O.value;this.renderMesh(D,{camera:l,view:o,viewMatrix:u})}}catch(_){A.e(_)}finally{A.f()}}},{key:"renderMesh",value:function(o,s){var l=s.camera,u=s.view,h=s.viewMatrix,p=this.mesh.getComponentByEntity(o);if(!(!p||!p.visible)){var g=p.material,v=p.geometry;if(!(!v||v.dirty||!g)){var b=this.transform.getComponentByEntity(o),w=cr.multiply(cr.create(),h,b.worldTransform),A=u.getViewport(),O=A.width,D=A.height;g.setUniform({projectionMatrix:l.getPerspective(),modelViewMatrix:w,modelMatrix:b.worldTransform,viewMatrix:h,cameraPosition:l.getPosition(),u_viewport:[O,D]}),p.model&&(p.model.draw({uniforms:g.uniforms.reduce(function(_,I){return _[I.name]=I.data,_},{})}),g.uniforms.forEach(function(_){_.dirty=!1}),g.dirty=!1)}}}},{key:"initMesh",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l,u){var h,p,g,v,b,w,A,O;return kn().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(h=this.mesh.getComponentByEntity(l),h){_.next=3;break}return _.abrupt("return");case 3:if(p=h.material,g=h.geometry,!(!g||g.dirty||!p)){_.next=7;break}return _.abrupt("return");case 7:if(h.model){_.next=24;break}if(v="m-".concat(p.entity,"-g-").concat(g.entity),!this.modelCache[v]){_.next=12;break}return h.model=this.modelCache[v],_.abrupt("return");case 12:return p.setUniform({projectionMatrix:1,modelViewMatrix:1,modelMatrix:1,viewMatrix:1,cameraPosition:1,u_viewport:1}),b=this.engine,w=b.createModel,A=b.createAttribute,O={vs:p.vertexShaderGLSL,fs:p.fragmentShaderGLSL,defines:p.defines,attributes:g.attributes.reduce(function(I,B){return B.data&&B.buffer&&(I[B.name]=A({buffer:B.buffer,attributes:B.attributes,arrayStride:B.arrayStride,stepMode:B.stepMode,divisor:B.stepMode==="vertex"?0:1})),I},{}),uniforms:p.uniforms.reduce(function(I,B){return I[B.name]=B.data,I},{}),scissor:{enable:!0,box:function(){return u.getViewport()}}},p.cull&&(O.cull=p.cull),p.depth&&(O.depth=p.depth),p.blend&&(O.blend=p.blend),g.indicesBuffer&&(O.elements=g.indicesBuffer),g.maxInstancedCount&&(O.instances=g.maxInstancedCount,O.count=g.vertexCount||3),_.next=22,w(O);case 22:h.model=_.sent,this.modelCache[v]=h.model;case 24:case"end":return _.stop()}},s,this)}));function o(s,l){return r.apply(this,arguments)}return o}()},{key:"initView",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){var u,h,p,g;return kn().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:u=l.getScene(),h=Xa(u.getEntities()),b.prev=2,h.s();case 4:if((p=h.n()).done){b.next=10;break}return g=p.value,b.next=8,this.initMesh(g,l);case 8:b.next=4;break;case 10:b.next=15;break;case 12:b.prev=12,b.t0=b.catch(2),h.e(b.t0);case 15:return b.prev=15,h.f(),b.finish(15);case 18:case"end":return b.stop()}},s,this,[[2,12,15,18]])}));function o(s){return r.apply(this,arguments)}return o}()}]),n}(),J2.IDENTIFIER="Render Pass",Su),X2=(0,On.Z)(bl.prototype,"mesh",[z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lh=(0,On.Z)(bl.prototype,"geometry",[U2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hs=(0,On.Z)(bl.prototype,"material",[V2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bo=(0,On.Z)(bl.prototype,"cullable",[j2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$v=(0,On.Z)(bl.prototype,"transform",[H2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y2=(0,On.Z)(bl.prototype,"hierarchy",[$2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wv=(0,On.Z)(bl.prototype,"frameGraphSystem",[W2,Z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K2=(0,On.Z)(bl.prototype,"engine",[Od],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q2=(0,On.Z)(bl.prototype,"resourcePool",[jv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bl))||Hv),Q2,ex,Xv,tx,nx,rx,ip,ix,ox,op,Au,sx,Tu;function Yv(n,r){var o;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(o=oE(n))||r&&n&&typeof n.length=="number"){o&&(n=o);var s=0,l=function(){};return{s:l,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(v){throw v},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=!0,h=!1,p;return{s:function(){o=n[Symbol.iterator]()},n:function(){var v=o.next();return u=v.done,v},e:function(v){h=!0,p=v},f:function(){try{!u&&o.return!=null&&o.return()}finally{if(h)throw p}}}}function oE(n,r){if(!!n){if(typeof n=="string")return ax(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);if(o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set")return Array.from(n);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return ax(n,r)}}function ax(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=n[o];return s}var Kv={NONE:0,ENCODE:1,HIGHLIGHT:2},qv=(Q2=(0,U.b2)(),ex=(0,U.f3)(Pt.RenderEngine),Xv=(0,U.f3)(Pt.ResourcePool),tx=(0,U.f3)(Pt.RenderPassFactory),nx=(0,U.f3)(Pt.MeshComponentManager),Q2(rx=(ip=(Tu=sx=function(){function n(){var r=this;(0,Wn.Z)(this,n),(0,tr.Z)(this,"engine",ix,this),(0,tr.Z)(this,"resourcePool",ox,this),(0,tr.Z)(this,"renderPassFactory",op,this),(0,tr.Z)(this,"mesh",Au,this),this.pickingFBO=void 0,this.views=void 0,this.highlightEnabled=!0,this.highlightColor=[255,0,0,255],this.alreadyInRendering=!1,this.setup=function(o,s,l){var u=o.createRenderTarget(s,"picking fbo",{width:1,height:1});l.data={output:s.write(o,u)},s.hasSideEffect=!0},this.execute=function(){var o=(0,Zr.Z)(kn().mark(function s(l,u,h){var p,g,v;return kn().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(r.views=h,!r.alreadyInRendering){w.next=3;break}return w.abrupt("return");case 3:p=Yv(h);try{for(v=function(){var O=g.value,D=O.getViewport(),_=D.width,I=D.height;r.alreadyInRendering=!0;var B=l.getResourceNode(u.data.output);r.pickingFBO=r.resourcePool.getOrCreateResource(B.resource),r.pickingFBO.resize({width:_,height:I}),r.engine.useFramebuffer(r.pickingFBO,function(){r.engine.clear({framebuffer:r.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var G=r.renderPassFactory(rp.IDENTIFIER),K=[],ve=O.getScene(),ae=Yv(ve.getEntities()),Ye;try{for(ae.s();!(Ye=ae.n()).done;){var rt=Ye.value,st=r.mesh.getComponentByEntity(rt),tn=st.material;tn.setUniform("u_PickingStage",Kv.ENCODE),K.push(st)}}catch(bt){ae.e(bt)}finally{ae.f()}G.renderView(O),K.forEach(function(bt){var jt=bt.material;jt.setUniform("u_PickingStage",Kv.HIGHLIGHT)}),r.alreadyInRendering=!1})},p.s();!(g=p.n()).done;)v()}catch(A){p.e(A)}finally{p.f()}case 5:case"end":return w.stop()}},s)}));return function(s,l,u){return o.apply(this,arguments)}}(),this.pick=function(o,s){var l=o.x,u=o.y,h=r.engine,p=h.readPixels,g=h.useFramebuffer,v=s.getViewport(),b=v.width,w=v.height,A=l*window.devicePixelRatio,O=u*window.devicePixelRatio;if(!(A>b||A<0||O>w||O<0)){var D,_;return g(r.pickingFBO,function(){D=p({x:Math.round(A),y:Math.round(w-(u+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:r.pickingFBO}),(D[0]!==0||D[1]!==0||D[2]!==0)&&(_=Bv(D),r.highlightEnabled&&r.highlightPickedFeature(D,s))}),_}}}return(0,or.Z)(n,[{key:"enableHighlight",value:function(o){this.highlightEnabled=o}},{key:"setHighlightColor",value:function(o){this.highlightColor=o}},{key:"highlightPickedFeature",value:function(o,s){if(o){var l=Yv(s.getScene().getEntities()),u;try{for(l.s();!(u=l.n()).done;){var h=u.value,p=this.mesh.getComponentByEntity(h),g=p.material;g.setUniform("u_PickingStage",Kv.HIGHLIGHT),g.setUniform("u_PickingColor",[o[0],o[1],o[2]]),g.setUniform("u_HighlightColor",this.highlightColor)}}catch(v){l.e(v)}finally{l.f()}}}}]),n}(),sx.IDENTIFIER="PixelPicking Pass",Tu),ix=(0,On.Z)(ip.prototype,"engine",[ex],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ox=(0,On.Z)(ip.prototype,"resourcePool",[Xv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),op=(0,On.Z)(ip.prototype,"renderPassFactory",[tx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Au=(0,On.Z)(ip.prototype,"mesh",[nx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ip))||rx),lx,cx,ux,dx,Cg,Jv,Qv,hx,fx,px=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Fh=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Mu=`layout(set = 0, binding = 0) uniform sampler u_TextureSampler;
layout(set = 0, binding = 1) uniform texture2D u_Texture;

layout(location = 0) in vec2 v_UV;
layout(location = 0) out vec4 outColor;

void main() {
  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);
}`,sE=`layout(location = 0) in vec2 a_Position;
layout(location = 0) out vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Dd=(lx=(0,U.b2)(),cx=(0,U.f3)(Pt.RenderEngine),ux=(0,U.f3)(Pt.ResourcePool),lx(dx=(Cg=(fx=hx=function n(){var r=this;(0,Wn.Z)(this,n),(0,tr.Z)(this,"engine",Jv,this),(0,tr.Z)(this,"resourcePool",Qv,this),this.model=void 0,this.setup=function(o,s,l){var u=o.getPass(rp.IDENTIFIER);if(u){var h=o.createRenderTarget(s,"render to screen",{width:1,height:1});l.data={input:s.read(u.data.output),output:s.write(o,h)}}},this.execute=function(){var o=(0,Zr.Z)(kn().mark(function s(l,u){var h,p,g,v,b,w,A;return kn().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(h=r.engine,p=h.createModel,g=h.createAttribute,v=h.createBuffer,r.model){D.next=6;break}return D.next=4,p({vs:r.engine.supportWebGPU?sE:Fh,fs:r.engine.supportWebGPU?Mu:px,attributes:{a_Position:g({buffer:v({data:[-4,-4,4,-4,0,4],type:tt.FLOAT}),size:2,arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})},uniforms:{u_Texture:null},depth:{enable:!1},count:3,blend:{enable:!0}});case 4:b=D.sent,r.model=b;case 6:w=l.getResourceNode(u.data.input),A=r.resourcePool.getOrCreateResource(w.resource),r.engine.useFramebuffer(null,function(){r.engine.clear({framebuffer:null,color:[0,0,0,0],depth:1,stencil:0}),r.model.draw({uniforms:{u_Texture:A}})});case 9:case"end":return D.stop()}},s)}));return function(s,l){return o.apply(this,arguments)}}(),this.tearDown=function(){r.model=void 0}},hx.IDENTIFIER="Copy Pass",fx),Jv=(0,On.Z)(Cg.prototype,"engine",[cx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qv=(0,On.Z)(Cg.prototype,"resourcePool",[ux],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cg))||dx),xl,aE,ey,Is,ty,gx,wg,Bc,n0,_d,Nd,ny,ii,ry=(xl=(0,U.b2)(),aE=(0,U.f3)(Pt.Systems),ey=(0,U.t6)(Pt.FrameGraphSystem),Is=(0,U.f3)(Pt.RenderPassFactory),ty=(0,U.f3)(Pt.ConfigService),gx=(0,U.f3)(Pt.ResourcePool),xl(wg=(Bc=(ii=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"frameGraphSystem",n0,this),(0,tr.Z)(this,"renderPassFactory",_d,this),(0,tr.Z)(this,"configService",Nd,this),(0,tr.Z)(this,"resourcePool",ny,this)}return(0,or.Z)(n,[{key:"execute",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){var u,h,p,g,v,b,w,A,O;return kn().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:u=this.renderPassFactory(rp.IDENTIFIER),h=u.setup,p=u.execute,g=this.frameGraphSystem.addPass(rp.IDENTIFIER,h,p),v=this.renderPassFactory(Dd.IDENTIFIER),b=v.setup,w=v.execute,A=v.tearDown,O=this.frameGraphSystem.addPass(Dd.IDENTIFIER,b,w,A),this.frameGraphSystem.present(O.data.output);case 5:case"end":return _.stop()}},s,this)}));function o(s){return r.apply(this,arguments)}return o}()},{key:"tearDown",value:function(){this.resourcePool.clean()}},{key:"pick",value:function(o,s){var l=this.renderPassFactory(qv.IDENTIFIER);return l.pick(o,s)}}]),n}(),ii),n0=(0,On.Z)(Bc.prototype,"frameGraphSystem",[aE,ey],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_d=(0,On.Z)(Bc.prototype,"renderPassFactory",[Is],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nd=(0,On.Z)(Bc.prototype,"configService",[ty],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ny=(0,On.Z)(Bc.prototype,"resourcePool",[gx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bc))||wg);function lE(n){var r=mx();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function mx(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var vx=function(n){(0,Rs.Z)(o,n);var r=lE(o);function o(s){var l;return(0,Wn.Z)(this,o),l=r.call(this,s),l.parentID=void 0,Object.assign((0,vo.Z)(l),s),l}return o}(Td),yx,bx,xx,Cx,kd,Eg,li,Rd,iy,wx,xo=(yx=(0,U.b2)(),bx=(0,U.f3)(Pt.HierarchyComponentManager),xx=(0,U.f3)(Pt.TransformComponentManager),Cx=(0,U.f3)(Pt.MeshComponentManager),yx(kd=(Eg=(wx=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"hierarchy",li,this),(0,tr.Z)(this,"transform",Rd,this),(0,tr.Z)(this,"mesh",iy,this)}return(0,or.Z)(n,[{key:"execute",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){return kn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:this.runTransformUpdateSystem(),this.runHierarchyUpdateSystem();case 2:case"end":return u.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"tearDown",value:function(){this.hierarchy.clear(),this.transform.clear()}},{key:"getHierarchyComponentManager",value:function(){return this.hierarchy}},{key:"getTransformComponentManager",value:function(){return this.transform}},{key:"runTransformUpdateSystem",value:function(){var o=this;this.transform.forEach(function(s,l){(l.isDirty()||l.isLocalDirty())&&(o.setMeshAABBDirty(o.mesh.getComponentByEntity(s)),l.updateTransform())})}},{key:"runHierarchyUpdateSystem",value:function(){var o=this;this.hierarchy.forEach(function(s,l){var u=o.transform.getComponentByEntity(s),h=o.transform.getComponentByEntity(l.parentID);u!==null&&h!==null&&u.updateTransformWithParent(h)})}},{key:"attach",value:function(o,s,l){this.hierarchy.contains(o)&&this.detach(o),this.hierarchy.create(o,{parentID:s});var u=this.mesh.getComponentByEntity(s);if(this.setMeshAABBDirty(u),u&&u.children.indexOf(o)===-1&&u.children.push(o),this.hierarchy.getCount()>1)for(var h=this.hierarchy.getCount()-1;h>0;--h)for(var p=this.hierarchy.getEntity(h),g=0;g<h;++g){var v=this.hierarchy.getComponent(g);if(v.parentID===p){this.hierarchy.moveItem(h,g),++h;break}}var b=this.hierarchy.getComponentByEntity(o),w=this.transform.getComponentByEntity(s);w===null&&(w=this.transform.create(s));var A=this.transform.getComponentByEntity(o);A===null&&(A=this.transform.create(o),w=this.transform.getComponentByEntity(s)),A.parent=w,!l&&w&&(A.matrixTransform(cr.invert(cr.create(),w.worldTransform)),A.updateTransform()),w&&A.updateTransformWithParent(w)}},{key:"detach",value:function(o){var s=this.hierarchy.getComponentByEntity(o);if(s!==null){var l=this.transform.getComponentByEntity(o);l!==null&&(l.parent=null,l.applyTransform()),this.hierarchy.removeKeepSorted(o);var u=this.mesh.getComponentByEntity(s.parentID);if(u){var h=u.children.indexOf(o);u.children.splice(h,1)}this.setMeshAABBDirty(u)}}},{key:"detachChildren",value:function(o){var s=this.mesh.getComponentByEntity(o);s&&(s.children=[]);for(var l=0;l<this.hierarchy.getCount();){var u;if(((u=this.hierarchy.getComponent(l))===null||u===void 0?void 0:u.parentID)===o){var h=this.hierarchy.getEntity(l);this.detach(h)}else++l}}},{key:"setMeshAABBDirty",value:function(o){o&&(o.aabbDirty=!0)}}]),n}(),wx),li=(0,On.Z)(Eg.prototype,"hierarchy",[bx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rd=(0,On.Z)(Eg.prototype,"transform",[xx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iy=(0,On.Z)(Eg.prototype,"mesh",[Cx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eg))||kd),Xo=P(49685);function ps(){var n=new Xo.WT(4);return Xo.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function cE(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function Oa(n,r,o){o=o*.5;var s=Math.sin(o);return n[0]=s*r[0],n[1]=s*r[1],n[2]=s*r[2],n[3]=Math.cos(o),n}function tA(n,r){var o=Math.acos(r[3])*2,s=Math.sin(o/2);return s>glMatrix.EPSILON?(n[0]=r[0]/s,n[1]=r[1]/s,n[2]=r[2]/s):(n[0]=1,n[1]=0,n[2]=0),o}function oy(n,r){var o=Pu(n,r);return Math.acos(2*o*o-1)}function oa(n,r,o){var s=r[0],l=r[1],u=r[2],h=r[3],p=o[0],g=o[1],v=o[2],b=o[3];return n[0]=s*b+h*p+l*v-u*g,n[1]=l*b+h*g+u*p-s*v,n[2]=u*b+h*v+s*g-l*p,n[3]=h*b-s*p-l*g-u*v,n}function r0(n,r,o){o*=.5;var s=r[0],l=r[1],u=r[2],h=r[3],p=Math.sin(o),g=Math.cos(o);return n[0]=s*g+h*p,n[1]=l*g+u*p,n[2]=u*g-l*p,n[3]=h*g-s*p,n}function sy(n,r,o){o*=.5;var s=r[0],l=r[1],u=r[2],h=r[3],p=Math.sin(o),g=Math.cos(o);return n[0]=s*g-u*p,n[1]=l*g+h*p,n[2]=u*g+s*p,n[3]=h*g-l*p,n}function nA(n,r,o){o*=.5;var s=r[0],l=r[1],u=r[2],h=r[3],p=Math.sin(o),g=Math.cos(o);return n[0]=s*g+l*p,n[1]=l*g-s*p,n[2]=u*g+h*p,n[3]=h*g-u*p,n}function rA(n,r){var o=r[0],s=r[1],l=r[2];return n[0]=o,n[1]=s,n[2]=l,n[3]=Math.sqrt(Math.abs(1-o*o-s*s-l*l)),n}function uE(n,r){var o=r[0],s=r[1],l=r[2],u=r[3],h=Math.sqrt(o*o+s*s+l*l),p=Math.exp(u),g=h>0?p*Math.sin(h)/h:0;return n[0]=o*g,n[1]=s*g,n[2]=l*g,n[3]=p*Math.cos(h),n}function i0(n,r){var o=r[0],s=r[1],l=r[2],u=r[3],h=Math.sqrt(o*o+s*s+l*l),p=h>0?Math.atan2(h,u)/h:0;return n[0]=o*p,n[1]=s*p,n[2]=l*p,n[3]=.5*Math.log(o*o+s*s+l*l+u*u),n}function iA(n,r,o){return i0(n,r),hE(n,n,o),uE(n,n),n}function o0(n,r,o,s){var l=r[0],u=r[1],h=r[2],p=r[3],g=o[0],v=o[1],b=o[2],w=o[3],A,O,D,_,I;return O=l*g+u*v+h*b+p*w,O<0&&(O=-O,g=-g,v=-v,b=-b,w=-w),1-O>Xo.Ib?(A=Math.acos(O),D=Math.sin(A),_=Math.sin((1-s)*A)/D,I=Math.sin(s*A)/D):(_=1-s,I=s),n[0]=_*l+I*g,n[1]=_*u+I*v,n[2]=_*h+I*b,n[3]=_*p+I*w,n}function Sg(n){var r=glMatrix.RANDOM(),o=glMatrix.RANDOM(),s=glMatrix.RANDOM(),l=Math.sqrt(1-r),u=Math.sqrt(r);return n[0]=l*Math.sin(2*Math.PI*o),n[1]=l*Math.cos(2*Math.PI*o),n[2]=u*Math.sin(2*Math.PI*s),n[3]=u*Math.cos(2*Math.PI*s),n}function ay(n,r){var o=r[0],s=r[1],l=r[2],u=r[3],h=o*o+s*s+l*l+u*u,p=h?1/h:0;return n[0]=-o*p,n[1]=-s*p,n[2]=-l*p,n[3]=u*p,n}function sp(n,r){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=r[3],n}function Gh(n,r){var o=r[0]+r[4]+r[8],s;if(o>0)s=Math.sqrt(o+1),n[3]=.5*s,s=.5/s,n[0]=(r[5]-r[7])*s,n[1]=(r[6]-r[2])*s,n[2]=(r[1]-r[3])*s;else{var l=0;r[4]>r[0]&&(l=1),r[8]>r[l*3+l]&&(l=2);var u=(l+1)%3,h=(l+2)%3;s=Math.sqrt(r[l*3+l]-r[u*3+u]-r[h*3+h]+1),n[l]=.5*s,s=.5/s,n[3]=(r[u*3+h]-r[h*3+u])*s,n[u]=(r[u*3+l]+r[l*3+u])*s,n[h]=(r[h*3+l]+r[l*3+h])*s}return n}function ly(n,r,o,s){var l=.5*Math.PI/180;r*=l,o*=l,s*=l;var u=Math.sin(r),h=Math.cos(r),p=Math.sin(o),g=Math.cos(o),v=Math.sin(s),b=Math.cos(s);return n[0]=u*g*b-h*p*v,n[1]=h*p*b+u*g*v,n[2]=h*g*v-u*p*b,n[3]=h*g*b+u*p*v,n}function oA(n){return"quat("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}var sA=yo.d9,cy=yo.al,Ag=yo.JG,aA=yo.t8,lA=yo.IH,dE=oa,hE=yo.bA,Pu=yo.AK,uy=yo.t7,fE=yo.kE,nO=null,cA=yo.we,uA=null,Tg=yo.Fv,dA=yo.I6,ap=yo.fS,hA=function(){var n=gt.create(),r=gt.fromValues(1,0,0),o=gt.fromValues(0,1,0);return function(s,l,u){var h=gt.dot(l,u);return h<-.999999?(gt.cross(n,r,l),gt.len(n)<1e-6&&gt.cross(n,o,l),gt.normalize(n,n),Oa(s,n,Math.PI),s):h>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(gt.cross(n,l,u),s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=1+h,Tg(s,s))}}(),fA=function(){var n=ps(),r=ps();return function(o,s,l,u,h,p){return o0(n,s,h,p),o0(r,l,u,p),o0(o,n,r,2*p*(1-p)),o}}(),pE=function(){var n=kh.Ue();return function(r,o,s,l){return n[0]=s[0],n[3]=s[1],n[6]=s[2],n[1]=l[0],n[4]=l[1],n[7]=l[2],n[2]=-o[0],n[5]=-o[1],n[8]=-o[2],Tg(r,Gh(r,n))}}();function gE(n){var r=pA();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function pA(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Ex=function(n){(0,Rs.Z)(o,n);var r=gE(o);function o(s){var l;return(0,Wn.Z)(this,o),l=r.call(this,s),l.dirtyFlag=void 0,l.localDirtyFlag=void 0,l.parent=null,l.localPosition=gt.fromValues(0,0,0),l.localRotation=cy(0,0,0,1),l.localScale=gt.fromValues(1,1,1),l.localTransform=cr.create(),l.position=gt.fromValues(0,0,0),l.rotation=cy(0,0,0,1),l.scaling=gt.fromValues(1,1,1),l.worldTransform=cr.create(),l.matrixTransform=function(){var u=cr.create();return function(h){cr.multiply(u,l.getLocalTransform(),h),cr.getScaling(l.localScale,u),cr.getTranslation(l.localPosition,u),cr.getRotation(l.localRotation,u)}}(),l.rotateRollPitchYaw=function(){var u=ps(),h=ps(),p=ps();return function(g,v,b){l.setDirty(),ly(u,g,0,0),ly(h,0,v,0),ly(p,0,0,b),oa(l.localRotation,u,l.localRotation),oa(l.localRotation,l.localRotation,h),oa(l.localRotation,p,l.localRotation),Tg(l.localRotation,l.localRotation)}}(),l.lerp=function(){var u=gt.create(),h=ps(),p=gt.create(),g=gt.create(),v=ps(),b=gt.create();return function(w,A,O){l.setDirty(),cr.getScaling(u,w.worldTransform),cr.getTranslation(p,w.worldTransform),cr.getRotation(h,w.worldTransform),cr.getScaling(g,A.worldTransform),cr.getTranslation(b,A.worldTransform),cr.getRotation(v,A.worldTransform),gt.lerp(l.localScale,u,g,O),o0(l.localRotation,h,v,O),gt.lerp(l.localPosition,p,b,O)}}(),l.translate=function(){var u=gt.create();return function(h){return gt.add(u,l.getPosition(),h),l.setPosition(u),l.setDirty(!0),(0,vo.Z)(l)}}(),l.translateLocal=function(){return function(u){return gt.transformQuat(u,u,l.localRotation),gt.add(l.localPosition,l.localPosition,u),l.setLocalDirty(!0),(0,vo.Z)(l)}}(),l.setPosition=function(){var u=cr.create();return function(h){return l.position=h,l.setLocalDirty(!0),l.parent===null?gt.copy(l.localPosition,h):(cr.copy(u,l.parent.worldTransform),cr.invert(u,u),gt.transformMat4(l.localPosition,h,u)),(0,vo.Z)(l)}}(),l.rotate=function(){var u=ps();return function(h){if(l.parent===null)oa(l.localRotation,l.localRotation,h),Tg(l.localRotation,l.localRotation);else{var p=l.getRotation(),g=l.parent.getRotation();Ag(u,g),ay(u,u),oa(u,u,h),oa(l.localRotation,h,p),Tg(l.localRotation,l.localRotation)}return l.setLocalDirty(),(0,vo.Z)(l)}}(),l.rotateLocal=function(){return function(u){return oa(l.localRotation,l.localRotation,u),Tg(l.localRotation,l.localRotation),l.setLocalDirty(!0),(0,vo.Z)(l)}}(),l.setRotation=function(){var u=ps();return function(h){return l.parent===null?Ag(l.localRotation,h):(Ag(u,l.parent.getRotation()),ay(u,u),Ag(l.localRotation,u),dE(l.localRotation,l.localRotation,h)),l.setLocalDirty(!0),(0,vo.Z)(l)}}(),l}return(0,or.Z)(o,[{key:"setLocalPosition",value:function(l){gt.copy(this.localPosition,l),this.setLocalDirty(!0)}},{key:"setLocalScale",value:function(l){gt.copy(this.localScale,l),this.setLocalDirty(!0)}},{key:"setLocalRotation",value:function(l){return Ag(this.localRotation,l),this.setLocalDirty(!0),this}},{key:"isDirty",value:function(){return this.dirtyFlag}},{key:"setDirty",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;l?this.dirtyFlag|=o.DIRTY:this.dirtyFlag&=~o.DIRTY}},{key:"isLocalDirty",value:function(){return this.localDirtyFlag}},{key:"setLocalDirty",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;l?(this.localDirtyFlag|=o.DIRTY,this.setDirty(!0)):this.localDirtyFlag&=~o.DIRTY}},{key:"updateTransform",value:function(){this.isLocalDirty()&&this.getLocalTransform(),this.isDirty()&&this.parent===null&&(cr.copy(this.worldTransform,this.getLocalTransform()),this.setDirty(!1))}},{key:"updateTransformWithParent",value:function(l){cr.multiply(this.worldTransform,l.worldTransform,this.getLocalTransform())}},{key:"applyTransform",value:function(){this.setDirty(),cr.getScaling(this.localScale,this.worldTransform),cr.getTranslation(this.localPosition,this.worldTransform),cr.getRotation(this.localRotation,this.worldTransform)}},{key:"clearTransform",value:function(){this.setDirty(),this.localPosition=gt.fromValues(0,0,0),this.localRotation=cy(0,0,0,1),this.localScale=gt.fromValues(1,1,1)}},{key:"scaleLocal",value:function(l){return this.setLocalDirty(),gt.multiply(this.localScale,this.localScale,l),this}},{key:"getLocalPosition",value:function(){return this.localPosition}},{key:"getLocalRotation",value:function(){return this.localRotation}},{key:"getLocalScale",value:function(){return this.localScale}},{key:"getLocalTransform",value:function(){return this.localDirtyFlag&&(cr.fromRotationTranslationScale(this.localTransform,this.localRotation,this.localPosition,this.localScale),this.setLocalDirty(!1)),this.localTransform}},{key:"getWorldTransform",value:function(){return!this.isLocalDirty()&&!this.isDirty()?this.worldTransform:(this.parent&&this.parent.getWorldTransform(),this.updateTransform(),this.worldTransform)}},{key:"getPosition",value:function(){return cr.getTranslation(this.position,this.worldTransform),this.position}},{key:"getRotation",value:function(){return cr.getRotation(this.rotation,this.worldTransform),this.rotation}},{key:"getScale",value:function(){return cr.getScaling(this.scaling,this.worldTransform),this.scaling}}]),o}(Td);Ex.DIRTY=1<<0;var Bh=P(84879),Mg,Pg,Sx,s0,Ax,Tx,mE=(Mg=(0,U.b2)(),Pg=(0,U.f3)(Pt.RenderEngine),Mg(Sx=(s0=(Tx=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"engine",Ax,this),this.resourcePool={}}return(0,or.Z)(n,[{key:"getOrCreateResource",value:function(o){if(!this.resourcePool[o.name]){var s=o.descriptor,l=s.width,u=s.height,h=s.usage;this.resourcePool[o.name]=this.engine.createFramebuffer({color:this.engine.createTexture2D({width:l,height:u,wrapS:tt.CLAMP_TO_EDGE,wrapT:tt.CLAMP_TO_EDGE,usage:h})})}return this.resourcePool[o.name]}},{key:"clean",value:function(){this.resourcePool={}}}]),n}(),Tx),Ax=(0,On.Z)(s0.prototype,"engine",[Pg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s0))||Sx);function vE(n){var r=zh();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function zh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var yE=function(n){(0,Rs.Z)(o,n);var r=vE(o);function o(s){var l;return(0,Wn.Z)(this,o),l=r.call(this,s),l.name=void 0,l.name=s.name||"",l}return o}(Td),Mx,Og,Dg,Px=(Mx=(0,U.b2)(),Mx(Og=(Dg=function(){function n(){(0,Wn.Z)(this,n),this.config=void 0}return(0,or.Z)(n,[{key:"get",value:function(){return this.config}},{key:"set",value:function(o){this.config=o}}]),n}(),Dg))||Og),dy,Ox,Dx;(function(n){n.PANSTART="PANSTART",n.PANEND="PANEND",n.PANMOVE="PANMOVE",n.PINCH="PINCH",n.KEYDOWN="KEYDOWN",n.KEYUP="KEYUP",n.HOVER="HOVER"})(Dx||(Dx={}));var _x=(dy=(0,U.b2)(),dy(Ox=function(){function n(){(0,Wn.Z)(this,n)}return(0,or.Z)(n,[{key:"listen",value:function(o){}},{key:"on",value:function(o,s){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"destroy",value:function(){}}]),n}())||Ox);function Cl(n){var r=0;switch(n){case"vec2":case"ivec2":r=2;break;case"vec3":case"ivec3":r=3;break;case"vec4":case"ivec4":case"mat2":r=4;break;case"mat3":r=9;break;case"mat4":r=16;break;default:}return r}var bE=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Ou(n){var r={};return n=n.replace(bE,function(o,s,l){var u=l.split(":"),h=u[0].trim(),p="";switch(u.length>1&&(p=u[1].trim()),s){case"bool":p=p==="true";break;case"float":case"int":p=Number(p);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":p?p=p.replace("[","").replace("]","").split(",").reduce(function(g,v){return g.push(Number(v.trim())),g},[]):p=new Array(Cl(s)).fill(0);break;default:}return r[h]=p,"uniform ".concat(s," ").concat(h,`;
`)}),{content:n,uniforms:r}}function xE(n){return n.filter(function(r,o,s){return s.indexOf(r)===o})}var hy,fy,Nx;function kx(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function lp(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?kx(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):kx(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}var Rx=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,Ix=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}`,CE=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}`,py=/precision\s+(high|low|medium)p\s+float/,wE=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Lx=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,EE=(hy=(0,U.b2)(),hy(fy=(Nx=function(){function n(){(0,Wn.Z)(this,n),this.moduleCache={},this.rawContentCache={}}return(0,or.Z)(n,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("picking",{vs:Ix,fs:Rx}),this.registerModule("sdf2d",{vs:"",fs:CE})}},{key:"registerModule",value:function(o,s){if(!this.rawContentCache[o]){var l=s.vs,u=l===void 0?"":l,h=s.fs,p=h===void 0?"":h,g=s.uniforms,v=Ou(u),b=v.content,w=v.uniforms,A=Ou(p),O=A.content,D=A.uniforms;this.rawContentCache[o]={fs:O,uniforms:lp(lp(lp({},w),D),g),vs:b}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(o){var s=this;if(this.moduleCache[o])return this.moduleCache[o];var l=this.rawContentCache[o].vs||"",u=this.rawContentCache[o].fs||"",h=this.processModule(l,[],"vs"),p=h.content,g=h.includeList,v=this.processModule(u,[],"fs"),b=v.content,w=v.includeList,A=b,O=xE(g.concat(w).concat(o)).reduce(function(D,_){return lp(lp({},D),s.rawContentCache[_].uniforms)},{});return py.test(b)||(A=wE+b),this.moduleCache[o]={fs:A.trim(),uniforms:O,vs:p.trim()},this.moduleCache[o]}},{key:"processModule",value:function(o,s,l){var u=this,h=o.replace(Lx,function(p,g){var v=g.split(" "),b=v[0].replace(/"/g,"");if(s.indexOf(b)>-1)return"";var w=u.rawContentCache[b][l];s.push(b);var A=u.processModule(w||"",s,l),O=A.content;return O});return{content:h,includeList:s}}}]),n}(),Nx))||fy),zc=new U.W2,gy=(0,Bh.Z)(zc,!1),gA=function(r){var o=gy.lazyInject(r);return function(s,l,u){o.call(this,s,l),u&&(u.initializer=function(){return s[l]})}},a0=function(r){var o=gy.lazyMultiInject(r);return function(s,l,u){o.call(this,s,l),u&&(u.initializer=function(){return s[l]})}};zc.bind(Pt.ShaderModuleService).to(EE).inSingletonScope(),zc.bind(Pt.NameComponentManager).toConstantValue(new Md(yE)),zc.bind(Pt.HierarchyComponentManager).toConstantValue(new Md(vx)),zc.bind(Pt.TransformComponentManager).toConstantValue(new Md(Ex)),zc.bind(Pt.MeshComponentManager).toConstantValue(new Md(eE)),zc.bind(Pt.CullableComponentManager).toConstantValue(new Md(Jw)),zc.bind(Pt.GeometryComponentManager).toConstantValue(new Md($w)),zc.bind(Pt.MaterialComponentManager).toConstantValue(new Md(b2));function l0(){var n=new U.W2;return n.parent=zc,n.bind(Pt.Systems).to(xo).inSingletonScope().whenTargetNamed(Pt.SceneGraphSystem),n.bind(Pt.Systems).to(Km).inSingletonScope().whenTargetNamed(Pt.FrameGraphSystem),n.bind(Pt.Systems).to(iE).inSingletonScope().whenTargetNamed(Pt.MeshSystem),n.bind(Pt.Systems).to(Ww).inSingletonScope().whenTargetNamed(Pt.GeometrySystem),n.bind(Pt.Systems).to(Yw).inSingletonScope().whenTargetNamed(Pt.MaterialSystem),n.bind(Pt.Systems).to(ry).inSingletonScope().whenTargetNamed(Pt.RendererSystem),n.bind(Pt.ResourcePool).to(mE).inSingletonScope(),n.bind(Pt.ConfigService).to(Px).inSingletonScope(),n.bind(Pt.InteractorService).to(_x).inSingletonScope(),n.bind(Pt.RenderPass).to(rp).inSingletonScope().whenTargetNamed(rp.IDENTIFIER),n.bind(Pt.RenderPass).to(Dd).inSingletonScope().whenTargetNamed(Dd.IDENTIFIER),n.bind(Pt.RenderPass).to(qv).inSingletonScope().whenTargetNamed(qv.IDENTIFIER),n.bind(Pt.RenderPassFactory).toFactory(function(r){return function(o){return r.container.getNamed(Pt.RenderPass,o)}}),n}function Uh(n){for(var r=new e0,o=gt.fromValues(n[0],n[1],n[2]),s=gt.fromValues(n[0],n[1],n[2]),l=3;l<n.length;){var u=n[l++],h=n[l++],p=n[l++];u<o[0]&&(o[0]=u),h<o[1]&&(o[1]=h),p<o[2]&&(o[2]=p),u>s[0]&&(s[0]=u),h>s[1]&&(s[1]=h),p>s[2]&&(s[2]=p)}return r.setMinMax(o,s),r}var sa=typeof navigator<"u"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),SE=gt.create(),AE=null,mA=gt.create(),vA=gt.create(),yA=gt.create(),TE=gt.create(),bA=gt.create(),xA=null,CA=P(59518),_g=P(26199),wA=P(14156),Id=P(71468),EA=P(48871),SA=P(9871),Fx;(function(n){n.Normal="normal",n.PostProcessing="post-processing"})(Fx||(Fx={}));var AA=P(25612),ME=P(92777),my=P(20159),vy=P(6727),TA=P(20499),Gx=P(64851),Vh;(function(n){n.Void="Void",n.Boolean="Boolean",n.Float="Float",n.Uint32="Uint32",n.Int32="Int32",n.Vector="Vector",n.Vector2Float="vec2<f32>",n.Vector3Float="vec3<f32>",n.Vector4Float="vec4<f32>",n.Vector2Boolean="vec2<bool>",n.Vector3Boolean="vec3<bool>",n.Vector4Boolean="vec4<bool>",n.Vector2Uint="vec2<u32>",n.Vector3Uint="vec3<u32>",n.Vector4Uint="vec4<u32>",n.Vector2Int="vec2<i32>",n.Vector3Int="vec3<i32>",n.Vector4Int="vec4<i32>",n.Matrix="Matrix",n.Matrix3x3Float="mat3x3<f32>",n.Matrix4x4Float="mat4x4<i32>",n.Struct="Struct",n.FloatArray="Float[]",n.Vector4FloatArray="vec4<f32>[]"})(Vh||(Vh={}));var yy;(function(n){n.Program="Program",n.Identifier="Identifier",n.VariableDeclaration="VariableDeclaration",n.BlockStatement="BlockStatement",n.ReturnStatement="ReturnStatement",n.FunctionDeclaration="FunctionDeclaration",n.VariableDeclarator="VariableDeclarator",n.AssignmentExpression="AssignmentExpression",n.LogicalExpression="LogicalExpression",n.BinaryExpression="BinaryExpression",n.ArrayExpression="ArrayExpression",n.UnaryExpression="UnaryExpression",n.UpdateExpression="UpdateExpression",n.FunctionExpression="FunctionExpression",n.MemberExpression="MemberExpression",n.ConditionalExpression="ConditionalExpression",n.ExpressionStatement="ExpressionStatement",n.CallExpression="CallExpression",n.NumThreadStatement="NumThreadStatement",n.StorageStatement="StorageStatement",n.DoWhileStatement="DoWhileStatement",n.WhileStatement="WhileStatement",n.ForStatement="ForStatement",n.BreakStatement="BreakStatement",n.ContinueStatement="ContinueStatement",n.IfStatement="IfStatement",n.ImportedFunctionStatement="ImportedFunctionStatement"})(yy||(yy={}));var Ld;(function(n){n.Input="Input",n.Output="Output",n.Uniform="Uniform",n.Workgroup="Workgroup",n.UniformConstant="UniformConstant",n.Image="Image",n.StorageBuffer="StorageBuffer",n.Private="Private",n.Function="Function"})(Ld||(Ld={}));var cp;(function(n){n.GLSL100="GLSL100",n.GLSL450="GLSL450",n.WGSL="WGSL"})(cp||(cp={}));var PE="__DefineValuePlaceholder__";function jh(n){return typeof n=="number"}function wl(n){return n===void 0?0:n>360||n<-360?n%360:n}function Hh(n,r,o){return jh(n)?gt.fromValues(n,r,o):n.length===3?gt.clone(n):gt.fromValues(n[0],n[1],n[2])}var Du=function(){function n(r,o){(0,Wn.Z)(this,n),this.name=void 0,this.matrix=void 0,this.right=void 0,this.up=void 0,this.forward=void 0,this.position=void 0,this.focalPoint=void 0,this.distanceVector=void 0,this.distance=void 0,this.dollyingStep=void 0,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=r,this.matrix=cr.clone(o.matrix),this.right=gt.clone(o.right),this.up=gt.clone(o.up),this.forward=gt.clone(o.forward),this.position=gt.clone(o.position),this.focalPoint=gt.clone(o.focalPoint),this.distanceVector=gt.clone(o.distanceVector),this.azimuth=o.azimuth,this.elevation=o.elevation,this.roll=o.roll,this.relAzimuth=o.relAzimuth,this.relElevation=o.relElevation,this.relRoll=o.relRoll,this.dollyingStep=o.dollyingStep,this.distance=o.distance}return(0,or.Z)(n,[{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getRoll",value:function(){return this.roll}},{key:"retrieve",value:function(o){o.matrix=cr.copy(o.matrix,this.matrix),o.right=gt.copy(o.right,this.right),o.up=gt.copy(o.up,this.up),o.forward=gt.copy(o.forward,this.forward),o.position=gt.copy(o.position,this.position),o.focalPoint=gt.copy(o.focalPoint,this.focalPoint),o.distanceVector=gt.copy(o.distanceVector,this.distanceVector),o.azimuth=this.azimuth,o.elevation=this.elevation,o.roll=this.roll,o.relAzimuth=this.relAzimuth,o.relElevation=this.relElevation,o.relRoll=this.relRoll,o.dollyingStep=this.dollyingStep,o.distance=this.distance}}]),n}(),Bx,up,zx,c0,Ux,by,Xr,xi;(function(n){n.ORBITING="ORBITING",n.EXPLORING="EXPLORING",n.TRACKING="TRACKING"})(xi||(xi={}));var u0;(function(n){n.DEFAULT="DEFAULT",n.ROTATIONAL="ROTATIONAL",n.TRANSLATIONAL="TRANSLATIONAL",n.CINEMATIC="CINEMATIC"})(u0||(u0={}));var Uc;(function(n){n.ORTHOGRAPHIC="ORTHOGRAPHIC",n.PERSPECTIVE="PERSPECTIVE"})(Uc||(Uc={}));var Si=Math.PI/180,Fd=180/Math.PI,ws=(Bx=(0,U.b2)(),up=(0,U.f3)(Pt.InteractorService),Bx(zx=(c0=(Xr=by=function(){function n(){(0,Wn.Z)(this,n),this.matrix=cr.create(),this.right=gt.fromValues(1,0,0),this.up=gt.fromValues(0,1,0),this.forward=gt.fromValues(0,0,1),this.position=gt.fromValues(0,0,1),this.focalPoint=gt.fromValues(0,0,0),this.distanceVector=gt.fromValues(0,0,0),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.rotateWorld=!1,(0,tr.Z)(this,"interactor",Ux,this),this.fov=30,this.near=.1,this.far=1e4,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.zoom=1,this.perspective=cr.create(),this.view=void 0,this.following=void 0,this.type=xi.EXPLORING,this.trackingMode=u0.DEFAULT,this.projectionMode=Uc.PERSPECTIVE,this.frustum=new nE,this.landmarks=[],this.landmarkAnimationID=void 0}return(0,or.Z)(n,[{key:"clone",value:function(){var o=new n;return o.setType(this.type,void 0),o.interactor=this.interactor,o}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.perspective}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"setType",value:function(o,s){return this.type=o,this.type===xi.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===xi.TRACKING&&s!==void 0&&this.setTrackingMode(s),this}},{key:"setProjectionMode",value:function(o){return this.projectionMode=o,this}},{key:"setTrackingMode",value:function(o){if(this.type!==xi.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=o,this}},{key:"setWorldRotation",value:function(o){this.rotateWorld=o,this._getAngles()}},{key:"getViewTransform",value:function(){return cr.invert(cr.create(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"setMatrix",value:function(o){return this.matrix=o,this._update(),this}},{key:"setAspect",value:function(o){return this.setPerspective(this.near,this.far,this.fov,o),this}},{key:"setViewOffset",value:function(o,s,l,u,h,p){return this.aspect=o/s,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=o,this.view.fullHeight=s,this.view.offsetX=l,this.view.offsetY=u,this.view.width=h,this.view.height=p,this.projectionMode===Uc.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Uc.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setPerspective",value:function(o,s,l,u){return this.projectionMode=Uc.PERSPECTIVE,this.fov=l,this.near=o,this.far=s,this.aspect=u,cr.perspective(this.perspective,this.fov*Si,this.aspect,this.near,this.far),this}},{key:"setOrthographic",value:function(o,s,l,u,h,p){this.projectionMode=Uc.ORTHOGRAPHIC,this.rright=s,this.left=o,this.top=l,this.bottom=u,this.near=h,this.far=p;var g=(this.rright-this.left)/(2*this.zoom),v=(this.top-this.bottom)/(2*this.zoom),b=(this.rright+this.left)/2,w=(this.top+this.bottom)/2,A=b-g,O=b+g,D=w+v,_=w-v;if(this.view!==void 0&&this.view.enabled){var I=(this.rright-this.left)/this.view.fullWidth/this.zoom,B=(this.top-this.bottom)/this.view.fullHeight/this.zoom;A+=I*this.view.offsetX,O=A+I*this.view.width,D-=B*this.view.offsetY,_=D-B*this.view.height}return cr.ortho(this.perspective,A,O,D,_,h,p),this}},{key:"setPosition",value:function(o,s,l){return this._setPosition(o,s,l),this.setFocalPoint(this.focalPoint),this}},{key:"setFocalPoint",value:function(o,s,l){var u=gt.fromValues(0,1,0);if(this.focalPoint=Hh(o,s,l),this.trackingMode===u0.CINEMATIC){var h=gt.subtract(gt.create(),this.focalPoint,this.position);o=h[0],s=h[1],l=h[2];var p=gt.length(h),g=Math.asin(s/p)*Fd,v=90+Math.atan2(l,o)*Fd,b=cr.create();cr.rotateY(b,b,v*Si),cr.rotateX(b,b,g*Si),u=gt.transformMat4(gt.create(),[0,1,0],b)}return cr.invert(this.matrix,cr.lookAt(cr.create(),this.position,this.focalPoint,u)),this._getAxes(),this._getDistance(),this._getAngles(),this}},{key:"setDistance",value:function(o){if(!(this.distance===o||o<0)){this.distance=o,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var s=gt.create();o=this.distance;var l=this.forward,u=this.focalPoint;return s[0]=o*l[0]+u[0],s[1]=o*l[1]+u[1],s[2]=o*l[2]+u[2],this._setPosition(s),this}}},{key:"setMaxDistance",value:function(o){return this.maxDistance=o,this}},{key:"setMinDistance",value:function(o){return this.minDistance=o,this}},{key:"changeAzimuth",value:function(o){return this.setAzimuth(this.azimuth+o),this}},{key:"changeElevation",value:function(o){return this.setElevation(this.elevation+o),this}},{key:"changeRoll",value:function(o){return this.setRoll(this.roll+o),this}},{key:"setAzimuth",value:function(o){return this.azimuth=wl(o),this.computeMatrix(),this._getAxes(),this.type===xi.ORBITING||this.type===xi.EXPLORING?this._getPosition():this.type===xi.TRACKING&&this._getFocalPoint(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(o){return this.elevation=wl(o),this.computeMatrix(),this._getAxes(),this.type===xi.ORBITING||this.type===xi.EXPLORING?this._getPosition():this.type===xi.TRACKING&&this._getFocalPoint(),this}},{key:"setRoll",value:function(o){return this.roll=wl(o),this.computeMatrix(),this._getAxes(),this.type===xi.ORBITING||this.type===xi.EXPLORING?this._getPosition():this.type===xi.TRACKING&&this._getFocalPoint(),this}},{key:"rotate",value:function(o,s,l){if(this.type===xi.EXPLORING){o=wl(o),s=wl(s),l=wl(l);var u=Oa(ps(),[1,0,0],(this.rotateWorld?1:-1)*s*Si),h=Oa(ps(),[0,1,0],(this.rotateWorld?1:-1)*o*Si),p=Oa(ps(),[0,0,1],l*Si),g=oa(ps(),h,u);g=oa(ps(),g,p);var v=cr.fromQuat(cr.create(),g);cr.translate(this.matrix,this.matrix,[0,0,-this.distance]),cr.multiply(this.matrix,this.matrix,v),cr.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation+s)>90)return;this.relElevation=wl(s),this.relAzimuth=wl(o),this.relRoll=wl(l),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.computeMatrix()}return this._getAxes(),this.type===xi.ORBITING||this.type===xi.EXPLORING?this._getPosition():this.type===xi.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(o,s){var l=Hh(o,s,0),u=gt.clone(this.position);return gt.add(u,u,gt.scale(gt.create(),this.right,l[0])),gt.add(u,u,gt.scale(gt.create(),this.up,l[1])),this._setPosition(u),this}},{key:"dolly",value:function(o){var s=this.forward,l=gt.clone(this.position),u=o*this.dollyingStep,h=this.distance+o*this.dollyingStep;return u=Math.max(Math.min(h,this.maxDistance),this.minDistance)-this.distance,l[0]+=u*s[0],l[1]+=u*s[1],l[2]+=u*s[2],this._setPosition(l),this.type===xi.ORBITING||this.type===xi.EXPLORING?this._getDistance():this.type===xi.TRACKING&&gt.add(this.focalPoint,l,this.distanceVector),this}},{key:"createLandmark",value:function(o,s){var l=this.clone();l.setPosition(s.position),l.setFocalPoint(s.focalPoint),s.roll!==void 0&&l.setRoll(s.roll);var u=new Du(o,l);return this.landmarks.push(u),u}},{key:"setLandmark",value:function(o){var s=new Du(o,this);return this.landmarks.push(s),this}},{key:"gotoLandmark",value:function(o){var s=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3,u=this.landmarks.find(function(w){return w.name===o});if(u){if(l===0){u.retrieve(this);return}this.landmarkAnimationID!==void 0&&window.cancelAnimationFrame(this.landmarkAnimationID),this.interactor.disconnect();var h=u.getPosition(),p=u.getFocalPoint(),g=u.getRoll(),v,b=function w(A){v===void 0&&(v=A);var O=A-v,D=(1-Math.cos(O/l*Math.PI))/2,_=gt.create(),I=gt.create(),B=0;gt.lerp(_,s.focalPoint,p,D),gt.lerp(I,s.position,h,D),B=s.roll*(1-D)+g*D,s.setFocalPoint(_),s.setPosition(I),s.setRoll(B),s.computeMatrix();var G=gt.dist(_,p)+gt.dist(I,h);if(!(G>.01)){s.setFocalPoint(_),s.setPosition(I),s.setRoll(B),s.computeMatrix(),s.interactor.connect();return}O<l&&(s.landmarkAnimationID=window.requestAnimationFrame(w))};window.requestAnimationFrame(b)}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles()}},{key:"computeMatrix",value:function(){var o,s,l=Oa(ps(),[0,0,1],this.roll*Si);cr.identity(this.matrix),o=Oa(ps(),[1,0,0],(this.rotateWorld&&this.type!==xi.TRACKING||this.type===xi.TRACKING?1:-1)*this.elevation*Si),s=Oa(ps(),[0,1,0],(this.rotateWorld&&this.type!==xi.TRACKING||this.type===xi.TRACKING?1:-1)*this.azimuth*Si);var u=oa(ps(),s,o);u=oa(ps(),u,l);var h=cr.fromQuat(cr.create(),u);this.type===xi.ORBITING||this.type===xi.EXPLORING?(cr.translate(this.matrix,this.matrix,this.focalPoint),cr.multiply(this.matrix,this.matrix,h),cr.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===xi.TRACKING&&(cr.translate(this.matrix,this.matrix,this.position),cr.multiply(this.matrix,this.matrix,h))}},{key:"_setPosition",value:function(o,s,l){this.position=Hh(o,s,l);var u=this.matrix;u[12]=this.position[0],u[13]=this.position[1],u[14]=this.position[2],u[15]=1}},{key:"_getAxes",value:function(){gt.copy(this.right,Hh(yo.fF(yo.Ue(),[1,0,0,0],this.matrix))),gt.copy(this.up,Hh(yo.fF(yo.Ue(),[0,1,0,0],this.matrix))),gt.copy(this.forward,Hh(yo.fF(yo.Ue(),[0,0,1,0],this.matrix))),gt.normalize(this.right,this.right),gt.normalize(this.up,this.up),gt.normalize(this.forward,this.forward)}},{key:"_getAngles",value:function(){var o=this.distanceVector[0],s=this.distanceVector[1],l=this.distanceVector[2],u=gt.length(this.distanceVector);if(u===0){this.elevation=0,this.azimuth=0;return}this.type===xi.TRACKING?(this.elevation=Math.asin(s/u)*Fd,this.azimuth=Math.atan2(-o,-l)*Fd):this.rotateWorld?(this.elevation=Math.asin(s/u)*Fd,this.azimuth=Math.atan2(-o,-l)*Fd):(this.elevation=-Math.asin(s/u)*Fd,this.azimuth=-Math.atan2(-o,-l)*Fd)}},{key:"_getPosition",value:function(){gt.copy(this.position,Hh(yo.fF(yo.Ue(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){gt.transformMat3(this.distanceVector,[0,0,-this.distance],kh.xO(kh.Ue(),this.matrix)),gt.add(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=gt.subtract(gt.create(),this.focalPoint,this.position),this.distance=gt.length(this.distanceVector),this.dollyingStep=this.distance/100}}]),n}(),by.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},Xr),Ux=(0,On.Z)(c0.prototype,"interactor",[up],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c0))||zx),Vx,jx,d0,$h,nc,h0,OE,Wh=(Vx=(0,U.b2)(),jx=(0,U.f3)(Pt.GeometryComponentManager),Vx(d0=($h=(OE=h0=function(){function n(){(0,Wn.Z)(this,n),this.config=void 0,(0,tr.Z)(this,"geometry",nc,this),this.entity=void 0,this.component=void 0}return(0,or.Z)(n,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(o){this.config=o}},{key:"setEntity",value:function(o){this.entity=o,this.component=this.geometry.create(o),this.component.entity=o,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),n}(),h0.BOX="box",h0.SPHERE="sphere",h0.PLANE="plane",h0.MERGED="merged",OE),nc=(0,On.Z)($h.prototype,"geometry",[jx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h))||d0),vn=P(49469);function DE(){if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}var MA={}.toString,_E=function(r,o){return MA.call(r)==="[object "+o+"]"},Hx=_E,PA=function(n){return Array.isArray?Array.isArray(n):Hx(n,"Array")},OA=9007199254740991,f0="[object Arguments]",Qi="[object Array]",NE="[object Boolean]",_u="[object Date]",aa="[object Error]",$x="[object Function]",Wx="[object Map]",Zx="[object Number]",$s="[object Object]",Vc="[object RegExp]",p0="[object Set]",g0="[object String]",DA="[object WeakMap]",kE="[object ArrayBuffer]",Nu="[object DataView]",_A="[object Float32Array]",NA="[object Float64Array]",kA="[object Int8Array]",xy="[object Int16Array]",RA="[object Int32Array]",IA="[object Uint8Array]",RE="[object Uint8ClampedArray]",dp="[object Uint16Array]",LA="[object Uint32Array]",Do={};Do[_A]=Do[NA]=Do[kA]=Do[xy]=Do[RA]=Do[IA]=Do[RE]=Do[dp]=Do[LA]=!0,Do[f0]=Do[Qi]=Do[kE]=Do[NE]=Do[Nu]=Do[_u]=Do[aa]=Do[$x]=Do[Wx]=Do[Zx]=Do[$s]=Do[Vc]=Do[p0]=Do[g0]=Do[DA]=!1;function FA(n){return function(r){return n(r)}}var GA=Object.prototype,IE=GA.toString;function BA(n){return UA(n)&&zA(n.length)&&!!Do[IE.call(n)]}function zA(n){return typeof n=="number"&&n>-1&&n%1===0&&n<=OA}function UA(n){return!!n&&(0,Pd.Z)(n)==="object"}var LE=BA,FE,m0,GE,BE,Ya,Xx,hp,Di;function Yx(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function El(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?Yx(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):Yx(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}var Ka=(FE=(0,U.b2)(),m0=(0,U.f3)(Pt.RenderEngine),GE=(0,U.f3)(Pt.ConfigService),FE(BE=(Ya=(Di=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"engine",Xx,this),(0,tr.Z)(this,"configService",hp,this),this.entity=vl(),this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return(0,or.Z)(n,[{key:"init",value:function(){var o=this.configService.get(),s=o.canvas,l=o.engineOptions;this.initPromise=this.engine.init(El({canvas:s||DE(),swapChainFormat:vn.EV.BGRA8Unorm,antialiasing:!1},l))}},{key:"setBundle",value:function(o){this.compiledBundle=JSON.parse(JSON.stringify(o))}},{key:"setDispatch",value:function(o){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=o),this}},{key:"setMaxIteration",value:function(o){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=o),this}},{key:"setBinding",value:function(o,s){var l=this;if(typeof o=="string"){var u=jh(s)||LE(s)||PA(s);if(this.compiledBundle&&this.compiledBundle.context){var h=this.compiledBundle.context.defines.find(function(g){return g.name===o});if(h)return h.value=s,this;var p=this.compiledBundle.context.uniforms.find(function(g){return g.name===o});p&&(u?(p.data=s,p.isReferer=!1,p.storageClass===Ld.Uniform?this.model&&this.model.updateUniform(o,s):this.model&&this.model.updateBuffer(o,s)):(p.isReferer=!0,p.data=s))}}else Object.keys(o).forEach(function(g){l.setBinding(g,o[g])});return this}},{key:"execute",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l=this,u,h,p=arguments;return kn().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(u=p.length>0&&p[0]!==void 0?p[0]:1,!this.dirty){v.next=6;break}return this.compiledBundle.context&&(u>1?this.compiledBundle.context.maxIteration=u:this.compiledBundle.context.maxIteration++),v.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(b){var w=b.isReferer;return w}).forEach(function(b){var w=b.data,A=b.name;l.model.confirmInput(w.model,A)}),h=0;h<u;h++)this.model.run();return this.engine.endFrame(),v.abrupt("return",this);case 12:case"end":return v.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"getOutput",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){return kn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.model.readData());case 1:case"end":return u.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"compile",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l,u,h;return kn().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.initPromise;case 2:return l=El({},this.compiledBundle.context),u=this.engine.supportWebGPU?this.engine.useWGSL?cp.WGSL:cp.GLSL450:cp.GLSL100,h=this.compiledBundle.shaders[u],l.defines.filter(function(v){return v.runtime}).forEach(function(v){var b="".concat(PE).concat(v.name);h=h.replace(b,"".concat(v.value))}),l.shader=h,l.uniforms.forEach(function(v){if(!v.data&&v.storageClass===Ld.StorageBuffer){var b=1;v.type===Vh.FloatArray?b=1:v.type===Vh.Vector4FloatArray&&(b=4),v.data=new Float32Array(l.output.length*b).fill(0)}}),this.compiledBundle.context=l,g.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=g.sent;case 12:case"end":return g.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()}]),n}(),Di),Xx=(0,On.Z)(Ya.prototype,"engine",[m0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hp=(0,On.Z)(Ya.prototype,"configService",[GE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ya))||BE),Kx,qx,ku,Cy,Gd,_i,Jx,Qx=(Kx=(0,U.b2)(),qx=(0,U.f3)(Pt.MaterialComponentManager),Kx(ku=(Cy=(Jx=_i=function(){function n(){(0,Wn.Z)(this,n),this.config=void 0,(0,tr.Z)(this,"material",Gd,this),this.entity=void 0,this.component=void 0}return(0,or.Z)(n,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(o){this.config=o}},{key:"setEntity",value:function(o,s){this.entity=o,this.component=this.material.create(o),this.component.entity=o,this.component.type=s,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),n}(),_i.BASIC="basic",Jx),Gd=(0,On.Z)(Cy.prototype,"material",[qx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cy))||ku),fp,wy,Bd,eC,pp,Ey,Ng,gp,tC,Sy,nC,bi,v0,kg,zd=(fp=(0,U.b2)(),wy=(0,U.f3)(Pt.MeshComponentManager),Bd=(0,U.f3)(Pt.CullableComponentManager),eC=(0,U.f3)(Pt.TransformComponentManager),pp=(0,U.f3)(Pt.Systems),Ey=(0,U.t6)(Pt.SceneGraphSystem),fp(Ng=(gp=(kg=v0=function(){function n(){(0,Wn.Z)(this,n),this.attributes={},this.config=void 0,(0,tr.Z)(this,"mesh",tC,this),(0,tr.Z)(this,"cullable",Sy,this),(0,tr.Z)(this,"transform",nC,this),(0,tr.Z)(this,"sceneGraphSystem",bi,this),this.meshComponent=void 0,this.transformComponent=void 0,this.entity=void 0}return(0,or.Z)(n,[{key:"getEntity",value:function(){return this.entity}},{key:"getTransformComponent",value:function(){return this.transformComponent}},{key:"getMeshComponent",value:function(){return this.meshComponent}},{key:"setConfig",value:function(o){this.config=o}},{key:"setEntity",value:function(o){this.entity=o,this.cullable.create(o),this.meshComponent=this.mesh.create(o),this.transformComponent=this.transform.create(o),this.onEntityCreated()}},{key:"setMaterial",value:function(o){return this.meshComponent.material=o,this}},{key:"setGeometry",value:function(o){return this.meshComponent.geometry=o,this}},{key:"setAttributes",value:function(o){var s=this;Object.keys(o).forEach(function(l){o[l]!==void 0&&o[l]!==s.attributes[l]&&(s.onAttributeChanged({name:l,data:o[l]}),s.attributes[l]=o[l])})}},{key:"setVisible",value:function(o){var s=this;return this.meshComponent.visible=o,this.meshComponent.children.forEach(function(l){var u=s.mesh.getComponentByEntity(l);u&&(u.visible=o)}),this}},{key:"isVisible",value:function(){return this.meshComponent.visible}},{key:"attach",value:function(o){return this.sceneGraphSystem.attach(this.entity,o.entity),this}},{key:"detach",value:function(){return this.sceneGraphSystem.detach(this.entity),this}},{key:"detachChildren",value:function(){return this.sceneGraphSystem.detachChildren(this.entity),this}},{key:"onEntityCreated",value:function(){}},{key:"onAttributeChanged",value:function(o){var s=o.name,l=o.data;this.meshComponent&&this.meshComponent.material&&this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(s),l)}},{key:"convertAttributeName2UniformName",value:function(o){return o}}]),n}(),v0.POINT="point",v0.LINE="line",v0.GRID="grid",kg),tC=(0,On.Z)(gp.prototype,"mesh",[wy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sy=(0,On.Z)(gp.prototype,"cullable",[Bd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nC=(0,On.Z)(gp.prototype,"transform",[eC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bi=(0,On.Z)(gp.prototype,"sceneGraphSystem",[pp,Ey],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gp))||Ng),zE=P(81550),mp=P.n(zE),Sl=function(){function n(r,o){(0,Wn.Z)(this,n),this.attribute=void 0,this.buffer=void 0;var s=o.buffer,l=o.offset,u=o.stride,h=o.normalized,p=o.size,g=o.divisor;this.buffer=s,this.attribute={buffer:s.get(),offset:l||0,stride:u||0,normalized:h||!1,divisor:g||0},p&&(this.attribute.size=p)}return(0,or.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(o){this.buffer.subData(o)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),Wi,Rg,rc,co,vp,uo,Ig,Da,ic,Ud,Ws,jc,Al,Lg,UE=(Wi={},(0,ht.Z)(Wi,tt.POINTS,"points"),(0,ht.Z)(Wi,tt.LINES,"lines"),(0,ht.Z)(Wi,tt.LINE_LOOP,"line loop"),(0,ht.Z)(Wi,tt.LINE_STRIP,"line strip"),(0,ht.Z)(Wi,tt.TRIANGLES,"triangles"),(0,ht.Z)(Wi,tt.TRIANGLE_FAN,"triangle fan"),(0,ht.Z)(Wi,tt.TRIANGLE_STRIP,"triangle strip"),Wi),y0=(Rg={},(0,ht.Z)(Rg,tt.STATIC_DRAW,"static"),(0,ht.Z)(Rg,tt.DYNAMIC_DRAW,"dynamic"),(0,ht.Z)(Rg,tt.STREAM_DRAW,"stream"),Rg),Hc=(rc={},(0,ht.Z)(rc,tt.BYTE,"int8"),(0,ht.Z)(rc,tt.UNSIGNED_INT,"int16"),(0,ht.Z)(rc,tt.INT,"int32"),(0,ht.Z)(rc,tt.UNSIGNED_BYTE,"uint8"),(0,ht.Z)(rc,tt.UNSIGNED_SHORT,"uint16"),(0,ht.Z)(rc,tt.UNSIGNED_INT,"uint32"),(0,ht.Z)(rc,tt.FLOAT,"float"),rc),VE=(co={},(0,ht.Z)(co,tt.ALPHA,"alpha"),(0,ht.Z)(co,tt.LUMINANCE,"luminance"),(0,ht.Z)(co,tt.LUMINANCE_ALPHA,"luminance alpha"),(0,ht.Z)(co,tt.RGB,"rgb"),(0,ht.Z)(co,tt.RGBA,"rgba"),(0,ht.Z)(co,tt.RGBA4,"rgba4"),(0,ht.Z)(co,tt.RGB5_A1,"rgb5 a1"),(0,ht.Z)(co,tt.RGB565,"rgb565"),(0,ht.Z)(co,tt.DEPTH_COMPONENT,"depth"),(0,ht.Z)(co,tt.DEPTH_STENCIL,"depth stencil"),co),Ay=(vp={},(0,ht.Z)(vp,tt.DONT_CARE,"dont care"),(0,ht.Z)(vp,tt.NICEST,"nice"),(0,ht.Z)(vp,tt.FASTEST,"fast"),vp),rC=(uo={},(0,ht.Z)(uo,tt.NEAREST,"nearest"),(0,ht.Z)(uo,tt.LINEAR,"linear"),(0,ht.Z)(uo,tt.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,ht.Z)(uo,tt.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,ht.Z)(uo,tt.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,ht.Z)(uo,tt.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),uo),iC=(Ig={},(0,ht.Z)(Ig,tt.REPEAT,"repeat"),(0,ht.Z)(Ig,tt.CLAMP_TO_EDGE,"clamp"),(0,ht.Z)(Ig,tt.MIRRORED_REPEAT,"mirror"),Ig),Ty=(Da={},(0,ht.Z)(Da,tt.NONE,"none"),(0,ht.Z)(Da,tt.BROWSER_DEFAULT_WEBGL,"browser"),Da),jE=(ic={},(0,ht.Z)(ic,tt.NEVER,"never"),(0,ht.Z)(ic,tt.ALWAYS,"always"),(0,ht.Z)(ic,tt.LESS,"less"),(0,ht.Z)(ic,tt.LEQUAL,"lequal"),(0,ht.Z)(ic,tt.GREATER,"greater"),(0,ht.Z)(ic,tt.GEQUAL,"gequal"),(0,ht.Z)(ic,tt.EQUAL,"equal"),(0,ht.Z)(ic,tt.NOTEQUAL,"notequal"),ic),Fg=(Ud={},(0,ht.Z)(Ud,tt.FUNC_ADD,"add"),(0,ht.Z)(Ud,tt.MIN_EXT,"min"),(0,ht.Z)(Ud,tt.MAX_EXT,"max"),(0,ht.Z)(Ud,tt.FUNC_SUBTRACT,"subtract"),(0,ht.Z)(Ud,tt.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ud),b0=(Ws={},(0,ht.Z)(Ws,tt.ZERO,"zero"),(0,ht.Z)(Ws,tt.ONE,"one"),(0,ht.Z)(Ws,tt.SRC_COLOR,"src color"),(0,ht.Z)(Ws,tt.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,ht.Z)(Ws,tt.SRC_ALPHA,"src alpha"),(0,ht.Z)(Ws,tt.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,ht.Z)(Ws,tt.DST_COLOR,"dst color"),(0,ht.Z)(Ws,tt.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,ht.Z)(Ws,tt.DST_ALPHA,"dst alpha"),(0,ht.Z)(Ws,tt.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,ht.Z)(Ws,tt.CONSTANT_COLOR,"constant color"),(0,ht.Z)(Ws,tt.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,ht.Z)(Ws,tt.CONSTANT_ALPHA,"constant alpha"),(0,ht.Z)(Ws,tt.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,ht.Z)(Ws,tt.SRC_ALPHA_SATURATE,"src alpha saturate"),Ws),x0=(jc={},(0,ht.Z)(jc,tt.NEVER,"never"),(0,ht.Z)(jc,tt.ALWAYS,"always"),(0,ht.Z)(jc,tt.LESS,"less"),(0,ht.Z)(jc,tt.LEQUAL,"lequal"),(0,ht.Z)(jc,tt.GREATER,"greater"),(0,ht.Z)(jc,tt.GEQUAL,"gequal"),(0,ht.Z)(jc,tt.EQUAL,"equal"),(0,ht.Z)(jc,tt.NOTEQUAL,"notequal"),jc),yp=(Al={},(0,ht.Z)(Al,tt.ZERO,"zero"),(0,ht.Z)(Al,tt.KEEP,"keep"),(0,ht.Z)(Al,tt.REPLACE,"replace"),(0,ht.Z)(Al,tt.INVERT,"invert"),(0,ht.Z)(Al,tt.INCR,"increment"),(0,ht.Z)(Al,tt.DECR,"decrement"),(0,ht.Z)(Al,tt.INCR_WRAP,"increment wrap"),(0,ht.Z)(Al,tt.DECR_WRAP,"decrement wrap"),Al),My=(Lg={},(0,ht.Z)(Lg,tt.FRONT,"front"),(0,ht.Z)(Lg,tt.BACK,"back"),Lg),oC=function(){function n(r,o){(0,Wn.Z)(this,n),this.buffer=void 0;var s=o.data,l=o.usage,u=o.type;this.buffer=r.buffer({data:s,usage:y0[l||tt.STATIC_DRAW],type:Hc[u||tt.UNSIGNED_BYTE]})}return(0,or.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(o){var s=o.data,l=o.offset;this.buffer.subdata(s,l)}}]),n}(),Yo=P(93433),Zh=9007199254740991,zo="[object Arguments]",HE="[object Array]",Py="[object Boolean]",$E="[object Date]",WE="[object Error]",ZE="[object Function]",Xh="[object Map]",XE="[object Number]",Oy="[object Object]",YE="[object RegExp]",Yh="[object Set]",sC="[object String]",KE="[object WeakMap]",qE="[object ArrayBuffer]",aC="[object DataView]",JE="[object Float32Array]",lC="[object Float64Array]",ci="[object Int8Array]",QE="[object Int16Array]",qr="[object Int32Array]",Jr="[object Uint8Array]",oc="[object Uint8ClampedArray]",Ci="[object Uint16Array]",eS="[object Uint32Array]",ji={};ji[JE]=ji[lC]=ji[ci]=ji[QE]=ji[qr]=ji[Jr]=ji[oc]=ji[Ci]=ji[eS]=!0,ji[zo]=ji[HE]=ji[qE]=ji[Py]=ji[aC]=ji[$E]=ji[WE]=ji[ZE]=ji[Xh]=ji[XE]=ji[Oy]=ji[YE]=ji[Yh]=ji[sC]=ji[KE]=!1;function VA(n){return function(r){return n(r)}}var tS=Object.prototype,Gg=tS.toString;function C0(n){return Ru(n)&&nS(n.length)&&!!ji[Gg.call(n)]}function nS(n){return typeof n=="number"&&n>-1&&n%1===0&&n<=Zh}function Ru(n){return!!n&&(0,Pd.Z)(n)==="object"}var Dy=C0;function sc(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function Bg(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?sc(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):sc(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}var _a=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,bp=0,w0=!1,rS=function(){function n(r,o){var s=this;(0,Wn.Z)(this,n),this.reGl=r,this.context=o,this.entity=vl(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var l={};this.context.uniforms.forEach(function(v){var b=v.name,w=v.type,A=v.data,O=v.isReferer,D=v.storageClass;if(D===Ld.StorageBuffer){if(O)s.textureCache[b]={data:void 0},l["".concat(b,"Size")]=function(){return A.compiledBundle.context.output.textureSize};else{s.textureCache[b]=s.calcDataTexture(b,w,A);var _=s.textureCache[b],I=_.textureWidth,B=_.isOutput;l["".concat(b,"Size")]=[I,I],B&&(s.outputTextureName=b,s.context.needPingpong&&(s.outputTextureName="".concat(b,"Output"),s.textureCache[s.outputTextureName]=s.calcDataTexture(b,w,A)))}l[b]=function(){return w0&&console.log("[".concat(s.entity,"]: ").concat(b," ").concat(s.textureCache[b].id)),s.textureCache[b].texture}}else if(D===Ld.Uniform){if(A&&(Array.isArray(A)||Dy(A))&&A.length>16)throw new Error("invalid data type ".concat(w));l[b]=function(){return v.data}}});var u=this.getOuputDataTexture(),h=u.textureWidth,p=u.texelCount;l.u_OutputTextureSize=[h,h],l.u_OutputTexelCount=p,this.context.output.textureSize=[h,h];var g={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:l,vert:_a,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(g)}return(0,or.Z)(n,[{key:"run",value:function(){var o=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){o.computeCommand()}),w0&&console.log("[".concat(this.entity,"]: output ").concat(this.getOuputDataTexture().id))}},{key:"readData",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l=this,u,h,p,g,v,b,w,A;return kn().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){u=l.reGl.read()}),!u){D.next=6;break}if(h=this.getOuputDataTexture(),p=h.originalDataLength,g=h.elementsPerTexel,v=h.typedArrayConstructor,b=v===void 0?Float32Array:v,w=[],g!==4)for(A=0;A<u.length;A+=4)g===1?w.push(u[A]):g===2?w.push(u[A],u[A+1]):w.push(u[A],u[A+1],u[A+2]);else w=u;return D.abrupt("return",new b(w.slice(0,p)));case 6:return D.abrupt("return",new Float32Array);case 7:case"end":return D.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"confirmInput",value:function(o,s){var l;this.entity===o.entity?(this.dynamicPingpong=!0,l=this):l=o,this.textureCache[s].id=l.getOuputDataTexture().id,this.textureCache[s].texture=l.getOuputDataTexture().texture,w0&&console.log("[".concat(this.entity,"]: confirm input ").concat(s," from model ").concat(l.entity,", ").concat(l.getOuputDataTexture().id))}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(o,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=this.context.uniforms.find(function(v){var b=v.name;return b===o});if(u){var h=this.calcDataTexture(o,u.type,s),p=h.texture,g=h.data;this.textureCache[o].data=g,this.textureCache[o].texture=p}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var o=this.context.output.name;this.textureCache[o].id=this.getOuputDataTexture().id,this.textureCache[o].texture=this.getOuputDataTexture().texture}var s=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=s,w0&&console.log("[".concat(this.entity,"]: after swap, output ").concat(this.getOuputDataTexture().id))}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var o=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=o}},{key:"cloneDataTexture",value:function(o){var s=o.data,l=o.textureWidth;return Bg(Bg({},o),{},{id:bp++,texture:this.reGl.texture({width:l,height:l,data:s,type:"float"})})}},{key:"calcDataTexture",value:function(o,s,l){var u=1;s===Vh.Vector4FloatArray&&(u=4);for(var h=[],p=0;p<l.length;p+=u)u===1?h.push(l[p],0,0,0):u===2?h.push(l[p],l[p+1],0,0):u===3?h.push(l[p],l[p+1],l[p+2],0):u===4&&h.push(l[p],l[p+1],l[p+2],l[p+3]);var g=l.length,v=Math.ceil(g/u),b=Math.ceil(Math.sqrt(v)),w=b*b;v<w&&h.push.apply(h,(0,Yo.Z)(new Array((w-v)*4).fill(0)));var A=this.reGl.texture({width:b,height:b,data:h,type:"float"});return{id:bp++,data:h,originalDataLength:g,typedArrayConstructor:Dy(l)?l.constructor:void 0,textureWidth:b,texture:A,texelCount:v,elementsPerTexel:u,isOutput:o===this.context.output.name}}}]),n}(),c=function(){function n(r,o){(0,Wn.Z)(this,n),this.elements=void 0;var s=o.data,l=o.usage,u=o.type,h=o.count;this.elements=r.elements({data:s,usage:y0[l||tt.STATIC_DRAW],type:Hc[u||tt.UNSIGNED_BYTE],count:h})}return(0,or.Z)(n,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(o){var s=o.data;this.elements.subdata(s)}},{key:"destroy",value:function(){this.elements.destroy()}}]),n}(),e=function(){function n(r,o){(0,Wn.Z)(this,n),this.framebuffer=void 0;var s=o.width,l=o.height,u=o.color,h=o.colors,p=o.depth,g=o.stencil,v={width:s,height:l};Array.isArray(h)&&(v.colors=h.map(function(b){return b.get()})),u&&typeof u!="boolean"&&(v.color=u.get()),this.framebuffer=r.framebuffer(v)}return(0,or.Z)(n,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(o){var s=o.width,l=o.height;this.framebuffer.resize(s,l)}}]),n}();function t(n){var r=(0,Pd.Z)(n);return n!=null&&(r==="object"||r==="function")}function i(n){var r={};return Object.keys(n).forEach(function(o){a(o,n[o],r,"")}),r}function a(n,r,o,s){if(r===null||typeof r=="number"||typeof r=="boolean"||Array.isArray(r)&&typeof r[0]=="number"||Dy(r)||r===""||r.resize!==void 0){o["".concat(s&&s+".").concat(n)]=r;return}t(r)&&Object.keys(r).forEach(function(l){a(l,r[l],o,"".concat(s&&s+".").concat(n))}),Array.isArray(r)&&r.forEach(function(l,u){Object.keys(l).forEach(function(h){a(h,l[h],o,"".concat(s&&s+".").concat(n,"[").concat(u,"]"))})})}function d(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function f(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?d(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}var m=function(){function n(r,o){(0,Wn.Z)(this,n),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=r;var s=o.vs,l=o.fs,u=o.defines,h=o.attributes,p=o.uniforms,g=o.primitive,v=o.count,b=o.elements,w=o.depth,A=o.blend,O=o.stencil,D=o.cull,_=o.instances,I=o.scissor,B=o.viewport,G={};p&&(this.uniforms=i(p),Object.keys(p).forEach(function(Ye){G[Ye]=r.prop(Ye)}));var K={};Object.keys(h).forEach(function(Ye){K[Ye]=h[Ye].get()});var ve=u&&this.generateDefines(u)||"",ae={attributes:K,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(ve,`
`).concat(l),uniforms:G,vert:`
`.concat(ve,`
`).concat(s),primitive:UE[g===void 0?tt.TRIANGLES:g]};_&&(ae.instances=_),v&&(ae.count=v),b&&(ae.elements=b.get()),I&&(ae.scissor=I),B&&(ae.viewport=B),this.initDepthDrawParams({depth:w},ae),this.initBlendDrawParams({blend:A},ae),this.initStencilDrawParams({stencil:O},ae),this.initCullDrawParams({cull:D},ae),this.drawCommand=r(ae)}return(0,or.Z)(n,[{key:"addUniforms",value:function(o){this.uniforms=f(f({},this.uniforms),i(o))}},{key:"draw",value:function(o){var s=f(f({},this.uniforms),i(o.uniforms||{})),l={};Object.keys(s).forEach(function(u){var h=(0,Pd.Z)(s[u]);h==="boolean"||h==="number"||Array.isArray(s[u])||s[u].BYTES_PER_ELEMENT?l[u]=s[u]:h==="string"||(l[u]=s[u].get())}),this.drawCommand(l)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(o,s){var l=o.depth;l&&(s.depth={enable:l.enable===void 0?!0:!!l.enable,mask:l.mask===void 0?!0:!!l.mask,func:jE[l.func||tt.LESS],range:l.range||[0,1]})}},{key:"initBlendDrawParams",value:function(o,s){var l=o.blend;if(l){var u=l.enable,h=l.func,p=l.equation,g=l.color,v=g===void 0?[0,0,0,0]:g;s.blend={enable:!!u,func:{srcRGB:b0[h&&h.srcRGB||tt.SRC_ALPHA],srcAlpha:b0[h&&h.srcAlpha||tt.SRC_ALPHA],dstRGB:b0[h&&h.dstRGB||tt.ONE_MINUS_SRC_ALPHA],dstAlpha:b0[h&&h.dstAlpha||tt.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Fg[p&&p.rgb||tt.FUNC_ADD],alpha:Fg[p&&p.alpha||tt.FUNC_ADD]},color:v}}}},{key:"initStencilDrawParams",value:function(o,s){var l=o.stencil;if(l){var u=l.enable,h=l.mask,p=h===void 0?-1:h,g=l.func,v=g===void 0?{cmp:tt.ALWAYS,ref:0,mask:-1}:g,b=l.opFront,w=b===void 0?{fail:tt.KEEP,zfail:tt.KEEP,zpass:tt.KEEP}:b,A=l.opBack,O=A===void 0?{fail:tt.KEEP,zfail:tt.KEEP,zpass:tt.KEEP}:A;s.stencil={enable:!!u,mask:p,func:f(f({},v),{},{cmp:x0[v.cmp]}),opFront:{fail:yp[w.fail],zfail:yp[w.zfail],zpass:yp[w.zpass]},opBack:{fail:yp[O.fail],zfail:yp[O.zfail],zpass:yp[O.zpass]}}}}},{key:"initCullDrawParams",value:function(o,s){var l=o.cull;if(l){var u=l.enable,h=l.face,p=h===void 0?tt.BACK:h;s.cull={enable:!!u,face:My[p]}}}},{key:"generateDefines",value:function(o){return Object.keys(o).map(function(s){return"#define ".concat(s," ").concat(Number(o[s]))}).join(`
`)}}]),n}(),y=function(){function n(r,o){(0,Wn.Z)(this,n),this.texture=void 0,this.width=void 0,this.height=void 0;var s=o.data,l=o.type,u=l===void 0?tt.UNSIGNED_BYTE:l,h=o.width,p=o.height,g=o.flipY,v=g===void 0?!1:g,b=o.format,w=b===void 0?tt.RGBA:b,A=o.mipmap,O=A===void 0?!1:A,D=o.wrapS,_=D===void 0?tt.CLAMP_TO_EDGE:D,I=o.wrapT,B=I===void 0?tt.CLAMP_TO_EDGE:I,G=o.aniso,K=G===void 0?0:G,ve=o.alignment,ae=ve===void 0?1:ve,Ye=o.premultiplyAlpha,rt=Ye===void 0?!1:Ye,st=o.mag,tn=st===void 0?tt.NEAREST:st,bt=o.min,jt=bt===void 0?tt.NEAREST:bt,et=o.colorSpace,An=et===void 0?tt.BROWSER_DEFAULT_WEBGL:et;this.width=h,this.height=p;var Vn={width:h,height:p,type:Hc[u],format:VE[w],wrapS:iC[_],wrapT:iC[B],mag:rC[tn],min:rC[jt],alignment:ae,flipY:v,colorSpace:Ty[An],premultiplyAlpha:rt,aniso:K};s&&(Vn.data=s),typeof O=="number"?Vn.mipmap=Ay[O]:typeof O=="boolean"&&(Vn.mipmap=O),this.texture=r.texture(Vn)}return(0,or.Z)(n,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(o){var s=o.width,l=o.height;this.texture.resize(s,l),this.width=s,this.height=l}},{key:"destroy",value:function(){this.texture.destroy()}}]),n}(),x,E,S,T=(x=(0,U.b2)(),x(E=(S=function(){function n(){var r=this;(0,Wn.Z)(this,n),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var o=(0,Zr.Z)(kn().mark(function s(l){return kn().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!l.uniforms){h.next=3;break}return h.next=3,Promise.all(Object.keys(l.uniforms).map(function(){var p=(0,Zr.Z)(kn().mark(function g(v){var b;return kn().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(!(l.uniforms[v]&&l.uniforms[v].load!==void 0)){A.next=5;break}return A.next=3,l.uniforms[v].load();case 3:b=A.sent,l.uniforms[v]=b;case 5:case"end":return A.stop()}},g)}));return function(g){return p.apply(this,arguments)}}()));case 3:return h.abrupt("return",new m(r.gl,l));case 4:case"end":return h.stop()}},s)}));return function(s){return o.apply(this,arguments)}}(),this.createAttribute=function(o){return new Sl(r.gl,o)},this.createBuffer=function(o){return new oC(r.gl,o)},this.createElements=function(o){return new c(r.gl,o)},this.createTexture2D=function(o){return new y(r.gl,o)},this.createFramebuffer=function(o){return new e(r.gl,o)},this.useFramebuffer=function(o,s){r.gl({framebuffer:o?o.get():null})(s)},this.createComputeModel=function(){var o=(0,Zr.Z)(kn().mark(function s(l){return kn().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",new rS(r.gl,l));case 1:case"end":return h.stop()}},s)}));return function(s){return o.apply(this,arguments)}}(),this.clear=function(o){var s=o.color,l=o.depth,u=o.stencil,h=o.framebuffer,p=h===void 0?null:h,g={color:s,depth:l,stencil:u};g.framebuffer=p===null?p:p.get(),r.gl.clear(g)},this.setScissor=function(o){r.gl&&r.gl._gl&&(o.enable&&o.box?(r.gl._gl.enable(tt.SCISSOR_TEST),r.gl._gl.scissor(o.box.x,o.box.y,o.box.width,o.box.height)):r.gl._gl.disable(tt.SCISSOR_TEST),r.gl._refresh())},this.viewport=function(o){var s=o.x,l=o.y,u=o.width,h=o.height;r.gl&&r.gl._gl&&(r.gl._gl.viewport(s,l,u,h),r.gl._refresh())},this.readPixels=function(o){var s=o.framebuffer,l=o.x,u=o.y,h=o.width,p=o.height,g={x:l,y:u,width:h,height:p};return s&&(g.framebuffer=s.get()),r.gl.read(g)},this.getCanvas=function(){return r.$canvas},this.getGLContext=function(){return r.gl._gl},this.destroy=function(){r.gl&&(r.gl.destroy(),r.inited=!1)}}return(0,or.Z)(n,[{key:"init",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){return kn().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!this.inited){h.next=2;break}return h.abrupt("return");case 2:return this.$canvas=l.canvas,h.next=5,new Promise(function(p,g){mp()({canvas:l.canvas,attributes:{alpha:!0,antialias:l.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(b,w){(b||!w)&&g(b),p(w)}})});case 5:this.gl=h.sent,this.inited=!0;case 7:case"end":return h.stop()}},s,this)}));function o(s){return r.apply(this,arguments)}return o}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),n}(),S))||E);function R(){return typeof window<"u"}function V(n,r,o,s){if(!!R()){var l=document.getElementsByTagName("head")[0],u=document.createElement("script");u.setAttribute("type","text/javascript"),u.setAttribute("src",n),s&&(u.id=s),u.onload=function(){r&&r()},u.onerror=function(h){o&&o("Unable to load script '".concat(n,"'"),h)},l.appendChild(u)}}function j(n,r){return new Promise(function(o,s){V(n,function(){o()},function(l,u){s(u)})})}var q;function ue(){return be.apply(this,arguments)}function be(){return be=(0,Zr.Z)(kn().mark(function n(){return kn().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!q){o.next=2;break}return o.abrupt("return",q);case 2:return o.next=4,j("https://preview.babylonjs.com/glslang/glslang.js");case 4:return q=window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"),o.abrupt("return",q);case 6:case"end":return o.stop()}},n)})),be.apply(this,arguments)}var se=function(){function n(r,o){(0,Wn.Z)(this,n),this.engine=r,this.options=o,this.attribute=void 0,this.buffer=void 0;var s=o,l=s.buffer,u=s.offset,h=s.stride,p=s.normalized,g=s.size,v=s.divisor,b=s.arrayStride,w=s.attributes,A=s.stepMode;this.buffer=l,this.attribute={buffer:l.get(),offset:u||0,stride:h||0,normalized:p||!1,divisor:v||0,arrayStride:b||0,attributes:w,stepMode:A||"vertex"},g&&(this.attribute.size=g)}return(0,or.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(o){this.buffer.subData(o)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),Pe=function(){function n(r,o){(0,Wn.Z)(this,n),this.engine=r,this.options=o,this.buffer=void 0;var s=o,l=s.data,u=s.usage,h=s.type;this.buffer=this.createBuffer(l instanceof Array?new Float32Array(l):l,u||vn.FB.Vertex|vn.FB.CopyDst)}return(0,or.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(o){var s=o.data,l=o.offset;this.setSubData(this.buffer,l,s instanceof Array?new Float32Array(s):s)}},{key:"createBuffer",value:function(o,s){var l=o.byteLength%4,u={size:o.byteLength+l,usage:s},h=this.engine.device.createBuffer(u);return this.setSubData(h,0,o),h}},{key:"setSubData",value:function(o,s,l){var u=sa?this.engine.device.getQueue():this.engine.device.defaultQueue;u.writeBuffer(o,s,l)}}]),n}();function He(n){return typeof n=="number"}var ft=function(){function n(r,o){(0,Wn.Z)(this,n),this.engine=r,this.context=o,this.entity=vl(),this.uniformGPUBufferLayout=[],this.uniformBuffer=void 0,this.vertexBuffers={},this.outputBuffer=void 0,this.bindGroupEntries=void 0,this.bindGroup=void 0,this.computePipeline=void 0}return(0,or.Z)(n,[{key:"init",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l=this,u,h,p,g,v,b,w;return kn().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,this.compileComputePipelineStageDescriptor(this.context.shader);case 2:u=O.sent,h=u.computeStage,p=this.context.uniforms.filter(function(D){return D.storageClass===Ld.StorageBuffer}),g=this.context.uniforms.filter(function(D){return D.storageClass===Ld.Uniform}),v=g.length?1:0,this.bindGroupEntries=[],v&&(b=0,w=[],g.forEach(function(D){if(He(D.data))l.uniformGPUBufferLayout.push({name:D.name,offset:b}),b+=4,w.push(D.data);else{var _,I=((_=D.data)===null||_===void 0?void 0:_.length)||1;I===3&&(I=4,D.data.push(0));var B=b/4%4;if(B>0){var G=4-B;if(I>1&&I<=G)I===2&&(G===3&&(b+=4,w.push(0)),w.push.apply(w,(0,Yo.Z)(D.data)),l.uniformGPUBufferLayout.push({name:D.name,offset:b}));else{for(var K=0;K<G;K++)b+=4,w.push(0);w.push.apply(w,(0,Yo.Z)(D.data)),l.uniformGPUBufferLayout.push({name:D.name,offset:b})}}b+=4*I}}),this.uniformBuffer=new Pe(this.engine,{data:w instanceof Array?new Float32Array(w):w,usage:vn.FB.Uniform|vn.FB.CopyDst}),this.bindGroupEntries.push({binding:0,resource:{buffer:this.uniformBuffer.get()}})),p.forEach(function(D){if(D.data!==null&&(D.type===Vh.Vector4FloatArray||D.type===Vh.FloatArray)){var _;D.name===l.context.output.name?(_=new Pe(l.engine,{data:isFinite(Number(D.data))?[D.data]:D.data,usage:vn.FB.Storage|vn.FB.CopyDst|vn.FB.CopySrc}),l.outputBuffer=_,l.context.output={name:D.name,length:isFinite(Number(D.data))?1:D.data.length,typedArrayConstructor:Float32Array,gpuBuffer:_.get()}):D.isReferer?D.data.model&&D.data.model.outputBuffer&&(_=D.data.model.outputBuffer):_=new Pe(l.engine,{data:isFinite(Number(D.data))?[D.data]:D.data,usage:vn.FB.Storage|vn.FB.CopyDst|vn.FB.CopySrc}),l.vertexBuffers[D.name]=_,l.bindGroupEntries.push({binding:v,resource:{name:D.name,refer:_?void 0:D.data,buffer:_?_.get():void 0}}),v++}}),this.computePipeline=this.engine.device.createComputePipeline({computeStage:h}),console.log(this.bindGroupEntries),this.bindGroup=this.engine.device.createBindGroup({layout:this.computePipeline.getBindGroupLayout(0),entries:this.bindGroupEntries});case 13:case"end":return O.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"destroy",value:function(){var o=this;this.uniformBuffer&&this.uniformBuffer.destroy(),Object.keys(this.vertexBuffers).forEach(function(s){return o.vertexBuffers[s].destroy()})}},{key:"readData",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l,u,h,p,g,v,b,w,A,O;return kn().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(l=this.context.output,!l){_.next=16;break}if(u=l.length,h=l.typedArrayConstructor,p=l.gpuBuffer,!p){_.next=16;break}return g=u*h.BYTES_PER_ELEMENT,v=this.engine.device.createBuffer({size:g,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),b=this.engine.device.createCommandEncoder(),b.copyBufferToBuffer(p,0,v,0,g),w=sa?this.engine.device.getQueue():this.engine.device.defaultQueue,w.submit([b.finish()]),_.next=12,v.mapAsync(vn.gc.Read);case 12:return A=v.getMappedRange(),O=new h(A.slice(0)),v.unmap(),_.abrupt("return",O);case 16:return _.abrupt("return",new Float32Array);case 17:case"end":return _.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"run",value:function(){if(this.engine.currentComputePass){var o;this.engine.currentComputePass.setPipeline(this.computePipeline),this.engine.currentComputePass.setBindGroup(0,this.bindGroup),(o=this.engine.currentComputePass).dispatch.apply(o,(0,Yo.Z)(this.context.dispatch))}}},{key:"updateBuffer",value:function(o,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=this.vertexBuffers[o];u&&u.subData({data:s,offset:l})}},{key:"updateUniform",value:function(o,s){var l=this.uniformGPUBufferLayout.find(function(u){return u.name===o});l&&this.uniformBuffer.subData({data:Number.isFinite(s)?new Float32Array([s]):new Float32Array(s),offset:l.offset})}},{key:"confirmInput",value:function(o,s){var l=this.vertexBuffers[s],u=o.outputBuffer;if(l&&u&&l!==u){var h=this.engine.device.createCommandEncoder(),p=o.context.output,g=p.length,v=p.typedArrayConstructor,b=g*v.BYTES_PER_ELEMENT;h.copyBufferToBuffer(u.get(),0,l.get(),0,b);var w=sa?this.engine.device.getQueue():this.engine.device.defaultQueue;w.submit([h.finish()])}}},{key:"compileShaderToSpirV",value:function(o,s,l){return this.compileRawShaderToSpirV(l+o,s)}},{key:"compileRawShaderToSpirV",value:function(o,s){return this.engine.glslang.compileGLSL(o,s)}},{key:"compileComputePipelineStageDescriptor",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){var u,h;return kn().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(u=l,h=`#version 450
`,this.engine.options.useWGSL){g.next=6;break}return g.next=5,this.compileShaderToSpirV(l,"compute",h);case 5:u=g.sent;case 6:return g.abrupt("return",{computeStage:{module:this.engine.device.createShaderModule({code:u,isWHLSL:sa}),entryPoint:"main"}});case 7:case"end":return g.stop()}},s,this)}));function o(s){return r.apply(this,arguments)}return o}()}]),n}(),pt=function(){function n(r,o){(0,Wn.Z)(this,n),this.engine=r,this.options=o,this.indexCount=void 0,this.buffer=void 0;var s=o,l=s.data,u=s.usage,h=s.type,p=s.count;this.indexCount=p||0,this.buffer=new Pe(r,{data:l instanceof Array?new Uint16Array(l):l,usage:vn.FB.Index|vn.FB.CopyDst})}return(0,or.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"subData",value:function(o){this.buffer.subData(o)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),kt=function(){function n(r,o){(0,Wn.Z)(this,n),this.engine=r,this.options=o,this.colorTexture=void 0,this.depthTexture=void 0,this.width=0,this.height=0;var s=o,l=s.width,u=s.height,h=s.color,p=s.colors,g=s.depth,v=s.stencil;h&&(this.colorTexture=h),g&&(this.depthTexture=g)}return(0,or.Z)(n,[{key:"get",value:function(){var o,s;return{color:(o=this.colorTexture)===null||o===void 0?void 0:o.get(),depth:(s=this.depthTexture)===null||s===void 0?void 0:s.get()}}},{key:"destroy",value:function(){var o,s;(o=this.colorTexture)===null||o===void 0||o.destroy(),(s=this.depthTexture)===null||s===void 0||s.destroy()}},{key:"resize",value:function(o){var s=o.width,l=o.height;if(s!==this.width||l!==this.height){var u,h;(u=this.colorTexture)===null||u===void 0||u.resize({width:s,height:l}),(h=this.depthTexture)===null||h===void 0||h.resize({width:s,height:l})}this.width=s,this.height=l}}]),n}(),cn,Bt,Xt,on,fr,Cr,St,dn=(cn={},(0,ht.Z)(cn,tt.POINTS,vn.YV.PointList),(0,ht.Z)(cn,tt.LINES,vn.YV.LineList),(0,ht.Z)(cn,tt.LINE_LOOP,vn.YV.LineList),(0,ht.Z)(cn,tt.LINE_STRIP,vn.YV.LineStrip),(0,ht.Z)(cn,tt.TRIANGLES,vn.YV.TriangleList),(0,ht.Z)(cn,tt.TRIANGLE_FAN,vn.YV.TriangleList),(0,ht.Z)(cn,tt.TRIANGLE_STRIP,vn.YV.TriangleStrip),cn),ur=(Bt={},(0,ht.Z)(Bt,tt.NEVER,vn.wb.Never),(0,ht.Z)(Bt,tt.ALWAYS,vn.wb.Always),(0,ht.Z)(Bt,tt.LESS,vn.wb.Less),(0,ht.Z)(Bt,tt.LEQUAL,vn.wb.LessEqual),(0,ht.Z)(Bt,tt.GREATER,vn.wb.Greater),(0,ht.Z)(Bt,tt.GEQUAL,vn.wb.GreaterEqual),(0,ht.Z)(Bt,tt.EQUAL,vn.wb.Equal),(0,ht.Z)(Bt,tt.NOTEQUAL,vn.wb.NotEqual),Bt),Ni=(Xt={},(0,ht.Z)(Xt,tt.FUNC_ADD,vn.db.Add),(0,ht.Z)(Xt,tt.MIN_EXT,vn.db.Min),(0,ht.Z)(Xt,tt.MAX_EXT,vn.db.Max),(0,ht.Z)(Xt,tt.FUNC_SUBTRACT,vn.db.Subtract),(0,ht.Z)(Xt,tt.FUNC_REVERSE_SUBTRACT,vn.db.ReverseSubtract),Xt),Gi=(on={},(0,ht.Z)(on,tt.ZERO,vn.zi.Zero),(0,ht.Z)(on,tt.ONE,vn.zi.One),(0,ht.Z)(on,tt.SRC_COLOR,vn.zi.SrcColor),(0,ht.Z)(on,tt.ONE_MINUS_SRC_COLOR,vn.zi.OneMinusSrcColor),(0,ht.Z)(on,tt.SRC_ALPHA,vn.zi.SrcAlpha),(0,ht.Z)(on,tt.ONE_MINUS_SRC_ALPHA,vn.zi.OneMinusSrcAlpha),(0,ht.Z)(on,tt.DST_COLOR,vn.zi.DstColor),(0,ht.Z)(on,tt.ONE_MINUS_DST_COLOR,vn.zi.OneMinusDstColor),(0,ht.Z)(on,tt.DST_ALPHA,vn.zi.DstAlpha),(0,ht.Z)(on,tt.ONE_MINUS_DST_ALPHA,vn.zi.OneMinusDstAlpha),(0,ht.Z)(on,tt.CONSTANT_COLOR,vn.zi.BlendColor),(0,ht.Z)(on,tt.ONE_MINUS_CONSTANT_COLOR,vn.zi.OneMinusBlendColor),(0,ht.Z)(on,tt.SRC_ALPHA_SATURATE,vn.zi.SrcAlphaSaturated),on),cs=(fr={},(0,ht.Z)(fr,tt.ALPHA,"r8unorm"),(0,ht.Z)(fr,tt.RGBA,"rgba8unorm"),(0,ht.Z)(fr,tt.DEPTH_COMPONENT,"depth32float"),(0,ht.Z)(fr,tt.DEPTH_STENCIL,"depth24plus-stencil8"),fr),_o=(Cr={},(0,ht.Z)(Cr,tt.NEAREST,"nearest"),(0,ht.Z)(Cr,tt.LINEAR,"linear"),Cr),xp=(St={},(0,ht.Z)(St,tt.REPEAT,"repeat"),(0,ht.Z)(St,tt.CLAMP_TO_EDGE,"clamp-to-edge"),(0,ht.Z)(St,tt.MIRRORED_REPEAT,"mirror-repeat"),St);function E0(n){var r=n.cull;if(!r||!r.enable)return vn.Wf.None;if(r.face)return r.face===tt.FRONT?vn.Wf.Front:vn.Wf.Back}function Vd(n){var r=n.depth,o=n.stencil,s={compare:vn.wb.Always,depthFailOp:vn.xS.Keep,failOp:vn.xS.Keep,passOp:vn.xS.Keep};return{depthWriteEnabled:r&&r.enable,depthCompare:ur[(r==null?void 0:r.func)||tt.ALWAYS],format:vn.EV.Depth24PlusStencil8,stencilFront:s,stencilBack:s,stencilReadMask:4294967295,stencilWriteMask:4294967295}}function zg(n,r){var o=n.blend;return[{format:r,alphaBlend:{srcFactor:Gi[o&&o.func&&o.func.srcAlpha||tt.ONE],dstFactor:Gi[o&&o.func&&o.func.dstAlpha||tt.ZERO],operation:Ni[o&&o.equation&&o.equation.alpha||tt.FUNC_ADD]},colorBlend:{srcFactor:Gi[o&&o.func&&o.func.srcRGB||tt.ONE],dstFactor:Gi[o&&o.func&&o.func.dstRGB||tt.ZERO],operation:Ni[o&&o.equation&&o.equation.rgb||tt.FUNC_ADD]},writeMask:vn.Yw.All}]}function $c(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function Na(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?$c(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):$c(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}function cC(n){for(var r=0,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];for(var u=0,h=s;u<h.length;u++){var p=h[u];r+=p.length}for(var g=new n(r),v=0,b=0,w=s;b<w.length;b++){var A=w[b];g.set(A,v),v+=A.length}return g}var uC=function(){function n(r,o){(0,Wn.Z)(this,n),this.engine=r,this.options=o,this.pipelineLayout=void 0,this.renderPipeline=void 0,this.uniformsBindGroupLayout=void 0,this.uniformBindGroup=void 0,this.uniformBuffer=void 0,this.uniforms={},this.uniformGPUBufferLayout=[],this.attributeCache={},this.indexBuffer=void 0,this.indexCount=void 0}return(0,or.Z)(n,[{key:"init",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l=this,u,h,p,g,v,b,w,A,O,D,_,I,B,G,K,ve,ae,Ye;return kn().wrap(function(st){for(;;)switch(st.prev=st.next){case 0:return u=this.options,h=u.vs,p=u.fs,g=u.attributes,v=u.uniforms,b=u.primitive,w=u.count,A=u.elements,O=u.depth,D=u.blend,_=u.stencil,I=u.cull,B=u.instances,st.next=3,this.compilePipelineStageDescriptor(h,p,null);case 3:G=st.sent,K=G.vertexStage,ve=G.fragmentStage,v&&this.buildUniformBindGroup(v),A&&(this.indexBuffer=A.get(),this.indexCount=A.indexCount),ae={vertexBuffers:Object.keys(g).map(function(tn,bt){var jt=g[tn],et=jt.get(),An=et.arrayStride,Vn=et.stepMode,Zn=et.attributes;return l.attributeCache[tn]=jt,{arrayStride:An,stepMode:Vn,attributes:Zn}})},Ye={sampleCount:this.engine.mainPassSampleCount,primitiveTopology:dn[b||tt.TRIANGLES],rasterizationState:Na(Na({},this.getDefaultRasterizationStateDescriptor()),{},{cullMode:E0({cull:I})}),depthStencilState:Vd({depth:O,stencil:_}),colorStates:zg({blend:D},this.engine.options.swapChainFormat),layout:this.pipelineLayout,vertexStage:K,fragmentStage:ve,vertexState:ae},this.renderPipeline=this.engine.device.createRenderPipeline(Ye);case 11:case"end":return st.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"addUniforms",value:function(o){this.uniforms=Na(Na({},this.uniforms),i(o))}},{key:"draw",value:function(o){var s=this,l=this.engine.getCurrentRenderPass(),u=Na(Na({},this.uniforms),i(o.uniforms||{})),h=[];Object.keys(u).forEach(function(p){var g=(0,Pd.Z)(u[p]);if(g==="boolean"||g==="number"||Array.isArray(u[p])||u[p].BYTES_PER_ELEMENT){var v,b=(v=s.uniformGPUBufferLayout.find(function(B){var G=B.name;return G===p}))===null||v===void 0?void 0:v.offset;b!==null&&s.uniformBuffer.subData({data:u[p],offset:b})}else{var w,A=(w=s.uniformGPUBufferLayout.find(function(B){var G=B.name;return G===p}))===null||w===void 0?void 0:w.offset;if(A!==null){var O=u[p].get(),D=O.color||O,_=D.texture,I=D.sampler;I&&(h.push({binding:A,resource:I}),A++),h.push({binding:A,resource:_.createView()})}}}),this.uniformBuffer&&(h[0]={binding:0,resource:{buffer:this.uniformBuffer.get()}}),this.uniformBindGroup=this.engine.device.createBindGroup({layout:this.uniformsBindGroupLayout,entries:h}),this.renderPipeline&&l.setPipeline(this.renderPipeline),l.setBindGroup(0,this.uniformBindGroup),this.indexBuffer&&l.setIndexBuffer(this.indexBuffer.get(),vn.iD.Uint32,0),Object.keys(this.attributeCache).forEach(function(p,g){l.setVertexBuffer(0+g,s.attributeCache[p].get().buffer,0)}),this.indexBuffer?l.drawIndexed(this.indexCount,this.options.instances||1,0,0,0):l.draw(this.options.count||0,this.options.instances||0,0,0)}},{key:"destroy",value:function(){throw new Error("Method not implemented.")}},{key:"compilePipelineStageDescriptor",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l,u,h){var p,g,v;return kn().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(p=`#version 450
`,g=l,v=u,this.engine.options.useWGSL){w.next=10;break}return w.next=6,this.compileShaderToSpirV(l,"vertex",p);case 6:return g=w.sent,w.next=9,this.compileShaderToSpirV(u,"fragment",p);case 9:v=w.sent;case 10:return w.abrupt("return",this.createPipelineStageDescriptor(g,v));case 11:case"end":return w.stop()}},s,this)}));function o(s,l,u){return r.apply(this,arguments)}return o}()},{key:"compileShaderToSpirV",value:function(o,s,l){return this.compileRawShaderToSpirV(l+o,s)}},{key:"compileRawShaderToSpirV",value:function(o,s){return this.engine.glslang.compileGLSL(o,s)}},{key:"createPipelineStageDescriptor",value:function(o,s){return{vertexStage:{module:this.engine.device.createShaderModule({code:o,isWHLSL:sa}),entryPoint:"main"},fragmentStage:{module:this.engine.device.createShaderModule({code:s,isWHLSL:sa}),entryPoint:"main"}}}},{key:"getDefaultRasterizationStateDescriptor",value:function(){return{frontFace:vn.zX.CCW,cullMode:vn.Wf.None,depthBias:0,depthBiasSlopeScale:0,depthBiasClamp:0}}},{key:"buildUniformBindGroup",value:function(o){var s=this,l=0,u=cC.apply(void 0,[Float32Array].concat((0,Yo.Z)(Object.keys(o).map(function(g){return o[g]?(s.uniformGPUBufferLayout.push({name:g,offset:l}),l+=(o[g].length||1)*4,o[g]):[]})))),h=[],p=!1;u.length&&(p=!0,h.push({binding:0,visibility:vn.$X.Fragment|vn.$X.Vertex,type:vn.$l.UniformBuffer})),Object.keys(o).filter(function(g){return o[g]===null}).forEach(function(g,v){s.uniformGPUBufferLayout.push({name:g,offset:v*2+(p?1:0)}),h.push({binding:v*2+(p?1:0),visibility:vn.$X.Fragment,type:vn.$l.Sampler},{binding:v*2+(p?1:0)+1,visibility:vn.$X.Fragment,type:vn.$l.SampledTexture})}),this.uniformsBindGroupLayout=this.engine.device.createBindGroupLayout({entries:h}),this.pipelineLayout=this.engine.device.createPipelineLayout({bindGroupLayouts:[this.uniformsBindGroupLayout]}),p&&(this.uniformBuffer=new Pe(this.engine,{data:u instanceof Array?new Float32Array(u):u,usage:vn.FB.Uniform|vn.FB.CopyDst}))}}]),n}(),Cp=function(){function n(r,o){(0,Wn.Z)(this,n),this.engine=r,this.options=o,this.texture=void 0,this.sampler=void 0,this.width=void 0,this.height=void 0,this.createTexture()}return(0,or.Z)(n,[{key:"get",value:function(){return{texture:this.texture,sampler:this.sampler}}},{key:"update",value:function(){}},{key:"resize",value:function(o){var s=o.width,l=o.height;(s!==this.width||l!==this.height)&&(this.destroy(),this.createTexture()),this.width=s,this.height=l}},{key:"destroy",value:function(){this.texture&&this.texture.destroy()}},{key:"createTexture",value:function(){var o=this.options,s=o.data,l=o.type,u=l===void 0?tt.UNSIGNED_BYTE:l,h=o.width,p=o.height,g=o.flipY,v=g===void 0?!1:g,b=o.format,w=b===void 0?tt.RGBA:b,A=o.mipmap,O=A===void 0?!1:A,D=o.wrapS,_=D===void 0?tt.CLAMP_TO_EDGE:D,I=o.wrapT,B=I===void 0?tt.CLAMP_TO_EDGE:I,G=o.aniso,K=G===void 0?0:G,ve=o.alignment,ae=ve===void 0?1:ve,Ye=o.premultiplyAlpha,rt=Ye===void 0?!1:Ye,st=o.mag,tn=st===void 0?tt.NEAREST:st,bt=o.min,jt=bt===void 0?tt.NEAREST:bt,et=o.colorSpace,An=et===void 0?tt.BROWSER_DEFAULT_WEBGL:et,Vn=o.usage;this.width=h,this.height=p,this.texture=this.engine.device.createTexture({size:[h,p,1],mipLevelCount:1,sampleCount:1,dimension:vn.kd.E2d,format:cs[w],usage:Vn||vn.v2.Sampled|vn.v2.CopyDst}),(!Vn||Vn&vn.v2.Sampled)&&(this.sampler=this.engine.device.createSampler({addressModeU:xp[_],addressModeV:xp[B],addressModeW:xp[_],magFilter:_o[tn],minFilter:_o[jt],maxAnisotropy:K}))}}]),n}(),jA,HA,$A,rO=(jA=(0,U.b2)(),jA(HA=($A=function(){function n(){var r=this;(0,Wn.Z)(this,n),this.supportWebGPU=!0,this.useWGSL=!1,this.options=void 0,this.canvas=void 0,this.context=void 0,this.glslang=void 0,this.adapter=void 0,this.device=void 0,this.swapChain=void 0,this.mainPassSampleCount=void 0,this.mainTexture=void 0,this.depthTexture=void 0,this.mainColorAttachments=void 0,this.mainTextureExtends=void 0,this.mainDepthAttachment=void 0,this.uploadEncoder=void 0,this.renderEncoder=void 0,this.computeEncoder=void 0,this.renderTargetEncoder=void 0,this.commandBuffers=new Array(4).fill(void 0),this.currentRenderPass=null,this.mainRenderPass=null,this.currentRenderTargetViewDescriptor=void 0,this.currentComputePass=null,this.bundleEncoder=void 0,this.tempBuffers=[],this.currentRenderTarget=null,this.uploadEncoderDescriptor={label:"upload"},this.renderEncoderDescriptor={label:"render"},this.renderTargetEncoderDescriptor={label:"renderTarget"},this.computeEncoderDescriptor={label:"compute"},this.pipelines={},this.computePipelines={},this.defaultSampleCount=4,this.clearDepthValue=1,this.clearStencilValue=0,this.transientViewport={x:1/0,y:0,width:0,height:0},this.cachedViewport={x:0,y:0,width:0,height:0},this.clear=function(o){var s=o.framebuffer,l=o.color,u=o.depth,h=o.stencil;r.options.supportCompute&&r.startComputePass(),r.currentRenderTarget?(r.currentRenderPass&&r.endRenderTargetRenderPass(),r.startRenderTargetRenderPass(r.currentRenderTarget,l||null,!!u,!!h)):(r.mainColorAttachments[0].loadValue=l||vn.Ws.Load,r.mainDepthAttachment.depthLoadValue=u||vn.Ws.Load,r.mainDepthAttachment.stencilLoadValue=h?r.clearStencilValue:vn.Ws.Load,r.mainRenderPass&&r.endMainRenderPass(),r.startMainRenderPass())},this.createModel=function(){var o=(0,Zr.Z)(kn().mark(function s(l){var u;return kn().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return u=new uC(r,l),p.next=3,u.init();case 3:return p.abrupt("return",u);case 4:case"end":return p.stop()}},s)}));return function(s){return o.apply(this,arguments)}}(),this.createAttribute=function(o){return new se(r,o)},this.createBuffer=function(o){return new Pe(r,o)},this.createElements=function(o){return new pt(r,o)},this.createTexture2D=function(o){return new Cp(r,o)},this.createFramebuffer=function(o){return new kt(r,o)},this.useFramebuffer=function(o,s){r.currentRenderTarget&&r.unbindFramebuffer(r.currentRenderTarget),r.currentRenderTarget=o,r.currentRenderTargetViewDescriptor={dimension:vn.p_.E2d,arrayLayerCount:1,aspect:vn.H7.All},r.currentRenderPass=null,s()},this.createComputeModel=function(){var o=(0,Zr.Z)(kn().mark(function s(l){var u;return kn().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return u=new ft(r,l),p.next=3,u.init();case 3:return p.abrupt("return",u);case 4:case"end":return p.stop()}},s)}));return function(s){return o.apply(this,arguments)}}(),this.getCanvas=function(){return r.canvas},this.getGLContext=function(){throw new Error("Method not implemented.")},this.viewport=function(o){var s=o.x,l=o.y,u=o.width,h=o.height;if(!r.currentRenderPass)r.transientViewport={x:s,y:l,width:u,height:h};else if(r.transientViewport.x!==1/0){var p=r.getCurrentRenderPass();p.setViewport(r.transientViewport.x,r.transientViewport.y,r.transientViewport.width,r.transientViewport.height,0,1)}else if(s!==r.cachedViewport.x||l!==r.cachedViewport.y||u!==r.cachedViewport.width||h!==r.cachedViewport.height){r.cachedViewport={x:s,y:l,width:u,height:h};var g=r.getCurrentRenderPass();g.setViewport(s,l,u,h,0,1)}},this.readPixels=function(o){throw new Error("Method not implemented.")}}return(0,or.Z)(n,[{key:"isFloatSupported",value:function(){return!0}},{key:"init",value:function(){var r=(0,Zr.Z)(kn().mark(function s(l){return kn().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return this.canvas=l.canvas,this.options=l,this.useWGSL=!!l.useWGSL,this.mainPassSampleCount=l.antialiasing?this.defaultSampleCount:1,h.next=6,this.initGlslang();case 6:this.initContextAndSwapChain(),this.initMainAttachments();case 8:case"end":return h.stop()}},s,this)}));function o(s){return r.apply(this,arguments)}return o}()},{key:"setScissor",value:function(o){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){this.mainTexture&&this.mainTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.tempBuffers.forEach(function(o){return o.destroy()}),this.tempBuffers=[]}},{key:"beginFrame",value:function(){this.uploadEncoder=this.device.createCommandEncoder(this.uploadEncoderDescriptor),this.renderEncoder=this.device.createCommandEncoder(this.renderEncoderDescriptor),this.renderTargetEncoder=this.device.createCommandEncoder(this.renderTargetEncoderDescriptor),this.options.supportCompute&&(this.computeEncoder=this.device.createCommandEncoder(this.computeEncoderDescriptor))}},{key:"endFrame",value:function(){this.options.supportCompute&&this.endComputePass(),this.endMainRenderPass(),this.commandBuffers[0]=this.uploadEncoder.finish(),this.commandBuffers[1]=this.renderEncoder.finish(),this.options.supportCompute&&(this.commandBuffers[2]=this.computeEncoder.finish()),this.commandBuffers[3]=this.renderTargetEncoder.finish(),sa?this.device.getQueue().submit(this.commandBuffers.filter(function(o){return o})):this.device.defaultQueue.submit(this.commandBuffers.filter(function(o){return o}))}},{key:"getCurrentRenderPass",value:function(){return this.currentRenderTarget&&!this.currentRenderPass?this.startRenderTargetRenderPass(this.currentRenderTarget,null,!1,!1):this.currentRenderPass||this.startMainRenderPass(),this.currentRenderPass}},{key:"initGlslang",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l,u;return kn().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,ue();case 2:return this.glslang=p.sent,p.next=5,(l=navigator)===null||l===void 0||(u=l.gpu)===null||u===void 0?void 0:u.requestAdapter();case 5:return this.adapter=p.sent,p.next=8,this.adapter.requestDevice();case 8:this.device=p.sent;case 9:case"end":return p.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"initContextAndSwapChain",value:function(){this.context=this.canvas.getContext(sa?"gpu":"gpupresent"),this.swapChain=this.context.configureSwapChain({device:this.device,format:this.options.swapChainFormat,usage:vn.v2.OutputAttachment|vn.v2.CopySrc})}},{key:"initMainAttachments",value:function(){if(this.mainTextureExtends={width:this.canvas.width,height:this.canvas.height,depth:1},this.options.antialiasing){var o={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:vn.kd.E2d,format:vn.EV.BGRA8Unorm,usage:vn.v2.OutputAttachment};this.mainTexture&&this.mainTexture.destroy(),this.mainTexture=this.device.createTexture(o),this.mainColorAttachments=[{attachment:sa?this.mainTexture.createDefaultView():this.mainTexture.createView(),loadValue:[0,0,0,1],storeOp:vn.EG.Store}]}else this.mainColorAttachments=[{attachment:sa?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),loadValue:[0,0,0,1],storeOp:vn.EG.Store}];var s={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:vn.kd.E2d,format:sa?"depth32float-stencil8":vn.EV.Depth24PlusStencil8,usage:vn.v2.OutputAttachment};this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture(s),this.mainDepthAttachment={attachment:sa?this.depthTexture.createDefaultView():this.depthTexture.createView(),depthLoadValue:this.clearDepthValue,depthStoreOp:vn.EG.Store,stencilLoadValue:this.clearStencilValue,stencilStoreOp:vn.EG.Store}}},{key:"startComputePass",value:function(){this.currentComputePass&&this.endComputePass(),this.currentComputePass=this.computeEncoder.beginComputePass()}},{key:"startMainRenderPass",value:function(){this.currentRenderPass&&!this.currentRenderTarget&&this.endMainRenderPass(),this.options.antialiasing?this.mainColorAttachments[0].resolveTarget=sa?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView():this.mainColorAttachments[0].attachment=sa?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),this.currentRenderPass=this.renderEncoder.beginRenderPass({colorAttachments:this.mainColorAttachments,depthStencilAttachment:this.mainDepthAttachment}),this.mainRenderPass=this.currentRenderPass,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"startRenderTargetRenderPass",value:function(o,s,l){var u,h,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,g=(u=o.get().color)===null||u===void 0?void 0:u.texture,v;g&&(v=g.createView(this.currentRenderTargetViewDescriptor));var b=(h=o.get().depth)===null||h===void 0?void 0:h.texture,w;b&&(w=b.createView());var A=this.renderTargetEncoder.beginRenderPass({colorAttachments:[{attachment:v,loadValue:s!==null?s:vn.Ws.Load,storeOp:vn.EG.Store}],depthStencilAttachment:b&&w?{attachment:w,depthLoadValue:l?this.clearDepthValue:vn.Ws.Load,depthStoreOp:vn.EG.Store,stencilLoadValue:p?this.clearStencilValue:vn.Ws.Load,stencilStoreOp:vn.EG.Store}:void 0});this.currentRenderPass=A,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"endMainRenderPass",value:function(){this.currentRenderPass===this.mainRenderPass&&this.currentRenderPass!==null&&(this.currentRenderPass.endPass(),this.resetCachedViewport(),this.currentRenderPass=null,this.mainRenderPass=null)}},{key:"endComputePass",value:function(){this.currentComputePass&&(this.currentComputePass.endPass(),this.currentComputePass=null)}},{key:"endRenderTargetRenderPass",value:function(){this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport())}},{key:"resetCachedViewport",value:function(){this.cachedViewport={x:0,y:0,width:0,height:0}}},{key:"unbindFramebuffer",value:function(o){this.currentRenderPass&&this.currentRenderPass!==this.mainRenderPass&&this.endRenderTargetRenderPass(),this.transientViewport.x=1/0,this.currentRenderTarget=null,this.currentRenderPass=this.mainRenderPass}}]),n}(),$A))||HA),WA,ZA;function iO(n){var r=oO();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function oO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var iS=4/64,XA=1-iS*2,sO=(WA=(0,U.b2)(),WA(ZA=function(n){(0,Rs.Z)(o,n);var r=iO(o);function o(){return(0,Wn.Z)(this,o),r.apply(this,arguments)}return(0,or.Z)(o,[{key:"onEntityCreated",value:function(){var l=this.config,u=l.widthSegments,h=u===void 0?1:u,p=l.heightSegments,g=p===void 0?1:p,v=l.depthSegments,b=v===void 0?1:v,w=l.halfExtents,A=w===void 0?gt.fromValues(.5,.5,.5):w,O=h,D=g,_=b,I=(0,_h.Z)(A,3),B=I[0],G=I[1],K=I[2],ve=[gt.fromValues(-B,-G,K),gt.fromValues(B,-G,K),gt.fromValues(B,G,K),gt.fromValues(-B,G,K),gt.fromValues(B,-G,-K),gt.fromValues(-B,-G,-K),gt.fromValues(-B,G,-K),gt.fromValues(B,G,-K)],ae=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],Ye=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],rt={FRONT:0,BACK:1,TOP:2,BOTTOM:3,RIGHT:4,LEFT:5},st=[],tn=[],bt=[],jt=[],et=[],An=0,Vn=function(Dr,eo,Uo){var Ur,Vo,gs,hn;for(gs=0;gs<=eo;gs++)for(hn=0;hn<=Uo;hn++){var Xn=gt.create(),oi=gt.create(),ui=gt.create(),Ai=gt.create();gt.lerp(Xn,ve[ae[Dr][0]],ve[ae[Dr][1]],gs/eo),gt.lerp(oi,ve[ae[Dr][0]],ve[ae[Dr][2]],hn/Uo),gt.sub(ui,oi,ve[ae[Dr][0]]),gt.add(Ai,Xn,ui),Ur=gs/eo,Vo=hn/Uo,st.push(Ai[0],Ai[1],Ai[2]),tn.push(Ye[Dr][0],Ye[Dr][1],Ye[Dr][2]),bt.push(Ur,Vo),Ur/=3,Vo/=3,Ur=Ur*XA+iS,Vo=Vo*XA+iS,Ur+=Dr%3/3,Vo+=Math.floor(Dr/3)/3,jt.push(Ur,Vo),gs<eo&&hn<Uo&&(et.push(An+Uo+1,An+1,An),et.push(An+Uo+1,An+Uo+2,An+1)),An++}};Vn(rt.FRONT,O,D),Vn(rt.BACK,O,D),Vn(rt.TOP,O,_),Vn(rt.BOTTOM,O,_),Vn(rt.RIGHT,_,D),Vn(rt.LEFT,_,D);var Zn=Uh(st),wi=this.getComponent();wi.indices=Uint32Array.from(et),wi.aabb=Zn,wi.vertexCount=An,wi.attributes=[{dirty:!0,name:"position",data:Float32Array.from(st),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(tn),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(bt),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),o}(Wh))||ZA);function aO(n,r){if(!n&&!r)throw new Error("Please specify valid arguments for parameters a and b.");if(!r||r.length===0)return n;if(!n||n.length===0)return r;if(Object.prototype.toString.call(n)!==Object.prototype.toString.call(r))throw new Error("The types of the two arguments passed for parameters a and b do not match.");var o=new n.constructor(n.length+r.length);return o.set(n),o.set(r,n.length),o}var YA,KA;function lO(n){var r=cO();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function cO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var uO=(YA=(0,U.b2)(),YA(KA=function(n){(0,Rs.Z)(o,n);var r=lO(o);function o(){return(0,Wn.Z)(this,o),r.apply(this,arguments)}return(0,or.Z)(o,[{key:"onEntityCreated",value:function(){var l=this.config.geometries,u=l===void 0?[]:l,h=this.getComponent();h.aabb=new e0;var p=[],g=[],v=0;u.forEach(function(b){var w=b.aabb,A=b.indices,O=b.vertexCount,D=b.attributes;h.aabb.add(w),h.vertexCount+=O,A&&g.push.apply(g,(0,Yo.Z)(A.map(function(_){return _+v}))),v+=O,D.forEach(function(_,I){p[I]?_.data&&(jh(_.data)?p[I].push(_.data):LE(_.data)?p[I].data=aO(p[I].data,_.data):p[I].data=p[I].data.concat(_.data)):(p[I]=_,p[I].dirty=!0)})}),h.attributes=p,h.indices=Uint32Array.from(g),h.dirty=!0}}]),o}(Wh))||KA),qA,JA;function dO(n){var r=hO();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function hO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var fO=(qA=(0,U.b2)(),qA(JA=function(n){(0,Rs.Z)(o,n);var r=dO(o);function o(){return(0,Wn.Z)(this,o),r.apply(this,arguments)}return(0,or.Z)(o,[{key:"onEntityCreated",value:function(){for(var l=this.config,u=l.halfExtents,h=u===void 0?[.5,.5]:u,p=l.widthSegments,g=p===void 0?5:p,v=l.lengthSegments,b=v===void 0?5:v,w=[],A=[],O=[],D=[],_=0,I=0;I<=g;I++)for(var B=0;B<=b;B++){var G=-h[0]+2*h[0]*I/g,K=0,ve=-(-h[1]+2*h[1]*B/b),ae=I/g,Ye=B/b;w.push(G,K,ve),A.push(0,1,0),O.push(ae,Ye),I<g&&B<b&&(D.push(_+b+1,_+1,_),D.push(_+b+1,_+b+2,_+1)),_++}var rt=Uh(w),st=this.getComponent();st.indices=Uint32Array.from(D),st.aabb=rt,st.vertexCount=_,st.attributes=[{dirty:!0,name:"position",data:Float32Array.from(w),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(A),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(O),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),o}(Wh))||JA),QA,eT;function pO(n){var r=gO();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function gO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var mO=(QA=(0,U.b2)(),QA(eT=function(n){(0,Rs.Z)(o,n);var r=pO(o);function o(){return(0,Wn.Z)(this,o),r.apply(this,arguments)}return(0,or.Z)(o,[{key:"onEntityCreated",value:function(){for(var l=this.config,u=l.radius,h=u===void 0?.5:u,p=l.latitudeBands,g=p===void 0?16:p,v=l.longitudeBands,b=v===void 0?16:v,w=[],A=[],O=[],D=[],_=0;_<=g;_++)for(var I=_*Math.PI/g,B=Math.sin(I),G=Math.cos(I),K=0;K<=b;K++){var ve=K*2*Math.PI/b-Math.PI/2,ae=Math.sin(ve),Ye=Math.cos(ve),rt=Ye*B,st=G,tn=ae*B,bt=1-K/b,jt=1-_/g;w.push(rt*h,st*h,tn*h),A.push(rt,st,tn),O.push(bt,jt)}for(var et=0;et<g;++et)for(var An=0;An<b;++An){var Vn=et*(b+1)+An,Zn=Vn+b+1;D.push(Vn+1,Zn,Vn),D.push(Vn+1,Zn+1,Zn)}var wi=Uh(w),Ei=this.getComponent();Ei.indices=Uint32Array.from(D),Ei.aabb=wi,Ei.vertexCount=w.length/3,Ei.attributes=[{dirty:!0,name:"position",data:Float32Array.from(w),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(A),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(O),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),o}(Wh))||eT),tT,nT,rT,iT,dC,oT,sT,aT;function vO(n){var r=yO();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function yO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var bO=`varying vec4 fragColor;

#pragma include "uv.frag.declaration"
#pragma include "map.frag.declaration"

void main() {
  vec4 diffuseColor = fragColor;

  #pragma include "map.frag.main"

  gl_FragColor = diffuseColor;
}`,xO=`attribute vec3 position;
attribute vec3 normal;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform vec4 color;

varying vec4 fragColor;

#pragma include "uv.vert.declaration"

void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  fragColor = color;

  #pragma include "uv.vert.main"
}`,CO=`// layout(set = 0, binding = 1) uniform WireframeUniforms {
//   float lineWidth;
//   vec4 lineColor;
// } wireframe;

layout(location = 0) in vec4 fragColor;
// layout(location = 1) in vec3 v_Barycentric;

layout(location = 0) out vec4 outColor;

// wireframe
// float edgeFactor() {
//   vec3 d = fwidth(v_Barycentric);
//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);
//   return min(min(a3.x, a3.y), a3.z);
// }

void main() {
  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));
  outColor = fragColor;
}`,wO=`layout(set = 0, binding = 0) uniform Uniforms {
  vec4 color;
  mat4 projectionMatrix;
  mat4 modelViewMatrix;
} uniforms;

layout(location = 0) in vec3 position;
// layout(location = 1) in vec3 barycentric;

layout(location = 0) out vec4 fragColor;
// layout(location = 1) out vec3 v_Barycentric;

void main() {
  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);
  fragColor = uniforms.color;
  // v_Barycentric = barycentric;
}`,EO=(tT=(0,U.b2)(),nT=(0,U.f3)(Pt.RenderEngine),rT=(0,U.f3)(Pt.ShaderModuleService),tT(iT=(dC=(aT=function(n){(0,Rs.Z)(o,n);var r=vO(o);function o(){var s;(0,Wn.Z)(this,o);for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];return s=r.call.apply(r,[this].concat(u)),(0,tr.Z)(s,"engine",oT,(0,vo.Z)(s)),(0,tr.Z)(s,"shaderModuleService",sT,(0,vo.Z)(s)),s}return(0,or.Z)(o,[{key:"onEntityCreated",value:function(){var l=this.getComponent(),u=this.engine.supportWebGPU?wO:xO,h=this.engine.supportWebGPU?CO:bO;this.shaderModuleService.registerModule("material-basic",{vs:u,fs:h});var p=this.shaderModuleService.getModule("material-basic"),g=p.vs,v=p.fs,b=p.uniforms;l.vertexShaderGLSL=g,l.fragmentShaderGLSL=v,l.setUniform(b),this.config.map&&(l.setDefines({USE_UV:1,USE_MAP:1}),l.setUniform({map:this.config.map,uvTransform:kh.Ue()}))}}]),o}(Qx),aT),oT=(0,On.Z)(dC.prototype,"engine",[nT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sT=(0,On.Z)(dC.prototype,"shaderModuleService",[rT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dC))||iT),lT,cT,uT,dT,hT,fT,pT,_y,gT,mT,vT,yT;function SO(n){var r=AO();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function AO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var TO=`// generate grid, borrow from clay.gl viewer
// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl
#extension GL_OES_standard_derivatives : enable

varying vec3 v_Position;
// varying vec3 v_Normal;

uniform float u_GridSize : 5;
uniform float u_GridSize2 : .5;
uniform vec4 u_GridColor : [0, 0, 0, 1];
uniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];
uniform bool u_GridEnabled : true;

// uniform vec3 u_LightDirection;
// uniform vec3 u_LightColor;
// uniform vec3 u_Camera;

void main() {
  // vec3 n = v_Normal;
  // vec3 l = normalize(u_LightDirection);
  // float NdotL = clamp(dot(n, l), 0.001, 1.0);

  gl_FragColor = vec4(1.);

  if (u_GridEnabled) {
    float wx = v_Position.x;
    float wz = v_Position.z;
    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;
    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;

    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;
    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;

    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);
    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);
    // if (v0 > 0.1) {
        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);
    // }
    // else {
        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);
    // }
  }

  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);
  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;

  // gl_FragColor.rgb *= diffuseColor;
}`,MO=`attribute vec3 a_Position;

varying vec3 v_Position;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

void main() {
  v_Position = a_Position;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);
}`,PO=(lT=(0,U.b2)(),cT=(0,U.f3)(Pt.Systems),uT=(0,U.t6)(Pt.MaterialSystem),dT=(0,U.f3)(Pt.Systems),hT=(0,U.t6)(Pt.GeometrySystem),fT=(0,U.f3)(Pt.ShaderModuleService),lT(pT=(_y=(yT=function(n){(0,Rs.Z)(o,n);var r=SO(o);function o(){var s;(0,Wn.Z)(this,o);for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];return s=r.call.apply(r,[this].concat(u)),(0,tr.Z)(s,"materialSystem",gT,(0,vo.Z)(s)),(0,tr.Z)(s,"geometrySystem",mT,(0,vo.Z)(s)),(0,tr.Z)(s,"shaderModuleService",vT,(0,vo.Z)(s)),s}return(0,or.Z)(o,[{key:"onAttributeChanged",value:function(l){var u=l.name,h=l.data,p=this.getMeshComponent();p&&p.material&&(u==="gridColor"?(p.material.setUniform("u_GridColor",h),p.material.setUniform("u_GridColor2",h)):u==="gridSize"&&(p.material.setUniform("u_GridSize",h),p.material.setUniform("u_GridSize2",h)))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:MO,fs:TO});var l=this.shaderModuleService.getModule("grid"),u=l.vs,h=l.fs,p=l.uniforms,g=this.materialSystem.createShaderMaterial({vertexShader:u,fragmentShader:h});this.setMaterial(g);var v=this.geometrySystem.createBufferGeometry({vertexCount:4});this.setGeometry(v),g.setCull({enable:!1,face:tt.BACK}).setDepth({enable:!0,func:tt.LESS}),g.setUniform(p),this.setAttributes({gridColor:this.config.gridColor,gridSize:this.config.gridSize}),v.setIndex([0,3,2,2,1,0]),v.setAttribute("a_Position",Float32Array.from([-4,-1,-4,4,-1,-4,4,-1,4,-4,-1,4]),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})}}]),o}(zd),yT),gT=(0,On.Z)(_y.prototype,"materialSystem",[cT,uT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mT=(0,On.Z)(_y.prototype,"geometrySystem",[dT,hT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vT=(0,On.Z)(_y.prototype,"shaderModuleService",[fT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_y))||pT),hC=P(32644),Ug=P(40582);function fC(n,r,o,s,l){Ny(r,s,-l),Ny(r,s,l),n.push(o),n.push(o)}function Ny(n,r,o){n.push([[r[0],r[1]],o])}function OO(n,r,o){var s=[0,0],l=[0,0],u=[0,0],h=[0,0],p=-1,g=!1,v=null,b=(0,hC.create)(),w=o||0,A=3,O=[],D=[],_=[],I=[0,0];r&&(n=n.slice(),n.push(n[0]));for(var B=n.length,G=1;G<B;G++){var K=w,ve=n[G-1],ae=n[G],Ye=G<n.length-1?n[G+1]:null;if(I.push(G/B,G/B),(0,Ug.o7)(s,ae,ve),v||(v=[0,0],(0,Ug.mJ)(v,s)),g||(g=!0,fC(D,O,ve,v,1)),_.push([K+0,K+1,K+2]),!Ye)(0,Ug.mJ)(v,s),fC(D,O,ae,v,1),_.push(p===1?[K,K+2,K+3]:[K+2,K+1,K+3]),w+=2;else{(0,Ug.o7)(l,Ye,ae);var rt=(0,Ug.x7)(u,h,s,l,1),st=(0,hC.dot)(u,v)<0?-1:1,tn=rt>A;if(!isFinite(rt)){(0,Ug.mJ)(v,s),fC(D,O,ae,v,1),_.push(p===1?[K,K+2,K+3]:[K+2,K+1,K+3]),w+=2,p=st;continue}tn?(rt=A,I.push(G/B),Ny(O,v,-st),D.push(ae),Ny(O,h,rt*st),D.push(ae),_.push(p!==-st?[K,K+2,K+3]:[K+2,K+1,K+3]),_.push([K+2,K+3,K+4]),(0,Ug.mJ)(b,l),(0,hC.copy)(v,b),Ny(O,v,-st),D.push(ae),w+=3):(fC(D,O,ae,h,rt),_.push(p===1?[K,K+2,K+3]:[K+2,K+1,K+3]),st=-1,(0,hC.copy)(v,h),w+=2),p=st}}return{normals:O,attrIndex:_,attrPos:D,attrCounters:I}}var bT,xT,CT,wT,ET,ST,AT,ky,TT,MT,PT,OT;function DO(n){var r=_O();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function _O(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var NO=`uniform float u_dash_array : 0.02;
uniform float u_dash_offset : 0;
uniform float u_dash_ratio : 0;
uniform float u_thickness : 0.02;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
    float blur = 1. - smoothstep(0.98, 1., length(v_normal));

    gl_FragColor = v_color;
    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));
}`,kO=`attribute vec2 a_pos;
attribute vec4 a_color;
attribute float a_line_miter;
attribute vec2 a_line_normal;
attribute float a_counters;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform float u_thickness : 0.02;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
  v_color = a_color;
  v_counters = a_counters;

  vec3 normal = normalize(vec3(a_line_normal, 0.0));

  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);

  v_normal = vec2(normal * sign(a_line_miter));

  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;
}
`,RO=(bT=(0,U.b2)(),xT=(0,U.f3)(Pt.Systems),CT=(0,U.t6)(Pt.MaterialSystem),wT=(0,U.f3)(Pt.Systems),ET=(0,U.t6)(Pt.GeometrySystem),ST=(0,U.f3)(Pt.ShaderModuleService),bT(AT=(ky=(OT=function(n){(0,Rs.Z)(o,n);var r=DO(o);function o(){var s;(0,Wn.Z)(this,o);for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];return s=r.call.apply(r,[this].concat(u)),(0,tr.Z)(s,"materialSystem",TT,(0,vo.Z)(s)),(0,tr.Z)(s,"geometrySystem",MT,(0,vo.Z)(s)),(0,tr.Z)(s,"shaderModuleService",PT,(0,vo.Z)(s)),s.vertexCount=void 0,s}return(0,or.Z)(o,[{key:"onAttributeChanged",value:function(l){var u=l.name,h=l.data,p=this.getMeshComponent();if(p&&p.material)switch(u){case"dashArray":p.material.setUniform("u_dash_array",h);break;case"dashOffset":p.material.setUniform("u_dash_offset",h);break;case"dashRatio":p.material.setUniform("u_dash_ratio",h);break;case"thickness":p.material.setUniform("u_thickness",h);break;case"color":var g=new Array(this.vertexCount).fill(void 0).map(function(){return h}).reduce(function(v,b){return[].concat((0,Yo.Z)(v),(0,Yo.Z)(b))},[]);p.geometry.setAttribute("a_color",Float32Array.from(g),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]});break}}},{key:"onEntityCreated",value:function(){var l=this;this.shaderModuleService.registerModule("line",{vs:kO,fs:NO});var u=this.shaderModuleService.getModule("line"),h=u.vs,p=u.fs,g=u.uniforms,v=this.materialSystem.createShaderMaterial({vertexShader:h,fragmentShader:p}),b=OO(this.config.points,!1),w=b.normals,A=b.attrIndex,O=b.attrPos,D=b.attrCounters,_=O.length;this.vertexCount=_;var I=this.geometrySystem.createBufferGeometry({vertexCount:_});this.setMaterial(v),this.setGeometry(I),v.setCull({enable:!1,face:tt.BACK}).setUniform(g),this.setAttributes({dashArray:this.config.dashArray,dashOffset:this.config.dashOffset,dashRatio:this.config.dashRatio,thickness:this.config.thickness});var B=[],G=[];w.forEach(function(ve){var ae=ve[0],Ye=ve[1];B.push([ae[0],ae[1]]),G.push(Ye)}),I.setIndex(A.reduce(function(ve,ae){return[].concat((0,Yo.Z)(ve),(0,Yo.Z)(ae))},[])),I.setAttribute("a_pos",Float32Array.from(O.reduce(function(ve,ae){return[].concat((0,Yo.Z)(ve),(0,Yo.Z)(ae))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]});var K=new Array(_).fill(void 0).map(function(){return(0,Yo.Z)(l.config.color)}).reduce(function(ve,ae){return[].concat((0,Yo.Z)(ve),(0,Yo.Z)(ae))},[]);I.setAttribute("a_color",Float32Array.from(K),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]}),I.setAttribute("a_line_miter",Float32Array.from(G),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float"}]}),I.setAttribute("a_line_normal",Float32Array.from(B.reduce(function(ve,ae){return[].concat((0,Yo.Z)(ve),(0,Yo.Z)(ae))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:3,offset:0,format:"float2"}]}),I.setAttribute("a_counters",Float32Array.from(D),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:4,offset:0,format:"float"}]})}}]),o}(zd),OT),TT=(0,On.Z)(ky.prototype,"materialSystem",[xT,CT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MT=(0,On.Z)(ky.prototype,"geometrySystem",[wT,ET],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PT=(0,On.Z)(ky.prototype,"shaderModuleService",[ST],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ky))||AT);function IO(n){return[n+1&255,n+1>>8&255,n+1>>8>>8&255]}var DT,_T,NT,kT,RT,IT,LT,Ry,FT,GT,BT,zT;function UT(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function LO(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?UT(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):UT(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}function FO(n){var r=GO();return function(){var s=(0,Pr.Z)(n),l;if(r){var u=(0,Pr.Z)(this).constructor;l=Reflect.construct(s,arguments,u)}else l=s.apply(this,arguments);return(0,js.Z)(this,l)}}function GO(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var BO=`uniform float u_blur : 0.05;
uniform float u_opacity : 0.7;
uniform float u_stroke_width : 0.01;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "sdf2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  // if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  // } else if (shape == 1) {
  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  // } else if (shape == 2) {
  //   outer_df = sdBox(v_data.xy, vec2(1.));
  //   inner_df = sdBox(v_data.xy, vec2(r));
  // } else if (shape == 3) {
  //   outer_df = sdPentagon(v_data.xy, 0.8);
  //   inner_df = sdPentagon(v_data.xy, r * 0.8);
  // } else if (shape == 4) {
  //   outer_df = sdHexagon(v_data.xy, 0.8);
  //   inner_df = sdHexagon(v_data.xy, r * 0.8);
  // } else if (shape == 5) {
  //   outer_df = sdOctogon(v_data.xy, 1.0);
  //   inner_df = sdOctogon(v_data.xy, r);
  // } else if (shape == 6) {
  //   outer_df = sdHexagram(v_data.xy, 0.52);
  //   inner_df = sdHexagram(v_data.xy, r * 0.52);
  // } else if (shape == 7) {
  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));
  //   inner_df = sdRhombus(v_data.xy, vec2(r));
  // } else if (shape == 8) {
  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);
  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  // }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;

  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;

  gl_FragColor = filterColor(gl_FragColor);
}`,zO=`attribute vec2 position;
attribute vec4 color;
attribute float shape;
attribute vec2 offset;
attribute float size;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

uniform float u_stroke_width : 0.01;
uniform float u_device_pixel_ratio;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "picking"

void main() {
  v_color = color;
  v_radius = size;

  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);

  // construct point coords
  v_data = vec4(position, antialiasblur, shape);

  gl_Position = projectionMatrix * modelViewMatrix
    * vec4(position * size + offset, 0.0, 1.0);

  setPickingColor(a_PickingColor);
}`,UO=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],VO=(DT=(0,U.b2)(),_T=(0,U.f3)(Pt.Systems),NT=(0,U.t6)(Pt.MaterialSystem),kT=(0,U.f3)(Pt.Systems),RT=(0,U.t6)(Pt.GeometrySystem),IT=(0,U.f3)(Pt.ShaderModuleService),DT(LT=(Ry=(zT=function(n){(0,Rs.Z)(o,n);var r=FO(o);function o(){var s;(0,Wn.Z)(this,o);for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];return s=r.call.apply(r,[this].concat(u)),(0,tr.Z)(s,"materialSystem",FT,(0,vo.Z)(s)),(0,tr.Z)(s,"geometrySystem",GT,(0,vo.Z)(s)),(0,tr.Z)(s,"shaderModuleService",BT,(0,vo.Z)(s)),s}return(0,or.Z)(o,[{key:"onAttributeChanged",value:function(l){var u=l.name,h=l.data,p=this.getMeshComponent();p&&p.material&&(u==="strokeWidth"?p.material.setUniform("u_stroke_width",h):u==="strokeColor"?p.material.setUniform("u_stroke_color",h):u==="strokeOpacity"?p.material.setUniform("u_stroke_opacity",h):u==="opacity"?p.material.setUniform("u_opacity",h):u==="blur"&&p.material.setUniform("u_blur",h))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:zO,fs:BO});var l=this.shaderModuleService.getModule("grid"),u=l.vs,h=l.fs,p=l.uniforms,g=this.materialSystem.createShaderMaterial({vertexShader:u,fragmentShader:h,cull:{enable:!1},depth:{enable:!1},blend:{enable:!0,func:{srcRGB:tt.SRC_ALPHA,dstRGB:tt.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}});g.setUniform(LO({u_device_pixel_ratio:window.devicePixelRatio},p));var v=this.buildAttributes(),b=this.geometrySystem.createInstancedBufferGeometry({maxInstancedCount:v.instancedOffsets.length/2,vertexCount:6});b.setIndex([0,2,1,0,3,2]),b.setAttribute("position",Float32Array.from(v.positions),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]}),b.setAttribute("offset",Float32Array.from(v.instancedOffsets),{arrayStride:4*2,stepMode:"instance",attributes:[{shaderLocation:1,offset:0,format:"float2"}]}),b.setAttribute("color",Float32Array.from(v.instancedColors),{arrayStride:4*4,stepMode:"instance",attributes:[{shaderLocation:2,offset:0,format:"float4"}]}),b.setAttribute("size",Float32Array.from(v.instancedSizes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:3,offset:0,format:"float"}]}),b.setAttribute("shape",Float32Array.from(v.instancedShapes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:4,offset:0,format:"float"}]}),b.setAttribute("a_PickingColor",Float32Array.from(v.instancedPickingColors),{arrayStride:4*3,stepMode:"instance",attributes:[{shaderLocation:6,offset:0,format:"float3"}]}),this.setMaterial(g),this.setGeometry(b)}},{key:"buildAttribute",value:function(l,u,h){var p,g,v,b;(p=u.instancedPickingColors).push.apply(p,(0,Yo.Z)(IO(l.id||h))),u.instancedShapes.push(UO.indexOf(l.shape||"circle")),(g=u.instancedColors).push.apply(g,(0,Yo.Z)(l.color||[1,0,0,1])),(v=u.instancedOffsets).push.apply(v,(0,Yo.Z)(l.position||[0,0])),(b=u.instancedSizes).push.apply(b,(0,Yo.Z)(l.size||[.2,.2]))}},{key:"buildAttributes",value:function(){var l=this,u={positions:[1,1,1,-1,-1,-1,-1,1],instancedOffsets:[],instancedColors:[],instancedSizes:[],instancedShapes:[],instancedPickingColors:[]};return Array.isArray(this.config)?this.config.forEach(function(h,p){l.buildAttribute(h,u,p)}):this.buildAttribute(this.config,u,0),u}}]),o}(zd),zT),FT=(0,On.Z)(Ry.prototype,"materialSystem",[_T,NT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GT=(0,On.Z)(Ry.prototype,"geometrySystem",[kT,RT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BT=(0,On.Z)(Ry.prototype,"shaderModuleService",[IT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ry))||LT),VT,jT,HT,$T,WT,Iy,ZT,XT,YT,KT;function qT(n,r){var o;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(o=jO(n))||r&&n&&typeof n.length=="number"){o&&(n=o);var s=0,l=function(){};return{s:l,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(v){throw v},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=!0,h=!1,p;return{s:function(){o=n[Symbol.iterator]()},n:function(){var v=o.next();return u=v.done,v},e:function(v){h=!0,p=v},f:function(){try{!u&&o.return!=null&&o.return()}finally{if(h)throw p}}}}function jO(n,r){if(!!n){if(typeof n=="string")return JT(n,r);var o=Object.prototype.toString.call(n).slice(8,-1);if(o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set")return Array.from(n);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return JT(n,r)}}function JT(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=n[o];return s}var HO=`#ifdef USE_MAP
  uniform sampler2D map;
#endif`,$O=`#ifdef USE_MAP
  vec4 texelColor = texture2D(map, vUv);
  // texelColor = mapTexelToLinear(texelColor);
  diffuseColor *= texelColor;
#endif`,WO=`#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))
  varying vec2 vUv;
#endif`,ZO=`#ifdef USE_UV
  attribute vec2 uv;
	#ifdef UVS_VERTEX_ONLY
    vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,XO=`#ifdef USE_UV
  vUv = (uvTransform * vec3(uv, 1)).xy;
#endif`,QT=(VT=(0,U.b2)(),jT=(0,U.f3)(Pt.RenderEngine),HT=(0,U.f3)(Pt.ShaderModuleService),$T=(0,U.f3)(Pt.ConfigService),VT(WT=(Iy=(KT=function(){function n(){(0,Wn.Z)(this,n),this.container=void 0,(0,tr.Z)(this,"engine",ZT,this),(0,tr.Z)(this,"shaderModule",XT,this),(0,tr.Z)(this,"configService",YT,this),this.inited=!1,this.rendering=!1,this.pendings=[],this.views=[],this.size=void 0}return(0,or.Z)(n,[{key:"init",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l,u,h,p,g;return kn().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.shaderModule.registerBuiltinModules(),this.shaderModule.registerModule("uv.vert.declaration",{vs:ZO}),this.shaderModule.registerModule("uv.vert.main",{vs:XO}),this.shaderModule.registerModule("uv.frag.declaration",{fs:WO}),this.shaderModule.registerModule("map.frag.declaration",{fs:HO}),this.shaderModule.registerModule("map.frag.main",{fs:$O}),l=this.container.getAll(Pt.Systems),u=this.configService.get(),!u.canvas){b.next=30;break}return b.next=11,this.engine.init({canvas:u.canvas,swapChainFormat:vn.EV.BGRA8Unorm,antialiasing:!1});case 11:h=qT(l),b.prev=12,h.s();case 14:if((p=h.n()).done){b.next=21;break}if(g=p.value,!g.initialize){b.next=19;break}return b.next=19,g.initialize();case 19:b.next=14;break;case 21:b.next=26;break;case 23:b.prev=23,b.t0=b.catch(12),h.e(b.t0);case 26:return b.prev=26,h.f(),b.finish(26);case 29:this.inited=!0;case 30:case"end":return b.stop()}},s,this,[[12,23,26,29]])}));function o(){return r.apply(this,arguments)}return o}()},{key:"render",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l,u,h,p,g,v,b,w=arguments;return kn().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(!(!this.inited||this.rendering)){O.next=2;break}return O.abrupt("return");case 2:for(this.pendings.length&&this.pendings.forEach(function(D){D()}),this.rendering=!0,this.engine.beginFrame(),l=this.container.getAll(Pt.Systems),u=w.length,h=new Array(u),p=0;p<u;p++)h[p]=w[p];g=qT(l),O.prev=8,g.s();case 10:if((v=g.n()).done){O.next=17;break}if(b=v.value,!b.execute){O.next=15;break}return O.next=15,b.execute(h);case 15:O.next=10;break;case 17:O.next=22;break;case 19:O.prev=19,O.t0=O.catch(8),g.e(O.t0);case 22:return O.prev=22,g.f(),O.finish(22);case 25:this.engine.endFrame(),this.rendering=!1;case 27:case"end":return O.stop()}},s,this,[[8,19,22,25]])}));function o(){return r.apply(this,arguments)}return o}()},{key:"clear",value:function(o){var s=this;return this.inited?this.engine.clear(o):this.pendings.unshift(function(){s.engine.clear(o),s.pendings.shift()}),this}},{key:"setSize",value:function(o){var s=o.width,l=o.height,u=this.engine.getCanvas();return this.size={width:s,height:l},u.width=s,u.height=l,this}},{key:"getSize",value:function(){return this.size}}]),n}(),KT),ZT=(0,On.Z)(Iy.prototype,"engine",[jT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XT=(0,On.Z)(Iy.prototype,"shaderModule",[HT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YT=(0,On.Z)(Iy.prototype,"configService",[$T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iy))||WT),eM,tM,nM,rM=(eM=(0,U.b2)(),eM(tM=(nM=function(){function n(){(0,Wn.Z)(this,n),this.entities=[]}return(0,or.Z)(n,[{key:"getEntities",value:function(){return this.entities}},{key:"addRenderable",value:function(o){return this.addEntity(o.getEntity()),this}},{key:"removeRenderable",value:function(o){return this.removeEntity(o.getEntity()),this}},{key:"addLight",value:function(){}},{key:"addEntity",value:function(o){return this.entities.indexOf(o)===-1&&this.entities.push(o),this}},{key:"removeEntity",value:function(o){var s=this.entities.indexOf(o);return this.entities.splice(s,1),this}}]),n}(),nM))||tM),iM,oM,sM,aM=(iM=(0,U.b2)(),iM(oM=(sM=function(){function n(){(0,Wn.Z)(this,n),this.cache={}}return(0,or.Z)(n,[{key:"get",value:function(o){return this.cache[o]}},{key:"set",value:function(o,s){this.cache[o]=s}}]),n}(),sM))||oM),lM,cM,uM,dM,pC,hM,fM,pM;function gM(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function mM(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?gM(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):gM(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}var vM=(lM=(0,U.b2)(),cM=(0,U.f3)(aM),uM=(0,U.f3)(Pt.RenderEngine),lM(dM=(pC=(pM=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"textureCache",hM,this),(0,tr.Z)(this,"engine",fM,this),this.config=void 0,this.loaded=!1,this.texture=void 0}return(0,or.Z)(n,[{key:"setConfig",value:function(o){this.config=o}},{key:"isLoaded",value:function(){return this.loaded}},{key:"load",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l=this;return kn().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!this.config.url){h.next=4;break}return h.abrupt("return",new Promise(function(p,g){var v=l.textureCache.get(l.config.url);if(v)p(v);else{var b=new Image;b.crossOrigin="Anonymous",b.src=l.config.url,b.onload=function(){var w=l.engine.createTexture2D(mM(mM({},l.config),{},{data:b,width:b.width,height:b.height,flipY:!0}));l.textureCache.set(l.config.url,w),l.texture=w,l.loaded=!0,p(w)},b.onerror=function(){g()}}}));case 4:return this.loaded=!0,this.texture=this.engine.createTexture2D(this.config),h.abrupt("return",this.texture);case 7:case"end":return h.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()}]),n}(),pM),hM=(0,On.Z)(pC.prototype,"textureCache",[cM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fM=(0,On.Z)(pC.prototype,"engine",[uM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pC))||dM),yM,bM,xM,CM,oS,wM,EM,SM=(yM=(0,U.b2)(),bM=(0,U.f3)(Pt.Systems),xM=(0,U.t6)(Pt.RendererSystem),yM(CM=(oS=(EM=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"rendererSystem",wM,this),this.camera=void 0,this.scene=void 0,this.viewport={x:0,y:0,width:0,height:0},this.clearColor=[1,1,1,1]}return(0,or.Z)(n,[{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getViewport",value:function(){return this.viewport}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setCamera",value:function(o){return this.camera=o,this}},{key:"setScene",value:function(o){return this.scene=o,this}},{key:"setViewport",value:function(o){return this.viewport=o,this}},{key:"setClearColor",value:function(o){return this.clearColor=o,this}},{key:"pick",value:function(o){return this.rendererSystem.pick(o,this)}}]),n}(),EM),wM=(0,On.Z)(oS.prototype,"rendererSystem",[bM,xM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oS))||CM),AM,TM,MM,sS,PM,OM;function DM(n,r){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);r&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),o.push.apply(o,s)}return o}function YO(n){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?DM(Object(o),!0).forEach(function(s){(0,ht.Z)(n,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):DM(Object(o)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(o,s))})}return n}var gC=(AM=(0,U.b2)(),TM=(0,U.f3)(Pt.ConfigService),AM(MM=(sS=(OM=function(){function n(){(0,Wn.Z)(this,n),(0,tr.Z)(this,"configService",PM,this),this.container=void 0}return(0,or.Z)(n,[{key:"getEngine",value:function(){var r=(0,Zr.Z)(kn().mark(function s(){var l,u,h,p;return kn().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return l=this.container.get(Pt.RenderEngine),u=this.configService.get(),h=u.canvas,p=u.engineOptions,v.next=4,l.init(YO({canvas:h||DE(),swapChainFormat:vn.EV.BGRA8Unorm,antialiasing:!1},p));case 4:return v.abrupt("return",l);case 5:case"end":return v.stop()}},s,this)}));function o(){return r.apply(this,arguments)}return o}()},{key:"getTransformComponent",value:function(o){var s=this.container.get(Pt.TransformComponentManager);return s.getComponentByEntity(o)}},{key:"getMeshComponent",value:function(o){var s=this.container.get(Pt.MeshComponentManager);return s.getComponentByEntity(o)}},{key:"setConfig",value:function(o){this.configService.set(o)}},{key:"setContainer",value:function(o){this.container=o}},{key:"getContainer",value:function(){return this.container}},{key:"createEntity",value:function(){return vl()}},{key:"createScene",value:function(){return this.container.get(rM)}},{key:"createCamera",value:function(){return this.container.get(ws)}},{key:"createView",value:function(){return this.container.get(SM)}},{key:"createRenderable",value:function(o,s){var l=o?this.container.getNamed(Pt.Renderable,o):this.container.get(zd),u=vl();return l.setConfig(s||{}),l.setEntity(u),l}},{key:"createGeometry",value:function(o,s){var l=this.container.getNamed(Pt.Geometry,o),u=vl();return l.setConfig(s||{}),l.setEntity(u),l.getComponent()}},{key:"createMaterial",value:function(o,s){var l=this.container.getNamed(Pt.Material,o),u=vl();return l.setConfig(s||{}),l.setEntity(u,o),l.getComponent()}},{key:"createTexture2D",value:function(o){var s=this.container.get(vM);return s.setConfig(o),s}},{key:"createBufferGeometry",value:function(o){var s=this.container.getNamed(Pt.Systems,Pt.GeometrySystem);return s.createBufferGeometry(o)}},{key:"createInstancedBufferGeometry",value:function(o){var s=this.container.getNamed(Pt.Systems,Pt.GeometrySystem);return s.createInstancedBufferGeometry(o)}},{key:"createShaderMaterial",value:function(o){var s=this.container.getNamed(Pt.Systems,Pt.MaterialSystem);return s.createShaderMaterial(o)}},{key:"createKernel",value:function(o){var s=this.container.get(Ka);return typeof o=="string"?s.setBundle(JSON.parse(o)):s.setBundle(o),s.init(),s}},{key:"createRenderer",value:function(){var o=this.container.get(QT);return o.container=this.container,o.init(),o}},{key:"destroy",value:function(){var o=this.container.getAll(Pt.Systems);o.forEach(function(u){u.tearDown&&u.tearDown()});var s=this.container.get(Pt.RenderEngine);s.destroy();var l=this.container.get(Pt.InteractorService);l.destroy()}}],[{key:"create",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=l0(),l=navigator.gpu?rO:T;s.isBound(Pt.RenderEngine)||s.bind(Pt.RenderEngine).to(l).inSingletonScope(),s.bind(QT).toSelf(),s.bind(Ka).toSelf(),s.bind(zd).toSelf(),s.bind(SM).toSelf(),s.bind(ws).toSelf(),s.bind(rM).toSelf(),s.bind(n).toSelf(),s.bind(aM).toSelf(),s.bind(vM).toSelf(),s.bind(Pt.Geometry).to(sO).whenTargetNamed(Wh.BOX),s.bind(Pt.Geometry).to(mO).whenTargetNamed(Wh.SPHERE),s.bind(Pt.Geometry).to(fO).whenTargetNamed(Wh.PLANE),s.bind(Pt.Geometry).to(uO).whenTargetNamed(Wh.MERGED),s.bind(Pt.Material).to(EO).whenTargetNamed(Qx.BASIC),s.bind(Pt.Renderable).to(VO).whenTargetNamed(zd.POINT),s.bind(Pt.Renderable).to(RO).whenTargetNamed(zd.LINE),s.bind(Pt.Renderable).to(PO).whenTargetNamed(zd.GRID);var u=s.get(n);return u.setContainer(s),u.setConfig(o),u}}]),n}(),OM),PM=(0,On.Z)(sS.prototype,"configService",[TM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sS))||MM);const S0=(n,r)=>{let o;return n?En(n)?o=()=>n:o=n:o=()=>r||1,o},KO=(n,r)=>{const o=[],s=[],l={};let u=0;for(u=0;u<n.length;u++){const p=n[u];l[p.id]=u,o.push(p.x),o.push(p.y),o.push(0),o.push(0),s.push([])}for(u=0;u<r.length;u++){const p=r[u],g=Kr(p,"source"),v=Kr(p,"target");s[l[g]].push(l[v]),s[l[v]].push(l[g])}let h=0;for(u=0;u<n.length;u++){const p=o.length,g=s[u],v=g.length;o[u*4+2]=p,o[u*4+3]=g.length,h=Math.max(h,g.length);for(let b=0;b<v;++b){const w=g[b];o.push(+w)}}for(;o.length%4!==0;)o.push(0);return{maxEdgePerVetex:h,array:new Float32Array(o)}},qO=(n,r,o,s)=>{const l=[],u=[],h={};let p=0;for(p=0;p<n.length;p++){const v=n[p];h[v.id]=p,l.push(v.x),l.push(v.y),l.push(0),l.push(0),u.push([])}for(p=0;p<r.length;p++){const v=r[p],b=Kr(v,"source"),w=Kr(v,"target");u[h[b]].push(h[w]),u[h[b]].push(o(v)),u[h[b]].push(s(v)),u[h[b]].push(0),u[h[w]].push(h[b]),u[h[w]].push(o(v)),u[h[w]].push(s(v)),u[h[w]].push(0)}let g=0;for(p=0;p<n.length;p++){const v=l.length,b=u[p],w=b.length;l[p*4+2]=v+1048576*w/4,l[p*4+3]=0,g=Math.max(g,w/4);for(let A=0;A<w;++A){const O=b[A];l.push(+O)}}for(;l.length%4!==0;)l.push(0);return{maxEdgePerVetex:g,array:new Float32Array(l)}},JO=(n,r)=>{const o=[],s=n.length,l={};return r.forEach(u=>{n.forEach((h,p)=>{if(l[u[h]]===void 0&&(l[u[h]]=Object.keys(l).length),o.push(l[u[h]]),p===s-1)for(;o.length%4!==0;)o.push(0)})}),{array:new Float32Array(o),count:Object.keys(l).length}},_M=n=>{const r=[],o=n.length,s=n[0].length;for(let l=0;l<s;l++)n.forEach((u,h)=>{if(r.push(u[l]),h===o-1)for(;r.length%4!==0;)r.push(0)});return new Float32Array(r)},Sk=null,QO='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_K : f32;\\n  [[offset 4]] u_K2 : f32;\\n  [[offset 8]] u_Center : vec2<f32>;\\n  [[offset 16]] u_Gravity : f32;\\n  [[offset 20]] u_ClusterGravity : f32;\\n  [[offset 24]] u_Speed : f32;\\n  [[offset 28]] u_MaxDisplace : f32;\\n  [[offset 32]] u_Clustering : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AttributeArray : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar param : f32 = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx = dx + param * xDist;\\ndy = dy + param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < j);\\ndx = dx + param * std::sign;\\ndy = dy + param * std::sign;}}}}\\nreturn vec2<f32>(dx, dy);}\\nfn calcGravity(currentNode : vec4<f32>, nodeAttributes : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar vx : f32 = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nvar vy : f32 = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nvar gf : f32 = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {var clusterIdx : i32 = i32(nodeAttributes.x);\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nvar cvx : f32 = currentNode.x - center.x;\\nvar cvy : f32 = currentNode.y - center.y;\\nvar dist : f32 = std::sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nvar parma : f32 = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx = dx + parma * cvx;\\ndy = dy + parma * cvy;}\\nreturn vec2<f32>(dx, dy);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar arr_offset : i32 = i32(std::floor(currentNode.z + 0.5));\\nvar length : i32 = i32(std::floor(currentNode.w + 0.5));\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + i32(p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = select(node_buffer.x, select(node_buffer.y, select(node_buffer.z, node_buffer.w, buf_offset == 2), buf_offset == 1), buf_offset == 0);\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar attractiveF : f32 = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx = dx - xDist * attractiveF;\\ndy = dy - yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < i32(float_j));\\ndx = dx - std::sign * attractiveF;\\ndy = dy - std::sign * attractiveF;}}}\\nreturn vec2<f32>(dx, dy);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nif (i >= __DefineValuePlaceholder__VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes : vec4<f32> = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\ndx = dx + repulsive.x;\\ndy = dy + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode);\\ndx = dx + attractive.x;\\ndy = dy + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(currentNode, nodeAttributes);\\ndx = dx - gravity.x;\\ndy = dy - gravity.y;\\ndx = dx * gWebGPUUniformParams.u_Speed;\\ndy = dy * gWebGPUUniformParams.u_Speed;\\nvar distLength : f32 = std::sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {var limitedDist : f32 = std::min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_K;\\n  float u_K2;\\n  vec2 u_Center;\\n  float u_Gravity;\\n  float u_ClusterGravity;\\n  float u_Speed;\\n  float u_MaxDisplace;\\n  float u_Clustering;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AttributeArray[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nvec2 calcRepulsive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {float dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nfloat vy = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nfloat gf = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= gWebGPUUniformParams.u_Speed;\\ndy *= gWebGPUUniformParams.u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',Ak=null,eD='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\n\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 0, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributes : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[i];\\nvar sumx : f32 = 0.0;\\nvar sumy : f32 = 0.0;\\nvar count : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var attributes : vec4<f32> = gWebGPUBuffer1.u_NodeAttributes[j];\\nvar clusterIdx : i32 = i32(attributes.x);\\nvar vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx = sumx + vertex.x;\\nsumy = sumy + vertex.y;\\ncount = count + 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4<f32>(sumx / count, sumy / count, count, i);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\n\\nlayout(std430, set = 0, binding = 0) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_NodeAttributes[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {int i = globalInvocationID.x;\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[i];\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = gWebGPUBuffer1.u_NodeAttributes[j];\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4(sumx / count, sumy / count, count, i);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var mC=function(n,r,o,s){function l(u){return u instanceof o?u:new o(function(h){h(u)})}return new(o||(o=Promise))(function(u,h){function p(b){try{v(s.next(b))}catch(w){h(w)}}function g(b){try{v(s.throw(b))}catch(w){h(w)}}function v(b){b.done?u(b.value):l(b.value).then(p,g)}v((s=s.apply(n,r||[])).next())})};class tD extends _s{constructor(r){super(),this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(r)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return mC(this,void 0,void 0,function*(){const r=this,o=r.nodes;if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const s=r.center;if(o.length===1){o[0].x=s[0],o[0].y=s[1],r.onLayoutEnd&&r.onLayoutEnd();return}const l={},u={};o.forEach((h,p)=>{En(h.x)||(h.x=Math.random()*this.width),En(h.y)||(h.y=Math.random()*this.height),l[h.id]=h,u[h.id]=p}),r.nodeMap=l,r.nodeIdxMap=u,yield r.run()})}executeWithWorker(r,o){return mC(this,void 0,void 0,function*(){const s=this,l=s.nodes,u=s.center;if(!l||l.length===0)return;if(l.length===1){l[0].x=u[0],l[0].y=u[1];return}const h={},p={};l.forEach((g,v)=>{En(g.x)||(g.x=Math.random()*this.width),En(g.y)||(g.y=Math.random()*this.height),h[g.id]=g,p[g.id]=v}),s.nodeMap=h,s.nodeIdxMap=p,yield s.run(r,o)})}run(r,o){return mC(this,void 0,void 0,function*(){const s=this,l=s.nodes,u=s.edges,h=s.maxIteration,p=s.center,g=s.height*s.width;let v=Math.sqrt(g)/10;const b=g/(l.length+1),w=Math.sqrt(b),A=s.speed,O=s.clustering,{array:D,count:_}=JO([s.clusterField],l);l.forEach((bt,jt)=>{let et=0,An=0;En(bt.fx)&&En(bt.fy)&&(et=bt.fx||.001,An=bt.fy||.001),D[4*jt+1]=et,D[4*jt+2]=An});const I=l.length,{maxEdgePerVetex:B,array:G}=KO(l,u),K=s.workerEnabled;let ve;K?ve=gC.create({canvas:r,engineOptions:{supportCompute:!0}}):ve=gC.create({engineOptions:{supportCompute:!0}});const ae=s.onLayoutEnd,Ye=[];for(let bt=0;bt<_;bt++)Ye.push(0,0,0,0);const rt=ve.createKernel(QO).setDispatch([I,1,1]).setBinding({u_Data:G,u_K:w,u_K2:b,u_Gravity:s.gravity,u_ClusterGravity:s.clusterGravity||s.gravity||1,u_Speed:A,u_MaxDisplace:v,u_Clustering:O?1:0,u_Center:p,u_AttributeArray:D,u_ClusterCenters:Ye,MAX_EDGE_PER_VERTEX:B,VERTEX_COUNT:I});let st;O&&(st=ve.createKernel(eD).setDispatch([_,1,1]).setBinding({u_Data:G,u_NodeAttributes:D,u_ClusterCenters:Ye,VERTEX_COUNT:I,CLUSTER_COUNT:_})),yield(()=>mC(this,void 0,void 0,function*(){for(let jt=0;jt<h;jt++)yield rt.execute(),O&&(st.setBinding({u_Data:rt}),yield st.execute(),rt.setBinding({u_ClusterCenters:st})),rt.setBinding({u_MaxDisplace:v*=.99});const bt=yield rt.getOutput();r?o.postMessage({type:Jn.GPUEND,vertexEdgeData:bt}):l.forEach((jt,et)=>{const An=bt[4*et],Vn=bt[4*et+1];jt.x=An,jt.y=Vn}),ae&&ae()}))()})}getType(){return"fruchterman-gpu"}}const Tk=null,nD='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_damping : f32;\\n  [[offset 4]] u_maxSpeed : f32;\\n  [[offset 8]] u_minMovement : f32;\\n  \\n  [[offset 12]] u_coulombDisScale : f32;\\n  [[offset 16]] u_factor : f32;\\n  \\n  \\n  [[offset 20]] u_interval : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray1 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\ntype GWebGPUBuffer3 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray2 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 4, set 0]] var<storage_buffer> gWebGPUBuffer3 : GWebGPUBuffer3;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn unpack_float(packedValue : f32) -> vec2<i32> {var packedIntValue : i32 = i32(packedValue);\\nvar v0 : i32 = packedIntValue / 1048576;\\nreturn vec2<i32>(v0, packedIntValue - (v0 * 1048576));}\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar vx : f32 = currentNode.x - nextNode.x;\\nvar vy : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar n_dist : f32 = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar attributesi : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar attributesj : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nvar massi : f32 = attributesi.x;\\nvar nodeStrengthi : f32 = attributesi.z;\\nvar nodeStrengthj : f32 = attributesj.z;\\nvar nodeStrength : f32 = (nodeStrengthi + nodeStrengthj) / 2.0;\\nvar param : f32 = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax = ax + direx * param;\\nay = ay + direy * param;}}\\nreturn vec2<f32>(ax, ay);}\\nfn calcGravity(i : i32, currentNode : vec4<f32>, attributes2 : vec4<f32>) -> vec2<f32> {var vx : f32 = currentNode.x - attributes2.x;\\nvar vy : f32 = currentNode.y - attributes2.y;\\nvar ax : f32 = vx * attributes2.z;\\nvar ay : f32 = vy * attributes2.z;\\nreturn vec2<f32>(ax, ay);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>, attributes1 : vec4<f32>) -> vec2<f32> {var mass : f32 = attributes1.x;\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nvar compressed : vec2<i32> = unpack_float(currentNode.z);\\nvar length : i32 = compressed.x;\\nvar arr_offset : i32 = compressed.y;\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + (4 * p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = node_buffer.x;\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar vx : f32 = nextNode.x - currentNode.x;\\nvar vy : f32 = nextNode.y - currentNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar edgeLength : f32 = node_buffer.y;\\nvar edgeStrength : f32 = node_buffer.z;\\nvar diff : f32 = edgeLength - dist;\\nvar param : f32 = (diff * edgeStrength) / mass;\\nax = ax - direx * param;\\nay = ay - direy * param;}\\nreturn vec2<f32>(ax, ay);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar movement : vec4<f32> = gWebGPUBuffer1.u_AveMovement[0];\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nif ((i >= __DefineValuePlaceholder__VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes1 : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar nodeAttributes2 : vec4<f32> = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\nax = ax + repulsive.x;\\nay = ay + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode, nodeAttributes1);\\nax = ax + attractive.x;\\nay = ay + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(i, currentNode, nodeAttributes2);\\nax = ax - gravity.x;\\nay = ay - gravity.y;\\nvar param : f32 = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nvar vx : f32 = ax * param;\\nvar vy : f32 = ay * param;\\nvar vlength : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {var param2 : f32 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nvar distx : f32 = vx * gWebGPUUniformParams.u_interval;\\nvar disty : f32 = vy * gWebGPUUniformParams.u_interval;\\nvar distLength : f32 = std::sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_damping;\\n  float u_maxSpeed;\\n  float u_minMovement;\\n  \\n  float u_coulombDisScale;\\n  float u_factor;\\n  \\n  \\n  float u_interval;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_NodeAttributeArray1[];\\n} gWebGPUBuffer2;\\n\\nlayout(std430, set = 0, binding = 4) buffer readonly  GWebGPUBuffer3 {\\n  vec4 u_NodeAttributeArray2[];\\n} gWebGPUBuffer3;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nivec2 unpack_float(float packedValue) {int packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {float ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 attributesj = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {float vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {float mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nvec4 movement = gWebGPUBuffer1.u_AveMovement[0];\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes1 = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 nodeAttributes2 = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {float param2 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * gWebGPUUniformParams.u_interval;\\nfloat disty = vy * gWebGPUUniformParams.u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {gl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',Mk=null,rD='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_iter : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var movement : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nmovement = movement + vertex.w;}\\nmovement = movement / f32(__DefineValuePlaceholder__VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4<f32>(movement, 0.0, 0.0, 0.0);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_iter;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {float movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = gWebGPUBuffer0.u_Data[j];\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4(movement, 0.0, 0.0, 0.0);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var aS=function(n,r,o,s){function l(u){return u instanceof o?u:new o(function(h){h(u)})}return new(o||(o=Promise))(function(u,h){function p(b){try{v(s.next(b))}catch(w){h(w)}}function g(b){try{v(s.throw(b))}catch(w){h(w)}}function v(b){b.done?u(b.value):l(b.value).then(p,g)}v((s=s.apply(n,r||[])).next())})};class iD extends _s{constructor(r){super(),this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(r)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return aS(this,void 0,void 0,function*(){const r=this,o=r.nodes;if(!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const s=r.center;if(o.length===1){o[0].x=s[0],o[0].y=s[1],r.onLayoutEnd&&r.onLayoutEnd();return}const l={},u={};o.forEach((h,p)=>{En(h.x)||(h.x=Math.random()*r.width),En(h.y)||(h.y=Math.random()*r.height),l[h.id]=h,u[h.id]=p}),r.nodeMap=l,r.nodeIdxMap=u,r.nodeStrength=S0(r.nodeStrength,1),r.edgeStrength=S0(r.edgeStrength,1),yield r.run()})}executeWithWorker(r,o){const s=this,l=s.nodes,u=s.center;if(!l||l.length===0)return;if(l.length===1){l[0].x=u[0],l[0].y=u[1];return}const h={},p={};l.forEach((g,v)=>{En(g.x)||(g.x=Math.random()*s.width),En(g.y)||(g.y=Math.random()*s.height),h[g.id]=g,p[g.id]=v}),s.nodeMap=h,s.nodeIdxMap=p,s.nodeStrength=S0(s.nodeStrength,1),s.edgeStrength=S0(s.edgeStrength,1),s.run(r,o)}run(r,o){return aS(this,void 0,void 0,function*(){const s=this,l=s.nodes,u=s.edges,h=s.maxIteration;!s.width&&typeof window<"u"&&(s.width=window.innerWidth),!s.height&&typeof window<"u"&&(s.height=window.innerHeight);const p=l.length;s.linkDistance=S0(s.linkDistance),s.edgeStrength=S0(s.edgeStrength);const{maxEdgePerVetex:g,array:v}=qO(l,u,s.linkDistance,s.edgeStrength);s.degrees=Nc(l.length,s.nodeIdxMap,u);const b=[],w=[],A=[],O=[],D=[],_=[],I=[];s.getMass||(s.getMass=et=>s.degrees[s.nodeIdxMap[et.id]]||1);const B=s.gravity,G=s.center;l.forEach((et,An)=>{b.push(s.getMass(et)),w.push(s.nodeStrength(et)),s.degrees[An]||(s.degrees[An]=0);let Vn=[G[0],G[1],B];if(s.getCenter){const Zn=s.getCenter(et,s.degrees[An]);Zn&&En(Zn[0])&&En(Zn[1])&&En(Zn[2])&&(Vn=Zn)}A.push(Vn[0]),O.push(Vn[1]),D.push(Vn[2]),En(et.fx)&&En(et.fy)?(_.push(et.fx||.001),I.push(et.fy||.001)):(_.push(0),I.push(0))});const K=_M([b,s.degrees,w,_]),ve=_M([A,O,D,I]),ae=s.workerEnabled;let Ye;ae?Ye=gC.create({canvas:r,engineOptions:{supportCompute:!0}}):Ye=gC.create({engineOptions:{supportCompute:!0}});const rt=s.onLayoutEnd,st=[];v.forEach(et=>{st.push(et)});for(let et=0;et<4;et++)st.push(0);const tn=Ye.createKernel(nD).setDispatch([p,1,1]).setBinding({u_Data:v,u_damping:s.damping,u_maxSpeed:s.maxSpeed,u_minMovement:s.minMovement,u_coulombDisScale:s.coulombDisScale,u_factor:s.factor,u_NodeAttributeArray1:K,u_NodeAttributeArray2:ve,MAX_EDGE_PER_VERTEX:g,VERTEX_COUNT:p,u_AveMovement:st,u_interval:s.interval}),bt=Ye.createKernel(rD).setDispatch([1,1,1]).setBinding({u_Data:v,VERTEX_COUNT:p,u_AveMovement:[0,0,0,0]});yield(()=>aS(this,void 0,void 0,function*(){for(let An=0;An<h;An++){yield tn.execute(),bt.setBinding({u_Data:tn}),yield bt.execute();const Vn=Math.max(.02,s.interval-An*.002);tn.setBinding({u_interval:Vn,u_AveMovement:bt})}const et=yield tn.getOutput();r?o.postMessage({type:Jn.GPUEND,vertexEdgeData:et}):l.forEach((An,Vn)=>{const Zn=et[4*Vn],wi=et[4*Vn+1];An.x=Zn,An.y=wi}),rt&&rt()}))()})}getType(){return"gForce-gpu"}}class oD extends _s{constructor(r){super(),this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(r)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const r=this,o=r.nodes,s=r.center;if(r.comboTree={id:"comboTreeRoot",depth:-1,children:r.comboTrees},!o||o.length===0){r.onLayoutEnd&&r.onLayoutEnd();return}if(o.length===1){o[0].x=s[0],o[0].y=s[1],r.onLayoutEnd&&r.onLayoutEnd();return}r.initVals(),r.run(),r.onLayoutEnd&&r.onLayoutEnd()}run(){const r=this,o=r.nodes,s=r.previousLayouted?r.maxIteration/5:r.maxIteration;!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight);const l=r.center,u=r.velocityDecay,h=r.comboMap;r.previousLayouted||r.initPos(h);for(let v=0;v<s;v++){const b=[];o.forEach((w,A)=>{b[A]={x:0,y:0}}),r.applyCalculate(b),r.applyComboCenterForce(b),o.forEach((w,A)=>{!En(w.x)||!En(w.y)||(w.x+=b[A].x*u,w.y+=b[A].y*u)}),r.alpha+=(r.alphaTarget-r.alpha)*r.alphaDecay,r.onTick()}const p=[0,0];o.forEach(v=>{!En(v.x)||!En(v.y)||(p[0]+=v.x,p[1]+=v.y)}),p[0]/=o.length,p[1]/=o.length;const g=[l[0]-p[0],l[1]-p[1]];o.forEach((v,b)=>{!En(v.x)||!En(v.y)||(v.x+=g[0],v.y+=g[1])}),r.combos.forEach(v=>{const b=h[v.id];b&&b.empty&&(v.x=b.cx||v.x,v.y=b.cy||v.y)}),r.previousLayouted=!0}initVals(){const r=this,o=r.edges,s=r.nodes,l=r.combos,u={},h={},p={};s.forEach((bt,jt)=>{h[bt.id]=bt,p[bt.id]=jt}),r.nodeMap=h,r.indexMap=p;const g={};l.forEach(bt=>{g[bt.id]=bt}),r.oriComboMap=g,r.comboMap=r.getComboMap();const v=r.preventOverlap;r.preventComboOverlap=r.preventComboOverlap||v,r.preventNodeOverlap=r.preventNodeOverlap||v;const b=r.collideStrength;b&&(r.comboCollideStrength=b,r.nodeCollideStrength=b),r.comboCollideStrength=r.comboCollideStrength?r.comboCollideStrength:0,r.nodeCollideStrength=r.nodeCollideStrength?r.nodeCollideStrength:0;for(let bt=0;bt<o.length;++bt){const jt=Kr(o[bt],"source"),et=Kr(o[bt],"target");u[jt]?u[jt]++:u[jt]=1,u[et]?u[et]++:u[et]=1}const w=[];for(let bt=0;bt<o.length;++bt){const jt=Kr(o[bt],"source"),et=Kr(o[bt],"target");w[bt]=u[jt]/(u[jt]+u[et])}this.bias=w;const A=r.nodeSize,O=r.nodeSpacing;let D,_;if(En(O)?_=()=>O:Sa(O)?_=O:_=()=>0,this.nodeSpacing=_,!A)D=bt=>bt.size?xs(bt.size)?(bt.size[0]>bt.size[1]?bt.size[0]:bt.size[1])/2:Ea(bt.size)?(bt.size.width>bt.size.height?bt.size.width:bt.size.height)/2:bt.size/2:10;else if(Sa(A))D=bt=>A(bt);else if(xs(A)){const jt=(A[0]>A[1]?A[0]:A[1])/2;D=et=>jt}else{const bt=A/2;D=jt=>bt}this.nodeSize=D;const I=r.comboSpacing;let B;En(I)?B=()=>I:Sa(I)?B=I:B=()=>0,this.comboSpacing=B;const G=r.comboPadding;let K;En(G)?K=()=>G:xs(G)?K=()=>Math.max.apply(null,G):Sa(G)?K=G:K=()=>0,this.comboPadding=K;let ve=this.linkDistance,ae;ve||(ve=10),En(ve)?ae=bt=>ve:ae=ve,this.linkDistance=ae;let Ye=this.edgeStrength,rt;Ye||(Ye=1),En(Ye)?rt=bt=>Ye:rt=Ye,this.edgeStrength=rt;let st=this.nodeStrength,tn;st||(st=30),En(st)?tn=bt=>st:tn=st,this.nodeStrength=tn}initPos(r){this.nodes.forEach((l,u)=>{const h=l.comboId,p=r[h];h&&p?(l.x=p.cx+100/(u+1),l.y=p.cy+100/(u+1)):(l.x=100/(u+1),l.y=100/(u+1))})}getComboMap(){const r=this,o=r.nodeMap,s=r.comboTrees,l=r.oriComboMap,u={};return(s||[]).forEach(h=>{const p=[];yu(h,g=>{if(g.itemType==="node"||!l[g.id])return!0;if(u[g.id]===void 0){const w={id:g.id,name:g.id,cx:0,cy:0,count:0,depth:r.oriComboMap[g.id].depth||0,children:[]};u[g.id]=w}const v=g.children;v&&v.forEach(w=>{if(!u[w.id]&&!o[w.id])return!0;p.push(w)});const b=u[g.id];if(b.cx=0,b.cy=0,p.length===0){b.empty=!0;const w=l[g.id];b.cx=w.x,b.cy=w.y}return p.forEach(w=>{if(b.count++,w.itemType!=="node"){const O=u[w.id];En(O.cx)&&(b.cx+=O.cx),En(O.cy)&&(b.cy+=O.cy);return}const A=o[w.id];!A||(En(A.x)&&(b.cx+=A.x),En(A.y)&&(b.cy+=A.y))}),b.cx/=b.count||1,b.cy/=b.count||1,b.children=p,!0})}),u}applyComboCenterForce(r){const o=this,s=o.gravity,l=o.comboGravity||s,u=this.alpha,h=o.comboTrees,p=o.indexMap,g=o.nodeMap,v=o.comboMap;(h||[]).forEach(b=>{yu(b,w=>{if(w.itemType==="node"||!v[w.id])return!0;const O=v[w.id],D=(O.depth+1)/10*.5,_=O.cx,I=O.cy;return O.cx=0,O.cy=0,O.children.forEach(B=>{if(B.itemType!=="node"){const st=v[B.id];st&&En(st.cx)&&(O.cx+=st.cx),st&&En(st.cy)&&(O.cy+=st.cy);return}const G=g[B.id],K=G.x-_||.005,ve=G.y-I||.005,ae=Math.sqrt(K*K+ve*ve),Ye=p[G.id],rt=l*u/ae*D;r[Ye].x-=K*rt,r[Ye].y-=ve*rt,En(G.x)&&(O.cx+=G.x),En(G.y)&&(O.cy+=G.y)}),O.cx/=O.count||1,O.cy/=O.count||1,!0})})}applyCalculate(r){const o=this,s=o.comboMap,l=o.nodes,u={};l.forEach((p,g)=>{l.forEach((v,b)=>{if(g<b)return;const w=p.x-v.x||.005,A=p.y-v.y||.005;let O=w*w+A*A;const D=Math.sqrt(O);O<1&&(O=D),u[`${p.id}-${v.id}`]={vx:w,vy:A,vl2:O,vl:D},u[`${v.id}-${p.id}`]={vl2:O,vl:D,vx:-w,vy:-A}})}),o.updateComboSizes(s),o.calRepulsive(r,u),o.calAttractive(r,u),o.preventComboOverlap&&o.comboNonOverlapping(r,s)}updateComboSizes(r){const o=this,s=o.comboTrees,l=o.nodeMap,u=o.nodeSize,h=o.comboSpacing,p=o.comboPadding;(s||[]).forEach(g=>{const v=[];yu(g,b=>{if(b.itemType==="node")return!0;const w=r[b.id];if(!w)return!1;const A=b.children;A&&A.forEach(_=>{!r[_.id]&&!l[_.id]||v.push(_)}),w.minX=1/0,w.minY=1/0,w.maxX=-1/0,w.maxY=-1/0,v.forEach(_=>{if(_.itemType!=="node")return!0;const I=l[_.id];if(!I)return!0;const B=u(I),G=I.x-B,K=I.y-B,ve=I.x+B,ae=I.y+B;w.minX>G&&(w.minX=G),w.minY>K&&(w.minY=K),w.maxX<ve&&(w.maxX=ve),w.maxY<ae&&(w.maxY=ae)});let O=o.oriComboMap[b.id].size||10;xs(O)&&(O=O[0]);const D=Math.max(w.maxX-w.minX,w.maxY-w.minY,O);return w.r=D/2+h(w)/2+p(w),!0})})}comboNonOverlapping(r,o){const s=this,l=s.comboTree,u=s.comboCollideStrength,h=s.indexMap,p=s.nodeMap;yu(l,g=>{if(!o[g.id]&&!p[g.id]&&g.id!=="comboTreeRoot")return!1;const v=g.children;return v&&v.length>1&&v.forEach((b,w)=>{if(b.itemType==="node")return!1;const A=o[b.id];!A||v.forEach((O,D)=>{if(w<=D||O.itemType==="node")return!1;const _=o[O.id];if(!_)return!1;const I=A.cx-_.cx||.005,B=A.cy-_.cy||.005,G=I*I+B*B,K=A.r||1,ve=_.r||1,ae=K+ve,Ye=ve*ve,rt=K*K;if(G<ae*ae){const st=b.children;if(!st||st.length===0)return!1;const tn=O.children;if(!tn||tn.length===0)return!1;const bt=Math.sqrt(G),jt=(ae-bt)/bt*u,et=I*jt,An=B*jt,Vn=Ye/(rt+Ye),Zn=1-Vn;st.forEach(wi=>{if(wi.itemType!=="node")return!1;if(!p[wi.id])return;const Ei=h[wi.id];tn.forEach(Dr=>{if(Dr.itemType!=="node"||!p[Dr.id])return!1;const eo=h[Dr.id];r[Ei].x+=et*Vn,r[Ei].y+=An*Vn,r[eo].x-=et*Zn,r[eo].y-=An*Zn})})}})}),!0})}calRepulsive(r,o){const s=this,l=s.nodes,u=s.width*s.optimizeRangeFactor,h=s.nodeStrength,p=s.alpha,g=s.nodeCollideStrength,v=s.preventNodeOverlap,b=s.nodeSize,w=s.nodeSpacing,A=s.depthRepulsiveForceScale,O=s.center;l.forEach((D,_)=>{if(!(!D.x||!D.y)){if(O){const I=s.gravity,B=D.x-O[0]||.005,G=D.y-O[1]||.005,K=Math.sqrt(B*B+G*G);r[_].x-=B*I*p/K,r[_].y-=G*I*p/K}l.forEach((I,B)=>{if(_===B||!I.x||!I.y)return;const{vl2:G,vl:K}=o[`${D.id}-${I.id}`];if(K>u)return;const{vx:ve,vy:ae}=o[`${D.id}-${I.id}`];let Ye=Math.log(Math.abs(I.depth-D.depth)/10)+1||1;Ye=Ye<1?1:Ye,I.comboId!==D.comboId&&(Ye+=1);const rt=Ye?Math.pow(A,Ye):1,st=h(I)*p/G*rt;if(r[_].x+=ve*st,r[_].y+=ae*st,_<B&&v){const tn=b(D)+w(D)||1,bt=b(I)+w(I)||1,jt=tn+bt;if(G<jt*jt){const et=(jt-K)/K*g,An=bt*bt;let Vn=An/(tn*tn+An);const Zn=ve*et,wi=ae*et;r[_].x+=Zn*Vn,r[_].y+=wi*Vn,Vn=1-Vn,r[B].x-=Zn*Vn,r[B].y-=wi*Vn}}})}})}calAttractive(r,o){const s=this,l=s.edges,u=s.linkDistance,h=s.alpha,p=s.edgeStrength,g=s.bias,v=s.depthAttractiveForceScale;l.forEach((b,w)=>{const A=Kr(b,"source"),O=Kr(b,"target");if(!A||!O||A===O)return;const D=s.indexMap[A],_=s.indexMap[O],I=s.nodeMap[A],B=s.nodeMap[O];if(!I||!B)return;let G=I.depth===B.depth?0:Math.log(Math.abs(I.depth-B.depth)/10);I.comboId===B.comboId&&(G=G/2);let K=G?Math.pow(v,G):1;if(I.comboId!==B.comboId&&K===1?K=v/2:I.comboId===B.comboId&&(K=2),!En(B.x)||!En(I.x)||!En(B.y)||!En(I.y))return;const{vl:ve,vx:ae,vy:Ye}=o[`${O}-${A}`],rt=(ve-u(b))/ve*h*p(b)*K,st=ae*rt,tn=Ye*rt,bt=g[w];r[_].x-=st*bt,r[_].y-=tn*bt,r[D].x+=st*(1-bt),r[D].y+=tn*(1-bt)})}getType(){return"comboForce"}}class lS{constructor(r){this.id=r.id||0,this.rx=r.rx,this.ry=r.ry,this.fx=0,this.fy=0,this.mass=r.mass,this.degree=r.degree,this.g=r.g||0}distanceTo(r){const o=this.rx-r.rx,s=this.ry-r.ry;return Math.hypot(o,s)}setPos(r,o){this.rx=r,this.ry=o}resetForce(){this.fx=0,this.fy=0}addForce(r){const o=r.rx-this.rx,s=r.ry-this.ry;let l=Math.hypot(o,s);l=l<1e-4?1e-4:l;const u=this.g*(this.degree+1)*(r.degree+1)/l;this.fx+=u*o/l,this.fy+=u*s/l}in(r){return r.contains(this.rx,this.ry)}add(r){const o=this.mass+r.mass,s=(this.rx*this.mass+r.rx*r.mass)/o,l=(this.ry*this.mass+r.ry*r.mass)/o,u=this.degree+r.degree,h={rx:s,ry:l,mass:o,degree:u};return new lS(h)}}class A0{constructor(r){this.xmid=r.xmid,this.ymid=r.ymid,this.length=r.length,this.massCenter=r.massCenter||[0,0],this.mass=r.mass||1}getLength(){return this.length}contains(r,o){const s=this.length/2;return r<=this.xmid+s&&r>=this.xmid-s&&o<=this.ymid+s&&o>=this.ymid-s}NW(){const r=this.xmid-this.length/4,o=this.ymid+this.length/4,s=this.length/2,l={xmid:r,ymid:o,length:s};return new A0(l)}NE(){const r=this.xmid+this.length/4,o=this.ymid+this.length/4,s=this.length/2,l={xmid:r,ymid:o,length:s};return new A0(l)}SW(){const r=this.xmid-this.length/4,o=this.ymid-this.length/4,s=this.length/2,l={xmid:r,ymid:o,length:s};return new A0(l)}SE(){const r=this.xmid+this.length/4,o=this.ymid-this.length/4,s=this.length/2,l={xmid:r,ymid:o,length:s};return new A0(l)}}class T0{constructor(r){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,r!=null&&(this.quad=r)}insert(r){if(this.body==null){this.body=r;return}this._isExternal()?(this.quad&&(this.NW=new T0(this.quad.NW()),this.NE=new T0(this.quad.NE()),this.SW=new T0(this.quad.SW()),this.SE=new T0(this.quad.SE())),this._putBody(this.body),this._putBody(r),this.body=this.body.add(r)):(this.body=this.body.add(r),this._putBody(r))}_putBody(r){!this.quad||(r.in(this.quad.NW())&&this.NW?this.NW.insert(r):r.in(this.quad.NE())&&this.NE?this.NE.insert(r):r.in(this.quad.SW())&&this.SW?this.SW.insert(r):r.in(this.quad.SE())&&this.SE&&this.SE.insert(r))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(r){if(!(this.body==null||r===this.body))if(this._isExternal())r.addForce(this.body);else{const o=this.quad?this.quad.getLength():0,s=this.body.distanceTo(r);o/s<this.theta?r.addForce(this.body):(this.NW&&this.NW.updateForce(r),this.NE&&this.NE.updateForce(r),this.SW&&this.SW.updateForce(r),this.SE&&this.SE.updateForce(r))}}}class sD extends _s{constructor(r){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(r)}getDefaultCfg(){return{}}execute(){const r=this,{nodes:o,onLayoutEnd:s,prune:l}=r;let u=r.maxIteration;!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight);const h=[],p=o.length;for(let g=0;g<p;g+=1){const v=o[g];let b=10,w=10;En(v.size)&&(b=v.size,w=v.size),xs(v.size)?(isNaN(v.size[0])||(b=v.size[0]),isNaN(v.size[1])||(w=v.size[1])):Ea(v.size)&&(b=v.size.width,w=v.size.height),r.getWidth&&!isNaN(r.getWidth(v))&&(w=r.getWidth(v)),r.getHeight&&!isNaN(r.getHeight(v))&&(b=r.getHeight(v));const A=Math.max(b,w);h.push(A)}r.barnesHut===void 0&&p>250&&(r.barnesHut=!0),r.prune===void 0&&p>100&&(r.prune=!0),this.maxIteration===0&&!r.prune?(u=250,p<=200&&p>100?u=1e3:p>200&&(u=1200),this.maxIteration=u):this.maxIteration===0&&l&&(u=100,p<=200&&p>100?u=500:p>200&&(u=950),this.maxIteration=u),r.kr||(r.kr=50,p>100&&p<=500?r.kr=20:p>500&&(r.kr=1)),r.kg||(r.kg=20,p>100&&p<=500?r.kg=10:p>500&&(r.kg=1)),this.nodes=r.updateNodesByForces(h),s()}updateNodesByForces(r){const o=this,{edges:s,maxIteration:l}=o;let u=o.nodes;const h=s.filter(D=>{const _=Kr(D,"source"),I=Kr(D,"target");return _!==I}),p=u.length,g=h.length,v=[],b={},w={},A=[];for(let D=0;D<p;D+=1)b[u[D].id]=D,v[D]=0,(u[D].x===void 0||isNaN(u[D].x))&&(u[D].x=Math.random()*1e3),(u[D].y===void 0||isNaN(u[D].y))&&(u[D].y=Math.random()*1e3),A.push({x:u[D].x,y:u[D].y});for(let D=0;D<g;D+=1){let _,I,B=0,G=0;for(let K=0;K<p;K+=1){const ve=Kr(h[D],"source"),ae=Kr(h[D],"target");u[K].id===ve?(_=u[K],B=K):u[K].id===ae&&(I=u[K],G=K),w[D]={sourceIdx:B,targetIdx:G}}_&&(v[b[_.id]]+=1),I&&(v[b[I.id]]+=1)}let O=l;if(u=this.iterate(O,b,w,g,v,r),o.prune){for(let D=0;D<g;D+=1)v[w[D].sourceIdx]<=1?(u[w[D].sourceIdx].x=u[w[D].targetIdx].x,u[w[D].sourceIdx].y=u[w[D].targetIdx].y):v[w[D].targetIdx]<=1&&(u[w[D].targetIdx].x=u[w[D].sourceIdx].x,u[w[D].targetIdx].y=u[w[D].sourceIdx].y);o.prune=!1,o.barnesHut=!1,O=100,u=this.iterate(O,b,w,g,v,r)}return u}iterate(r,o,s,l,u,h){const p=this;let{nodes:g}=p;const{kr:v,preventOverlap:b}=p,{barnesHut:w}=p,A=g.length;let O=0;const D=100;let _=r;const I=50;let B=[];const G=[],K=[];for(let ve=0;ve<A;ve+=1)if(B[2*ve]=0,B[2*ve+1]=0,w){const ae={id:ve,rx:g[ve].x,ry:g[ve].y,mass:1,g:v,degree:u[ve]};K[ve]=new lS(ae)}for(;_>0;){for(let ae=0;ae<A;ae+=1)G[2*ae]=B[2*ae],G[2*ae+1]=B[2*ae+1],B[2*ae]=0,B[2*ae+1]=0;B=this.getAttrForces(_,I,l,o,s,u,h,B),w&&(b&&_>I||!b)?B=this.getOptRepGraForces(B,K,u):B=this.getRepGraForces(_,I,B,D,h,u);const ve=this.updatePos(B,G,O,u);g=ve.nodes,O=ve.sg,_--,p.tick&&p.tick()}return g}getAttrForces(r,o,s,l,u,h,p,g){const v=this,{nodes:b,preventOverlap:w,dissuadeHubs:A,mode:O,prune:D}=v;for(let _=0;_<s;_+=1){const I=b[u[_].sourceIdx],B=u[_].sourceIdx,G=b[u[_].targetIdx],K=u[_].targetIdx;if(D&&(h[B]<=1||h[K]<=1))continue;const ve=[G.x-I.x,G.y-I.y];let ae=Math.hypot(ve[0],ve[1]);ae=ae<1e-4?1e-4:ae,ve[0]=ve[0]/ae,ve[1]=ve[1]/ae,w&&r<o&&(ae=ae-p[B]-p[K]);let Ye=ae,rt=Ye;O==="linlog"&&(Ye=Math.log(1+ae),rt=Ye),A&&(Ye=ae/h[B],rt=ae/h[K]),w&&r<o&&ae<=0?(Ye=0,rt=0):w&&r<o&&ae>0&&(Ye=ae,rt=ae),g[2*l[I.id]]+=Ye*ve[0],g[2*l[G.id]]-=rt*ve[0],g[2*l[I.id]+1]+=Ye*ve[1],g[2*l[G.id]+1]-=rt*ve[1]}return g}getRepGraForces(r,o,s,l,u,h){const p=this,{nodes:g,preventOverlap:v,kr:b,kg:w,center:A,prune:O}=p,D=g.length;for(let _=0;_<D;_+=1){for(let K=_+1;K<D;K+=1){if(O&&(h[_]<=1||h[K]<=1))continue;const ve=[g[K].x-g[_].x,g[K].y-g[_].y];let ae=Math.hypot(ve[0],ve[1]);ae=ae<1e-4?1e-4:ae,ve[0]=ve[0]/ae,ve[1]=ve[1]/ae,v&&r<o&&(ae=ae-u[_]-u[K]);let Ye=b*(h[_]+1)*(h[K]+1)/ae;v&&r<o&&ae<0?Ye=l*(h[_]+1)*(h[K]+1):v&&r<o&&ae===0?Ye=0:v&&r<o&&ae>0&&(Ye=b*(h[_]+1)*(h[K]+1)/ae),s[2*_]-=Ye*ve[0],s[2*K]+=Ye*ve[0],s[2*_+1]-=Ye*ve[1],s[2*K+1]+=Ye*ve[1]}const I=[g[_].x-A[0],g[_].y-A[1]],B=Math.hypot(I[0],I[1]);I[0]=I[0]/B,I[1]=I[1]/B;const G=w*(h[_]+1);s[2*_]-=G*I[0],s[2*_+1]-=G*I[1]}return s}getOptRepGraForces(r,o,s){const l=this,{nodes:u,kg:h,center:p,prune:g}=l,v=u.length;let b=9e10,w=-9e10,A=9e10,O=-9e10;for(let G=0;G<v;G+=1)g&&s[G]<=1||(o[G].setPos(u[G].x,u[G].y),u[G].x>=w&&(w=u[G].x),u[G].x<=b&&(b=u[G].x),u[G].y>=O&&(O=u[G].y),u[G].y<=A&&(A=u[G].y));const D=Math.max(w-b,O-A),_={xmid:(w+b)/2,ymid:(O+A)/2,length:D,massCenter:p,mass:v},I=new A0(_),B=new T0(I);for(let G=0;G<v;G+=1)g&&s[G]<=1||o[G].in(I)&&B.insert(o[G]);for(let G=0;G<v;G+=1){if(g&&s[G]<=1)continue;o[G].resetForce(),B.updateForce(o[G]),r[2*G]-=o[G].fx,r[2*G+1]-=o[G].fy;const K=[u[G].x-p[0],u[G].y-p[1]];let ve=Math.hypot(K[0],K[1]);ve=ve<1e-4?1e-4:ve,K[0]=K[0]/ve,K[1]=K[1]/ve;const ae=h*(s[G]+1);r[2*G]-=ae*K[0],r[2*G+1]-=ae*K[1]}return r}updatePos(r,o,s,l){const u=this,{nodes:h,ks:p,tao:g,prune:v,ksmax:b}=u,w=h.length,A=[],O=[];let D=0,_=0;for(let B=0;B<w;B+=1){if(v&&l[B]<=1)continue;const G=[r[2*B]-o[2*B],r[2*B+1]-o[2*B+1]],K=Math.hypot(G[0],G[1]),ve=[r[2*B]+o[2*B],r[2*B+1]+o[2*B+1]],ae=Math.hypot(ve[0],ve[1]);A[B]=K,O[B]=ae/2,D+=(l[B]+1)*A[B],_+=(l[B]+1)*O[B]}const I=s;s=g*_/D,I!==0&&(s=s>1.5*I?1.5*I:s);for(let B=0;B<w;B+=1){if(v&&l[B]<=1)continue;let G=p*s/(1+s*Math.sqrt(A[B])),K=Math.hypot(r[2*B],r[2*B+1]);K=K<1e-4?1e-4:K;const ve=b/K;G=G>ve?ve:G;const ae=G*r[2*B],Ye=G*r[2*B+1];h[B].x+=ae,h[B].y+=Ye}return{nodes:h,sg:s}}}class Kh{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(r,o,s){this.cells=[],this.CELL_W=s.CELL_W||Kh.DEFAULT_CELL_W,this.CELL_H=s.CELL_H||Kh.DEFAULT_CELL_H,this.columnNum=Math.ceil(r/this.CELL_W),this.rowNum=Math.ceil(o/this.CELL_H),Kh.MIN_DIST=Math.pow(r,2)+Math.pow(o,2);for(let l=0;l<this.columnNum;l++){const u=[];for(let h=0;h<this.rowNum;h++){const p={dx:l,dy:h,x:l*this.CELL_W,y:h*this.CELL_H,occupied:!1};u.push(p)}this.cells.push(u)}}findGridByNodeId(r){var o,s;for(let l=0;l<this.columnNum;l++)for(let u=0;u<this.rowNum;u++)if(this.cells[l][u].node&&((s=(o=this.cells[l][u])===null||o===void 0?void 0:o.node)===null||s===void 0?void 0:s.id)===r)return{column:l,row:u};return null}sqdist(r,o){return Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)}occupyNearest(r){let o=Kh.MIN_DIST,s,l=null;for(let u=0;u<this.columnNum;u++)for(let h=0;h<this.rowNum;h++)!this.cells[u][h].occupied&&(s=this.sqdist(r,this.cells[u][h]))<o&&(o=s,l=this.cells[u][h]);return l&&(l.occupied=!0),l}insertColumn(r,o){if(!(o<=0)){for(let s=0;s<o;s++){this.cells[s+this.columnNum]=[];for(let l=0;l<this.rowNum;l++)this.cells[s+this.columnNum][l]={dx:s,dy:l,x:s*this.CELL_W,y:l*this.CELL_H,occupied:!1,node:null}}for(let s=this.columnNum-1;s>r;s--)for(let l=0;l<this.rowNum;l++)this.cells[s+o][l]=Object.assign(Object.assign({},this.cells[s][l]),{x:(s+o)*this.CELL_W,y:l*this.CELL_H}),this.cells[s][l]={x:s*this.CELL_W,y:l*this.CELL_H,occupied:!0,node:null};for(let s=0;s<this.additionColumn.length;s++)this.additionColumn[s]>=r&&(this.additionColumn[s]+=o);for(let s=0;s<o;s++)this.additionColumn.push(r+s+1);this.columnNum+=o}}insertRow(r,o){if(!(o<=0)){for(let s=0;s<o;s++)for(let l=0;l<this.columnNum;l++)this.cells[l][s+this.rowNum]={dx:l,dy:s,x:l*this.CELL_W,y:s*this.CELL_H,occupied:!1,node:null};for(let s=0;s<this.columnNum;s++)for(let l=this.rowNum-1;l>r;l--)this.cells[s][l+o]=Object.assign(Object.assign({},this.cells[s][l]),{dx:s,dy:l+o,x:s*this.CELL_W,y:(l+o)*this.CELL_H}),this.cells[s][l]={dx:s,dy:l,x:s*this.CELL_W,y:l*this.CELL_H,occupied:!1,node:null};for(let s=0;s<this.additionRow.length;s++)this.additionRow[s]>=r&&(this.additionRow[s]+=o);for(let s=0;s<o;s++)this.additionRow.push(r+s+1);this.rowNum+=o}}getNodes(){const r=[];for(let o=0;o<this.columnNum;o++)for(let s=0;s<this.rowNum;s++)this.cells[o][s].node&&r.push(this.cells[o][s]);return r}}Kh.MIN_DIST=50,Kh.DEFAULT_CELL_W=80,Kh.DEFAULT_CELL_H=80;function aD(n,r){if(!n.nodes||n.nodes.length===0)return n;const o=r.width,s=r.height,l=r.nodeMinGap;let u=1e4,h=1e4;n.nodes.forEach(g=>{const v=g.size[0]||50,b=g.size[1]||50;u=Math.min(v,u),h=Math.min(b,h)});const p=new Kh;p.init(o,s,{CELL_H:h,CELL_W:u}),n.nodes.forEach(g=>{const v=p.occupyNearest(g);v&&(v.node={id:g.id,size:g.size},g.x=v.x,g.y=v.y,g.dx=v.dx,g.dy=v.dy)});for(let g=0;g<n.nodes.length;g++){const v=n.nodes[g],b=p.findGridByNodeId(v.id);if(!b)throw new Error("can not find node cell");const{column:w,row:A}=b;if(v.size[0]+l>u){const O=Math.ceil((v.size[0]+l)/u)-1;let D=O;for(let _=0;_<O&&(p.additionColumn.indexOf(w+_+1)>-1&&!p.cells[w+_+1][A].node);_++)D--;p.insertColumn(w,D)}if(v.size[1]+l>h){const O=Math.ceil((v.size[1]+l)/h)-1;let D=O;for(let _=0;_<O&&(p.additionRow.indexOf(A+_+1)>-1&&!p.cells[w][A+_+1].node);_++)D--;p.insertRow(A,D)}}for(let g=0;g<p.columnNum;g++)for(let v=0;v<p.rowNum;v++){const b=p.cells[g][v];if(b.node){const w=n.nodes.find(A=>{var O;return A.id===((O=b==null?void 0:b.node)===null||O===void 0?void 0:O.id)});w&&(w.x=b.x+w.size[0]/2,w.y=b.y+w.size[1]/2)}}}const NM=1200,kM=800,vC=1e7,Ly=10,RM=3.141592653589793,cS=1.5707963267948966,lD=RM*.375,cD=RM*.625,yC=new Map,uD=10,dD=10;let uS=.8;const IM=.1,hD=.5;function fD(n,r,o){const s=n.x-n.size[0]/2,l=n.y-n.size[1]/2,u=n.x+n.size[0]/2,h=n.y+n.size[1]/2,p=r.x-r.size[0]/2,g=r.y-r.size[1]/2,v=r.x+r.size[0]/2,b=r.y+r.size[1]/2,w=n.x,A=n.y,O=r.x,D=r.y,_=O-w,I=Math.atan2(_,D-A);let B=0,G=0,K=0,ve=0;I>cS?(G=l-b,B=p-u,K=parseFloat(G?(G/Math.cos(I)).toFixed(2):B.toFixed(2)),ve=parseFloat(B?(B/Math.sin(I)).toFixed(2):G.toFixed(2))):0<I&&I<=cS?(G=g-h,B=p-u,G>B?K=ve=parseFloat(G?(G/Math.cos(I)).toFixed(2):B.toFixed(2)):K=ve=parseFloat(B?(B/Math.sin(I)).toFixed(2):G.toFixed(2))):I<-cS?(G=l-b,B=-(v-s),G>B?K=ve=parseFloat(G?(G/Math.cos(I)).toFixed(2):B.toFixed(2)):K=ve=parseFloat(B?(B/Math.sin(I)).toFixed(2):G.toFixed(2))):(G=g-h,Math.abs(_)>(u-s)/2?B=s-v:B=_,G>B?K=ve=parseFloat(G?(G/Math.cos(I)).toFixed(2):B.toFixed(2)):K=ve=parseFloat(B&&I!==0?(B/Math.sin(I)).toFixed(2):G.toFixed(2)));const ae=parseFloat(I.toFixed(2));let Ye=o;return o&&(Ye=lD<ae&&ae<cD),{distance:Math.abs(K<ve?K:ve),isHoriz:Ye}}function LM(n,r){const s=(yC.get(n.id)||[]).find(rt=>rt.source===r.id||rt.target===r.id),l=n.size[0]*n.size[1],u=r.size[0]*r.size[1],h=l>u?r:n,p=l>u?n:r,g=h.x-h.size[0]/2,v=h.y-h.size[1]/2,b=h.x+h.size[0]/2,w=h.y+h.size[1]/2,A=p.x-p.size[0]/2,O=p.y-p.size[1]/2,D=p.x+p.size[0]/2,_=p.y+p.size[1]/2,I=h.x,B=h.y,G=p.x,K=p.y,ve=b>=A&&D>=g&&w>=O&&_>=v;let ae=0,Ye=0;if(ve){Ye=Math.sqrt(Math.pow(G-I,2)+Math.pow(K-B,2));const rt=g>A?g:A,st=v>O?v:O,tn=b<D?b:D,bt=w<_?w:_,jt=tn-rt,et=bt-st,An=jt*et;Ye===0&&(Ye=1e-7),ae=Ly*1/Ye*100+An,ae*=vC}else{let rt=!1;const st=fD(h,p,rt);Ye=st.distance,rt=st.isHoriz,Ye<=Ly?Ye!==0?s?ae+=Ly+vC*1/Ye:ae+=Ly+vC*Ly/Ye:ae+=vC:(ae+=Ye,s&&(ae+=Ye*Ye))}return ae}function FM(n){let r=0;for(let o=0;o<n.length;o++){const s=n[o];(s.x<0||s.y<0||s.x>NM||s.y>kM)&&(r+=1e12);for(let l=o+1;l<n.length;l++)r+=LM(s,n[l])}return r}function pD(n,r,o,s){const l=new Map;o.forEach((g,v)=>{l.set(g.id,g)});const u=s.filter(g=>g.source===n.id||g.target===n.id)||[],h=[];u.forEach(g=>{const v=g.source===n.id?g.target:g.source,b=l.get(v);b&&h.push(b)});let p=!0;for(let g=0;g<h.length;g++){const v=h[g],b=Math.atan((n.y-v.y)/(v.x-n.y))*180,w=Math.atan((r.y-v.y)/(v.x-r.y))*180,A=b<30||b>150,O=w<30||w>150,D=b>70&&b<110,_=w>70&&w<110;if(A&&!O||b*w<0){p=!1;break}else if(D&&!_||b*w<0){p=!1;break}else if((v.x-n.x)*(v.x-r.x)<0){p=!1;break}else if((v.y-n.y)*(v.y-r.y)<0){p=!1;break}}return p}function gD(n,r){let o=!1;const s=1,l=uD*s,u=dD*s,h=[l,-l,0,0],p=[0,0,u,-u];for(let g=0;g<n.length;++g){const v=n[g];let b=GM(v,n);for(let w=0;w<h.length;w++)if(pD(v,{x:v.x+h[w],y:v.y+p[w]},n,r)){v.x+=h[w],v.y+=p[w];const O=GM(v,n),D=Math.random();O<b||D<uS&&D>IM?(b=O,o=!0):(v.x-=h[w],v.y-=p[w])}}return uS>IM&&(uS*=hD),o?FM(n):0}function GM(n,r){let o=0;(n.x<0||n.y<0||n.x+n.size[0]+20>NM||n.y+n.size[1]+20>kM)&&(o+=1e12);for(let s=0;s<r.length;++s)n.id!==r[s].id&&(o+=LM(n,r[s]));return o}function mD(n,r){if(n.length===0)return{nodes:n,edges:r};n.forEach(g=>{const v=r.filter(b=>b.source===g.id||b.target===g.id);yC.set(g,v)}),n.sort((g,v)=>{var b,w;return((b=yC.get(g.id))===null||b===void 0?void 0:b.length)-((w=yC.get(v.id))===null||w===void 0?void 0:w.length)});let o=FM(n),s=20,l=1,u=0;const h=50;let p=0;for(;s>0&&(p++,!(p>=h));){const g=gD(n,r);g!==0&&(u=g),l=u-o,o=u,l===0?--s:s=20}return n.forEach(g=>{g.x=g.x-g.size[0]/2,g.y=g.y-g.size[1]/2}),{nodes:n,edges:r}}var vD=mD;function yD(n,r){const{nodes:o,edges:s}=n,l=r.width,u=r.height;if(!(o!=null&&o.length))return Promise.resolve();const h=[];o.forEach(D=>{if(s.filter(I=>I.source===D.id||I.target===D.id).length>1){const I=Object.assign({},D);delete I.size,h.push(I)}});const p=[];s.forEach(D=>{const _=h.find(B=>B.id===D.source),I=h.find(B=>B.id===D.target);_&&I&&p.push(D)});const g=new Ub({type:"dagre",ranksep:r.nodeMinGap,nodesep:r.nodeMinGap}),{nodes:v}=g.layout({nodes:h,edges:p});o.forEach(D=>{const _=(v||[]).find(I=>I.id===D.id);D.x=(_==null?void 0:_.x)||l/2,D.y=(_==null?void 0:_.y)||u/2});const b=JSON.parse(JSON.stringify(o)),w=JSON.parse(JSON.stringify(s)),A=mn().nodes(b).force("link",Nt(w).id(D=>D.id).distance(D=>p.find(I=>I.source===D.source&&I.target===D.target)?30:20)).force("charge",Dt()).force("center",Cn(l/2,u/2)).force("x",pn(l/2)).force("y",en(u/2)).alpha(.3).alphaDecay(.08).alphaMin(.001);return new Promise(D=>{A.on("end",()=>{o.forEach(ae=>{const Ye=b.find(rt=>rt.id===ae.id);Ye&&(ae.x=Ye.x,ae.y=Ye.y)});const _=Math.min(...o.map(ae=>ae.x)),I=Math.max(...o.map(ae=>ae.x)),B=Math.min(...o.map(ae=>ae.y)),G=Math.max(...o.map(ae=>ae.y)),K=l/(I-_),ve=u/(G-B);o.forEach(ae=>{ae.x!==void 0&&K<1&&(ae.x=(ae.x-_)*K),ae.y!==void 0&&ve<1&&(ae.y=(ae.y-B)*ve)}),o.forEach(ae=>{ae.sizeTemp=ae.size,ae.size=[10,10]}),vD(o,s),o.forEach(ae=>{ae.size=ae.sizeTemp||[],delete ae.sizeTemp}),aD({nodes:o,edges:s},r),D()})})}class bD extends _s{constructor(r){super(),this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},r&&this.updateCfg(r)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const r=this,o=r.nodes,s=r.edges;return o==null||o.forEach(l=>{l.size||(l.size=[50,50])}),yD({nodes:o,edges:s},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(()=>{r.onLayoutEnd&&r.onLayoutEnd()})}getType(){return"er"}}class xD extends _s{constructor(r){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(r)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const r=this,o=r.nodes,s=.9,l=r.center;return!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),o&&o.forEach(u=>{u.x=(Math.random()-.5)*s*r.width+l[0],u.y=(Math.random()-.5)*s*r.height+l[1]}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:this.edges}}getType(){return"random"}}class Pk{constructor(r){const o=getLayoutByName(r.type);this.layoutInstance=new o(r)}layout(r){return this.layoutInstance.layout(r)}updateCfg(r){this.layoutInstance.updateCfg(r)}init(r){this.layoutInstance.init(r)}execute(){this.layoutInstance.execute()}getDefaultCfg(){return this.layoutInstance.getDefaultCfg()}destroy(){return this.layoutInstance.destroy()}}const CD={force:Ar,fruchterman:ww,forceAtlas2:sD,gForce:fm,dagre:Ub,circular:To,radial:Tv,concentric:Mv,grid:wh,mds:Qb,comboForce:oD,random:xD,"gForce-gpu":iD,"fruchterman-gpu":tD,er:bD};var bC;(function(n){n.command=rr.GRAPH_LAYOUT,n.hookKey="graphLayout"})(bC||(bC={}));let Fy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().graphLayout.call(r,u=>Ee(this,void 0,void 0,function*(){const{layoutType:h,layoutOptions:p,customLayout:g}=u;return yield(g||(w=>{const A=CD[h];return new A(Object.assign({},p)).layout(w)}))(u.graphData),{graphData:u.graphData}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Fy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Fy.prototype,"init",null),Fy=vt([nn({token:{token:jr,named:bC.command.id}})],Fy);var xC;(function(n){function r(s,l){return(0,wc.isEqual)(s,l)}n.isNodeEqual=r;function o(s,l){return(0,wc.isEqual)(s,l)}n.isEdgeEqual=o})(xC||(xC={}));var CC;(function(n){n.command=rr.GRAPH_RENDER,n.hookKey="graphRender"})(CC||(CC={}));let Gy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().graphRender.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),p=yield this.ctx.getGraphMeta(),{beforeRender:g,graphData:v,isNodeEqual:b,isEdgeEqual:w,afterRender:A}=u;return g&&g(p),yield this.doLoadGraph(h,v,b,w),A&&A(v,p),{}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this}),this.doLoadGraph=(r,o,s,l)=>Ee(this,void 0,void 0,function*(){r!=null&&r.isFrozen()||r==null||r.freeze();const u=this.ctx.getCommands(),{addNodeConfigs:h,addEdgeConfigs:p,removeNodes:g,removeEdges:v,updateNodes:b,updateEdges:w}=this.graphDataDiff(r,o,s,l);for(const A of b){const O=A==null?void 0:A.getData();yield u.executeCommand(di.UPDATE_NODE.id,{nodeConfig:O})}for(const A of w){const O=A==null?void 0:A.getData();yield u.executeCommand(zi.UPDATE_EDGE.id,{edgeConfig:O})}for(const A of h)yield u.executeCommand(di.ADD_NODE.id,{nodeConfig:A,options:{isRenderGraph:!0}},{name:"remove servcie",handler:O=>Ee(this,void 0,void 0,function*(){delete O.createNodeService})});yield u.executeCommand(to.INIT_GROUP.id,{graphData:{nodes:h,edges:[]}});for(const A of p)yield u.executeCommand(zi.ADD_EDGE.id,{edgeConfig:A,options:{isRenderGraph:!0}},{name:"remove servcie",handler:O=>Ee(this,void 0,void 0,function*(){delete O.createEdgeService})});for(const A of g){const O=A==null?void 0:A.getData();O.isGroup?yield u.executeCommand(to.DEL_GROUP.id,{nodeConfig:O}):yield u.executeCommand(di.DEL_NODE.id,{nodeConfig:O})}for(const A of v){const O=A==null?void 0:A.getData();yield u.executeCommand(zi.DEL_EDGE.id,{edgeConfig:O})}r!=null&&r.isFrozen()&&(r==null||r.unfreeze())})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}graphDataDiff(r,o,s,l){const{nodes:u,edges:h}=o,p=[];u.forEach(B=>{r.getCellById(B==null?void 0:B.id)||p.push(B)});const g=[],v=[],b=[];r.getNodes().forEach(B=>{const G=u.find(K=>(K==null?void 0:K.id)===(B==null?void 0:B.id));if(!G)b.push(B);else{let K=!0;s?K=s(B==null?void 0:B.data,G):(B==null?void 0:B.data)&&G&&(K=xC.isNodeEqual(B==null?void 0:B.data,G)),K||B.setData(G,{deep:!1}),K===!0?g.push(B):v.push(B)}});const A=[];h.forEach(B=>{r.getCellById(B==null?void 0:B.id)||A.push(B)});const O=[],D=[],_=[];return r.getEdges().forEach(B=>{const G=h.find(K=>(K==null?void 0:K.id)===(B==null?void 0:B.id));if(!G)_.push(B);else{let K=!0;l?K=l(B==null?void 0:B.data,G):(B==null?void 0:B.data)&&G&&(K=xC.isEdgeEqual(B==null?void 0:B.data,G)),K||B.setData(G,{deep:!1}),K===!0?O.push(B):D.push(B)}}),{addNodeConfigs:p,addEdgeConfigs:A,retainNodes:g,retainEdges:O,removeNodes:b,removeEdges:_,updateNodes:v,updateEdges:D}}};vt([Rt(Br),ct("design:type",Object)],Gy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Gy.prototype,"init",null),Gy=vt([nn({token:{token:jr,named:CC.command.id}})],Gy);var wC;(function(n){n.command=rr.GRAPH_RESIZE,n.hookKey="graphResize"})(wC||(wC={}));let By=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),s=this.ctx.getHooks(),l=yield this.ctx.getGraphConfig(),u=l.rootContainer.clientHeight,h=l.rootContainer.clientWidth,p=yield s.graphResize.call(r,g=>Ee(this,void 0,void 0,function*(){const v=yield this.ctx.getX6Graph(),{width:b=h,height:w=u}=g;return v==null||v.resize(b,w),{}}),o);return this.ctx.setResult(p),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],By.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],By.prototype,"init",null),By=vt([nn({token:{token:jr,named:wC.command.id}})],By);var EC;(function(n){n.command=rr.GRAPH_FULLSCREEN,n.hookKey="graphFullscreen"})(EC||(EC={}));let zy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),s=this.ctx.getHooks(),l=yield this.ctx.getGraphConfig(),{appContainer:u}=l;if(!u)return;const h=yield s.graphFullscreen.call(r,()=>Ee(this,void 0,void 0,function*(){var p,g;let v=!1;return document.fullscreenElement?(g=document.exitFullscreen)===null||g===void 0||g.call(document):((p=u.requestFullscreen)===null||p===void 0||p.call(u),v=!0),{fulllscreen:v}}),o);return this.ctx.setResult(h),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],zy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],zy.prototype,"init",null),zy=vt([nn({token:{token:jr,named:EC.command.id}})],zy);var Uy;(function(n){n.command=rr.GRAPH_ZOOM,n.MAX_SCALE=1.5,n.MIN_SCALE=.05,n.defaultZoomOptions={maxScale:n.MAX_SCALE,minScale:n.MIN_SCALE},n.hookKey="graphZoom"})(Uy||(Uy={}));let Vy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().graphZoom.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),{factor:p,zoomFitPadding:g=12,zoomOptions:v=Uy.defaultZoomOptions}=u;return typeof p=="number"?h==null||h.zoom(p,v||{}):p==="fit"?h==null||h.zoomToFit(Object.assign(Object.assign({},v),{padding:g})):p==="real"&&(h==null||h.scale(1),h==null||h.centerContent()),{factor:p,zoomFitPadding:g,zoomOptions:v}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Vy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Vy.prototype,"init",null),Vy=vt([nn({token:{token:jr,named:Uy.command.id}})],Vy);var SC;(function(n){n.command=rr.GRAPH_COPY,n.hookKey="graphCopySelection"})(SC||(SC={}));let AC=class{constructor(){this.parseCells=r=>{r.forEach(u=>{const h=u.getData();u.isNode()&&h.isGroup&&u.getChildren().forEach(g=>{r.push(g)})});const o=r.filter(u=>u.isNode()).map(u=>u.id),s=r.reduce((u,h)=>{if(h.isEdge()){const p=h.getSourceCellId(),g=h.getTargetCellId();p&&g&&o.includes(p)&&o.includes(g)&&u.set(h.id,h)}else u.set(h.id,h);return u},new Map),l=Array.from(s.values());return Mc(l)},this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().graphCopySelection.call(o,()=>Ee(this,void 0,void 0,function*(){const p=(yield r.getX6Graph()).getSelectedCells(),g=this.parseCells(p),v=window.localStorage.getItem(cc);return window.localStorage.setItem(cc,JSON.stringify(g)),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){window.localStorage.setItem(cc,v)}))),{err:null}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],AC.prototype,"contextProvider",void 0),AC=vt([nn({token:{token:jr,named:SC.command.id}})],AC);function wD(n,r=null){try{return JSON.parse(n)||r}catch(o){return console.error(o),r}}let jy=class{constructor(){this.groupNodeMap=new Map,this.nodeMap=new Map,this.nodeMappingRecord=new Map,this.portMap=new Map,this.portMappingRecord=new Map,this.edgeMap=new Map,this.edgeMappingRecord=new Map,this.getNodesByType=r=>r.reduce((o,s)=>(s.isGroup?o.groupNodes.push(s):o.normalNodes.push(s),o),{normalNodes:[],groupNodes:[]}),this.getNodePorts=r=>Array.isArray(r.ports)?r.ports:r.ports&&Array.isArray(r.ports.items)?r.ports.items:[],this.addNodes=r=>{r.forEach(o=>{if(o.isGroup)this.groupNodeMap.set(o.id,o);else{const s=this.getNodePorts(o);this.nodeMap.set(o.id,o),s.forEach(l=>{this.portMap.set(l.id,l)})}})},this.addEdge=r=>{r.forEach(o=>{this.edgeMap.set(o.id,o)})},this.buildNodeMapping=(r,o)=>{const s=r.id||r.originId,l=o.id;this.nodeMappingRecord.set(s,l),this.getNodePorts(r).forEach((h,p)=>{const g=o.ports[p];g&&(this.portMap.set(g.id,g),this.portMappingRecord.set(h.id,g.id))})},this.createEdgeBetweenNodes=r=>{const{source:o,sourcePortId:s,target:l,targetPortId:u}=r;return Object.assign(Object.assign({},r),{source:this.nodeMappingRecord.get(o),target:this.nodeMappingRecord.get(l),sourcePortId:this.portMappingRecord.get(s),targetPortId:this.portMappingRecord.get(u)})},this.buildGroupRelations=r=>{const{groupChildren:o}=r,s=o.map(l=>this.nodeMappingRecord.get(l));return Object.assign(Object.assign({},r),{groupChildren:s})}}};jy=vt([nn()],jy);var Hy,TC;(function(n){n.command=rr.GRAPH_PASTE,n.hookKey="graphPasteSelection"})(TC||(TC={}));function MC(n,r=0){return Math.floor(Math.random()*(n-r)+r)}let M0=Hy=class{constructor(){this.updateNodeCopiedProps=(r,o)=>{let s=MC(100),l=MC(100);return r&&(s=o.x-r.x+MC(30),l=o.y-r.y+MC(30)),o.x+=s,o.y+=l,o.originId=o.id,delete o.id,o.label=`${o.label}_copied`,o.isCollapsed=!1,o},this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),l=r.getHooks();if(Hy.doing)return this;Hy.doing=!0;const u=yield l.graphPasteSelection.call(o,h=>Ee(this,void 0,void 0,function*(){const{commandService:p,position:g}=h,v=window.localStorage.getItem(cc),b=wD(v,{nodes:[],edges:[]}),{nodes:w=[],edges:A=[]}=b,{normalNodes:O,groupNodes:D}=this.mappingHelper.getNodesByType(w);return this.mappingHelper.addNodes(w),yield Promise.all(O.map(_=>Ee(this,void 0,void 0,function*(){const G=(yield p.executeCommand(di.ADD_NODE.id,{nodeConfig:this.updateNodeCopiedProps(g,_)})).contextProvider().getResult();this.mappingHelper.buildNodeMapping(_,G.nodeConfig)}))),yield Promise.all(D.map(_=>Ee(this,void 0,void 0,function*(){const I=this.mappingHelper.buildGroupRelations(_);yield p.executeCommand(to.ADD_GROUP.id,{nodeConfig:this.updateNodeCopiedProps(g,I)})}))),yield Promise.all(A.map(_=>{const I=this.mappingHelper.createEdgeBetweenNodes(_);return p.executeCommand(zi.ADD_EDGE.id,{edgeConfig:I})})),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){window.localStorage.setItem(cc,null)}))),{err:null}}),s);return r.setResult(u),Hy.doing=!1,this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};M0.doing=!1,vt([Rt(Br),ct("design:type",Object)],M0.prototype,"contextProvider",void 0),vt([Rt(jy),ct("design:type",jy)],M0.prototype,"mappingHelper",void 0),M0=Hy=vt([nn({token:{token:jr,named:TC.command.id}})],M0);var PC;(function(n){n.command=rr.GRAPH_TOGGLE_MULTI_SELECT,n.hookKey="toggleMultiSelect"})(PC||(PC={}));let $y=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().toggleMultiSelect.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),p=yield this.ctx.getGraphConfig(),{isEnable:g,modelService:v}=u,b=yield hu.getModel(v),w=typeof g=="boolean"?g:!h.isRubberbandEnabled();return w?(h.enableRubberband(),h.scroller&&h.scroller.widget?h.scroller.disablePanning():h.disablePanning(),p.graphContainer.style.cursor="crosshair"):(h.disableRubberband(),h.scroller&&h.scroller.widget?h.scroller.enablePanning():h.enablePanning(),p.graphContainer.style.cursor="grab"),b.setValue({isEnable:w}),{isEnable:w}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],$y.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],$y.prototype,"init",null),$y=vt([nn({token:{token:jr,named:PC.command.id}})],$y);var OC;(function(n){n.command=rr.GRAPH_HISTORY_UNDO,n.hookKey="historyUndo"})(OC||(OC={}));let DC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().historyUndo.call(o,h=>Ee(this,void 0,void 0,function*(){const p=yield r.getX6Graph();return p.isHistoryEnabled()===!1?{err:"history is disabled"}:(p.undo(),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){const{commandService:g}=h;g.executeCommand(rr.GRAPH_HISTORY_REDO.id,{})}))),{err:null})}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],DC.prototype,"contextProvider",void 0),DC=vt([nn({token:{token:jr,named:OC.command.id}})],DC);var _C;(function(n){n.command=rr.GRAPH_HISTORY_REDO,n.hookKey="historyRedo"})(_C||(_C={}));let NC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().historyRedo.call(o,h=>Ee(this,void 0,void 0,function*(){const p=yield r.getX6Graph();return p.isHistoryEnabled()===!1?{err:"history is disabled"}:(p.redo(),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){const{commandService:g}=h;g.executeCommand(rr.GRAPH_HISTORY_UNDO.id,{})}))),{err:null})}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],NC.prototype,"contextProvider",void 0),NC=vt([nn({token:{token:jr,named:_C.command.id}})],NC);var kC;(function(n){n.command=rr.GRAPH_HISTORY_TOGGLE,n.hookKey="historyToggle"})(kC||(kC={}));let RC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().historyToggle.call(o,h=>Ee(this,void 0,void 0,function*(){const p=yield r.getX6Graph();if(p.isHistoryEnabled()===!1)return{err:"history is disabled"};const g=p.isHistoryEnabled(),{enabled:v}=h;return p.toggleHistory(v),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){const{commandService:b}=h;b.executeCommand(rr.GRAPH_HISTORY_TOGGLE.id,{enabled:g})}))),{err:null}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],RC.prototype,"contextProvider",void 0),RC=vt([nn({token:{token:jr,named:kC.command.id}})],RC);var IC;(function(n){n.command=rr.GRAPH_HISTORY_RESET,n.hookKey="historyReset"})(IC||(IC={}));let LC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().historyReset.call(o,()=>Ee(this,void 0,void 0,function*(){return(yield r.getX6Graph()).cleanHistory(),{err:null}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],LC.prototype,"contextProvider",void 0),LC=vt([nn({token:{token:jr,named:IC.command.id}})],LC);var FC;(function(n){n.command=rr.GRAPH_ADD_TOOL,n.hookKey="addTool"})(FC||(FC={}));let GC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().addTool.call(o,h=>Ee(this,void 0,void 0,function*(){const{cellId:p,toolConfig:g,commandService:v}=h,w=(yield r.getX6Graph()).getCellById(p);return w&&(w.addTools(g.items,g.options),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){Array.isArray(g.items)&&g.items.forEach(A=>{v.executeCommand(rr.GRAPH_DEL_TOOL.id,{cellId:p,toolname:A})})})))),{err:null}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],GC.prototype,"contextProvider",void 0),GC=vt([nn({token:{token:jr,named:FC.command.id}})],GC);var BC;(function(n){n.command=rr.GRAPH_DEL_TOOL,n.hookKey="delTool"})(BC||(BC={}));let zC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().delTool.call(o,h=>Ee(this,void 0,void 0,function*(){const{cellId:p,toolName:g,toolConfig:v}=h,w=(yield r.getX6Graph()).getCellById(p);return w&&(g==="*"?w.removeTools(v):w.removeTool(g,v)),{err:null}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],zC.prototype,"contextProvider",void 0),zC=vt([nn({token:{token:jr,named:BC.command.id}})],zC);var UC;(function(n){n.command=rr.REDO_CMD,n.hookKey="redoCommand"})(UC||(UC={}));let Wy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.ctx,{args:o,hooks:s}=r.getArgs();return yield r.getHooks().redoCommand.call(o,()=>Ee(this,void 0,void 0,function*(){const u=r.getCommands();return u.isRedoable&&u.redoCommand(),this.ctx.addUndo(Rn.create(()=>{u.redoCommand()})),{}}),s),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Wy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Wy.prototype,"init",null),Wy=vt([nn({token:{token:jr,named:UC.command.id}})],Wy);var VC;(function(n){n.command=rr.UNDO_CMD,n.hookKey="undoCommand"})(VC||(VC={}));let Zy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.ctx,{args:o,hooks:s}=r.getArgs();return yield r.getHooks().undoCommand.call(o,()=>Ee(this,void 0,void 0,function*(){const u=r.getCommands();return u.isUndoable&&u.undoCommand(),this.ctx.addUndo(Rn.create(()=>{u.redoCommand()})),{}}),s),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Zy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Zy.prototype,"init",null),Zy=vt([nn({token:{token:jr,named:VC.command.id}})],Zy);const ED=n=>{n(yd),n(vh),n(mh),n(Fy),n(Gy),n(By),n(DC),n(NC),n(RC),n(LC),n(Wy),n(Zy),n(Vy),n($y),n(AC),n(M0),n(zy),n(GC),n(zC)},SD=[gh,Ff,Gf,OC,_C,IC,kC,bC,CC,wC,EC,UC,VC,Uy,PC,SC,TC,FC,BC];var Xy;(function(n){n.command=zi.ADD_EDGE,n.hookKey="addEdge",n.createEdgeId=s=>{if(Yr.kf.isString(s.source))return`${s.source}:${s.sourcePortId}-${s.target}:${s.targetPortId}`;if(r(s)){const l=s;return`${l.source.cell}:${l.source.port}-${l.target.cell}:${l.target.port}`}if(o(s)){const l=s;return`${l.sourceCell}:${l.sourcePort}-${l.targetCell}:${l.targetPort}`}};function r(s){return s.source&&s.source.cell&&Yr.kf.isString(s.source.cell)}n.isX6EdgeConfig=r;function o(s){return s.sourceCell&&Yr.kf.isString(s.sourceCell)}n.isX6EdgePlainConfig=o})(Xy||(Xy={}));let Yy=class{constructor(){this.processEdgeConfig=(r,o)=>Ee(this,void 0,void 0,function*(){if(!o.id){const{createIdService:s=Xy.createEdgeId}=r;o.id=yield s(o)}return o.sourcePortId&&!o.sourcePort&&(o.sourcePort=o.sourcePortId,o.targetPort=o.targetPortId),o}),this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().addEdge.call(r,u=>Ee(this,void 0,void 0,function*(){const{cellFactory:h,createEdgeService:p,commandService:g,options:v}=u,b=yield this.ctx.getX6Graph();let w=u.edgeConfig;if(p){const I=yield p(u);if(typeof I=="boolean")return{err:"createEdgeService rejected"};w=I}const A=yield this.processEdgeConfig(u,w);let O;const D=Object.assign(Object.assign({},v),{isCommand:!0});if(h){const I=yield h(A,this);O=b.addEdge(I,D)}else O=b.addEdge(Object.assign(Object.assign({},A),{label:(A==null?void 0:A.label)||A,data:Object.assign({},A)}),D);const _=Rn.create(()=>{g.executeCommand(zi.DEL_EDGE.id,{x6Edge:O})});return this.ctx.addUndo(_),{edgeConfig:A,edgeCell:O}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Yy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Yy.prototype,"init",null),Yy=vt([nn({token:{token:jr,named:Xy.command.id}})],Yy);var Iu;(function(n){n.command=zi.DEL_EDGE,n.hookKey="delEdge";let r;(function(o){o.EDGE_NOT_EXIST="edge is not exist",o.EDGE_INVALID_CELL="this is not a valid cell",o.X6_DELETE_FAILED="x6 throw err when call delete edge",o.SERVICE_REJECT="service reject to delete"})(r=n.ErrEnum||(n.ErrEnum={}))})(Iu||(Iu={}));let Ky=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().delEdge.call(r,u=>Ee(this,void 0,void 0,function*(){const{edgeConfig:h,x6Edge:p,deleteEdgeService:g,commandService:v,options:b}=u;let w=p;if(!w&&(w=yield this.findEdgeById(h),!w))return console.error(Iu.ErrEnum.EDGE_NOT_EXIST,h),{err:Iu.ErrEnum.EDGE_NOT_EXIST};if(!(w&&w.isEdge()))return console.error(Iu.ErrEnum.EDGE_NOT_EXIST,w),{err:Iu.ErrEnum.EDGE_NOT_EXIST};if(g&&!(yield g(u)))return{err:Iu.ErrEnum.SERVICE_REJECT};try{const O=w.getTargetCell(),D=w.getSourceCell(),_=w.getSourcePortId(),I=w.getTargetPortId(),B=D?D.id:D.source,G=O?O.id:O.target;w.remove(Object.assign(Object.assign({},b),{isCommand:!0}));const K=Rn.create(()=>{v.executeCommand(zi.ADD_EDGE.id,{edgeConfig:{source:B,target:G,sourcePortId:_,targetPortId:I}})});return this.ctx.addUndo(K),{err:null,edgeConfig:{source:B,target:G,sourcePortId:_,targetPortId:I},targetCell:O,sourceCell:D,sourcePortId:_,targetPortId:I}}catch(O){return console.error(Iu.ErrEnum.X6_DELETE_FAILED,O),{err:Iu.ErrEnum.X6_DELETE_FAILED}}}),o);return this.ctx.setResult(l),this}),this.findEdgeById=r=>Ee(this,void 0,void 0,function*(){return(yield this.ctx.getX6Graph()).getCellById(r.id)}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Ky.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Ky.prototype,"init",null),Ky=vt([nn({token:{token:jr,named:Iu.command.id}})],Ky);var AD=P(13218),BM=P.n(AD),P0;(function(n){n.command=zi.UPDATE_EDGE,n.hookKey="updateEdge",n.XFlowEdgeSetOptions={overwrite:!0},n.XFlowUpdateLabelService=(r,o,s=n.XFlowEdgeSetOptions)=>Ee(this,void 0,void 0,function*(){r==null||r.setLabelAt(0,(o==null?void 0:o.label)||o,s)})})(P0||(P0={}));let qy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().updateEdge.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),{updateEdgeService:p,updateEdgeLabelService:g=P0.XFlowUpdateLabelService,options:v=P0.XFlowEdgeSetOptions}=u,b=p?yield p(u):u==null?void 0:u.edgeConfig,w=h==null?void 0:h.getCellById(b==null?void 0:b.id);return w==null||w.setData(b,v),b!=null&&b.hasOwnProperty("label")&&(yield g(w,b,v)),Oc()(b==null?void 0:b.visible)&&w.setVisible(b==null?void 0:b.visible),b.attrs&&w.setAttrs(b.attrs),b.vertices&&w.setVertices(b.vertices),b.router&&w.setRouter(b.router),b.connector&&w.setConnector(b.connector),BM()(b.source)&&w.setSource(b.source),BM()(b.target)&&w.setTarget(b.target),{edgeConfig:b,edgeCell:w}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],qy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],qy.prototype,"init",null),qy=vt([nn({token:{token:jr,named:P0.command.id}})],qy);var jC;(function(n){n.command=zi.HIGHLIGHT_EDGE,n.hookKey="highlightEdge"})(jC||(jC={}));let Jy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().highlightEdge.call(r,u=>Ee(this,void 0,void 0,function*(){var h,p;const g=yield this.ctx.getX6Graph(),{edgeId:v,strokeColor:b,strokeWidth:w}=u,A=g.getEdges(),O=A.find(_=>_.id===v),D=A.filter(_=>_.id!==v);if(!O)console.error(v,"this edgeId is not exist");else{const _=O.getAttrs();((h=_==null?void 0:_.line)===null||h===void 0?void 0:h.stroke)===b&&((p=_==null?void 0:_.line)===null||p===void 0?void 0:p.strokeWidth)===w||(O==null||O.setAttrs({line:{stroke:b,strokeWidth:w||2}}),D.forEach(I=>{I.setAttrs({line:_==null?void 0:_.line})}),u.commandService.executeCommand(zi.FRONT_EDGE.id,{edgeId:v}))}return{}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Jy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Jy.prototype,"init",null),Jy=vt([nn({token:{token:jr,named:jC.command.id}})],Jy);var HC;(function(n){n.command=zi.FRONT_EDGE,n.hookKey="frontEdge"})(HC||(HC={}));let Qy=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().frontEdge.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),{edgeId:p}=u,g=h==null?void 0:h.getCellById(p);return g?(g.toFront(),this.ctx.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){u.commandService.executeCommand(zi.BACK_EDGE.id,{edgeId:p})})))):console.error(p,"this edgeId is not exist"),{}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],Qy.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],Qy.prototype,"init",null),Qy=vt([nn({token:{token:jr,named:HC.command.id}})],Qy);var $C;(function(n){n.command=zi.BACK_EDGE,n.hookKey="frontEdge"})($C||($C={}));let eb=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().frontEdge.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),{edgeId:p}=u,g=h==null?void 0:h.getCellById(p);return g?(g.toBack(),this.ctx.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){u.commandService.executeCommand(zi.FRONT_EDGE.id,{edgeId:p})})))):console.error(p,"this edgeId is not exist"),{}}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],eb.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],eb.prototype,"init",null),eb=vt([nn({token:{token:jr,named:$C.command.id}})],eb);const TD=n=>{n(Yy),n(Ky),n(qy),n(Jy),n(Qy),n(eb)},MD=[Xy,Iu,P0,jC,HC,$C];var O0;(function(n){n.command=to.ADD_GROUP,n.hookKey="addGroup",n.GROUP_PADDING=12,n.GROUP_HEADER_HEIGHT=40})(O0||(O0={}));let WC=class{constructor(){this.getBBox=(r,o,s)=>{const{groupHeaderHeight:l=O0.GROUP_HEADER_HEIGHT,groupPadding:u=O0.GROUP_PADDING}=o,h=s.getCellsBBox(r.children);return h.moveAndExpand({x:-u,y:-(u+l),width:u*2,height:u*2+l}),h},this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().addGroup.call(o,h=>Ee(this,void 0,void 0,function*(){const{nodeConfig:p,createService:g,cellFactory:v,commandService:b}=h,w=yield r.getX6Graph(),A=yield b.executeCommand(di.ADD_NODE.id,{cellFactory:v,createNodeService:g,nodeConfig:p}),{nodeCell:O}=A.contextProvider().getResult(),{id:D}=O,{groupChildren:_}=p;if(_.length){_.forEach(B=>{const G=w.getCellById(B);G&&(G.setData(Object.assign(Object.assign({},G.getData()),{group:D,isCollapsed:!1})),G.prop("group",D),O.addChild(G),w.unselect(G))});const I=this.getBBox(O,p,w);O.position(I.x,I.y),O.size(I.width,I.height),O.setZIndex(0),O.prop("isGroup",!0),O.setData(Object.assign(Object.assign({},O.getData()),{width:I.width,height:I.height,groupChildrenSize:{width:I.width,height:I.height},x:I.x,y:I.y,isGroup:!0})),w.select(O)}return p.isCollapsed&&(yield b.executeCommand(to.COLLAPSE_GROUP.id,{nodeId:p.id,isCollapsed:p.isCollapsed})),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){b.executeCommand(to.DEL_GROUP.id,{nodeConfig:p})}))),{nodeConfig:p,nodeCell:O}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],WC.prototype,"contextProvider",void 0),WC=vt([nn({token:{token:jr,named:O0.command.id}})],WC);var ZC;(function(n){n.command=to.DEL_GROUP,n.hookKey="delGroup"})(ZC||(ZC={}));let XC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().delGroup.call(o,h=>Ee(this,void 0,void 0,function*(){const p=yield r.getX6Graph(),{nodeConfig:g,commandService:v,deleteService:b}=h,{id:w}=g,A=p.getCellById(w);if(b&&!(yield b(h)))return{err:"service rejected"};if(!A)return{err:"target node is not exist"};if(A.getProp("isGroup")!==!0)return{err:"target node is not group"};const{isCollapsed:O}=A.getData();O&&(yield v.executeCommand(to.COLLAPSE_GROUP.id,{nodeId:A.id,isCollapsed:!1,collapsedSize:{width:0,height:0}}));const D=A.getChildren();return D&&D.forEach(_=>{A.unembed(_),_.prop("group",""),_.setData(Object.assign(Object.assign({},_.getData()),{group:""}))}),yield v.executeCommand(di.DEL_NODE.id,{nodeConfig:g}),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){v.executeCommand(to.ADD_GROUP.id,{nodeConfig:g})}))),{err:null}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],XC.prototype,"contextProvider",void 0),XC=vt([nn({token:{token:jr,named:ZC.command.id}})],XC);var YC;(function(n){n.command=to.INIT_GROUP,n.hookKey="initGroup"})(YC||(YC={}));let KC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().initGroup.call(o,h=>Ee(this,void 0,void 0,function*(){const{graphData:p,commandService:g}=h,v=yield r.getX6Graph(),{nodes:b}=p,w={};return b.forEach(A=>{const{id:O,group:D}=A;D&&(w[D]?w[D].push(O):w[D]=[O])}),Object.keys(w).forEach(A=>Ee(this,void 0,void 0,function*(){const O=v.getCellById(A),D=O.getData(),_=w[A]||[];O.prop("isGroup",!0),O.setData(Object.assign(Object.assign({},D),{isGroup:!0,groupChildren:_})),_.forEach(G=>{const K=v.getCellById(G);O.embed(K)}),O.toBack();const{isCollapsed:I,groupCollapsedSize:B}=D;if(I){const G=h.collapsedSize||B||Hd;yield g.executeCommand(to.COLLAPSE_GROUP.id,{collapsedSize:G,isCollapsed:!0,nodeId:O.id})}})),{}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],KC.prototype,"contextProvider",void 0),KC=vt([nn({token:{token:jr,named:YC.command.id}})],KC);var qC;(function(n){n.command=to.COLLAPSE_GROUP,n.hookKey="collapseGroup"})(qC||(qC={}));let tb=class{constructor(){this.toggleVisible=(r,o,s)=>{r.forEach(l=>{const u=s.findViewByCell(l).container;u.style.visibility=o?"visible":"hidden"})},this.toggleCollapse=(r,o,s)=>{const l=r.getChildren().filter(g=>g.isNode()),u=r.getData(),{isCollapsed:h,gap:p=0}=s;if(h){const g=s.collapsedSize||u.groupCollapsedSize||Hd;r.prop("previousSize",r.size()),r.size(g)}else r.size(r.prop("previousSize"));l&&l.forEach(g=>{const v=r.position(),b=o.getConnectedEdges(g).filter(w=>{const A=w.getSourceNode(),O=w.getTargetNode();return l.includes(A)&&l.includes(O)});if(h){this.toggleVisible([g,...b],!1,o),g.prop("previousSize",g.size()),g.prop("previousRelativePosition",g.position({relative:!0})),g.position(v.x+p,v.y+p);const w=r.size();g.size({width:w.width-p*2,height:w.height-p*2})}else{this.toggleVisible([g,...b],!0,o);const w=g.prop("previousRelativePosition"),A=g.prop("previousSize");g.position(w.x,w.y,{relative:!0}),g.size(A)}}),r.prop("isCollapsed",h),r.setData(Object.assign(Object.assign({},r.getData()),{isCollapsed:h}))},this.execute=()=>Ee(this,void 0,void 0,function*(){const{args:r,hooks:o}=this.ctx.getArgs(),l=yield this.ctx.getHooks().collapseGroup.call(r,u=>Ee(this,void 0,void 0,function*(){const h=yield this.ctx.getX6Graph(),p=h.getCellById(r.nodeId),{toggleService:g}=u;return g&&!(yield g(u))?{err:"service rejected"}:(p&&(this.toggleCollapse(p,h,r),this.ctx.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){p&&this.toggleCollapse(p,h,Object.assign(r,{isCollapsed:!r.isCollapsed}))})))),{err:null})}),o);return this.ctx.setResult(l),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.ctx.isUndoable||(yield this.execute()),this})}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};vt([Rt(Br),ct("design:type",Object)],tb.prototype,"contextProvider",void 0),vt([(0,U.zY)(),ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",void 0)],tb.prototype,"init",null),tb=vt([nn({token:{token:jr,named:qC.command.id}})],tb);const PD=n=>{n(WC),n(XC),n(KC),n(tb)},OD=[O0,ZC,YC,qC];var JC;(function(n){n.command=Ja.UPDATE_MODEL,n.hookKey="updateModel"})(JC||(JC={}));let QC=class{constructor(){this.execute=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),u=yield r.getHooks().updateModel.call(o,h=>Ee(this,void 0,void 0,function*(){const{updateModel:p,getModel:g,modelService:v}=h,b=yield g(v),w=b.getValue(),A=ns(w);yield p(A);const O=Lo(A);return b.setValue(O),r.addUndo(Rn.create(()=>Ee(this,void 0,void 0,function*(){b.setValue(O)}))),{model:b,value:O}}),s);return r.setResult(u),this}),this.undo=()=>Ee(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>Ee(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};vt([Rt(Br),ct("design:type",Object)],QC.prototype,"contextProvider",void 0),QC=vt([nn({token:{token:jr,named:JC.command.id}})],QC);const Ok=()=>{},DD=n=>{n(QC)},_D=[JC],zM=[...K0,...MD,...OD,...SD,..._D],UM=()=>new pa;let nb=class{constructor(){this.registerHook=r=>Ee(this,void 0,void 0,function*(){const o=r.x6Events.registerHook({name:"bind group node move event",handler:s=>Ee(this,void 0,void 0,function*(){const l={eventName:"node:moving",callback:({node:u})=>Ee(this,void 0,void 0,function*(){if(u.prop("isGroup")){u.prop("originPosition",u.getPosition());return}const p=u.model.graph,{group:g}=u.getData(),v=p.getNodes().find(K=>K.id===g);if(!v)return;const b=v.getProp("isCollapsed");let w=v.getProp("originSize"),A=!1;w==null&&(w=v.size(),v.prop("originSize",w));let O=v.prop("originPosition");O==null&&(O=v.getPosition(),v.prop("originPosition",O));let D=O.x,_=O.y,I=O.x+w.width,B=O.y+w.height;const G=v.getChildren();if(G&&G.forEach(K=>{const ve=K.getBBox().inflate(12),ae=ve.getCorner();ve.x<D&&(D=ve.x,A=!0),ve.y<_&&(_=ve.y,A=!0),ae.x>I&&(I=ae.x,A=!0),ae.y>B&&(B=ae.y,A=!0)}),A){v.prop({position:{x:D,y:_},size:{width:I-D,height:B-_}});const K=Object.assign(Object.assign({},v.getData()),{x:D,y:_,width:I-D,height:B-_});b!==!0&&(K.groupChildrenSize={width:I-D,height:B-_}),v.setData(K)}})};s.push(l)})});return Rn.create(()=>{o.dispose()})}),this.registerHookHub=r=>Ee(this,void 0,void 0,function*(){const o=new qn;return zM.forEach(({hookKey:s,createHook:l=UM})=>{const u=r.registerHookHub(s,l());o.push(u)}),this.commandConfig.getConfig().then(({getContributions:s})=>{s().forEach(({hookKey:u,createHook:h=UM})=>{const p=r.registerHookHub(u,h());o.push(p)})}),o})}registerGraphCommands(r){zM.forEach(({command:o})=>{r.registerCommand(o,{createCommand:this.commandFactory})}),this.commandConfig.getConfig().then(({getContributions:o})=>{o().forEach(l=>{r.registerCommand(l.command,{createCommand:this.commandFactory})})})}};vt([Rt(vf),ct("design:type",Function)],nb.prototype,"commandFactory",void 0),vt([Rt(jl),ct("design:type",jl)],nb.prototype,"commandConfig",void 0),nb=vt([Dn({contrib:[yf,ga]})],nb);const ND=(n,r)=>{r.getCommandContributions().forEach(s=>{const{CommandHandler:l,command:u}=s;n({token:{token:jr,named:u.id},useClass:l})}),ED(n),Y0(n),TD(n),PD(n),DD(n),n(nb)},kD=n=>Yi(r=>{r(jy),ul(r,n),ND(r,n),r(Va),r(vf,{useFactory:o=>(s,l,u)=>{const h=o.container.createChild(),p=h.get(Va);h.register(Br,{useDynamic:()=>()=>p});const g=h.getNamed(jr,s);return p.setArgs(l,u),p.handlerInstance=g,g}})}),RD=n=>{const r=Os(),o=F.useMemo(()=>n.config?n.config:new jl,[]);return F.useEffect(()=>{r.addCoreModule({config:o,createModule:kD})},[]),null},ID=n=>r=>{const o=F.useMemo(()=>({getValue:()=>({})}),[]);return o.getValue=()=>r,F.useMemo(()=>{const l=new jl;return n(l,o),l},[o])},LD=Symbol("IToolbarService"),VM=ce.defineToken("IToolbarContribution");var FD=P(23279),GD=P.n(FD),BD=P(50361),zD=P.n(BD);let D0=class{constructor(){this.toDispose=new qn,this.toolbarItems=new Map,this.onDidChangeEvent=new fa(null),this.onDidChange=this.onDidChangeEvent.watch,this.fireOnDidChange=GD()(()=>this.onDidChangeEvent.setValue(void 0),16),this.registerDisposableToolbar=r=>{const o=new qn;return r({registerToolbarItem:l=>{const u=this.registerItem(l);return o.push(u),u}}),this.toDispose.push(o),o},this.getToolbarModel=r=>{const{layout:o,mainGroups:s=[],extraGroups:l=[]}=r;return new fa({layout:o,mainGroups:this.createToolbarGroupModel(s),extraGroups:this.createToolbarGroupModel(l)})},this.createToolbarGroupModel=r=>r.map(s=>{const{items:l=[]}=s;return Object.assign(Object.assign({},s),{items:l.map(u=>this.createToolbarModel({id:u.id})).filter(u=>!!u)})})}onStart(){const r=this.contributionProvider.getContributions();for(const o of r)o.registerToolbarItems(this)}onStop(){this.toDispose.dispose()}registerItem(r){return this.toolbarItems.has(r.id)&&console.warn(`ToolbarRegistry ${r.id} is duplicated, in`,r),this.toolbarItems.set(r.id,r),this.fireOnDidChange(),new qn(Rn.create(()=>this.fireOnDidChange()),Rn.create(()=>this.toolbarItems.delete(r.id)))}createToolbarModel(r){const o=zD()(this.toolbarItems.get(r.id)),s=Oc()(o.isEnabled)?o.isEnabled:!0,l=Oc()(o.isVisible)?o.isVisible:!0;return Object.assign(Object.assign({},o),{isEnabled:s,isVisible:l,iconName:o.iconName,text:o.text})}};vt([Rt(su),ct("design:type",Object)],D0.prototype,"commandService",void 0),vt([Rt(mi),ct("design:type",Object)],D0.prototype,"modelService",void 0),vt([Bi(VM),ct("design:type",Object)],D0.prototype,"contributionProvider",void 0),D0=vt([Dn({contrib:[Ao,LD]})],D0);const UD=()=>Yi(n=>{Qr.register(n,VM),n(D0)}),jM=n=>{const{}=n,r=Os();return F.useEffect(()=>{const o=r.addCoreModule({config:{CONFIG_TYPE:"ToolbarRegistry",getConfig:()=>Ee(void 0,void 0,void 0,function*(){})},createModule:UD});return()=>{o.dispose()}},[r]),null};jM.defaultProps={XFlowModuleType:"ToolbarRegistry"};const Dk=Symbol("xflow-menu-root"),VD=Symbol("IMenuService"),HM=ce.defineToken("IMenuContribution");var e1;(function(n){n.Separator="separator",n.Submenu="submenu",n.Root="root",n.Leaf="leaf"})(e1||(e1={}));let t1=class{constructor(){this.toDispose=new qn,this.menuMap=new Map,this.getMenu=r=>this.menuMap.get(r),this.registerDisposableMenu=r=>{const o=new qn;return r({registerMenu:l=>{const u=this.registerMenu(l);return o.push(u),u}}),this.toDispose.push(o),o}}onStart(){const r=this.contributionProvider.getContributions();for(const o of r)o.registerMenu(this)}onStop(){this.toDispose.dispose()}registerMenu(r){return this.menuMap.set(r.id,r),Rn.create(()=>this.menuMap.delete(r.id))}};vt([Bi(HM),ct("design:type",Object)],t1.prototype,"contributionProvider",void 0),t1=vt([Dn({contrib:[Ao,VD]})],t1);const jD=()=>Yi(n=>{Qr.register(n,HM),n(t1)}),$M=n=>{const{}=n,r=Os();return F.useEffect(()=>{const o=r.addCoreModule({config:{CONFIG_TYPE:"MenuRegistry",getConfig:()=>Ee(void 0,void 0,void 0,function*(){})},createModule:jD});return()=>{o.dispose()}},[]),null};$M.defaultProps={XFlowModuleType:"MenuRegistry"};const WM=n=>{const{meta:r,graphConfig:o,graphData:s,graphLayout:l,onLoad:u,isAutoCenter:h,hookConfig:p,modelServiceConfig:g,commandConfig:v,onAppConfigReady:b,onAppDestroy:w,children:A=[],className:O,style:D}=n,[_,I]=F.useState(),B=F.useRef(null),G=Af();F.useEffect(()=>{b&&b(G);const ae=Yp(G);ae.start().then(()=>Ee(void 0,void 0,void 0,function*(){var rt;I(ae),(rt=G.getExtension("GraphConfig"))===null||rt===void 0||rt.config.setAppContainer(B.current),r&&(yield ae.commandService.executeCommand(rr.LOAD_META.id,{meta:r})),u&&u(ae,G),s&&(l&&(yield ae.commandService.executeCommand(rr.GRAPH_LAYOUT.id,Object.assign({graphData:s},l))),yield ae.commandService.executeCommand(rr.GRAPH_RENDER.id,{graphData:s}))}));const Ye=()=>Ee(void 0,void 0,void 0,function*(){w&&w(ae)});return()=>{Ye()}},[]),F.useEffect(()=>{_&&_.commandService.executeCommand(rr.LOAD_META.id,{meta:r})},[r]),F.useEffect(()=>{(()=>Ee(void 0,void 0,void 0,function*(){_&&(s&&l&&(yield _.commandService.executeCommand(rr.GRAPH_LAYOUT.id,Object.assign({graphData:s},l))),yield _.commandService.executeCommand(rr.GRAPH_RENDER.id,{graphData:s}),h&&(yield _.getGraphInstance()).centerContent())}))()},[s]);const K=Ii()("xflow-app-workspace",O,...G.getContainerClassNames()),ve=(Array.isArray(A)?A:[A]).some(ae=>ae&&ae.props.isXFlowCanvas);return F.createElement(Xd,{app:_},F.createElement(sh.Provider,{value:G},F.createElement("div",{className:K,id:G.getInstanceId(),ref:B,style:D},!ve&&F.createElement(dh,{config:o,position:{top:0,bottom:0,left:0,right:0}}),A,F.createElement(Nf,{config:g}),F.createElement(RD,{config:v}),F.createElement(ah,{config:p}),F.createElement(jM,null),F.createElement($M,null))))};WM.defaultProps={};var _k=null;const HD=n=>n&&n.current,ZM=()=>{const n=F.useRef(!0);return F.useEffect(()=>()=>{n.current=!1},[]),n},XM=n=>{const r=ZM(),[o,s]=F.useState(n.getValue());F.useEffect(()=>{const p=n.watch(g=>{HD(r)&&s(g)});return()=>{p.dispose()}},[s]);const l=o,u=ds.isValidValue(l),h=F.useCallback(p=>n.setValue(p),[n]);return[l,h,u]},n1=n=>{const r=F.useMemo(()=>new fa(n),[]),[o,s,l]=XM(r);return F.useEffect(()=>()=>{r.dispose()},[r]),[o,s,r,l]},$D=n=>{const{getModel:r,initialState:o}=n,s=ZM(),l=F.useRef(),[u,h]=F.useState(o);return F.useEffect(()=>{let p;return r().then(g=>Ee(void 0,void 0,void 0,function*(){l.current=g;const v=yield g.getValidValue();!s.current||(h(v),p=g.watch(b=>{s.current&&h(b)}))})),()=>{p&&p.dispose&&p.dispose()}},[]),[u,h,l.current]},WD=Symbol("IKeyBindingService"),YM=ce.defineToken("IKeyBindingContribution"),KM=Symbol("IKeyBindingOptionProvider");let wp=class{constructor(){this.toDispose=new qn,this.keyBindingMap=new Map,this.enabledKeyBindingMap=new Map,this.registerExternalKeybindings=()=>Ee(this,void 0,void 0,function*(){const{registerKeybindingFunc:r}=yield this.optionProvider.getOption();return r(this)}),this.registerKeybinding=(r=[])=>{const o=new qn;return r.forEach(s=>{this.keyBindingMap.set(s.id,s),this.enableKeyBindings(s.id).then(l=>{o.push(Rn.create(()=>{l.dispose(),this.keyBindingMap.delete(s.id)}))})}),this.toDispose.push(o),o},this.enableKeyBindings=r=>Ee(this,void 0,void 0,function*(){this.disableKeyBindings([r]);const o=this.keyBindingMap.get(r),s=yield this.getX6Graph(),l=this.runCommand(o);s.bindKey(o.keybinding,l);const u=Rn.create(()=>{s.unbindKey(o.keybinding),this.enabledKeyBindingMap.delete(o.id)});return this.enabledKeyBindingMap.set(o.id,u),u}),this.disableKeyBindings=r=>{r.forEach(o=>{const s=this.enabledKeyBindingMap.get(o);s&&s.dispose()})},this.runCommand=r=>o=>Ee(this,void 0,void 0,function*(){yield r.callback(r,this.modelService,this.commandService,o)}),this.getX6Graph=()=>Ee(this,void 0,void 0,function*(){return yield this.graphProvider.getGraphInstance()})}onStart(){const r=this.contributionProvider.getContributions();for(const o of r)o.registerKeybinding(this);this.registerExternalKeybindings()}onStop(){this.toDispose.dispose()}};vt([Rt(KM),ct("design:type",Object)],wp.prototype,"optionProvider",void 0),vt([Rt(su),ct("design:type",Object)],wp.prototype,"commandService",void 0),vt([Rt(mi),ct("design:type",Object)],wp.prototype,"modelService",void 0),vt([Bi(YM),ct("design:type",Object)],wp.prototype,"contributionProvider",void 0),vt([Rt(Ec),ct("design:type",Object)],wp.prototype,"graphProvider",void 0),wp=vt([Dn({contrib:[Ao,WD]})],wp);const ZD=(n,r)=>{n(KM,{useDynamic:()=>({getOption:()=>Ee(void 0,void 0,void 0,function*(){return r.getConfig()})}),lifecycle:ce.Lifecycle.singleton})},XD=n=>Yi(r=>{ZD(r,n),Qr.register(r,YM),r(wp)});var dS;(function(n){n.CONFIG_TYPE="CONTEXT_CONFIG"})(dS||(dS={}));const qM=()=>Rn.create(()=>{});class JM{constructor(){this.CONFIG_TYPE=dS.CONFIG_TYPE,this.keybindingFunc=qM,this.isMounted=new As,this.setKeybindingFunc=r=>{this.keybindingFunc=r},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>Ee(this,void 0,void 0,function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,registerKeybindingFunc:this.keybindingFunc}}),this.dispose=()=>{this.keybindingFunc=qM,this.isMounted=new As}}}const YD=n=>{const{config:r}=n,o=Os(),s=F.useMemo(()=>r||new JM,[r]);return F.useEffect(()=>{const l=o.addCoreModule({config:s,createModule:XD});return s.setMountState(),()=>{l.dispose(),s.dispose()}},[o,s]),null},KD=n=>r=>{const o=F.useMemo(()=>({getValue:()=>({})}),[]);return o.getValue=()=>r,F.useMemo(()=>{const l=new JM;return n(l,o),l},[o])};function qD(n){return new Promise(r=>setTimeout(()=>r(!0),n))}var r1=P(1870);class JD{constructor(){this.map=new Map([["default",r1.Z],["QuestionCircleOutlined",r1.Z]]),this.map.set("default",r1.Z),this.map.set("QuestionCircleOutlined",r1.Z)}get(r){return this.map.get(r)}set(r,o){this.map.set(r,o)}has(r){return this.map.has(r)}}const jd=new JD;var Nk=null;let hS=class{constructor(){this.toDispose=new qn,this.registerHookHub=()=>(0,Vt.mG)(this,void 0,void 0,function*(){return Rn.create(()=>{})}),this.registerHook=r=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=new qn,s=[r.graphOptions.registerHook({name:"add snapline options",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){l.snapline={enabled:!0,className:"xflow-snapline",clean:5e3}})})];return o.pushAll(s),Rn.create(()=>{})})}};hS=(0,Vt.gn)([Dn({contrib:ga})],hS);const QD=()=>Yi(n=>{n(hS)}),e_="CanvasSnapline",t_="#faad14",n_=n=>{const{color:r=t_}=n,o=Os(),s=F.useMemo(()=>({CONFIG_TYPE:e_,getConfig:()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){return{}})}),[]);return F.useEffect(()=>{const l=`xflow-snapline-${Date.now()}`;o.addContainerClassNames(l);const u=`
    .${l} .xflow-snapline .x6-widget-snapline-horizontal,
    .${l} .xflow-snapline .x6-widget-snapline-vertical {
      border-color: ${r};
    }`,h=Kg(u);return()=>{document.head.removeChild(h)}},[r,o]),F.createElement(md,{config:s,createModule:QD})};var i1=P(45777),Ep;(function(n){n.MOUSE_ENTER="node-port:mouseenter",n.MOUSE_LEAVE="node-port:mouseleave"})(Ep||(Ep={}));var o1;(function(n){n.id="ACTIVE_NODE_PORT",n.useModel=r=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=yield r.awaitModel(n.id);return{data:yield o.getValidValue(),model:o}})})(o1||(o1={}));let s1=class{constructor(){this.toDispose=new qn,this.getGraphInstance=()=>(0,Vt.mG)(this,void 0,void 0,function*(){const r=yield this.graphProvider.getGraphInstance(),o=yield this.graphProvider.getGraphOptions();return{graph:r,config:o}}),this.getPortRenderConfig=()=>({onPortRendered(o){const s=this,{port:l,node:u}=o,{contentSelectors:h}=o,p=h&&h["xflow-port-group"];p instanceof Element&&(p.setAttribute("class",Ii()("xflow-port-group",{connected:l.connected&&l.group!=="out",groupPort:(u==null?void 0:u.isGroup)&&(u==null?void 0:u.isGroup())})),p.addEventListener("mouseenter",g=>{const v={e:g,portId:l.id,nodeId:u.id,portData:l,nodeData:u.getData(),tooltip:l.tooltip,placement:l.group};s.trigger(Ep.MOUSE_ENTER,v)}),p.addEventListener("mouseleave",g=>{const v={e:g,portId:l.id,nodeId:u.id,portData:l,nodeData:u.getData(),tooltip:l.tooltip,placement:l.group};s.trigger(Ep.MOUSE_LEAVE,v)}))}}),this.registerHookHub=()=>(0,Vt.mG)(this,void 0,void 0,function*(){return Rn.create(()=>{})}),this.registerHook=r=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=new qn,s=[r.graphOptions.registerHook({name:"add onPortRendered options ",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){Object.assign(l,this.getPortRenderConfig())})})];return o.pushAll(s),Rn.create(()=>{})})}registerModel(r){r.registerModel({id:o1.id,watchChange:o=>(0,Vt.mG)(this,void 0,void 0,function*(){const{graph:s,config:l}=yield this.getGraphInstance(),u=g=>{const{x:v,y:b,width:w,height:A}=g.target.getBoundingClientRect(),O=l.rootContainer.getBoundingClientRect();return{x:v-((O==null?void 0:O.x)||0)+w/2,y:b-((O==null?void 0:O.y)||0)+A/2}},h=g=>{o.setValue(Object.assign(Object.assign({},g),{position:u(g.e)}))},p=()=>{o.setValue(null)};return s.on(Ep.MOUSE_ENTER,h),s.on(Ep.MOUSE_LEAVE,p),s.on("cell:mouseleave",p),Rn.create(()=>{s.off(Ep.MOUSE_ENTER,h),s.off(Ep.MOUSE_LEAVE,p)})})})}};(0,Vt.gn)([Rt(Ec),(0,Vt.w6)("design:type",Object)],s1.prototype,"graphProvider",void 0),s1=(0,Vt.gn)([Dn({contrib:[ga,il]})],s1);const r_=()=>Yi(n=>{n(s1)}),i_="CanvasNodePortTooltip",o_=n=>{const r=po(),[o,,s]=n1(null);F.useEffect(()=>{if(!r)return;const p=(()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const{model:g}=yield o1.useModel(r.modelService);return g.watch(v=>{s.setValue(v)})}))();return()=>{p.then(g=>{g.dispose()})}},[s,r]);const l=!!(o&&o.position&&o.position.x);if(!l)return null;const u=n.getTooltip?n.getTooltip(o):o.tooltip;return F.createElement(i1.Z,{visible:l,title:u,placement:o.placement||"top"},F.createElement("span",{className:"canvas-node-port-tooltip",style:{position:"absolute",left:o.position.x,top:o.position.y}}))},s_=n=>{const r=F.useCallback(()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){return null}),[]);return F.createElement(md,{createModule:r_,config:{CONFIG_TYPE:i_,getConfig:r}},F.createElement(o_,Object.assign({},n)))};var fS;(function(n){n.CONFIG_TYPE="ContextMenuConfig"})(fS||(fS={}));class rb{constructor(r){this.CONFIG_TYPE=fS.CONFIG_TYPE,this.setMenuModelService=o=>{this.menuModelService=o},this.setCustomMenuRender=o=>{this.menuCustomRender=o},this.getConfig=()=>(0,Vt.mG)(this,void 0,void 0,function*(){return{CONFIG_TYPE:this.CONFIG_TYPE,menuCustomRender:this.menuCustomRender,menuModelService:this.menuModelService}}),this.moduleId=r||Ol()}dispose(){}}var a1;(function(n){n.id="CONTEXT_MENU_MODEL",n.useValue=io(n.id),n.getModel=$i(n.id)})(a1||(a1={}));const{inject:QM,singleton:a_}=Z;let ib=class{constructor(){this.toDispose=new qn,this.getMenuModelValue=r=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=yield this.menuConfig.getConfig(),{anchor:s,type:l,cell:u}=r,h=new qn;this.toDispose.push(h);const p=u?u.getData():null,g=new fa({id:"menuroot",type:e1.Root,submenu:[]});h.push(Rn.create(()=>{g.dispose()}));const v={toDispose:h,anchor:s,target:{data:p,type:l},customRender:null,menuModel:g};return o.menuCustomRender&&(v.customRender=yield o.menuCustomRender(r,this.modelService)),o.menuModelService&&(yield o.menuModelService(r,v.menuModel,this.modelService,h)),v})}registerModel(r){const o=[r.registerModel({id:a1.id,getInitialValue:()=>null,watchChange:(s,l)=>(0,Vt.mG)(this,void 0,void 0,function*(){return(yield rs.getModel(l)).watch(h=>(0,Vt.mG)(this,void 0,void 0,function*(){const p=yield this.getMenuModelValue(h);s.setValue(p)}))})})];this.toDispose.pushAll(o)}};(0,Vt.gn)([QM(rb),(0,Vt.w6)("design:type",rb)],ib.prototype,"menuConfig",void 0),(0,Vt.gn)([QM(mi),(0,Vt.w6)("design:type",Object)],ib.prototype,"modelService",void 0),ib=(0,Vt.gn)([a_({contrib:[il]})],ib);const l_=n=>Yi(r=>{r(ib),r(rb,{useValue:n})});var eP=P(1413),c_=P(44925),u_=P(18481),_0={adjustX:1,adjustY:1},N0=[0,0],d_={topLeft:{points:["bl","tl"],overflow:_0,offset:[0,-4],targetOffset:N0},topCenter:{points:["bc","tc"],overflow:_0,offset:[0,-4],targetOffset:N0},topRight:{points:["br","tr"],overflow:_0,offset:[0,-4],targetOffset:N0},bottomLeft:{points:["tl","bl"],overflow:_0,offset:[0,4],targetOffset:N0},bottomCenter:{points:["tc","bc"],overflow:_0,offset:[0,4],targetOffset:N0},bottomRight:{points:["tr","br"],overflow:_0,offset:[0,4],targetOffset:N0}},h_=d_,zr={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(r){var o=r.keyCode;if(r.altKey&&!r.ctrlKey||r.metaKey||o>=zr.F1&&o<=zr.F12)return!1;switch(o){case zr.ALT:case zr.CAPS_LOCK:case zr.CONTEXT_MENU:case zr.CTRL:case zr.DOWN:case zr.END:case zr.ESC:case zr.HOME:case zr.INSERT:case zr.LEFT:case zr.MAC_FF_META:case zr.META:case zr.NUMLOCK:case zr.NUM_CENTER:case zr.PAGE_DOWN:case zr.PAGE_UP:case zr.PAUSE:case zr.PRINT_SCREEN:case zr.RIGHT:case zr.SHIFT:case zr.UP:case zr.WIN_KEY:case zr.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(r){if(r>=zr.ZERO&&r<=zr.NINE||r>=zr.NUM_ZERO&&r<=zr.NUM_MULTIPLY||r>=zr.A&&r<=zr.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&r===0)return!0;switch(r){case zr.SPACE:case zr.QUESTION_MARK:case zr.NUM_PLUS:case zr.NUM_MINUS:case zr.NUM_PERIOD:case zr.NUM_DIVISION:case zr.SEMICOLON:case zr.DASH:case zr.EQUALS:case zr.COMMA:case zr.PERIOD:case zr.SLASH:case zr.APOSTROPHE:case zr.SINGLE_QUOTE:case zr.OPEN_SQUARE_BRACKET:case zr.BACKSLASH:case zr.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},tP=zr,nP=function(r){return+setTimeout(r,16)},rP=function(r){return clearTimeout(r)};typeof window<"u"&&"requestAnimationFrame"in window&&(nP=function(r){return window.requestAnimationFrame(r)},rP=function(r){return window.cancelAnimationFrame(r)});var iP=0,pS=new Map;function oP(n){pS.delete(n)}function sP(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;iP+=1;var o=iP;function s(l){if(l===0)oP(o),n();else{var u=nP(function(){s(l-1)});pS.set(o,u)}}return s(r),o}sP.cancel=function(n){var r=pS.get(n);return oP(r),rP(r)};var f_=tP.ESC,p_=tP.TAB;function g_(n){var r=n.visible,o=n.setTriggerVisible,s=n.triggerRef,l=n.menuRef,u=n.onVisibleChange,h=n.autoFocus,p=F.useRef(!1),g=function(){if(r&&s.current){var A,O,D,_;(A=s.current)===null||A===void 0||(O=A.triggerRef)===null||O===void 0||(D=O.current)===null||D===void 0||(_=D.focus)===null||_===void 0||_.call(D),o(!1),typeof u=="function"&&u(!1)}},v=function(){var A,O;(A=l.current)===null||A===void 0||(O=A.focus)===null||O===void 0||O.call(A),p.current=!0},b=function(A){var O;switch(A.keyCode){case f_:g();break;case p_:!p.current&&((O=l.current)===null||O===void 0?void 0:O.focus)?(A.preventDefault(),v()):g();break}};F.useEffect(function(){return r?(window.addEventListener("keydown",b),h&&sP(v,3),function(){window.removeEventListener("keydown",b),p.current=!1}):function(){p.current=!1}},[r])}var m_=P(59864);function kk(n,r,o){var s=React.useRef({});return(!("value"in s.current)||o(s.current.condition,r))&&(s.current.value=n(),s.current.condition=r),s.current.value}function v_(n,r){typeof n=="function"?n(r):(0,Pd.Z)(n)==="object"&&n&&"current"in n&&(n.current=r)}function aP(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=r.filter(function(l){return l});return s.length<=1?s[0]:function(l){r.forEach(function(u){v_(u,l)})}}function Rk(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return useMemo(function(){return aP.apply(void 0,r)},r,function(s,l){return s.length===l.length&&s.every(function(u,h){return u===l[h]})})}function y_(n){var r,o,s=(0,m_.isMemo)(n)?n.type.type:n.type;return!(typeof s=="function"&&!(!((r=s.prototype)===null||r===void 0)&&r.render)||typeof n=="function"&&!(!((o=n.prototype)===null||o===void 0)&&o.render))}var b_=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus"];function x_(n,r){var o=n.arrow,s=o===void 0?!1:o,l=n.prefixCls,u=l===void 0?"rc-dropdown":l,h=n.transitionName,p=n.animation,g=n.align,v=n.placement,b=v===void 0?"bottomLeft":v,w=n.placements,A=w===void 0?h_:w,O=n.getPopupContainer,D=n.showAction,_=n.hideAction,I=n.overlayClassName,B=n.overlayStyle,G=n.visible,K=n.trigger,ve=K===void 0?["hover"]:K,ae=n.autoFocus,Ye=(0,c_.Z)(n,b_),rt=F.useState(),st=(0,_h.Z)(rt,2),tn=st[0],bt=st[1],jt="visible"in n?G:tn,et=F.useRef(null);F.useImperativeHandle(r,function(){return et.current});var An=F.useRef(null),Vn="".concat(u,"-menu");g_({visible:jt,setTriggerVisible:bt,triggerRef:et,menuRef:An,onVisibleChange:n.onVisibleChange,autoFocus:ae});var Zn=function(){var Xn=n.overlay,oi;return typeof Xn=="function"?oi=Xn():oi=Xn,oi},wi=function(Xn){var oi=n.onOverlayClick,ui=Zn().props;bt(!1),oi&&oi(Xn),ui.onClick&&ui.onClick(Xn)},Ei=function(Xn){var oi=n.onVisibleChange;bt(Xn),typeof oi=="function"&&oi(Xn)},Dr=function(){var Xn,oi=Zn(),ui=aP(An,oi.ref),Ai=(Xn={prefixCls:Vn},(0,ht.Z)(Xn,"data-dropdown-inject",!0),(0,ht.Z)(Xn,"onClick",wi),(0,ht.Z)(Xn,"ref",y_(oi)?ui:void 0),Xn);return typeof oi.type=="string"&&(delete Ai.prefixCls,delete Ai["data-dropdown-inject"]),F.createElement(F.Fragment,null,s&&F.createElement("div",{className:"".concat(u,"-arrow")}),F.cloneElement(oi,Ai))},eo=function(){var Xn=n.overlay;return typeof Xn=="function"?Dr:Dr()},Uo=function(){var Xn=n.minOverlayWidthMatchTrigger,oi=n.alignPoint;return"minOverlayWidthMatchTrigger"in n?Xn:!oi},Ur=function(){var Xn=n.openClassName;return Xn!==void 0?Xn:"".concat(u,"-open")},Vo=function(){var Xn=n.children,oi=Xn.props?Xn.props:{},ui=Ii()(oi.className,Ur());return jt&&Xn?F.cloneElement(Xn,{className:ui}):Xn},gs=_;return!gs&&ve.indexOf("contextMenu")!==-1&&(gs=["click"]),F.createElement(u_.Z,(0,eP.Z)((0,eP.Z)({builtinPlacements:A},Ye),{},{prefixCls:u,ref:et,popupClassName:Ii()(I,(0,ht.Z)({},"".concat(u,"-show-arrow"),s)),popupStyle:B,action:ve,showAction:D,hideAction:gs||[],popupPlacement:b,popupAlign:g,popupTransitionName:h,popupAnimation:p,popupVisible:jt,stretch:Uo()?"minWidth":"",popup:eo(),onPopupVisibleChange:Ei,getPopupContainer:O}),Vo())}var C_=F.forwardRef(x_),w_=C_;class l1 extends F.Component{render(){const{children:r,trigger:o,disabled:s}=this.props,l=`${this.props.prefixCls}-dropdown`,u=F.Children.only(r),h=F.cloneElement(u,{className:Ii()(r.props.className,`${l}-trigger`),disabled:s}),p=s?[]:Array.isArray(o)?o:[o];let g=!1;p&&p.indexOf("contextMenu")!==-1&&(g=!0);const v=F.Children.only(this.props.overlay),b=F.createElement("div",{className:`${l}-overlay`},v);return F.createElement(w_,Object.assign({},this.props,{prefixCls:l,overlay:b,alignPoint:g,trigger:p}),h)}}(function(n){n.defaultProps={trigger:"hover",prefixCls:"x6",mouseEnterDelay:.15,mouseLeaveDelay:.1,placement:"bottomLeft"}})(l1||(l1={}));const c1=F.createContext({});class Sp extends F.PureComponent{constructor(){super(...arguments),this.onHotkey=()=>{this.triggerHandler()},this.onClick=r=>{this.triggerHandler(r)}}componentDidMount(){const{hotkey:r}=this.props;r&&this.props.context.registerHotkey(r,this.onHotkey)}componentWillUnmount(){const{hotkey:r}=this.props;r&&this.props.context.unregisterHotkey(r,this.onHotkey)}triggerHandler(r){!this.props.disabled&&!this.props.hidden&&(this.props.name&&this.props.context.onClick(this.props.name,r),this.props.onClick&&this.props.onClick())}render(){return F.createElement("div",Object.assign({},Sp.getProps(this.props)),Sp.getContent(this.props,this.onClick))}}(function(n){function r(s,l){const{className:u,disabled:h,active:p,hidden:g}=s,{prefixCls:v}=s.context,b=`${v}-item`;return{className:Ii()(b,l,{[`${b}-active`]:p,[`${b}-hidden`]:g,[`${b}-disabled`]:h},u)}}n.getProps=r;function o(s,l,u,h){const{icon:p,text:g,hotkey:v,children:b}=s,{prefixCls:w}=s.context,A=`${w}-item`;return F.createElement(F.Fragment,null,F.createElement("button",{type:"button",className:`${A}-button`,onClick:l},p&&F.isValidElement(p)&&F.createElement("span",{className:`${A}-icon`},p),F.createElement("span",{className:`${A}-text`},g||b),v&&F.createElement("span",{className:`${A}-hotkey`},v),u),h)}n.getContent=o})(Sp||(Sp={}));const E_=n=>F.createElement(c1.Consumer,null,r=>F.createElement(Sp,Object.assign({context:r},n))),S_=()=>F.createElement(c1.Consumer,null,({prefixCls:n})=>F.createElement("div",{className:`${n}-item ${n}-item-divider`}));var A_=function(n,r){var o={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&r.indexOf(s)<0&&(o[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(n);l<s.length;l++)r.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(n,s[l])&&(o[s[l]]=n[s[l]]);return o};const T_=n=>{const{hotkey:r,children:o}=n,s=A_(n,["hotkey","children"]);return F.createElement(c1.Consumer,null,l=>{const{prefixCls:u}=l,h=Sp.getProps(Object.assign({context:l},n),`${u}-submenu`);return F.createElement("div",Object.assign({},h),Sp.getContent(Object.assign({context:l},s),null,F.createElement("span",{className:`${u}-submenu-arrow`}),F.createElement("div",{className:`${u}-submenu-menu`},o)))})};class Ap extends F.PureComponent{constructor(){super(...arguments),this.onClick=(r,o)=>{this.props.stopPropagation&&o!=null&&o.stopPropagation(),this.props.onClick&&this.props.onClick(r)},this.registerHotkey=(r,o)=>{this.props.registerHotkey&&this.props.registerHotkey(r,o)},this.unregisterHotkey=(r,o)=>{this.props.unregisterHotkey&&this.props.unregisterHotkey(r,o)}}render(){const{prefixCls:r,className:o,children:s,hasIcon:l}=this.props,u=`${r}-menu`,h=c1.Provider,p={prefixCls:u,onClick:this.onClick,registerHotkey:this.registerHotkey,unregisterHotkey:this.unregisterHotkey};return F.createElement("div",{className:Ii()(u,{[`${u}-has-icon`]:l},o)},F.createElement(h,{value:p},s))}}(function(n){n.Item=E_,n.Divider=S_,n.SubMenu=T_,n.defaultProps={prefixCls:"x6",stopPropagation:!1}})(Ap||(Ap={}));const gS=n=>{const{idx:r,menuOptions:o,target:s,modelService:l,commandService:u,onHide:h}=n,{id:p,label:g,isEnabled:v=!0,isVisible:b=!0,iconName:w,submenu:A=[],active:O,hotkey:D,render:_,onClick:I}=o;if(!b)return null;if(o.type==="separator")return F.createElement(Ap.Divider,{key:String(o.id)+r});if(o.type==="root")return F.createElement(Ap,{hasIcon:!0},A.map((G,K)=>gS({idx:K,target:s,commandService:u,modelService:l,menuOptions:G,onHide:h})));if(o.submenu&&Array.isArray(o.submenu)){const G=jd.get(w),K=!v;return F.createElement(Ap.SubMenu,{key:String(p),text:g,disabled:K||A.length===0,icon:G?F.createElement(G,null):null,active:O,hotkey:D},A.map((ve,ae)=>gS({idx:ae,target:s,commandService:u,modelService:l,menuOptions:ve,onHide:h})))}const B=jd.get(w);return _?F.createElement(_,{menuItem:o,target:s,commandService:u,modelService:l,onHide:h},[F.createElement(Ap.Item,{key:String(p),text:g,disabled:!v,icon:B?F.createElement(B,null):null,active:O,hotkey:D})]):F.createElement(Ap.Item,{key:String(p),text:g,disabled:!v,icon:B?F.createElement(B,null):null,active:O,hotkey:D,onClick:()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){yield I({menuItem:o,target:s,commandService:u,modelService:l}),h&&h()})})},M_=n=>{const{menuModel:r,target:o,onHide:s}=n,{modelService:l,commandService:u}=po(),[h]=XM(r);return gS({idx:-1,target:o,commandService:u,modelService:l,menuOptions:h,onHide:s})},P_=({toDispose:n})=>(F.useEffect(()=>()=>{n.dispose()},[n]),null),O_=()=>{const n=F.useRef(),r=po(),[o,,s]=$D({getModel:()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){return yield a1.getModel(r.modelService)}),initialState:{anchor:null,menuModel:null,target:null,customRender:null,toDispose:null}}),{target:l,anchor:u,menuModel:h,customRender:p,toDispose:g}=o;if(!l||!u||!h)return null;const v=()=>{s.setValue({anchor:null,menuModel:null,target:null,customRender:null,toDispose:null})},b=p?F.createElement(p,{target:l,modelService:r.modelService,onHide:v}):F.createElement(M_,{target:l,menuModel:h,onHide:v});return F.createElement("div",{className:"xflow-menu-mask",ref:n,onClick:v,onContextMenu:w=>{w.preventDefault(),w.stopPropagation()}},F.createElement(P_,{toDispose:g}),F.createElement(l1,{visible:!0,getPopupContainer:()=>n.current,overlay:b},F.createElement("div",{className:"xflow-context-menu-anchor",style:{top:u.y,left:u.x}})))},Ik="CanvasContextMenu",D_=n=>{const o=!!po(),s=F.useMemo(()=>n.config?n.config:new rb,[n.config]);return F.createElement(md,{createModule:l_,config:s},o&&F.createElement(O_,{config:s}))},__=n=>r=>{const o=F.useMemo(()=>({getValue:()=>({})}),[]);return o.getValue=()=>r,F.useMemo(()=>{const l=new rb;return n(l,o),l},[o])},mS="CanvasToolbar";class lP{constructor(){this.CONFIG_TYPE=mS,this.setToolbarName=r=>{this.moduleId=mS+"__"+r},this.setToolbarModelService=r=>{this.toolbarModelService=r},this.setCustomToolbarRender=r=>{this.customRenderService=r},this.getConfig=()=>({CONFIG_TYPE:this.CONFIG_TYPE,toolbarCustomRender:this.customRenderService,toolbarModelService:this.toolbarModelService}),this.moduleId=mS+"__"+Ol()}dispose(){}}var cP=P(11382);const vS=F.createContext({});class N_ extends F.PureComponent{constructor(){super(...arguments),this.handleClick=()=>{this.processClick()},this.handleDropdownItemClick=r=>{this.processClick(r,!1)}}processClick(r=this.props.name,o=this.props.dropdown){!this.props.disabled&&!o&&(r&&this.props.context.onClick(r),this.props.onClick&&this.props.onClick(r))}renderButton(){const{className:r,hidden:o,disabled:s,active:l,icon:u,text:h,dropdown:p,dropdownArrow:g,tooltip:v,tooltipProps:b,tooltipAsTitle:w,children:A}=this.props,{prefixCls:O}=this.props.context,D=`${O}-item`,_={onClick:this.handleClick,className:Ii()(D,{[`${D}-hidden`]:o,[`${D}-active`]:l,[`${D}-disabled`]:s,[`${D}-dropdown`]:p},r)};v&&w&&(_.title=v);const I=F.createElement("button",Object.assign({type:"button"},_),u&&F.isValidElement(u)&&F.createElement("span",{className:`${D}-icon`},u),(h||A)&&F.createElement("span",{className:`${D}-text`},h||A),p&&g&&F.createElement("span",{className:`${D}-dropdown-arrow`}));return v&&!w&&!s?F.createElement(i1.Z,Object.assign({title:v,placement:"bottom",mouseEnterDelay:0,mouseLeaveDelay:0},b),I):I}render(){const{dropdown:r,dropdownProps:o,disabled:s}=this.props,l=this.renderButton();if(r!=null&&!s){const u=F.createElement("div",null,r.type===Ap?F.cloneElement(r,{onClick:this.handleDropdownItemClick}):r),h=Object.assign(Object.assign({trigger:["click"]},o),{disabled:s,overlay:u});return F.createElement(l1,Object.assign({},h),l)}return l}}const uP=n=>F.createElement(vS.Consumer,null,r=>F.createElement(N_,Object.assign({context:r},n)));uP.defaultProps={dropdownArrow:!0};const k_=({children:n,className:r})=>F.createElement(vS.Consumer,null,({prefixCls:o})=>F.createElement("div",{className:Ii()(`${o}-group`,r)},n));class k0 extends F.PureComponent{constructor(){super(...arguments),this.onClick=(r,o)=>{this.props.onClick&&this.props.onClick(r,o)}}render(){const{prefixCls:r,className:o,children:s,extra:l,size:u,align:h,hoverEffect:p}=this.props,g=`${r}-toolbar`;return F.createElement("div",{className:Ii()(g,o,{[`${g}-${u}`]:u,[`${g}-align-right`]:h==="right",[`${g}-hover-effect`]:p})},F.createElement("div",{className:`${g}-content`},F.createElement("div",{className:`${g}-content-inner`},F.createElement(vS.Provider,{value:{prefixCls:g,onClick:this.onClick}},s)),l&&F.createElement("div",{className:`${g}-content-extras`},l)))}}(function(n){n.Item=uP,n.Group=k_,n.defaultProps={prefixCls:"x6",hoverEffect:!1}})(k0||(k0={}));const R_=n=>{const r=po(),{item:o,layout:s}=n,l=Ii()({["xflow-toolbar-item"]:!0}),u=s==="vertical"?"":o.text;let h;if(o.icon)h=o.icon;else if(o.iconName){const A=jd.get(o.iconName);h=F.createElement(A,null)}const p=o.render,{isEnabled:g=!0}=o,{commandService:v,modelService:b}=r,w=()=>{o.onClick&&o.onClick({toolbarItem:o,commandService:v,modelService:b})};return p?F.createElement(p,Object.assign({},o,{onClick:w}),F.createElement(k0.Item,Object.assign({},o,{icon:h,text:u,className:l,disabled:!g,tooltip:o.tooltip||o.text,tooltipProps:Object.assign({placement:s==="vertical"?"left":"bottom"},o.tooltipProps),onClick:()=>{}}))):F.createElement(k0.Item,Object.assign({},o,{icon:h,text:u,className:l,hidden:!o,disabled:!g,tooltip:o.tooltip||o.text,onClick:w,tooltipProps:Object.assign(Object.assign({},o.tooltipProps),{placement:s==="vertical"?"left":"bottom"})}))},I_=n=>{const{group:r,layout:o}=n,s=F.useMemo(()=>r.name||Ol(),[r.name]),{items:l=[]}=r;if(l.length===0)return null;const u=Ii()({["xflow-toolbar-group"]:!0});return F.createElement(k0.Group,{className:u,key:s},l.map(h=>F.createElement(R_,{item:h,layout:o,key:h.id})))},L_=n=>{const{config:r}=n,o=r.moduleId,s=po(),[l,u,h,p]=n1({name:o,layout:n.layout,mainGroups:[],extraGroups:[],customRender:null});return F.useEffect(()=>{const g=new qn;if(!s.modelService.findDeferredModel(o)){const{toolbarCustomRender:b,toolbarModelService:w}=r.getConfig(),A=s.modelService.registerModel({id:o,modelFactory:()=>h,watchChange:O=>(0,Vt.mG)(void 0,void 0,void 0,function*(){if(w&&(yield w(O,s.modelService,g)),b){const D=_=>{O.setValue(I=>I.customRender=_)};yield b(s.modelService,D)}return g})});g.push(A)}return()=>{g.dispose()}},[]),{isModelReady:p,state:l,setState:u,toolbarModel:h}},dP=n=>{const{idx:r,groups:o,layout:s,toolbarOptions:l}=n,{hoverEffect:u=!0}=l;return F.createElement(k0,{hoverEffect:u},o.map((h,p)=>{const g=r+p;return F.createElement(I_,{key:g,group:h,layout:s})}))},F_=n=>{const{isModelReady:r,state:o}=L_(n),s=cl(n.position),{mainGroups:l=[],extraGroups:u=[],layout:h,customRender:p}=o,g=Ii()(n.className,h,"xflow-toolbar"),v=Ii()({[h]:!0,["xflow-toolbar-root"]:!0});return r?p?F.createElement("div",{className:g,style:Object.assign(Object.assign({},s),n.style)},F.createElement(p,{config:o})):F.createElement("div",{className:g,style:Object.assign(Object.assign({},s),n.style)},F.createElement("div",{className:v},l.length>0&&F.createElement(dP,{idx:"mainGroups",groups:l,layout:h,toolbarOptions:o}),u.length>0&&F.createElement(dP,{idx:"extraGroups",groups:u,layout:h,toolbarOptions:o}))):F.createElement("div",{className:g,style:Object.assign(Object.assign({},s),n.style)},F.createElement(cP.Z,{spinning:!0,size:"small"}))},G_=F.memo(F_),hP=n=>{const o=!!po(),s=F.useMemo(()=>n.config?n.config:new lP,[n.config]);return o?F.createElement(G_,Object.assign({},n,{config:s})):null},fP=n=>r=>{const o=F.useMemo(()=>({getValue:()=>({})}),[]);return o.getValue=()=>r,F.useMemo(()=>{const l=new lP;return n(l,o),l},[o])};var B_=P(72504),z_=P(16130),U_=P(80068),V_=P(22699),j_=P(38296),H_=P(21444),ob;(function(n){jd.set("ZoomInOutlined",B_.Z),jd.set("ZoomOutOutlined",z_.Z),jd.set("OneToOneOutlined",U_.Z),jd.set("CompressOutlined",V_.Z),jd.set("FullscreenOutlined",j_.Z),jd.set("FullscreenExitOutlined",H_.Z),n.ZOOM_IN=rr.GRAPH_ZOOM.id+"-zoom-in",n.ZOOM_OUT=rr.GRAPH_ZOOM.id+"-zoom-out",n.SCALE_TO_ONE=rr.GRAPH_ZOOM.id+"-scale-to-one",n.SCALE_TO_FIT=rr.GRAPH_ZOOM.id+"-scale-to-fit",n.FULLSCREEN=rr.GRAPH_ZOOM.id+"-fullscreen",n.MAX_SCALE=1.5,n.MIN_SCALE=.05,n.zoomOptions={maxScale:n.MAX_SCALE,minScale:n.MIN_SCALE},n.getToolbarConfig=({zoomFactor:r,fullscreen:o})=>[{name:"main",items:[{id:n.ZOOM_IN,tooltip:"\u653E\u5927",iconName:"ZoomInOutlined",onClick:({commandService:s})=>{s.executeCommand(rr.GRAPH_ZOOM.id,{factor:.1,zoomOptions:n.zoomOptions})}},{id:n.ZOOM_OUT,tooltip:"\u7F29\u5C0F",iconName:"ZoomOutOutlined",onClick:({commandService:s})=>{s.executeCommand(rr.GRAPH_ZOOM.id,{factor:-.1,zoomOptions:n.zoomOptions})}},{id:n.SCALE_TO_ONE,iconName:"OneToOneOutlined",tooltip:"\u7F29\u653E\u52301:1",isEnabled:r!==1,onClick:({commandService:s})=>{s.executeCommand(rr.GRAPH_ZOOM.id,{factor:"real",zoomOptions:n.zoomOptions})}},{id:n.SCALE_TO_FIT,tooltip:"\u7F29\u653E\u5230\u9002\u5E94\u5C4F\u5E55",iconName:"CompressOutlined",onClick:({commandService:s})=>{s.executeCommand(rr.GRAPH_ZOOM.id,{factor:"fit",zoomOptions:n.zoomOptions})}},{id:n.FULLSCREEN,tooltip:o?"\u9000\u51FA\u5168\u5C4F":"\u5168\u5C4F",iconName:o?"FullscreenExitOutlined":"FullscreenOutlined",onClick:({commandService:s})=>{s.executeCommand(rr.GRAPH_FULLSCREEN.id,{})}}]}]})(ob||(ob={}));const Lk="CANVAS_SCALE_TOOLBAR",$_=fP(n=>{n.setToolbarModelService((r,o)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const s=yield Ua.useValue(o);r.setValue(h=>{h.mainGroups=ob.getToolbarConfig({zoomFactor:s.zoomFactor,fullscreen:!1})});const l=yield fu.getModel(o);l.setValue(!1),l.watch(h=>{r.setValue(p=>{p.mainGroups=ob.getToolbarConfig({zoomFactor:s.zoomFactor,fullscreen:h})})}),(yield Ua.getModel(o)).watch(({zoomFactor:h})=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const p=yield fu.useValue(o);r.setValue(g=>{g.mainGroups=ob.getToolbarConfig({zoomFactor:h,fullscreen:p})})}))}))}),W_=n=>{const r=$_(n);return F.createElement(hP,Object.assign({layout:"vertical"},n,{config:r,position:n.position||{top:12,right:12}}))};function Fk(n){const{className:r,layout:o,initialValues:s,form:l,formItems:u=[],onFinish:h,submitButton:p,buttonProps:g}=n;if(!l)return null;const v=o==="vertical"?{padding:"0px 12px"}:{padding:"8px 12px"};return React.createElement(Form,{size:"small",form:l,style:v,layout:o,onFinish:h,className:r,initialValues:s,labelCol:o==="vertical"?{span:24}:{span:8},wrapperCol:o==="vertical"?{span:24}:{span:16}},u.map(b=>React.createElement(Form.Item,Object.assign({label:b.label,name:b.name,rules:b.rules},b.itemProps),React.createElement(b.render,b.renderProps))),React.createElement(Form.Item,{wrapperCol:{offset:0,span:24}},p||React.createElement(Button,Object.assign({type:"primary",htmlType:"submit",style:{width:"100%"}},g),"\u6267\u884C\u547D\u4EE4")))}const Z_=Symbol("IMinimapConfigProvider");let yS=class{constructor(){this.toDispose=new qn,this.registerHookHub=()=>(0,Vt.mG)(this,void 0,void 0,function*(){return Rn.create(()=>{})}),this.registerHook=r=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=new qn,s=[r.graphOptions.registerHook({name:"add minimap options",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){const u=yield this.minimapConfig.getConfig();l.minimap=Object.assign({},u)})})];return o.pushAll(s),Rn.create(()=>{})})}};(0,Vt.gn)([Rt(Z_),(0,Vt.w6)("design:type",Object)],yS.prototype,"minimapConfig",void 0),yS=(0,Vt.gn)([Dn({contrib:ga})],yS);const Gk=n=>ManaSyringe.Module(r=>{r(IMinimapConfigProvider,{useDynamic:()=>n}),r(HookContribution)});class sb extends Yr.DK{renderMarkup(){return this.renderJSONMarkup({tagName:"rect",selector:"body"})}update(){super.update({body:{refWidth:"100%",refHeight:"100%",fill:sb.nodeFillColor}})}}sb.nodeFillColor="#31d0c6",sb.setNodeFillColor=n=>{sb.nodeFillColor=n};const X_="CanvasMiniMap",Y_=()=>({grid:!1,enabled:!0,width:200,height:120,padding:8,graphOptions:{async:!0,getCellView(n){if(n.isNode())return SimpleNodeView},createCellView(n){if(n.isEdge())return null}}}),Bk=n=>{const{nodeFillColor:r,borderColor:o="#ced4de",handlerColor:s="rgba(0,0,0,.3)",miniMapClz:l="",position:u={bottom:12,right:12},minimapOptions:h={}}=n,p=React.useRef(null),g=React.useRef(n.minimapOptions),v=React.useMemo(()=>new Set([l,"xflow-minimap","minimap-instacne-"+Date.now().toString()]),[l]),b=React.useMemo(()=>()=>__awaiter(void 0,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},Y_()),g.current),{container:p.current})}),[p]),w=usePositionStyle(u);React.useEffect(()=>{g.current=h},[g,h]),React.useEffect(()=>{r&&SimpleNodeView.setNodeFillColor(r)},[r]),React.useEffect(()=>{const O=Array.from(v).reduce((I,B)=>B?`${I}.${B}`:I,""),D=`
      ${O} .x6-widget-minimap-viewport {
        border: 1px solid ${o};
        margin: 0;
      }
      ${O} .x6-widget-minimap-viewport-zoom {
        border: 1px solid ${s};
      }
    `,_=insertCss(D);return()=>{document.head.removeChild(_)}},[o,v,s]);const A=Array.from(v).join(" ");return React.createElement(XFlowAppExtensionModule,{config:{getConfig:b,CONFIG_TYPE:X_},createModule},React.createElement("div",{ref:p,className:A,style:w}))};class K_{constructor(){this.getValue=()=>({})}dispose(){this.getValue=()=>null}}class zk{constructor(r){this.moduleId=r}dispose(){}}const pP=F.createContext({propsProxy:null,commandService:null,modelService:null}),ab=()=>F.useContext(pP),gP=n=>{const{className:r,position:o,style:s,children:l}=n,u=po(),h=cl(o),p=F.useMemo(()=>new K_,[]);if(F.useEffect(()=>()=>{p.dispose()},[p]),!u||!u.modelService)return null;p.getValue=()=>n;const g=Ii()({[r]:!!r,"xflow-workspace-panel":!0}),{commandService:v,modelService:b}=u;return F.createElement(pP.Provider,{value:{propsProxy:p,commandService:v,modelService:b}},F.createElement("div",{className:g,style:Object.assign(Object.assign({},h),s)},l))};var q_=P(7573);const R0={HORIRONTAL_NODE:"xflow-node-horizontal-edge",VERTICAL_NODE:"xflow-node-vertical-edge",VERTICAL_GROUP:"xflow-group-vertical-edge"},u1={EDGE:"xflow-edge"},bS="XFLOW_NODE_SHAPE",mP="processing",J_=160,Q_=32;var I0;(function(n){n.id="GRAPH_STATUS_INFO";let r;(function(o){o.SUCCESS="success",o.PROCESSING="processing",o.ERROR="error",o.DEFAULT="default",o.WARNING="warning"})(r=n.StatusEnum||(n.StatusEnum={})),n.getModel=$i(n.id),n.useValue=io(n.id)})(I0||(I0={}));var d1;(function(n){n.QUERY_GRAPH_STATUS={id:"xflow:query-graph-status",label:"\u67E5\u8BE2\u753B\u5E03\u8282\u70B9\u72B6\u6001"}})(d1||(d1={}));let h1;const{AnchorGroup:f1}=fo;Yr.NB.registry.exist(bS)?h1=Yr.NB.registry.get(bS):h1=uh.ep.define({width:J_,height:Q_,shape:bS,view:Ml,ports:{groups:{top:{zIndex:2,position:{name:f1.TOP}},bottom:{zIndex:2,position:{name:f1.BOTTOM}},right:{zIndex:2,position:{name:f1.RIGHT}},left:{zIndex:2,position:{name:f1.LEFT}}}},attrs:{body:{magnet:!1,fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%",zIndex:1}},portMarkup:[{tagName:"g",selector:"xflow-port-group",className:"xflow-port-group",attrs:{width:8,height:8,x:-4,y:-4,zIndex:10,magnet:"true"},children:[{tagName:"circle",selector:"xflow-port",className:"xflow-port",attrs:{r:4,fill:"#fff",stroke:"#d9d9d9",zIndex:12}},{tagName:"polygon",selector:"xflow-port-arrow",className:"xflow-port-arrow",attrs:{points:"0,0 8,0 4,4 ",fill:"#d9d9d9",stroke:"#d9d9d9",zIndex:13,transform:"translate(-4,0)"}}]}]});const{DirectoryTree:e3,TreeNode:vP}=q_.Z,t3=({expanded:n})=>n?React.createElement(FolderOpenFilled,null):React.createElement(FolderFilled,null),n3=n=>new XFlowNode(n),yP=n=>{const{nodeConfig:r,onMouseDown:o,graphConfig:s,modelService:l,commandService:u}=n;if(!s)return React.createElement("div",null);if(r.renderComponent)return React.createElement("div",{onMouseDown:o},React.createElement(r.renderComponent,{data:r,isNodeTreePanel:!0}));const h=s.nodeTypeParser(r)||XFlowConstants.XFLOW_DEFAULT_NODE,p=s.nodeRender.get(h);return React.createElement("div",{onMouseDown:o},React.createElement(p,{commandService:u,modelService:l,data:r,isNodeTreePanel:!0}))},bP=n=>{const[r,o]=useState(!1),[s,l]=useState(),{getGraphConfig:u}=useXFlowApp();u().then(O=>{l(O.appContainer)});const{prefixClz:h,graphConfig:p,commandService:g,modelService:v,popoverContent:b,onMouseDown:w,item:A}=n;return React.createElement(React.Fragment,null,b&&React.createElement(Popover,{placement:"right",destroyTooltipOnHide:!0,content:b,visible:r,onVisibleChange:O=>{o(O)},getPopupContainer:()=>s||document.body},React.createElement("div",{className:`${h}-node-wrapper`,onMouseEnter:()=>{o(!0)}},yP({graphConfig:p,commandService:g,onMouseDown:w,modelService:v,nodeConfig:A}))),!b&&React.createElement("div",{className:`${h}-node-wrapper`,onMouseEnter:()=>{o(!0)}},yP({graphConfig:p,commandService:g,onMouseDown:w,modelService:v,nodeConfig:A})))},Uk=n=>{const{x6NodeFactory:r,dndOptions:o,onNodeDrop:s,state:l,onFolderExpand:u,prefixClz:h}=n,{graphProvider:p,modelService:g,commandService:v}=useXFlowApp(),[b,w]=React.useState(),[A,O]=React.useState(),[D,_]=React.useState();p.getGraphInstance().then(G=>{_(G)}),React.useEffect(()=>{if(p.getGraphOptions().then(K=>{w(K)}),!D)return;const G=new Addon.Dnd(Object.assign(Object.assign({scaled:!1,animation:!1},o),{target:D,validateNode:K=>__awaiter(void 0,void 0,void 0,function*(){const ve=Object.assign(Object.assign({},K.getData()),K.getPosition());return s?yield s(ve,v,g):console.error("onNodeDrop method is required in NodeTree Panel"),!1})}));O(G)},[v,o,D,p,g,s]);const I=React.useCallback(G=>K=>{if(!D||!A||!b)return;const ve=b.nodeTypeParser(G),ae=G.renderComponent?G.renderComponent:b.nodeRender.get(ve),Ye=getNodeReactComponent(ae,v,g),rt={data:G,width:G.width||180,height:G.height||40,view:b.graphId,component:Ye},st=r?r(rt):n3(rt);A.start(st,K.nativeEvent)},[v,A,D,b,g,r]),B=React.useCallback((G=[])=>G.map(K=>{const{isDirectory:ve,children:ae,popoverContent:Ye}=K;return ve?React.createElement(vP,{icon:t3,key:K.id,title:K.label,className:`${h}-tree-folder`},B(ae)):React.createElement(vP,{isLeaf:!0,key:K.id,className:`${h}-tree-leaf`,icon:React.createElement("span",null),title:React.createElement(bP,{item:K,onMouseDown:I(K),popoverContent:Ye,prefixClz:h,modelService:g,commandService:v,graphConfig:b})})}),[v,b,g,I,h]);return React.createElement(React.Fragment,null,React.createElement("div",{className:`${h}-body`,style:n.style},!l.keyword&&React.createElement(e3,{showIcon:!0,selectable:!1,autoExpandParent:!1,onExpand:u,expandedKeys:l.expandedKeys,className:`${h}-tree`},B(l.treeData)),l.searchList.length>0&&React.createElement("ul",{className:`${h}-body-list`},l.searchList.map(G=>React.createElement("li",{className:`${h}-body-list-item`},React.createElement(bP,{item:G,onMouseDown:I(G),popoverContent:G.popoverContent,prefixClz:h,modelService:g,commandService:v,graphConfig:b})))),l.keyword&&l.searchList.length===0&&React.createElement(Empty,{style:{marginTop:"48px"}})))},Vk=n=>{const{prefixClz:r,onKeywordChange:o}=n,{propsProxy:s}=usePanelContext(),l=s.getValue();return React.createElement(React.Fragment,null,React.createElement("div",{className:`${r}-header`,style:n.style},l.header&&React.isValidElement(l.header)&&l.header,l.searchService&&React.createElement("div",{className:`${r}-header-search`},React.createElement(Input,{placeholder:"\u641C\u7D22\u7EC4\u4EF6",allowClear:!0,onChange:u=>o(u.target.value),style:{width:"100%",border:0}}))))},jk=n=>{const{prefixClz:r}=n,{propsProxy:o}=usePanelContext(),s=o.getValue();return React.createElement(React.Fragment,null,React.createElement("div",{className:`${r}-footer`,style:n.style},s.footer&&React.isValidElement(s.footer)&&s.footer))},Hk=n=>{const r=n&&n.headerPosition&&n.headerPosition.height||PANEL_HEADER_HEIGHT,o=n.footerPosition&&n.footerPosition.height||PANEL_FOOTER_HEIGHT;return{headerStyle:usePositionStyle(Object.assign({height:r,lineHeight:r,top:0,left:0,right:0},n.headerPosition)),bodyStyle:usePositionStyle(Object.assign({left:0,right:0,top:r,bottom:o},n.bodyPosition)),footerStyle:usePositionStyle(Object.assign({left:0,right:0,lineHeight:o,height:o,bottom:0},n.footerPosition))}};var $k=P(45578),lb;(function(n){n.id="TREE_PANEL_MODEL",n.useModel=r=>(0,Vt.mG)(this,void 0,void 0,function*(){return r.awaitModel(n.id)})})(lb||(lb={}));const Wk=(n,r)=>{n.executeCommand(XFlowModelCommands.UPDATE_MODEL.id,{getModel:o=>__awaiter(void 0,void 0,void 0,function*(){return lb.useModel(o)}),updateModel:r})},Zk=n=>{const{treeDataService:r,searchService:o}=n,{modelService:s}=useXFlowApp(),[l,u,h]=createComponentModel({treeData:[],searchList:[],treeNodeList:[],expandedKeys:[],defaultExpandAll:!1,keyword:""});React.useEffect(()=>{s.findDeferredModel(lb.id)||s.registerModel({id:lb.id,modelFactory:()=>h,watchChange:v=>__awaiter(void 0,void 0,void 0,function*(){const b=yield MODELS.GRAPH_META.getModel(s),w=O=>__awaiter(void 0,void 0,void 0,function*(){const D=yield r(O,s),{treeData:_,rootNodes:I}=r3(D),B=yield v.getValidValue(),G=B.expandedKeys.length>0?B.expandedKeys:I.map(K=>K.id);return{listData:D,treeData:_,expandedKeys:G}}),A=b.watch(O=>__awaiter(void 0,void 0,void 0,function*(){const D=yield w(O);v.setValue({treeNodeList:D.listData,treeData:D.treeData,expandedKeys:D.expandedKeys,defaultExpandAll:!1,keyword:"",searchList:[]})}));return Disposable.create(()=>{A.dispose()})})})},[]);const p=React.useCallback(v=>{u(b=>{b.expandedKeys=v})},[u]),g=React.useCallback(v=>__awaiter(void 0,void 0,void 0,function*(){if(!o)return console.warn("searchService is not defined");if(v){const b=yield o(l.treeNodeList,v);u(w=>{w.keyword=v,w.searchList=b})}else u(b=>{b.keyword="",b.searchList=[]})}),[o,l.treeNodeList]);return{state:l,setState:u,onKeywordChange:g,onFolderExpand:p}};function r3(n=[]){const o=(h=>uniqBy(h,"id").reduce((v,b)=>{const w=b.parentId||TREE_ROOT_ID;return v.has(w)||v.set(w,[]),v.get(w).push(b),v},new Map))(cloneDeep(n));function s(h,p){return h.map(g=>{if(p.has(g.id)){const v=p.get(g.id);g.key=g.id,g.isDirectory=!0,g.children=s(v,p)||[]}else g.isLeaf=!0;return g})}const l=o.get(TREE_ROOT_ID)||[];return{treeData:s(l,o),rootNodes:l}}var xP;(function(n){n.id="TREE_PANEL_DATA"})(xP||(xP={}));const i3=n=>{const{headerStyle:r,bodyStyle:o,footerStyle:s}=usePanelLyaoutStyle(n),{state:l,onFolderExpand:u,onKeywordChange:h}=useTreePanelData(n);return React.createElement(React.Fragment,null,React.createElement(NodePanelHeader,Object.assign({},n,{state:l,style:r,onKeywordChange:h})),React.createElement(NodePanelBody,Object.assign({},n,{state:l,style:o,onFolderExpand:u})),React.createElement(NodePanelFooter,Object.assign({},n,{state:l,style:s})))},Xk=n=>{const r=useXflowPrefixCls("node-dnd-panel");return React.createElement(WorkspacePanel,Object.assign({},n,{className:r}),React.createElement(i3,Object.assign({},n,{prefixClz:r})))},o3=n=>new h1(n),s3=n=>{const{x6NodeFactory:r,dndOptions:o,onNodeDrop:s}=n,{graphProvider:l,modelService:u,commandService:h}=po(),[p,g]=F.useState(),[v,b]=F.useState(),[w,A]=F.useState();F.useEffect(()=>{l.getGraphInstance().then(D=>{A(D)}),l.getGraphOptions().then(D=>{g(D)})},[l,A,g]),F.useEffect(()=>{if(!w)return;const D=new Yr.e9.q6(Object.assign(Object.assign({scaled:!1,animation:!1},o),{target:w,validateNode:_=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const I=Object.assign(Object.assign({},_.getData()),_.getPosition());return s?yield s(I,h,u):console.error("onNodeDrop method is required in NodeTree Panel"),!1})}));return b(D),()=>{D.dispose()}},[h,u,o,w,s]);const O=F.useCallback(D=>_=>{if(!w||!v||!p||D.isDisabled)return;const I=p.nodeTypeParser(D),B=D.renderComponent?D.renderComponent:p.nodeRender.get(I),G=Qg(B,h,u),K={data:D,width:D.width||180,height:D.height||40,view:p.graphId,component:G},ve=r?r(K):o3(K);v.start(ve,_.nativeEvent)},[h,v,w,p,u,r]);return{graphConfig:p,onMouseDown:O,modelService:u,commandService:h}};var cb=P(14277),a3=P(55241);const CP=n=>{const{nodeConfig:r,onMouseDown:o,graphConfig:s,modelService:l,commandService:u}=n;if(!s)return F.createElement("div",null);if(r.renderComponent)return F.createElement("div",{onMouseDown:o},F.createElement(r.renderComponent,{data:r,isNodePanel:!0}));const h=s.nodeTypeParser(r)||Pl,p=s.nodeRender.get(h);return F.createElement("div",{onMouseDown:o},F.createElement(p,{commandService:u,modelService:l,data:r,isNodeTreePanel:!0}))},wP=n=>{const[r,o]=F.useState(!1),{prefixClz:s,graphConfig:l,commandService:u,modelService:h,popoverContent:p,onMouseDown:g,item:v}=n;return F.createElement(F.Fragment,null,p?F.createElement(a3.Z,{placement:"right",destroyTooltipOnHide:!0,content:p,visible:r,onVisibleChange:b=>{o(b)}},F.createElement("div",{className:`${s}-node-wrapper`,onMouseEnter:()=>{o(!0)}},CP({graphConfig:l,commandService:u,onMouseDown:g,modelService:h,nodeConfig:v}))):F.createElement("div",{className:`${s}-node-wrapper`},CP({graphConfig:l,commandService:u,onMouseDown:g,modelService:h,nodeConfig:v})))},l3=n=>{const{searchResult:r,prefixClz:o,onMouseDown:s,modelService:l,commandService:u,graphConfig:h}=n;return r.length===0?F.createElement(cb.Z,{style:{marginTop:"24px"}}):F.createElement("ul",{className:"xflow-collapse-search-list"},r.map(p=>F.createElement("li",{className:`xflow-collapse-search-list-item ${p.isDisabled?"disabled":""}`,key:p.id},F.createElement(wP,{item:p,onMouseDown:s(p),popoverContent:p.popoverContent,prefixClz:o,modelService:l,commandService:u,graphConfig:h}))))};var c3=P(25782);const u3=n=>{const{onActiveKeyChange:r,collapseData:o,prefixClz:s,onMouseDown:l,modelService:u,commandService:h,graphConfig:p}=n,g=b=>{const{header:w,extra:A,icon:O,isCollapsed:D}=b,_=I=>{I.preventDefault(),r(b.id)};return F.createElement("div",{className:"xflow-collapse-header",onClick:_},F.createElement("div",{className:"xflow-collapse-header-icon"},Sf(O)?F.createElement(O,{isCollapsed:D}):F.createElement(c3.Z,{rotate:D?0:90,style:{fontSize:"12px"}})),F.createElement("div",{className:"xflow-collapse-header-label"},Sf(w)?F.createElement(w,b):w),F.createElement("div",{className:"xflow-collapse-header-extra"},Sf(A)?F.createElement(A,b):A))},v=b=>F.createElement("div",{className:"xflow-collapse-content"},b.map(w=>F.createElement("div",{className:`xflow-collapse-content-item ${w.isDisabled?"disabled":""}`,key:w.id},F.createElement(wP,{item:w,onMouseDown:l(w),popoverContent:w.popoverContent,prefixClz:s,modelService:u,commandService:h,graphConfig:p}))));return F.createElement("ul",{className:"xflow-collapse-list"},o.length===0&&F.createElement(cb.Z,{style:{marginTop:"24px"}}),o.map(b=>{const{children:w=[],isCollapsed:A,render:O}=b,D=A?"close":"open";return F.createElement("li",{className:`xflow-collapse-list-item ${D}`,key:b.id},g(b),Sf(O)?F.createElement(O,b):v(w))}))},d3=n=>{const{state:r,prefixClz:o,onActiveKeyChange:s}=n,{graphConfig:l,onMouseDown:u,modelService:h,commandService:p}=s3(n),{searchResult:g,collapseData:v,keyword:b}=r;return F.createElement("div",{className:`${o}-body`,style:n.style},b.length===0&&F.createElement(u3,{onActiveKeyChange:s,collapseData:v,onMouseDown:u,modelService:h,commandService:p,graphConfig:l,prefixClz:o}),b.length>0&&F.createElement(l3,{searchResult:g,onMouseDown:u,modelService:h,commandService:p,graphConfig:l,prefixClz:o}))};var p1=P(4107);const h3=n=>{const{prefixClz:r,onKeywordChange:o,state:s}=n,{propsProxy:l}=ab(),u=l.getValue(),h=p=>{const g=s.collapseData.reduce((v,b)=>(b.children&&v.push(...b.children),v),[]);o(p.target.value,g)};return F.createElement(F.Fragment,null,F.createElement("div",{className:`${r}-header`,style:n.style},u.header&&F.isValidElement(u.header)&&u.header,u.searchService&&F.createElement("div",{className:`${r}-header-search`},F.createElement(p1.Z,{placeholder:"\u641C\u7D22\u7EC4\u4EF6",allowClear:!0,onChange:p=>h(p),style:{width:"100%",border:0}}))))},f3=n=>{const{prefixClz:r}=n,{propsProxy:o}=ab(),s=o.getValue();return F.createElement(F.Fragment,null,F.createElement("div",{className:`${r}-footer`,style:n.style},s.footer&&F.isValidElement(s.footer)&&s.footer))};var p3=P(85663);const g3=n=>{const{prefixClz:r,onCollapseBtnClick:o,isCollapsed:s,collapseButtonStyle:l,style:u}=n;return F.createElement(F.Fragment,null,F.createElement("div",{className:`${r}-header`,style:Object.assign(Object.assign({},u),l),onClick:o},F.createElement(p3.Z,{rotate:s?180:0})))},m3=40,v3=40,y3=n=>{const r=n&&n.headerPosition&&n.headerPosition.height||m3,o=n.footerPosition&&n.footerPosition.height||v3;return{headerStyle:cl(Object.assign({height:r,lineHeight:r,top:0,left:0,right:0},n.headerPosition)),bodyStyle:cl(Object.assign({left:0,right:0,top:r,bottom:o},n.bodyPosition)),footerStyle:cl(Object.assign({left:0,right:0,lineHeight:o,height:o,bottom:0},n.footerPosition))}};var g1;(function(n){n.id="COLLAPSE_PANEL_DATA",n.useModel=r=>(0,Vt.mG)(this,void 0,void 0,function*(){return r.awaitModel(n.id)})})(g1||(g1={}));const Yk=(n,r)=>{n.executeCommand(XFlowModelCommands.UPDATE_MODEL.id,{getModel:o=>__awaiter(void 0,void 0,void 0,function*(){return NsCollapsePanelModel.useModel(o)}),updateModel:r})},b3=n=>{const{collapsible:r,nodeDataService:o,searchService:s,onCollapseChange:l}=n,{modelService:u}=po(),[h,p,g]=n1({keyword:"",collapseData:[],searchResult:[]});F.useEffect(()=>{u.findDeferredModel(g1.id)||u.registerModel({id:g1.id,modelFactory:()=>g,watchChange:w=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const A=yield Tc.getModel(u),O=_=>(0,Vt.mG)(void 0,void 0,void 0,function*(){return{collapseData:yield o(_,u)}}),D=A.watch(_=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const{collapseData:I}=yield O(_);w.setValue(B=>{B.keyword="",B.collapseData=I,B.searchResult=[]})}));return Rn.create(()=>{D.dispose()})})})},[]);const v=F.useCallback(w=>{p(A=>{A.collapseData.forEach(O=>{O.id===w&&O.collapsible!==!1&&(O.isCollapsed=!O.isCollapsed)})})},[p]),b=F.useCallback((w,A)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){if(!s)return console.warn("searchService is not defined");if(w){const O=yield s(A,w);p(D=>{D.keyword=w,D.searchResult=O})}else p(O=>{O.keyword="",O.searchResult=[]})}),[s]);return{state:h,collapsible:r,setState:p,onKeywordChange:b,onActiveKeyChange:v,onCollapseChange:l}},x3=n=>{const{headerStyle:r,bodyStyle:o,footerStyle:s}=y3(n),{state:l,onActiveKeyChange:u,onKeywordChange:h}=b3(n);return F.createElement(F.Fragment,null,F.createElement(h3,Object.assign({},n,{state:l,style:r,onKeywordChange:h})),F.createElement(d3,Object.assign({},n,{state:l,style:o,onActiveKeyChange:u})),F.createElement(f3,Object.assign({},n,{state:l,style:s})))},C3=n=>{const{position:r,collapsible:o,onCollapseChange:s}=n,{width:l=200,left:u}=r,h=gd("collapse-panel"),[p,g]=(0,F.useState)(!1),v=(0,F.useCallback)(()=>{g(!p),s(!p)},[p,s]);return F.createElement(gP,Object.assign({},n,{className:h,position:Object.assign(Object.assign({},r),{left:p?-l:u}),style:{transition:"left 0.5s"}}),F.createElement(x3,Object.assign({},n,{prefixClz:h})),o&&F.createElement(g3,Object.assign({},n,{prefixClz:h,isCollapsed:p,onCollapseBtnClick:v,style:{position:"absolute",zIndex:1,width:13,right:-13,bottom:20,padding:"12px 0px",textAlign:"center",borderWidth:"1px 1px 1px 0",borderStyle:"solid solid solid",borderColor:"rgb(232, 232, 232) rgb(232, 232, 232) rgb(232, 232, 232)",cursor:"pointer"}})))},w3=n=>{const{state:r}=n,{propsProxy:o}=ab(),s=o.getValue(),l=po(),u=s.footer&&typeof s.footer=="function";return F.createElement(F.Fragment,null,F.createElement("div",{className:`${n.prefixClz}-footer`,style:n.style},u&&F.createElement(s.footer,Object.assign(Object.assign({},n),{headerStyle:{},bodyStyle:{},footerStyle:n.style,targetData:r.targetData,targetType:r.targetType,modelService:l.modelService,commandService:l.commandService})),!s.footer&&F.createElement("div",{className:`${n.prefixClz}-footer-title`},s.footerText)))},E3=n=>{const{prefixClz:r,hasSchema:o,state:s}=n,{propsProxy:l}=ab(),u=l.getValue(),h=po();if(o)return null;const p=u.header&&typeof u.header=="function";return F.createElement(F.Fragment,null,F.createElement("div",{className:`${r}-header`,style:n.style},p&&F.createElement(u.header,Object.assign(Object.assign({},n),{headerStyle:n.style,bodyStyle:{},footerStyle:{},targetData:s.targetData,targetType:s.targetType,modelService:h.modelService,commandService:h.commandService})),!u.header&&F.createElement("div",{className:`${r}-header-title`},u.headerText||"Panel")))};var EP=P(51752),qh=P(71257);const S3=n=>{const{text:r}=n,o=(0,Vt._T)(n,["text"]);return r?F.createElement(i1.Z,Object.assign({placement:"left",title:r},o),F.createElement("div",{className:"text-truncate"},r)):null};function L0(n){if(!!n)return F.createElement(S3,{text:n})}var A3=P(27361),SP=P.n(A3);function T3(n,r){return(o,s)=>n.some(u=>typeof(u==null?void 0:u.condition)=="function")?(typeof r=="function"&&r(void 0),!0):n.some(u=>{const{name:h}=u;return h?SP()(o,h)!==SP()(s,h)?(typeof r=="function"&&r(h),!0):!1:(console.error("[Schema form]: A dependent name must be provided in the updater when the dependency condition is not a function."),!1)})}function M3(n){return n===""||n===void 0}function P3(n,r,o){const{getFieldValue:s,getFieldsValue:l}=n,{dependencies:u,hidden:h,disabled:p}=r;let g=h,v=p;return u==null||u.forEach(b=>{const{name:w,condition:A,hidden:O,disabled:D}=b;if(typeof A!="function"&&o&&w!==o)return;let _=!1;if(typeof A=="function"){const I=l();_=!!A(I)}else{if(!w){console.error("[Schema form]: A dependent name must be provided in the props genarator when the dependency condition is not a function.");return}_=s(w)===A}_&&(O!==void 0&&(g=O),D!==void 0&&(v=D))}),{hidden:g,disabled:v}}const Tp=n=>{const{schema:r,children:o}=n,[s,l]=(0,F.useState)(),{dependencies:u,value:h,defaultValue:p,hidden:g,disabled:v}=r,b=(0,F.useMemo)(()=>u!=null&&u.length?T3(u,l):void 0,[u]);if(typeof o!="function")throw new Error("[Schema Form]: chilren of FormItemWrapper should be a render prop.");const w=M3(h)?p:h;return b?F.createElement(qh.Z.Item,{noStyle:!0,shouldUpdate:b},A=>{const{hidden:O,disabled:D}=P3(A,r,s);return o({hidden:O,disabled:D,initialValue:w})}):o({hidden:g,disabled:v,initialValue:w})},AP=n=>{const{controlSchema:r}=n,{required:o,tooltip:s,extra:l,name:u,label:h,placeholder:p,rules:g}=r;return F.createElement(Tp,{schema:r},({disabled:v,hidden:b,initialValue:w})=>F.createElement(qh.Z.Item,{name:u,label:h,initialValue:w,tooltip:s,extra:L0(l),required:o,hidden:b,rules:g},F.createElement(p1.Z,{className:"xflow-form-input",allowClear:!0,placeholder:p,disabled:v})))};var O3=P(9676);const D3=n=>{const{controlSchema:r}=n,{required:o,tooltip:s,extra:l,name:u,label:h,rules:p}=r;return F.createElement(Tp,{schema:r},({hidden:g,disabled:v,initialValue:b})=>F.createElement(qh.Z.Item,{className:"xflow-form-checkbox",name:u,rules:p,initialValue:b,tooltip:s,extra:L0(l),required:o,hidden:g,valuePropName:"checked",getValueProps:w=>({checked:!!{true:!0,false:!1}[w]})},F.createElement(O3.Z,{disabled:v},h)))},_3=n=>{const{controlSchema:r}=n,{required:o,tooltip:s,extra:l,name:u,label:h,placeholder:p,rules:g}=r;return F.createElement(Tp,{schema:r},({hidden:v,disabled:b,initialValue:w})=>F.createElement(qh.Z.Item,{name:u,label:h,initialValue:w,tooltip:s,extra:L0(l),required:o,hidden:v,rules:g},F.createElement(p1.Z.TextArea,{allowClear:!0,placeholder:p,rows:3,disabled:b})))};var xS=P(34041);const N3=n=>{const{controlSchema:r}=n,{required:o,tooltip:s,extra:l,name:u,label:h,placeholder:p,options:g=[],rules:v}=r;return F.createElement(Tp,{schema:r},({hidden:b,disabled:w,initialValue:A})=>F.createElement(qh.Z.Item,{name:u,label:h,initialValue:A,tooltip:s,extra:L0(l),required:o,hidden:b,rules:v},F.createElement(xS.Z,{disabled:w,placeholder:p},g.map(O=>{const{title:D,value:_}=O;return F.createElement(xS.Z.Option,{key:_.toString(),value:_},D)}))))};var k3=P(95405),R3=P(30381),CS=P.n(R3);const I3=n=>{const{className:r,style:o,disabled:s,value:l,onChange:u}=n,[h,p]=(0,F.useState)(l?CS()(l):void 0),g=(0,F.useRef)(!1);(0,F.useEffect)(()=>{if(!g.current){g.current=!0;return}const b=CS()(l);b.isValid()&&p(b)},[l]);const v=(0,F.useCallback)((b,w)=>{const A=CS()(w);p(A.isValid()?A:void 0),typeof u=="function"&&u(A.isValid()?A.format("YYYY-MM-DD HH:mm:ss"):"")},[u]);return F.createElement(k3.Z,{showTime:!0,allowClear:!0,className:r,style:o,disabled:s,value:h,onChange:v})},L3=n=>{const{controlSchema:r}=n,{required:o,tooltip:s,extra:l,name:u,label:h,rules:p}=r;return F.createElement(Tp,{schema:r},({disabled:g,hidden:v,initialValue:b})=>F.createElement(qh.Z.Item,{name:u,label:h,initialValue:b,tooltip:s,extra:L0(l),required:o,hidden:v,rules:p},F.createElement(I3,{style:{width:"100%"},disabled:g})))};var wS=P(85986);function m1(n){const r=Number(n);return Number.isNaN(r)?void 0:r}const F3=n=>{const{disabled:r,placeholder:o,value:s,onChange:l}=n,[u,h]=(0,F.useState)(m1(s)),p=(0,F.useRef)(!1);(0,F.useEffect)(()=>{p.current||(p.current=!0),h(m1(s))},[s]);const g=(0,F.useCallback)(v=>{h(v),typeof l=="function"&&(v===void 0?l(""):typeof m1(v)=="number"&&l(m1(v)))},[l]);return F.createElement(wS.Z,{style:{width:"100%"},size:"small",placeholder:o,value:u,onChange:g,disabled:r})},G3=n=>{const{controlSchema:r}=n,{required:o,tooltip:s,extra:l,name:u,label:h,placeholder:p,rules:g}=r;return F.createElement(Tp,{schema:r},({disabled:v,hidden:b,initialValue:w})=>F.createElement(qh.Z.Item,{name:u,label:h,initialValue:w,tooltip:s,extra:L0(l),required:o,hidden:b,rules:g},F.createElement(F3,{placeholder:p,disabled:v})))};var Mp;(function(n){n.INPUT="input",n.CHECKBOX="checkbox",n.TEXTAREA="textArea",n.SELECT="select",n.DATETIME="datetime",n.FLOAT="float"})(Mp||(Mp={}));const TP=[[Mp.INPUT,AP],[Mp.CHECKBOX,D3],[Mp.TEXTAREA,_3],[Mp.DATETIME,L3],[Mp.SELECT,N3],[Mp.FLOAT,G3]],MP=n=>{const r=new Map;return n.forEach(o=>{const[s,l]=o,u=s.toLowerCase();r.has(u)&&console.error(`${s} is duplicated in controlMap:`,r),r.set(u,l)}),r},B3=(n,r,o=AP)=>{if(r.has(n))return r.get(n);const s=n.toLowerCase();return r.has(s)?r.get(s):(console.warn(`${n} is not exist in controlmap, fallback to defaultControl`),o)},{TabPane:z3}=EP.Z,U3=n=>{var r;const{schema:o,form:s,className:l,triggerUpdate:u,defaultControlRender:h,afterUpdatingCb:p,controlMap:g}=n,v=(0,Vt._T)(n,["schema","form","className","triggerUpdate","defaultControlRender","afterUpdatingCb","controlMap"]),{tabs:b}=o,[w]=qh.Z.useForm(s),A=F.useMemo(()=>n.controlMap?n.controlMap:MP(TP),[n.controlMap]),O=(0,F.useCallback)(_=>{typeof u=="function"&&u(w,_)},[w,u]);(0,F.useEffect)(()=>{w.setFieldsValue({})},[w]);const D=(0,F.useCallback)(()=>{requestAnimationFrame(()=>{w.setFieldsValue({})})},[w]);return F.createElement(qh.Z,Object.assign({size:"small",form:w,layout:"vertical",className:Ii()("xflow-json-form",l)},v),F.createElement(EP.Z,{type:"card",defaultActiveKey:(r=b[0])===null||r===void 0?void 0:r.name,className:Ii()({tabs:!0,xTab:!0,singleTab:(b==null?void 0:b.length)===1,coupleTab:(b==null?void 0:b.length)===2,ternateTab:(b==null?void 0:b.length)===3}),onTabClick:D},b.map(_=>{const{name:I,groups:B}=_;return F.createElement(z3,{key:I,tab:I},B.length===0&&F.createElement(cb.Z,{style:{padding:"24px 0"}}),B.length>0&&B.map(G=>{const{controls:K=[]}=G;return K.length===0?F.createElement(cb.Z,{style:{padding:"24px 0"}}):K.map(ve=>{const{shape:ae,name:Ye}=ve,rt=B3(ae,A,h);return rt?F.createElement(rt,{key:Ye,form:w,controlSchema:ve,triggerUpdate:O,afterUpdatingCb:p}):(console.error("\u672A\u627E\u5230\u5BF9\u5E94\u7684\u63A7\u4EF6:",ae),null)})}))})))},V3=n=>{const{schema:r={tabs:[]},triggerUpdate:o,onFieldsChange:s,afterUpdatingCb:l,defaultControlRender:u,loading:h,controlMapService:p,defaultControls:g=[]}=n,v=F.useMemo(()=>{const b=MP([...TP,...g]);return p&&p(b),b},[p,g]);return h?F.createElement("div",{className:`${n.prefixClz}-body`,style:Object.assign(Object.assign({},n.style),{display:"flex",justifyContent:"center",alignItems:"center"})},F.createElement(cP.Z,{spinning:!0})):F.createElement("div",{className:`${n.prefixClz}-body`,style:n.style},r.tabs.length>0&&F.createElement(U3,{schema:r,onFieldsChange:s,controlMap:v,defaultControlRender:u,afterUpdatingCb:l,triggerUpdate:o}),r.tabs.length===0&&F.createElement(cb.Z,{style:{paddingTop:"64px"}}))},j3=40,H3=40,$3=(n,r)=>{const o=n&&n.headerPosition&&n.headerPosition.height||j3,s=n.footerPosition&&n.footerPosition.height||H3;return{headerStyle:cl(Object.assign(Object.assign({height:0,top:0,left:0,right:0},r?{height:o,lineHeight:o}:{}),n.headerPosition)),bodyStyle:cl(Object.assign(Object.assign({left:0,right:0,top:0},r?{top:o,bottom:s}:{bottom:s}),n.bodyPosition)),footerStyle:cl(Object.assign(Object.assign({left:0,right:0,lineHeight:s,height:s,bottom:0},r?{lineHeight:s,height:s}:{bottom:0}),n.footerPosition))}};var ub;(function(n){n.id="XFLOW_JSON_SCHEMA_FORM",n.useModel=r=>(0,Vt.mG)(this,void 0,void 0,function*(){return r.awaitModel(n.id)})})(ub||(ub={}));const Kk=(n,r)=>{n.executeCommand(XFlowModelCommands.UPDATE_MODEL.id,{getModel:o=>__awaiter(void 0,void 0,void 0,function*(){return ub.useModel(o)}),updateModel:r})},W3=n=>{const r=po(),{commandService:o,modelService:s,getGraphInstance:l}=r,{formSchemaService:u}=n,[h,p,g,v]=n1({schema:{tabs:[]},targetType:null,targetData:null,targetCell:null,loading:!1});return F.useEffect(()=>{if(!r||!r.modelService)return;const b=new qn;if(!r.modelService.findDeferredModel(ub.id)){const A=r.modelService.registerModel({id:ub.id,modelFactory:()=>g,watchChange:(O,D)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const I=(yield zl.getModel(D)).watch(B=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const G=(ae,Ye)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){O.setValue(bt=>{bt.loading=!0,bt.schema={tabs:[]},bt.targetType=null,bt.targetData=null,bt.targetCell=null});const rt=ae?ae.getData():null;if(!u)return;const st=yield l(),tn=yield u({commandService:o,modelService:s,targetData:rt,cell:ae,targetType:Ye,graph:st});O.setValue({loading:!1,schema:tn,targetType:Ye,targetCell:ae,targetData:rt})}),ve=(ae=>ae?ae.isNode&&ae.isNode()&&ae.getProp("isGroup")?"group":ae.isNode&&ae.isNode()?"node":ae.isEdge&&ae.isEdge()?"edge":"canvas":"canvas")(B);(n.targetType||["node","canvas"]).includes(ve)&&(yield G(B,ve))}));return Rn.create(()=>{I.dispose(),b.push(I)})})});b.push(A)}return()=>{b.dispose()}},[]),{commandService:o,modelService:s,state:h,setState:p,model:g,isModelReady:v}},Z3=n=>{const{prefixClz:r}=n,{getCustomRenderComponent:o,afterUpdatingCb:s,formValueUpdateService:l=()=>{}}=n,{state:u,commandService:h,modelService:p}=W3(n),g=F.useCallback((D,_={})=>(0,Vt.mG)(void 0,void 0,void 0,function*(){D.setFieldsValue(_);const I=Object.entries(_).map(([K,ve])=>({name:K,value:ve})),B=Object.entries(u.targetData).map(([K,ve])=>({name:K,value:ve})),G=yield l({allFields:B,values:I,modelService:p,commandService:h,targetData:u.targetData,targetType:u.targetType});s&&s(G)}),[s,h,l,p,u.targetData,u.targetType]),v=F.useCallback((D,_)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const I=yield l({values:D,allFields:_,modelService:p,commandService:h,targetData:u.targetData,targetType:u.targetType});s&&s(I)}),[s,h,l,p,u.targetData,u.targetType]),b=F.useMemo(()=>{try{return u.schema.tabs.length===0||!u.schema}catch{return!0}},[u.schema]),{headerStyle:w,bodyStyle:A,footerStyle:O}=$3(n,b);if(o){const D=o(u.targetType,u.targetData,p,h);if(D)return F.createElement(D,Object.assign(Object.assign({},n),{headerStyle:w,bodyStyle:A,footerStyle:O,targetData:u.targetData,targetType:u.targetType,modelService:p,commandService:h}))}return F.createElement("div",{className:r},F.createElement(E3,Object.assign({hasSchema:!b},n,{state:u,style:w,prefixClz:n.prefixClz})),F.createElement(V3,Object.assign({},n,{key:u.targetData&&u.targetData.id,style:A,prefixClz:n.prefixClz,loading:u.loading,schema:u.schema,triggerUpdate:g,onFieldsChange:v})),F.createElement(w3,Object.assign({},n,{state:u,style:O})))},X3=n=>{const r=gd("json-schema-form");return F.createElement(gP,Object.assign({},n,{className:r}),F.createElement(Z3,Object.assign({},n,{prefixClz:r})))};Yr.Bz.Connector.registry.exist(R0.VERTICAL_NODE)||Yr.kJ.registerConnector(R0.VERTICAL_NODE,(n,r)=>{const s=Math.abs(r.y-n.y),l=Math.floor(s/3*2),u={x:n.x,y:n.y+16+l},h={x:r.x,y:r.y-16-l};return Yr.y$.normalize(`M ${n.x} ${n.y}
         L ${n.x} ${n.y+16}
         C ${u.x} ${u.y} ${h.x} ${h.y} ${r.x} ${r.y-16}
         L ${r.x} ${r.y}
        `)},!0),Yr.Bz.Connector.registry.exist(R0.VERTICAL_GROUP)||Yr.kJ.registerConnector(R0.VERTICAL_GROUP,(n,r)=>{const s=Math.abs(r.y-n.y),l={x:n.x,y:n.y+4+s},u={x:r.x,y:r.y-4-s};return Yr.y$.normalize(`M ${n.x} ${n.y}
       L ${n.x} ${n.y+4}
       C ${l.x} ${l.y} ${u.x} ${u.y} ${r.x} ${r.y-4}
       L ${r.x} ${r.y}
      `)},!0),Yr.Bz.Connector.registry.exist(R0.HORIRONTAL_NODE)||Yr.kJ.registerConnector(R0.HORIRONTAL_NODE,(n,r)=>{const s=Math.abs(r.y-n.y),l=Math.floor(s/3*2),u={x:n.x,y:n.y+4+l},h={x:r.x,y:r.y-4-l};return Yr.y$.normalize(`M ${n.x} ${n.y}
         L ${n.x} ${n.y+4}
         C ${u.x} ${u.y} ${h.x} ${h.y} ${r.x} ${r.y-4}
         L ${r.x} ${r.y}
        `)},!0);let ES=Yr.bn.kS.registry.get(u1.EDGE);Yr.bn.kS.registry.exist(u1.EDGE)||(ES=Yr.bn.kS.registry.register(u1.EDGE,Yr.bn.kS.define({zIndex:1,highlight:!1,shape:u1.EDGE}),!0));var Wc;(function(n){n.MODEL=I0,n.command=d1.QUERY_GRAPH_STATUS,n.hookKey="queryGraphStatus";let r;(function(o){o.SUCCESS="success",o.PROCESSING="processing",o.ERROR="error",o.DEFAULT="default",o.WARNING="warning"})(r=n.StatusEnum||(n.StatusEnum={})),n.initStatusMap=()=>({[n.StatusEnum.DEFAULT]:[],[n.StatusEnum.PROCESSING]:[],[n.StatusEnum.ERROR]:[],[n.StatusEnum.WARNING]:[],[n.StatusEnum.SUCCESS]:[]}),n.groupByStatus=o=>{const s=n.initStatusMap();return Object.entries(o).reduce((l,[u,h])=>(l[h.status].push(u),l),s)},n.statusDiff=(o,s)=>{const l=new Set([...o,...s]),u={current:[],add:[],remove:[]};return l.forEach(h=>{s.includes(h)&&!o.includes(h)&&u.add.push(h),!s.includes(h)&&o.includes(h)&&u.remove.push(h)}),u},n.shouldStop=o=>(0,Vt.mG)(this,void 0,void 0,function*(){return[r.ERROR,r.SUCCESS].includes(o.graphStatus)})})(Wc||(Wc={}));let v1=class{constructor(){this.statusInfo=Wc.initStatusMap(),this.getStatusModel=()=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=this.contextProvider().getModelService();return yield I0.getModel(o)}),this.updateModelValue=r=>(0,Vt.mG)(this,void 0,void 0,function*(){(yield this.getStatusModel()).setValue(r)}),this.stopCurrentStatusLooping=()=>(0,Vt.mG)(this,void 0,void 0,function*(){const r=yield this.getStatusModel(),{subscription:o}=yield r.getValidValue();o.dispose()}),this.addStopDispose=()=>(0,Vt.mG)(this,void 0,void 0,function*(){const r=yield this.getStatusModel(),{subscription:o}=yield r.getValidValue();o.push({dispose:()=>{this.updateEdges(this.statusInfo,Wc.initStatusMap()),this.isLooping=!1}})}),this.updateGraph=(r,o,s)=>{this.updateNodes(r,o,s),this.updateEdges(r,o)},this.updateNodeData=(r,o)=>{const s=this.x6Graph.getCellById(r);!s||s.setData(Object.assign(Object.assign(Object.assign(Object.assign({},s.getData()),s.getSize()),s.getPosition()),o))},this.updateNodes=(r,o,s)=>{Object.keys(r).forEach(l=>{const u=Wc.statusDiff(r[l],o[l]);u.add.forEach(h=>{this.updateNodeData(h,s[h])}),u.remove.forEach(h=>{this.updateNodeData(h,s[h])})})},this.updateEdges=(r,o)=>{const s=Wc.statusDiff(r.processing,o.processing);this.x6Graph.getEdges().forEach(u=>{var h;const p=(h=this.x6Graph)===null||h===void 0?void 0:h.findViewByCell(u.id),g=u.getTargetCellId();if(!g)return;const v=g.toString();if(!!p){if(s.add.includes(v))return p.addClass(mP);if(s.remove.includes(v))return p.removeClass(mP)}})},this.execute=()=>(0,Vt.mG)(this,void 0,void 0,function*(){const r=this.contextProvider(),{args:o,hooks:s}=r.getArgs(),l=r.getHooks();this.x6Graph=yield r.getX6Graph();const u=yield l.queryGraphStatus.call(o,h=>(0,Vt.mG)(this,void 0,void 0,function*(){const{graphStatusService:p,shouldStop:g=Wc.shouldStop,doOnce:v}=h;yield this.stopCurrentStatusLooping();const b=(w,A=1e4)=>(0,Vt.mG)(this,void 0,void 0,function*(){const O=yield w(h);this.updateModelValue(_=>{Object.entries(O.statusMap).forEach(([I,B])=>{_.statusMap.set(I,B)}),_.graphStatus=O.graphStatus});const D=Wc.groupByStatus(O.statusMap);this.updateGraph(this.statusInfo,D,O.statusMap),this.statusInfo=D,yield qD(A),this.isLooping&&(g&&(yield g(O,h))||(yield b(w,A)))});return this.isLooping=h.loop===void 0?!0:h.loop,yield this.addStopDispose(),v&&(yield v(h)),b(p,h.loopInterval),{}}),s);return r.setResult(u),this}),this.undo=()=>(0,Vt.mG)(this,void 0,void 0,function*(){const r=this.contextProvider();return this.isUndoable()&&r.undo(),this}),this.redo=()=>(0,Vt.mG)(this,void 0,void 0,function*(){return this.isUndoable()||(yield this.execute()),this})}isUndoable(){return this.contextProvider().isUndoable()}};(0,Vt.gn)([Rt(Br),(0,Vt.w6)("design:type",Object)],v1.prototype,"contextProvider",void 0),v1=(0,Vt.gn)([nn({token:{token:jr,named:Wc.command.id}})],v1);const qk=()=>{};var Pp;(function(n){n.TOP_BOTTOM="TB",n.LEFT_RIGHT="LR"})(Pp||(Pp={}));const PP=ce.defineToken("DAG_EXTENSION_CONFIG");var y1;(function(n){n.EVENT_NAME="ADD_EDGE_CMD_EVENT"})(y1||(y1={}));var b1;(function(n){n.router={name:"manhattan"},n.connector={name:"rounded",args:{radius:15}}})(b1||(b1={}));const Jk="ant",Y3=n=>{const{layout:r,router:o=b1.router,connector:s=b1.connector}=n;return{grid:!1,keyboard:{enabled:!0},selecting:{enabled:!0,multiple:!0,selectCellOnMoved:!0,showNodeSelectionBox:!1,rubberEdge:!0,rubberNode:!0,movable:!0},connecting:{sourceAnchor:r?r===Pp.TOP_BOTTOM?"bottom":"right":"center",targetAnchor:r?r===Pp.TOP_BOTTOM?"center":"left":"center",connectionPoint:"anchor",snap:{radius:20},router:o,connector:s,highlight:!0,dangling:!1,createEdge(){const u=this,h=new ES({attrs:{line:{strokeDasharray:"5 5",stroke:"#888",strokeWidth:1,targetMarker:{name:"block",args:{size:"6"}}}}}),p=g=>{const{isNew:v}=g,b=g.edge;if(v&&b.isEdge()&&b===h){const w=b.getTargetPortId(),A=b.getTargetCell();if(A&&A.isNode()){A.setPortProp(w,"connected",!1),b.attr({line:{strokeDasharray:"",targetMarker:"",stroke:"#d5d5d5"}});const O=b.getTargetPortId(),D=b.getSourcePortId(),_=b.getSourceCellId(),I=b.getTargetCellId();u.trigger(y1.EVENT_NAME,{targetPortId:O,sourcePortId:D,source:_,target:I,edge:h})}}};return u.once("edge:connected",p),h},validateEdge:u=>{var h;const{edge:p}=u;return!!(!((h=p==null?void 0:p.target)===null||h===void 0)&&h.port)},validateMagnet({magnet:u,cell:h}){const p=h.getData().ports.filter(g=>g.type===fo.AnchorType.INPUT);return p.length>0?u.getAttribute("port-group")!==p[0].group:!1},validateConnection({sourceView:u,targetView:h,sourceMagnet:p,targetMagnet:g}){if(u===h||!p||!g)return!1;if(r){const _=r===Pp.TOP_BOTTOM?fo.AnchorGroup.TOP:fo.AnchorGroup.LEFT;if(p.getAttribute("port-group")===_||g.getAttribute("port-group")!==_)return!1}const v=u.cell,b=p.getAttribute("port");if(!b||v.getPort(b).type!==fo.AnchorType.OUTPUT)return!1;const A=h.cell,O=g.getAttribute("port");if(!O)return!1;const D=A.getPort(O);return D.type!==fo.AnchorType.INPUT?!1:!(D&&D.connected)}},highlighting:{nodeAvailable:{name:"className",args:{className:"available"}},magnetAvailable:{name:"className",args:{className:"available"}},magnetAdsorbed:{name:"className",args:{className:"adsorbed"}}},scaling:{max:1.05,min:.01}}};let db=class{constructor(){this.registerGraphCommands=r=>{r.registerCommand(Wc.command,{createCommand:this.commandFactory})},this.toDispose=new qn,this.registerHook=r=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=new qn,s=[r.addNode.registerHook({name:"dag-add-node",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){const u=h=>(0,Vt.mG)(this,void 0,void 0,function*(){return new h1(Object.assign({},h))});l.cellFactory=u})}),r.addEdge.registerHook({name:"dag-add-edge",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){const{layout:u=Pp.TOP_BOTTOM}=yield this.propConfig.getConfig(),h=p=>(0,Vt.mG)(this,void 0,void 0,function*(){return new ES(Object.assign(Object.assign({},p),{id:p.id,source:{cell:p.source,port:p.sourcePortId,anchor:{name:u===Pp.TOP_BOTTOM?"bottom":"right"}},target:{cell:p.target,port:p.targetPortId,anchor:{name:u===Pp.TOP_BOTTOM?"center":"right"}},attrs:{line:{strokeDasharray:"",targetMarker:"",stroke:"#d5d5d5",strokeWidth:1}},data:Object.assign({},p)}))});l.cellFactory=h})}),r.addEdge.registerHook({name:"after add edge, set target port props",handler:(l,u)=>(0,Vt.mG)(this,void 0,void 0,function*(){return p=>(0,Vt.mG)(this,void 0,void 0,function*(){const g=yield u(p);if(g&&g.edgeCell){const v=g.edgeCell.getTargetCell(),b=g.edgeCell.getTargetPortId();v.setPortProp(b,"connected",!0)}return g})})}),r.delEdge.registerHook({name:"afetr del edge, reset target node port props",handler:(l,u)=>(0,Vt.mG)(this,void 0,void 0,function*(){return p=>(0,Vt.mG)(this,void 0,void 0,function*(){const g=yield u(p),{targetCell:v,targetPortId:b}=g;return v&&v.isNode()&&b&&v.setPortProp(b,"connected",!1),g})})}),r.afterGraphInit.registerHook({name:"call add edge to replace temp edge",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){const{commandService:u,graph:h}=l;h.on(y1.EVENT_NAME,p=>{u.executeCommand(zi.ADD_EDGE.id,{edgeConfig:p}),p.edge.remove()})})}),r.graphOptions.registerHook({name:"dag-extension-x6-options",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){const u=yield this.propConfig.getConfig(),h=Y3(u);Object.assign(l,h)})})];return o.pushAll(s),Rn.create(()=>{})}),this.registerHookHub=r=>(0,Vt.mG)(this,void 0,void 0,function*(){return r.registerHookHub(Wc.hookKey,new pa)})}registerModel(r){r.registerModel({id:I0.id,getInitialValue:()=>({statusMap:new Map,subscription:new qn,graphStatus:I0.StatusEnum.DEFAULT}),watchChange:o=>(0,Vt.mG)(this,void 0,void 0,function*(){const{subscription:s}=yield o.getValidValue();return s})})}};(0,Vt.gn)([Rt(vf),(0,Vt.w6)("design:type",Function)],db.prototype,"commandFactory",void 0),(0,Vt.gn)([Rt(PP),(0,Vt.w6)("design:type",Object)],db.prototype,"propConfig",void 0),db=(0,Vt.gn)([Dn({contrib:[ga,il,yf]})],db);const K3=n=>Yi(r=>{r(db),r(v1),r(PP,{useValue:n})}),q3=n=>{const r=Os();F.useEffect(()=>{r.addContainerClassNames("dag-extension-container");const s=n.layout||"TB";r.addContainerClassNames(s==="TB"?"layout-top-bottom":"layout-left-right")},[r,n.layout]);const o=F.useMemo(()=>({CONFIG_TYPE:"DAG_EXTENSION",getConfig:()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){return n})}),[n]);return F.createElement(md,{config:o,createModule:K3})},SS="XFLOW_FLOW_NODE_SHAPE",J3=150,Q3=60;let AS;const{AnchorGroup:x1}=fo,C1={circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}};Yr.NB.registry.exist(SS)?AS=Yr.NB.registry.get(SS):AS=uh.ep.define({width:J3,height:Q3,shape:SS,view:Ml,ports:{groups:{top:{position:x1.TOP,attrs:C1},bottom:{position:x1.BOTTOM,attrs:C1},right:{position:x1.RIGHT,attrs:C1},left:{position:x1.LEFT,attrs:C1}}},attrs:{body:{magnet:!1,fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"}}});const eN={grid:!0,mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge(){return new Yr.bn.kS({attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:0})},validateConnection({targetMagnet:n}){return!!n}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},resizing:!0,rotating:!0,selecting:{enabled:!0,rubberband:!0,showNodeSelectionBox:!0,modifiers:"shift"},snapline:!0,keyboard:!0,clipboard:!0};let OP=class{constructor(){this.toDispose=new qn,this.registerHookHub=()=>(0,Vt.mG)(this,void 0,void 0,function*(){return Rn.create(()=>{})}),this.registerHook=r=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=new qn,s=[r.addNode.registerHook({name:"flow-add-node",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){const u=h=>(0,Vt.mG)(this,void 0,void 0,function*(){return new AS(Object.assign({},h))});l.cellFactory=u})}),r.addEdge.registerHook({name:"flow-add-edge",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){const u=h=>(0,Vt.mG)(this,void 0,void 0,function*(){return delete h.id,new Yr.bn.kS({source:{cell:h.source,port:h.sourcePortId},target:{cell:h.target,port:h.targetPortId},attrs:{line:{stroke:"#A2B1C3",strokeWidth:2,targetMarker:{name:"block",width:12,height:8}}},zIndex:-1,data:Object.assign({},h)})});l.cellFactory=u})}),r.graphOptions.registerHook({name:"assign options ",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){Object.assign(l,eN)})})];return o.pushAll(s),Rn.create(()=>{})})}};OP=(0,Vt.gn)([Dn({contrib:ga})],OP);const Qk=()=>ManaSyringe.Module(n=>{n(FlowHooksContribution)}),eR=()=>{const n=useExtensionRegistry(),r=React.useMemo(()=>({CONFIG_TYPE:"DAG_EXTENSION",getConfig:()=>__awaiter(void 0,void 0,void 0,function*(){})}),[]);return React.useEffect(()=>{const o=n.addExtension({config:r,createModule:createFlowExtensionModule});return n.addContainerClassNames("flow-extension-container"),()=>{o.dispose()}},[r,n]),null};var tN=P(99543),nN=P(82492),DP=P.n(nN);const TS={config:{}},_P=n=>{TS.config=Object.assign({},TS.config,n)},w1=n=>{var r;return(r=TS.config)===null||r===void 0?void 0:r[n]},NP=new Map,kP=new Map,rN=n=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const r=yield n.getGraphInstance();NP.set("x6graph",r),kP.set("app",n)}),RP=()=>NP.get("x6graph"),iN=()=>kP.get("app"),oN=()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){return iN().getGraphData()}),hb=(0,wc.debounce)(n=>{const r=w1("onConfigChange");if(!(!r||typeof r!="function"))return r(Object.assign({data:oN()},n))},300,{trailing:!0}),sN=(n,r)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const{node:o}=n;if(!o)return;const{data:s}=o;if(s!=null&&s.groupChildren){const u=RP();s==null||s.groupChildren.forEach(h=>(0,Vt.mG)(void 0,void 0,void 0,function*(){var p,g;const v=u.getCellById(h);v&&v.isNode()&&(yield r.executeCommand(di.UPDATE_NODE.id,{nodeConfig:Object.assign(Object.assign(Object.assign({},v.data),(p=v.getSize)===null||p===void 0?void 0:p.call(v)),(g=v.getPosition)===null||g===void 0?void 0:g.call(v))}))}))}const l=Object.assign(Object.assign(Object.assign({},o.data),o.getPosition()),o.getSize());yield r.executeCommand(di.UPDATE_NODE.id,{nodeConfig:l}),hb({type:"move:node",config:l})}),aN=(n,r)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const{node:o}=n;if(!o)return;const s=Object.assign(Object.assign(Object.assign({},o.data),o.getPosition()),o.size());yield r.executeCommand(di.UPDATE_NODE.id,{nodeConfig:s}),hb({type:"resize:node",config:s})}),lN=n=>{var r;let o=(r=n==null?void 0:n.e)===null||r===void 0?void 0:r.currentTarget;if(!o)return document.getElementsByClassName("xflow-canvas-root");let s=null;for(;!s;){const l=o.getElementsByClassName("xflow-canvas-root");(l==null?void 0:l.length)>0&&(s=l),o=o.parentNode}return s},cN=n=>{const r=document.getElementsByClassName("x6-node-selected");if(!r)return;let o=r[0];return Array.from(r).forEach(s=>{s.getAttribute("data-cell-id")===n&&(o=s)}),o.getElementsByClassName("x6-port")},IP=(n,r)=>{const s=n.getAttribute("transform").split(",");s[0]=`matrix(${Number(s[0].split("(")[1])*r}`,s[3]=Number(s[3])*r,n.setAttribute("transform",s.join(","))},uN=n=>{if(!(n!=null&&n.length))return;const r=2;n.forEach(o=>{o.getAttribute("data-scale")||(IP(o,r),o.setAttribute("data-scale",`${r}`))})},dN=()=>{const n=document.getElementsByClassName("x6-port");!n||Array.from(n).forEach(r=>{const o=r.getAttribute("data-scale");o&&(IP(r,1/Number(o)),r.removeAttribute("data-scale"))})},MS=(n,r,o)=>{var s;n||dN();const l=lN(r),h=(s=RP().getSelectedCells())===null||s===void 0?void 0:s[0];(h==null?void 0:h.isNode())&&o&&uN(cN(h.id)),Array.from(l).forEach(p=>{const g=p.querySelectorAll(".x6-port-body"),v=h==null?void 0:h.isNode();for(let b=0,w=g.length;b<w;b=b+1)g[b].style.visibility=(!v||o)&&n?"visible":"hidden"})},hN=n=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const{edge:r}=n;!r||r.addTools("vertices","ondbclick")}),fN=(n,r)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const{edge:o}=n;!o||o.hasTools("ondbclick")&&(r.executeCommand(zi.UPDATE_EDGE.id,{edgeConfig:Object.assign(Object.assign({},(0,wc.get)(o,"data")),{vertices:o.getVertices()})}),o.removeTools())}),tR=40,nR="xflow-node-panel-collpase",pN="GROUP_NODE_RENDER_ID",Ko=60,Zi=40,Ve=1,Wt={stroke:"#A2B1C3",fill:"#FFFFFF",fontFill:"#000",fontSize:12,label:""},gN=[{name:"Terminal"},{name:"Process"},{name:"Decision"},{name:"Multi Document"},{name:"Connector",width:Zi,height:Zi},{name:"DataIO",ports:["top","bottom"]},{name:"Database"},{name:"Hard Disk"},{name:"Stroed Data"},{name:"Document"},{name:"Predefined Process"},{name:"Extract"},{name:"Merge"},{name:"Or",width:Zi,height:Zi},{name:"Manual Input"},{name:"Preparation"},{name:"Delay"},{name:"Manual Operation"},{name:"Display"},{name:"Off Page Link"},{name:"Note Left",label:"\u2263"},{name:"Note Right",label:"\u2263"},{name:"Internal Storage"},{name:"Text",label:"text"}],mN=["Connector","Or"],vN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=[["M",Ve,Ve],["L",g-2*Ve,Ve],["L",g-2*Ve,v-2*Ve],["L",Ve,v-2*Ve],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(b),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},yN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=[["M",g/2,Ve],["L",g-2*Ve,v/2],["L",g/2,v-2*Ve],["L",Ve,v/2],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(b),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},bN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=v-2*Ve;return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:`M ${Ve},${v/2} a ${b/2} ${b/2} 0 1 1 0 1 z`,fill:u,stroke:s}),F.createElement("text",{x:v/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},xN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=v/2,w=[["M",b-Ve,Ve],["L",g-2*Ve,Ve],["L",g-b,v-2*Ve],["L",Ve,v-2*Ve],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(w),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},CN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=Math.min(v,g)/2,w=[["M",b,Ve],["L",g-b,Ve],["C",g-2*Ve,Ve,g-2*Ve,v/2],["",g-2*Ve,v/2],["C",g-2*Ve,v/2,g-2*Ve,v-2*Ve],["",g-b,v-2*Ve],["L",b,v-2*Ve],["C",Ve,v-2*Ve,Ve,v/2],["",Ve,v/2],["C",Ve,v/2,Ve,Ve],["",b,Ve]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(w),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},wN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=g/4,w=Math.min(v/10,12),A=[["M",Ve,Ve+w],["C",Ve+b,Ve,Ve+g-b,Ve],["",g-2*Ve,Ve+w],["L",g-2*Ve,v-2*Ve-w],["C",g-2*Ve-b,v-2*Ve,Ve+b,v-2*Ve],["",Ve,v-2*Ve-w],["Z"]],O=[["M",Ve,Ve+w],["C",Ve+b,Ve+2*w,Ve+g-b,Ve+2*w],["",g-2*Ve,Ve+w]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(A),fill:u,stroke:s}),F.createElement("path",{d:ho(O),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},EN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=Math.min(g/10,v/4),w=Math.min(v/4,g/4),A=[["M",Ve+b,Ve],["L",g-2*Ve-b,Ve],["C",g-2*Ve,Ve+w,g-2*Ve,v-2*Ve-w],["",g-2*Ve-b,v-2*Ve],["L",Ve+b,v-2*Ve],["C",Ve,v-2*Ve-w,Ve,Ve+w],["",Ve+b,Ve]],O=[["M",g-2*Ve-b,Ve],["C",g-2*Ve-2*b,Ve+w,g-2*Ve-2*b,v-2*Ve-w],["",g-2*Ve-b,v-2*Ve]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(A),fill:u,stroke:s}),F.createElement("path",{d:ho(O),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},SN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=Math.min(g/10,v/4),w=Math.min(v/4,g/4),A=[["M",Ve+b,Ve],["L",g-2*Ve-b,Ve],["C",g-2*Ve-2*b,Ve+w,g-2*Ve-2*b,v-2*Ve-w],["",g-2*Ve-b,v-2*Ve],["L",Ve+b,v-2*Ve],["C",Ve,v-2*Ve-w,Ve,Ve+w],["",Ve+b,Ve]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(A),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},AN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=g/8,w=v/8,A=[["M",Ve,Ve],["L",g-2*Ve,Ve],["L",g-2*Ve,v-2*Ve-w],["C",g-2*Ve-b,v-2*Ve-2*w,g/2+b,v-2*Ve-2*w],["",g/2,v-2*Ve-w],["S",g/4,v-2*Ve,Ve,v-2*Ve-2*w],["L",Ve,Ve]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(A),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},TN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,g=6,v=Ve,b=g/2;let{width:w,height:A}=r;w+=g,A+=g;const O=w/8,D=A/8,_=[["M",v+b,v],["L",w-2*v,v],["L",w-2*v,A-2*v-D],["C",w-2*v-O,A-2*v-2*D,w/2+O,A-2*v-2*D],["",w/2,A-2*v-D],["S",w/4,A-2*v,v+b,A-2*v-2*D],["L",v+b,v]];return F.createElement("svg",{viewBox:`0 0 ${w} ${A}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(_),fill:u,stroke:s}),F.createElement("path",{d:ho(_,-g/2,g/2),fill:u,stroke:s}),F.createElement("text",{x:w/2,y:A/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},MN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=g/8,w=[["M",Ve,Ve],["L",g-2*Ve,Ve],["L",g-2*Ve,v-2*Ve],["L",Ve,v-2*Ve],["Z"]],A=[["M",b,Ve],["L",b,v-2*Ve]],O=[["M",g-b,Ve],["L",g-b,v-2*Ve]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(w),fill:u,stroke:s}),F.createElement("path",{d:ho(A),stroke:s}),F.createElement("path",{d:ho(O),stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},PN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=[["M",g/2,Ve],["L",g-2*Ve,v-2*Ve],["L",Ve,v-2*Ve],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(b),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},ON=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=[["M",Ve,Ve],["L",g-2*Ve,Ve],["L",g/2,v-2*Ve],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(b),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},DN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=[["M",v/2,Ve],["L",v/2,v-2*Ve]],w=[["M",Ve,v/2],["L",v-2*Ve,v/2]],A=v-2*Ve;return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:`M ${Ve},${v/2} a ${A/2} ${A/2} 0 1 1 0 1 z`,fill:u,stroke:s}),F.createElement("path",{d:ho(b),stroke:s}),F.createElement("path",{d:ho(w),stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},_N=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=[["M",Ve,v/5],["L",g-2*Ve,Ve],["L",g-2*Ve,v-2*Ve],["L",Ve,v-2*Ve],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(b),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},NN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=Math.tan(Math.PI/6)*(v/2),w=[["M",b,Ve],["L",g-b,Ve],["L",g-2*Ve,v/2],["L",g-b,v-2*Ve],["L",b,v-2*Ve],["L",Ve,v/2],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(w),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},kN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=Math.min(v,g)/2,w=[["M",Ve,Ve],["L",g-b,Ve],["C",g-2*Ve,Ve,g-2*Ve,v/2],["",g-2*Ve,v/2],["C",g-2*Ve,v/2,g-2*Ve,v-2*Ve],["",g-b,v-2*Ve],["L",Ve,v-2*Ve],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(w),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},RN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=Math.min(Math.tan(Math.PI/6)*v,g/2),w=[["M",Ve,Ve],["L",g-2*Ve,Ve],["L",g-b,v-2*Ve],["L",b,v-2*Ve],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(w),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},IN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=Math.min(v,g)/3,w=Math.min(Math.tan(Math.PI/6)*(v/2),g/3),A=[["M",w,Ve],["L",g-b,Ve],["C",g-2*Ve,Ve,g-2*Ve,v/2],["",g-2*Ve,v/2],["C",g-2*Ve,v/2,g-2*Ve,v-2*Ve],["",g-b,v-2*Ve],["L",w,v-2*Ve],["L",Ve,v/2],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(A),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},LN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=Math.min(Math.tan(Math.PI/6)*(g/2),v/4),w=[["M",Ve,Ve],["L",g-2*Ve,Ve],["L",g-2*Ve,v-b],["L",g/2,v-2*Ve],["L",Ve,v-b],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(w),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},FN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u="transparent",fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=6,w=g-2*Ve,A=[["M",w,Ve],["C",w-b,Ve,w-b,b],["",w-b,(v-b)/2],["L",w-2*b,v/2],["L",w-b,(v+b)/2],["L",w-b,v-2*Ve-b],["C",w-b,v-2*Ve,w,v-2*Ve],["",w,v-2*Ve]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(A),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},GN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u="transparent",fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=6,w=[["M",Ve,Ve],["C",b,Ve,b,b],["",b,(v-b)/2],["L",2*b,v/2],["L",b,(v+b)/2],["L",b,v-2*Ve-b],["C",b,v-2*Ve,Ve,v-2*Ve],["",Ve,v-2*Ve]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(w),fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},BN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{stroke:s=Wt.stroke,label:l=Wt.label,fill:u=Wt.fill,fontFill:h=Wt.fontFill,fontSize:p=Wt.fontSize}=o,{width:g,height:v}=r,b=g-2*Ve,w=v-2*Ve,A=6,O=[["M",Ve,Ve],["L",b-A,Ve],["C",b,Ve,b,A],["",b,v/2],["L",b,w-A],["C",b,w,b-A,w],["",b-A,w],["L",A,w],["C",Ve,w,Ve,w-A],["",Ve,w-A],["Z"]];return F.createElement("svg",{viewBox:`0 0 ${g} ${v}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("path",{d:ho(O),fill:u,stroke:s}),F.createElement("path",{d:`M ${Ve},${A} L ${b-1} ${A} `,fill:u,stroke:s}),F.createElement("path",{d:`M ${A},${Ve} L ${A} ${w} `,fill:u,stroke:s}),F.createElement("text",{x:g/2,y:v/2,fill:h,textAnchor:"middle",alignmentBaseline:"middle",fontSize:p},l),"Sorry, your browser does not support inline SVG.")},zN=n=>{const{size:r={width:Ko,height:Zi},data:o={}}=n,{label:s=Wt.label,fontFill:l=Wt.fontFill,fontSize:u=Wt.fontSize}=o,{width:h,height:p}=r,g=2;return F.createElement("svg",{viewBox:`0 0 ${h/g} ${p/g}`,xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},F.createElement("text",{x:h/(2*g),y:p/(2*g),fill:l,textAnchor:"middle",alignmentBaseline:"middle",fontSize:u},s),"Sorry, your browser does not support inline SVG.")},E1=n=>({position:{name:n},attrs:{circle:{r:4,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff",style:{visibility:"hidden"}}},zIndex:10}),LP=(n=["top","right","bottom","left"])=>({items:n.map(r=>({group:r,id:uuidv4()})),groups:{top:E1("top"),right:E1("right"),bottom:E1("bottom"),left:E1("left")}}),UN=n=>(n||[]).map(r=>{const{name:o,popover:s,label:l="",width:u=NODE_HEIGHT,height:h=NODE_HEIGHT,ports:p,parentKey:g}=r;return{id:uuidv4(),renderKey:o,name:o,label:l,popoverContent:s,width:u,height:h,ports:p||LP(),originData:Object.assign({},r),isCustom:!0,parentKey:g}}),rR=n=>__awaiter(void 0,void 0,void 0,function*(){return[...UN(n),...NODEPOOL.map(({name:o,ports:s,width:l=NODE_WIDTH,height:u=NODE_HEIGHT,label:h=""})=>({id:uuidv4(),renderKey:o,name:o,label:h,popoverContent:()=>o,width:l,height:u,ports:LP(s)}))]}),VN=n=>{const r=n?(0,wc.isArray)(n)?n:[n]:[];let o=[];r.forEach(u=>{o=o.concat(u.nodes.map(h=>Object.assign(Object.assign({},h),{parentKey:u.key})))}),o.length&&_P({registerNode:o});const s=w1("graphConfig"),l=w1("registerNode");!s||!(l!=null&&l.length)||l.forEach(u=>{const{name:h,component:p}=u;s.setNodeRender(h,p)})},jN=n=>{VN(),n.nodeRender.get("Terminal")||gN.forEach(r=>{n.setNodeRender(r.name,J[`${r.name.replace(/\s+/g,"")}Node`])})},ho=(n,r=0,o=0)=>{if(!n.length)return null;let s="";return n.forEach(l=>{const[u,h,p,g,v]=l;s+=(0,wc.isNumber)(p)?` ${u} ${h+r} ${p+o}`:` ${u}`,v&&(s+=` ${g+r} ${v+o}`)}),s};var Vg=P(87462),HN=P(8812),FP=P(29388),$N=P(96774),PS=P.n($N),GP=P(50344),WN=P(63441),BP=F.forwardRef(function(n,r){var o,s=n.prefixCls,l=n.forceRender,u=n.className,h=n.style,p=n.children,g=n.isActive,v=n.role,b=F.useState(g||l),w=(0,_h.Z)(b,2),A=w[0],O=w[1];return F.useEffect(function(){(l||g)&&O(!0)},[l,g]),A?F.createElement("div",{ref:r,className:Ii()("".concat(s,"-content"),(o={},(0,ht.Z)(o,"".concat(s,"-content-active"),g),(0,ht.Z)(o,"".concat(s,"-content-inactive"),!g),o),u),style:h,role:v},F.createElement("div",{className:"".concat(s,"-content-box")},p)):null});BP.displayName="PanelContent";var ZN=BP,zP=function(n){(0,Rs.Z)(o,n);var r=(0,FP.Z)(o);function o(){var s;(0,Wn.Z)(this,o);for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];return s=r.call.apply(r,[this].concat(u)),s.onItemClick=function(){var p=s.props,g=p.onItemClick,v=p.panelKey;typeof g=="function"&&g(v)},s.handleKeyPress=function(p){(p.key==="Enter"||p.keyCode===13||p.which===13)&&s.onItemClick()},s.renderIcon=function(){var p=s.props,g=p.showArrow,v=p.expandIcon,b=p.prefixCls,w=p.collapsible;if(!g)return null;var A=typeof v=="function"?v(s.props):F.createElement("i",{className:"arrow"});return A&&F.createElement("div",{className:"".concat(b,"-expand-icon"),onClick:w==="header"?s.onItemClick:null},A)},s.renderTitle=function(){var p=s.props,g=p.header,v=p.prefixCls,b=p.collapsible;return F.createElement("span",{className:"".concat(v,"-header-text"),onClick:b==="header"?s.onItemClick:null},g)},s}return(0,or.Z)(o,[{key:"shouldComponentUpdate",value:function(l){return!PS()(this.props,l)}},{key:"render",value:function(){var l,u,h=this.props,p=h.className,g=h.id,v=h.style,b=h.prefixCls,w=h.headerClass,A=h.children,O=h.isActive,D=h.destroyInactivePanel,_=h.accordion,I=h.forceRender,B=h.openMotion,G=h.extra,K=h.collapsible,ve=K==="disabled",ae=K==="header",Ye=Ii()((l={},(0,ht.Z)(l,"".concat(b,"-item"),!0),(0,ht.Z)(l,"".concat(b,"-item-active"),O),(0,ht.Z)(l,"".concat(b,"-item-disabled"),ve),l),p),rt=Ii()("".concat(b,"-header"),(u={},(0,ht.Z)(u,w,w),(0,ht.Z)(u,"".concat(b,"-header-collapsible-only"),ae),u)),st={className:rt,"aria-expanded":O,"aria-disabled":ve,onKeyPress:this.handleKeyPress};ae||(st.onClick=this.onItemClick,st.role=_?"tab":"button",st.tabIndex=ve?-1:0);var tn=G!=null&&typeof G!="boolean";return F.createElement("div",{className:Ye,style:v,id:g},F.createElement("div",st,this.renderIcon(),this.renderTitle(),tn&&F.createElement("div",{className:"".concat(b,"-extra")},G)),F.createElement(WN.Z,(0,Vg.Z)({visible:O,leavedClassName:"".concat(b,"-content-hidden")},B,{forceRender:I,removeOnLeave:D}),function(bt,jt){var et=bt.className,An=bt.style;return F.createElement(ZN,{ref:jt,prefixCls:b,className:et,style:An,isActive:O,forceRender:I,role:_?"tabpanel":null},A)}))}}]),o}(F.Component);zP.defaultProps={showArrow:!0,isActive:!1,onItemClick:function(){},headerClass:"",forceRender:!1};var XN=zP;function UP(n){var r=n;if(!Array.isArray(r)){var o=(0,Pd.Z)(r);r=o==="number"||o==="string"?[r]:[]}return r.map(function(s){return String(s)})}var OS=function(n){(0,Rs.Z)(o,n);var r=(0,FP.Z)(o);function o(s){var l;(0,Wn.Z)(this,o),l=r.call(this,s),l.onClickItem=function(g){var v=l.state.activeKey;if(l.props.accordion)v=v[0]===g?[]:[g];else{v=(0,Yo.Z)(v);var b=v.indexOf(g),w=b>-1;w?v.splice(b,1):v.push(g)}l.setActiveKey(v)},l.getNewChild=function(g,v){if(!g)return null;var b=l.state.activeKey,w=l.props,A=w.prefixCls,O=w.openMotion,D=w.accordion,_=w.destroyInactivePanel,I=w.expandIcon,B=w.collapsible,G=g.key||String(v),K=g.props,ve=K.header,ae=K.headerClass,Ye=K.destroyInactivePanel,rt=K.collapsible,st=!1;D?st=b[0]===G:st=b.indexOf(G)>-1;var tn=rt??B,bt={key:G,panelKey:G,header:ve,headerClass:ae,isActive:st,prefixCls:A,destroyInactivePanel:Ye??_,openMotion:O,accordion:D,children:g.props.children,onItemClick:tn==="disabled"?null:l.onClickItem,expandIcon:I,collapsible:tn};return typeof g.type=="string"?g:(Object.keys(bt).forEach(function(jt){typeof bt[jt]>"u"&&delete bt[jt]}),F.cloneElement(g,bt))},l.getItems=function(){var g=l.props.children;return(0,GP.Z)(g).map(l.getNewChild)},l.setActiveKey=function(g){"activeKey"in l.props||l.setState({activeKey:g}),l.props.onChange(l.props.accordion?g[0]:g)};var u=s.activeKey,h=s.defaultActiveKey,p=h;return"activeKey"in s&&(p=u),l.state={activeKey:UP(p)},l}return(0,or.Z)(o,[{key:"shouldComponentUpdate",value:function(l,u){return!PS()(this.props,l)||!PS()(this.state,u)}},{key:"render",value:function(){var l,u=this.props,h=u.prefixCls,p=u.className,g=u.style,v=u.accordion,b=Ii()((l={},(0,ht.Z)(l,h,!0),(0,ht.Z)(l,p,!!p),l));return F.createElement("div",{className:b,style:g,role:v?"tablist":null},this.getItems())}}],[{key:"getDerivedStateFromProps",value:function(l){var u={};return"activeKey"in l&&(u.activeKey=UP(l.activeKey)),u}}]),o}(F.Component);OS.defaultProps={prefixCls:"rc-collapse",onChange:function(){},accordion:!1,destroyInactivePanel:!1},OS.Panel=XN;var VP=OS,jP=VP,iR=VP.Panel,YN=P(98423),HP=P(53124),KN=P(33603),$P=P(96159),qN=function(r){var o=F.useContext(HP.E_),s=o.getPrefixCls,l=r.prefixCls,u=r.className,h=u===void 0?"":u,p=r.showArrow,g=p===void 0?!0:p,v=s("collapse",l),b=Ii()((0,ht.Z)({},"".concat(v,"-no-arrow"),!g),h);return F.createElement(jP.Panel,(0,Vg.Z)({},r,{prefixCls:v,className:b}))},JN=qN,WP=function(r){var o,s=F.useContext(HP.E_),l=s.getPrefixCls,u=s.direction,h=r.prefixCls,p=r.className,g=p===void 0?"":p,v=r.bordered,b=v===void 0?!0:v,w=r.ghost,A=r.expandIconPosition,O=A===void 0?"start":A,D=l("collapse",h),_=F.useMemo(function(){return O==="left"?"start":O==="right"?"end":O},[O]),I=function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ye=r.expandIcon,rt=Ye?Ye(ae):F.createElement(HN.Z,{rotate:ae.isActive?90:void 0});return(0,$P.Tm)(rt,function(){return{className:Ii()(rt.props.className,"".concat(D,"-arrow"))}})},B=Ii()("".concat(D,"-icon-position-").concat(_),(o={},(0,ht.Z)(o,"".concat(D,"-borderless"),!b),(0,ht.Z)(o,"".concat(D,"-rtl"),u==="rtl"),(0,ht.Z)(o,"".concat(D,"-ghost"),!!w),o),g),G=(0,Vg.Z)((0,Vg.Z)({},KN.ZP),{motionAppear:!1,leavedClassName:"".concat(D,"-content-hidden")}),K=function(){var ae=r.children;return(0,GP.Z)(ae).map(function(Ye,rt){var st;if(!((st=Ye.props)===null||st===void 0)&&st.disabled){var tn=Ye.key||String(rt),bt=Ye.props,jt=bt.disabled,et=bt.collapsible,An=(0,Vg.Z)((0,Vg.Z)({},(0,YN.Z)(Ye.props,["disabled"])),{key:tn,collapsible:et??(jt?"disabled":void 0)});return(0,$P.Tm)(Ye,An)}return Ye})};return F.createElement(jP,(0,Vg.Z)({openMotion:G},r,{expandIcon:I,prefixCls:D,className:B}),K())};WP.Panel=JN;var QN=WP,ek=QN;const{Panel:ZP}=ek,oR=n=>{const{x6NodeFactory:r,dndOptions:o,state:s,prefixClz:l,defaultActiveKey:u=["official"],showOfficial:h=!0}=n,p=n.registerNode?isArray(n.registerNode)?n.registerNode:[n.registerNode]:[],{graphProvider:g,modelService:v,commandService:b}=useXFlowApp(),[w,A]=React.useState(),[O,D]=React.useState();g.getGraphInstance().then(rt=>{D(rt)});let _;g.getGraphOptions().then(rt=>{_=rt});const I=useCallback(rt=>__awaiter(void 0,void 0,void 0,function*(){var st;const{ports:tn}=rt,bt=Object.assign(Object.assign({},rt),{id:`node-${uuidv4()}`,zIndex:10,ports:Object.assign(Object.assign({},tn),{items:(st=tn.items)===null||st===void 0?void 0:st.map(An=>Object.assign(Object.assign({},An),{id:uuidv4()}))})}),jt={nodeConfig:bt};yield b.executeCommand(XFlowNodeCommands.ADD_NODE.id,jt);const et=getProps("onAddNode");typeof et=="function"&&et(bt)}),[b]);React.useEffect(()=>{if(!O)return;const rt=new Addon.Dnd(Object.assign(Object.assign({scaled:!1,animation:!1},o),{target:O,validateNode:st=>__awaiter(void 0,void 0,void 0,function*(){const tn=Object.assign(Object.assign({},st.getData()),st.getPosition());return yield I(tn),!1})}));A(rt)},[b,o,O,v,I]);const B=React.useCallback(rt=>st=>{if(!O||!w||!_)return;const tn=_.nodeTypeParser(rt),{width:bt=180,height:jt=40}=rt,et=_.nodeRender.get(tn),An=getNodeReactComponent(et,b,v),Vn={data:rt,width:bt,height:jt,view:_.graphId,component:An},Zn=r?r(Vn):defaultNodeFactory(Vn);w.start(Zn,st.nativeEvent)},[b,w,O,_,v,r]),G=React.useCallback((rt=[])=>rt.map(st=>{const{popoverContent:tn}=st;return React.createElement(NodeTitle,{item:st,key:st.id,onMouseDown:B(st),popoverContent:tn,prefixClz:l,modelService:v,commandService:b,graphConfig:_})}),[b,_,v,B,l]),K=s.nodeList.filter(rt=>!rt.isCustom),ve=s.searchList.filter(rt=>!rt.isCustom),ae=rt=>s.nodeList.filter(st=>st.isCustom&&st.parentKey===rt),Ye=rt=>s.searchList.filter(st=>st.isCustom&&st.parentKey===rt);return React.createElement(React.Fragment,null,React.createElement("div",{className:`${l}-body`},React.createElement(Collapse,{defaultActiveKey:u,style:{border:"none"}},h&&React.createElement(ZP,{header:"\u901A\u7528\u8282\u70B9",key:"official",style:{border:"none"}},!s.keyword&&React.createElement("div",{className:`${l}-official`},G(K)),s.searchList.length>0&&React.createElement("div",{className:`${l}-official`},G(ve))),(p==null?void 0:p.length)>0&&p.map(rt=>!rt.hidden&&rt.nodes.length>0&&React.createElement(ZP,{header:rt.title,key:rt.key,style:{border:"none"}},!s.keyword&&React.createElement("div",{className:`${l}-custom`},G(ae(rt.key))),s.searchList.length>0&&React.createElement("div",{className:`${l}-custom`},G(Ye(rt.key)))))),s.keyword&&s.searchList.length===0&&React.createElement(Empty,{style:{marginTop:"48px"}})))},sR=n=>{const{prefixClz:r,onKeywordChange:o}=n,{propsProxy:s}=usePanelContext(),l=s.getValue();return React.createElement(React.Fragment,null,React.createElement("div",{className:`${r}-header`,style:Object.assign({zIndex:1},n.style)},l.header&&React.isValidElement(l.header)&&l.header,React.createElement("div",{className:`${r}-header-search`},React.createElement(Input,{placeholder:"\u641C\u7D22\u7EC4\u4EF6",allowClear:!0,onChange:u=>o(u.target.value),style:{width:"100%",border:0}}))))};var S1;(function(n){n.id="NODE_PANEL_DATA"})(S1||(S1={}));const tk=(n=[],r)=>__awaiter(void 0,void 0,void 0,function*(){return n.filter(s=>{var l,u;return s.isDirectory||((l=s.label)===null||l===void 0?void 0:l.includes(r))||((u=s.name)===null||u===void 0?void 0:u.includes(r))})}),aR=n=>{const{searchService:r=tk}=n,o=n.registerNode?isArray(n.registerNode)?n.registerNode:[n.registerNode]:[];let s=[];o.forEach(v=>{s=s.concat(v.nodes.map(b=>Object.assign(Object.assign({},b),{parentKey:v.key})))});const{modelService:l}=useXFlowApp(),[u,h,p]=createComponentModel({searchList:[],nodeList:[],defaultExpandAll:!1,keyword:""});React.useEffect(()=>{l.findDeferredModel(S1.id)||l.registerModel({id:S1.id,modelFactory:()=>p,watchChange:v=>__awaiter(void 0,void 0,void 0,function*(){const b=yield MODELS.GRAPH_META.getModel(l),w=()=>__awaiter(void 0,void 0,void 0,function*(){return{listData:yield nodeService(s)}}),A=b.watch(()=>__awaiter(void 0,void 0,void 0,function*(){const O=yield w();v.setValue({nodeList:O.listData,defaultExpandAll:!1,keyword:"",searchList:[]})}));return Disposable.create(()=>{A.dispose()})})})},[]);const g=React.useCallback(v=>__awaiter(void 0,void 0,void 0,function*(){if(!!r)if(v){const b=yield r(u.nodeList,v);h(w=>{w.keyword=v,w.searchList=b})}else h(b=>{b.keyword="",b.searchList=[]})}),[r,u.nodeList,h]);return{state:u,setState:h,onKeywordChange:g}},nk=n=>{const{cell:r,data:{label:o,stroke:s,fill:l,fontSize:u,fontFill:h,width:p=200,isCollapsed:g=!1}}=n,v=po(),b=()=>{v.executeCommand(to.COLLAPSE_GROUP.id,{nodeId:r.id,isCollapsed:!1,collapsedSize:{width:p,height:40}})},w=()=>{v.executeCommand(to.COLLAPSE_GROUP.id,{nodeId:r.id,isCollapsed:!0,collapsedSize:{width:p,height:40},gap:3})};return F.createElement("div",{className:"xflow-group-node",style:{borderColor:s,backgroundColor:l,fontSize:u,color:h}},F.createElement("div",{className:"xflow-group-header"},F.createElement("div",{className:"header-left"},o),F.createElement("div",{className:"header-right"},g&&F.createElement($d.Z,{onClick:b}),!g&&F.createElement(Wd.Z,{onClick:w}))))},rk=n=>{n.setNodeRender(pN,nk)};var XP;(function(n){n.id="FLOWCHART_PANEL_DATA"})(XP||(XP={}));const ik=n=>{const{prefixClz:r,position:o={width:240,top:0,bottom:0,left:0},showHeader:s=!0}=n,l=__rest(n,["prefixClz","position","showHeader"]),{width:u=200}=o,{headerStyle:h,bodyStyle:p}=usePanelLyaoutStyle(n),{state:g,onKeywordChange:v}=usePanelData(n);return React.createElement(React.Fragment,null,s&&React.createElement(WorkspacePanel,Object.assign({},l,{position:{top:0,left:0,height:PANEL_HEADER_HEIGHT,width:u}}),React.createElement(NodePanelHeader,Object.assign({},n,{state:g,style:h,onKeywordChange:v}))),React.createElement(WorkspacePanel,Object.assign({className:`${CONTAINER_CLASS}-nodes`},l,{position:Object.assign(Object.assign({},o),{top:s?PANEL_HEADER_HEIGHT:0})}),React.createElement(NodePanelBody,Object.assign({},n,{state:g,style:p}))))},lR=n=>{registerCustomNode(get(n,"registerNode"));const r=useXflowPrefixCls("node-panel"),[o,s]=useState(!1),{show:l=!0,position:u={width:240,top:40,bottom:0,left:0}}=n,h=__rest(n,["show","position"]);if(!l)return null;const{width:p=200,left:g}=u;return React.createElement(WorkspacePanel,{className:CONTAINER_CLASS,position:Object.assign(Object.assign({},u),{left:o?-p:g})},React.createElement("div",{className:`${CONTAINER_CLASS}-wrapper`},React.createElement(WorkspacePanel,Object.assign({className:r},h,{position:{top:0,bottom:0,left:0,right:0}}),React.createElement(ik,Object.assign({},n,{prefixClz:r,position:u}))),React.createElement("div",{className:`${CONTAINER_CLASS}-icon`,style:{top:21,right:o?-20:-10,borderRadius:o?"0 50% 50% 0":"50%",borderLeft:o?"none":""},onClick:()=>{s(!o)}},o?React.createElement(DoubleRightOutlined,null):React.createElement(DoubleLeftOutlined,null))))},ok="flowchart-connecting-edge",sk="ant";var A1;(function(n){n.EVENT_NAME="ADD_FLOWCHART_EDGE_CMD_EVENT"})(A1||(A1={}));const YP={attrs:{line:{stroke:"#A2B1C3",targetMarker:{name:"block",width:12,height:8},strokeDasharray:"5 5",strokeWidth:1}}},ak=Yr.bn.kS.registry.register("xflow",Yr.bn.kS.define({zIndex:1,highlight:!0,name:ok,label:"",anchor:{name:"midSide",args:{dx:10}},attrs:YP.attrs,data:{label:""}}),!0),lk=Nl((n,r)=>{const{config:o={},useConfig:s,mode:l="edit",showPortsOnNodeSelected:u=!1,edgeConfig:h={}}=r.getValue();n.setEdgeTypeParser(p=>p==null?void 0:p.renderKey),_P(Object.assign(Object.assign({},r.getValue()),{graphConfig:n})),jN(n),rk(n),n.setX6Config(DP()({grid:!0,history:!0,resizing:{enabled:!0,minWidth:Zi,minHeight:Zi,preserveAspectRatio:p=>{const{data:g}=p;return mN.includes(g.name)}},snapline:{enabled:!0},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:8}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,snap:{radius:20},createEdge(){const p=new ak({});return this.once("edge:connected",g=>{const{edge:v,isNew:b}=g;if(b&&v&&v.isEdge()&&p===v){const w=v.getTargetCell();if(w&&w.isNode()){const A=v.getTargetPortId(),O=v.getSourcePortId(),D=v.getSourceCellId(),_=v.getTargetCellId(),I=typeof h=="function"?h(v):h;this.trigger(A1.EVENT_NAME,Object.assign({targetPortId:A,sourcePortId:O,source:D,target:_,edge:v,tempEdgeId:p.id},DP()(YP,I)))}}}),p},validateEdge:p=>{var g;const{edge:v}=p;return!!(!((g=v==null?void 0:v.target)===null||g===void 0)&&g.port)},validateMagnet(){return!0},validateConnection({sourceView:p,targetView:g,targetMagnet:v}){if(p===g)return!1;const b=g.cell;if(v){const w=v.getAttribute("port"),A=b.getPort(w);return!(A&&A.connected)}}},highlighting:{nodeAvailable:{name:"className",args:{className:"available"}},magnetAvailable:{name:"className",args:{className:"available"}},magnetAdsorbed:{name:"className",args:{className:"adsorbed"}}},onPortRendered(p){const{port:g}=p,{contentSelectors:v}=p,b=v&&v.content,w=g.group,A=Ii()("xflow-port",{connected:g.connected});b&&ca.render(F.createElement(tN.ZP,{prefixCls:sk},F.createElement(i1.Z,{title:g.tooltip,placement:w},F.createElement("span",{className:A}))),b)}},o)),n.setEvents([{eventName:"node:selected",callback:()=>{l==="edit"&&MS(!1)}},{eventName:"edge:dblclick",callback:p=>{hN(p)}},{eventName:"edge:mouseleave",callback:(p,g)=>{fN(p,g)}},{eventName:"node:mouseenter",callback:p=>{l==="edit"&&MS(!0,p,u)}},{eventName:"node:mouseleave",callback:p=>{MS(!1,p)}},{eventName:"node:moved",callback:(p,g)=>{sN(p,g)}},{eventName:"node:resized",callback:(p,g)=>{aN(p,g)}}]),typeof s=="function"&&s(n)});let KP=class{constructor(){this.toDispose=new qn,this.registerHookHub=()=>(0,Vt.mG)(this,void 0,void 0,function*(){return Rn.create(()=>{})}),this.registerHook=r=>(0,Vt.mG)(this,void 0,void 0,function*(){const o=new qn,s=[r.afterGraphInit.registerHook({name:"call add edge to replace temp edge",handler:l=>(0,Vt.mG)(this,void 0,void 0,function*(){const{commandService:u,graph:h}=l;h.on(A1.EVENT_NAME,p=>(0,Vt.mG)(this,void 0,void 0,function*(){const{edge:g}=p,v=(0,Vt._T)(p,["edge"]),{tempEdgeId:b}=v,w=(0,Vt._T)(v,["tempEdgeId"]),A={edgeConfig:Object.assign(Object.assign({},w),{source:{cell:v.source,port:v.sourcePortId},target:{cell:v.target,port:v.targetPortId},zIndex:1,data:Object.assign({},w)})};yield u.executeCommand(zi.ADD_EDGE.id,A),yield u.executeCommand(zi.DEL_EDGE.id,{edgeConfig:{id:b}});const O=h.getCellById(v.source),D=h.getCellById(v.target);yield u.executeCommand(di.UPDATE_NODE.id,{nodeConfig:Object.assign(Object.assign({},O.data),{incomingEdges:h.getIncomingEdges(O),outgoingEdges:h.getOutgoingEdges(O)})}),yield u.executeCommand(di.UPDATE_NODE.id,{nodeConfig:Object.assign(Object.assign({},D.data),{incomingEdges:h.getIncomingEdges(D),outgoingEdges:h.getOutgoingEdges(D)})});const _=w1("onAddEdge");typeof _=="function"&&_(A.edgeConfig),p.edge.remove()}))})})];return o.pushAll(s),Rn.create(()=>{})})}};KP=(0,Vt.gn)([Dn({contrib:ga})],KP);const cR=()=>{const n=useExtensionRegistry(),r=React.useMemo(()=>({CONFIG_TYPE:"FLOWCHART_EXTENSION",getConfig:()=>__awaiter(void 0,void 0,void 0,function*(){})}),[]);return React.useEffect(()=>{const o=n.addExtension({config:r,createModule:createFlowchartExtensionModule});return n.addContainerClassNames("flowchart-extension-container"),()=>{o.dispose()}},[r,n]),null},uR=()=>Module(n=>{n(FlowHooksContribution)}),ck=n=>{const{position:r={top:40,left:240,right:240,bottom:0}}=n,o=lk(n),s=po();return(0,F.useEffect)(()=>{s&&rN(s)},[s]),F.createElement(dh,Object.assign({},n,{config:o,position:r}),n.children)};ck.defaultProps={isXFlowCanvas:!0};function uk(n){const[r,o]=(0,F.useState)({loading:!0}),s=(0,F.useCallback)(()=>{n().then(l=>{o({loading:!1,data:l})},l=>{o({loading:!1}),console.error(l)})},[n]);return(0,F.useEffect)(()=>{s()},[s]),r}const DS=n=>{const{controlSchema:r,children:o,type:s="node"}=n,{commandService:l,modelService:u}=ab(),h=(0,F.useCallback)(()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const{data:O}=yield Ul.useValue(u);return O}),[u]),p=(0,F.useCallback)(()=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const O=yield zl.useValue(u),D=O.getData();return Object.assign({id:O.id},D)}),[u]),{data:g,loading:v}=uk(s==="edge"?p:h);F.useEffect(()=>{l.executeCommand(rr.SAVE_GRAPH_DATA.id,{saveGraphDataService:(O,D)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){return{err:null,data:D,meta:O}})})},[l]);const b=O=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const D=yield h(),_=Object.assign(Object.assign({},D),O);yield l.executeCommand(di.UPDATE_NODE.id,{nodeConfig:_}),hb({type:"update:node",config:_})}),w=(O,D="line",_)=>(0,Vt.mG)(void 0,void 0,void 0,function*(){var I;const B=yield p(),G=Object.assign(Object.assign(Object.assign({},B),_?O[_]:O),{attrs:Object.assign(Object.assign({},B.attrs),{[D]:Object.assign(Object.assign({},(I=B.attrs)===null||I===void 0?void 0:I[D]),_?O[_]:O)})});yield l.executeCommand(zi.UPDATE_EDGE.id,{edgeConfig:G}),hb({type:"update:edge",config:G})}),A=O=>(0,Vt.mG)(void 0,void 0,void 0,function*(){const D=yield h(),_=Object.assign(Object.assign({},D),O);yield l.executeCommand(di.UPDATE_NODE.id,{nodeConfig:_}),hb({type:"update:group",config:_})});return v?null:F.createElement(Tp,{schema:r},()=>o(Object.assign({},g),{updateNode:b,updateEdge:w,updateGroup:A}))},Ls="flowchart-editor",T1=24,qP={attrs:{line:{stroke:"#A2B1C3",strokeWidth:1},text:{fill:"#000",fontSize:12,textAnchor:"middle",textVerticalAnchor:"middle"}}},M1={width:12,height:8,name:"block"},P1={width:0,height:0,name:""},dk={target:{sourceMarker:P1,targetMarker:M1},source:{sourceMarker:M1,targetMarker:P1},all:{sourceMarker:M1,targetMarker:M1},none:{sourceMarker:P1,targetMarker:P1}},hk={solid:[0,0],dash:[5,5]};var O1=n=>{const{label:r="\u6807\u7B7E",value:o,onChange:s}=n;return F.createElement("div",{className:"group"},F.createElement("label",null,r),F.createElement(p1.Z,{value:o,style:{height:T1},onChange:l=>{s==null||s(l.target.value)}}))},JP=P(71577),fk=P(48007);const pk=n=>{const{label:r,value:o="",onChange:s}=n,[l,u]=(0,F.useState)(!1),h=(0,F.useRef)(o),p=(0,F.useRef)(),{graphProvider:g}=po(),v=(0,F.useRef)();g.getGraphOptions().then(O=>{v.current=O});const b=()=>F.createElement("div",{className:`${Ls}-pick-color-container`},F.createElement("div",{className:`${Ls}-popover`},F.createElement(fk.xS,{onChange:O=>{h.current=O.hex}}),F.createElement("div",{className:"foolter"},F.createElement(JP.Z,{onClick:()=>{u(!1)}},"\u53D6\u6D88"),F.createElement(JP.Z,{type:"primary",onClick:()=>{s==null||s(h.current),u(!1)}},"\u786E\u8BA4")))),w=(O,D)=>{const _=document.getElementsByClassName(D);if(_.length===1)return _[0];let I=null,B=O.parentElement;for(;!I;){const G=B.getElementsByClassName(D);(G==null?void 0:G.length)>0&&(I=G[0]),B=B.parentElement}return I},A=O=>{const D=document.getElementsByClassName(`${Ls}-pick-color-container`);if(D.length&&Array.from(D).forEach(I=>{var B;(B=I.parentNode)===null||B===void 0||B.removeChild(I)}),!O)return;const _=document.createElement("div");(0,ca.render)((0,ca.createPortal)(F.createElement(b,null),w(p.current,"flowchart-editor-panel-body")),_)};return F.createElement("div",{className:"group",ref:p},r&&F.createElement("label",null,r),F.createElement("div",{className:`${Ls}-color-container`,onClick:()=>{u(!0)}},F.createElement("div",{className:`${Ls}-color`,style:{backgroundColor:o,height:"100%"}})),A(l))};var Jh=(0,F.memo)(pk,(n,r)=>n.label===r.label&&n.value===r.value),fb=n=>{const{label:r,value:o,onChange:s,min:l,width:u}=n;return F.createElement("div",{className:"group"},r&&F.createElement("label",null,r),F.createElement(wS.Z,{value:o,min:l,style:{width:u,height:T1},onChange:h=>{s==null||s(h)}}))};const D1=({value:n,onChangeItem:r,addonBefore:o})=>F.createElement("div",{className:"addon-before-group"},F.createElement(wS.Z,{value:n,style:{height:T1,border:"none"},onChange:s=>{r(s)}}),F.createElement("span",null,o));var _S=n=>{const{label:r="\u4F4D\u7F6E",x:o,y:s,onChange:l}=n;return F.createElement("div",{className:"group"},F.createElement("label",null,r),F.createElement("div",{className:"split"},F.createElement(D1,{addonBefore:"X",value:o,onChangeItem:u=>{l==null||l("x",u)}}),F.createElement(D1,{addonBefore:"Y",value:s,onChangeItem:u=>{l==null||l("y",u)}})))},NS=n=>{const{width:r,height:o,label:s="\u5C3A\u5BF8",onChange:l}=n;return F.createElement("div",{className:"group"},F.createElement("label",null,s),F.createElement("div",{className:"split"},F.createElement(D1,{addonBefore:"W",value:r,onChangeItem:u=>{l==null||l("width",u)}}),F.createElement(D1,{addonBefore:"H",value:o,onChangeItem:u=>{l==null||l("height",u)}})))},kS=n=>{const{label:r="\u7BAD\u5934",value:o,onChange:s,options:l=[],width:u}=n;return F.createElement("div",{className:"group"},F.createElement("label",null,r),F.createElement(xS.Z,{size:"small",value:o,style:{width:u,height:T1},getPopupContainer:h=>h.parentNode,optionFilterProp:"children",onChange:h=>{s==null||s(h)},filterOption:(h,p)=>{const{label:g=""}=p;return typeof g=="string"?g.toLowerCase().indexOf(h.toLowerCase())>=0:g.toString().indexOf(h.toLowerCase())>=0},options:l}))};const mR={InputFiled:O1,ColorPicker:Jh,InputNumberFiled:fb,Size:NS,Position:_S,SelectField:kS},gk=n=>{const{config:r,plugin:o={}}=n,{updateNode:s}=o,[l,u]=(0,F.useState)(Object.assign(Object.assign({},Wt),r)),h=(p,g)=>{u(Object.assign(Object.assign({},l),{[p]:g})),s({[p]:g})};return(0,F.useEffect)(()=>{u(Object.assign(Object.assign({},Wt),r))},[r]),F.createElement("div",{className:`${Ls}-panel-body`},F.createElement("div",{className:`${Ls}-panel-group`},F.createElement("h5",null,"\u5185\u5BB9"),F.createElement(O1,{label:"\u6807\u9898",value:l.label,onChange:p=>{h("label",p)}})),F.createElement("div",{className:`${Ls}-panel-group`},F.createElement("h5",null,"\u6837\u5F0F"),F.createElement(_S,{x:l.x,y:l.y,onChange:(p,g)=>{h(p,g)}}),F.createElement(NS,{width:l.width,height:l.height,onChange:(p,g)=>{h(p,g)}}),F.createElement(Jh,{label:"\u586B\u5145",value:l.fill,onChange:p=>{h("fill",p)}}),F.createElement(Jh,{label:"\u8FB9\u6846",value:l.stroke,onChange:p=>{h("stroke",p)}}),F.createElement("div",{className:`${Ls}-node-text-style`},F.createElement(fb,{label:"\u5B57\u53F7",value:l.fontSize,width:68,onChange:p=>{h("fontSize",p)}}),F.createElement(Jh,{value:l.fontFill,onChange:p=>{h("fontFill",p)}}))))},mk=n=>F.createElement(DS,Object.assign({},n),(r,o)=>F.createElement(gk,Object.assign({},n,{plugin:o,config:r}))),vk=n=>{const{config:r,plugin:o={}}=n,{updateEdge:s}=o,[l,u]=(0,F.useState)(Object.assign(Object.assign({},qP),r));(0,F.useEffect)(()=>{u(Object.assign(Object.assign({},qP),r))},[r]);const h=(b,w="line")=>{var A;const{attrs:O={}}=l;return(A=O[w])===null||A===void 0?void 0:A[b]},p=()=>{var b,w,A,O,D;const{attrs:_={}}=l,{line:I={}}=_;return((b=I.sourceMarker)===null||b===void 0?void 0:b.name)&&((w=I.targetMarker)===null||w===void 0?void 0:w.name)?"all":!(!((A=I.sourceMarker)===null||A===void 0)&&A.name)&&!(!((O=I.targetMarker)===null||O===void 0)&&O.name)?"none":!((D=I.sourceMarker)===null||D===void 0)&&D.name?"source":"target"},g=()=>{const{attrs:b={}}=l,{line:w={}}=b;return w.strokeDasharray?"dash":"solid"},v=(b,w,A="line")=>{var O,D;u(b==="arrow"?Object.assign(Object.assign({},l),{attrs:Object.assign(Object.assign({},l.attrs),{[A]:Object.assign(Object.assign({},(O=l.attrs)===null||O===void 0?void 0:O[A]),w)})}):Object.assign(Object.assign({},l),{[b]:w,attrs:Object.assign(Object.assign({},l.attrs),{[A]:Object.assign(Object.assign({},(D=l.attrs)===null||D===void 0?void 0:D[A]),{[b]:w})})})),s({[b]:w},A,b==="arrow"?"arrow":"")};return F.createElement("div",{className:`${Ls}-panel-body`},F.createElement("div",{className:`${Ls}-panel-group`},F.createElement("h5",null,"\u5185\u5BB9"),F.createElement(O1,{label:"\u6807\u7B7E",value:l.label,onChange:b=>{v("label",b)}})),F.createElement("h5",{style:{marginBottom:12}},"\u6837\u5F0F"),F.createElement("div",{className:`${Ls}-panel-group`,style:{marginBottom:0}},F.createElement("h5",null,"\u7EBF"),F.createElement(kS,{label:"\u7BAD\u5934",value:p(),width:"100%",options:[{label:"\u6B63\u5411",value:"target"},{label:"\u9006\u5411",value:"source"},{label:"\u53CC\u5411",value:"all"},{label:"\u65E0",value:"none"}],onChange:b=>{v("arrow",dk[b],"line")}}),F.createElement("div",{className:`${Ls}-edge-stroke-style`},F.createElement(kS,{label:"\u7EBF\u5F62",width:68,value:g(),options:[{label:"\u5B9E\u7EBF",value:"solid"},{label:"\u865A\u7EBF",value:"dash"}],onChange:b=>{v("strokeDasharray",hk[b],"line")}}),F.createElement(fb,{value:h("strokeWidth"),min:1,onChange:b=>{v("strokeWidth",b,"line")}})),F.createElement(Jh,{label:"\u8FB9\u6846",value:h("stroke"),onChange:b=>{v("stroke",b,"line")}})),F.createElement("div",{className:`${Ls}-panel-group`},F.createElement("h5",null,"\u6807\u7B7E"),F.createElement("div",{className:`${Ls}-edge-text-style`},F.createElement(fb,{label:"\u5B57\u53F7",min:10,width:68,value:h("fontSize","text")||12,onChange:b=>{v("fontSize",b,"text")}}),F.createElement(Jh,{value:h("fill","text")||"#000",onChange:b=>{v("fill",b,"text")}}))))},yk=n=>F.createElement(DS,Object.assign({},n,{type:"edge"}),(r,o)=>F.createElement(vk,Object.assign({},n,{plugin:o,config:r}))),bk=n=>{const{config:r,plugin:o={}}=n,{updateGroup:s}=o,[l,u]=(0,F.useState)(Object.assign(Object.assign({},Wt),r)),h=(p,g)=>{u(Object.assign(Object.assign({},l),{[p]:g})),s({[p]:g})};return(0,F.useEffect)(()=>{u(Object.assign(Object.assign({},Wt),r))},[r]),F.createElement("div",{className:`${Ls}-panel-body`},F.createElement("div",{className:`${Ls}-panel-group`},F.createElement("h5",null,"\u5185\u5BB9"),F.createElement(O1,{label:"\u6807\u9898",value:l.label,onChange:p=>{h("label",p)}})),F.createElement("div",{className:`${Ls}-panel-group`},F.createElement("h5",null,"\u6837\u5F0F"),F.createElement(_S,{x:l.x,y:l.y,onChange:(p,g)=>{h(p,g)}}),F.createElement(NS,{width:l.width,height:l.height,onChange:(p,g)=>{h(p,g)}}),F.createElement(Jh,{label:"\u586B\u5145",value:l.fill,onChange:p=>{h("fill",p)}}),F.createElement(Jh,{label:"\u8FB9\u6846",value:l.stroke,onChange:p=>{h("stroke",p)}}),F.createElement("div",{className:`${Ls}-node-text-style`},F.createElement(fb,{label:"\u5B57\u53F7",value:l.fontSize,width:68,onChange:p=>{h("fontSize",p)}}),F.createElement(Jh,{value:l.fontFill,onChange:p=>{h("fontFill",p)}}))))},xk=n=>F.createElement(DS,Object.assign({},n),(r,o)=>F.createElement(bk,Object.assign({},n,{plugin:o,config:r}))),Ck=()=>F.createElement("div",{className:`${Ls}-canvas-panel`},F.createElement("span",null,"\u672A\u9009\u4E2D")),vR=n=>(n.set("node-service",NodeService),n.set("edge-service",EdgeService),n.set("group-service",GroupService),n.set("canvas-service",CanvasService),n),yR={NodeService:mk,EdgeService:yk,GroupService:xk,CanvasService:Ck},RS="xflow-editor-panel-collpase",bR=n=>{const[r,o]=useState(!1),{controlMapService:s=defaultControlMapService,formSchemaService:l=defaultFormSchemaService,position:u={width:240,top:0,bottom:0,right:0},show:h=!0}=n,p=__rest(n,["controlMapService","formSchemaService","position","show"]);if(!h)return null;const{width:g=200,right:v}=u;return React.createElement(WorkspacePanel,{className:RS,position:Object.assign(Object.assign({},u),{right:r?-g:v})},React.createElement("div",{className:`${RS}-wrapper`},React.createElement(JsonSchemaForm,Object.assign({targetType:["node","edge","canvas","group"],controlMapService:s,formSchemaService:l,position:Object.assign(Object.assign({},u),{top:0}),prefixClz:"xflow-form-editor"},p)),React.createElement("div",{className:`${RS}-icon`,style:{top:21,left:r?-20:-10,borderRadius:r?"50% 0 0  50%":"50%",borderRight:r?"none":""},onClick:()=>{o(!r)}},r?React.createElement(DoubleLeftOutlined,null):React.createElement(DoubleRightOutlined,null))))}},85788:function(je,$,P){var Z=P(58579);je.exports={Graph:Z.Graph,json:P(62485),alg:P(39100),version:Z.version}},74774:function(je,$,P){var Z=P(8057);je.exports=H;function H(J){var U={},pe=[],ke;function Ce(ge){Z.has(U,ge)||(U[ge]=!0,ke.push(ge),Z.each(J.successors(ge),Ce),Z.each(J.predecessors(ge),Ce))}return Z.each(J.nodes(),function(ge){ke=[],Ce(ge),ke.length&&pe.push(ke)}),pe}},65179:function(je,$,P){var Z=P(8057);je.exports=H;function H(U,pe,ke){Z.isArray(pe)||(pe=[pe]);var Ce=(U.isDirected()?U.successors:U.neighbors).bind(U),ge=[],Me={};return Z.each(pe,function(Se){if(!U.hasNode(Se))throw new Error("Graph does not have node: "+Se);J(U,Se,ke==="post",Me,Ce,ge)}),ge}function J(U,pe,ke,Ce,ge,Me){Z.has(Ce,pe)||(Ce[pe]=!0,ke||Me.push(pe),Z.each(ge(pe),function(Se){J(U,Se,ke,Ce,ge,Me)}),ke&&Me.push(pe))}},78698:function(je,$,P){var Z=P(69205),H=P(8057);je.exports=J;function J(U,pe,ke){return H.transform(U.nodes(),function(Ce,ge){Ce[ge]=Z(U,ge,pe,ke)},{})}},69205:function(je,$,P){var Z=P(8057),H=P(96129);je.exports=U;var J=Z.constant(1);function U(ke,Ce,ge,Me){return pe(ke,String(Ce),ge||J,Me||function(Se){return ke.outEdges(Se)})}function pe(ke,Ce,ge,Me){var Se={},ee=new H,oe,Ae,X=function(le){var Q=le.v!==oe?le.v:le.w,ne=Se[Q],he=ge(le),Ue=Ae.distance+he;if(he<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+le+" Weight: "+he);Ue<ne.distance&&(ne.distance=Ue,ne.predecessor=oe,ee.decrease(Q,Ue))};for(ke.nodes().forEach(function(le){var Q=le===Ce?0:Number.POSITIVE_INFINITY;Se[le]={distance:Q},ee.add(le,Q)});ee.size()>0&&(oe=ee.removeMin(),Ae=Se[oe],Ae.distance!==Number.POSITIVE_INFINITY);)Me(oe).forEach(X);return Se}},32630:function(je,$,P){var Z=P(8057),H=P(93070);je.exports=J;function J(U){return Z.filter(H(U),function(pe){return pe.length>1||pe.length===1&&U.hasEdge(pe[0],pe[0])})}},3171:function(je,$,P){var Z=P(8057);je.exports=J;var H=Z.constant(1);function J(pe,ke,Ce){return U(pe,ke||H,Ce||function(ge){return pe.outEdges(ge)})}function U(pe,ke,Ce){var ge={},Me=pe.nodes();return Me.forEach(function(Se){ge[Se]={},ge[Se][Se]={distance:0},Me.forEach(function(ee){Se!==ee&&(ge[Se][ee]={distance:Number.POSITIVE_INFINITY})}),Ce(Se).forEach(function(ee){var oe=ee.v===Se?ee.w:ee.v,Ae=ke(ee);ge[Se][oe]={distance:Ae,predecessor:Se}})}),Me.forEach(function(Se){var ee=ge[Se];Me.forEach(function(oe){var Ae=ge[oe];Me.forEach(function(X){var le=Ae[Se],Q=ee[X],ne=Ae[X],he=le.distance+Q.distance;he<ne.distance&&(ne.distance=he,ne.predecessor=Q.predecessor)})})}),ge}},39100:function(je,$,P){je.exports={components:P(74774),dijkstra:P(69205),dijkstraAll:P(78698),findCycles:P(32630),floydWarshall:P(3171),isAcyclic:P(78149),postorder:P(85979),preorder:P(5340),prim:P(74975),tarjan:P(93070),topsort:P(37034)}},78149:function(je,$,P){var Z=P(37034);je.exports=H;function H(J){try{Z(J)}catch(U){if(U instanceof Z.CycleException)return!1;throw U}return!0}},85979:function(je,$,P){var Z=P(65179);je.exports=H;function H(J,U){return Z(J,U,"post")}},5340:function(je,$,P){var Z=P(65179);je.exports=H;function H(J,U){return Z(J,U,"pre")}},74975:function(je,$,P){var Z=P(8057),H=P(1053),J=P(96129);je.exports=U;function U(pe,ke){var Ce=new H,ge={},Me=new J,Se;function ee(Ae){var X=Ae.v===Se?Ae.w:Ae.v,le=Me.priority(X);if(le!==void 0){var Q=ke(Ae);Q<le&&(ge[X]=Se,Me.decrease(X,Q))}}if(pe.nodeCount()===0)return Ce;Z.each(pe.nodes(),function(Ae){Me.add(Ae,Number.POSITIVE_INFINITY),Ce.setNode(Ae)}),Me.decrease(pe.nodes()[0],0);for(var oe=!1;Me.size()>0;){if(Se=Me.removeMin(),Z.has(ge,Se))Ce.setEdge(Se,ge[Se]);else{if(oe)throw new Error("Input graph is not connected: "+pe);oe=!0}pe.nodeEdges(Se).forEach(ee)}return Ce}},93070:function(je,$,P){var Z=P(8057);je.exports=H;function H(J){var U=0,pe=[],ke={},Ce=[];function ge(Me){var Se=ke[Me]={onStack:!0,lowlink:U,index:U++};if(pe.push(Me),J.successors(Me).forEach(function(Ae){Z.has(ke,Ae)?ke[Ae].onStack&&(Se.lowlink=Math.min(Se.lowlink,ke[Ae].index)):(ge(Ae),Se.lowlink=Math.min(Se.lowlink,ke[Ae].lowlink))}),Se.lowlink===Se.index){var ee=[],oe;do oe=pe.pop(),ke[oe].onStack=!1,ee.push(oe);while(Me!==oe);Ce.push(ee)}}return J.nodes().forEach(function(Me){Z.has(ke,Me)||ge(Me)}),Ce}},37034:function(je,$,P){var Z=P(8057);je.exports=H,H.CycleException=J;function H(U){var pe={},ke={},Ce=[];function ge(Me){if(Z.has(ke,Me))throw new J;Z.has(pe,Me)||(ke[Me]=!0,pe[Me]=!0,Z.each(U.predecessors(Me),ge),delete ke[Me],Ce.push(Me))}if(Z.each(U.sinks(),ge),Z.size(pe)!==U.nodeCount())throw new J;return Ce}function J(){}},96129:function(je,$,P){var Z=P(8057);je.exports=H;function H(){this._arr=[],this._keyIndices={}}H.prototype.size=function(){return this._arr.length},H.prototype.keys=function(){return this._arr.map(function(J){return J.key})},H.prototype.has=function(J){return Z.has(this._keyIndices,J)},H.prototype.priority=function(J){var U=this._keyIndices[J];if(U!==void 0)return this._arr[U].priority},H.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},H.prototype.add=function(J,U){var pe=this._keyIndices;if(J=String(J),!Z.has(pe,J)){var ke=this._arr,Ce=ke.length;return pe[J]=Ce,ke.push({key:J,priority:U}),this._decrease(Ce),!0}return!1},H.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var J=this._arr.pop();return delete this._keyIndices[J.key],this._heapify(0),J.key},H.prototype.decrease=function(J,U){var pe=this._keyIndices[J];if(U>this._arr[pe].priority)throw new Error("New priority is greater than current priority. Key: "+J+" Old: "+this._arr[pe].priority+" New: "+U);this._arr[pe].priority=U,this._decrease(pe)},H.prototype._heapify=function(J){var U=this._arr,pe=2*J,ke=pe+1,Ce=J;pe<U.length&&(Ce=U[pe].priority<U[Ce].priority?pe:Ce,ke<U.length&&(Ce=U[ke].priority<U[Ce].priority?ke:Ce),Ce!==J&&(this._swap(J,Ce),this._heapify(Ce)))},H.prototype._decrease=function(J){for(var U=this._arr,pe=U[J].priority,ke;J!==0&&(ke=J>>1,!(U[ke].priority<pe));)this._swap(J,ke),J=ke},H.prototype._swap=function(J,U){var pe=this._arr,ke=this._keyIndices,Ce=pe[J],ge=pe[U];pe[J]=ge,pe[U]=Ce,ke[ge.key]=J,ke[Ce.key]=U}},1053:function(je,$,P){"use strict";var Z=P(8057);je.exports=pe;var H="\0",J="\0",U="";function pe(ee){this._isDirected=Z.has(ee,"directed")?ee.directed:!0,this._isMultigraph=Z.has(ee,"multigraph")?ee.multigraph:!1,this._isCompound=Z.has(ee,"compound")?ee.compound:!1,this._label=void 0,this._defaultNodeLabelFn=Z.constant(void 0),this._defaultEdgeLabelFn=Z.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[J]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}pe.prototype._nodeCount=0,pe.prototype._edgeCount=0,pe.prototype.isDirected=function(){return this._isDirected},pe.prototype.isMultigraph=function(){return this._isMultigraph},pe.prototype.isCompound=function(){return this._isCompound},pe.prototype.setGraph=function(ee){return this._label=ee,this},pe.prototype.graph=function(){return this._label},pe.prototype.setDefaultNodeLabel=function(ee){return Z.isFunction(ee)||(ee=Z.constant(ee)),this._defaultNodeLabelFn=ee,this},pe.prototype.nodeCount=function(){return this._nodeCount},pe.prototype.nodes=function(){return Z.keys(this._nodes)},pe.prototype.sources=function(){return Z.filter(this.nodes(),Z.bind(function(ee){return Z.isEmpty(this._in[ee])},this))},pe.prototype.sinks=function(){return Z.filter(this.nodes(),Z.bind(function(ee){return Z.isEmpty(this._out[ee])},this))},pe.prototype.setNodes=function(ee,oe){var Ae=arguments;return Z.each(ee,Z.bind(function(X){Ae.length>1?this.setNode(X,oe):this.setNode(X)},this)),this},pe.prototype.setNode=function(ee,oe){return Z.has(this._nodes,ee)?(arguments.length>1&&(this._nodes[ee]=oe),this):(this._nodes[ee]=arguments.length>1?oe:this._defaultNodeLabelFn(ee),this._isCompound&&(this._parent[ee]=J,this._children[ee]={},this._children[J][ee]=!0),this._in[ee]={},this._preds[ee]={},this._out[ee]={},this._sucs[ee]={},++this._nodeCount,this)},pe.prototype.node=function(ee){return this._nodes[ee]},pe.prototype.hasNode=function(ee){return Z.has(this._nodes,ee)},pe.prototype.removeNode=function(ee){var oe=this;if(Z.has(this._nodes,ee)){var Ae=function(X){oe.removeEdge(oe._edgeObjs[X])};delete this._nodes[ee],this._isCompound&&(this._removeFromParentsChildList(ee),delete this._parent[ee],Z.each(this.children(ee),Z.bind(function(X){this.setParent(X)},this)),delete this._children[ee]),Z.each(Z.keys(this._in[ee]),Ae),delete this._in[ee],delete this._preds[ee],Z.each(Z.keys(this._out[ee]),Ae),delete this._out[ee],delete this._sucs[ee],--this._nodeCount}return this},pe.prototype.setParent=function(ee,oe){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Z.isUndefined(oe))oe=J;else{oe+="";for(var Ae=oe;!Z.isUndefined(Ae);Ae=this.parent(Ae))if(Ae===ee)throw new Error("Setting "+oe+" as parent of "+ee+" would create create a cycle");this.setNode(oe)}return this.setNode(ee),this._removeFromParentsChildList(ee),this._parent[ee]=oe,this._children[oe][ee]=!0,this},pe.prototype._removeFromParentsChildList=function(ee){delete this._children[this._parent[ee]][ee]},pe.prototype.parent=function(ee){if(this._isCompound){var oe=this._parent[ee];if(oe!==J)return oe}},pe.prototype.children=function(ee){if(Z.isUndefined(ee)&&(ee=J),this._isCompound){var oe=this._children[ee];if(oe)return Z.keys(oe)}else{if(ee===J)return this.nodes();if(this.hasNode(ee))return[]}},pe.prototype.predecessors=function(ee){var oe=this._preds[ee];if(oe)return Z.keys(oe)},pe.prototype.successors=function(ee){var oe=this._sucs[ee];if(oe)return Z.keys(oe)},pe.prototype.neighbors=function(ee){var oe=this.predecessors(ee);if(oe)return Z.union(oe,this.successors(ee))},pe.prototype.isLeaf=function(ee){var oe;return this.isDirected()?oe=this.successors(ee):oe=this.neighbors(ee),oe.length===0},pe.prototype.filterNodes=function(ee){var oe=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});oe.setGraph(this.graph()),Z.each(this._nodes,Z.bind(function(Q,ne){ee(ne)&&oe.setNode(ne,Q)},this)),Z.each(this._edgeObjs,Z.bind(function(Q){oe.hasNode(Q.v)&&oe.hasNode(Q.w)&&oe.setEdge(Q,this.edge(Q))},this));var Ae=this,X={};function le(Q){var ne=Ae.parent(Q);return ne===void 0||oe.hasNode(ne)?(X[Q]=ne,ne):ne in X?X[ne]:le(ne)}return this._isCompound&&Z.each(oe.nodes(),function(Q){oe.setParent(Q,le(Q))}),oe},pe.prototype.setDefaultEdgeLabel=function(ee){return Z.isFunction(ee)||(ee=Z.constant(ee)),this._defaultEdgeLabelFn=ee,this},pe.prototype.edgeCount=function(){return this._edgeCount},pe.prototype.edges=function(){return Z.values(this._edgeObjs)},pe.prototype.setPath=function(ee,oe){var Ae=this,X=arguments;return Z.reduce(ee,function(le,Q){return X.length>1?Ae.setEdge(le,Q,oe):Ae.setEdge(le,Q),Q}),this},pe.prototype.setEdge=function(){var ee,oe,Ae,X,le=!1,Q=arguments[0];typeof Q=="object"&&Q!==null&&"v"in Q?(ee=Q.v,oe=Q.w,Ae=Q.name,arguments.length===2&&(X=arguments[1],le=!0)):(ee=Q,oe=arguments[1],Ae=arguments[3],arguments.length>2&&(X=arguments[2],le=!0)),ee=""+ee,oe=""+oe,Z.isUndefined(Ae)||(Ae=""+Ae);var ne=ge(this._isDirected,ee,oe,Ae);if(Z.has(this._edgeLabels,ne))return le&&(this._edgeLabels[ne]=X),this;if(!Z.isUndefined(Ae)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(ee),this.setNode(oe),this._edgeLabels[ne]=le?X:this._defaultEdgeLabelFn(ee,oe,Ae);var he=Me(this._isDirected,ee,oe,Ae);return ee=he.v,oe=he.w,Object.freeze(he),this._edgeObjs[ne]=he,ke(this._preds[oe],ee),ke(this._sucs[ee],oe),this._in[oe][ne]=he,this._out[ee][ne]=he,this._edgeCount++,this},pe.prototype.edge=function(ee,oe,Ae){var X=arguments.length===1?Se(this._isDirected,arguments[0]):ge(this._isDirected,ee,oe,Ae);return this._edgeLabels[X]},pe.prototype.hasEdge=function(ee,oe,Ae){var X=arguments.length===1?Se(this._isDirected,arguments[0]):ge(this._isDirected,ee,oe,Ae);return Z.has(this._edgeLabels,X)},pe.prototype.removeEdge=function(ee,oe,Ae){var X=arguments.length===1?Se(this._isDirected,arguments[0]):ge(this._isDirected,ee,oe,Ae),le=this._edgeObjs[X];return le&&(ee=le.v,oe=le.w,delete this._edgeLabels[X],delete this._edgeObjs[X],Ce(this._preds[oe],ee),Ce(this._sucs[ee],oe),delete this._in[oe][X],delete this._out[ee][X],this._edgeCount--),this},pe.prototype.inEdges=function(ee,oe){var Ae=this._in[ee];if(Ae){var X=Z.values(Ae);return oe?Z.filter(X,function(le){return le.v===oe}):X}},pe.prototype.outEdges=function(ee,oe){var Ae=this._out[ee];if(Ae){var X=Z.values(Ae);return oe?Z.filter(X,function(le){return le.w===oe}):X}},pe.prototype.nodeEdges=function(ee,oe){var Ae=this.inEdges(ee,oe);if(Ae)return Ae.concat(this.outEdges(ee,oe))};function ke(ee,oe){ee[oe]?ee[oe]++:ee[oe]=1}function Ce(ee,oe){--ee[oe]||delete ee[oe]}function ge(ee,oe,Ae,X){var le=""+oe,Q=""+Ae;if(!ee&&le>Q){var ne=le;le=Q,Q=ne}return le+U+Q+U+(Z.isUndefined(X)?H:X)}function Me(ee,oe,Ae,X){var le=""+oe,Q=""+Ae;if(!ee&&le>Q){var ne=le;le=Q,Q=ne}var he={v:le,w:Q};return X&&(he.name=X),he}function Se(ee,oe){return ge(ee,oe.v,oe.w,oe.name)}},58579:function(je,$,P){je.exports={Graph:P(1053),version:P(82321)}},62485:function(je,$,P){var Z=P(8057),H=P(1053);je.exports={write:J,read:ke};function J(Ce){var ge={options:{directed:Ce.isDirected(),multigraph:Ce.isMultigraph(),compound:Ce.isCompound()},nodes:U(Ce),edges:pe(Ce)};return Z.isUndefined(Ce.graph())||(ge.value=Z.clone(Ce.graph())),ge}function U(Ce){return Z.map(Ce.nodes(),function(ge){var Me=Ce.node(ge),Se=Ce.parent(ge),ee={v:ge};return Z.isUndefined(Me)||(ee.value=Me),Z.isUndefined(Se)||(ee.parent=Se),ee})}function pe(Ce){return Z.map(Ce.edges(),function(ge){var Me=Ce.edge(ge),Se={v:ge.v,w:ge.w};return Z.isUndefined(ge.name)||(Se.name=ge.name),Z.isUndefined(Me)||(Se.value=Me),Se})}function ke(Ce){var ge=new H(Ce.options).setGraph(Ce.value);return Z.each(Ce.nodes,function(Me){ge.setNode(Me.v,Me.value),Me.parent&&ge.setParent(Me.v,Me.parent)}),Z.each(Ce.edges,function(Me){ge.setEdge({v:Me.v,w:Me.w,name:Me.name},Me.value)}),ge}},8057:function(je,$,P){var Z;try{Z=P(96486)}catch{}Z||(Z=window._),je.exports=Z},82321:function(je){je.exports="2.1.4"},70781:function(){"use strict"},49469:function(je,$){"use strict";var P;P={value:!0};var Z;(function(we){we.TextureCompressionBC="texture-compression-bc"})(Z=$.UX||($.UX={}));var H;(function(we){we.ClampToEdge="clamp-to-edge",we.Repeat="repeat",we.MirrorRepeat="mirror-repeat"})(H=$.OB||($.OB={}));var J;(function(we){we.UniformBuffer="uniform-buffer",we.StorageBuffer="storage-buffer",we.ReadonlyStorageBuffer="readonly-storage-buffer",we.Sampler="sampler",we.ComparisonSampler="comparison-sampler",we.SampledTexture="sampled-texture",we.ReadonlyStorageTexture="readonly-storage-texture",we.WriteonlyStorageTexture="writeonly-storage-texture"})(J=$.$l||($.$l={}));var U;(function(we){we.Zero="zero",we.One="one",we.SrcColor="src-color",we.OneMinusSrcColor="one-minus-src-color",we.SrcAlpha="src-alpha",we.OneMinusSrcAlpha="one-minus-src-alpha",we.DstColor="dst-color",we.OneMinusDstColor="one-minus-dst-color",we.DstAlpha="dst-alpha",we.OneMinusDstAlpha="one-minus-dst-alpha",we.SrcAlphaSaturated="src-alpha-saturated",we.BlendColor="blend-color",we.OneMinusBlendColor="one-minus-blend-color"})(U=$.zi||($.zi={}));var pe;(function(we){we.Add="add",we.Subtract="subtract",we.ReverseSubtract="reverse-subtract",we.Min="min",we.Max="max"})(pe=$.db||($.db={}));var ke;(function(we){we.Never="never",we.Less="less",we.Equal="equal",we.LessEqual="less-equal",we.Greater="greater",we.NotEqual="not-equal",we.GreaterEqual="greater-equal",we.Always="always"})(ke=$.wb||($.wb={}));var Ce;(function(we){we.None="none",we.Front="front",we.Back="back"})(Ce=$.Wf||($.Wf={}));var ge;(function(we){we.Nearest="nearest",we.Linear="linear"})(ge=$.X9||($.X9={}));var Me;(function(we){we.CCW="ccw",we.CW="cw"})(Me=$.zX||($.zX={}));var Se;(function(we){we.Uint16="uint16",we.Uint32="uint32"})(Se=$.iD||($.iD={}));var ee;(function(we){we.Vertex="vertex",we.Instance="instance"})(ee=$.V||($.V={}));var oe;(function(we){we.Load="load"})(oe=$.Ws||($.Ws={}));var Ae;(function(we){we.PointList="point-list",we.LineList="line-list",we.LineStrip="line-strip",we.TriangleList="triangle-list",we.TriangleStrip="triangle-strip"})(Ae=$.YV||($.YV={}));var X;(function(we){we.Keep="keep",we.Zero="zero",we.Replace="replace",we.Invert="invert",we.IncrementClamp="increment-clamp",we.DecrementClamp="decrement-clamp",we.IncrementWrap="increment-wrap",we.DecrementWrap="decrement-wrap"})(X=$.xS||($.xS={}));var le;(function(we){we.Store="store",we.Clear="clear"})(le=$.EG||($.EG={}));var Q;(function(we){we.E1d="1d",we.E2d="2d",we.E3d="3d"})(Q=$.kd||($.kd={}));var ne;(function(we){we.R8Unorm="r8unorm",we.R8Snorm="r8snorm",we.R8Uint="r8uint",we.R8Sint="r8sint",we.R16Uint="r16uint",we.R16Sint="r16sint",we.R16Float="r16float",we.RG8Unorm="rg8unorm",we.RG8Snorm="rg8snorm",we.RG8Uint="rg8uint",we.RG8Sint="rg8sint",we.R32Uint="r32uint",we.R32Sint="r32sint",we.R32Float="r32float",we.RG16Uint="rg16uint",we.RG16Sint="rg16sint",we.RG16Float="rg16float",we.RGBA8Unorm="rgba8unorm",we.RGBA8UnormSRGB="rgba8unorm-srgb",we.RGBA8Snorm="rgba8snorm",we.RGBA8Uint="rgba8uint",we.RGBA8Sint="rgba8sint",we.BGRA8Unorm="bgra8unorm",we.BGRA8UnormSRGB="bgra8unorm-srgb",we.RGB10A2Unorm="rgb10a2unorm",we.RG11B10Float="rg11b10float",we.RG32Uint="rg32uint",we.RG32Sint="rg32sint",we.RG32Float="rg32float",we.RGBA16Uint="rgba16uint",we.RGBA16Sint="rgba16sint",we.RGBA16Float="rgba16float",we.RGBA32Uint="rgba32uint",we.RGBA32Sint="rgba32sint",we.RGBA32Float="rgba32float",we.Depth32Float="depth32float",we.Depth24Plus="depth24plus",we.Depth24PlusStencil8="depth24plus-stencil8"})(ne=$.EV||($.EV={}));var he;(function(we){we.Float="float",we.Sint="sint",we.Uint="uint"})(he=$.Ek||($.Ek={}));var Ue;(function(we){we.E1d="1d",we.E2d="2d",we.E2dArray="2d-array",we.Cube="cube",we.CubeArray="cube-array",we.E3d="3d"})(Ue=$.p_||($.p_={}));var ce;(function(we){we.Uchar2="uchar2",we.Uchar4="uchar4",we.Char2="char2",we.Char4="char4",we.Uchar2Norm="uchar2norm",we.Uchar4Norm="uchar4norm",we.Char2Norm="char2norm",we.Char4Norm="char4norm",we.Ushort2="ushort2",we.Ushort4="ushort4",we.Short2="short2",we.Short4="short4",we.Ushort2Norm="ushort2norm",we.Ushort4Norm="ushort4norm",we.Short2Norm="short2norm",we.Short4Norm="short4norm",we.Half2="half2",we.Half4="half4",we.Float="float",we.Float2="float2",we.Float3="float3",we.Float4="float4",we.Uint="uint",we.Uint2="uint2",we.Uint3="uint3",we.Uint4="uint4",we.Int="int",we.Int2="int2",we.Int3="int3",we.Int4="int4"})(ce=$.gB||($.gB={}));var De;(function(we){we.All="all",we.StencilOnly="stencil-only",we.DepthOnly="depth-only"})(De=$.H7||($.H7={}));var _t;(function(we){we.Error="error",we.Warning="warning",we.Info="info"})(_t=$.mj||($.mj={}));var N;(function(we){we.Occlusion="occlusion"})(N=$.xL||($.xL={}));var ze;(function(we){we[we.MapRead=1]="MapRead",we[we.MapWrite=2]="MapWrite",we[we.CopySrc=4]="CopySrc",we[we.CopyDst=8]="CopyDst",we[we.Index=16]="Index",we[we.Vertex=32]="Vertex",we[we.Uniform=64]="Uniform",we[we.Storage=128]="Storage",we[we.Indirect=256]="Indirect",we[we.QueryResolve=512]="QueryResolve"})(ze=$.FB||($.FB={}));var Ze;(function(we){we[we.Red=1]="Red",we[we.Green=2]="Green",we[we.Blue=4]="Blue",we[we.Alpha=8]="Alpha",we[we.All=15]="All"})(Ze=$.Yw||($.Yw={}));var xt;(function(we){we[we.Vertex=1]="Vertex",we[we.Fragment=2]="Fragment",we[we.Compute=4]="Compute"})(xt=$.$X||($.$X={}));var Zt;(function(we){we[we.CopySrc=1]="CopySrc",we[we.CopyDst=2]="CopyDst",we[we.Sampled=4]="Sampled",we[we.Storage=8]="Storage",we[we.OutputAttachment=16]="OutputAttachment"})(Zt=$.v2||($.v2={}));var Kn;(function(we){we[we.Read=1]="Read",we[we.Write=2]="Write"})(Kn=$.gc||($.gc={}))},7573:function(je,$,P){"use strict";P.d($,{Z:function(){return Dn}});var Z=P(4942),H=P(71002),J=P(87462),U=P(80766),pe=P(94184),ke=P.n(pe),Ce=P(76513),ge=P(67294),Me=P(53124),Se=P(33603),ee=P(93433),oe=P(29439),Ae=P(86504),X=P(91816),le=P(63258),Q=P(10225),ne=P(1089),he;(function(yn){yn[yn.None=0]="None",yn[yn.Start=1]="Start",yn[yn.End=2]="End"})(he||(he={}));function Ue(yn,Rt){function Sr(pr){var _n=pr.key,gr=pr.children;Rt(_n,pr)!==!1&&Ue(gr||[],Rt)}yn.forEach(Sr)}function ce(yn){var Rt=yn.treeData,Sr=yn.expandedKeys,pr=yn.startKey,_n=yn.endKey,gr=[],Nn=he.None;if(pr&&pr===_n)return[pr];if(!pr||!_n)return[];function yr(Or){return Or===pr||Or===_n}return Ue(Rt,function(Or){if(Nn===he.End)return!1;if(yr(Or)){if(gr.push(Or),Nn===he.None)Nn=he.Start;else if(Nn===he.Start)return Nn=he.End,!1}else Nn===he.Start&&gr.push(Or);return Sr.indexOf(Or)!==-1}),gr}function De(yn,Rt){var Sr=(0,ee.Z)(Rt),pr=[];return Ue(yn,function(_n,gr){var Nn=Sr.indexOf(_n);return Nn!==-1&&(pr.push(gr),Sr.splice(Nn,1)),!!Sr.length}),pr}var _t=function(yn,Rt){var Sr={};for(var pr in yn)Object.prototype.hasOwnProperty.call(yn,pr)&&Rt.indexOf(pr)<0&&(Sr[pr]=yn[pr]);if(yn!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _n=0,pr=Object.getOwnPropertySymbols(yn);_n<pr.length;_n++)Rt.indexOf(pr[_n])<0&&Object.prototype.propertyIsEnumerable.call(yn,pr[_n])&&(Sr[pr[_n]]=yn[pr[_n]]);return Sr};function N(yn){var Rt=yn.isLeaf,Sr=yn.expanded;return Rt?ge.createElement(Ae.Z,null):Sr?ge.createElement(X.Z,null):ge.createElement(le.Z,null)}function ze(yn){var Rt=yn.treeData,Sr=yn.children;return Rt||(0,ne.zn)(Sr)}var Ze=function(Rt,Sr){var pr=Rt.defaultExpandAll,_n=Rt.defaultExpandParent,gr=Rt.defaultExpandedKeys,Nn=_t(Rt,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]),yr=ge.useRef(),Or=ge.useRef(),Co=ge.createRef();ge.useImperativeHandle(Sr,function(){return Co.current});var _r=function(){var ya=(0,ne.I8)(ze(Nn)),Ys=ya.keyEntities,qo;return pr?qo=Object.keys(Ys):_n?qo=(0,Q.r7)(Nn.expandedKeys||gr||[],Ys):qo=Nn.expandedKeys||gr,qo},Mi=ge.useState(Nn.selectedKeys||Nn.defaultSelectedKeys||[]),Xi=(0,oe.Z)(Mi,2),ms=Xi[0],Xs=Xi[1],Yi=ge.useState(_r()),Bi=(0,oe.Z)(Yi,2),Qr=Bi[0],fo=Bi[1];ge.useEffect(function(){"selectedKeys"in Nn&&Xs(Nn.selectedKeys)},[Nn.selectedKeys]),ge.useEffect(function(){"expandedKeys"in Nn&&fo(Nn.expandedKeys)},[Nn.expandedKeys]);var Qn=function(ya,Ys){var qo;return"expandedKeys"in Nn||fo(ya),(qo=Nn.onExpand)===null||qo===void 0?void 0:qo.call(Nn,ya,Ys)},Hr=function(ya,Ys){var qo,la=Nn.multiple,Ss=Ys.node,Jo=Ys.nativeEvent,Ks=Ss.key,ac=Ks===void 0?"":Ks,lc=ze(Nn),Qo=(0,J.Z)((0,J.Z)({},Ys),{selected:!0}),es=(Jo==null?void 0:Jo.ctrlKey)||(Jo==null?void 0:Jo.metaKey),zu=Jo==null?void 0:Jo.shiftKey,qs;la&&es?(qs=ya,yr.current=ac,Or.current=qs,Qo.selectedNodes=De(lc,qs)):la&&zu?(qs=Array.from(new Set([].concat((0,ee.Z)(Or.current||[]),(0,ee.Z)(ce({treeData:lc,expandedKeys:Qr,startKey:ac,endKey:yr.current}))))),Qo.selectedNodes=De(lc,qs)):(qs=[ac],yr.current=ac,Or.current=qs,Qo.selectedNodes=De(lc,qs)),(qo=Nn.onSelect)===null||qo===void 0||qo.call(Nn,qs,Qo),"selectedKeys"in Nn||Xs(qs)},Ra=ge.useContext(Me.E_),fe=Ra.getPrefixCls,Yc=Ra.direction,Bu=Nn.prefixCls,vt=Nn.className,Tl=_t(Nn,["prefixCls","className"]),ct=fe("tree",Bu),Ee=ke()("".concat(ct,"-directory"),(0,Z.Z)({},"".concat(ct,"-directory-rtl"),Yc==="rtl"),vt);return ge.createElement(nn,(0,J.Z)({icon:N,ref:Co,blockNode:!0},Tl,{prefixCls:ct,className:Ee,expandedKeys:Qr,selectedKeys:ms,onSelect:Hr,onExpand:Qn}))},xt=ge.forwardRef(Ze);xt.defaultProps={showIcon:!0,expandAction:"click"};var Zt=xt,Kn=4;function we(yn){var Rt,Sr=yn.dropPosition,pr=yn.dropLevelOffset,_n=yn.prefixCls,gr=yn.indent,Nn=yn.direction,yr=Nn===void 0?"ltr":Nn,Or=yr==="ltr"?"left":"right",Co=yr==="ltr"?"right":"left",_r=(Rt={},(0,Z.Z)(Rt,Or,-pr*gr+Kn),(0,Z.Z)(Rt,Co,0),Rt);switch(Sr){case-1:_r.top=-3;break;case 1:_r.bottom=-3;break;default:_r.bottom=-3,_r[Or]=gr+Kn;break}return ge.createElement("div",{style:_r,className:"".concat(_n,"-drop-indicator")})}var Bn=P(61639),Fr=ge.forwardRef(function(yn,Rt){var Sr,pr=ge.useContext(Me.E_),_n=pr.getPrefixCls,gr=pr.direction,Nn=pr.virtual,yr=yn.prefixCls,Or=yn.className,Co=yn.showIcon,_r=yn.showLine,Mi=yn.switcherIcon,Xi=yn.blockNode,ms=yn.children,Xs=yn.checkable,Yi=yn.selectable,Bi=yn.draggable,Qr=_n("tree",yr),fo=(0,J.Z)((0,J.Z)({},yn),{showLine:Boolean(_r),dropIndicatorRender:we}),Qn=ge.useMemo(function(){if(!Bi)return!1;var Hr={};switch((0,H.Z)(Bi)){case"function":Hr.nodeDraggable=Bi;break;case"object":Hr=(0,J.Z)({},Bi);break;default:}return Hr.icon!==!1&&(Hr.icon=Hr.icon||ge.createElement(U.Z,null)),Hr},[Bi]);return ge.createElement(Ce.Z,(0,J.Z)({itemHeight:20,ref:Rt,virtual:Nn},fo,{prefixCls:Qr,className:ke()((Sr={},(0,Z.Z)(Sr,"".concat(Qr,"-icon-hide"),!Co),(0,Z.Z)(Sr,"".concat(Qr,"-block-node"),Xi),(0,Z.Z)(Sr,"".concat(Qr,"-unselectable"),!Yi),(0,Z.Z)(Sr,"".concat(Qr,"-rtl"),gr==="rtl"),Sr),Or),direction:gr,checkable:Xs&&ge.createElement("span",{className:"".concat(Qr,"-checkbox-inner")}),selectable:Yi,switcherIcon:function(Ra){return(0,Bn.Z)(Qr,Mi,_r,Ra)},draggable:Qn}),ms)});Fr.TreeNode=Ce.O,Fr.DirectoryTree=Zt,Fr.defaultProps={checkable:!1,selectable:!0,showIcon:!1,motion:(0,J.Z)((0,J.Z)({},Se.ZP),{motionAppear:!1}),blockNode:!1};var nn=Fr,Dn=nn},89550:function(je){je.exports=$;function $(P,Z,H){return P[0]=Z[0]+H[0],P[1]=Z[1]+H[1],P}},62189:function(je){je.exports=$;function $(P,Z){return P[0]=Math.ceil(Z[0]),P[1]=Math.ceil(Z[1]),P}},76057:function(je){je.exports=$;function $(P){var Z=new Float32Array(2);return Z[0]=P[0],Z[1]=P[1],Z}},3492:function(je){je.exports=$;function $(P,Z){return P[0]=Z[0],P[1]=Z[1],P}},61589:function(je){je.exports=$;function $(){var P=new Float32Array(2);return P[0]=0,P[1]=0,P}},56439:function(je){je.exports=$;function $(P,Z,H){var J=Z[0]*H[1]-Z[1]*H[0];return P[0]=P[1]=0,P[2]=J,P}},80278:function(je,$,P){je.exports=P(27953)},27953:function(je){je.exports=$;function $(P,Z){var H=Z[0]-P[0],J=Z[1]-P[1];return Math.sqrt(H*H+J*J)}},49973:function(je,$,P){je.exports=P(6773)},6773:function(je){je.exports=$;function $(P,Z,H){return P[0]=Z[0]/H[0],P[1]=Z[1]/H[1],P}},56601:function(je){je.exports=$;function $(P,Z){return P[0]*Z[0]+P[1]*Z[1]}},89936:function(je){je.exports=1e-6},51232:function(je,$,P){je.exports=H;var Z=P(89936);function H(J,U){var pe=J[0],ke=J[1],Ce=U[0],ge=U[1];return Math.abs(pe-Ce)<=Z*Math.max(1,Math.abs(pe),Math.abs(Ce))&&Math.abs(ke-ge)<=Z*Math.max(1,Math.abs(ke),Math.abs(ge))}},39546:function(je){je.exports=$;function $(P,Z){return P[0]===Z[0]&&P[1]===Z[1]}},67744:function(je){je.exports=$;function $(P,Z){return P[0]=Math.floor(Z[0]),P[1]=Math.floor(Z[1]),P}},49002:function(je,$,P){je.exports=H;var Z=P(61589)();function H(J,U,pe,ke,Ce,ge){var Me,Se;for(U||(U=2),pe||(pe=0),ke?Se=Math.min(ke*U+pe,J.length):Se=J.length,Me=pe;Me<Se;Me+=U)Z[0]=J[Me],Z[1]=J[Me+1],Ce(Z,Z,ge),J[Me]=Z[0],J[Me+1]=Z[1];return J}},69878:function(je){je.exports=$;function $(P,Z){var H=new Float32Array(2);return H[0]=P,H[1]=Z,H}},32644:function(je,$,P){je.exports={EPSILON:P(89936),create:P(61589),clone:P(76057),fromValues:P(69878),copy:P(3492),set:P(68854),equals:P(51232),exactEquals:P(39546),add:P(89550),subtract:P(43650),sub:P(45222),multiply:P(79920),mul:P(23113),divide:P(6773),div:P(49973),inverse:P(83793),min:P(20676),max:P(97899),rotate:P(48677),floor:P(67744),ceil:P(62189),round:P(57074),scale:P(47838),scaleAndAdd:P(21066),distance:P(27953),dist:P(80278),squaredDistance:P(14290),sqrDist:P(79569),length:P(37781),len:P(8123),squaredLength:P(26791),sqrLen:P(1791),negate:P(90549),normalize:P(36820),dot:P(56601),cross:P(56439),lerp:P(20577),random:P(85773),transformMat2:P(904),transformMat2d:P(60736),transformMat3:P(60221),transformMat4:P(37674),forEach:P(49002),limit:P(82418)}},83793:function(je){je.exports=$;function $(P,Z){return P[0]=1/Z[0],P[1]=1/Z[1],P}},8123:function(je,$,P){je.exports=P(37781)},37781:function(je){je.exports=$;function $(P){var Z=P[0],H=P[1];return Math.sqrt(Z*Z+H*H)}},20577:function(je){je.exports=$;function $(P,Z,H,J){var U=Z[0],pe=Z[1];return P[0]=U+J*(H[0]-U),P[1]=pe+J*(H[1]-pe),P}},82418:function(je){je.exports=$;function $(P,Z,H){var J=Z[0]*Z[0]+Z[1]*Z[1];if(J>H*H){var U=Math.sqrt(J);P[0]=Z[0]/U*H,P[1]=Z[1]/U*H}else P[0]=Z[0],P[1]=Z[1];return P}},97899:function(je){je.exports=$;function $(P,Z,H){return P[0]=Math.max(Z[0],H[0]),P[1]=Math.max(Z[1],H[1]),P}},20676:function(je){je.exports=$;function $(P,Z,H){return P[0]=Math.min(Z[0],H[0]),P[1]=Math.min(Z[1],H[1]),P}},23113:function(je,$,P){je.exports=P(79920)},79920:function(je){je.exports=$;function $(P,Z,H){return P[0]=Z[0]*H[0],P[1]=Z[1]*H[1],P}},90549:function(je){je.exports=$;function $(P,Z){return P[0]=-Z[0],P[1]=-Z[1],P}},36820:function(je){je.exports=$;function $(P,Z){var H=Z[0],J=Z[1],U=H*H+J*J;return U>0&&(U=1/Math.sqrt(U),P[0]=Z[0]*U,P[1]=Z[1]*U),P}},85773:function(je){je.exports=$;function $(P,Z){Z=Z||1;var H=Math.random()*2*Math.PI;return P[0]=Math.cos(H)*Z,P[1]=Math.sin(H)*Z,P}},48677:function(je){je.exports=$;function $(P,Z,H){var J=Math.cos(H),U=Math.sin(H),pe=Z[0],ke=Z[1];return P[0]=pe*J-ke*U,P[1]=pe*U+ke*J,P}},57074:function(je){je.exports=$;function $(P,Z){return P[0]=Math.round(Z[0]),P[1]=Math.round(Z[1]),P}},47838:function(je){je.exports=$;function $(P,Z,H){return P[0]=Z[0]*H,P[1]=Z[1]*H,P}},21066:function(je){je.exports=$;function $(P,Z,H,J){return P[0]=Z[0]+H[0]*J,P[1]=Z[1]+H[1]*J,P}},68854:function(je){je.exports=$;function $(P,Z,H){return P[0]=Z,P[1]=H,P}},79569:function(je,$,P){je.exports=P(14290)},1791:function(je,$,P){je.exports=P(26791)},14290:function(je){je.exports=$;function $(P,Z){var H=Z[0]-P[0],J=Z[1]-P[1];return H*H+J*J}},26791:function(je){je.exports=$;function $(P){var Z=P[0],H=P[1];return Z*Z+H*H}},45222:function(je,$,P){je.exports=P(43650)},43650:function(je){je.exports=$;function $(P,Z,H){return P[0]=Z[0]-H[0],P[1]=Z[1]-H[1],P}},904:function(je){je.exports=$;function $(P,Z,H){var J=Z[0],U=Z[1];return P[0]=H[0]*J+H[2]*U,P[1]=H[1]*J+H[3]*U,P}},60736:function(je){je.exports=$;function $(P,Z,H){var J=Z[0],U=Z[1];return P[0]=H[0]*J+H[2]*U+H[4],P[1]=H[1]*J+H[3]*U+H[5],P}},60221:function(je){je.exports=$;function $(P,Z,H){var J=Z[0],U=Z[1];return P[0]=H[0]*J+H[3]*U+H[6],P[1]=H[1]*J+H[4]*U+H[7],P}},37674:function(je){je.exports=$;function $(P,Z,H){var J=Z[0],U=Z[1];return P[0]=H[0]*J+H[4]*U+H[12],P[1]=H[1]*J+H[5]*U+H[13],P}},50450:function(je,$,P){var Z,H,J;(function(U){H=[P(19755)],Z=U,J=typeof Z=="function"?Z.apply($,H):Z,J!==void 0&&(je.exports=J)})(function(U){var pe=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],ke="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],Ce=Array.prototype.slice,ge,Me;if(U.event.fixHooks)for(var Se=pe.length;Se;)U.event.fixHooks[pe[--Se]]=U.event.mouseHooks;var ee=U.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var le=ke.length;le;)this.addEventListener(ke[--le],oe,!1);else this.onmousewheel=oe;U.data(this,"mousewheel-line-height",ee.getLineHeight(this)),U.data(this,"mousewheel-page-height",ee.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var le=ke.length;le;)this.removeEventListener(ke[--le],oe,!1);else this.onmousewheel=null;U.removeData(this,"mousewheel-line-height"),U.removeData(this,"mousewheel-page-height")},getLineHeight:function(le){var Q=U(le),ne=Q["offsetParent"in U.fn?"offsetParent":"parent"]();return ne.length||(ne=U("body")),parseInt(ne.css("fontSize"),10)||parseInt(Q.css("fontSize"),10)||16},getPageHeight:function(le){return U(le).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};U.fn.extend({mousewheel:function(le){return le?this.bind("mousewheel",le):this.trigger("mousewheel")},unmousewheel:function(le){return this.unbind("mousewheel",le)}});function oe(le){var Q=le||window.event,ne=Ce.call(arguments,1),he=0,Ue=0,ce=0,De=0,_t=0,N=0;if(le=U.event.fix(Q),le.type="mousewheel","detail"in Q&&(ce=Q.detail*-1),"wheelDelta"in Q&&(ce=Q.wheelDelta),"wheelDeltaY"in Q&&(ce=Q.wheelDeltaY),"wheelDeltaX"in Q&&(Ue=Q.wheelDeltaX*-1),"axis"in Q&&Q.axis===Q.HORIZONTAL_AXIS&&(Ue=ce*-1,ce=0),he=ce===0?Ue:ce,"deltaY"in Q&&(ce=Q.deltaY*-1,he=ce),"deltaX"in Q&&(Ue=Q.deltaX,ce===0&&(he=Ue*-1)),!(ce===0&&Ue===0)){if(Q.deltaMode===1){var ze=U.data(this,"mousewheel-line-height");he*=ze,ce*=ze,Ue*=ze}else if(Q.deltaMode===2){var Ze=U.data(this,"mousewheel-page-height");he*=Ze,ce*=Ze,Ue*=Ze}if(De=Math.max(Math.abs(ce),Math.abs(Ue)),(!Me||De<Me)&&(Me=De,X(Q,De)&&(Me/=40)),X(Q,De)&&(he/=40,Ue/=40,ce/=40),he=Math[he>=1?"floor":"ceil"](he/Me),Ue=Math[Ue>=1?"floor":"ceil"](Ue/Me),ce=Math[ce>=1?"floor":"ceil"](ce/Me),ee.settings.normalizeOffset&&this.getBoundingClientRect){var xt=this.getBoundingClientRect();_t=le.clientX-xt.left,N=le.clientY-xt.top}return le.deltaX=Ue,le.deltaY=ce,le.deltaFactor=Me,le.offsetX=_t,le.offsetY=N,le.deltaMode=0,ne.unshift(le,he,Ue,ce),ge&&clearTimeout(ge),ge=setTimeout(Ae,200),(U.event.dispatch||U.event.handle).apply(this,ne)}}function Ae(){Me=null}function X(le,Q){return ee.settings.adjustOldDeltas&&le.type==="mousewheel"&&Q%120===0}})},19755:function(je,$){var P,Z;(function(H,J){"use strict";typeof je.exports=="object"?je.exports=H.document?J(H,!0):function(U){if(!U.document)throw new Error("jQuery requires a window with a document");return J(U)}:J(H)})(typeof window<"u"?window:this,function(H,J){"use strict";var U=[],pe=Object.getPrototypeOf,ke=U.slice,Ce=U.flat?function(C){return U.flat.call(C)}:function(C){return U.concat.apply([],C)},ge=U.push,Me=U.indexOf,Se={},ee=Se.toString,oe=Se.hasOwnProperty,Ae=oe.toString,X=Ae.call(Object),le={},Q=function(M){return typeof M=="function"&&typeof M.nodeType!="number"&&typeof M.item!="function"},ne=function(M){return M!=null&&M===M.window},he=H.document,Ue={type:!0,src:!0,nonce:!0,noModule:!0};function ce(C,M,k){k=k||he;var L,W,Y=k.createElement("script");if(Y.text=C,M)for(L in Ue)W=M[L]||M.getAttribute&&M.getAttribute(L),W&&Y.setAttribute(L,W);k.head.appendChild(Y).parentNode.removeChild(Y)}function De(C){return C==null?C+"":typeof C=="object"||typeof C=="function"?Se[ee.call(C)]||"object":typeof C}var _t="3.6.1",N=function(C,M){return new N.fn.init(C,M)};N.fn=N.prototype={jquery:_t,constructor:N,length:0,toArray:function(){return ke.call(this)},get:function(C){return C==null?ke.call(this):C<0?this[C+this.length]:this[C]},pushStack:function(C){var M=N.merge(this.constructor(),C);return M.prevObject=this,M},each:function(C){return N.each(this,C)},map:function(C){return this.pushStack(N.map(this,function(M,k){return C.call(M,k,M)}))},slice:function(){return this.pushStack(ke.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(N.grep(this,function(C,M){return(M+1)%2}))},odd:function(){return this.pushStack(N.grep(this,function(C,M){return M%2}))},eq:function(C){var M=this.length,k=+C+(C<0?M:0);return this.pushStack(k>=0&&k<M?[this[k]]:[])},end:function(){return this.prevObject||this.constructor()},push:ge,sort:U.sort,splice:U.splice},N.extend=N.fn.extend=function(){var C,M,k,L,W,Y,re=arguments[0]||{},Ge=1,Fe=arguments.length,it=!1;for(typeof re=="boolean"&&(it=re,re=arguments[Ge]||{},Ge++),typeof re!="object"&&!Q(re)&&(re={}),Ge===Fe&&(re=this,Ge--);Ge<Fe;Ge++)if((C=arguments[Ge])!=null)for(M in C)L=C[M],!(M==="__proto__"||re===L)&&(it&&L&&(N.isPlainObject(L)||(W=Array.isArray(L)))?(k=re[M],W&&!Array.isArray(k)?Y=[]:!W&&!N.isPlainObject(k)?Y={}:Y=k,W=!1,re[M]=N.extend(it,Y,L)):L!==void 0&&(re[M]=L));return re},N.extend({expando:"jQuery"+(_t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(C){throw new Error(C)},noop:function(){},isPlainObject:function(C){var M,k;return!C||ee.call(C)!=="[object Object]"?!1:(M=pe(C),M?(k=oe.call(M,"constructor")&&M.constructor,typeof k=="function"&&Ae.call(k)===X):!0)},isEmptyObject:function(C){var M;for(M in C)return!1;return!0},globalEval:function(C,M,k){ce(C,{nonce:M&&M.nonce},k)},each:function(C,M){var k,L=0;if(ze(C))for(k=C.length;L<k&&M.call(C[L],L,C[L])!==!1;L++);else for(L in C)if(M.call(C[L],L,C[L])===!1)break;return C},makeArray:function(C,M){var k=M||[];return C!=null&&(ze(Object(C))?N.merge(k,typeof C=="string"?[C]:C):ge.call(k,C)),k},inArray:function(C,M,k){return M==null?-1:Me.call(M,C,k)},merge:function(C,M){for(var k=+M.length,L=0,W=C.length;L<k;L++)C[W++]=M[L];return C.length=W,C},grep:function(C,M,k){for(var L,W=[],Y=0,re=C.length,Ge=!k;Y<re;Y++)L=!M(C[Y],Y),L!==Ge&&W.push(C[Y]);return W},map:function(C,M,k){var L,W,Y=0,re=[];if(ze(C))for(L=C.length;Y<L;Y++)W=M(C[Y],Y,k),W!=null&&re.push(W);else for(Y in C)W=M(C[Y],Y,k),W!=null&&re.push(W);return Ce(re)},guid:1,support:le}),typeof Symbol=="function"&&(N.fn[Symbol.iterator]=U[Symbol.iterator]),N.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(C,M){Se["[object "+M+"]"]=M.toLowerCase()});function ze(C){var M=!!C&&"length"in C&&C.length,k=De(C);return Q(C)||ne(C)?!1:k==="array"||M===0||typeof M=="number"&&M>0&&M-1 in C}var Ze=function(C){var M,k,L,W,Y,re,Ge,Fe,it,At,Qt,Ct,It,ir,Ir,er,Eo,So,Fs,br="sizzle"+1*new Date,Nr=C.document,Ts=0,Gr=0,Vi=Ro(),tl=Ro(),La=Ro(),vs=Ro(),xa=function(te,Re){return te===Re&&(Qt=!0),0},ha={}.hasOwnProperty,ts=[],Li=ts.pop,ro=ts.push,$o=ts.push,Up=ts.slice,us=function(te,Re){for(var Ke=0,Lt=te.length;Ke<Lt;Ke++)if(te[Ke]===Re)return Ke;return-1},Ca="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ei="[\\x20\\t\\r\\n\\f]",ta="(?:\\\\[\\da-fA-F]{1,6}"+ei+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",pc="\\["+ei+"*("+ta+")(?:"+ei+"*([*^$|!~]?=)"+ei+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+ta+"))|)"+ei+"*\\]",gc=":("+ta+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+pc+")*)|.*)\\)|)",Ll=new RegExp(ei+"+","g"),Gs=new RegExp("^"+ei+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ei+"+$","g"),go=new RegExp("^"+ei+"*,"+ei+"*"),mc=new RegExp("^"+ei+"*([>+~]|"+ei+")"+ei+"*"),eu=new RegExp(ei+"|>"),eh=new RegExp(gc),ed=new RegExp("^"+ta+"$"),Ms={ID:new RegExp("^#("+ta+")"),CLASS:new RegExp("^\\.("+ta+")"),TAG:new RegExp("^("+ta+"|[*])"),ATTR:new RegExp("^"+pc),PSEUDO:new RegExp("^"+gc),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ei+"*(even|odd|(([+-]|)(\\d*)n|)"+ei+"*(?:([+-]|)"+ei+"*(\\d+)|))"+ei+"*\\)|)","i"),bool:new RegExp("^(?:"+Ca+")$","i"),needsContext:new RegExp("^"+ei+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ei+"*((?:-\\d)?\\d*)"+ei+"*\\)|)(?=[^-]|$)","i")},td=/HTML$/i,vc=/^(?:input|select|textarea|button)$/i,nd=/^h\d$/i,Fa=/^[^{]+\{\s*\[native \w/,rd=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tu=/[+~]/,Ps=new RegExp("\\\\[\\da-fA-F]{1,6}"+ei+"?|\\\\([^\\r\\n\\f])","g"),Bs=function(te,Re){var Ke="0x"+te.slice(1)-65536;return Re||(Ke<0?String.fromCharCode(Ke+65536):String.fromCharCode(Ke>>10|55296,Ke&1023|56320))},Fl=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Gl=function(te,Re){return Re?te==="\0"?"\uFFFD":te.slice(0,-1)+"\\"+te.charCodeAt(te.length-1).toString(16)+" ":"\\"+te},nu=function(){Ct()},th=rl(function(te){return te.disabled===!0&&te.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{$o.apply(ts=Up.call(Nr.childNodes),Nr.childNodes),ts[Nr.childNodes.length].nodeType}catch{$o={apply:ts.length?function(Re,Ke){ro.apply(Re,Up.call(Ke))}:function(Re,Ke){for(var Lt=Re.length,qe=0;Re[Lt++]=Ke[qe++];);Re.length=Lt-1}}}function Oi(te,Re,Ke,Lt){var qe,Gt,rn,xn,Sn,dr,jn,mr=Re&&Re.ownerDocument,ti=Re?Re.nodeType:9;if(Ke=Ke||[],typeof te!="string"||!te||ti!==1&&ti!==9&&ti!==11)return Ke;if(!Lt&&(Ct(Re),Re=Re||It,Ir)){if(ti!==11&&(Sn=rd.exec(te)))if(qe=Sn[1]){if(ti===9)if(rn=Re.getElementById(qe)){if(rn.id===qe)return Ke.push(rn),Ke}else return Ke;else if(mr&&(rn=mr.getElementById(qe))&&Fs(Re,rn)&&rn.id===qe)return Ke.push(rn),Ke}else{if(Sn[2])return $o.apply(Ke,Re.getElementsByTagName(te)),Ke;if((qe=Sn[3])&&k.getElementsByClassName&&Re.getElementsByClassName)return $o.apply(Ke,Re.getElementsByClassName(qe)),Ke}if(k.qsa&&!vs[te+" "]&&(!er||!er.test(te))&&(ti!==1||Re.nodeName.toLowerCase()!=="object")){if(jn=te,mr=Re,ti===1&&(eu.test(te)||mc.test(te))){for(mr=tu.test(te)&&od(Re.parentNode)||Re,(mr!==Re||!k.scope)&&((xn=Re.getAttribute("id"))?xn=xn.replace(Fl,Gl):Re.setAttribute("id",xn=br)),dr=re(te),Gt=dr.length;Gt--;)dr[Gt]=(xn?"#"+xn:":scope")+" "+Ga(dr[Gt]);jn=dr.join(",")}try{return $o.apply(Ke,mr.querySelectorAll(jn)),Ke}catch{vs(te,!0)}finally{xn===br&&Re.removeAttribute("id")}}}return Fe(te.replace(Gs,"$1"),Re,Ke,Lt)}function Ro(){var te=[];function Re(Ke,Lt){return te.push(Ke+" ")>L.cacheLength&&delete Re[te.shift()],Re[Ke+" "]=Lt}return Re}function zs(te){return te[br]=!0,te}function ys(te){var Re=It.createElement("fieldset");try{return!!te(Re)}catch{return!1}finally{Re.parentNode&&Re.parentNode.removeChild(Re),Re=null}}function nh(te,Re){for(var Ke=te.split("|"),Lt=Ke.length;Lt--;)L.attrHandle[Ke[Lt]]=Re}function ru(te,Re){var Ke=Re&&te,Lt=Ke&&te.nodeType===1&&Re.nodeType===1&&te.sourceIndex-Re.sourceIndex;if(Lt)return Lt;if(Ke){for(;Ke=Ke.nextSibling;)if(Ke===Re)return-1}return te?1:-1}function Vp(te){return function(Re){var Ke=Re.nodeName.toLowerCase();return Ke==="input"&&Re.type===te}}function nl(te){return function(Re){var Ke=Re.nodeName.toLowerCase();return(Ke==="input"||Ke==="button")&&Re.type===te}}function id(te){return function(Re){return"form"in Re?Re.parentNode&&Re.disabled===!1?"label"in Re?"label"in Re.parentNode?Re.parentNode.disabled===te:Re.disabled===te:Re.isDisabled===te||Re.isDisabled!==!te&&th(Re)===te:Re.disabled===te:"label"in Re?Re.disabled===te:!1}}function Bl(te){return zs(function(Re){return Re=+Re,zs(function(Ke,Lt){for(var qe,Gt=te([],Ke.length,Re),rn=Gt.length;rn--;)Ke[qe=Gt[rn]]&&(Ke[qe]=!(Lt[qe]=Ke[qe]))})})}function od(te){return te&&typeof te.getElementsByTagName<"u"&&te}k=Oi.support={},Y=Oi.isXML=function(te){var Re=te&&te.namespaceURI,Ke=te&&(te.ownerDocument||te).documentElement;return!td.test(Re||Ke&&Ke.nodeName||"HTML")},Ct=Oi.setDocument=function(te){var Re,Ke,Lt=te?te.ownerDocument||te:Nr;return Lt==It||Lt.nodeType!==9||!Lt.documentElement||(It=Lt,ir=It.documentElement,Ir=!Y(It),Nr!=It&&(Ke=It.defaultView)&&Ke.top!==Ke&&(Ke.addEventListener?Ke.addEventListener("unload",nu,!1):Ke.attachEvent&&Ke.attachEvent("onunload",nu)),k.scope=ys(function(qe){return ir.appendChild(qe).appendChild(It.createElement("div")),typeof qe.querySelectorAll<"u"&&!qe.querySelectorAll(":scope fieldset div").length}),k.attributes=ys(function(qe){return qe.className="i",!qe.getAttribute("className")}),k.getElementsByTagName=ys(function(qe){return qe.appendChild(It.createComment("")),!qe.getElementsByTagName("*").length}),k.getElementsByClassName=Fa.test(It.getElementsByClassName),k.getById=ys(function(qe){return ir.appendChild(qe).id=br,!It.getElementsByName||!It.getElementsByName(br).length}),k.getById?(L.filter.ID=function(qe){var Gt=qe.replace(Ps,Bs);return function(rn){return rn.getAttribute("id")===Gt}},L.find.ID=function(qe,Gt){if(typeof Gt.getElementById<"u"&&Ir){var rn=Gt.getElementById(qe);return rn?[rn]:[]}}):(L.filter.ID=function(qe){var Gt=qe.replace(Ps,Bs);return function(rn){var xn=typeof rn.getAttributeNode<"u"&&rn.getAttributeNode("id");return xn&&xn.value===Gt}},L.find.ID=function(qe,Gt){if(typeof Gt.getElementById<"u"&&Ir){var rn,xn,Sn,dr=Gt.getElementById(qe);if(dr){if(rn=dr.getAttributeNode("id"),rn&&rn.value===qe)return[dr];for(Sn=Gt.getElementsByName(qe),xn=0;dr=Sn[xn++];)if(rn=dr.getAttributeNode("id"),rn&&rn.value===qe)return[dr]}return[]}}),L.find.TAG=k.getElementsByTagName?function(qe,Gt){if(typeof Gt.getElementsByTagName<"u")return Gt.getElementsByTagName(qe);if(k.qsa)return Gt.querySelectorAll(qe)}:function(qe,Gt){var rn,xn=[],Sn=0,dr=Gt.getElementsByTagName(qe);if(qe==="*"){for(;rn=dr[Sn++];)rn.nodeType===1&&xn.push(rn);return xn}return dr},L.find.CLASS=k.getElementsByClassName&&function(qe,Gt){if(typeof Gt.getElementsByClassName<"u"&&Ir)return Gt.getElementsByClassName(qe)},Eo=[],er=[],(k.qsa=Fa.test(It.querySelectorAll))&&(ys(function(qe){var Gt;ir.appendChild(qe).innerHTML="<a id='"+br+"'></a><select id='"+br+"-\r\\' msallowcapture=''><option selected=''></option></select>",qe.querySelectorAll("[msallowcapture^='']").length&&er.push("[*^$]="+ei+`*(?:''|"")`),qe.querySelectorAll("[selected]").length||er.push("\\["+ei+"*(?:value|"+Ca+")"),qe.querySelectorAll("[id~="+br+"-]").length||er.push("~="),Gt=It.createElement("input"),Gt.setAttribute("name",""),qe.appendChild(Gt),qe.querySelectorAll("[name='']").length||er.push("\\["+ei+"*name"+ei+"*="+ei+`*(?:''|"")`),qe.querySelectorAll(":checked").length||er.push(":checked"),qe.querySelectorAll("a#"+br+"+*").length||er.push(".#.+[+~]"),qe.querySelectorAll("\\\f"),er.push("[\\r\\n\\f]")}),ys(function(qe){qe.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var Gt=It.createElement("input");Gt.setAttribute("type","hidden"),qe.appendChild(Gt).setAttribute("name","D"),qe.querySelectorAll("[name=d]").length&&er.push("name"+ei+"*[*^$|!~]?="),qe.querySelectorAll(":enabled").length!==2&&er.push(":enabled",":disabled"),ir.appendChild(qe).disabled=!0,qe.querySelectorAll(":disabled").length!==2&&er.push(":enabled",":disabled"),qe.querySelectorAll("*,:x"),er.push(",.*:")})),(k.matchesSelector=Fa.test(So=ir.matches||ir.webkitMatchesSelector||ir.mozMatchesSelector||ir.oMatchesSelector||ir.msMatchesSelector))&&ys(function(qe){k.disconnectedMatch=So.call(qe,"*"),So.call(qe,"[s!='']:x"),Eo.push("!=",gc)}),er=er.length&&new RegExp(er.join("|")),Eo=Eo.length&&new RegExp(Eo.join("|")),Re=Fa.test(ir.compareDocumentPosition),Fs=Re||Fa.test(ir.contains)?function(qe,Gt){var rn=qe.nodeType===9?qe.documentElement:qe,xn=Gt&&Gt.parentNode;return qe===xn||!!(xn&&xn.nodeType===1&&(rn.contains?rn.contains(xn):qe.compareDocumentPosition&&qe.compareDocumentPosition(xn)&16))}:function(qe,Gt){if(Gt){for(;Gt=Gt.parentNode;)if(Gt===qe)return!0}return!1},xa=Re?function(qe,Gt){if(qe===Gt)return Qt=!0,0;var rn=!qe.compareDocumentPosition-!Gt.compareDocumentPosition;return rn||(rn=(qe.ownerDocument||qe)==(Gt.ownerDocument||Gt)?qe.compareDocumentPosition(Gt):1,rn&1||!k.sortDetached&&Gt.compareDocumentPosition(qe)===rn?qe==It||qe.ownerDocument==Nr&&Fs(Nr,qe)?-1:Gt==It||Gt.ownerDocument==Nr&&Fs(Nr,Gt)?1:At?us(At,qe)-us(At,Gt):0:rn&4?-1:1)}:function(qe,Gt){if(qe===Gt)return Qt=!0,0;var rn,xn=0,Sn=qe.parentNode,dr=Gt.parentNode,jn=[qe],mr=[Gt];if(!Sn||!dr)return qe==It?-1:Gt==It?1:Sn?-1:dr?1:At?us(At,qe)-us(At,Gt):0;if(Sn===dr)return ru(qe,Gt);for(rn=qe;rn=rn.parentNode;)jn.unshift(rn);for(rn=Gt;rn=rn.parentNode;)mr.unshift(rn);for(;jn[xn]===mr[xn];)xn++;return xn?ru(jn[xn],mr[xn]):jn[xn]==Nr?-1:mr[xn]==Nr?1:0}),It},Oi.matches=function(te,Re){return Oi(te,null,null,Re)},Oi.matchesSelector=function(te,Re){if(Ct(te),k.matchesSelector&&Ir&&!vs[Re+" "]&&(!Eo||!Eo.test(Re))&&(!er||!er.test(Re)))try{var Ke=So.call(te,Re);if(Ke||k.disconnectedMatch||te.document&&te.document.nodeType!==11)return Ke}catch{vs(Re,!0)}return Oi(Re,It,null,[te]).length>0},Oi.contains=function(te,Re){return(te.ownerDocument||te)!=It&&Ct(te),Fs(te,Re)},Oi.attr=function(te,Re){(te.ownerDocument||te)!=It&&Ct(te);var Ke=L.attrHandle[Re.toLowerCase()],Lt=Ke&&ha.call(L.attrHandle,Re.toLowerCase())?Ke(te,Re,!Ir):void 0;return Lt!==void 0?Lt:k.attributes||!Ir?te.getAttribute(Re):(Lt=te.getAttributeNode(Re))&&Lt.specified?Lt.value:null},Oi.escape=function(te){return(te+"").replace(Fl,Gl)},Oi.error=function(te){throw new Error("Syntax error, unrecognized expression: "+te)},Oi.uniqueSort=function(te){var Re,Ke=[],Lt=0,qe=0;if(Qt=!k.detectDuplicates,At=!k.sortStable&&te.slice(0),te.sort(xa),Qt){for(;Re=te[qe++];)Re===te[qe]&&(Lt=Ke.push(qe));for(;Lt--;)te.splice(Ke[Lt],1)}return At=null,te},W=Oi.getText=function(te){var Re,Ke="",Lt=0,qe=te.nodeType;if(qe){if(qe===1||qe===9||qe===11){if(typeof te.textContent=="string")return te.textContent;for(te=te.firstChild;te;te=te.nextSibling)Ke+=W(te)}else if(qe===3||qe===4)return te.nodeValue}else for(;Re=te[Lt++];)Ke+=W(Re);return Ke},L=Oi.selectors={cacheLength:50,createPseudo:zs,match:Ms,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(te){return te[1]=te[1].replace(Ps,Bs),te[3]=(te[3]||te[4]||te[5]||"").replace(Ps,Bs),te[2]==="~="&&(te[3]=" "+te[3]+" "),te.slice(0,4)},CHILD:function(te){return te[1]=te[1].toLowerCase(),te[1].slice(0,3)==="nth"?(te[3]||Oi.error(te[0]),te[4]=+(te[4]?te[5]+(te[6]||1):2*(te[3]==="even"||te[3]==="odd")),te[5]=+(te[7]+te[8]||te[3]==="odd")):te[3]&&Oi.error(te[0]),te},PSEUDO:function(te){var Re,Ke=!te[6]&&te[2];return Ms.CHILD.test(te[0])?null:(te[3]?te[2]=te[4]||te[5]||"":Ke&&eh.test(Ke)&&(Re=re(Ke,!0))&&(Re=Ke.indexOf(")",Ke.length-Re)-Ke.length)&&(te[0]=te[0].slice(0,Re),te[2]=Ke.slice(0,Re)),te.slice(0,3))}},filter:{TAG:function(te){var Re=te.replace(Ps,Bs).toLowerCase();return te==="*"?function(){return!0}:function(Ke){return Ke.nodeName&&Ke.nodeName.toLowerCase()===Re}},CLASS:function(te){var Re=Vi[te+" "];return Re||(Re=new RegExp("(^|"+ei+")"+te+"("+ei+"|$)"))&&Vi(te,function(Ke){return Re.test(typeof Ke.className=="string"&&Ke.className||typeof Ke.getAttribute<"u"&&Ke.getAttribute("class")||"")})},ATTR:function(te,Re,Ke){return function(Lt){var qe=Oi.attr(Lt,te);return qe==null?Re==="!=":Re?(qe+="",Re==="="?qe===Ke:Re==="!="?qe!==Ke:Re==="^="?Ke&&qe.indexOf(Ke)===0:Re==="*="?Ke&&qe.indexOf(Ke)>-1:Re==="$="?Ke&&qe.slice(-Ke.length)===Ke:Re==="~="?(" "+qe.replace(Ll," ")+" ").indexOf(Ke)>-1:Re==="|="?qe===Ke||qe.slice(0,Ke.length+1)===Ke+"-":!1):!0}},CHILD:function(te,Re,Ke,Lt,qe){var Gt=te.slice(0,3)!=="nth",rn=te.slice(-4)!=="last",xn=Re==="of-type";return Lt===1&&qe===0?function(Sn){return!!Sn.parentNode}:function(Sn,dr,jn){var mr,ti,gi,Un,Io,ns,Lo=Gt!==rn?"nextSibling":"previousSibling",Hi=Sn.parentNode,ds=xn&&Sn.nodeName.toLowerCase(),fa=!jn&&!xn,Ao=!1;if(Hi){if(Gt){for(;Lo;){for(Un=Sn;Un=Un[Lo];)if(xn?Un.nodeName.toLowerCase()===ds:Un.nodeType===1)return!1;ns=Lo=te==="only"&&!ns&&"nextSibling"}return!0}if(ns=[rn?Hi.firstChild:Hi.lastChild],rn&&fa){for(Un=Hi,gi=Un[br]||(Un[br]={}),ti=gi[Un.uniqueID]||(gi[Un.uniqueID]={}),mr=ti[te]||[],Io=mr[0]===Ts&&mr[1],Ao=Io&&mr[2],Un=Io&&Hi.childNodes[Io];Un=++Io&&Un&&Un[Lo]||(Ao=Io=0)||ns.pop();)if(Un.nodeType===1&&++Ao&&Un===Sn){ti[te]=[Ts,Io,Ao];break}}else if(fa&&(Un=Sn,gi=Un[br]||(Un[br]={}),ti=gi[Un.uniqueID]||(gi[Un.uniqueID]={}),mr=ti[te]||[],Io=mr[0]===Ts&&mr[1],Ao=Io),Ao===!1)for(;(Un=++Io&&Un&&Un[Lo]||(Ao=Io=0)||ns.pop())&&!((xn?Un.nodeName.toLowerCase()===ds:Un.nodeType===1)&&++Ao&&(fa&&(gi=Un[br]||(Un[br]={}),ti=gi[Un.uniqueID]||(gi[Un.uniqueID]={}),ti[te]=[Ts,Ao]),Un===Sn)););return Ao-=qe,Ao===Lt||Ao%Lt===0&&Ao/Lt>=0}}},PSEUDO:function(te,Re){var Ke,Lt=L.pseudos[te]||L.setFilters[te.toLowerCase()]||Oi.error("unsupported pseudo: "+te);return Lt[br]?Lt(Re):Lt.length>1?(Ke=[te,te,"",Re],L.setFilters.hasOwnProperty(te.toLowerCase())?zs(function(qe,Gt){for(var rn,xn=Lt(qe,Re),Sn=xn.length;Sn--;)rn=us(qe,xn[Sn]),qe[rn]=!(Gt[rn]=xn[Sn])}):function(qe){return Lt(qe,0,Ke)}):Lt}},pseudos:{not:zs(function(te){var Re=[],Ke=[],Lt=Ge(te.replace(Gs,"$1"));return Lt[br]?zs(function(qe,Gt,rn,xn){for(var Sn,dr=Lt(qe,null,xn,[]),jn=qe.length;jn--;)(Sn=dr[jn])&&(qe[jn]=!(Gt[jn]=Sn))}):function(qe,Gt,rn){return Re[0]=qe,Lt(Re,null,rn,Ke),Re[0]=null,!Ke.pop()}}),has:zs(function(te){return function(Re){return Oi(te,Re).length>0}}),contains:zs(function(te){return te=te.replace(Ps,Bs),function(Re){return(Re.textContent||W(Re)).indexOf(te)>-1}}),lang:zs(function(te){return ed.test(te||"")||Oi.error("unsupported lang: "+te),te=te.replace(Ps,Bs).toLowerCase(),function(Re){var Ke;do if(Ke=Ir?Re.lang:Re.getAttribute("xml:lang")||Re.getAttribute("lang"))return Ke=Ke.toLowerCase(),Ke===te||Ke.indexOf(te+"-")===0;while((Re=Re.parentNode)&&Re.nodeType===1);return!1}}),target:function(te){var Re=C.location&&C.location.hash;return Re&&Re.slice(1)===te.id},root:function(te){return te===ir},focus:function(te){return te===It.activeElement&&(!It.hasFocus||It.hasFocus())&&!!(te.type||te.href||~te.tabIndex)},enabled:id(!1),disabled:id(!0),checked:function(te){var Re=te.nodeName.toLowerCase();return Re==="input"&&!!te.checked||Re==="option"&&!!te.selected},selected:function(te){return te.parentNode&&te.parentNode.selectedIndex,te.selected===!0},empty:function(te){for(te=te.firstChild;te;te=te.nextSibling)if(te.nodeType<6)return!1;return!0},parent:function(te){return!L.pseudos.empty(te)},header:function(te){return nd.test(te.nodeName)},input:function(te){return vc.test(te.nodeName)},button:function(te){var Re=te.nodeName.toLowerCase();return Re==="input"&&te.type==="button"||Re==="button"},text:function(te){var Re;return te.nodeName.toLowerCase()==="input"&&te.type==="text"&&((Re=te.getAttribute("type"))==null||Re.toLowerCase()==="text")},first:Bl(function(){return[0]}),last:Bl(function(te,Re){return[Re-1]}),eq:Bl(function(te,Re,Ke){return[Ke<0?Ke+Re:Ke]}),even:Bl(function(te,Re){for(var Ke=0;Ke<Re;Ke+=2)te.push(Ke);return te}),odd:Bl(function(te,Re){for(var Ke=1;Ke<Re;Ke+=2)te.push(Ke);return te}),lt:Bl(function(te,Re,Ke){for(var Lt=Ke<0?Ke+Re:Ke>Re?Re:Ke;--Lt>=0;)te.push(Lt);return te}),gt:Bl(function(te,Re,Ke){for(var Lt=Ke<0?Ke+Re:Ke;++Lt<Re;)te.push(Lt);return te})}},L.pseudos.nth=L.pseudos.eq;for(M in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})L.pseudos[M]=Vp(M);for(M in{submit:!0,reset:!0})L.pseudos[M]=nl(M);function yc(){}yc.prototype=L.filters=L.pseudos,L.setFilters=new yc,re=Oi.tokenize=function(te,Re){var Ke,Lt,qe,Gt,rn,xn,Sn,dr=tl[te+" "];if(dr)return Re?0:dr.slice(0);for(rn=te,xn=[],Sn=L.preFilter;rn;){(!Ke||(Lt=go.exec(rn)))&&(Lt&&(rn=rn.slice(Lt[0].length)||rn),xn.push(qe=[])),Ke=!1,(Lt=mc.exec(rn))&&(Ke=Lt.shift(),qe.push({value:Ke,type:Lt[0].replace(Gs," ")}),rn=rn.slice(Ke.length));for(Gt in L.filter)(Lt=Ms[Gt].exec(rn))&&(!Sn[Gt]||(Lt=Sn[Gt](Lt)))&&(Ke=Lt.shift(),qe.push({value:Ke,type:Gt,matches:Lt}),rn=rn.slice(Ke.length));if(!Ke)break}return Re?rn.length:rn?Oi.error(te):tl(te,xn).slice(0)};function Ga(te){for(var Re=0,Ke=te.length,Lt="";Re<Ke;Re++)Lt+=te[Re].value;return Lt}function rl(te,Re,Ke){var Lt=Re.dir,qe=Re.next,Gt=qe||Lt,rn=Ke&&Gt==="parentNode",xn=Gr++;return Re.first?function(Sn,dr,jn){for(;Sn=Sn[Lt];)if(Sn.nodeType===1||rn)return te(Sn,dr,jn);return!1}:function(Sn,dr,jn){var mr,ti,gi,Un=[Ts,xn];if(jn){for(;Sn=Sn[Lt];)if((Sn.nodeType===1||rn)&&te(Sn,dr,jn))return!0}else for(;Sn=Sn[Lt];)if(Sn.nodeType===1||rn)if(gi=Sn[br]||(Sn[br]={}),ti=gi[Sn.uniqueID]||(gi[Sn.uniqueID]={}),qe&&qe===Sn.nodeName.toLowerCase())Sn=Sn[Lt]||Sn;else{if((mr=ti[Gt])&&mr[0]===Ts&&mr[1]===xn)return Un[2]=mr[2];if(ti[Gt]=Un,Un[2]=te(Sn,dr,jn))return!0}return!1}}function iu(te){return te.length>1?function(Re,Ke,Lt){for(var qe=te.length;qe--;)if(!te[qe](Re,Ke,Lt))return!1;return!0}:te[0]}function jp(te,Re,Ke){for(var Lt=0,qe=Re.length;Lt<qe;Lt++)Oi(te,Re[Lt],Ke);return Ke}function sd(te,Re,Ke,Lt,qe){for(var Gt,rn=[],xn=0,Sn=te.length,dr=Re!=null;xn<Sn;xn++)(Gt=te[xn])&&(!Ke||Ke(Gt,Lt,qe))&&(rn.push(Gt),dr&&Re.push(xn));return rn}function ad(te,Re,Ke,Lt,qe,Gt){return Lt&&!Lt[br]&&(Lt=ad(Lt)),qe&&!qe[br]&&(qe=ad(qe,Gt)),zs(function(rn,xn,Sn,dr){var jn,mr,ti,gi=[],Un=[],Io=xn.length,ns=rn||jp(Re||"*",Sn.nodeType?[Sn]:Sn,[]),Lo=te&&(rn||!Re)?sd(ns,gi,te,Sn,dr):ns,Hi=Ke?qe||(rn?te:Io||Lt)?[]:xn:Lo;if(Ke&&Ke(Lo,Hi,Sn,dr),Lt)for(jn=sd(Hi,Un),Lt(jn,[],Sn,dr),mr=jn.length;mr--;)(ti=jn[mr])&&(Hi[Un[mr]]=!(Lo[Un[mr]]=ti));if(rn){if(qe||te){if(qe){for(jn=[],mr=Hi.length;mr--;)(ti=Hi[mr])&&jn.push(Lo[mr]=ti);qe(null,Hi=[],jn,dr)}for(mr=Hi.length;mr--;)(ti=Hi[mr])&&(jn=qe?us(rn,ti):gi[mr])>-1&&(rn[jn]=!(xn[jn]=ti))}}else Hi=sd(Hi===xn?Hi.splice(Io,Hi.length):Hi),qe?qe(null,xn,Hi,dr):$o.apply(xn,Hi)})}function bc(te){for(var Re,Ke,Lt,qe=te.length,Gt=L.relative[te[0].type],rn=Gt||L.relative[" "],xn=Gt?1:0,Sn=rl(function(mr){return mr===Re},rn,!0),dr=rl(function(mr){return us(Re,mr)>-1},rn,!0),jn=[function(mr,ti,gi){var Un=!Gt&&(gi||ti!==it)||((Re=ti).nodeType?Sn(mr,ti,gi):dr(mr,ti,gi));return Re=null,Un}];xn<qe;xn++)if(Ke=L.relative[te[xn].type])jn=[rl(iu(jn),Ke)];else{if(Ke=L.filter[te[xn].type].apply(null,te[xn].matches),Ke[br]){for(Lt=++xn;Lt<qe&&!L.relative[te[Lt].type];Lt++);return ad(xn>1&&iu(jn),xn>1&&Ga(te.slice(0,xn-1).concat({value:te[xn-2].type===" "?"*":""})).replace(Gs,"$1"),Ke,xn<Lt&&bc(te.slice(xn,Lt)),Lt<qe&&bc(te=te.slice(Lt)),Lt<qe&&Ga(te))}jn.push(Ke)}return iu(jn)}function ou(te,Re){var Ke=Re.length>0,Lt=te.length>0,qe=function(Gt,rn,xn,Sn,dr){var jn,mr,ti,gi=0,Un="0",Io=Gt&&[],ns=[],Lo=it,Hi=Gt||Lt&&L.find.TAG("*",dr),ds=Ts+=Lo==null?1:Math.random()||.1,fa=Hi.length;for(dr&&(it=rn==It||rn||dr);Un!==fa&&(jn=Hi[Un])!=null;Un++){if(Lt&&jn){for(mr=0,!rn&&jn.ownerDocument!=It&&(Ct(jn),xn=!Ir);ti=te[mr++];)if(ti(jn,rn||It,xn)){Sn.push(jn);break}dr&&(Ts=ds)}Ke&&((jn=!ti&&jn)&&gi--,Gt&&Io.push(jn))}if(gi+=Un,Ke&&Un!==gi){for(mr=0;ti=Re[mr++];)ti(Io,ns,rn,xn);if(Gt){if(gi>0)for(;Un--;)Io[Un]||ns[Un]||(ns[Un]=Li.call(Sn));ns=sd(ns)}$o.apply(Sn,ns),dr&&!Gt&&ns.length>0&&gi+Re.length>1&&Oi.uniqueSort(Sn)}return dr&&(Ts=ds,it=Lo),Io};return Ke?zs(qe):qe}return Ge=Oi.compile=function(te,Re){var Ke,Lt=[],qe=[],Gt=La[te+" "];if(!Gt){for(Re||(Re=re(te)),Ke=Re.length;Ke--;)Gt=bc(Re[Ke]),Gt[br]?Lt.push(Gt):qe.push(Gt);Gt=La(te,ou(qe,Lt)),Gt.selector=te}return Gt},Fe=Oi.select=function(te,Re,Ke,Lt){var qe,Gt,rn,xn,Sn,dr=typeof te=="function"&&te,jn=!Lt&&re(te=dr.selector||te);if(Ke=Ke||[],jn.length===1){if(Gt=jn[0]=jn[0].slice(0),Gt.length>2&&(rn=Gt[0]).type==="ID"&&Re.nodeType===9&&Ir&&L.relative[Gt[1].type]){if(Re=(L.find.ID(rn.matches[0].replace(Ps,Bs),Re)||[])[0],Re)dr&&(Re=Re.parentNode);else return Ke;te=te.slice(Gt.shift().value.length)}for(qe=Ms.needsContext.test(te)?0:Gt.length;qe--&&(rn=Gt[qe],!L.relative[xn=rn.type]);)if((Sn=L.find[xn])&&(Lt=Sn(rn.matches[0].replace(Ps,Bs),tu.test(Gt[0].type)&&od(Re.parentNode)||Re))){if(Gt.splice(qe,1),te=Lt.length&&Ga(Gt),!te)return $o.apply(Ke,Lt),Ke;break}}return(dr||Ge(te,jn))(Lt,Re,!Ir,Ke,!Re||tu.test(te)&&od(Re.parentNode)||Re),Ke},k.sortStable=br.split("").sort(xa).join("")===br,k.detectDuplicates=!!Qt,Ct(),k.sortDetached=ys(function(te){return te.compareDocumentPosition(It.createElement("fieldset"))&1}),ys(function(te){return te.innerHTML="<a href='#'></a>",te.firstChild.getAttribute("href")==="#"})||nh("type|href|height|width",function(te,Re,Ke){if(!Ke)return te.getAttribute(Re,Re.toLowerCase()==="type"?1:2)}),(!k.attributes||!ys(function(te){return te.innerHTML="<input/>",te.firstChild.setAttribute("value",""),te.firstChild.getAttribute("value")===""}))&&nh("value",function(te,Re,Ke){if(!Ke&&te.nodeName.toLowerCase()==="input")return te.defaultValue}),ys(function(te){return te.getAttribute("disabled")==null})||nh(Ca,function(te,Re,Ke){var Lt;if(!Ke)return te[Re]===!0?Re.toLowerCase():(Lt=te.getAttributeNode(Re))&&Lt.specified?Lt.value:null}),Oi}(H);N.find=Ze,N.expr=Ze.selectors,N.expr[":"]=N.expr.pseudos,N.uniqueSort=N.unique=Ze.uniqueSort,N.text=Ze.getText,N.isXMLDoc=Ze.isXML,N.contains=Ze.contains,N.escapeSelector=Ze.escape;var xt=function(C,M,k){for(var L=[],W=k!==void 0;(C=C[M])&&C.nodeType!==9;)if(C.nodeType===1){if(W&&N(C).is(k))break;L.push(C)}return L},Zt=function(C,M){for(var k=[];C;C=C.nextSibling)C.nodeType===1&&C!==M&&k.push(C);return k},Kn=N.expr.match.needsContext;function we(C,M){return C.nodeName&&C.nodeName.toLowerCase()===M.toLowerCase()}var Bn=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Fr(C,M,k){return Q(M)?N.grep(C,function(L,W){return!!M.call(L,W,L)!==k}):M.nodeType?N.grep(C,function(L){return L===M!==k}):typeof M!="string"?N.grep(C,function(L){return Me.call(M,L)>-1!==k}):N.filter(M,C,k)}N.filter=function(C,M,k){var L=M[0];return k&&(C=":not("+C+")"),M.length===1&&L.nodeType===1?N.find.matchesSelector(L,C)?[L]:[]:N.find.matches(C,N.grep(M,function(W){return W.nodeType===1}))},N.fn.extend({find:function(C){var M,k,L=this.length,W=this;if(typeof C!="string")return this.pushStack(N(C).filter(function(){for(M=0;M<L;M++)if(N.contains(W[M],this))return!0}));for(k=this.pushStack([]),M=0;M<L;M++)N.find(C,W[M],k);return L>1?N.uniqueSort(k):k},filter:function(C){return this.pushStack(Fr(this,C||[],!1))},not:function(C){return this.pushStack(Fr(this,C||[],!0))},is:function(C){return!!Fr(this,typeof C=="string"&&Kn.test(C)?N(C):C||[],!1).length}});var nn,Dn=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,yn=N.fn.init=function(C,M,k){var L,W;if(!C)return this;if(k=k||nn,typeof C=="string")if(C[0]==="<"&&C[C.length-1]===">"&&C.length>=3?L=[null,C,null]:L=Dn.exec(C),L&&(L[1]||!M))if(L[1]){if(M=M instanceof N?M[0]:M,N.merge(this,N.parseHTML(L[1],M&&M.nodeType?M.ownerDocument||M:he,!0)),Bn.test(L[1])&&N.isPlainObject(M))for(L in M)Q(this[L])?this[L](M[L]):this.attr(L,M[L]);return this}else return W=he.getElementById(L[2]),W&&(this[0]=W,this.length=1),this;else return!M||M.jquery?(M||k).find(C):this.constructor(M).find(C);else{if(C.nodeType)return this[0]=C,this.length=1,this;if(Q(C))return k.ready!==void 0?k.ready(C):C(N)}return N.makeArray(C,this)};yn.prototype=N.fn,nn=N(he);var Rt=/^(?:parents|prev(?:Until|All))/,Sr={children:!0,contents:!0,next:!0,prev:!0};N.fn.extend({has:function(C){var M=N(C,this),k=M.length;return this.filter(function(){for(var L=0;L<k;L++)if(N.contains(this,M[L]))return!0})},closest:function(C,M){var k,L=0,W=this.length,Y=[],re=typeof C!="string"&&N(C);if(!Kn.test(C)){for(;L<W;L++)for(k=this[L];k&&k!==M;k=k.parentNode)if(k.nodeType<11&&(re?re.index(k)>-1:k.nodeType===1&&N.find.matchesSelector(k,C))){Y.push(k);break}}return this.pushStack(Y.length>1?N.uniqueSort(Y):Y)},index:function(C){return C?typeof C=="string"?Me.call(N(C),this[0]):Me.call(this,C.jquery?C[0]:C):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(C,M){return this.pushStack(N.uniqueSort(N.merge(this.get(),N(C,M))))},addBack:function(C){return this.add(C==null?this.prevObject:this.prevObject.filter(C))}});function pr(C,M){for(;(C=C[M])&&C.nodeType!==1;);return C}N.each({parent:function(C){var M=C.parentNode;return M&&M.nodeType!==11?M:null},parents:function(C){return xt(C,"parentNode")},parentsUntil:function(C,M,k){return xt(C,"parentNode",k)},next:function(C){return pr(C,"nextSibling")},prev:function(C){return pr(C,"previousSibling")},nextAll:function(C){return xt(C,"nextSibling")},prevAll:function(C){return xt(C,"previousSibling")},nextUntil:function(C,M,k){return xt(C,"nextSibling",k)},prevUntil:function(C,M,k){return xt(C,"previousSibling",k)},siblings:function(C){return Zt((C.parentNode||{}).firstChild,C)},children:function(C){return Zt(C.firstChild)},contents:function(C){return C.contentDocument!=null&&pe(C.contentDocument)?C.contentDocument:(we(C,"template")&&(C=C.content||C),N.merge([],C.childNodes))}},function(C,M){N.fn[C]=function(k,L){var W=N.map(this,M,k);return C.slice(-5)!=="Until"&&(L=k),L&&typeof L=="string"&&(W=N.filter(L,W)),this.length>1&&(Sr[C]||N.uniqueSort(W),Rt.test(C)&&W.reverse()),this.pushStack(W)}});var _n=/[^\x20\t\r\n\f]+/g;function gr(C){var M={};return N.each(C.match(_n)||[],function(k,L){M[L]=!0}),M}N.Callbacks=function(C){C=typeof C=="string"?gr(C):N.extend({},C);var M,k,L,W,Y=[],re=[],Ge=-1,Fe=function(){for(W=W||C.once,L=M=!0;re.length;Ge=-1)for(k=re.shift();++Ge<Y.length;)Y[Ge].apply(k[0],k[1])===!1&&C.stopOnFalse&&(Ge=Y.length,k=!1);C.memory||(k=!1),M=!1,W&&(k?Y=[]:Y="")},it={add:function(){return Y&&(k&&!M&&(Ge=Y.length-1,re.push(k)),function At(Qt){N.each(Qt,function(Ct,It){Q(It)?(!C.unique||!it.has(It))&&Y.push(It):It&&It.length&&De(It)!=="string"&&At(It)})}(arguments),k&&!M&&Fe()),this},remove:function(){return N.each(arguments,function(At,Qt){for(var Ct;(Ct=N.inArray(Qt,Y,Ct))>-1;)Y.splice(Ct,1),Ct<=Ge&&Ge--}),this},has:function(At){return At?N.inArray(At,Y)>-1:Y.length>0},empty:function(){return Y&&(Y=[]),this},disable:function(){return W=re=[],Y=k="",this},disabled:function(){return!Y},lock:function(){return W=re=[],!k&&!M&&(Y=k=""),this},locked:function(){return!!W},fireWith:function(At,Qt){return W||(Qt=Qt||[],Qt=[At,Qt.slice?Qt.slice():Qt],re.push(Qt),M||Fe()),this},fire:function(){return it.fireWith(this,arguments),this},fired:function(){return!!L}};return it};function Nn(C){return C}function yr(C){throw C}function Or(C,M,k,L){var W;try{C&&Q(W=C.promise)?W.call(C).done(M).fail(k):C&&Q(W=C.then)?W.call(C,M,k):M.apply(void 0,[C].slice(L))}catch(Y){k.apply(void 0,[Y])}}N.extend({Deferred:function(C){var M=[["notify","progress",N.Callbacks("memory"),N.Callbacks("memory"),2],["resolve","done",N.Callbacks("once memory"),N.Callbacks("once memory"),0,"resolved"],["reject","fail",N.Callbacks("once memory"),N.Callbacks("once memory"),1,"rejected"]],k="pending",L={state:function(){return k},always:function(){return W.done(arguments).fail(arguments),this},catch:function(Y){return L.then(null,Y)},pipe:function(){var Y=arguments;return N.Deferred(function(re){N.each(M,function(Ge,Fe){var it=Q(Y[Fe[4]])&&Y[Fe[4]];W[Fe[1]](function(){var At=it&&it.apply(this,arguments);At&&Q(At.promise)?At.promise().progress(re.notify).done(re.resolve).fail(re.reject):re[Fe[0]+"With"](this,it?[At]:arguments)})}),Y=null}).promise()},then:function(Y,re,Ge){var Fe=0;function it(At,Qt,Ct,It){return function(){var ir=this,Ir=arguments,er=function(){var So,Fs;if(!(At<Fe)){if(So=Ct.apply(ir,Ir),So===Qt.promise())throw new TypeError("Thenable self-resolution");Fs=So&&(typeof So=="object"||typeof So=="function")&&So.then,Q(Fs)?It?Fs.call(So,it(Fe,Qt,Nn,It),it(Fe,Qt,yr,It)):(Fe++,Fs.call(So,it(Fe,Qt,Nn,It),it(Fe,Qt,yr,It),it(Fe,Qt,Nn,Qt.notifyWith))):(Ct!==Nn&&(ir=void 0,Ir=[So]),(It||Qt.resolveWith)(ir,Ir))}},Eo=It?er:function(){try{er()}catch(So){N.Deferred.exceptionHook&&N.Deferred.exceptionHook(So,Eo.stackTrace),At+1>=Fe&&(Ct!==yr&&(ir=void 0,Ir=[So]),Qt.rejectWith(ir,Ir))}};At?Eo():(N.Deferred.getStackHook&&(Eo.stackTrace=N.Deferred.getStackHook()),H.setTimeout(Eo))}}return N.Deferred(function(At){M[0][3].add(it(0,At,Q(Ge)?Ge:Nn,At.notifyWith)),M[1][3].add(it(0,At,Q(Y)?Y:Nn)),M[2][3].add(it(0,At,Q(re)?re:yr))}).promise()},promise:function(Y){return Y!=null?N.extend(Y,L):L}},W={};return N.each(M,function(Y,re){var Ge=re[2],Fe=re[5];L[re[1]]=Ge.add,Fe&&Ge.add(function(){k=Fe},M[3-Y][2].disable,M[3-Y][3].disable,M[0][2].lock,M[0][3].lock),Ge.add(re[3].fire),W[re[0]]=function(){return W[re[0]+"With"](this===W?void 0:this,arguments),this},W[re[0]+"With"]=Ge.fireWith}),L.promise(W),C&&C.call(W,W),W},when:function(C){var M=arguments.length,k=M,L=Array(k),W=ke.call(arguments),Y=N.Deferred(),re=function(Ge){return function(Fe){L[Ge]=this,W[Ge]=arguments.length>1?ke.call(arguments):Fe,--M||Y.resolveWith(L,W)}};if(M<=1&&(Or(C,Y.done(re(k)).resolve,Y.reject,!M),Y.state()==="pending"||Q(W[k]&&W[k].then)))return Y.then();for(;k--;)Or(W[k],re(k),Y.reject);return Y.promise()}});var Co=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;N.Deferred.exceptionHook=function(C,M){H.console&&H.console.warn&&C&&Co.test(C.name)&&H.console.warn("jQuery.Deferred exception: "+C.message,C.stack,M)},N.readyException=function(C){H.setTimeout(function(){throw C})};var _r=N.Deferred();N.fn.ready=function(C){return _r.then(C).catch(function(M){N.readyException(M)}),this},N.extend({isReady:!1,readyWait:1,ready:function(C){(C===!0?--N.readyWait:N.isReady)||(N.isReady=!0,!(C!==!0&&--N.readyWait>0)&&_r.resolveWith(he,[N]))}}),N.ready.then=_r.then;function Mi(){he.removeEventListener("DOMContentLoaded",Mi),H.removeEventListener("load",Mi),N.ready()}he.readyState==="complete"||he.readyState!=="loading"&&!he.documentElement.doScroll?H.setTimeout(N.ready):(he.addEventListener("DOMContentLoaded",Mi),H.addEventListener("load",Mi));var Xi=function(C,M,k,L,W,Y,re){var Ge=0,Fe=C.length,it=k==null;if(De(k)==="object"){W=!0;for(Ge in k)Xi(C,M,Ge,k[Ge],!0,Y,re)}else if(L!==void 0&&(W=!0,Q(L)||(re=!0),it&&(re?(M.call(C,L),M=null):(it=M,M=function(At,Qt,Ct){return it.call(N(At),Ct)})),M))for(;Ge<Fe;Ge++)M(C[Ge],k,re?L:L.call(C[Ge],Ge,M(C[Ge],k)));return W?C:it?M.call(C):Fe?M(C[0],k):Y},ms=/^-ms-/,Xs=/-([a-z])/g;function Yi(C,M){return M.toUpperCase()}function Bi(C){return C.replace(ms,"ms-").replace(Xs,Yi)}var Qr=function(C){return C.nodeType===1||C.nodeType===9||!+C.nodeType};function fo(){this.expando=N.expando+fo.uid++}fo.uid=1,fo.prototype={cache:function(C){var M=C[this.expando];return M||(M={},Qr(C)&&(C.nodeType?C[this.expando]=M:Object.defineProperty(C,this.expando,{value:M,configurable:!0}))),M},set:function(C,M,k){var L,W=this.cache(C);if(typeof M=="string")W[Bi(M)]=k;else for(L in M)W[Bi(L)]=M[L];return W},get:function(C,M){return M===void 0?this.cache(C):C[this.expando]&&C[this.expando][Bi(M)]},access:function(C,M,k){return M===void 0||M&&typeof M=="string"&&k===void 0?this.get(C,M):(this.set(C,M,k),k!==void 0?k:M)},remove:function(C,M){var k,L=C[this.expando];if(L!==void 0){if(M!==void 0)for(Array.isArray(M)?M=M.map(Bi):(M=Bi(M),M=M in L?[M]:M.match(_n)||[]),k=M.length;k--;)delete L[M[k]];(M===void 0||N.isEmptyObject(L))&&(C.nodeType?C[this.expando]=void 0:delete C[this.expando])}},hasData:function(C){var M=C[this.expando];return M!==void 0&&!N.isEmptyObject(M)}};var Qn=new fo,Hr=new fo,Ra=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,fe=/[A-Z]/g;function Yc(C){return C==="true"?!0:C==="false"?!1:C==="null"?null:C===+C+""?+C:Ra.test(C)?JSON.parse(C):C}function Bu(C,M,k){var L;if(k===void 0&&C.nodeType===1)if(L="data-"+M.replace(fe,"-$&").toLowerCase(),k=C.getAttribute(L),typeof k=="string"){try{k=Yc(k)}catch{}Hr.set(C,M,k)}else k=void 0;return k}N.extend({hasData:function(C){return Hr.hasData(C)||Qn.hasData(C)},data:function(C,M,k){return Hr.access(C,M,k)},removeData:function(C,M){Hr.remove(C,M)},_data:function(C,M,k){return Qn.access(C,M,k)},_removeData:function(C,M){Qn.remove(C,M)}}),N.fn.extend({data:function(C,M){var k,L,W,Y=this[0],re=Y&&Y.attributes;if(C===void 0){if(this.length&&(W=Hr.get(Y),Y.nodeType===1&&!Qn.get(Y,"hasDataAttrs"))){for(k=re.length;k--;)re[k]&&(L=re[k].name,L.indexOf("data-")===0&&(L=Bi(L.slice(5)),Bu(Y,L,W[L])));Qn.set(Y,"hasDataAttrs",!0)}return W}return typeof C=="object"?this.each(function(){Hr.set(this,C)}):Xi(this,function(Ge){var Fe;if(Y&&Ge===void 0)return Fe=Hr.get(Y,C),Fe!==void 0||(Fe=Bu(Y,C),Fe!==void 0)?Fe:void 0;this.each(function(){Hr.set(this,C,Ge)})},null,M,arguments.length>1,null,!0)},removeData:function(C){return this.each(function(){Hr.remove(this,C)})}}),N.extend({queue:function(C,M,k){var L;if(C)return M=(M||"fx")+"queue",L=Qn.get(C,M),k&&(!L||Array.isArray(k)?L=Qn.access(C,M,N.makeArray(k)):L.push(k)),L||[]},dequeue:function(C,M){M=M||"fx";var k=N.queue(C,M),L=k.length,W=k.shift(),Y=N._queueHooks(C,M),re=function(){N.dequeue(C,M)};W==="inprogress"&&(W=k.shift(),L--),W&&(M==="fx"&&k.unshift("inprogress"),delete Y.stop,W.call(C,re,Y)),!L&&Y&&Y.empty.fire()},_queueHooks:function(C,M){var k=M+"queueHooks";return Qn.get(C,k)||Qn.access(C,k,{empty:N.Callbacks("once memory").add(function(){Qn.remove(C,[M+"queue",k])})})}}),N.fn.extend({queue:function(C,M){var k=2;return typeof C!="string"&&(M=C,C="fx",k--),arguments.length<k?N.queue(this[0],C):M===void 0?this:this.each(function(){var L=N.queue(this,C,M);N._queueHooks(this,C),C==="fx"&&L[0]!=="inprogress"&&N.dequeue(this,C)})},dequeue:function(C){return this.each(function(){N.dequeue(this,C)})},clearQueue:function(C){return this.queue(C||"fx",[])},promise:function(C,M){var k,L=1,W=N.Deferred(),Y=this,re=this.length,Ge=function(){--L||W.resolveWith(Y,[Y])};for(typeof C!="string"&&(M=C,C=void 0),C=C||"fx";re--;)k=Qn.get(Y[re],C+"queueHooks"),k&&k.empty&&(L++,k.empty.add(Ge));return Ge(),W.promise(M)}});var vt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Tl=new RegExp("^(?:([+-])=|)("+vt+")([a-z%]*)$","i"),ct=["Top","Right","Bottom","Left"],Ee=he.documentElement,Ho=function(C){return N.contains(C.ownerDocument,C)},ya={composed:!0};Ee.getRootNode&&(Ho=function(C){return N.contains(C.ownerDocument,C)||C.getRootNode(ya)===C.ownerDocument});var Ys=function(C,M){return C=M||C,C.style.display==="none"||C.style.display===""&&Ho(C)&&N.css(C,"display")==="none"};function qo(C,M,k,L){var W,Y,re=20,Ge=L?function(){return L.cur()}:function(){return N.css(C,M,"")},Fe=Ge(),it=k&&k[3]||(N.cssNumber[M]?"":"px"),At=C.nodeType&&(N.cssNumber[M]||it!=="px"&&+Fe)&&Tl.exec(N.css(C,M));if(At&&At[3]!==it){for(Fe=Fe/2,it=it||At[3],At=+Fe||1;re--;)N.style(C,M,At+it),(1-Y)*(1-(Y=Ge()/Fe||.5))<=0&&(re=0),At=At/Y;At=At*2,N.style(C,M,At+it),k=k||[]}return k&&(At=+At||+Fe||0,W=k[1]?At+(k[1]+1)*k[2]:+k[2],L&&(L.unit=it,L.start=At,L.end=W)),W}var la={};function Ss(C){var M,k=C.ownerDocument,L=C.nodeName,W=la[L];return W||(M=k.body.appendChild(k.createElement(L)),W=N.css(M,"display"),M.parentNode.removeChild(M),W==="none"&&(W="block"),la[L]=W,W)}function Jo(C,M){for(var k,L,W=[],Y=0,re=C.length;Y<re;Y++)L=C[Y],L.style&&(k=L.style.display,M?(k==="none"&&(W[Y]=Qn.get(L,"display")||null,W[Y]||(L.style.display="")),L.style.display===""&&Ys(L)&&(W[Y]=Ss(L))):k!=="none"&&(W[Y]="none",Qn.set(L,"display",k)));for(Y=0;Y<re;Y++)W[Y]!=null&&(C[Y].style.display=W[Y]);return C}N.fn.extend({show:function(){return Jo(this,!0)},hide:function(){return Jo(this)},toggle:function(C){return typeof C=="boolean"?C?this.show():this.hide():this.each(function(){Ys(this)?N(this).show():N(this).hide()})}});var Ks=/^(?:checkbox|radio)$/i,ac=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,lc=/^$|^module$|\/(?:java|ecma)script/i;(function(){var C=he.createDocumentFragment(),M=C.appendChild(he.createElement("div")),k=he.createElement("input");k.setAttribute("type","radio"),k.setAttribute("checked","checked"),k.setAttribute("name","t"),M.appendChild(k),le.checkClone=M.cloneNode(!0).cloneNode(!0).lastChild.checked,M.innerHTML="<textarea>x</textarea>",le.noCloneChecked=!!M.cloneNode(!0).lastChild.defaultValue,M.innerHTML="<option></option>",le.option=!!M.lastChild})();var Qo={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Qo.tbody=Qo.tfoot=Qo.colgroup=Qo.caption=Qo.thead,Qo.th=Qo.td,le.option||(Qo.optgroup=Qo.option=[1,"<select multiple='multiple'>","</select>"]);function es(C,M){var k;return typeof C.getElementsByTagName<"u"?k=C.getElementsByTagName(M||"*"):typeof C.querySelectorAll<"u"?k=C.querySelectorAll(M||"*"):k=[],M===void 0||M&&we(C,M)?N.merge([C],k):k}function zu(C,M){for(var k=0,L=C.length;k<L;k++)Qn.set(C[k],"globalEval",!M||Qn.get(M[k],"globalEval"))}var qs=/<|&#?\w+;/;function ef(C,M,k,L,W){for(var Y,re,Ge,Fe,it,At,Qt=M.createDocumentFragment(),Ct=[],It=0,ir=C.length;It<ir;It++)if(Y=C[It],Y||Y===0)if(De(Y)==="object")N.merge(Ct,Y.nodeType?[Y]:Y);else if(!qs.test(Y))Ct.push(M.createTextNode(Y));else{for(re=re||Qt.appendChild(M.createElement("div")),Ge=(ac.exec(Y)||["",""])[1].toLowerCase(),Fe=Qo[Ge]||Qo._default,re.innerHTML=Fe[1]+N.htmlPrefilter(Y)+Fe[2],At=Fe[0];At--;)re=re.lastChild;N.merge(Ct,re.childNodes),re=Qt.firstChild,re.textContent=""}for(Qt.textContent="",It=0;Y=Ct[It++];){if(L&&N.inArray(Y,L)>-1){W&&W.push(Y);continue}if(it=Ho(Y),re=es(Qt.appendChild(Y),"script"),it&&zu(re),k)for(At=0;Y=re[At++];)lc.test(Y.type||"")&&k.push(Y)}return Qt}var Fp=/^([^.]*)(?:\.(.+)|)/;function F(){return!0}function No(){return!1}function Ii(C,M){return C===Zg()==(M==="focus")}function Zg(){try{return he.activeElement}catch{}}function Yr(C,M,k,L,W,Y){var re,Ge;if(typeof M=="object"){typeof k!="string"&&(L=L||k,k=void 0);for(Ge in M)Yr(C,Ge,k,L,M[Ge],Y);return C}if(L==null&&W==null?(W=k,L=k=void 0):W==null&&(typeof k=="string"?(W=L,L=void 0):(W=L,L=k,k=void 0)),W===!1)W=No;else if(!W)return C;return Y===1&&(re=W,W=function(Fe){return N().off(Fe),re.apply(this,arguments)},W.guid=re.guid||(re.guid=N.guid++)),C.each(function(){N.event.add(this,M,W,L,k)})}N.event={global:{},add:function(C,M,k,L,W){var Y,re,Ge,Fe,it,At,Qt,Ct,It,ir,Ir,er=Qn.get(C);if(!!Qr(C))for(k.handler&&(Y=k,k=Y.handler,W=Y.selector),W&&N.find.matchesSelector(Ee,W),k.guid||(k.guid=N.guid++),(Fe=er.events)||(Fe=er.events=Object.create(null)),(re=er.handle)||(re=er.handle=function(Eo){return typeof N<"u"&&N.event.triggered!==Eo.type?N.event.dispatch.apply(C,arguments):void 0}),M=(M||"").match(_n)||[""],it=M.length;it--;)Ge=Fp.exec(M[it])||[],It=Ir=Ge[1],ir=(Ge[2]||"").split(".").sort(),It&&(Qt=N.event.special[It]||{},It=(W?Qt.delegateType:Qt.bindType)||It,Qt=N.event.special[It]||{},At=N.extend({type:It,origType:Ir,data:L,handler:k,guid:k.guid,selector:W,needsContext:W&&N.expr.match.needsContext.test(W),namespace:ir.join(".")},Y),(Ct=Fe[It])||(Ct=Fe[It]=[],Ct.delegateCount=0,(!Qt.setup||Qt.setup.call(C,L,ir,re)===!1)&&C.addEventListener&&C.addEventListener(It,re)),Qt.add&&(Qt.add.call(C,At),At.handler.guid||(At.handler.guid=k.guid)),W?Ct.splice(Ct.delegateCount++,0,At):Ct.push(At),N.event.global[It]=!0)},remove:function(C,M,k,L,W){var Y,re,Ge,Fe,it,At,Qt,Ct,It,ir,Ir,er=Qn.hasData(C)&&Qn.get(C);if(!(!er||!(Fe=er.events))){for(M=(M||"").match(_n)||[""],it=M.length;it--;){if(Ge=Fp.exec(M[it])||[],It=Ir=Ge[1],ir=(Ge[2]||"").split(".").sort(),!It){for(It in Fe)N.event.remove(C,It+M[it],k,L,!0);continue}for(Qt=N.event.special[It]||{},It=(L?Qt.delegateType:Qt.bindType)||It,Ct=Fe[It]||[],Ge=Ge[2]&&new RegExp("(^|\\.)"+ir.join("\\.(?:.*\\.|)")+"(\\.|$)"),re=Y=Ct.length;Y--;)At=Ct[Y],(W||Ir===At.origType)&&(!k||k.guid===At.guid)&&(!Ge||Ge.test(At.namespace))&&(!L||L===At.selector||L==="**"&&At.selector)&&(Ct.splice(Y,1),At.selector&&Ct.delegateCount--,Qt.remove&&Qt.remove.call(C,At));re&&!Ct.length&&((!Qt.teardown||Qt.teardown.call(C,ir,er.handle)===!1)&&N.removeEvent(C,It,er.handle),delete Fe[It])}N.isEmptyObject(Fe)&&Qn.remove(C,"handle events")}},dispatch:function(C){var M,k,L,W,Y,re,Ge=new Array(arguments.length),Fe=N.event.fix(C),it=(Qn.get(this,"events")||Object.create(null))[Fe.type]||[],At=N.event.special[Fe.type]||{};for(Ge[0]=Fe,M=1;M<arguments.length;M++)Ge[M]=arguments[M];if(Fe.delegateTarget=this,!(At.preDispatch&&At.preDispatch.call(this,Fe)===!1)){for(re=N.event.handlers.call(this,Fe,it),M=0;(W=re[M++])&&!Fe.isPropagationStopped();)for(Fe.currentTarget=W.elem,k=0;(Y=W.handlers[k++])&&!Fe.isImmediatePropagationStopped();)(!Fe.rnamespace||Y.namespace===!1||Fe.rnamespace.test(Y.namespace))&&(Fe.handleObj=Y,Fe.data=Y.data,L=((N.event.special[Y.origType]||{}).handle||Y.handler).apply(W.elem,Ge),L!==void 0&&(Fe.result=L)===!1&&(Fe.preventDefault(),Fe.stopPropagation()));return At.postDispatch&&At.postDispatch.call(this,Fe),Fe.result}},handlers:function(C,M){var k,L,W,Y,re,Ge=[],Fe=M.delegateCount,it=C.target;if(Fe&&it.nodeType&&!(C.type==="click"&&C.button>=1)){for(;it!==this;it=it.parentNode||this)if(it.nodeType===1&&!(C.type==="click"&&it.disabled===!0)){for(Y=[],re={},k=0;k<Fe;k++)L=M[k],W=L.selector+" ",re[W]===void 0&&(re[W]=L.needsContext?N(W,this).index(it)>-1:N.find(W,this,null,[it]).length),re[W]&&Y.push(L);Y.length&&Ge.push({elem:it,handlers:Y})}}return it=this,Fe<M.length&&Ge.push({elem:it,handlers:M.slice(Fe)}),Ge},addProp:function(C,M){Object.defineProperty(N.Event.prototype,C,{enumerable:!0,configurable:!0,get:Q(M)?function(){if(this.originalEvent)return M(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[C]},set:function(k){Object.defineProperty(this,C,{enumerable:!0,configurable:!0,writable:!0,value:k})}})},fix:function(C){return C[N.expando]?C:new N.Event(C)},special:{load:{noBubble:!0},click:{setup:function(C){var M=this||C;return Ks.test(M.type)&&M.click&&we(M,"input")&&ca(M,"click",F),!1},trigger:function(C){var M=this||C;return Ks.test(M.type)&&M.click&&we(M,"input")&&ca(M,"click"),!0},_default:function(C){var M=C.target;return Ks.test(M.type)&&M.click&&we(M,"input")&&Qn.get(M,"click")||we(M,"a")}},beforeunload:{postDispatch:function(C){C.result!==void 0&&C.originalEvent&&(C.originalEvent.returnValue=C.result)}}}};function ca(C,M,k){if(!k){Qn.get(C,M)===void 0&&N.event.add(C,M,F);return}Qn.set(C,M,!1),N.event.add(C,M,{namespace:!1,handler:function(L){var W,Y,re=Qn.get(this,M);if(L.isTrigger&1&&this[M]){if(re.length)(N.event.special[M]||{}).delegateType&&L.stopPropagation();else if(re=ke.call(arguments),Qn.set(this,M,re),W=k(this,M),this[M](),Y=Qn.get(this,M),re!==Y||W?Qn.set(this,M,!1):Y={},re!==Y)return L.stopImmediatePropagation(),L.preventDefault(),Y&&Y.value}else re.length&&(Qn.set(this,M,{value:N.event.trigger(N.extend(re[0],N.Event.prototype),re.slice(1),this)}),L.stopImmediatePropagation())}})}N.removeEvent=function(C,M,k){C.removeEventListener&&C.removeEventListener(M,k)},N.Event=function(C,M){if(!(this instanceof N.Event))return new N.Event(C,M);C&&C.type?(this.originalEvent=C,this.type=C.type,this.isDefaultPrevented=C.defaultPrevented||C.defaultPrevented===void 0&&C.returnValue===!1?F:No,this.target=C.target&&C.target.nodeType===3?C.target.parentNode:C.target,this.currentTarget=C.currentTarget,this.relatedTarget=C.relatedTarget):this.type=C,M&&N.extend(this,M),this.timeStamp=C&&C.timeStamp||Date.now(),this[N.expando]=!0},N.Event.prototype={constructor:N.Event,isDefaultPrevented:No,isPropagationStopped:No,isImmediatePropagationStopped:No,isSimulated:!1,preventDefault:function(){var C=this.originalEvent;this.isDefaultPrevented=F,C&&!this.isSimulated&&C.preventDefault()},stopPropagation:function(){var C=this.originalEvent;this.isPropagationStopped=F,C&&!this.isSimulated&&C.stopPropagation()},stopImmediatePropagation:function(){var C=this.originalEvent;this.isImmediatePropagationStopped=F,C&&!this.isSimulated&&C.stopImmediatePropagation(),this.stopPropagation()}},N.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},N.event.addProp),N.each({focus:"focusin",blur:"focusout"},function(C,M){N.event.special[C]={setup:function(){return ca(this,C,Ii),!1},trigger:function(){return ca(this,C),!0},_default:function(k){return Qn.get(k.target,C)},delegateType:M}}),N.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(C,M){N.event.special[C]={delegateType:M,bindType:M,handle:function(k){var L,W=this,Y=k.relatedTarget,re=k.handleObj;return(!Y||Y!==W&&!N.contains(W,Y))&&(k.type=re.origType,L=re.handler.apply(this,arguments),k.type=M),L}}}),N.fn.extend({on:function(C,M,k,L){return Yr(this,C,M,k,L)},one:function(C,M,k,L){return Yr(this,C,M,k,L,1)},off:function(C,M,k){var L,W;if(C&&C.preventDefault&&C.handleObj)return L=C.handleObj,N(C.delegateTarget).off(L.namespace?L.origType+"."+L.namespace:L.origType,L.selector,L.handler),this;if(typeof C=="object"){for(W in C)this.off(W,M,C[W]);return this}return(M===!1||typeof M=="function")&&(k=M,M=void 0),k===!1&&(k=No),this.each(function(){N.event.remove(this,C,k,M)})}});var Uu=/<script|<style|<link/i,tf=/checked\s*(?:[^=]|=\s*.checked.)/i,nf=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function rf(C,M){return we(C,"table")&&we(M.nodeType!==11?M:M.firstChild,"tr")&&N(C).children("tbody")[0]||C}function ba(C){return C.type=(C.getAttribute("type")!==null)+"/"+C.type,C}function Rn(C){return(C.type||"").slice(0,5)==="true/"?C.type=C.type.slice(5):C.removeAttribute("type"),C}function qn(C,M){var k,L,W,Y,re,Ge,Fe;if(M.nodeType===1){if(Qn.hasData(C)&&(Y=Qn.get(C),Fe=Y.events,Fe)){Qn.remove(M,"handle events");for(W in Fe)for(k=0,L=Fe[W].length;k<L;k++)N.event.add(M,W,Fe[W][k])}Hr.hasData(C)&&(re=Hr.access(C),Ge=N.extend({},re),Hr.set(M,Ge))}}function As(C,M){var k=M.nodeName.toLowerCase();k==="input"&&Ks.test(C.type)?M.checked=C.checked:(k==="input"||k==="textarea")&&(M.defaultValue=C.defaultValue)}function Ml(C,M,k,L){M=Ce(M);var W,Y,re,Ge,Fe,it,At=0,Qt=C.length,Ct=Qt-1,It=M[0],ir=Q(It);if(ir||Qt>1&&typeof It=="string"&&!le.checkClone&&tf.test(It))return C.each(function(Ir){var er=C.eq(Ir);ir&&(M[0]=It.call(this,Ir,er.html())),Ml(er,M,k,L)});if(Qt&&(W=ef(M,C[0].ownerDocument,!1,C,L),Y=W.firstChild,W.childNodes.length===1&&(W=Y),Y||L)){for(re=N.map(es(W,"script"),ba),Ge=re.length;At<Qt;At++)Fe=W,At!==Ct&&(Fe=N.clone(Fe,!0,!0),Ge&&N.merge(re,es(Fe,"script"))),k.call(C[At],Fe,At);if(Ge)for(it=re[re.length-1].ownerDocument,N.map(re,Rn),At=0;At<Ge;At++)Fe=re[At],lc.test(Fe.type||"")&&!Qn.access(Fe,"globalEval")&&N.contains(it,Fe)&&(Fe.src&&(Fe.type||"").toLowerCase()!=="module"?N._evalUrl&&!Fe.noModule&&N._evalUrl(Fe.src,{nonce:Fe.nonce||Fe.getAttribute("nonce")},it):ce(Fe.textContent.replace(nf,""),Fe,it))}return C}function of(C,M,k){for(var L,W=M?N.filter(M,C):C,Y=0;(L=W[Y])!=null;Y++)!k&&L.nodeType===1&&N.cleanData(es(L)),L.parentNode&&(k&&Ho(L)&&zu(es(L,"script")),L.parentNode.removeChild(L));return C}N.extend({htmlPrefilter:function(C){return C},clone:function(C,M,k){var L,W,Y,re,Ge=C.cloneNode(!0),Fe=Ho(C);if(!le.noCloneChecked&&(C.nodeType===1||C.nodeType===11)&&!N.isXMLDoc(C))for(re=es(Ge),Y=es(C),L=0,W=Y.length;L<W;L++)As(Y[L],re[L]);if(M)if(k)for(Y=Y||es(C),re=re||es(Ge),L=0,W=Y.length;L<W;L++)qn(Y[L],re[L]);else qn(C,Ge);return re=es(Ge,"script"),re.length>0&&zu(re,!Fe&&es(C,"script")),Ge},cleanData:function(C){for(var M,k,L,W=N.event.special,Y=0;(k=C[Y])!==void 0;Y++)if(Qr(k)){if(M=k[Qn.expando]){if(M.events)for(L in M.events)W[L]?N.event.remove(k,L):N.removeEvent(k,L,M.handle);k[Qn.expando]=void 0}k[Hr.expando]&&(k[Hr.expando]=void 0)}}}),N.fn.extend({detach:function(C){return of(this,C,!0)},remove:function(C){return of(this,C)},text:function(C){return Xi(this,function(M){return M===void 0?N.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=M)})},null,C,arguments.length)},append:function(){return Ml(this,arguments,function(C){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var M=rf(this,C);M.appendChild(C)}})},prepend:function(){return Ml(this,arguments,function(C){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var M=rf(this,C);M.insertBefore(C,M.firstChild)}})},before:function(){return Ml(this,arguments,function(C){this.parentNode&&this.parentNode.insertBefore(C,this)})},after:function(){return Ml(this,arguments,function(C){this.parentNode&&this.parentNode.insertBefore(C,this.nextSibling)})},empty:function(){for(var C,M=0;(C=this[M])!=null;M++)C.nodeType===1&&(N.cleanData(es(C,!1)),C.textContent="");return this},clone:function(C,M){return C=C??!1,M=M??C,this.map(function(){return N.clone(this,C,M)})},html:function(C){return Xi(this,function(M){var k=this[0]||{},L=0,W=this.length;if(M===void 0&&k.nodeType===1)return k.innerHTML;if(typeof M=="string"&&!Uu.test(M)&&!Qo[(ac.exec(M)||["",""])[1].toLowerCase()]){M=N.htmlPrefilter(M);try{for(;L<W;L++)k=this[L]||{},k.nodeType===1&&(N.cleanData(es(k,!1)),k.innerHTML=M);k=0}catch{}}k&&this.empty().append(M)},null,C,arguments.length)},replaceWith:function(){var C=[];return Ml(this,arguments,function(M){var k=this.parentNode;N.inArray(this,C)<0&&(N.cleanData(es(this)),k&&k.replaceChild(M,this))},C)}}),N.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(C,M){N.fn[C]=function(k){for(var L,W=[],Y=N(k),re=Y.length-1,Ge=0;Ge<=re;Ge++)L=Ge===re?this:this.clone(!0),N(Y[Ge])[M](L),ge.apply(W,L.get());return this.pushStack(W)}});var Vu=new RegExp("^("+vt+")(?!px)[a-z%]+$","i"),Ia=/^--/,Pl=function(C){var M=C.ownerDocument.defaultView;return(!M||!M.opener)&&(M=H),M.getComputedStyle(C)},ju=function(C,M,k){var L,W,Y={};for(W in M)Y[W]=C.style[W],C.style[W]=M[W];L=k.call(C);for(W in M)C.style[W]=Y[W];return L},sf=new RegExp(ct.join("|"),"i"),cc="[\\x20\\t\\r\\n\\f]",Xg=new RegExp("^"+cc+"+|((?:^|[^\\\\])(?:\\\\.)*)"+cc+"+$","g");(function(){function C(){if(!!it){Fe.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",it.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Ee.appendChild(Fe).appendChild(it);var At=H.getComputedStyle(it);k=At.top!=="1%",Ge=M(At.marginLeft)===12,it.style.right="60%",Y=M(At.right)===36,L=M(At.width)===36,it.style.position="absolute",W=M(it.offsetWidth/3)===12,Ee.removeChild(Fe),it=null}}function M(At){return Math.round(parseFloat(At))}var k,L,W,Y,re,Ge,Fe=he.createElement("div"),it=he.createElement("div");!it.style||(it.style.backgroundClip="content-box",it.cloneNode(!0).style.backgroundClip="",le.clearCloneStyle=it.style.backgroundClip==="content-box",N.extend(le,{boxSizingReliable:function(){return C(),L},pixelBoxStyles:function(){return C(),Y},pixelPosition:function(){return C(),k},reliableMarginLeft:function(){return C(),Ge},scrollboxSize:function(){return C(),W},reliableTrDimensions:function(){var At,Qt,Ct,It;return re==null&&(At=he.createElement("table"),Qt=he.createElement("tr"),Ct=he.createElement("div"),At.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Qt.style.cssText="border:1px solid",Qt.style.height="1px",Ct.style.height="9px",Ct.style.display="block",Ee.appendChild(At).appendChild(Qt).appendChild(Ct),It=H.getComputedStyle(Qt),re=parseInt(It.height,10)+parseInt(It.borderTopWidth,10)+parseInt(It.borderBottomWidth,10)===Qt.offsetHeight,Ee.removeChild(At)),re}}))})();function Hu(C,M,k){var L,W,Y,re,Ge=Ia.test(M),Fe=C.style;return k=k||Pl(C),k&&(re=k.getPropertyValue(M)||k[M],Ge&&(re=re.replace(Xg,"$1")),re===""&&!Ho(C)&&(re=N.style(C,M)),!le.pixelBoxStyles()&&Vu.test(re)&&sf.test(M)&&(L=Fe.width,W=Fe.minWidth,Y=Fe.maxWidth,Fe.minWidth=Fe.maxWidth=Fe.width=re,re=k.width,Fe.width=L,Fe.minWidth=W,Fe.maxWidth=Y)),re!==void 0?re+"":re}function Hd(C,M){return{get:function(){if(C()){delete this.get;return}return(this.get=M).apply(this,arguments)}}}var Ol=["Webkit","Moz","ms"],$d=he.createElement("div").style,Wd={};function Kc(C){for(var M=C[0].toUpperCase()+C.slice(1),k=Ol.length;k--;)if(C=Ol[k]+M,C in $d)return C}function po(C){var M=N.cssProps[C]||Wd[C];return M||(C in $d?C:Wd[C]=Kc(C)||C)}var Gp=/^(none|table(?!-c[ea]).+)/,Zd={position:"absolute",visibility:"hidden",display:"block"},Xd={letterSpacing:"0",fontWeight:"400"};function af(C,M,k){var L=Tl.exec(M);return L?Math.max(0,L[2]-(k||0))+(L[3]||"px"):M}function di(C,M,k,L,W,Y){var re=M==="width"?1:0,Ge=0,Fe=0;if(k===(L?"border":"content"))return 0;for(;re<4;re+=2)k==="margin"&&(Fe+=N.css(C,k+ct[re],!0,W)),L?(k==="content"&&(Fe-=N.css(C,"padding"+ct[re],!0,W)),k!=="margin"&&(Fe-=N.css(C,"border"+ct[re]+"Width",!0,W))):(Fe+=N.css(C,"padding"+ct[re],!0,W),k!=="padding"?Fe+=N.css(C,"border"+ct[re]+"Width",!0,W):Ge+=N.css(C,"border"+ct[re]+"Width",!0,W));return!L&&Y>=0&&(Fe+=Math.max(0,Math.ceil(C["offset"+M[0].toUpperCase()+M.slice(1)]-Y-Fe-Ge-.5))||0),Fe}function zi(C,M,k){var L=Pl(C),W=!le.boxSizingReliable()||k,Y=W&&N.css(C,"boxSizing",!1,L)==="border-box",re=Y,Ge=Hu(C,M,L),Fe="offset"+M[0].toUpperCase()+M.slice(1);if(Vu.test(Ge)){if(!k)return Ge;Ge="auto"}return(!le.boxSizingReliable()&&Y||!le.reliableTrDimensions()&&we(C,"tr")||Ge==="auto"||!parseFloat(Ge)&&N.css(C,"display",!1,L)==="inline")&&C.getClientRects().length&&(Y=N.css(C,"boxSizing",!1,L)==="border-box",re=Fe in C,re&&(Ge=C[Fe])),Ge=parseFloat(Ge)||0,Ge+di(C,M,k||(Y?"border":"content"),re,L,Ge)+"px"}N.extend({cssHooks:{opacity:{get:function(C,M){if(M){var k=Hu(C,"opacity");return k===""?"1":k}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(C,M,k,L){if(!(!C||C.nodeType===3||C.nodeType===8||!C.style)){var W,Y,re,Ge=Bi(M),Fe=Ia.test(M),it=C.style;if(Fe||(M=po(Ge)),re=N.cssHooks[M]||N.cssHooks[Ge],k!==void 0){if(Y=typeof k,Y==="string"&&(W=Tl.exec(k))&&W[1]&&(k=qo(C,M,W),Y="number"),k==null||k!==k)return;Y==="number"&&!Fe&&(k+=W&&W[3]||(N.cssNumber[Ge]?"":"px")),!le.clearCloneStyle&&k===""&&M.indexOf("background")===0&&(it[M]="inherit"),(!re||!("set"in re)||(k=re.set(C,k,L))!==void 0)&&(Fe?it.setProperty(M,k):it[M]=k)}else return re&&"get"in re&&(W=re.get(C,!1,L))!==void 0?W:it[M]}},css:function(C,M,k,L){var W,Y,re,Ge=Bi(M),Fe=Ia.test(M);return Fe||(M=po(Ge)),re=N.cssHooks[M]||N.cssHooks[Ge],re&&"get"in re&&(W=re.get(C,!0,k)),W===void 0&&(W=Hu(C,M,L)),W==="normal"&&M in Xd&&(W=Xd[M]),k===""||k?(Y=parseFloat(W),k===!0||isFinite(Y)?Y||0:W):W}}),N.each(["height","width"],function(C,M){N.cssHooks[M]={get:function(k,L,W){if(L)return Gp.test(N.css(k,"display"))&&(!k.getClientRects().length||!k.getBoundingClientRect().width)?ju(k,Zd,function(){return zi(k,M,W)}):zi(k,M,W)},set:function(k,L,W){var Y,re=Pl(k),Ge=!le.scrollboxSize()&&re.position==="absolute",Fe=Ge||W,it=Fe&&N.css(k,"boxSizing",!1,re)==="border-box",At=W?di(k,M,W,it,re):0;return it&&Ge&&(At-=Math.ceil(k["offset"+M[0].toUpperCase()+M.slice(1)]-parseFloat(re[M])-di(k,M,"border",!1,re)-.5)),At&&(Y=Tl.exec(L))&&(Y[3]||"px")!=="px"&&(k.style[M]=L,L=N.css(k,M)),af(k,L,At)}}}),N.cssHooks.marginLeft=Hd(le.reliableMarginLeft,function(C,M){if(M)return(parseFloat(Hu(C,"marginLeft"))||C.getBoundingClientRect().left-ju(C,{marginLeft:0},function(){return C.getBoundingClientRect().left}))+"px"}),N.each({margin:"",padding:"",border:"Width"},function(C,M){N.cssHooks[C+M]={expand:function(k){for(var L=0,W={},Y=typeof k=="string"?k.split(" "):[k];L<4;L++)W[C+ct[L]+M]=Y[L]||Y[L-2]||Y[0];return W}},C!=="margin"&&(N.cssHooks[C+M].set=af)}),N.fn.extend({css:function(C,M){return Xi(this,function(k,L,W){var Y,re,Ge={},Fe=0;if(Array.isArray(L)){for(Y=Pl(k),re=L.length;Fe<re;Fe++)Ge[L[Fe]]=N.css(k,L[Fe],!1,Y);return Ge}return W!==void 0?N.style(k,L,W):N.css(k,L)},C,M,arguments.length>1)}});function rr(C,M,k,L,W){return new rr.prototype.init(C,M,k,L,W)}N.Tween=rr,rr.prototype={constructor:rr,init:function(C,M,k,L,W,Y){this.elem=C,this.prop=k,this.easing=W||N.easing._default,this.options=M,this.start=this.now=this.cur(),this.end=L,this.unit=Y||(N.cssNumber[k]?"":"px")},cur:function(){var C=rr.propHooks[this.prop];return C&&C.get?C.get(this):rr.propHooks._default.get(this)},run:function(C){var M,k=rr.propHooks[this.prop];return this.options.duration?this.pos=M=N.easing[this.easing](C,this.options.duration*C,0,1,this.options.duration):this.pos=M=C,this.now=(this.end-this.start)*M+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),k&&k.set?k.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(C){var M;return C.elem.nodeType!==1||C.elem[C.prop]!=null&&C.elem.style[C.prop]==null?C.elem[C.prop]:(M=N.css(C.elem,C.prop,""),!M||M==="auto"?0:M)},set:function(C){N.fx.step[C.prop]?N.fx.step[C.prop](C):C.elem.nodeType===1&&(N.cssHooks[C.prop]||C.elem.style[po(C.prop)]!=null)?N.style(C.elem,C.prop,C.now+C.unit):C.elem[C.prop]=C.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(C){C.elem.nodeType&&C.elem.parentNode&&(C.elem[C.prop]=C.now)}},N.easing={linear:function(C){return C},swing:function(C){return .5-Math.cos(C*Math.PI)/2},_default:"swing"},N.fx=rr.prototype.init,N.fx.step={};var Ja,to,lf=/^(?:toggle|show|hide)$/,$u=/queueHooks$/;function Wu(){to&&(he.hidden===!1&&H.requestAnimationFrame?H.requestAnimationFrame(Wu):H.setTimeout(Wu,N.fx.interval),N.fx.tick())}function cf(){return H.setTimeout(function(){Ja=void 0}),Ja=Date.now()}function Yd(C,M){var k,L=0,W={height:C};for(M=M?1:0;L<4;L+=2-M)k=ct[L],W["margin"+k]=W["padding"+k]=C;return M&&(W.opacity=W.width=C),W}function Dl(C,M,k){for(var L,W=(ko.tweeners[M]||[]).concat(ko.tweeners["*"]),Y=0,re=W.length;Y<re;Y++)if(L=W[Y].call(k,M,C))return L}function Kd(C,M,k){var L,W,Y,re,Ge,Fe,it,At,Qt="width"in M||"height"in M,Ct=this,It={},ir=C.style,Ir=C.nodeType&&Ys(C),er=Qn.get(C,"fxshow");k.queue||(re=N._queueHooks(C,"fx"),re.unqueued==null&&(re.unqueued=0,Ge=re.empty.fire,re.empty.fire=function(){re.unqueued||Ge()}),re.unqueued++,Ct.always(function(){Ct.always(function(){re.unqueued--,N.queue(C,"fx").length||re.empty.fire()})}));for(L in M)if(W=M[L],lf.test(W)){if(delete M[L],Y=Y||W==="toggle",W===(Ir?"hide":"show"))if(W==="show"&&er&&er[L]!==void 0)Ir=!0;else continue;It[L]=er&&er[L]||N.style(C,L)}if(Fe=!N.isEmptyObject(M),!(!Fe&&N.isEmptyObject(It))){Qt&&C.nodeType===1&&(k.overflow=[ir.overflow,ir.overflowX,ir.overflowY],it=er&&er.display,it==null&&(it=Qn.get(C,"display")),At=N.css(C,"display"),At==="none"&&(it?At=it:(Jo([C],!0),it=C.style.display||it,At=N.css(C,"display"),Jo([C]))),(At==="inline"||At==="inline-block"&&it!=null)&&N.css(C,"float")==="none"&&(Fe||(Ct.done(function(){ir.display=it}),it==null&&(At=ir.display,it=At==="none"?"":At)),ir.display="inline-block")),k.overflow&&(ir.overflow="hidden",Ct.always(function(){ir.overflow=k.overflow[0],ir.overflowX=k.overflow[1],ir.overflowY=k.overflow[2]})),Fe=!1;for(L in It)Fe||(er?"hidden"in er&&(Ir=er.hidden):er=Qn.access(C,"fxshow",{display:it}),Y&&(er.hidden=!Ir),Ir&&Jo([C],!0),Ct.done(function(){Ir||Jo([C]),Qn.remove(C,"fxshow");for(L in It)N.style(C,L,It[L])})),Fe=Dl(Ir?er[L]:0,L,Ct),L in er||(er[L]=Fe.start,Ir&&(Fe.end=Fe.start,Fe.start=0))}}function uf(C,M){var k,L,W,Y,re;for(k in C)if(L=Bi(k),W=M[L],Y=C[k],Array.isArray(Y)&&(W=Y[1],Y=C[k]=Y[0]),k!==L&&(C[L]=Y,delete C[k]),re=N.cssHooks[L],re&&"expand"in re){Y=re.expand(Y),delete C[L];for(k in Y)k in C||(C[k]=Y[k],M[k]=W)}else M[L]=W}function ko(C,M,k){var L,W,Y=0,re=ko.prefilters.length,Ge=N.Deferred().always(function(){delete Fe.elem}),Fe=function(){if(W)return!1;for(var Qt=Ja||cf(),Ct=Math.max(0,it.startTime+it.duration-Qt),It=Ct/it.duration||0,ir=1-It,Ir=0,er=it.tweens.length;Ir<er;Ir++)it.tweens[Ir].run(ir);return Ge.notifyWith(C,[it,ir,Ct]),ir<1&&er?Ct:(er||Ge.notifyWith(C,[it,1,0]),Ge.resolveWith(C,[it]),!1)},it=Ge.promise({elem:C,props:N.extend({},M),opts:N.extend(!0,{specialEasing:{},easing:N.easing._default},k),originalProperties:M,originalOptions:k,startTime:Ja||cf(),duration:k.duration,tweens:[],createTween:function(Qt,Ct){var It=N.Tween(C,it.opts,Qt,Ct,it.opts.specialEasing[Qt]||it.opts.easing);return it.tweens.push(It),It},stop:function(Qt){var Ct=0,It=Qt?it.tweens.length:0;if(W)return this;for(W=!0;Ct<It;Ct++)it.tweens[Ct].run(1);return Qt?(Ge.notifyWith(C,[it,1,0]),Ge.resolveWith(C,[it,Qt])):Ge.rejectWith(C,[it,Qt]),this}}),At=it.props;for(uf(At,it.opts.specialEasing);Y<re;Y++)if(L=ko.prefilters[Y].call(it,C,At,it.opts),L)return Q(L.stop)&&(N._queueHooks(it.elem,it.opts.queue).stop=L.stop.bind(L)),L;return N.map(At,Dl,it),Q(it.opts.start)&&it.opts.start.call(C,it),it.progress(it.opts.progress).done(it.opts.done,it.opts.complete).fail(it.opts.fail).always(it.opts.always),N.fx.timer(N.extend(Fe,{elem:C,anim:it,queue:it.opts.queue})),it}N.Animation=N.extend(ko,{tweeners:{"*":[function(C,M){var k=this.createTween(C,M);return qo(k.elem,C,Tl.exec(M),k),k}]},tweener:function(C,M){Q(C)?(M=C,C=["*"]):C=C.match(_n);for(var k,L=0,W=C.length;L<W;L++)k=C[L],ko.tweeners[k]=ko.tweeners[k]||[],ko.tweeners[k].unshift(M)},prefilters:[Kd],prefilter:function(C,M){M?ko.prefilters.unshift(C):ko.prefilters.push(C)}}),N.speed=function(C,M,k){var L=C&&typeof C=="object"?N.extend({},C):{complete:k||!k&&M||Q(C)&&C,duration:C,easing:k&&M||M&&!Q(M)&&M};return N.fx.off?L.duration=0:typeof L.duration!="number"&&(L.duration in N.fx.speeds?L.duration=N.fx.speeds[L.duration]:L.duration=N.fx.speeds._default),(L.queue==null||L.queue===!0)&&(L.queue="fx"),L.old=L.complete,L.complete=function(){Q(L.old)&&L.old.call(this),L.queue&&N.dequeue(this,L.queue)},L},N.fn.extend({fadeTo:function(C,M,k,L){return this.filter(Ys).css("opacity",0).show().end().animate({opacity:M},C,k,L)},animate:function(C,M,k,L){var W=N.isEmptyObject(C),Y=N.speed(M,k,L),re=function(){var Ge=ko(this,N.extend({},C),Y);(W||Qn.get(this,"finish"))&&Ge.stop(!0)};return re.finish=re,W||Y.queue===!1?this.each(re):this.queue(Y.queue,re)},stop:function(C,M,k){var L=function(W){var Y=W.stop;delete W.stop,Y(k)};return typeof C!="string"&&(k=M,M=C,C=void 0),M&&this.queue(C||"fx",[]),this.each(function(){var W=!0,Y=C!=null&&C+"queueHooks",re=N.timers,Ge=Qn.get(this);if(Y)Ge[Y]&&Ge[Y].stop&&L(Ge[Y]);else for(Y in Ge)Ge[Y]&&Ge[Y].stop&&$u.test(Y)&&L(Ge[Y]);for(Y=re.length;Y--;)re[Y].elem===this&&(C==null||re[Y].queue===C)&&(re[Y].anim.stop(k),W=!1,re.splice(Y,1));(W||!k)&&N.dequeue(this,C)})},finish:function(C){return C!==!1&&(C=C||"fx"),this.each(function(){var M,k=Qn.get(this),L=k[C+"queue"],W=k[C+"queueHooks"],Y=N.timers,re=L?L.length:0;for(k.finish=!0,N.queue(this,C,[]),W&&W.stop&&W.stop.call(this,!0),M=Y.length;M--;)Y[M].elem===this&&Y[M].queue===C&&(Y[M].anim.stop(!0),Y.splice(M,1));for(M=0;M<re;M++)L[M]&&L[M].finish&&L[M].finish.call(this);delete k.finish})}}),N.each(["toggle","show","hide"],function(C,M){var k=N.fn[M];N.fn[M]=function(L,W,Y){return L==null||typeof L=="boolean"?k.apply(this,arguments):this.animate(Yd(M,!0),L,W,Y)}}),N.each({slideDown:Yd("show"),slideUp:Yd("hide"),slideToggle:Yd("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(C,M){N.fn[C]=function(k,L,W){return this.animate(M,k,L,W)}}),N.timers=[],N.fx.tick=function(){var C,M=0,k=N.timers;for(Ja=Date.now();M<k.length;M++)C=k[M],!C()&&k[M]===C&&k.splice(M--,1);k.length||N.fx.stop(),Ja=void 0},N.fx.timer=function(C){N.timers.push(C),N.fx.start()},N.fx.interval=13,N.fx.start=function(){to||(to=!0,Wu())},N.fx.stop=function(){to=null},N.fx.speeds={slow:600,fast:200,_default:400},N.fn.delay=function(C,M){return C=N.fx&&N.fx.speeds[C]||C,M=M||"fx",this.queue(M,function(k,L){var W=H.setTimeout(k,C);L.stop=function(){H.clearTimeout(W)}})},function(){var C=he.createElement("input"),M=he.createElement("select"),k=M.appendChild(he.createElement("option"));C.type="checkbox",le.checkOn=C.value!=="",le.optSelected=k.selected,C=he.createElement("input"),C.value="t",C.type="radio",le.radioValue=C.value==="t"}();var df,uc=N.expr.attrHandle;N.fn.extend({attr:function(C,M){return Xi(this,N.attr,C,M,arguments.length>1)},removeAttr:function(C){return this.each(function(){N.removeAttr(this,C)})}}),N.extend({attr:function(C,M,k){var L,W,Y=C.nodeType;if(!(Y===3||Y===8||Y===2)){if(typeof C.getAttribute>"u")return N.prop(C,M,k);if((Y!==1||!N.isXMLDoc(C))&&(W=N.attrHooks[M.toLowerCase()]||(N.expr.match.bool.test(M)?df:void 0)),k!==void 0){if(k===null){N.removeAttr(C,M);return}return W&&"set"in W&&(L=W.set(C,k,M))!==void 0?L:(C.setAttribute(M,k+""),k)}return W&&"get"in W&&(L=W.get(C,M))!==null?L:(L=N.find.attr(C,M),L??void 0)}},attrHooks:{type:{set:function(C,M){if(!le.radioValue&&M==="radio"&&we(C,"input")){var k=C.value;return C.setAttribute("type",M),k&&(C.value=k),M}}}},removeAttr:function(C,M){var k,L=0,W=M&&M.match(_n);if(W&&C.nodeType===1)for(;k=W[L++];)C.removeAttribute(k)}}),df={set:function(C,M,k){return M===!1?N.removeAttr(C,k):C.setAttribute(k,k),k}},N.each(N.expr.match.bool.source.match(/\w+/g),function(C,M){var k=uc[M]||N.find.attr;uc[M]=function(L,W,Y){var re,Ge,Fe=W.toLowerCase();return Y||(Ge=uc[Fe],uc[Fe]=re,re=k(L,W,Y)!=null?Fe:null,uc[Fe]=Ge),re}});var dc=/^(?:input|select|textarea|button)$/i,_l=/^(?:a|area)$/i;N.fn.extend({prop:function(C,M){return Xi(this,N.prop,C,M,arguments.length>1)},removeProp:function(C){return this.each(function(){delete this[N.propFix[C]||C]})}}),N.extend({prop:function(C,M,k){var L,W,Y=C.nodeType;if(!(Y===3||Y===8||Y===2))return(Y!==1||!N.isXMLDoc(C))&&(M=N.propFix[M]||M,W=N.propHooks[M]),k!==void 0?W&&"set"in W&&(L=W.set(C,k,M))!==void 0?L:C[M]=k:W&&"get"in W&&(L=W.get(C,M))!==null?L:C[M]},propHooks:{tabIndex:{get:function(C){var M=N.find.attr(C,"tabindex");return M?parseInt(M,10):dc.test(C.nodeName)||_l.test(C.nodeName)&&C.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),le.optSelected||(N.propHooks.selected={get:function(C){var M=C.parentNode;return M&&M.parentNode&&M.parentNode.selectedIndex,null},set:function(C){var M=C.parentNode;M&&(M.selectedIndex,M.parentNode&&M.parentNode.selectedIndex)}}),N.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){N.propFix[this.toLowerCase()]=this});function no(C){var M=C.match(_n)||[];return M.join(" ")}function wo(C){return C.getAttribute&&C.getAttribute("class")||""}function Nl(C){return Array.isArray(C)?C:typeof C=="string"?C.match(_n)||[]:[]}N.fn.extend({addClass:function(C){var M,k,L,W,Y,re;return Q(C)?this.each(function(Ge){N(this).addClass(C.call(this,Ge,wo(this)))}):(M=Nl(C),M.length?this.each(function(){if(L=wo(this),k=this.nodeType===1&&" "+no(L)+" ",k){for(Y=0;Y<M.length;Y++)W=M[Y],k.indexOf(" "+W+" ")<0&&(k+=W+" ");re=no(k),L!==re&&this.setAttribute("class",re)}}):this)},removeClass:function(C){var M,k,L,W,Y,re;return Q(C)?this.each(function(Ge){N(this).removeClass(C.call(this,Ge,wo(this)))}):arguments.length?(M=Nl(C),M.length?this.each(function(){if(L=wo(this),k=this.nodeType===1&&" "+no(L)+" ",k){for(Y=0;Y<M.length;Y++)for(W=M[Y];k.indexOf(" "+W+" ")>-1;)k=k.replace(" "+W+" "," ");re=no(k),L!==re&&this.setAttribute("class",re)}}):this):this.attr("class","")},toggleClass:function(C,M){var k,L,W,Y,re=typeof C,Ge=re==="string"||Array.isArray(C);return Q(C)?this.each(function(Fe){N(this).toggleClass(C.call(this,Fe,wo(this),M),M)}):typeof M=="boolean"&&Ge?M?this.addClass(C):this.removeClass(C):(k=Nl(C),this.each(function(){if(Ge)for(Y=N(this),W=0;W<k.length;W++)L=k[W],Y.hasClass(L)?Y.removeClass(L):Y.addClass(L);else(C===void 0||re==="boolean")&&(L=wo(this),L&&Qn.set(this,"__className__",L),this.setAttribute&&this.setAttribute("class",L||C===!1?"":Qn.get(this,"__className__")||""))}))},hasClass:function(C){var M,k,L=0;for(M=" "+C+" ";k=this[L++];)if(k.nodeType===1&&(" "+no(wo(k))+" ").indexOf(M)>-1)return!0;return!1}});var Js=/\r/g;N.fn.extend({val:function(C){var M,k,L,W=this[0];return arguments.length?(L=Q(C),this.each(function(Y){var re;this.nodeType===1&&(L?re=C.call(this,Y,N(this).val()):re=C,re==null?re="":typeof re=="number"?re+="":Array.isArray(re)&&(re=N.map(re,function(Ge){return Ge==null?"":Ge+""})),M=N.valHooks[this.type]||N.valHooks[this.nodeName.toLowerCase()],(!M||!("set"in M)||M.set(this,re,"value")===void 0)&&(this.value=re))})):W?(M=N.valHooks[W.type]||N.valHooks[W.nodeName.toLowerCase()],M&&"get"in M&&(k=M.get(W,"value"))!==void 0?k:(k=W.value,typeof k=="string"?k.replace(Js,""):k??"")):void 0}}),N.extend({valHooks:{option:{get:function(C){var M=N.find.attr(C,"value");return M??no(N.text(C))}},select:{get:function(C){var M,k,L,W=C.options,Y=C.selectedIndex,re=C.type==="select-one",Ge=re?null:[],Fe=re?Y+1:W.length;for(Y<0?L=Fe:L=re?Y:0;L<Fe;L++)if(k=W[L],(k.selected||L===Y)&&!k.disabled&&(!k.parentNode.disabled||!we(k.parentNode,"optgroup"))){if(M=N(k).val(),re)return M;Ge.push(M)}return Ge},set:function(C,M){for(var k,L,W=C.options,Y=N.makeArray(M),re=W.length;re--;)L=W[re],(L.selected=N.inArray(N.valHooks.option.get(L),Y)>-1)&&(k=!0);return k||(C.selectedIndex=-1),Y}}}}),N.each(["radio","checkbox"],function(){N.valHooks[this]={set:function(C,M){if(Array.isArray(M))return C.checked=N.inArray(N(C).val(),M)>-1}},le.checkOn||(N.valHooks[this].get=function(C){return C.getAttribute("value")===null?"on":C.value})}),le.focusin="onfocusin"in H;var qd=/^(?:focusinfocus|focusoutblur)$/,qc=function(C){C.stopPropagation()};N.extend(N.event,{trigger:function(C,M,k,L){var W,Y,re,Ge,Fe,it,At,Qt,Ct=[k||he],It=oe.call(C,"type")?C.type:C,ir=oe.call(C,"namespace")?C.namespace.split("."):[];if(Y=Qt=re=k=k||he,!(k.nodeType===3||k.nodeType===8)&&!qd.test(It+N.event.triggered)&&(It.indexOf(".")>-1&&(ir=It.split("."),It=ir.shift(),ir.sort()),Fe=It.indexOf(":")<0&&"on"+It,C=C[N.expando]?C:new N.Event(It,typeof C=="object"&&C),C.isTrigger=L?2:3,C.namespace=ir.join("."),C.rnamespace=C.namespace?new RegExp("(^|\\.)"+ir.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,C.result=void 0,C.target||(C.target=k),M=M==null?[C]:N.makeArray(M,[C]),At=N.event.special[It]||{},!(!L&&At.trigger&&At.trigger.apply(k,M)===!1))){if(!L&&!At.noBubble&&!ne(k)){for(Ge=At.delegateType||It,qd.test(Ge+It)||(Y=Y.parentNode);Y;Y=Y.parentNode)Ct.push(Y),re=Y;re===(k.ownerDocument||he)&&Ct.push(re.defaultView||re.parentWindow||H)}for(W=0;(Y=Ct[W++])&&!C.isPropagationStopped();)Qt=Y,C.type=W>1?Ge:At.bindType||It,it=(Qn.get(Y,"events")||Object.create(null))[C.type]&&Qn.get(Y,"handle"),it&&it.apply(Y,M),it=Fe&&Y[Fe],it&&it.apply&&Qr(Y)&&(C.result=it.apply(Y,M),C.result===!1&&C.preventDefault());return C.type=It,!L&&!C.isDefaultPrevented()&&(!At._default||At._default.apply(Ct.pop(),M)===!1)&&Qr(k)&&Fe&&Q(k[It])&&!ne(k)&&(re=k[Fe],re&&(k[Fe]=null),N.event.triggered=It,C.isPropagationStopped()&&Qt.addEventListener(It,qc),k[It](),C.isPropagationStopped()&&Qt.removeEventListener(It,qc),N.event.triggered=void 0,re&&(k[Fe]=re)),C.result}},simulate:function(C,M,k){var L=N.extend(new N.Event,k,{type:C,isSimulated:!0});N.event.trigger(L,null,M)}}),N.fn.extend({trigger:function(C,M){return this.each(function(){N.event.trigger(C,M,this)})},triggerHandler:function(C,M){var k=this[0];if(k)return N.event.trigger(C,M,k,!0)}}),le.focusin||N.each({focus:"focusin",blur:"focusout"},function(C,M){var k=function(L){N.event.simulate(M,L.target,N.event.fix(L))};N.event.special[M]={setup:function(){var L=this.ownerDocument||this.document||this,W=Qn.access(L,M);W||L.addEventListener(C,k,!0),Qn.access(L,M,(W||0)+1)},teardown:function(){var L=this.ownerDocument||this.document||this,W=Qn.access(L,M)-1;W?Qn.access(L,M,W):(L.removeEventListener(C,k,!0),Qn.remove(L,M))}}});var hc=H.location,Jc={guid:Date.now()},Qa=/\?/;N.parseXML=function(C){var M,k;if(!C||typeof C!="string")return null;try{M=new H.DOMParser().parseFromString(C,"text/xml")}catch{}return k=M&&M.getElementsByTagName("parsererror")[0],(!M||k)&&N.error("Invalid XML: "+(k?N.map(k.childNodes,function(L){return L.textContent}).join(`
`):C)),M};var Zu=/\[\]$/,hf=/\r?\n/g,Bp=/^(?:submit|button|image|reset|file)$/i,ff=/^(?:input|select|textarea|keygen)/i;function Jd(C,M,k,L){var W;if(Array.isArray(M))N.each(M,function(Y,re){k||Zu.test(C)?L(C,re):Jd(C+"["+(typeof re=="object"&&re!=null?Y:"")+"]",re,k,L)});else if(!k&&De(M)==="object")for(W in M)Jd(C+"["+W+"]",M[W],k,L);else L(C,M)}N.param=function(C,M){var k,L=[],W=function(Y,re){var Ge=Q(re)?re():re;L[L.length]=encodeURIComponent(Y)+"="+encodeURIComponent(Ge??"")};if(C==null)return"";if(Array.isArray(C)||C.jquery&&!N.isPlainObject(C))N.each(C,function(){W(this.name,this.value)});else for(k in C)Jd(k,C[k],M,W);return L.join("&")},N.fn.extend({serialize:function(){return N.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var C=N.prop(this,"elements");return C?N.makeArray(C):this}).filter(function(){var C=this.type;return this.name&&!N(this).is(":disabled")&&ff.test(this.nodeName)&&!Bp.test(C)&&(this.checked||!Ks.test(C))}).map(function(C,M){var k=N(this).val();return k==null?null:Array.isArray(k)?N.map(k,function(L){return{name:M.name,value:L.replace(hf,`\r
`)}}):{name:M.name,value:k.replace(hf,`\r
`)}}).get()}});var pf=/%20/g,zp=/#.*$/,Qd=/([?&])_=[^&]*/,ua=/^(.*?):[ \t]*([^\r\n]*)$/mg,Qs=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,fc=/^(?:GET|HEAD)$/,Xu=/^\/\//,Yu={},Ki={},Ku="*/".concat("*"),qu=he.createElement("a");qu.href=hc.href;function Pi(C){return function(M,k){typeof M!="string"&&(k=M,M="*");var L,W=0,Y=M.toLowerCase().match(_n)||[];if(Q(k))for(;L=Y[W++];)L[0]==="+"?(L=L.slice(1)||"*",(C[L]=C[L]||[]).unshift(k)):(C[L]=C[L]||[]).push(k)}}function da(C,M,k,L){var W={},Y=C===Ki;function re(Ge){var Fe;return W[Ge]=!0,N.each(C[Ge]||[],function(it,At){var Qt=At(M,k,L);if(typeof Qt=="string"&&!Y&&!W[Qt])return M.dataTypes.unshift(Qt),re(Qt),!1;if(Y)return!(Fe=Qt)}),Fe}return re(M.dataTypes[0])||!W["*"]&&re("*")}function kl(C,M){var k,L,W=N.ajaxSettings.flatOptions||{};for(k in M)M[k]!==void 0&&((W[k]?C:L||(L={}))[k]=M[k]);return L&&N.extend(!0,C,L),C}function Rl(C,M,k){for(var L,W,Y,re,Ge=C.contents,Fe=C.dataTypes;Fe[0]==="*";)Fe.shift(),L===void 0&&(L=C.mimeType||M.getResponseHeader("Content-Type"));if(L){for(W in Ge)if(Ge[W]&&Ge[W].test(L)){Fe.unshift(W);break}}if(Fe[0]in k)Y=Fe[0];else{for(W in k){if(!Fe[0]||C.converters[W+" "+Fe[0]]){Y=W;break}re||(re=W)}Y=Y||re}if(Y)return Y!==Fe[0]&&Fe.unshift(Y),k[Y]}function Qc(C,M,k,L){var W,Y,re,Ge,Fe,it={},At=C.dataTypes.slice();if(At[1])for(re in C.converters)it[re.toLowerCase()]=C.converters[re];for(Y=At.shift();Y;)if(C.responseFields[Y]&&(k[C.responseFields[Y]]=M),!Fe&&L&&C.dataFilter&&(M=C.dataFilter(M,C.dataType)),Fe=Y,Y=At.shift(),Y){if(Y==="*")Y=Fe;else if(Fe!=="*"&&Fe!==Y){if(re=it[Fe+" "+Y]||it["* "+Y],!re){for(W in it)if(Ge=W.split(" "),Ge[1]===Y&&(re=it[Fe+" "+Ge[0]]||it["* "+Ge[0]],re)){re===!0?re=it[W]:it[W]!==!0&&(Y=Ge[0],At.unshift(Ge[1]));break}}if(re!==!0)if(re&&C.throws)M=re(M);else try{M=re(M)}catch(Qt){return{state:"parsererror",error:re?Qt:"No conversion from "+Fe+" to "+Y}}}}return{state:"success",data:M}}N.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:hc.href,type:"GET",isLocal:Qs.test(hc.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ku,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":N.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(C,M){return M?kl(kl(C,N.ajaxSettings),M):kl(N.ajaxSettings,C)},ajaxPrefilter:Pi(Yu),ajaxTransport:Pi(Ki),ajax:function(C,M){typeof C=="object"&&(M=C,C=void 0),M=M||{};var k,L,W,Y,re,Ge,Fe,it,At,Qt,Ct=N.ajaxSetup({},M),It=Ct.context||Ct,ir=Ct.context&&(It.nodeType||It.jquery)?N(It):N.event,Ir=N.Deferred(),er=N.Callbacks("once memory"),Eo=Ct.statusCode||{},So={},Fs={},br="canceled",Nr={readyState:0,getResponseHeader:function(Gr){var Vi;if(Fe){if(!Y)for(Y={};Vi=ua.exec(W);)Y[Vi[1].toLowerCase()+" "]=(Y[Vi[1].toLowerCase()+" "]||[]).concat(Vi[2]);Vi=Y[Gr.toLowerCase()+" "]}return Vi==null?null:Vi.join(", ")},getAllResponseHeaders:function(){return Fe?W:null},setRequestHeader:function(Gr,Vi){return Fe==null&&(Gr=Fs[Gr.toLowerCase()]=Fs[Gr.toLowerCase()]||Gr,So[Gr]=Vi),this},overrideMimeType:function(Gr){return Fe==null&&(Ct.mimeType=Gr),this},statusCode:function(Gr){var Vi;if(Gr)if(Fe)Nr.always(Gr[Nr.status]);else for(Vi in Gr)Eo[Vi]=[Eo[Vi],Gr[Vi]];return this},abort:function(Gr){var Vi=Gr||br;return k&&k.abort(Vi),Ts(0,Vi),this}};if(Ir.promise(Nr),Ct.url=((C||Ct.url||hc.href)+"").replace(Xu,hc.protocol+"//"),Ct.type=M.method||M.type||Ct.method||Ct.type,Ct.dataTypes=(Ct.dataType||"*").toLowerCase().match(_n)||[""],Ct.crossDomain==null){Ge=he.createElement("a");try{Ge.href=Ct.url,Ge.href=Ge.href,Ct.crossDomain=qu.protocol+"//"+qu.host!=Ge.protocol+"//"+Ge.host}catch{Ct.crossDomain=!0}}if(Ct.data&&Ct.processData&&typeof Ct.data!="string"&&(Ct.data=N.param(Ct.data,Ct.traditional)),da(Yu,Ct,M,Nr),Fe)return Nr;it=N.event&&Ct.global,it&&N.active++===0&&N.event.trigger("ajaxStart"),Ct.type=Ct.type.toUpperCase(),Ct.hasContent=!fc.test(Ct.type),L=Ct.url.replace(zp,""),Ct.hasContent?Ct.data&&Ct.processData&&(Ct.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Ct.data=Ct.data.replace(pf,"+")):(Qt=Ct.url.slice(L.length),Ct.data&&(Ct.processData||typeof Ct.data=="string")&&(L+=(Qa.test(L)?"&":"?")+Ct.data,delete Ct.data),Ct.cache===!1&&(L=L.replace(Qd,"$1"),Qt=(Qa.test(L)?"&":"?")+"_="+Jc.guid+++Qt),Ct.url=L+Qt),Ct.ifModified&&(N.lastModified[L]&&Nr.setRequestHeader("If-Modified-Since",N.lastModified[L]),N.etag[L]&&Nr.setRequestHeader("If-None-Match",N.etag[L])),(Ct.data&&Ct.hasContent&&Ct.contentType!==!1||M.contentType)&&Nr.setRequestHeader("Content-Type",Ct.contentType),Nr.setRequestHeader("Accept",Ct.dataTypes[0]&&Ct.accepts[Ct.dataTypes[0]]?Ct.accepts[Ct.dataTypes[0]]+(Ct.dataTypes[0]!=="*"?", "+Ku+"; q=0.01":""):Ct.accepts["*"]);for(At in Ct.headers)Nr.setRequestHeader(At,Ct.headers[At]);if(Ct.beforeSend&&(Ct.beforeSend.call(It,Nr,Ct)===!1||Fe))return Nr.abort();if(br="abort",er.add(Ct.complete),Nr.done(Ct.success),Nr.fail(Ct.error),k=da(Ki,Ct,M,Nr),!k)Ts(-1,"No Transport");else{if(Nr.readyState=1,it&&ir.trigger("ajaxSend",[Nr,Ct]),Fe)return Nr;Ct.async&&Ct.timeout>0&&(re=H.setTimeout(function(){Nr.abort("timeout")},Ct.timeout));try{Fe=!1,k.send(So,Ts)}catch(Gr){if(Fe)throw Gr;Ts(-1,Gr)}}function Ts(Gr,Vi,tl,La){var vs,xa,ha,ts,Li,ro=Vi;Fe||(Fe=!0,re&&H.clearTimeout(re),k=void 0,W=La||"",Nr.readyState=Gr>0?4:0,vs=Gr>=200&&Gr<300||Gr===304,tl&&(ts=Rl(Ct,Nr,tl)),!vs&&N.inArray("script",Ct.dataTypes)>-1&&N.inArray("json",Ct.dataTypes)<0&&(Ct.converters["text script"]=function(){}),ts=Qc(Ct,ts,Nr,vs),vs?(Ct.ifModified&&(Li=Nr.getResponseHeader("Last-Modified"),Li&&(N.lastModified[L]=Li),Li=Nr.getResponseHeader("etag"),Li&&(N.etag[L]=Li)),Gr===204||Ct.type==="HEAD"?ro="nocontent":Gr===304?ro="notmodified":(ro=ts.state,xa=ts.data,ha=ts.error,vs=!ha)):(ha=ro,(Gr||!ro)&&(ro="error",Gr<0&&(Gr=0))),Nr.status=Gr,Nr.statusText=(Vi||ro)+"",vs?Ir.resolveWith(It,[xa,ro,Nr]):Ir.rejectWith(It,[Nr,ro,ha]),Nr.statusCode(Eo),Eo=void 0,it&&ir.trigger(vs?"ajaxSuccess":"ajaxError",[Nr,Ct,vs?xa:ha]),er.fireWith(It,[Nr,ro]),it&&(ir.trigger("ajaxComplete",[Nr,Ct]),--N.active||N.event.trigger("ajaxStop")))}return Nr},getJSON:function(C,M,k){return N.get(C,M,k,"json")},getScript:function(C,M){return N.get(C,void 0,M,"script")}}),N.each(["get","post"],function(C,M){N[M]=function(k,L,W,Y){return Q(L)&&(Y=Y||W,W=L,L=void 0),N.ajax(N.extend({url:k,type:M,dataType:Y,data:L,success:W},N.isPlainObject(k)&&k))}}),N.ajaxPrefilter(function(C){var M;for(M in C.headers)M.toLowerCase()==="content-type"&&(C.contentType=C.headers[M]||"")}),N._evalUrl=function(C,M,k){return N.ajax({url:C,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(L){N.globalEval(L,M,k)}})},N.fn.extend({wrapAll:function(C){var M;return this[0]&&(Q(C)&&(C=C.call(this[0])),M=N(C,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&M.insertBefore(this[0]),M.map(function(){for(var k=this;k.firstElementChild;)k=k.firstElementChild;return k}).append(this)),this},wrapInner:function(C){return Q(C)?this.each(function(M){N(this).wrapInner(C.call(this,M))}):this.each(function(){var M=N(this),k=M.contents();k.length?k.wrapAll(C):M.append(C)})},wrap:function(C){var M=Q(C);return this.each(function(k){N(this).wrapAll(M?C.call(this,k):C)})},unwrap:function(C){return this.parent(C).not("body").each(function(){N(this).replaceWith(this.childNodes)}),this}}),N.expr.pseudos.hidden=function(C){return!N.expr.pseudos.visible(C)},N.expr.pseudos.visible=function(C){return!!(C.offsetWidth||C.offsetHeight||C.getClientRects().length)},N.ajaxSettings.xhr=function(){try{return new H.XMLHttpRequest}catch{}};var Ju={0:200,1223:204},Il=N.ajaxSettings.xhr();le.cors=!!Il&&"withCredentials"in Il,le.ajax=Il=!!Il,N.ajaxTransport(function(C){var M,k;if(le.cors||Il&&!C.crossDomain)return{send:function(L,W){var Y,re=C.xhr();if(re.open(C.type,C.url,C.async,C.username,C.password),C.xhrFields)for(Y in C.xhrFields)re[Y]=C.xhrFields[Y];C.mimeType&&re.overrideMimeType&&re.overrideMimeType(C.mimeType),!C.crossDomain&&!L["X-Requested-With"]&&(L["X-Requested-With"]="XMLHttpRequest");for(Y in L)re.setRequestHeader(Y,L[Y]);M=function(Ge){return function(){M&&(M=k=re.onload=re.onerror=re.onabort=re.ontimeout=re.onreadystatechange=null,Ge==="abort"?re.abort():Ge==="error"?typeof re.status!="number"?W(0,"error"):W(re.status,re.statusText):W(Ju[re.status]||re.status,re.statusText,(re.responseType||"text")!=="text"||typeof re.responseText!="string"?{binary:re.response}:{text:re.responseText},re.getAllResponseHeaders()))}},re.onload=M(),k=re.onerror=re.ontimeout=M("error"),re.onabort!==void 0?re.onabort=k:re.onreadystatechange=function(){re.readyState===4&&H.setTimeout(function(){M&&k()})},M=M("abort");try{re.send(C.hasContent&&C.data||null)}catch(Ge){if(M)throw Ge}},abort:function(){M&&M()}}}),N.ajaxPrefilter(function(C){C.crossDomain&&(C.contents.script=!1)}),N.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(C){return N.globalEval(C),C}}}),N.ajaxPrefilter("script",function(C){C.cache===void 0&&(C.cache=!1),C.crossDomain&&(C.type="GET")}),N.ajaxTransport("script",function(C){if(C.crossDomain||C.scriptAttrs){var M,k;return{send:function(L,W){M=N("<script>").attr(C.scriptAttrs||{}).prop({charset:C.scriptCharset,src:C.url}).on("load error",k=function(Y){M.remove(),k=null,Y&&W(Y.type==="error"?404:200,Y.type)}),he.head.appendChild(M[0])},abort:function(){k&&k()}}}});var ea=[],el=/(=)\?(?=&|$)|\?\?/;N.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var C=ea.pop()||N.expando+"_"+Jc.guid++;return this[C]=!0,C}}),N.ajaxPrefilter("json jsonp",function(C,M,k){var L,W,Y,re=C.jsonp!==!1&&(el.test(C.url)?"url":typeof C.data=="string"&&(C.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&el.test(C.data)&&"data");if(re||C.dataTypes[0]==="jsonp")return L=C.jsonpCallback=Q(C.jsonpCallback)?C.jsonpCallback():C.jsonpCallback,re?C[re]=C[re].replace(el,"$1"+L):C.jsonp!==!1&&(C.url+=(Qa.test(C.url)?"&":"?")+C.jsonp+"="+L),C.converters["script json"]=function(){return Y||N.error(L+" was not called"),Y[0]},C.dataTypes[0]="json",W=H[L],H[L]=function(){Y=arguments},k.always(function(){W===void 0?N(H).removeProp(L):H[L]=W,C[L]&&(C.jsonpCallback=M.jsonpCallback,ea.push(L)),Y&&Q(W)&&W(Y[0]),Y=W=void 0}),"script"}),le.createHTMLDocument=function(){var C=he.implementation.createHTMLDocument("").body;return C.innerHTML="<form></form><form></form>",C.childNodes.length===2}(),N.parseHTML=function(C,M,k){if(typeof C!="string")return[];typeof M=="boolean"&&(k=M,M=!1);var L,W,Y;return M||(le.createHTMLDocument?(M=he.implementation.createHTMLDocument(""),L=M.createElement("base"),L.href=he.location.href,M.head.appendChild(L)):M=he),W=Bn.exec(C),Y=!k&&[],W?[M.createElement(W[1])]:(W=ef([C],M,Y),Y&&Y.length&&N(Y).remove(),N.merge([],W.childNodes))},N.fn.load=function(C,M,k){var L,W,Y,re=this,Ge=C.indexOf(" ");return Ge>-1&&(L=no(C.slice(Ge)),C=C.slice(0,Ge)),Q(M)?(k=M,M=void 0):M&&typeof M=="object"&&(W="POST"),re.length>0&&N.ajax({url:C,type:W||"GET",dataType:"html",data:M}).done(function(Fe){Y=arguments,re.html(L?N("<div>").append(N.parseHTML(Fe)).find(L):Fe)}).always(k&&function(Fe,it){re.each(function(){k.apply(this,Y||[Fe.responseText,it,Fe])})}),this},N.expr.pseudos.animated=function(C){return N.grep(N.timers,function(M){return C===M.elem}).length},N.offset={setOffset:function(C,M,k){var L,W,Y,re,Ge,Fe,it,At=N.css(C,"position"),Qt=N(C),Ct={};At==="static"&&(C.style.position="relative"),Ge=Qt.offset(),Y=N.css(C,"top"),Fe=N.css(C,"left"),it=(At==="absolute"||At==="fixed")&&(Y+Fe).indexOf("auto")>-1,it?(L=Qt.position(),re=L.top,W=L.left):(re=parseFloat(Y)||0,W=parseFloat(Fe)||0),Q(M)&&(M=M.call(C,k,N.extend({},Ge))),M.top!=null&&(Ct.top=M.top-Ge.top+re),M.left!=null&&(Ct.left=M.left-Ge.left+W),"using"in M?M.using.call(C,Ct):Qt.css(Ct)}},N.fn.extend({offset:function(C){if(arguments.length)return C===void 0?this:this.each(function(W){N.offset.setOffset(this,C,W)});var M,k,L=this[0];if(!!L)return L.getClientRects().length?(M=L.getBoundingClientRect(),k=L.ownerDocument.defaultView,{top:M.top+k.pageYOffset,left:M.left+k.pageXOffset}):{top:0,left:0}},position:function(){if(!!this[0]){var C,M,k,L=this[0],W={top:0,left:0};if(N.css(L,"position")==="fixed")M=L.getBoundingClientRect();else{for(M=this.offset(),k=L.ownerDocument,C=L.offsetParent||k.documentElement;C&&(C===k.body||C===k.documentElement)&&N.css(C,"position")==="static";)C=C.parentNode;C&&C!==L&&C.nodeType===1&&(W=N(C).offset(),W.top+=N.css(C,"borderTopWidth",!0),W.left+=N.css(C,"borderLeftWidth",!0))}return{top:M.top-W.top-N.css(L,"marginTop",!0),left:M.left-W.left-N.css(L,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var C=this.offsetParent;C&&N.css(C,"position")==="static";)C=C.offsetParent;return C||Ee})}}),N.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(C,M){var k=M==="pageYOffset";N.fn[C]=function(L){return Xi(this,function(W,Y,re){var Ge;if(ne(W)?Ge=W:W.nodeType===9&&(Ge=W.defaultView),re===void 0)return Ge?Ge[M]:W[Y];Ge?Ge.scrollTo(k?Ge.pageXOffset:re,k?re:Ge.pageYOffset):W[Y]=re},C,L,arguments.length)}}),N.each(["top","left"],function(C,M){N.cssHooks[M]=Hd(le.pixelPosition,function(k,L){if(L)return L=Hu(k,M),Vu.test(L)?N(k).position()[M]+"px":L})}),N.each({Height:"height",Width:"width"},function(C,M){N.each({padding:"inner"+C,content:M,"":"outer"+C},function(k,L){N.fn[L]=function(W,Y){var re=arguments.length&&(k||typeof W!="boolean"),Ge=k||(W===!0||Y===!0?"margin":"border");return Xi(this,function(Fe,it,At){var Qt;return ne(Fe)?L.indexOf("outer")===0?Fe["inner"+C]:Fe.document.documentElement["client"+C]:Fe.nodeType===9?(Qt=Fe.documentElement,Math.max(Fe.body["scroll"+C],Qt["scroll"+C],Fe.body["offset"+C],Qt["offset"+C],Qt["client"+C])):At===void 0?N.css(Fe,it,Ge):N.style(Fe,it,At,Ge)},M,re?W:void 0,re)}})}),N.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(C,M){N.fn[M]=function(k){return this.on(M,k)}}),N.fn.extend({bind:function(C,M,k){return this.on(C,null,M,k)},unbind:function(C,M){return this.off(C,null,M)},delegate:function(C,M,k,L){return this.on(M,C,k,L)},undelegate:function(C,M,k){return arguments.length===1?this.off(C,"**"):this.off(M,C||"**",k)},hover:function(C,M){return this.mouseenter(C).mouseleave(M||C)}}),N.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(C,M){N.fn[M]=function(k,L){return arguments.length>0?this.on(M,null,k,L):this.trigger(M)}});var Qu=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;N.proxy=function(C,M){var k,L,W;if(typeof M=="string"&&(k=C[M],M=C,C=k),!!Q(C))return L=ke.call(arguments,2),W=function(){return C.apply(M||this,L.concat(ke.call(arguments)))},W.guid=C.guid=C.guid||N.guid++,W},N.holdReady=function(C){C?N.readyWait++:N.ready(!0)},N.isArray=Array.isArray,N.parseJSON=JSON.parse,N.nodeName=we,N.isFunction=Q,N.isWindow=ne,N.camelCase=Bi,N.type=De,N.now=Date.now,N.isNumeric=function(C){var M=N.type(C);return(M==="number"||M==="string")&&!isNaN(C-parseFloat(C))},N.trim=function(C){return C==null?"":(C+"").replace(Qu,"$1")},P=[],Z=function(){return N}.apply($,P),Z!==void 0&&(je.exports=Z);var gf=H.jQuery,mf=H.$;return N.noConflict=function(C){return H.$===N&&(H.$=mf),C&&H.jQuery===N&&(H.jQuery=gf),N},typeof J>"u"&&(H.jQuery=H.$=N),N})},47443:function(je,$,P){var Z=P(42118);function H(J,U){var pe=J==null?0:J.length;return!!pe&&Z(J,U,0)>-1}je.exports=H},1196:function(je){function $(P,Z,H){for(var J=-1,U=P==null?0:P.length;++J<U;)if(H(Z,P[J]))return!0;return!1}je.exports=$},41848:function(je){function $(P,Z,H,J){for(var U=P.length,pe=H+(J?1:-1);J?pe--:++pe<U;)if(Z(P[pe],pe,P))return pe;return-1}je.exports=$},42118:function(je,$,P){var Z=P(41848),H=P(62722),J=P(42351);function U(pe,ke,Ce){return ke===ke?J(pe,ke,Ce):Z(pe,H,Ce)}je.exports=U},62722:function(je){function $(P){return P!==P}je.exports=$},45652:function(je,$,P){var Z=P(88668),H=P(47443),J=P(1196),U=P(74757),pe=P(23593),ke=P(21814),Ce=200;function ge(Me,Se,ee){var oe=-1,Ae=H,X=Me.length,le=!0,Q=[],ne=Q;if(ee)le=!1,Ae=J;else if(X>=Ce){var he=Se?null:pe(Me);if(he)return ke(he);le=!1,Ae=U,ne=new Z}else ne=Se?[]:Q;e:for(;++oe<X;){var Ue=Me[oe],ce=Se?Se(Ue):Ue;if(Ue=ee||Ue!==0?Ue:0,le&&ce===ce){for(var De=ne.length;De--;)if(ne[De]===ce)continue e;Se&&ne.push(ce),Q.push(Ue)}else Ae(ne,ce,ee)||(ne!==Q&&ne.push(ce),Q.push(Ue))}return Q}je.exports=ge},23593:function(je,$,P){var Z=P(58525),H=P(50308),J=P(21814),U=1/0,pe=Z&&1/J(new Z([,-0]))[1]==U?function(ke){return new Z(ke)}:H;je.exports=pe},42351:function(je){function $(P,Z,H){for(var J=H-1,U=P.length;++J<U;)if(P[J]===Z)return J;return-1}je.exports=$},51584:function(je,$,P){var Z=P(44239),H=P(37005),J="[object Boolean]";function U(pe){return pe===!0||pe===!1||H(pe)&&Z(pe)==J}je.exports=U},50308:function(je){function $(){}je.exports=$},45578:function(je,$,P){var Z=P(11243),H=P(45652);function J(U,pe){return U&&U.length?H(U,Z(pe,2)):[]}je.exports=J},42441:function(je,$,P){var Z;(function(H,J,U){if(!H)return;for(var pe={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},ke={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ce={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},ge={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},Me,Se=1;Se<20;++Se)pe[111+Se]="f"+Se;for(Se=0;Se<=9;++Se)pe[Se+96]=Se.toString();function ee(ze,Ze,xt){if(ze.addEventListener){ze.addEventListener(Ze,xt,!1);return}ze.attachEvent("on"+Ze,xt)}function oe(ze){if(ze.type=="keypress"){var Ze=String.fromCharCode(ze.which);return ze.shiftKey||(Ze=Ze.toLowerCase()),Ze}return pe[ze.which]?pe[ze.which]:ke[ze.which]?ke[ze.which]:String.fromCharCode(ze.which).toLowerCase()}function Ae(ze,Ze){return ze.sort().join(",")===Ze.sort().join(",")}function X(ze){var Ze=[];return ze.shiftKey&&Ze.push("shift"),ze.altKey&&Ze.push("alt"),ze.ctrlKey&&Ze.push("ctrl"),ze.metaKey&&Ze.push("meta"),Ze}function le(ze){if(ze.preventDefault){ze.preventDefault();return}ze.returnValue=!1}function Q(ze){if(ze.stopPropagation){ze.stopPropagation();return}ze.cancelBubble=!0}function ne(ze){return ze=="shift"||ze=="ctrl"||ze=="alt"||ze=="meta"}function he(){if(!Me){Me={};for(var ze in pe)ze>95&&ze<112||pe.hasOwnProperty(ze)&&(Me[pe[ze]]=ze)}return Me}function Ue(ze,Ze,xt){return xt||(xt=he()[ze]?"keydown":"keypress"),xt=="keypress"&&Ze.length&&(xt="keydown"),xt}function ce(ze){return ze==="+"?["+"]:(ze=ze.replace(/\+{2}/g,"+plus"),ze.split("+"))}function De(ze,Ze){var xt,Zt,Kn,we=[];for(xt=ce(ze),Kn=0;Kn<xt.length;++Kn)Zt=xt[Kn],ge[Zt]&&(Zt=ge[Zt]),Ze&&Ze!="keypress"&&Ce[Zt]&&(Zt=Ce[Zt],we.push("shift")),ne(Zt)&&we.push(Zt);return Ze=Ue(Zt,we,Ze),{key:Zt,modifiers:we,action:Ze}}function _t(ze,Ze){return ze===null||ze===J?!1:ze===Ze?!0:_t(ze.parentNode,Ze)}function N(ze){var Ze=this;if(ze=ze||J,!(Ze instanceof N))return new N(ze);Ze.target=ze,Ze._callbacks={},Ze._directMap={};var xt={},Zt,Kn=!1,we=!1,Bn=!1;function Fr(_n){_n=_n||{};var gr=!1,Nn;for(Nn in xt){if(_n[Nn]){gr=!0;continue}xt[Nn]=0}gr||(Bn=!1)}function nn(_n,gr,Nn,yr,Or,Co){var _r,Mi,Xi=[],ms=Nn.type;if(!Ze._callbacks[_n])return[];for(ms=="keyup"&&ne(_n)&&(gr=[_n]),_r=0;_r<Ze._callbacks[_n].length;++_r)if(Mi=Ze._callbacks[_n][_r],!(!yr&&Mi.seq&&xt[Mi.seq]!=Mi.level)&&ms==Mi.action&&(ms=="keypress"&&!Nn.metaKey&&!Nn.ctrlKey||Ae(gr,Mi.modifiers))){var Xs=!yr&&Mi.combo==Or,Yi=yr&&Mi.seq==yr&&Mi.level==Co;(Xs||Yi)&&Ze._callbacks[_n].splice(_r,1),Xi.push(Mi)}return Xi}function Dn(_n,gr,Nn,yr){Ze.stopCallback(gr,gr.target||gr.srcElement,Nn,yr)||_n(gr,Nn)===!1&&(le(gr),Q(gr))}Ze._handleKey=function(_n,gr,Nn){var yr=nn(_n,gr,Nn),Or,Co={},_r=0,Mi=!1;for(Or=0;Or<yr.length;++Or)yr[Or].seq&&(_r=Math.max(_r,yr[Or].level));for(Or=0;Or<yr.length;++Or){if(yr[Or].seq){if(yr[Or].level!=_r)continue;Mi=!0,Co[yr[Or].seq]=1,Dn(yr[Or].callback,Nn,yr[Or].combo,yr[Or].seq);continue}Mi||Dn(yr[Or].callback,Nn,yr[Or].combo)}var Xi=Nn.type=="keypress"&&we;Nn.type==Bn&&!ne(_n)&&!Xi&&Fr(Co),we=Mi&&Nn.type=="keydown"};function yn(_n){typeof _n.which!="number"&&(_n.which=_n.keyCode);var gr=oe(_n);if(!!gr){if(_n.type=="keyup"&&Kn===gr){Kn=!1;return}Ze.handleKey(gr,X(_n),_n)}}function Rt(){clearTimeout(Zt),Zt=setTimeout(Fr,1e3)}function Sr(_n,gr,Nn,yr){xt[_n]=0;function Or(ms){return function(){Bn=ms,++xt[_n],Rt()}}function Co(ms){Dn(Nn,ms,_n),yr!=="keyup"&&(Kn=oe(ms)),setTimeout(Fr,10)}for(var _r=0;_r<gr.length;++_r){var Mi=_r+1===gr.length,Xi=Mi?Co:Or(yr||De(gr[_r+1]).action);pr(gr[_r],Xi,yr,_n,_r)}}function pr(_n,gr,Nn,yr,Or){Ze._directMap[_n+":"+Nn]=gr,_n=_n.replace(/\s+/g," ");var Co=_n.split(" "),_r;if(Co.length>1){Sr(_n,Co,gr,Nn);return}_r=De(_n,Nn),Ze._callbacks[_r.key]=Ze._callbacks[_r.key]||[],nn(_r.key,_r.modifiers,{type:_r.action},yr,_n,Or),Ze._callbacks[_r.key][yr?"unshift":"push"]({callback:gr,modifiers:_r.modifiers,action:_r.action,seq:yr,level:Or,combo:_n})}Ze._bindMultiple=function(_n,gr,Nn){for(var yr=0;yr<_n.length;++yr)pr(_n[yr],gr,Nn)},ee(ze,"keypress",yn),ee(ze,"keydown",yn),ee(ze,"keyup",yn)}N.prototype.bind=function(ze,Ze,xt){var Zt=this;return ze=ze instanceof Array?ze:[ze],Zt._bindMultiple.call(Zt,ze,Ze,xt),Zt},N.prototype.unbind=function(ze,Ze){var xt=this;return xt.bind.call(xt,ze,function(){},Ze)},N.prototype.trigger=function(ze,Ze){var xt=this;return xt._directMap[ze+":"+Ze]&&xt._directMap[ze+":"+Ze]({},ze),xt},N.prototype.reset=function(){var ze=this;return ze._callbacks={},ze._directMap={},ze},N.prototype.stopCallback=function(ze,Ze){var xt=this;if((" "+Ze.className+" ").indexOf(" mousetrap ")>-1||_t(Ze,xt.target))return!1;if("composedPath"in ze&&typeof ze.composedPath=="function"){var Zt=ze.composedPath()[0];Zt!==ze.target&&(Ze=Zt)}return Ze.tagName=="INPUT"||Ze.tagName=="SELECT"||Ze.tagName=="TEXTAREA"||Ze.isContentEditable},N.prototype.handleKey=function(){var ze=this;return ze._handleKey.apply(ze,arguments)},N.addKeycodes=function(ze){for(var Ze in ze)ze.hasOwnProperty(Ze)&&(pe[Ze]=ze[Ze]);Me=null},N.init=function(){var ze=N(J);for(var Ze in ze)Ze.charAt(0)!=="_"&&(N[Ze]=function(xt){return function(){return ze[xt].apply(ze,arguments)}}(Ze))},N.init(),H.Mousetrap=N,je.exports&&(je.exports=N),Z=function(){return N}.call($,P,$,je),Z!==U&&(je.exports=Z)})(typeof window<"u"?window:null,typeof window<"u"?document:null)},40582:function(je,$,P){var Z=P(89550),H=P(68854),J=P(36820),U=P(43650),pe=P(56601),ke=[0,0];je.exports.x7=function(ge,Me,Se,ee,oe){return Z(ge,Se,ee),J(ge,ge),H(Me,-ge[1],ge[0]),H(ke,-Se[1],Se[0]),oe/pe(Me,ke)},je.exports.mJ=function(ge,Me){return H(ge,-Me[1],Me[0]),ge},je.exports.o7=function(ge,Me,Se){return U(ge,Me,Se),J(ge,ge),ge}},81550:function(je){(function($,P){je.exports=P()})(this,function(){"use strict";var $=function(z){return z instanceof Uint8Array||z instanceof Uint16Array||z instanceof Uint32Array||z instanceof Int8Array||z instanceof Int16Array||z instanceof Int32Array||z instanceof Float32Array||z instanceof Float64Array||z instanceof Uint8ClampedArray},P=function(z,de){for(var _e=Object.keys(de),at=0;at<_e.length;++at)z[_e[at]]=de[_e[at]];return z},Z=`
`;function H(z){return typeof atob<"u"?atob(z):"base64:"+z}function J(z){var de=new Error("(regl) "+z);throw console.error(de),de}function U(z,de){z||J(de)}function pe(z){return z?": "+z:""}function ke(z,de,_e){z in de||J("unknown parameter ("+z+")"+pe(_e)+". possible values: "+Object.keys(de).join())}function Ce(z,de){$(z)||J("invalid parameter type"+pe(de)+". must be a typed array")}function ge(z,de){switch(de){case"number":return typeof z=="number";case"object":return typeof z=="object";case"string":return typeof z=="string";case"boolean":return typeof z=="boolean";case"function":return typeof z=="function";case"undefined":return typeof z>"u";case"symbol":return typeof z=="symbol"}}function Me(z,de,_e){ge(z,de)||J("invalid parameter type"+pe(_e)+". expected "+de+", got "+typeof z)}function Se(z,de){z>=0&&(z|0)===z||J("invalid parameter type, ("+z+")"+pe(de)+". must be a nonnegative integer")}function ee(z,de,_e){de.indexOf(z)<0&&J("invalid value"+pe(_e)+". must be one of: "+de)}var oe=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ae(z){Object.keys(z).forEach(function(de){oe.indexOf(de)<0&&J('invalid regl constructor argument "'+de+'". must be one of '+oe)})}function X(z,de){for(z=z+"";z.length<de;)z=" "+z;return z}function le(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Q(z,de){this.number=z,this.line=de,this.errors=[]}function ne(z,de,_e){this.file=z,this.line=de,this.message=_e}function he(){var z=new Error,de=(z.stack||z).toString(),_e=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(de);if(_e)return _e[1];var at=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(de);return at?at[1]:"unknown"}function Ue(){var z=new Error,de=(z.stack||z).toString(),_e=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(de);if(_e)return _e[1];var at=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(de);return at?at[1]:"unknown"}function ce(z,de){var _e=z.split(`
`),at=1,Tt=0,lt={unknown:new le,0:new le};lt.unknown.name=lt[0].name=de||he(),lt.unknown.lines.push(new Q(0,""));for(var mt=0;mt<_e.length;++mt){var zt=_e[mt],Ht=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(zt);if(Ht)switch(Ht[1]){case"line":var Kt=/(\d+)(\s+\d+)?/.exec(Ht[2]);Kt&&(at=Kt[1]|0,Kt[2]&&(Tt=Kt[2]|0,Tt in lt||(lt[Tt]=new le)));break;case"define":var $t=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Ht[2]);$t&&(lt[Tt].name=$t[1]?H($t[2]):$t[2]);break}lt[Tt].lines.push(new Q(at++,zt))}return Object.keys(lt).forEach(function(sn){var fn=lt[sn];fn.lines.forEach(function(Ut){fn.index[Ut.number]=Ut})}),lt}function De(z){var de=[];return z.split(`
`).forEach(function(_e){if(!(_e.length<5)){var at=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(_e);at?de.push(new ne(at[1]|0,at[2]|0,at[3].trim())):_e.length>0&&de.push(new ne("unknown",0,_e))}}),de}function _t(z,de){de.forEach(function(_e){var at=z[_e.file];if(at){var Tt=at.index[_e.line];if(Tt){Tt.errors.push(_e),at.hasErrors=!0;return}}z.unknown.hasErrors=!0,z.unknown.lines[0].errors.push(_e)})}function N(z,de,_e,at,Tt){if(!z.getShaderParameter(de,z.COMPILE_STATUS)){var lt=z.getShaderInfoLog(de),mt=at===z.FRAGMENT_SHADER?"fragment":"vertex";Bn(_e,"string",mt+" shader source must be a string",Tt);var zt=ce(_e,Tt),Ht=De(lt);_t(zt,Ht),Object.keys(zt).forEach(function(Kt){var $t=zt[Kt];if(!$t.hasErrors)return;var sn=[""],fn=[""];function Ut(an,Je){sn.push(an),fn.push(Je||"")}Ut("file number "+Kt+": "+$t.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),$t.lines.forEach(function(an){if(an.errors.length>0){Ut(X(an.number,4)+"|  ","background-color:yellow; font-weight:bold"),Ut(an.line+Z,"color:red; background-color:yellow; font-weight:bold");var Je=0;an.errors.forEach(function(yt){var Jt=yt.message,mn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Jt);if(mn){var Dt=mn[1];switch(Jt=mn[2],Dt){case"assign":Dt="=";break}Je=Math.max(an.line.indexOf(Dt,Je),0)}else Je=0;Ut(X("| ",6)),Ut(X("^^^",Je+3)+Z,"font-weight:bold"),Ut(X("| ",6)),Ut(Jt+Z,"font-weight:bold")}),Ut(X("| ",6)+Z)}else Ut(X(an.number,4)+"|  "),Ut(an.line+Z,"color:red")}),typeof document<"u"&&!window.chrome?(fn[0]=sn.join("%c"),console.log.apply(console,fn)):console.log(sn.join(""))}),U.raise("Error compiling "+mt+" shader, "+zt[0].name)}}function ze(z,de,_e,at,Tt){if(!z.getProgramParameter(de,z.LINK_STATUS)){var lt=z.getProgramInfoLog(de),mt=ce(_e,Tt),zt=ce(at,Tt),Ht='Error linking program with vertex shader, "'+zt[0].name+'", and fragment shader "'+mt[0].name+'"';typeof document<"u"?console.log("%c"+Ht+Z+"%c"+lt,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Ht+Z+lt),U.raise(Ht)}}function Ze(z){z._commandRef=he()}function xt(z,de,_e,at){Ze(z);function Tt(Ht){return Ht?at.id(Ht):0}z._fragId=Tt(z.static.frag),z._vertId=Tt(z.static.vert);function lt(Ht,Kt){Object.keys(Kt).forEach(function($t){Ht[at.id($t)]=!0})}var mt=z._uniformSet={};lt(mt,de.static),lt(mt,de.dynamic);var zt=z._attributeSet={};lt(zt,_e.static),lt(zt,_e.dynamic),z._hasCount="count"in z.static||"count"in z.dynamic||"elements"in z.static||"elements"in z.dynamic}function Zt(z,de){var _e=Ue();J(z+" in command "+(de||he())+(_e==="unknown"?"":" called from "+_e))}function Kn(z,de,_e){z||Zt(de,_e||he())}function we(z,de,_e,at){z in de||Zt("unknown parameter ("+z+")"+pe(_e)+". possible values: "+Object.keys(de).join(),at||he())}function Bn(z,de,_e,at){ge(z,de)||Zt("invalid parameter type"+pe(_e)+". expected "+de+", got "+typeof z,at||he())}function Fr(z){z()}function nn(z,de,_e){z.texture?ee(z.texture._texture.internalformat,de,"unsupported texture format for attachment"):ee(z.renderbuffer._renderbuffer.format,_e,"unsupported renderbuffer format for attachment")}var Dn=33071,yn=9728,Rt=9984,Sr=9985,pr=9986,_n=9987,gr=5120,Nn=5121,yr=5122,Or=5123,Co=5124,_r=5125,Mi=5126,Xi=32819,ms=32820,Xs=33635,Yi=34042,Bi=36193,Qr={};Qr[gr]=Qr[Nn]=1,Qr[yr]=Qr[Or]=Qr[Bi]=Qr[Xs]=Qr[Xi]=Qr[ms]=2,Qr[Co]=Qr[_r]=Qr[Mi]=Qr[Yi]=4;function fo(z,de){return z===ms||z===Xi||z===Xs?2:z===Yi?4:Qr[z]*de}function Qn(z){return!(z&z-1)&&!!z}function Hr(z,de,_e){var at,Tt=de.width,lt=de.height,mt=de.channels;U(Tt>0&&Tt<=_e.maxTextureSize&&lt>0&&lt<=_e.maxTextureSize,"invalid texture shape"),(z.wrapS!==Dn||z.wrapT!==Dn)&&U(Qn(Tt)&&Qn(lt),"incompatible wrap mode for texture, both width and height must be power of 2"),de.mipmask===1?Tt!==1&&lt!==1&&U(z.minFilter!==Rt&&z.minFilter!==pr&&z.minFilter!==Sr&&z.minFilter!==_n,"min filter requires mipmap"):(U(Qn(Tt)&&Qn(lt),"texture must be a square power of 2 to support mipmapping"),U(de.mipmask===(Tt<<1)-1,"missing or incomplete mipmap data")),de.type===Mi&&(_e.extensions.indexOf("oes_texture_float_linear")<0&&U(z.minFilter===yn&&z.magFilter===yn,"filter not supported, must enable oes_texture_float_linear"),U(!z.genMipmaps,"mipmap generation not supported with float textures"));var zt=de.images;for(at=0;at<16;++at)if(zt[at]){var Ht=Tt>>at,Kt=lt>>at;U(de.mipmask&1<<at,"missing mipmap data");var $t=zt[at];if(U($t.width===Ht&&$t.height===Kt,"invalid shape for mip images"),U($t.format===de.format&&$t.internalformat===de.internalformat&&$t.type===de.type,"incompatible type for mip image"),!$t.compressed)if($t.data){var sn=Math.ceil(fo($t.type,mt)*Ht/$t.unpackAlignment)*$t.unpackAlignment;U($t.data.byteLength===sn*Kt,"invalid data for image, buffer size is inconsistent with image format")}else $t.element||$t.copy}else z.genMipmaps||U((de.mipmask&1<<at)===0,"extra mipmap data");de.compressed&&U(!z.genMipmaps,"mipmap generation for compressed images not supported")}function Ra(z,de,_e,at){var Tt=z.width,lt=z.height,mt=z.channels;U(Tt>0&&Tt<=at.maxTextureSize&&lt>0&&lt<=at.maxTextureSize,"invalid texture shape"),U(Tt===lt,"cube map must be square"),U(de.wrapS===Dn&&de.wrapT===Dn,"wrap mode not supported by cube map");for(var zt=0;zt<_e.length;++zt){var Ht=_e[zt];U(Ht.width===Tt&&Ht.height===lt,"inconsistent cube map face shape"),de.genMipmaps&&(U(!Ht.compressed,"can not generate mipmap for compressed textures"),U(Ht.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Kt=Ht.images,$t=0;$t<16;++$t){var sn=Kt[$t];if(sn){var fn=Tt>>$t,Ut=lt>>$t;U(Ht.mipmask&1<<$t,"missing mipmap data"),U(sn.width===fn&&sn.height===Ut,"invalid shape for mip images"),U(sn.format===z.format&&sn.internalformat===z.internalformat&&sn.type===z.type,"incompatible type for mip image"),sn.compressed||(sn.data?U(sn.data.byteLength===fn*Ut*Math.max(fo(sn.type,mt),sn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):sn.element||sn.copy)}}}}var fe=P(U,{optional:Fr,raise:J,commandRaise:Zt,command:Kn,parameter:ke,commandParameter:we,constructor:Ae,type:Me,commandType:Bn,isTypedArray:Ce,nni:Se,oneOf:ee,shaderError:N,linkError:ze,callSite:Ue,saveCommandRef:Ze,saveDrawInfo:xt,framebufferFormat:nn,guessCommand:he,texture2D:Hr,textureCube:Ra}),Yc=0,Bu=0,vt=5,Tl=6;function ct(z,de){this.id=Yc++,this.type=z,this.data=de}function Ee(z){return z.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Ho(z){if(z.length===0)return[];var de=z.charAt(0),_e=z.charAt(z.length-1);if(z.length>1&&de===_e&&(de==='"'||de==="'"))return['"'+Ee(z.substr(1,z.length-2))+'"'];var at=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(z);if(at)return Ho(z.substr(0,at.index)).concat(Ho(at[1])).concat(Ho(z.substr(at.index+at[0].length)));var Tt=z.split(".");if(Tt.length===1)return['"'+Ee(z)+'"'];for(var lt=[],mt=0;mt<Tt.length;++mt)lt=lt.concat(Ho(Tt[mt]));return lt}function ya(z){return"["+Ho(z).join("][")+"]"}function Ys(z,de){return new ct(z,ya(de+""))}function qo(z){return typeof z=="function"&&!z._reglType||z instanceof ct}function la(z,de){if(typeof z=="function")return new ct(Bu,z);if(typeof z=="number"||typeof z=="boolean")return new ct(vt,z);if(Array.isArray(z))return new ct(Tl,z.map((_e,at)=>la(_e,de+"["+at+"]")));if(z instanceof ct)return z;fe(!1,"invalid option type in uniform "+de)}var Ss={DynamicVariable:ct,define:Ys,isDynamic:qo,unbox:la,accessor:ya},Jo={next:typeof requestAnimationFrame=="function"?function(z){return requestAnimationFrame(z)}:function(z){return setTimeout(z,16)},cancel:typeof cancelAnimationFrame=="function"?function(z){return cancelAnimationFrame(z)}:clearTimeout},Ks=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function ac(){var z={"":0},de=[""];return{id:function(_e){var at=z[_e];return at||(at=z[_e]=de.length,de.push(_e),at)},str:function(_e){return de[_e]}}}function lc(z,de,_e){var at=document.createElement("canvas");P(at.style,{border:0,margin:0,padding:0,top:0,left:0}),z.appendChild(at),z===document.body&&(at.style.position="absolute",P(z.style,{margin:0,padding:0}));function Tt(){var zt=window.innerWidth,Ht=window.innerHeight;if(z!==document.body){var Kt=z.getBoundingClientRect();zt=Kt.right-Kt.left,Ht=Kt.bottom-Kt.top}at.width=_e*zt,at.height=_e*Ht,P(at.style,{width:zt+"px",height:Ht+"px"})}var lt;z!==document.body&&typeof ResizeObserver=="function"?(lt=new ResizeObserver(function(){setTimeout(Tt)}),lt.observe(z)):window.addEventListener("resize",Tt,!1);function mt(){lt?lt.disconnect():window.removeEventListener("resize",Tt),z.removeChild(at)}return Tt(),{canvas:at,onDestroy:mt}}function Qo(z,de){function _e(at){try{return z.getContext(at,de)}catch{return null}}return _e("webgl")||_e("experimental-webgl")||_e("webgl-experimental")}function es(z){return typeof z.nodeName=="string"&&typeof z.appendChild=="function"&&typeof z.getBoundingClientRect=="function"}function zu(z){return typeof z.drawArrays=="function"||typeof z.drawElements=="function"}function qs(z){return typeof z=="string"?z.split():(fe(Array.isArray(z),"invalid extension array"),z)}function ef(z){return typeof z=="string"?(fe(typeof document<"u","not supported outside of DOM"),document.querySelector(z)):z}function Fp(z){var de=z||{},_e,at,Tt,lt,mt={},zt=[],Ht=[],Kt=typeof window>"u"?1:window.devicePixelRatio,$t=!1,sn=function(an){an&&fe.raise(an)},fn=function(){};if(typeof de=="string"?(fe(typeof document<"u","selector queries only supported in DOM enviroments"),_e=document.querySelector(de),fe(_e,"invalid query string for element")):typeof de=="object"?es(de)?_e=de:zu(de)?(lt=de,Tt=lt.canvas):(fe.constructor(de),"gl"in de?lt=de.gl:"canvas"in de?Tt=ef(de.canvas):"container"in de&&(at=ef(de.container)),"attributes"in de&&(mt=de.attributes,fe.type(mt,"object","invalid context attributes")),"extensions"in de&&(zt=qs(de.extensions)),"optionalExtensions"in de&&(Ht=qs(de.optionalExtensions)),"onDone"in de&&(fe.type(de.onDone,"function","invalid or missing onDone callback"),sn=de.onDone),"profile"in de&&($t=!!de.profile),"pixelRatio"in de&&(Kt=+de.pixelRatio,fe(Kt>0,"invalid pixel ratio"))):fe.raise("invalid arguments to regl"),_e&&(_e.nodeName.toLowerCase()==="canvas"?Tt=_e:at=_e),!lt){if(!Tt){fe(typeof document<"u","must manually specify webgl context outside of DOM environments");var Ut=lc(at||document.body,sn,Kt);if(!Ut)return null;Tt=Ut.canvas,fn=Ut.onDestroy}mt.premultipliedAlpha===void 0&&(mt.premultipliedAlpha=!0),lt=Qo(Tt,mt)}return lt?{gl:lt,canvas:Tt,container:at,extensions:zt,optionalExtensions:Ht,pixelRatio:Kt,profile:$t,onDone:sn,onDestroy:fn}:(fn(),sn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function F(z,de){var _e={};function at(mt){fe.type(mt,"string","extension name must be string");var zt=mt.toLowerCase(),Ht;try{Ht=_e[zt]=z.getExtension(zt)}catch{}return!!Ht}for(var Tt=0;Tt<de.extensions.length;++Tt){var lt=de.extensions[Tt];if(!at(lt))return de.onDestroy(),de.onDone('"'+lt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return de.optionalExtensions.forEach(at),{extensions:_e,restore:function(){Object.keys(_e).forEach(function(mt){if(_e[mt]&&!at(mt))throw new Error("(regl): error restoring extension "+mt)})}}}function No(z,de){for(var _e=Array(z),at=0;at<z;++at)_e[at]=de(at);return _e}var Ii=5120,Zg=5121,Yr=5122,ca=5123,Uu=5124,tf=5125,nf=5126;function rf(z){for(var de=16;de<=1<<28;de*=16)if(z<=de)return de;return 0}function ba(z){var de,_e;return de=(z>65535)<<4,z>>>=de,_e=(z>255)<<3,z>>>=_e,de|=_e,_e=(z>15)<<2,z>>>=_e,de|=_e,_e=(z>3)<<1,z>>>=_e,de|=_e,de|z>>1}function Rn(){var z=No(8,function(){return[]});function de(lt){var mt=rf(lt),zt=z[ba(mt)>>2];return zt.length>0?zt.pop():new ArrayBuffer(mt)}function _e(lt){z[ba(lt.byteLength)>>2].push(lt)}function at(lt,mt){var zt=null;switch(lt){case Ii:zt=new Int8Array(de(mt),0,mt);break;case Zg:zt=new Uint8Array(de(mt),0,mt);break;case Yr:zt=new Int16Array(de(2*mt),0,mt);break;case ca:zt=new Uint16Array(de(2*mt),0,mt);break;case Uu:zt=new Int32Array(de(4*mt),0,mt);break;case tf:zt=new Uint32Array(de(4*mt),0,mt);break;case nf:zt=new Float32Array(de(4*mt),0,mt);break;default:return null}return zt.length!==mt?zt.subarray(0,mt):zt}function Tt(lt){_e(lt.buffer)}return{alloc:de,free:_e,allocType:at,freeType:Tt}}var qn=Rn();qn.zero=Rn();var As=3408,Ml=3410,of=3411,Vu=3412,Ia=3413,Pl=3414,ju=3415,sf=33901,cc=33902,Xg=3379,Hu=3386,Hd=34921,Ol=36347,$d=36348,Wd=35661,Kc=35660,po=34930,Gp=36349,Zd=34076,Xd=34024,af=7936,di=7937,zi=7938,rr=35724,Ja=34047,to=36063,lf=34852,$u=3553,Wu=34067,cf=34069,Yd=33984,Dl=6408,Kd=5126,uf=5121,ko=36160,df=36053,uc=36064,dc=16384,_l=function(z,de){var _e=1;de.ext_texture_filter_anisotropic&&(_e=z.getParameter(Ja));var at=1,Tt=1;de.webgl_draw_buffers&&(at=z.getParameter(lf),Tt=z.getParameter(to));var lt=!!de.oes_texture_float;if(lt){var mt=z.createTexture();z.bindTexture($u,mt),z.texImage2D($u,0,Dl,1,1,0,Dl,Kd,null);var zt=z.createFramebuffer();if(z.bindFramebuffer(ko,zt),z.framebufferTexture2D(ko,uc,$u,mt,0),z.bindTexture($u,null),z.checkFramebufferStatus(ko)!==df)lt=!1;else{z.viewport(0,0,1,1),z.clearColor(1,0,0,1),z.clear(dc);var Ht=qn.allocType(Kd,4);z.readPixels(0,0,1,1,Dl,Kd,Ht),z.getError()?lt=!1:(z.deleteFramebuffer(zt),z.deleteTexture(mt),lt=Ht[0]===1),qn.freeType(Ht)}}var Kt=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),$t=!0;if(!Kt){var sn=z.createTexture(),fn=qn.allocType(uf,36);z.activeTexture(Yd),z.bindTexture(Wu,sn),z.texImage2D(cf,0,Dl,3,3,0,Dl,uf,fn),qn.freeType(fn),z.bindTexture(Wu,null),z.deleteTexture(sn),$t=!z.getError()}return{colorBits:[z.getParameter(Ml),z.getParameter(of),z.getParameter(Vu),z.getParameter(Ia)],depthBits:z.getParameter(Pl),stencilBits:z.getParameter(ju),subpixelBits:z.getParameter(As),extensions:Object.keys(de).filter(function(Ut){return!!de[Ut]}),maxAnisotropic:_e,maxDrawbuffers:at,maxColorAttachments:Tt,pointSizeDims:z.getParameter(sf),lineWidthDims:z.getParameter(cc),maxViewportDims:z.getParameter(Hu),maxCombinedTextureUnits:z.getParameter(Wd),maxCubeMapSize:z.getParameter(Zd),maxRenderbufferSize:z.getParameter(Xd),maxTextureUnits:z.getParameter(po),maxTextureSize:z.getParameter(Xg),maxAttributes:z.getParameter(Hd),maxVertexUniforms:z.getParameter(Ol),maxVertexTextureUnits:z.getParameter(Kc),maxVaryingVectors:z.getParameter($d),maxFragmentUniforms:z.getParameter(Gp),glsl:z.getParameter(rr),renderer:z.getParameter(di),vendor:z.getParameter(af),version:z.getParameter(zi),readFloat:lt,npotTextureCube:$t}};function no(z){return!!z&&typeof z=="object"&&Array.isArray(z.shape)&&Array.isArray(z.stride)&&typeof z.offset=="number"&&z.shape.length===z.stride.length&&(Array.isArray(z.data)||$(z.data))}var wo=function(z){return Object.keys(z).map(function(de){return z[de]})},Nl={shape:Qa,flatten:Jc};function Js(z,de,_e){for(var at=0;at<de;++at)_e[at]=z[at]}function qd(z,de,_e,at){for(var Tt=0,lt=0;lt<de;++lt)for(var mt=z[lt],zt=0;zt<_e;++zt)at[Tt++]=mt[zt]}function qc(z,de,_e,at,Tt,lt){for(var mt=lt,zt=0;zt<de;++zt)for(var Ht=z[zt],Kt=0;Kt<_e;++Kt)for(var $t=Ht[Kt],sn=0;sn<at;++sn)Tt[mt++]=$t[sn]}function hc(z,de,_e,at,Tt){for(var lt=1,mt=_e+1;mt<de.length;++mt)lt*=de[mt];var zt=de[_e];if(de.length-_e===4){var Ht=de[_e+1],Kt=de[_e+2],$t=de[_e+3];for(mt=0;mt<zt;++mt)qc(z[mt],Ht,Kt,$t,at,Tt),Tt+=lt}else for(mt=0;mt<zt;++mt)hc(z[mt],de,_e+1,at,Tt),Tt+=lt}function Jc(z,de,_e,at){var Tt=1;if(de.length)for(var lt=0;lt<de.length;++lt)Tt*=de[lt];else Tt=0;var mt=at||qn.allocType(_e,Tt);switch(de.length){case 0:break;case 1:Js(z,de[0],mt);break;case 2:qd(z,de[0],de[1],mt);break;case 3:qc(z,de[0],de[1],de[2],mt,0);break;default:hc(z,de,0,mt,0)}return mt}function Qa(z){for(var de=[],_e=z;_e.length;_e=_e[0])de.push(_e.length);return de}var Zu={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},hf=5120,Bp=5122,ff=5124,Jd=5121,pf=5123,zp=5125,Qd=5126,ua=5126,Qs={int8:hf,int16:Bp,int32:ff,uint8:Jd,uint16:pf,uint32:zp,float:Qd,float32:ua},fc=35048,Xu=35040,Yu={dynamic:fc,stream:Xu,static:35044},Ki=Nl.flatten,Ku=Nl.shape,qu=35044,Pi=35040,da=5121,kl=5126,Rl=[];Rl[5120]=1,Rl[5122]=2,Rl[5124]=4,Rl[5121]=1,Rl[5123]=2,Rl[5125]=4,Rl[5126]=4;function Qc(z){return Zu[Object.prototype.toString.call(z)]|0}function Ju(z,de){for(var _e=0;_e<de.length;++_e)z[_e]=de[_e]}function Il(z,de,_e,at,Tt,lt,mt){for(var zt=0,Ht=0;Ht<_e;++Ht)for(var Kt=0;Kt<at;++Kt)z[zt++]=de[Tt*Ht+lt*Kt+mt]}function ea(z,de,_e,at){var Tt=0,lt={};function mt(Je){this.id=Tt++,this.buffer=z.createBuffer(),this.type=Je,this.usage=qu,this.byteLength=0,this.dimension=1,this.dtype=da,this.persistentData=null,_e.profile&&(this.stats={size:0})}mt.prototype.bind=function(){z.bindBuffer(this.type,this.buffer)},mt.prototype.destroy=function(){fn(this)};var zt=[];function Ht(Je,yt){var Jt=zt.pop();return Jt||(Jt=new mt(Je)),Jt.bind(),sn(Jt,yt,Pi,0,1,!1),Jt}function Kt(Je){zt.push(Je)}function $t(Je,yt,Jt){Je.byteLength=yt.byteLength,z.bufferData(Je.type,yt,Jt)}function sn(Je,yt,Jt,mn,Dt,Cn){var Ft;if(Je.usage=Jt,Array.isArray(yt)){if(Je.dtype=mn||kl,yt.length>0){var ln;if(Array.isArray(yt[0])){Ft=Ku(yt);for(var Nt=1,un=1;un<Ft.length;++un)Nt*=Ft[un];Je.dimension=Nt,ln=Ki(yt,Ft,Je.dtype),$t(Je,ln,Jt),Cn?Je.persistentData=ln:qn.freeType(ln)}else if(typeof yt[0]=="number"){Je.dimension=Dt;var $n=qn.allocType(Je.dtype,yt.length);Ju($n,yt),$t(Je,$n,Jt),Cn?Je.persistentData=$n:qn.freeType($n)}else $(yt[0])?(Je.dimension=yt[0].length,Je.dtype=mn||Qc(yt[0])||kl,ln=Ki(yt,[yt.length,yt[0].length],Je.dtype),$t(Je,ln,Jt),Cn?Je.persistentData=ln:qn.freeType(ln)):fe.raise("invalid buffer data")}}else if($(yt))Je.dtype=mn||Qc(yt),Je.dimension=Dt,$t(Je,yt,Jt),Cn&&(Je.persistentData=new Uint8Array(new Uint8Array(yt.buffer)));else if(no(yt)){Ft=yt.shape;var lr=yt.stride,pn=yt.offset,en=0,Ot=0,Jn=0,Ar=0;Ft.length===1?(en=Ft[0],Ot=1,Jn=lr[0],Ar=0):Ft.length===2?(en=Ft[0],Ot=Ft[1],Jn=lr[0],Ar=lr[1]):fe.raise("invalid shape"),Je.dtype=mn||Qc(yt.data)||kl,Je.dimension=Ot;var Mn=qn.allocType(Je.dtype,en*Ot);Il(Mn,yt.data,en,Ot,Jn,Ar,pn),$t(Je,Mn,Jt),Cn?Je.persistentData=Mn:qn.freeType(Mn)}else yt instanceof ArrayBuffer?(Je.dtype=da,Je.dimension=Dt,$t(Je,yt,Jt),Cn&&(Je.persistentData=new Uint8Array(new Uint8Array(yt)))):fe.raise("invalid buffer data")}function fn(Je){de.bufferCount--,at(Je);var yt=Je.buffer;fe(yt,"buffer must not be deleted already"),z.deleteBuffer(yt),Je.buffer=null,delete lt[Je.id]}function Ut(Je,yt,Jt,mn){de.bufferCount++;var Dt=new mt(yt);lt[Dt.id]=Dt;function Cn(Nt){var un=qu,$n=null,lr=0,pn=0,en=1;return Array.isArray(Nt)||$(Nt)||no(Nt)||Nt instanceof ArrayBuffer?$n=Nt:typeof Nt=="number"?lr=Nt|0:Nt&&(fe.type(Nt,"object","buffer arguments must be an object, a number or an array"),"data"in Nt&&(fe($n===null||Array.isArray($n)||$($n)||no($n),"invalid data for buffer"),$n=Nt.data),"usage"in Nt&&(fe.parameter(Nt.usage,Yu,"invalid buffer usage"),un=Yu[Nt.usage]),"type"in Nt&&(fe.parameter(Nt.type,Qs,"invalid buffer type"),pn=Qs[Nt.type]),"dimension"in Nt&&(fe.type(Nt.dimension,"number","invalid dimension"),en=Nt.dimension|0),"length"in Nt&&(fe.nni(lr,"buffer length must be a nonnegative integer"),lr=Nt.length|0)),Dt.bind(),$n?sn(Dt,$n,un,pn,en,mn):(lr&&z.bufferData(Dt.type,lr,un),Dt.dtype=pn||da,Dt.usage=un,Dt.dimension=en,Dt.byteLength=lr),_e.profile&&(Dt.stats.size=Dt.byteLength*Rl[Dt.dtype]),Cn}function Ft(Nt,un){fe(un+Nt.byteLength<=Dt.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Nt.byteLength+" starting from offset "+un+" to a buffer of size "+Dt.byteLength),z.bufferSubData(Dt.type,un,Nt)}function ln(Nt,un){var $n=(un||0)|0,lr;if(Dt.bind(),$(Nt)||Nt instanceof ArrayBuffer)Ft(Nt,$n);else if(Array.isArray(Nt)){if(Nt.length>0)if(typeof Nt[0]=="number"){var pn=qn.allocType(Dt.dtype,Nt.length);Ju(pn,Nt),Ft(pn,$n),qn.freeType(pn)}else if(Array.isArray(Nt[0])||$(Nt[0])){lr=Ku(Nt);var en=Ki(Nt,lr,Dt.dtype);Ft(en,$n),qn.freeType(en)}else fe.raise("invalid buffer data")}else if(no(Nt)){lr=Nt.shape;var Ot=Nt.stride,Jn=0,Ar=0,Mn=0,Lr=0;lr.length===1?(Jn=lr[0],Ar=1,Mn=Ot[0],Lr=0):lr.length===2?(Jn=lr[0],Ar=lr[1],Mn=Ot[0],Lr=Ot[1]):fe.raise("invalid shape");var hr=Array.isArray(Nt.data)?Dt.dtype:Qc(Nt.data),Mr=qn.allocType(hr,Jn*Ar);Il(Mr,Nt.data,Jn,Ar,Mn,Lr,Nt.offset),Ft(Mr,$n),qn.freeType(Mr)}else fe.raise("invalid data for buffer subdata");return Cn}return Jt||Cn(Je),Cn._reglType="buffer",Cn._buffer=Dt,Cn.subdata=ln,_e.profile&&(Cn.stats=Dt.stats),Cn.destroy=function(){fn(Dt)},Cn}function an(){wo(lt).forEach(function(Je){Je.buffer=z.createBuffer(),z.bindBuffer(Je.type,Je.buffer),z.bufferData(Je.type,Je.persistentData||Je.byteLength,Je.usage)})}return _e.profile&&(de.getTotalBufferSize=function(){var Je=0;return Object.keys(lt).forEach(function(yt){Je+=lt[yt].stats.size}),Je}),{create:Ut,createStream:Ht,destroyStream:Kt,clear:function(){wo(lt).forEach(fn),zt.forEach(fn)},getBuffer:function(Je){return Je&&Je._buffer instanceof mt?Je._buffer:null},restore:an,_initBuffer:sn}}var el=0,Qu=0,gf=1,mf=1,C=4,M=4,k={points:el,point:Qu,lines:gf,line:mf,triangles:C,triangle:M,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},L=0,W=1,Y=4,re=5120,Ge=5121,Fe=5122,it=5123,At=5124,Qt=5125,Ct=34963,It=35040,ir=35044;function Ir(z,de,_e,at){var Tt={},lt=0,mt={uint8:Ge,uint16:it};de.oes_element_index_uint&&(mt.uint32=Qt);function zt(an){this.id=lt++,Tt[this.id]=this,this.buffer=an,this.primType=Y,this.vertCount=0,this.type=0}zt.prototype.bind=function(){this.buffer.bind()};var Ht=[];function Kt(an){var Je=Ht.pop();return Je||(Je=new zt(_e.create(null,Ct,!0,!1)._buffer)),sn(Je,an,It,-1,-1,0,0),Je}function $t(an){Ht.push(an)}function sn(an,Je,yt,Jt,mn,Dt,Cn){an.buffer.bind();var Ft;if(Je){var ln=Cn;!Cn&&(!$(Je)||no(Je)&&!$(Je.data))&&(ln=de.oes_element_index_uint?Qt:it),_e._initBuffer(an.buffer,Je,yt,ln,3)}else z.bufferData(Ct,Dt,yt),an.buffer.dtype=Ft||Ge,an.buffer.usage=yt,an.buffer.dimension=3,an.buffer.byteLength=Dt;if(Ft=Cn,!Cn){switch(an.buffer.dtype){case Ge:case re:Ft=Ge;break;case it:case Fe:Ft=it;break;case Qt:case At:Ft=Qt;break;default:fe.raise("unsupported type for element array")}an.buffer.dtype=Ft}an.type=Ft,fe(Ft!==Qt||!!de.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Nt=mn;Nt<0&&(Nt=an.buffer.byteLength,Ft===it?Nt>>=1:Ft===Qt&&(Nt>>=2)),an.vertCount=Nt;var un=Jt;if(Jt<0){un=Y;var $n=an.buffer.dimension;$n===1&&(un=L),$n===2&&(un=W),$n===3&&(un=Y)}an.primType=un}function fn(an){at.elementsCount--,fe(an.buffer!==null,"must not double destroy elements"),delete Tt[an.id],an.buffer.destroy(),an.buffer=null}function Ut(an,Je){var yt=_e.create(null,Ct,!0),Jt=new zt(yt._buffer);at.elementsCount++;function mn(Dt){if(!Dt)yt(),Jt.primType=Y,Jt.vertCount=0,Jt.type=Ge;else if(typeof Dt=="number")yt(Dt),Jt.primType=Y,Jt.vertCount=Dt|0,Jt.type=Ge;else{var Cn=null,Ft=ir,ln=-1,Nt=-1,un=0,$n=0;Array.isArray(Dt)||$(Dt)||no(Dt)?Cn=Dt:(fe.type(Dt,"object","invalid arguments for elements"),"data"in Dt&&(Cn=Dt.data,fe(Array.isArray(Cn)||$(Cn)||no(Cn),"invalid data for element buffer")),"usage"in Dt&&(fe.parameter(Dt.usage,Yu,"invalid element buffer usage"),Ft=Yu[Dt.usage]),"primitive"in Dt&&(fe.parameter(Dt.primitive,k,"invalid element buffer primitive"),ln=k[Dt.primitive]),"count"in Dt&&(fe(typeof Dt.count=="number"&&Dt.count>=0,"invalid vertex count for elements"),Nt=Dt.count|0),"type"in Dt&&(fe.parameter(Dt.type,mt,"invalid buffer type"),$n=mt[Dt.type]),"length"in Dt?un=Dt.length|0:(un=Nt,$n===it||$n===Fe?un*=2:($n===Qt||$n===At)&&(un*=4))),sn(Jt,Cn,Ft,ln,Nt,un,$n)}return mn}return mn(an),mn._reglType="elements",mn._elements=Jt,mn.subdata=function(Dt,Cn){return yt.subdata(Dt,Cn),mn},mn.destroy=function(){fn(Jt)},mn}return{create:Ut,createStream:Kt,destroyStream:$t,getElements:function(an){return typeof an=="function"&&an._elements instanceof zt?an._elements:null},clear:function(){wo(Tt).forEach(fn)}}}var er=new Float32Array(1),Eo=new Uint32Array(er.buffer),So=5123;function Fs(z){for(var de=qn.allocType(So,z.length),_e=0;_e<z.length;++_e)if(isNaN(z[_e]))de[_e]=65535;else if(z[_e]===1/0)de[_e]=31744;else if(z[_e]===-1/0)de[_e]=64512;else{er[0]=z[_e];var at=Eo[0],Tt=at>>>31<<15,lt=(at<<1>>>24)-127,mt=at>>13&(1<<10)-1;if(lt<-24)de[_e]=Tt;else if(lt<-14){var zt=-14-lt;de[_e]=Tt+(mt+(1<<10)>>zt)}else lt>15?de[_e]=Tt+31744:de[_e]=Tt+(lt+15<<10)+mt}return de}function br(z){return Array.isArray(z)||$(z)}var Nr=function(z){return!(z&z-1)&&!!z},Ts=34467,Gr=3553,Vi=34067,tl=34069,La=6408,vs=6406,xa=6407,ha=6409,ts=6410,Li=32854,ro=32855,$o=36194,Up=32819,us=32820,Ca=33635,ei=34042,ta=6402,pc=34041,gc=35904,Ll=35906,Gs=36193,go=33776,mc=33777,eu=33778,eh=33779,ed=35986,Ms=35987,td=34798,vc=35840,nd=35841,Fa=35842,rd=35843,tu=36196,Ps=5121,Bs=5123,Fl=5125,Gl=5126,nu=10242,th=10243,Oi=10497,Ro=33071,zs=33648,ys=10240,nh=10241,ru=9728,Vp=9729,nl=9984,id=9985,Bl=9986,od=9987,yc=33170,Ga=4352,rl=4353,iu=4354,jp=34046,sd=3317,ad=37440,bc=37441,ou=37443,te=37444,Re=33984,Ke=[nl,Bl,id,od],Lt=[0,ha,ts,xa,La],qe={};qe[ha]=qe[vs]=qe[ta]=1,qe[pc]=qe[ts]=2,qe[xa]=qe[gc]=3,qe[La]=qe[Ll]=4;function Gt(z){return"[object "+z+"]"}var rn=Gt("HTMLCanvasElement"),xn=Gt("OffscreenCanvas"),Sn=Gt("CanvasRenderingContext2D"),dr=Gt("ImageBitmap"),jn=Gt("HTMLImageElement"),mr=Gt("HTMLVideoElement"),ti=Object.keys(Zu).concat([rn,xn,Sn,dr,jn,mr]),gi=[];gi[Ps]=1,gi[Gl]=4,gi[Gs]=2,gi[Bs]=2,gi[Fl]=4;var Un=[];Un[Li]=2,Un[ro]=2,Un[$o]=2,Un[pc]=4,Un[go]=.5,Un[mc]=.5,Un[eu]=1,Un[eh]=1,Un[ed]=.5,Un[Ms]=1,Un[td]=1,Un[vc]=.5,Un[nd]=.25,Un[Fa]=.5,Un[rd]=.25,Un[tu]=.5;function Io(z){return Array.isArray(z)&&(z.length===0||typeof z[0]=="number")}function ns(z){if(!Array.isArray(z))return!1;var de=z.length;return!(de===0||!br(z[0]))}function Lo(z){return Object.prototype.toString.call(z)}function Hi(z){return Lo(z)===rn}function ds(z){return Lo(z)===xn}function fa(z){return Lo(z)===Sn}function Ao(z){return Lo(z)===dr}function su(z){return Lo(z)===jn}function jr(z){return Lo(z)===mr}function Br(z){if(!z)return!1;var de=Lo(z);return ti.indexOf(de)>=0?!0:Io(z)||ns(z)||no(z)}function vf(z){return Zu[Object.prototype.toString.call(z)]|0}function yf(z,de){var _e=de.length;switch(z.type){case Ps:case Bs:case Fl:case Gl:var at=qn.allocType(z.type,_e);at.set(de),z.data=at;break;case Gs:z.data=Fs(de);break;default:fe.raise("unsupported texture type, must specify a typed array")}}function bf(z,de){return qn.allocType(z.type===Gs?Gl:z.type,de)}function xf(z,de){z.type===Gs?(z.data=Fs(de),qn.freeType(de)):z.data=de}function V0(z,de,_e,at,Tt,lt){for(var mt=z.width,zt=z.height,Ht=z.channels,Kt=mt*zt*Ht,$t=bf(z,Kt),sn=0,fn=0;fn<zt;++fn)for(var Ut=0;Ut<mt;++Ut)for(var an=0;an<Ht;++an)$t[sn++]=de[_e*Ut+at*fn+Tt*an+lt];xf(z,$t)}function mi(z,de,_e,at,Tt,lt){var mt;if(typeof Un[z]<"u"?mt=Un[z]:mt=qe[z]*gi[de],lt&&(mt*=6),Tt){for(var zt=0,Ht=_e;Ht>=1;)zt+=mt*Ht*Ht,Ht/=2;return zt}else return mt*_e*at}function il(z,de,_e,at,Tt,lt,mt){var zt={"don't care":Ga,"dont care":Ga,nice:iu,fast:rl},Ht={repeat:Oi,clamp:Ro,mirror:zs},Kt={nearest:ru,linear:Vp},$t=P({mipmap:od,"nearest mipmap nearest":nl,"linear mipmap nearest":id,"nearest mipmap linear":Bl,"linear mipmap linear":od},Kt),sn={none:0,browser:te},fn={uint8:Ps,rgba4:Up,rgb565:Ca,"rgb5 a1":us},Ut={alpha:vs,luminance:ha,"luminance alpha":ts,rgb:xa,rgba:La,rgba4:Li,"rgb5 a1":ro,rgb565:$o},an={};de.ext_srgb&&(Ut.srgb=gc,Ut.srgba=Ll),de.oes_texture_float&&(fn.float32=fn.float=Gl),de.oes_texture_half_float&&(fn.float16=fn["half float"]=Gs),de.webgl_depth_texture&&(P(Ut,{depth:ta,"depth stencil":pc}),P(fn,{uint16:Bs,uint32:Fl,"depth stencil":ei})),de.webgl_compressed_texture_s3tc&&P(an,{"rgb s3tc dxt1":go,"rgba s3tc dxt1":mc,"rgba s3tc dxt3":eu,"rgba s3tc dxt5":eh}),de.webgl_compressed_texture_atc&&P(an,{"rgb atc":ed,"rgba atc explicit alpha":Ms,"rgba atc interpolated alpha":td}),de.webgl_compressed_texture_pvrtc&&P(an,{"rgb pvrtc 4bppv1":vc,"rgb pvrtc 2bppv1":nd,"rgba pvrtc 4bppv1":Fa,"rgba pvrtc 2bppv1":rd}),de.webgl_compressed_texture_etc1&&(an["rgb etc1"]=tu);var Je=Array.prototype.slice.call(z.getParameter(Ts));Object.keys(an).forEach(function(Te){var ut=an[Te];Je.indexOf(ut)>=0&&(Ut[Te]=ut)});var yt=Object.keys(Ut);_e.textureFormats=yt;var Jt=[];Object.keys(Ut).forEach(function(Te){var ut=Ut[Te];Jt[ut]=Te});var mn=[];Object.keys(fn).forEach(function(Te){var ut=fn[Te];mn[ut]=Te});var Dt=[];Object.keys(Kt).forEach(function(Te){var ut=Kt[Te];Dt[ut]=Te});var Cn=[];Object.keys($t).forEach(function(Te){var ut=$t[Te];Cn[ut]=Te});var Ft=[];Object.keys(Ht).forEach(function(Te){var ut=Ht[Te];Ft[ut]=Te});var ln=yt.reduce(function(Te,ut){var ot=Ut[ut];return ot===ha||ot===vs||ot===ha||ot===ts||ot===ta||ot===pc||de.ext_srgb&&(ot===gc||ot===Ll)?Te[ot]=ot:ot===ro||ut.indexOf("rgba")>=0?Te[ot]=La:Te[ot]=xa,Te},{});function Nt(){this.internalformat=La,this.format=La,this.type=Ps,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=te,this.width=0,this.height=0,this.channels=0}function un(Te,ut){Te.internalformat=ut.internalformat,Te.format=ut.format,Te.type=ut.type,Te.compressed=ut.compressed,Te.premultiplyAlpha=ut.premultiplyAlpha,Te.flipY=ut.flipY,Te.unpackAlignment=ut.unpackAlignment,Te.colorSpace=ut.colorSpace,Te.width=ut.width,Te.height=ut.height,Te.channels=ut.channels}function $n(Te,ut){if(!(typeof ut!="object"||!ut)){if("premultiplyAlpha"in ut&&(fe.type(ut.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Te.premultiplyAlpha=ut.premultiplyAlpha),"flipY"in ut&&(fe.type(ut.flipY,"boolean","invalid texture flip"),Te.flipY=ut.flipY),"alignment"in ut&&(fe.oneOf(ut.alignment,[1,2,4,8],"invalid texture unpack alignment"),Te.unpackAlignment=ut.alignment),"colorSpace"in ut&&(fe.parameter(ut.colorSpace,sn,"invalid colorSpace"),Te.colorSpace=sn[ut.colorSpace]),"type"in ut){var ot=ut.type;fe(de.oes_texture_float||!(ot==="float"||ot==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),fe(de.oes_texture_half_float||!(ot==="half float"||ot==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),fe(de.webgl_depth_texture||!(ot==="uint16"||ot==="uint32"||ot==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),fe.parameter(ot,fn,"invalid texture type"),Te.type=fn[ot]}var wn=Te.width,Rr=Te.height,ye=Te.channels,ie=!1;"shape"in ut?(fe(Array.isArray(ut.shape)&&ut.shape.length>=2,"shape must be an array"),wn=ut.shape[0],Rr=ut.shape[1],ut.shape.length===3&&(ye=ut.shape[2],fe(ye>0&&ye<=4,"invalid number of channels"),ie=!0),fe(wn>=0&&wn<=_e.maxTextureSize,"invalid width"),fe(Rr>=0&&Rr<=_e.maxTextureSize,"invalid height")):("radius"in ut&&(wn=Rr=ut.radius,fe(wn>=0&&wn<=_e.maxTextureSize,"invalid radius")),"width"in ut&&(wn=ut.width,fe(wn>=0&&wn<=_e.maxTextureSize,"invalid width")),"height"in ut&&(Rr=ut.height,fe(Rr>=0&&Rr<=_e.maxTextureSize,"invalid height")),"channels"in ut&&(ye=ut.channels,fe(ye>0&&ye<=4,"invalid number of channels"),ie=!0)),Te.width=wn|0,Te.height=Rr|0,Te.channels=ye|0;var Ie=!1;if("format"in ut){var Xe=ut.format;fe(de.webgl_depth_texture||!(Xe==="depth"||Xe==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),fe.parameter(Xe,Ut,"invalid texture format");var Qe=Te.internalformat=Ut[Xe];Te.format=ln[Qe],Xe in fn&&("type"in ut||(Te.type=fn[Xe])),Xe in an&&(Te.compressed=!0),Ie=!0}!ie&&Ie?Te.channels=qe[Te.format]:ie&&!Ie?Te.channels!==Lt[Te.format]&&(Te.format=Te.internalformat=Lt[Te.channels]):Ie&&ie&&fe(Te.channels===qe[Te.format],"number of channels inconsistent with specified format")}}function lr(Te){z.pixelStorei(ad,Te.flipY),z.pixelStorei(bc,Te.premultiplyAlpha),z.pixelStorei(ou,Te.colorSpace),z.pixelStorei(sd,Te.unpackAlignment)}function pn(){Nt.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function en(Te,ut){var ot=null;if(Br(ut)?ot=ut:ut&&(fe.type(ut,"object","invalid pixel data type"),$n(Te,ut),"x"in ut&&(Te.xOffset=ut.x|0),"y"in ut&&(Te.yOffset=ut.y|0),Br(ut.data)&&(ot=ut.data)),fe(!Te.compressed||ot instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),ut.copy){fe(!ot,"can not specify copy and data field for the same texture");var wn=Tt.viewportWidth,Rr=Tt.viewportHeight;Te.width=Te.width||wn-Te.xOffset,Te.height=Te.height||Rr-Te.yOffset,Te.needsCopy=!0,fe(Te.xOffset>=0&&Te.xOffset<wn&&Te.yOffset>=0&&Te.yOffset<Rr&&Te.width>0&&Te.width<=wn&&Te.height>0&&Te.height<=Rr,"copy texture read out of bounds")}else if(!ot)Te.width=Te.width||1,Te.height=Te.height||1,Te.channels=Te.channels||4;else if($(ot))Te.channels=Te.channels||4,Te.data=ot,!("type"in ut)&&Te.type===Ps&&(Te.type=vf(ot));else if(Io(ot))Te.channels=Te.channels||4,yf(Te,ot),Te.alignment=1,Te.needsFree=!0;else if(no(ot)){var ye=ot.data;!Array.isArray(ye)&&Te.type===Ps&&(Te.type=vf(ye));var ie=ot.shape,Ie=ot.stride,Xe,Qe,Be,Le,$e,xe;ie.length===3?(Be=ie[2],xe=Ie[2]):(fe(ie.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Be=1,xe=1),Xe=ie[0],Qe=ie[1],Le=Ie[0],$e=Ie[1],Te.alignment=1,Te.width=Xe,Te.height=Qe,Te.channels=Be,Te.format=Te.internalformat=Lt[Be],Te.needsFree=!0,V0(Te,ye,Le,$e,xe,ot.offset)}else if(Hi(ot)||ds(ot)||fa(ot))Hi(ot)||ds(ot)?Te.element=ot:Te.element=ot.canvas,Te.width=Te.element.width,Te.height=Te.element.height,Te.channels=4;else if(Ao(ot))Te.element=ot,Te.width=ot.width,Te.height=ot.height,Te.channels=4;else if(su(ot))Te.element=ot,Te.width=ot.naturalWidth,Te.height=ot.naturalHeight,Te.channels=4;else if(jr(ot))Te.element=ot,Te.width=ot.videoWidth,Te.height=ot.videoHeight,Te.channels=4;else if(ns(ot)){var Ne=Te.width||ot[0].length,me=Te.height||ot.length,We=Te.channels;br(ot[0][0])?We=We||ot[0][0].length:We=We||1;for(var nt=Nl.shape(ot),dt=1,Mt=0;Mt<nt.length;++Mt)dt*=nt[Mt];var Et=bf(Te,dt);Nl.flatten(ot,nt,"",Et),xf(Te,Et),Te.alignment=1,Te.width=Ne,Te.height=me,Te.channels=We,Te.format=Te.internalformat=Lt[We],Te.needsFree=!0}Te.type===Gl?fe(_e.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Te.type===Gs&&fe(_e.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Ot(Te,ut,ot){var wn=Te.element,Rr=Te.data,ye=Te.internalformat,ie=Te.format,Ie=Te.type,Xe=Te.width,Qe=Te.height;lr(Te),wn?z.texImage2D(ut,ot,ie,ie,Ie,wn):Te.compressed?z.compressedTexImage2D(ut,ot,ye,Xe,Qe,0,Rr):Te.needsCopy?(at(),z.copyTexImage2D(ut,ot,ie,Te.xOffset,Te.yOffset,Xe,Qe,0)):z.texImage2D(ut,ot,ie,Xe,Qe,0,ie,Ie,Rr||null)}function Jn(Te,ut,ot,wn,Rr){var ye=Te.element,ie=Te.data,Ie=Te.internalformat,Xe=Te.format,Qe=Te.type,Be=Te.width,Le=Te.height;lr(Te),ye?z.texSubImage2D(ut,Rr,ot,wn,Xe,Qe,ye):Te.compressed?z.compressedTexSubImage2D(ut,Rr,ot,wn,Ie,Be,Le,ie):Te.needsCopy?(at(),z.copyTexSubImage2D(ut,Rr,ot,wn,Te.xOffset,Te.yOffset,Be,Le)):z.texSubImage2D(ut,Rr,ot,wn,Be,Le,Xe,Qe,ie)}var Ar=[];function Mn(){return Ar.pop()||new pn}function Lr(Te){Te.needsFree&&qn.freeType(Te.data),pn.call(Te),Ar.push(Te)}function hr(){Nt.call(this),this.genMipmaps=!1,this.mipmapHint=Ga,this.mipmask=0,this.images=Array(16)}function Mr(Te,ut,ot){var wn=Te.images[0]=Mn();Te.mipmask=1,wn.width=Te.width=ut,wn.height=Te.height=ot,wn.channels=Te.channels=4}function si(Te,ut){var ot=null;if(Br(ut))ot=Te.images[0]=Mn(),un(ot,Te),en(ot,ut),Te.mipmask=1;else if($n(Te,ut),Array.isArray(ut.mipmap))for(var wn=ut.mipmap,Rr=0;Rr<wn.length;++Rr)ot=Te.images[Rr]=Mn(),un(ot,Te),ot.width>>=Rr,ot.height>>=Rr,en(ot,wn[Rr]),Te.mipmask|=1<<Rr;else ot=Te.images[0]=Mn(),un(ot,Te),en(ot,ut),Te.mipmask=1;un(Te,Te.images[0]),Te.compressed&&(Te.internalformat===go||Te.internalformat===mc||Te.internalformat===eu||Te.internalformat===eh)&&fe(Te.width%4===0&&Te.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function To(Te,ut){for(var ot=Te.images,wn=0;wn<ot.length;++wn){if(!ot[wn])return;Ot(ot[wn],ut,wn)}}var Wo=[];function Vr(){var Te=Wo.pop()||new hr;Nt.call(Te),Te.mipmask=0;for(var ut=0;ut<16;++ut)Te.images[ut]=null;return Te}function oo(Te){for(var ut=Te.images,ot=0;ot<ut.length;++ot)ut[ot]&&Lr(ut[ot]),ut[ot]=null;Wo.push(Te)}function fi(){this.minFilter=ru,this.magFilter=ru,this.wrapS=Ro,this.wrapT=Ro,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ga}function so(Te,ut){if("min"in ut){var ot=ut.min;fe.parameter(ot,$t),Te.minFilter=$t[ot],Ke.indexOf(Te.minFilter)>=0&&!("faces"in ut)&&(Te.genMipmaps=!0)}if("mag"in ut){var wn=ut.mag;fe.parameter(wn,Kt),Te.magFilter=Kt[wn]}var Rr=Te.wrapS,ye=Te.wrapT;if("wrap"in ut){var ie=ut.wrap;typeof ie=="string"?(fe.parameter(ie,Ht),Rr=ye=Ht[ie]):Array.isArray(ie)&&(fe.parameter(ie[0],Ht),fe.parameter(ie[1],Ht),Rr=Ht[ie[0]],ye=Ht[ie[1]])}else{if("wrapS"in ut){var Ie=ut.wrapS;fe.parameter(Ie,Ht),Rr=Ht[Ie]}if("wrapT"in ut){var Xe=ut.wrapT;fe.parameter(Xe,Ht),ye=Ht[Xe]}}if(Te.wrapS=Rr,Te.wrapT=ye,"anisotropic"in ut){var Qe=ut.anisotropic;fe(typeof Qe=="number"&&Qe>=1&&Qe<=_e.maxAnisotropic,"aniso samples must be between 1 and "),Te.anisotropic=ut.anisotropic}if("mipmap"in ut){var Be=!1;switch(typeof ut.mipmap){case"string":fe.parameter(ut.mipmap,zt,"invalid mipmap hint"),Te.mipmapHint=zt[ut.mipmap],Te.genMipmaps=!0,Be=!0;break;case"boolean":Be=Te.genMipmaps=ut.mipmap;break;case"object":fe(Array.isArray(ut.mipmap),"invalid mipmap type"),Te.genMipmaps=!1,Be=!0;break;default:fe.raise("invalid mipmap type")}Be&&!("min"in ut)&&(Te.minFilter=nl)}}function Mo(Te,ut){z.texParameteri(ut,nh,Te.minFilter),z.texParameteri(ut,ys,Te.magFilter),z.texParameteri(ut,nu,Te.wrapS),z.texParameteri(ut,th,Te.wrapT),de.ext_texture_filter_anisotropic&&z.texParameteri(ut,jp,Te.anisotropic),Te.genMipmaps&&(z.hint(yc,Te.mipmapHint),z.generateMipmap(ut))}var Po=0,is={},os=_e.maxTextureUnits,mo=Array(os).map(function(){return null});function wr(Te){Nt.call(this),this.mipmask=0,this.internalformat=La,this.id=Po++,this.refCount=1,this.target=Te,this.texture=z.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new fi,mt.profile&&(this.stats={size:0})}function ss(Te){z.activeTexture(Re),z.bindTexture(Te.target,Te.texture)}function ai(){var Te=mo[0];Te?z.bindTexture(Te.target,Te.texture):z.bindTexture(Gr,null)}function Yn(Te){var ut=Te.texture;fe(ut,"must not double destroy texture");var ot=Te.unit,wn=Te.target;ot>=0&&(z.activeTexture(Re+ot),z.bindTexture(wn,null),mo[ot]=null),z.deleteTexture(ut),Te.texture=null,Te.params=null,Te.pixels=null,Te.refCount=0,delete is[Te.id],lt.textureCount--}P(wr.prototype,{bind:function(){var Te=this;Te.bindCount+=1;var ut=Te.unit;if(ut<0){for(var ot=0;ot<os;++ot){var wn=mo[ot];if(wn){if(wn.bindCount>0)continue;wn.unit=-1}mo[ot]=Te,ut=ot;break}ut>=os&&fe.raise("insufficient number of texture units"),mt.profile&&lt.maxTextureUnits<ut+1&&(lt.maxTextureUnits=ut+1),Te.unit=ut,z.activeTexture(Re+ut),z.bindTexture(Te.target,Te.texture)}return ut},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Yn(this)}});function kr(Te,ut){var ot=new wr(Gr);is[ot.id]=ot,lt.textureCount++;function wn(ie,Ie){var Xe=ot.texInfo;fi.call(Xe);var Qe=Vr();return typeof ie=="number"?typeof Ie=="number"?Mr(Qe,ie|0,Ie|0):Mr(Qe,ie|0,ie|0):ie?(fe.type(ie,"object","invalid arguments to regl.texture"),so(Xe,ie),si(Qe,ie)):Mr(Qe,1,1),Xe.genMipmaps&&(Qe.mipmask=(Qe.width<<1)-1),ot.mipmask=Qe.mipmask,un(ot,Qe),fe.texture2D(Xe,Qe,_e),ot.internalformat=Qe.internalformat,wn.width=Qe.width,wn.height=Qe.height,ss(ot),To(Qe,Gr),Mo(Xe,Gr),ai(),oo(Qe),mt.profile&&(ot.stats.size=mi(ot.internalformat,ot.type,Qe.width,Qe.height,Xe.genMipmaps,!1)),wn.format=Jt[ot.internalformat],wn.type=mn[ot.type],wn.mag=Dt[Xe.magFilter],wn.min=Cn[Xe.minFilter],wn.wrapS=Ft[Xe.wrapS],wn.wrapT=Ft[Xe.wrapT],wn}function Rr(ie,Ie,Xe,Qe){fe(!!ie,"must specify image data");var Be=Ie|0,Le=Xe|0,$e=Qe|0,xe=Mn();return un(xe,ot),xe.width=0,xe.height=0,en(xe,ie),xe.width=xe.width||(ot.width>>$e)-Be,xe.height=xe.height||(ot.height>>$e)-Le,fe(ot.type===xe.type&&ot.format===xe.format&&ot.internalformat===xe.internalformat,"incompatible format for texture.subimage"),fe(Be>=0&&Le>=0&&Be+xe.width<=ot.width&&Le+xe.height<=ot.height,"texture.subimage write out of bounds"),fe(ot.mipmask&1<<$e,"missing mipmap data"),fe(xe.data||xe.element||xe.needsCopy,"missing image data"),ss(ot),Jn(xe,Gr,Be,Le,$e),ai(),Lr(xe),wn}function ye(ie,Ie){var Xe=ie|0,Qe=Ie|0||Xe;if(Xe===ot.width&&Qe===ot.height)return wn;wn.width=ot.width=Xe,wn.height=ot.height=Qe,ss(ot);for(var Be=0;ot.mipmask>>Be;++Be){var Le=Xe>>Be,$e=Qe>>Be;if(!Le||!$e)break;z.texImage2D(Gr,Be,ot.format,Le,$e,0,ot.format,ot.type,null)}return ai(),mt.profile&&(ot.stats.size=mi(ot.internalformat,ot.type,Xe,Qe,!1,!1)),wn}return wn(Te,ut),wn.subimage=Rr,wn.resize=ye,wn._reglType="texture2d",wn._texture=ot,mt.profile&&(wn.stats=ot.stats),wn.destroy=function(){ot.decRef()},wn}function Wr(Te,ut,ot,wn,Rr,ye){var ie=new wr(Vi);is[ie.id]=ie,lt.cubeCount++;var Ie=new Array(6);function Xe(Le,$e,xe,Ne,me,We){var nt,dt=ie.texInfo;for(fi.call(dt),nt=0;nt<6;++nt)Ie[nt]=Vr();if(typeof Le=="number"||!Le){var Mt=Le|0||1;for(nt=0;nt<6;++nt)Mr(Ie[nt],Mt,Mt)}else if(typeof Le=="object")if($e)si(Ie[0],Le),si(Ie[1],$e),si(Ie[2],xe),si(Ie[3],Ne),si(Ie[4],me),si(Ie[5],We);else if(so(dt,Le),$n(ie,Le),"faces"in Le){var Et=Le.faces;for(fe(Array.isArray(Et)&&Et.length===6,"cube faces must be a length 6 array"),nt=0;nt<6;++nt)fe(typeof Et[nt]=="object"&&!!Et[nt],"invalid input for cube map face"),un(Ie[nt],ie),si(Ie[nt],Et[nt])}else for(nt=0;nt<6;++nt)si(Ie[nt],Le);else fe.raise("invalid arguments to cube map");for(un(ie,Ie[0]),_e.npotTextureCube||fe(Nr(ie.width)&&Nr(ie.height),"your browser does not support non power or two texture dimensions"),dt.genMipmaps?ie.mipmask=(Ie[0].width<<1)-1:ie.mipmask=Ie[0].mipmask,fe.textureCube(ie,dt,Ie,_e),ie.internalformat=Ie[0].internalformat,Xe.width=Ie[0].width,Xe.height=Ie[0].height,ss(ie),nt=0;nt<6;++nt)To(Ie[nt],tl+nt);for(Mo(dt,Vi),ai(),mt.profile&&(ie.stats.size=mi(ie.internalformat,ie.type,Xe.width,Xe.height,dt.genMipmaps,!0)),Xe.format=Jt[ie.internalformat],Xe.type=mn[ie.type],Xe.mag=Dt[dt.magFilter],Xe.min=Cn[dt.minFilter],Xe.wrapS=Ft[dt.wrapS],Xe.wrapT=Ft[dt.wrapT],nt=0;nt<6;++nt)oo(Ie[nt]);return Xe}function Qe(Le,$e,xe,Ne,me){fe(!!$e,"must specify image data"),fe(typeof Le=="number"&&Le===(Le|0)&&Le>=0&&Le<6,"invalid face");var We=xe|0,nt=Ne|0,dt=me|0,Mt=Mn();return un(Mt,ie),Mt.width=0,Mt.height=0,en(Mt,$e),Mt.width=Mt.width||(ie.width>>dt)-We,Mt.height=Mt.height||(ie.height>>dt)-nt,fe(ie.type===Mt.type&&ie.format===Mt.format&&ie.internalformat===Mt.internalformat,"incompatible format for texture.subimage"),fe(We>=0&&nt>=0&&We+Mt.width<=ie.width&&nt+Mt.height<=ie.height,"texture.subimage write out of bounds"),fe(ie.mipmask&1<<dt,"missing mipmap data"),fe(Mt.data||Mt.element||Mt.needsCopy,"missing image data"),ss(ie),Jn(Mt,tl+Le,We,nt,dt),ai(),Lr(Mt),Xe}function Be(Le){var $e=Le|0;if($e!==ie.width){Xe.width=ie.width=$e,Xe.height=ie.height=$e,ss(ie);for(var xe=0;xe<6;++xe)for(var Ne=0;ie.mipmask>>Ne;++Ne)z.texImage2D(tl+xe,Ne,ie.format,$e>>Ne,$e>>Ne,0,ie.format,ie.type,null);return ai(),mt.profile&&(ie.stats.size=mi(ie.internalformat,ie.type,Xe.width,Xe.height,!1,!0)),Xe}}return Xe(Te,ut,ot,wn,Rr,ye),Xe.subimage=Qe,Xe.resize=Be,Xe._reglType="textureCube",Xe._texture=ie,mt.profile&&(Xe.stats=ie.stats),Xe.destroy=function(){ie.decRef()},Xe}function ao(){for(var Te=0;Te<os;++Te)z.activeTexture(Re+Te),z.bindTexture(Gr,null),mo[Te]=null;wo(is).forEach(Yn),lt.cubeCount=0,lt.textureCount=0}mt.profile&&(lt.getTotalTextureSize=function(){var Te=0;return Object.keys(is).forEach(function(ut){Te+=is[ut].stats.size}),Te});function Us(){for(var Te=0;Te<os;++Te){var ut=mo[Te];ut&&(ut.bindCount=0,ut.unit=-1,mo[Te]=null)}wo(is).forEach(function(ot){ot.texture=z.createTexture(),z.bindTexture(ot.target,ot.texture);for(var wn=0;wn<32;++wn)if((ot.mipmask&1<<wn)!==0)if(ot.target===Gr)z.texImage2D(Gr,wn,ot.internalformat,ot.width>>wn,ot.height>>wn,0,ot.internalformat,ot.type,null);else for(var Rr=0;Rr<6;++Rr)z.texImage2D(tl+Rr,wn,ot.internalformat,ot.width>>wn,ot.height>>wn,0,ot.internalformat,ot.type,null);Mo(ot.texInfo,ot.target)})}function Ed(){for(var Te=0;Te<os;++Te){var ut=mo[Te];ut&&(ut.bindCount=0,ut.unit=-1,mo[Te]=null),z.activeTexture(Re+Te),z.bindTexture(Gr,null),z.bindTexture(Vi,null)}}return{create2D:kr,createCube:Wr,clear:ao,getTexture:function(Te){return null},restore:Us,refresh:Ed}}var ol=36161,Vt=32854,ld=32855,au=36194,Yg=33189,lu=36168,rh=34041,qi=35907,pa=34836,ih=34842,ga=34843,Ba=[];Ba[Vt]=2,Ba[ld]=2,Ba[au]=2,Ba[Yg]=2,Ba[lu]=1,Ba[rh]=4,Ba[qi]=4,Ba[pa]=16,Ba[ih]=8,Ba[ga]=6;function Cf(z,de,_e){return Ba[z]*de*_e}var wf=function(z,de,_e,at,Tt){var lt={rgba4:Vt,rgb565:au,"rgb5 a1":ld,depth:Yg,stencil:lu,"depth stencil":rh};de.ext_srgb&&(lt.srgba=qi),de.ext_color_buffer_half_float&&(lt.rgba16f=ih,lt.rgb16f=ga),de.webgl_color_buffer_float&&(lt.rgba32f=pa);var mt=[];Object.keys(lt).forEach(function(Ut){var an=lt[Ut];mt[an]=Ut});var zt=0,Ht={};function Kt(Ut){this.id=zt++,this.refCount=1,this.renderbuffer=Ut,this.format=Vt,this.width=0,this.height=0,Tt.profile&&(this.stats={size:0})}Kt.prototype.decRef=function(){--this.refCount<=0&&$t(this)};function $t(Ut){var an=Ut.renderbuffer;fe(an,"must not double destroy renderbuffer"),z.bindRenderbuffer(ol,null),z.deleteRenderbuffer(an),Ut.renderbuffer=null,Ut.refCount=0,delete Ht[Ut.id],at.renderbufferCount--}function sn(Ut,an){var Je=new Kt(z.createRenderbuffer());Ht[Je.id]=Je,at.renderbufferCount++;function yt(mn,Dt){var Cn=0,Ft=0,ln=Vt;if(typeof mn=="object"&&mn){var Nt=mn;if("shape"in Nt){var un=Nt.shape;fe(Array.isArray(un)&&un.length>=2,"invalid renderbuffer shape"),Cn=un[0]|0,Ft=un[1]|0}else"radius"in Nt&&(Cn=Ft=Nt.radius|0),"width"in Nt&&(Cn=Nt.width|0),"height"in Nt&&(Ft=Nt.height|0);"format"in Nt&&(fe.parameter(Nt.format,lt,"invalid renderbuffer format"),ln=lt[Nt.format])}else typeof mn=="number"?(Cn=mn|0,typeof Dt=="number"?Ft=Dt|0:Ft=Cn):mn?fe.raise("invalid arguments to renderbuffer constructor"):Cn=Ft=1;if(fe(Cn>0&&Ft>0&&Cn<=_e.maxRenderbufferSize&&Ft<=_e.maxRenderbufferSize,"invalid renderbuffer size"),!(Cn===Je.width&&Ft===Je.height&&ln===Je.format))return yt.width=Je.width=Cn,yt.height=Je.height=Ft,Je.format=ln,z.bindRenderbuffer(ol,Je.renderbuffer),z.renderbufferStorage(ol,ln,Cn,Ft),fe(z.getError()===0,"invalid render buffer format"),Tt.profile&&(Je.stats.size=Cf(Je.format,Je.width,Je.height)),yt.format=mt[Je.format],yt}function Jt(mn,Dt){var Cn=mn|0,Ft=Dt|0||Cn;return Cn===Je.width&&Ft===Je.height||(fe(Cn>0&&Ft>0&&Cn<=_e.maxRenderbufferSize&&Ft<=_e.maxRenderbufferSize,"invalid renderbuffer size"),yt.width=Je.width=Cn,yt.height=Je.height=Ft,z.bindRenderbuffer(ol,Je.renderbuffer),z.renderbufferStorage(ol,Je.format,Cn,Ft),fe(z.getError()===0,"invalid render buffer format"),Tt.profile&&(Je.stats.size=Cf(Je.format,Je.width,Je.height))),yt}return yt(Ut,an),yt.resize=Jt,yt._reglType="renderbuffer",yt._renderbuffer=Je,Tt.profile&&(yt.stats=Je.stats),yt.destroy=function(){Je.decRef()},yt}Tt.profile&&(at.getTotalRenderbufferSize=function(){var Ut=0;return Object.keys(Ht).forEach(function(an){Ut+=Ht[an].stats.size}),Ut});function fn(){wo(Ht).forEach(function(Ut){Ut.renderbuffer=z.createRenderbuffer(),z.bindRenderbuffer(ol,Ut.renderbuffer),z.renderbufferStorage(ol,Ut.format,Ut.width,Ut.height)}),z.bindRenderbuffer(ol,null)}return{create:sn,clear:function(){wo(Ht).forEach($t)},restore:fn}},na=36160,cu=36161,xc=3553,uu=34069,j0=36064,Hp=36096,$p=36128,Ef=33306,Kg=36053,qg=36054,H0=36055,Sf=36057,Cc=36061,oh=36193,$0=5121,wc=5126,Jg=6407,Af=6408,sh=6402,Os=[Jg,Af],ah=[];ah[Af]=4,ah[Jg]=3;var lh=[];lh[$0]=1,lh[wc]=4,lh[oh]=2;var cd=32854,W0=32855,Qg=36194,Z0=33189,hs=36168,Ec=34041,Tf=35907,em=34836,Sc=34842,X0=34843,Mf=[cd,W0,Qg,Tf,Sc,X0,em],Ac={};Ac[Kg]="complete",Ac[qg]="incomplete attachment",Ac[Sf]="incomplete dimensions",Ac[H0]="incomplete, missing attachment",Ac[Cc]="unsupported";function tm(z,de,_e,at,Tt,lt){var mt={cur:null,next:null,dirty:!1,setFBO:null},zt=["rgba"],Ht=["rgba4","rgb565","rgb5 a1"];de.ext_srgb&&Ht.push("srgba"),de.ext_color_buffer_half_float&&Ht.push("rgba16f","rgb16f"),de.webgl_color_buffer_float&&Ht.push("rgba32f");var Kt=["uint8"];de.oes_texture_half_float&&Kt.push("half float","float16"),de.oes_texture_float&&Kt.push("float","float32");function $t(pn,en,Ot){this.target=pn,this.texture=en,this.renderbuffer=Ot;var Jn=0,Ar=0;en?(Jn=en.width,Ar=en.height):Ot&&(Jn=Ot.width,Ar=Ot.height),this.width=Jn,this.height=Ar}function sn(pn){pn&&(pn.texture&&pn.texture._texture.decRef(),pn.renderbuffer&&pn.renderbuffer._renderbuffer.decRef())}function fn(pn,en,Ot){if(!!pn)if(pn.texture){var Jn=pn.texture._texture,Ar=Math.max(1,Jn.width),Mn=Math.max(1,Jn.height);fe(Ar===en&&Mn===Ot,"inconsistent width/height for supplied texture"),Jn.refCount+=1}else{var Lr=pn.renderbuffer._renderbuffer;fe(Lr.width===en&&Lr.height===Ot,"inconsistent width/height for renderbuffer"),Lr.refCount+=1}}function Ut(pn,en){en&&(en.texture?z.framebufferTexture2D(na,pn,en.target,en.texture._texture.texture,0):z.framebufferRenderbuffer(na,pn,cu,en.renderbuffer._renderbuffer.renderbuffer))}function an(pn){var en=xc,Ot=null,Jn=null,Ar=pn;typeof pn=="object"&&(Ar=pn.data,"target"in pn&&(en=pn.target|0)),fe.type(Ar,"function","invalid attachment data");var Mn=Ar._reglType;return Mn==="texture2d"?(Ot=Ar,fe(en===xc)):Mn==="textureCube"?(Ot=Ar,fe(en>=uu&&en<uu+6,"invalid cube map target")):Mn==="renderbuffer"?(Jn=Ar,en=cu):fe.raise("invalid regl object for attachment"),new $t(en,Ot,Jn)}function Je(pn,en,Ot,Jn,Ar){if(Ot){var Mn=at.create2D({width:pn,height:en,format:Jn,type:Ar});return Mn._texture.refCount=0,new $t(xc,Mn,null)}else{var Lr=Tt.create({width:pn,height:en,format:Jn});return Lr._renderbuffer.refCount=0,new $t(cu,null,Lr)}}function yt(pn){return pn&&(pn.texture||pn.renderbuffer)}function Jt(pn,en,Ot){pn&&(pn.texture?pn.texture.resize(en,Ot):pn.renderbuffer&&pn.renderbuffer.resize(en,Ot),pn.width=en,pn.height=Ot)}var mn=0,Dt={};function Cn(){this.id=mn++,Dt[this.id]=this,this.framebuffer=z.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ft(pn){pn.colorAttachments.forEach(sn),sn(pn.depthAttachment),sn(pn.stencilAttachment),sn(pn.depthStencilAttachment)}function ln(pn){var en=pn.framebuffer;fe(en,"must not double destroy framebuffer"),z.deleteFramebuffer(en),pn.framebuffer=null,lt.framebufferCount--,delete Dt[pn.id]}function Nt(pn){var en;z.bindFramebuffer(na,pn.framebuffer);var Ot=pn.colorAttachments;for(en=0;en<Ot.length;++en)Ut(j0+en,Ot[en]);for(en=Ot.length;en<_e.maxColorAttachments;++en)z.framebufferTexture2D(na,j0+en,xc,null,0);z.framebufferTexture2D(na,Ef,xc,null,0),z.framebufferTexture2D(na,Hp,xc,null,0),z.framebufferTexture2D(na,$p,xc,null,0),Ut(Hp,pn.depthAttachment),Ut($p,pn.stencilAttachment),Ut(Ef,pn.depthStencilAttachment);var Jn=z.checkFramebufferStatus(na);!z.isContextLost()&&Jn!==Kg&&fe.raise("framebuffer configuration not supported, status = "+Ac[Jn]),z.bindFramebuffer(na,mt.next?mt.next.framebuffer:null),mt.cur=mt.next,z.getError()}function un(pn,en){var Ot=new Cn;lt.framebufferCount++;function Jn(Mn,Lr){var hr;fe(mt.next!==Ot,"can not update framebuffer which is currently in use");var Mr=0,si=0,To=!0,Wo=!0,Vr=null,oo=!0,fi="rgba",so="uint8",Mo=1,Po=null,is=null,os=null,mo=!1;if(typeof Mn=="number")Mr=Mn|0,si=Lr|0||Mr;else if(!Mn)Mr=si=1;else{fe.type(Mn,"object","invalid arguments for framebuffer");var wr=Mn;if("shape"in wr){var ss=wr.shape;fe(Array.isArray(ss)&&ss.length>=2,"invalid shape for framebuffer"),Mr=ss[0],si=ss[1]}else"radius"in wr&&(Mr=si=wr.radius),"width"in wr&&(Mr=wr.width),"height"in wr&&(si=wr.height);("color"in wr||"colors"in wr)&&(Vr=wr.color||wr.colors,Array.isArray(Vr)&&fe(Vr.length===1||de.webgl_draw_buffers,"multiple render targets not supported")),Vr||("colorCount"in wr&&(Mo=wr.colorCount|0,fe(Mo>0,"invalid color buffer count")),"colorTexture"in wr&&(oo=!!wr.colorTexture,fi="rgba4"),"colorType"in wr&&(so=wr.colorType,oo?(fe(de.oes_texture_float||!(so==="float"||so==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),fe(de.oes_texture_half_float||!(so==="half float"||so==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):so==="half float"||so==="float16"?(fe(de.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),fi="rgba16f"):(so==="float"||so==="float32")&&(fe(de.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),fi="rgba32f"),fe.oneOf(so,Kt,"invalid color type")),"colorFormat"in wr&&(fi=wr.colorFormat,zt.indexOf(fi)>=0?oo=!0:Ht.indexOf(fi)>=0?oo=!1:oo?fe.oneOf(wr.colorFormat,zt,"invalid color format for texture"):fe.oneOf(wr.colorFormat,Ht,"invalid color format for renderbuffer"))),("depthTexture"in wr||"depthStencilTexture"in wr)&&(mo=!!(wr.depthTexture||wr.depthStencilTexture),fe(!mo||de.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in wr&&(typeof wr.depth=="boolean"?To=wr.depth:(Po=wr.depth,Wo=!1)),"stencil"in wr&&(typeof wr.stencil=="boolean"?Wo=wr.stencil:(is=wr.stencil,To=!1)),"depthStencil"in wr&&(typeof wr.depthStencil=="boolean"?To=Wo=wr.depthStencil:(os=wr.depthStencil,To=!1,Wo=!1))}var ai=null,Yn=null,kr=null,Wr=null;if(Array.isArray(Vr))ai=Vr.map(an);else if(Vr)ai=[an(Vr)];else for(ai=new Array(Mo),hr=0;hr<Mo;++hr)ai[hr]=Je(Mr,si,oo,fi,so);fe(de.webgl_draw_buffers||ai.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),fe(ai.length<=_e.maxColorAttachments,"too many color attachments, not supported"),Mr=Mr||ai[0].width,si=si||ai[0].height,Po?Yn=an(Po):To&&!Wo&&(Yn=Je(Mr,si,mo,"depth","uint32")),is?kr=an(is):Wo&&!To&&(kr=Je(Mr,si,!1,"stencil","uint8")),os?Wr=an(os):!Po&&!is&&Wo&&To&&(Wr=Je(Mr,si,mo,"depth stencil","depth stencil")),fe(!!Po+!!is+!!os<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ao=null;for(hr=0;hr<ai.length;++hr)if(fn(ai[hr],Mr,si),fe(!ai[hr]||ai[hr].texture&&Os.indexOf(ai[hr].texture._texture.format)>=0||ai[hr].renderbuffer&&Mf.indexOf(ai[hr].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+hr+" is invalid"),ai[hr]&&ai[hr].texture){var Us=ah[ai[hr].texture._texture.format]*lh[ai[hr].texture._texture.type];ao===null?ao=Us:fe(ao===Us,"all color attachments much have the same number of bits per pixel.")}return fn(Yn,Mr,si),fe(!Yn||Yn.texture&&Yn.texture._texture.format===sh||Yn.renderbuffer&&Yn.renderbuffer._renderbuffer.format===Z0,"invalid depth attachment for framebuffer object"),fn(kr,Mr,si),fe(!kr||kr.renderbuffer&&kr.renderbuffer._renderbuffer.format===hs,"invalid stencil attachment for framebuffer object"),fn(Wr,Mr,si),fe(!Wr||Wr.texture&&Wr.texture._texture.format===Ec||Wr.renderbuffer&&Wr.renderbuffer._renderbuffer.format===Ec,"invalid depth-stencil attachment for framebuffer object"),Ft(Ot),Ot.width=Mr,Ot.height=si,Ot.colorAttachments=ai,Ot.depthAttachment=Yn,Ot.stencilAttachment=kr,Ot.depthStencilAttachment=Wr,Jn.color=ai.map(yt),Jn.depth=yt(Yn),Jn.stencil=yt(kr),Jn.depthStencil=yt(Wr),Jn.width=Ot.width,Jn.height=Ot.height,Nt(Ot),Jn}function Ar(Mn,Lr){fe(mt.next!==Ot,"can not resize a framebuffer which is currently in use");var hr=Math.max(Mn|0,1),Mr=Math.max(Lr|0||hr,1);if(hr===Ot.width&&Mr===Ot.height)return Jn;for(var si=Ot.colorAttachments,To=0;To<si.length;++To)Jt(si[To],hr,Mr);return Jt(Ot.depthAttachment,hr,Mr),Jt(Ot.stencilAttachment,hr,Mr),Jt(Ot.depthStencilAttachment,hr,Mr),Ot.width=Jn.width=hr,Ot.height=Jn.height=Mr,Nt(Ot),Jn}return Jn(pn,en),P(Jn,{resize:Ar,_reglType:"framebuffer",_framebuffer:Ot,destroy:function(){ln(Ot),Ft(Ot)},use:function(Mn){mt.setFBO({framebuffer:Jn},Mn)}})}function $n(pn){var en=Array(6);function Ot(Ar){var Mn;fe(en.indexOf(mt.next)<0,"can not update framebuffer which is currently in use");var Lr={color:null},hr=0,Mr=null,si="rgba",To="uint8",Wo=1;if(typeof Ar=="number")hr=Ar|0;else if(!Ar)hr=1;else{fe.type(Ar,"object","invalid arguments for framebuffer");var Vr=Ar;if("shape"in Vr){var oo=Vr.shape;fe(Array.isArray(oo)&&oo.length>=2,"invalid shape for framebuffer"),fe(oo[0]===oo[1],"cube framebuffer must be square"),hr=oo[0]}else"radius"in Vr&&(hr=Vr.radius|0),"width"in Vr?(hr=Vr.width|0,"height"in Vr&&fe(Vr.height===hr,"must be square")):"height"in Vr&&(hr=Vr.height|0);("color"in Vr||"colors"in Vr)&&(Mr=Vr.color||Vr.colors,Array.isArray(Mr)&&fe(Mr.length===1||de.webgl_draw_buffers,"multiple render targets not supported")),Mr||("colorCount"in Vr&&(Wo=Vr.colorCount|0,fe(Wo>0,"invalid color buffer count")),"colorType"in Vr&&(fe.oneOf(Vr.colorType,Kt,"invalid color type"),To=Vr.colorType),"colorFormat"in Vr&&(si=Vr.colorFormat,fe.oneOf(Vr.colorFormat,zt,"invalid color format for texture"))),"depth"in Vr&&(Lr.depth=Vr.depth),"stencil"in Vr&&(Lr.stencil=Vr.stencil),"depthStencil"in Vr&&(Lr.depthStencil=Vr.depthStencil)}var fi;if(Mr)if(Array.isArray(Mr))for(fi=[],Mn=0;Mn<Mr.length;++Mn)fi[Mn]=Mr[Mn];else fi=[Mr];else{fi=Array(Wo);var so={radius:hr,format:si,type:To};for(Mn=0;Mn<Wo;++Mn)fi[Mn]=at.createCube(so)}for(Lr.color=Array(fi.length),Mn=0;Mn<fi.length;++Mn){var Mo=fi[Mn];fe(typeof Mo=="function"&&Mo._reglType==="textureCube","invalid cube map"),hr=hr||Mo.width,fe(Mo.width===hr&&Mo.height===hr,"invalid cube map shape"),Lr.color[Mn]={target:uu,data:fi[Mn]}}for(Mn=0;Mn<6;++Mn){for(var Po=0;Po<fi.length;++Po)Lr.color[Po].target=uu+Mn;Mn>0&&(Lr.depth=en[0].depth,Lr.stencil=en[0].stencil,Lr.depthStencil=en[0].depthStencil),en[Mn]?en[Mn](Lr):en[Mn]=un(Lr)}return P(Ot,{width:hr,height:hr,color:fi})}function Jn(Ar){var Mn,Lr=Ar|0;if(fe(Lr>0&&Lr<=_e.maxCubeMapSize,"invalid radius for cube fbo"),Lr===Ot.width)return Ot;var hr=Ot.color;for(Mn=0;Mn<hr.length;++Mn)hr[Mn].resize(Lr);for(Mn=0;Mn<6;++Mn)en[Mn].resize(Lr);return Ot.width=Ot.height=Lr,Ot}return Ot(pn),P(Ot,{faces:en,resize:Jn,_reglType:"framebufferCube",destroy:function(){en.forEach(function(Ar){Ar.destroy()})}})}function lr(){mt.cur=null,mt.next=null,mt.dirty=!0,wo(Dt).forEach(function(pn){pn.framebuffer=z.createFramebuffer(),Nt(pn)})}return P(mt,{getFramebuffer:function(pn){if(typeof pn=="function"&&pn._reglType==="framebuffer"){var en=pn._framebuffer;if(en instanceof Cn)return en}return null},create:un,createCube:$n,clear:function(){wo(Dt).forEach(ln)},restore:lr})}var du=5126,nm=34962;function $i(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=du,this.offset=0,this.stride=0,this.divisor=0}function io(z,de,_e,at,Tt){for(var lt=_e.maxAttributes,mt=new Array(lt),zt=0;zt<lt;++zt)mt[zt]=new $i;var Ht=0,Kt={},$t={Record:$i,scope:{},state:mt,currentVAO:null,targetVAO:null,restore:fn()?Dt:function(){},createVAO:Cn,getVAO:an,destroyBuffer:sn,setVAO:fn()?Je:yt,clear:fn()?Jt:function(){}};function sn(Ft){for(var ln=0;ln<mt.length;++ln){var Nt=mt[ln];Nt.buffer===Ft&&(z.disableVertexAttribArray(ln),Nt.buffer=null)}}function fn(){return de.oes_vertex_array_object}function Ut(){return de.angle_instanced_arrays}function an(Ft){return typeof Ft=="function"&&Ft._vao?Ft._vao:null}function Je(Ft){if(Ft!==$t.currentVAO){var ln=fn();Ft?ln.bindVertexArrayOES(Ft.vao):ln.bindVertexArrayOES(null),$t.currentVAO=Ft}}function yt(Ft){if(Ft!==$t.currentVAO){if(Ft)Ft.bindAttrs();else for(var ln=Ut(),Nt=0;Nt<mt.length;++Nt){var un=mt[Nt];un.buffer?(z.enableVertexAttribArray(Nt),z.vertexAttribPointer(Nt,un.size,un.type,un.normalized,un.stride,un.offfset),ln&&un.divisor&&ln.vertexAttribDivisorANGLE(Nt,un.divisor)):(z.disableVertexAttribArray(Nt),z.vertexAttrib4f(Nt,un.x,un.y,un.z,un.w))}$t.currentVAO=Ft}}function Jt(){wo(Kt).forEach(function(Ft){Ft.destroy()})}function mn(){this.id=++Ht,this.attributes=[];var Ft=fn();Ft?this.vao=Ft.createVertexArrayOES():this.vao=null,Kt[this.id]=this,this.buffers=[]}mn.prototype.bindAttrs=function(){for(var Ft=Ut(),ln=this.attributes,Nt=0;Nt<ln.length;++Nt){var un=ln[Nt];un.buffer?(z.enableVertexAttribArray(Nt),z.bindBuffer(nm,un.buffer.buffer),z.vertexAttribPointer(Nt,un.size,un.type,un.normalized,un.stride,un.offset),Ft&&un.divisor&&Ft.vertexAttribDivisorANGLE(Nt,un.divisor)):(z.disableVertexAttribArray(Nt),z.vertexAttrib4f(Nt,un.x,un.y,un.z,un.w))}for(var $n=ln.length;$n<lt;++$n)z.disableVertexAttribArray($n)},mn.prototype.refresh=function(){var Ft=fn();Ft&&(Ft.bindVertexArrayOES(this.vao),this.bindAttrs(),$t.currentVAO=this)},mn.prototype.destroy=function(){if(this.vao){var Ft=fn();this===$t.currentVAO&&($t.currentVAO=null,Ft.bindVertexArrayOES(null)),Ft.deleteVertexArrayOES(this.vao),this.vao=null}Kt[this.id]&&(delete Kt[this.id],at.vaoCount-=1)};function Dt(){var Ft=fn();Ft&&wo(Kt).forEach(function(ln){ln.refresh()})}function Cn(Ft){var ln=new mn;at.vaoCount+=1;function Nt(un){fe(Array.isArray(un),"arguments to vertex array constructor must be an array"),fe(un.length<lt,"too many attributes"),fe(un.length>0,"must specify at least one attribute");var $n={},lr=ln.attributes;lr.length=un.length;for(var pn=0;pn<un.length;++pn){var en=un[pn],Ot=lr[pn]=new $i,Jn=en.data||en;if(Array.isArray(Jn)||$(Jn)||no(Jn)){var Ar;ln.buffers[pn]&&(Ar=ln.buffers[pn],$(Jn)&&Ar._buffer.byteLength>=Jn.byteLength?Ar.subdata(Jn):(Ar.destroy(),ln.buffers[pn]=null)),ln.buffers[pn]||(Ar=ln.buffers[pn]=Tt.create(en,nm,!1,!0)),Ot.buffer=Tt.getBuffer(Ar),Ot.size=Ot.buffer.dimension|0,Ot.normalized=!1,Ot.type=Ot.buffer.dtype,Ot.offset=0,Ot.stride=0,Ot.divisor=0,Ot.state=1,$n[pn]=1}else Tt.getBuffer(en)?(Ot.buffer=Tt.getBuffer(en),Ot.size=Ot.buffer.dimension|0,Ot.normalized=!1,Ot.type=Ot.buffer.dtype,Ot.offset=0,Ot.stride=0,Ot.divisor=0,Ot.state=1):Tt.getBuffer(en.buffer)?(Ot.buffer=Tt.getBuffer(en.buffer),Ot.size=(+en.size||Ot.buffer.dimension)|0,Ot.normalized=!!en.normalized||!1,"type"in en?(fe.parameter(en.type,Qs,"invalid buffer type"),Ot.type=Qs[en.type]):Ot.type=Ot.buffer.dtype,Ot.offset=(en.offset||0)|0,Ot.stride=(en.stride||0)|0,Ot.divisor=(en.divisor||0)|0,Ot.state=1,fe(Ot.size>=1&&Ot.size<=4,"size must be between 1 and 4"),fe(Ot.offset>=0,"invalid offset"),fe(Ot.stride>=0&&Ot.stride<=255,"stride must be between 0 and 255"),fe(Ot.divisor>=0,"divisor must be positive"),fe(!Ot.divisor||!!de.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in en?(fe(pn>0,"first attribute must not be a constant"),Ot.x=+en.x||0,Ot.y=+en.y||0,Ot.z=+en.z||0,Ot.w=+en.w||0,Ot.state=2):fe(!1,"invalid attribute spec for location "+pn)}for(var Mn=0;Mn<ln.buffers.length;++Mn)!$n[Mn]&&ln.buffers[Mn]&&(ln.buffers[Mn].destroy(),ln.buffers[Mn]=null);return ln.refresh(),Nt}return Nt.destroy=function(){for(var un=0;un<ln.buffers.length;++un)ln.buffers[un]&&ln.buffers[un].destroy();ln.buffers.length=0,ln.destroy()},Nt._vao=ln,Nt._reglType="vao",Nt(Ft)}return $t}var hu=35632,fu=35633,Pf=35718,Of=35721;function Df(z,de,_e,at){var Tt={},lt={};function mt(Je,yt,Jt,mn){this.name=Je,this.id=yt,this.location=Jt,this.info=mn}function zt(Je,yt){for(var Jt=0;Jt<Je.length;++Jt)if(Je[Jt].id===yt.id){Je[Jt].location=yt.location;return}Je.push(yt)}function Ht(Je,yt,Jt){var mn=Je===hu?Tt:lt,Dt=mn[yt];if(!Dt){var Cn=de.str(yt);Dt=z.createShader(Je),z.shaderSource(Dt,Cn),z.compileShader(Dt),fe.shaderError(z,Dt,Cn,Je,Jt),mn[yt]=Dt}return Dt}var Kt={},$t=[],sn=0;function fn(Je,yt){this.id=sn++,this.fragId=Je,this.vertId=yt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,at.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Ut(Je,yt,Jt){var mn,Dt,Cn=Ht(hu,Je.fragId),Ft=Ht(fu,Je.vertId),ln=Je.program=z.createProgram();if(z.attachShader(ln,Cn),z.attachShader(ln,Ft),Jt)for(mn=0;mn<Jt.length;++mn){var Nt=Jt[mn];z.bindAttribLocation(ln,Nt[0],Nt[1])}z.linkProgram(ln),fe.linkError(z,ln,de.str(Je.fragId),de.str(Je.vertId),yt);var un=z.getProgramParameter(ln,Pf);at.profile&&(Je.stats.uniformsCount=un);var $n=Je.uniforms;for(mn=0;mn<un;++mn)if(Dt=z.getActiveUniform(ln,mn),Dt)if(Dt.size>1)for(var lr=0;lr<Dt.size;++lr){var pn=Dt.name.replace("[0]","["+lr+"]");zt($n,new mt(pn,de.id(pn),z.getUniformLocation(ln,pn),Dt))}else zt($n,new mt(Dt.name,de.id(Dt.name),z.getUniformLocation(ln,Dt.name),Dt));var en=z.getProgramParameter(ln,Of);at.profile&&(Je.stats.attributesCount=en);var Ot=Je.attributes;for(mn=0;mn<en;++mn)Dt=z.getActiveAttrib(ln,mn),Dt&&zt(Ot,new mt(Dt.name,de.id(Dt.name),z.getAttribLocation(ln,Dt.name),Dt))}at.profile&&(_e.getMaxUniformsCount=function(){var Je=0;return $t.forEach(function(yt){yt.stats.uniformsCount>Je&&(Je=yt.stats.uniformsCount)}),Je},_e.getMaxAttributesCount=function(){var Je=0;return $t.forEach(function(yt){yt.stats.attributesCount>Je&&(Je=yt.stats.attributesCount)}),Je});function an(){Tt={},lt={};for(var Je=0;Je<$t.length;++Je)Ut($t[Je],null,$t[Je].attributes.map(function(yt){return[yt.location,yt.name]}))}return{clear:function(){var Je=z.deleteShader.bind(z);wo(Tt).forEach(Je),Tt={},wo(lt).forEach(Je),lt={},$t.forEach(function(yt){z.deleteProgram(yt.program)}),$t.length=0,Kt={},_e.shaderCount=0},program:function(Je,yt,Jt,mn){fe.command(Je>=0,"missing vertex shader",Jt),fe.command(yt>=0,"missing fragment shader",Jt);var Dt=Kt[yt];Dt||(Dt=Kt[yt]={});var Cn=Dt[Je];if(Cn&&(Cn.refCount++,!mn))return Cn;var Ft=new fn(yt,Je);return _e.shaderCount++,Ut(Ft,Jt,mn),Cn||(Dt[Je]=Ft),$t.push(Ft),P(Ft,{destroy:function(){if(Ft.refCount--,Ft.refCount<=0){z.deleteProgram(Ft.program);var ln=$t.indexOf(Ft);$t.splice(ln,1),_e.shaderCount--}Dt[Ft.vertId].refCount<=0&&(z.deleteShader(lt[Ft.vertId]),delete lt[Ft.vertId],delete Kt[Ft.fragId][Ft.vertId]),Object.keys(Kt[Ft.fragId]).length||(z.deleteShader(Tt[Ft.fragId]),delete Tt[Ft.fragId],delete Kt[Ft.fragId])}})},restore:an,shader:Ht,frag:-1,vert:-1}}var zl=6408,bs=5121,Ul=3333,za=5126;function Wp(z,de,_e,at,Tt,lt,mt){function zt($t){var sn;de.next===null?(fe(Tt.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),sn=bs):(fe(de.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),sn=de.next.colorAttachments[0].texture._texture.type,lt.oes_texture_float?(fe(sn===bs||sn===za,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),sn===za&&fe(mt.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):fe(sn===bs,"Reading from a framebuffer is only allowed for the type 'uint8'"));var fn=0,Ut=0,an=at.framebufferWidth,Je=at.framebufferHeight,yt=null;$($t)?yt=$t:$t&&(fe.type($t,"object","invalid arguments to regl.read()"),fn=$t.x|0,Ut=$t.y|0,fe(fn>=0&&fn<at.framebufferWidth,"invalid x offset for regl.read"),fe(Ut>=0&&Ut<at.framebufferHeight,"invalid y offset for regl.read"),an=($t.width||at.framebufferWidth-fn)|0,Je=($t.height||at.framebufferHeight-Ut)|0,yt=$t.data||null),yt&&(sn===bs?fe(yt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):sn===za&&fe(yt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),fe(an>0&&an+fn<=at.framebufferWidth,"invalid width for read pixels"),fe(Je>0&&Je+Ut<=at.framebufferHeight,"invalid height for read pixels"),_e();var Jt=an*Je*4;return yt||(sn===bs?yt=new Uint8Array(Jt):sn===za&&(yt=yt||new Float32Array(Jt))),fe.isTypedArray(yt,"data buffer for regl.read() must be a typedarray"),fe(yt.byteLength>=Jt,"data buffer for regl.read() too small"),z.pixelStorei(Ul,4),z.readPixels(fn,Ut,an,Je,zl,sn,yt),yt}function Ht($t){var sn;return de.setFBO({framebuffer:$t.framebuffer},function(){sn=zt($t)}),sn}function Kt($t){return!$t||!("framebuffer"in $t)?zt($t):Ht($t)}return Kt}function Vl(z){return Array.prototype.slice.call(z)}function sl(z){return Vl(z).join("")}function Zp(){var z=0,de=[],_e=[];function at(sn){for(var fn=0;fn<_e.length;++fn)if(_e[fn]===sn)return de[fn];var Ut="g"+z++;return de.push(Ut),_e.push(sn),Ut}function Tt(){var sn=[];function fn(){sn.push.apply(sn,Vl(arguments))}var Ut=[];function an(){var Je="v"+z++;return Ut.push(Je),arguments.length>0&&(sn.push(Je,"="),sn.push.apply(sn,Vl(arguments)),sn.push(";")),Je}return P(fn,{def:an,toString:function(){return sl([Ut.length>0?"var "+Ut.join(",")+";":"",sl(sn)])}})}function lt(){var sn=Tt(),fn=Tt(),Ut=sn.toString,an=fn.toString;function Je(yt,Jt){fn(yt,Jt,"=",sn.def(yt,Jt),";")}return P(function(){sn.apply(sn,Vl(arguments))},{def:sn.def,entry:sn,exit:fn,save:Je,set:function(yt,Jt,mn){Je(yt,Jt),sn(yt,Jt,"=",mn,";")},toString:function(){return Ut()+an()}})}function mt(){var sn=sl(arguments),fn=lt(),Ut=lt(),an=fn.toString,Je=Ut.toString;return P(fn,{then:function(){return fn.apply(fn,Vl(arguments)),this},else:function(){return Ut.apply(Ut,Vl(arguments)),this},toString:function(){var yt=Je();return yt&&(yt="else{"+yt+"}"),sl(["if(",sn,"){",an(),"}",yt])}})}var zt=Tt(),Ht={};function Kt(sn,fn){var Ut=[];function an(){var Dt="a"+Ut.length;return Ut.push(Dt),Dt}fn=fn||0;for(var Je=0;Je<fn;++Je)an();var yt=lt(),Jt=yt.toString,mn=Ht[sn]=P(yt,{arg:an,toString:function(){return sl(["function(",Ut.join(),"){",Jt(),"}"])}});return mn}function $t(){var sn=['"use strict";',zt,"return {"];Object.keys(Ht).forEach(function(an){sn.push('"',an,'":',Ht[an].toString(),",")}),sn.push("}");var fn=sl(sn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Ut=Function.apply(null,de.concat(fn));return Ut.apply(null,_e)}return{global:zt,link:at,block:Tt,proc:Kt,scope:lt,cond:mt,compile:$t}}var rs="xyzw".split(""),Tc=5121,Ua=1,ud=2,dd=0,hd=1,fd=2,pd=3,al=4,_f=5,ch=6,rm="dither",im="blend.enable",om="blend.color",Nf="blend.equation",Xp="blend.func",sm="depth.enable",am="depth.func",Mc="depth.range",lm="depth.mask",ll="colorMask",cm="cull.enable",Yp="cull.face",um="frontFace",kf="lineWidth",dm="polygonOffset.enable",gd="polygonOffset.offset",md="sample.alpha",cl="sample.enable",Kp="sample.coverage",uh="stencil.enable",dh="stencil.mask",Va="stencil.func",qp="stencil.opFront",pu="stencil.opBack",jl="scissor.enable",Jp="scissor.box",ul="viewport",Hl="profile",ja="framebuffer",Pc="vert",$l="frag",Ha="elements",$a="primitive",dl="count",gu="offset",Rf="instances",Oc="vao",Wl="Width",mu="Height",wa=ja+Wl,hl=ja+mu,If=ul+Wl,hh=ul+mu,fh="drawingBuffer",vd=fh+Wl,ph=fh+mu,vu=[Xp,Nf,Va,qp,pu,Kp,ul,Jp,gd],Zl=34962,Lf=34963,Y0=35632,K0=35633,gh=3553,yd=34067,Ff=2884,mh=3042,Gf=3024,vh=2960,yh=2929,q0=3089,Qp=32823,hm=32926,xs=32928,En=5126,Dc=35664,Bf=35665,Ea=35666,_c=5124,Kr=35667,Nc=35668,bh=35669,zf=35670,xh=35671,Ch=35672,yu=35673,Sa=35674,Ds=35675,Uf=35676,Vf=35678,bu=35680,_s=4,wh=1028,Xl=1029,fm=2304,eg=2305,pm=32775,J0=32776,Q0=519,kc=7680,gm=0,Ns=1,mm=32774,ev=513,vm=36160,ym=36064,fl={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},bm=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],bd={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Yl={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},xm={frag:Y0,vert:K0},tg={cw:fm,ccw:eg};function jf(z){return Array.isArray(z)||$(z)||no(z)}function Hf(z){return z.sort(function(de,_e){return de===ul?-1:_e===ul?1:de<_e?-1:1})}function fs(z,de,_e,at){this.thisDep=z,this.contextDep=de,this.propDep=_e,this.append=at}function Kl(z){return z&&!(z.thisDep||z.contextDep||z.propDep)}function hi(z){return new fs(!1,!1,!1,z)}function Fi(z,de){var _e=z.type;if(_e===dd){var at=z.data.length;return new fs(!0,at>=1,at>=2,de)}else if(_e===al){var Tt=z.data;return new fs(Tt.thisDep,Tt.contextDep,Tt.propDep,de)}else{if(_e===_f)return new fs(!1,!1,!1,de);if(_e===ch){for(var lt=!1,mt=!1,zt=!1,Ht=0;Ht<z.data.length;++Ht){var Kt=z.data[Ht];if(Kt.type===hd)zt=!0;else if(Kt.type===fd)mt=!0;else if(Kt.type===pd)lt=!0;else if(Kt.type===dd){lt=!0;var $t=Kt.data;$t>=1&&(mt=!0),$t>=2&&(zt=!0)}else Kt.type===al&&(lt=lt||Kt.data.thisDep,mt=mt||Kt.data.contextDep,zt=zt||Kt.data.propDep)}return new fs(lt,mt,zt,de)}else return new fs(_e===pd,_e===fd,_e===hd,de)}}var ql=new fs(!1,!1,!1,function(){});function tv(z,de,_e,at,Tt,lt,mt,zt,Ht,Kt,$t,sn,fn,Ut,an){var Je=Kt.Record,yt={add:32774,subtract:32778,"reverse subtract":32779};_e.ext_blend_minmax&&(yt.min=pm,yt.max=J0);var Jt=_e.angle_instanced_arrays,mn=_e.webgl_draw_buffers,Dt={dirty:!0,profile:an.profile},Cn={},Ft=[],ln={},Nt={};function un(ye){return ye.replace(".","_")}function $n(ye,ie,Ie){var Xe=un(ye);Ft.push(ye),Cn[Xe]=Dt[Xe]=!!Ie,ln[Xe]=ie}function lr(ye,ie,Ie){var Xe=un(ye);Ft.push(ye),Array.isArray(Ie)?(Dt[Xe]=Ie.slice(),Cn[Xe]=Ie.slice()):Dt[Xe]=Cn[Xe]=Ie,Nt[Xe]=ie}$n(rm,Gf),$n(im,mh),lr(om,"blendColor",[0,0,0,0]),lr(Nf,"blendEquationSeparate",[mm,mm]),lr(Xp,"blendFuncSeparate",[Ns,gm,Ns,gm]),$n(sm,yh,!0),lr(am,"depthFunc",ev),lr(Mc,"depthRange",[0,1]),lr(lm,"depthMask",!0),lr(ll,ll,[!0,!0,!0,!0]),$n(cm,Ff),lr(Yp,"cullFace",Xl),lr(um,um,eg),lr(kf,kf,1),$n(dm,Qp),lr(gd,"polygonOffset",[0,0]),$n(md,hm),$n(cl,xs),lr(Kp,"sampleCoverage",[1,!1]),$n(uh,vh),lr(dh,"stencilMask",-1),lr(Va,"stencilFunc",[Q0,0,-1]),lr(qp,"stencilOpSeparate",[wh,kc,kc,kc]),lr(pu,"stencilOpSeparate",[Xl,kc,kc,kc]),$n(jl,q0),lr(Jp,"scissor",[0,0,z.drawingBufferWidth,z.drawingBufferHeight]),lr(ul,ul,[0,0,z.drawingBufferWidth,z.drawingBufferHeight]);var pn={gl:z,context:fn,strings:de,next:Cn,current:Dt,draw:sn,elements:lt,buffer:Tt,shader:$t,attributes:Kt.state,vao:Kt,uniforms:Ht,framebuffer:zt,extensions:_e,timer:Ut,isBufferArgs:jf},en={primTypes:k,compareFuncs:bd,blendFuncs:fl,blendEquations:yt,stencilOps:Yl,glTypes:Qs,orientationType:tg};fe.optional(function(){pn.isArrayLike=br}),mn&&(en.backBuffer=[Xl],en.drawBuffer=No(at.maxDrawbuffers,function(ye){return ye===0?[0]:No(ye,function(ie){return ym+ie})}));var Ot=0;function Jn(){var ye=Zp(),ie=ye.link,Ie=ye.global;ye.id=Ot++,ye.batchId="0";var Xe=ie(pn),Qe=ye.shared={props:"a0"};Object.keys(pn).forEach(function(Ne){Qe[Ne]=Ie.def(Xe,".",Ne)}),fe.optional(function(){ye.CHECK=ie(fe),ye.commandStr=fe.guessCommand(),ye.command=ie(ye.commandStr),ye.assert=function(Ne,me,We){Ne("if(!(",me,"))",this.CHECK,".commandRaise(",ie(We),",",this.command,");")},en.invalidBlendCombinations=bm});var Be=ye.next={},Le=ye.current={};Object.keys(Nt).forEach(function(Ne){Array.isArray(Dt[Ne])&&(Be[Ne]=Ie.def(Qe.next,".",Ne),Le[Ne]=Ie.def(Qe.current,".",Ne))});var $e=ye.constants={};Object.keys(en).forEach(function(Ne){$e[Ne]=Ie.def(JSON.stringify(en[Ne]))}),ye.invoke=function(Ne,me){switch(me.type){case dd:var We=["this",Qe.context,Qe.props,ye.batchId];return Ne.def(ie(me.data),".call(",We.slice(0,Math.max(me.data.length+1,4)),")");case hd:return Ne.def(Qe.props,me.data);case fd:return Ne.def(Qe.context,me.data);case pd:return Ne.def("this",me.data);case al:return me.data.append(ye,Ne),me.data.ref;case _f:return me.data.toString();case ch:return me.data.map(function(nt){return ye.invoke(Ne,nt)})}},ye.attribCache={};var xe={};return ye.scopeAttrib=function(Ne){var me=de.id(Ne);if(me in xe)return xe[me];var We=Kt.scope[me];We||(We=Kt.scope[me]=new Je);var nt=xe[me]=ie(We);return nt},ye}function Ar(ye){var ie=ye.static,Ie=ye.dynamic,Xe;if(Hl in ie){var Qe=!!ie[Hl];Xe=hi(function(Le,$e){return Qe}),Xe.enable=Qe}else if(Hl in Ie){var Be=Ie[Hl];Xe=Fi(Be,function(Le,$e){return Le.invoke($e,Be)})}return Xe}function Mn(ye,ie){var Ie=ye.static,Xe=ye.dynamic;if(ja in Ie){var Qe=Ie[ja];return Qe?(Qe=zt.getFramebuffer(Qe),fe.command(Qe,"invalid framebuffer object"),hi(function(Le,$e){var xe=Le.link(Qe),Ne=Le.shared;$e.set(Ne.framebuffer,".next",xe);var me=Ne.context;return $e.set(me,"."+wa,xe+".width"),$e.set(me,"."+hl,xe+".height"),xe})):hi(function(Le,$e){var xe=Le.shared;$e.set(xe.framebuffer,".next","null");var Ne=xe.context;return $e.set(Ne,"."+wa,Ne+"."+vd),$e.set(Ne,"."+hl,Ne+"."+ph),"null"})}else if(ja in Xe){var Be=Xe[ja];return Fi(Be,function(Le,$e){var xe=Le.invoke($e,Be),Ne=Le.shared,me=Ne.framebuffer,We=$e.def(me,".getFramebuffer(",xe,")");fe.optional(function(){Le.assert($e,"!"+xe+"||"+We,"invalid framebuffer object")}),$e.set(me,".next",We);var nt=Ne.context;return $e.set(nt,"."+wa,We+"?"+We+".width:"+nt+"."+vd),$e.set(nt,"."+hl,We+"?"+We+".height:"+nt+"."+ph),We})}else return null}function Lr(ye,ie,Ie){var Xe=ye.static,Qe=ye.dynamic;function Be(xe){if(xe in Xe){var Ne=Xe[xe];fe.commandType(Ne,"object","invalid "+xe,Ie.commandStr);var me=!0,We=Ne.x|0,nt=Ne.y|0,dt,Mt;return"width"in Ne?(dt=Ne.width|0,fe.command(dt>=0,"invalid "+xe,Ie.commandStr)):me=!1,"height"in Ne?(Mt=Ne.height|0,fe.command(Mt>=0,"invalid "+xe,Ie.commandStr)):me=!1,new fs(!me&&ie&&ie.thisDep,!me&&ie&&ie.contextDep,!me&&ie&&ie.propDep,function(Fn,ar){var Tn=Fn.shared.context,Gn=dt;"width"in Ne||(Gn=ar.def(Tn,".",wa,"-",We));var xr=Mt;return"height"in Ne||(xr=ar.def(Tn,".",hl,"-",nt)),[We,nt,Gn,xr]})}else if(xe in Qe){var Et=Qe[xe],qt=Fi(Et,function(Fn,ar){var Tn=Fn.invoke(ar,Et);fe.optional(function(){Fn.assert(ar,Tn+"&&typeof "+Tn+'==="object"',"invalid "+xe)});var Gn=Fn.shared.context,xr=ar.def(Tn,".x|0"),ni=ar.def(Tn,".y|0"),Ji=ar.def('"width" in ',Tn,"?",Tn,".width|0:","(",Gn,".",wa,"-",xr,")"),as=ar.def('"height" in ',Tn,"?",Tn,".height|0:","(",Gn,".",hl,"-",ni,")");return fe.optional(function(){Fn.assert(ar,Ji+">=0&&"+as+">=0","invalid "+xe)}),[xr,ni,Ji,as]});return ie&&(qt.thisDep=qt.thisDep||ie.thisDep,qt.contextDep=qt.contextDep||ie.contextDep,qt.propDep=qt.propDep||ie.propDep),qt}else return ie?new fs(ie.thisDep,ie.contextDep,ie.propDep,function(Fn,ar){var Tn=Fn.shared.context;return[0,0,ar.def(Tn,".",wa),ar.def(Tn,".",hl)]}):null}var Le=Be(ul);if(Le){var $e=Le;Le=new fs(Le.thisDep,Le.contextDep,Le.propDep,function(xe,Ne){var me=$e.append(xe,Ne),We=xe.shared.context;return Ne.set(We,"."+If,me[2]),Ne.set(We,"."+hh,me[3]),me})}return{viewport:Le,scissor_box:Be(Jp)}}function hr(ye,ie){var Ie=ye.static,Xe=typeof Ie[$l]=="string"&&typeof Ie[Pc]=="string";if(Xe){if(Object.keys(ie.dynamic).length>0)return null;var Qe=ie.static,Be=Object.keys(Qe);if(Be.length>0&&typeof Qe[Be[0]]=="number"){for(var Le=[],$e=0;$e<Be.length;++$e)fe(typeof Qe[Be[$e]]=="number","must specify all vertex attribute locations when using vaos"),Le.push([Qe[Be[$e]]|0,Be[$e]]);return Le}}return null}function Mr(ye,ie,Ie){var Xe=ye.static,Qe=ye.dynamic;function Be(me){if(me in Xe){var We=de.id(Xe[me]);fe.optional(function(){$t.shader(xm[me],We,fe.guessCommand())});var nt=hi(function(){return We});return nt.id=We,nt}else if(me in Qe){var dt=Qe[me];return Fi(dt,function(Mt,Et){var qt=Mt.invoke(Et,dt),Fn=Et.def(Mt.shared.strings,".id(",qt,")");return fe.optional(function(){Et(Mt.shared.shader,".shader(",xm[me],",",Fn,",",Mt.command,");")}),Fn})}return null}var Le=Be($l),$e=Be(Pc),xe=null,Ne;return Kl(Le)&&Kl($e)?(xe=$t.program($e.id,Le.id,null,Ie),Ne=hi(function(me,We){return me.link(xe)})):Ne=new fs(Le&&Le.thisDep||$e&&$e.thisDep,Le&&Le.contextDep||$e&&$e.contextDep,Le&&Le.propDep||$e&&$e.propDep,function(me,We){var nt=me.shared.shader,dt;Le?dt=Le.append(me,We):dt=We.def(nt,".",$l);var Mt;$e?Mt=$e.append(me,We):Mt=We.def(nt,".",Pc);var Et=nt+".program("+Mt+","+dt;return fe.optional(function(){Et+=","+me.command}),We.def(Et+")")}),{frag:Le,vert:$e,progVar:Ne,program:xe}}function si(ye,ie){var Ie=ye.static,Xe=ye.dynamic;function Qe(){if(Ha in Ie){var me=Ie[Ha];jf(me)?me=lt.getElements(lt.create(me,!0)):me&&(me=lt.getElements(me),fe.command(me,"invalid elements",ie.commandStr));var We=hi(function(dt,Mt){if(me){var Et=dt.link(me);return dt.ELEMENTS=Et,Et}return dt.ELEMENTS=null,null});return We.value=me,We}else if(Ha in Xe){var nt=Xe[Ha];return Fi(nt,function(dt,Mt){var Et=dt.shared,qt=Et.isBufferArgs,Fn=Et.elements,ar=dt.invoke(Mt,nt),Tn=Mt.def("null"),Gn=Mt.def(qt,"(",ar,")"),xr=dt.cond(Gn).then(Tn,"=",Fn,".createStream(",ar,");").else(Tn,"=",Fn,".getElements(",ar,");");return fe.optional(function(){dt.assert(xr.else,"!"+ar+"||"+Tn,"invalid elements")}),Mt.entry(xr),Mt.exit(dt.cond(Gn).then(Fn,".destroyStream(",Tn,");")),dt.ELEMENTS=Tn,Tn})}return null}var Be=Qe();function Le(){if($a in Ie){var me=Ie[$a];return fe.commandParameter(me,k,"invalid primitve",ie.commandStr),hi(function(nt,dt){return k[me]})}else if($a in Xe){var We=Xe[$a];return Fi(We,function(nt,dt){var Mt=nt.constants.primTypes,Et=nt.invoke(dt,We);return fe.optional(function(){nt.assert(dt,Et+" in "+Mt,"invalid primitive, must be one of "+Object.keys(k))}),dt.def(Mt,"[",Et,"]")})}else if(Be)return Kl(Be)?Be.value?hi(function(nt,dt){return dt.def(nt.ELEMENTS,".primType")}):hi(function(){return _s}):new fs(Be.thisDep,Be.contextDep,Be.propDep,function(nt,dt){var Mt=nt.ELEMENTS;return dt.def(Mt,"?",Mt,".primType:",_s)});return null}function $e(me,We){if(me in Ie){var nt=Ie[me]|0;return fe.command(!We||nt>=0,"invalid "+me,ie.commandStr),hi(function(Mt,Et){return We&&(Mt.OFFSET=nt),nt})}else if(me in Xe){var dt=Xe[me];return Fi(dt,function(Mt,Et){var qt=Mt.invoke(Et,dt);return We&&(Mt.OFFSET=qt,fe.optional(function(){Mt.assert(Et,qt+">=0","invalid "+me)})),qt})}else if(We&&Be)return hi(function(Mt,Et){return Mt.OFFSET="0",0});return null}var xe=$e(gu,!0);function Ne(){if(dl in Ie){var me=Ie[dl]|0;return fe.command(typeof me=="number"&&me>=0,"invalid vertex count",ie.commandStr),hi(function(){return me})}else if(dl in Xe){var We=Xe[dl];return Fi(We,function(Mt,Et){var qt=Mt.invoke(Et,We);return fe.optional(function(){Mt.assert(Et,"typeof "+qt+'==="number"&&'+qt+">=0&&"+qt+"===("+qt+"|0)","invalid vertex count")}),qt})}else if(Be)if(Kl(Be)){if(Be)return xe?new fs(xe.thisDep,xe.contextDep,xe.propDep,function(Mt,Et){var qt=Et.def(Mt.ELEMENTS,".vertCount-",Mt.OFFSET);return fe.optional(function(){Mt.assert(Et,qt+">=0","invalid vertex offset/element buffer too small")}),qt}):hi(function(Mt,Et){return Et.def(Mt.ELEMENTS,".vertCount")});var nt=hi(function(){return-1});return fe.optional(function(){nt.MISSING=!0}),nt}else{var dt=new fs(Be.thisDep||xe.thisDep,Be.contextDep||xe.contextDep,Be.propDep||xe.propDep,function(Mt,Et){var qt=Mt.ELEMENTS;return Mt.OFFSET?Et.def(qt,"?",qt,".vertCount-",Mt.OFFSET,":-1"):Et.def(qt,"?",qt,".vertCount:-1")});return fe.optional(function(){dt.DYNAMIC=!0}),dt}return null}return{elements:Be,primitive:Le(),count:Ne(),instances:$e(Rf,!1),offset:xe}}function To(ye,ie){var Ie=ye.static,Xe=ye.dynamic,Qe={};return Ft.forEach(function(Be){var Le=un(Be);function $e(xe,Ne){if(Be in Ie){var me=xe(Ie[Be]);Qe[Le]=hi(function(){return me})}else if(Be in Xe){var We=Xe[Be];Qe[Le]=Fi(We,function(nt,dt){return Ne(nt,dt,nt.invoke(dt,We))})}}switch(Be){case cm:case im:case rm:case uh:case sm:case jl:case dm:case md:case cl:case lm:return $e(function(xe){return fe.commandType(xe,"boolean",Be,ie.commandStr),xe},function(xe,Ne,me){return fe.optional(function(){xe.assert(Ne,"typeof "+me+'==="boolean"',"invalid flag "+Be,xe.commandStr)}),me});case am:return $e(function(xe){return fe.commandParameter(xe,bd,"invalid "+Be,ie.commandStr),bd[xe]},function(xe,Ne,me){var We=xe.constants.compareFuncs;return fe.optional(function(){xe.assert(Ne,me+" in "+We,"invalid "+Be+", must be one of "+Object.keys(bd))}),Ne.def(We,"[",me,"]")});case Mc:return $e(function(xe){return fe.command(br(xe)&&xe.length===2&&typeof xe[0]=="number"&&typeof xe[1]=="number"&&xe[0]<=xe[1],"depth range is 2d array",ie.commandStr),xe},function(xe,Ne,me){fe.optional(function(){xe.assert(Ne,xe.shared.isArrayLike+"("+me+")&&"+me+".length===2&&typeof "+me+'[0]==="number"&&typeof '+me+'[1]==="number"&&'+me+"[0]<="+me+"[1]","depth range must be a 2d array")});var We=Ne.def("+",me,"[0]"),nt=Ne.def("+",me,"[1]");return[We,nt]});case Xp:return $e(function(xe){fe.commandType(xe,"object","blend.func",ie.commandStr);var Ne="srcRGB"in xe?xe.srcRGB:xe.src,me="srcAlpha"in xe?xe.srcAlpha:xe.src,We="dstRGB"in xe?xe.dstRGB:xe.dst,nt="dstAlpha"in xe?xe.dstAlpha:xe.dst;return fe.commandParameter(Ne,fl,Le+".srcRGB",ie.commandStr),fe.commandParameter(me,fl,Le+".srcAlpha",ie.commandStr),fe.commandParameter(We,fl,Le+".dstRGB",ie.commandStr),fe.commandParameter(nt,fl,Le+".dstAlpha",ie.commandStr),fe.command(bm.indexOf(Ne+", "+We)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Ne+", "+We+")",ie.commandStr),[fl[Ne],fl[We],fl[me],fl[nt]]},function(xe,Ne,me){var We=xe.constants.blendFuncs;fe.optional(function(){xe.assert(Ne,me+"&&typeof "+me+'==="object"',"invalid blend func, must be an object")});function nt(Tn,Gn){var xr=Ne.def('"',Tn,Gn,'" in ',me,"?",me,".",Tn,Gn,":",me,".",Tn);return fe.optional(function(){xe.assert(Ne,xr+" in "+We,"invalid "+Be+"."+Tn+Gn+", must be one of "+Object.keys(fl))}),xr}var dt=nt("src","RGB"),Mt=nt("dst","RGB");fe.optional(function(){var Tn=xe.constants.invalidBlendCombinations;xe.assert(Ne,Tn+".indexOf("+dt+'+", "+'+Mt+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Et=Ne.def(We,"[",dt,"]"),qt=Ne.def(We,"[",nt("src","Alpha"),"]"),Fn=Ne.def(We,"[",Mt,"]"),ar=Ne.def(We,"[",nt("dst","Alpha"),"]");return[Et,Fn,qt,ar]});case Nf:return $e(function(xe){if(typeof xe=="string")return fe.commandParameter(xe,yt,"invalid "+Be,ie.commandStr),[yt[xe],yt[xe]];if(typeof xe=="object")return fe.commandParameter(xe.rgb,yt,Be+".rgb",ie.commandStr),fe.commandParameter(xe.alpha,yt,Be+".alpha",ie.commandStr),[yt[xe.rgb],yt[xe.alpha]];fe.commandRaise("invalid blend.equation",ie.commandStr)},function(xe,Ne,me){var We=xe.constants.blendEquations,nt=Ne.def(),dt=Ne.def(),Mt=xe.cond("typeof ",me,'==="string"');return fe.optional(function(){function Et(qt,Fn,ar){xe.assert(qt,ar+" in "+We,"invalid "+Fn+", must be one of "+Object.keys(yt))}Et(Mt.then,Be,me),xe.assert(Mt.else,me+"&&typeof "+me+'==="object"',"invalid "+Be),Et(Mt.else,Be+".rgb",me+".rgb"),Et(Mt.else,Be+".alpha",me+".alpha")}),Mt.then(nt,"=",dt,"=",We,"[",me,"];"),Mt.else(nt,"=",We,"[",me,".rgb];",dt,"=",We,"[",me,".alpha];"),Ne(Mt),[nt,dt]});case om:return $e(function(xe){return fe.command(br(xe)&&xe.length===4,"blend.color must be a 4d array",ie.commandStr),No(4,function(Ne){return+xe[Ne]})},function(xe,Ne,me){return fe.optional(function(){xe.assert(Ne,xe.shared.isArrayLike+"("+me+")&&"+me+".length===4","blend.color must be a 4d array")}),No(4,function(We){return Ne.def("+",me,"[",We,"]")})});case dh:return $e(function(xe){return fe.commandType(xe,"number",Le,ie.commandStr),xe|0},function(xe,Ne,me){return fe.optional(function(){xe.assert(Ne,"typeof "+me+'==="number"',"invalid stencil.mask")}),Ne.def(me,"|0")});case Va:return $e(function(xe){fe.commandType(xe,"object",Le,ie.commandStr);var Ne=xe.cmp||"keep",me=xe.ref||0,We="mask"in xe?xe.mask:-1;return fe.commandParameter(Ne,bd,Be+".cmp",ie.commandStr),fe.commandType(me,"number",Be+".ref",ie.commandStr),fe.commandType(We,"number",Be+".mask",ie.commandStr),[bd[Ne],me,We]},function(xe,Ne,me){var We=xe.constants.compareFuncs;fe.optional(function(){function Et(){xe.assert(Ne,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Et(me+"&&typeof ",me,'==="object"'),Et('!("cmp" in ',me,")||(",me,".cmp in ",We,")")});var nt=Ne.def('"cmp" in ',me,"?",We,"[",me,".cmp]",":",kc),dt=Ne.def(me,".ref|0"),Mt=Ne.def('"mask" in ',me,"?",me,".mask|0:-1");return[nt,dt,Mt]});case qp:case pu:return $e(function(xe){fe.commandType(xe,"object",Le,ie.commandStr);var Ne=xe.fail||"keep",me=xe.zfail||"keep",We=xe.zpass||"keep";return fe.commandParameter(Ne,Yl,Be+".fail",ie.commandStr),fe.commandParameter(me,Yl,Be+".zfail",ie.commandStr),fe.commandParameter(We,Yl,Be+".zpass",ie.commandStr),[Be===pu?Xl:wh,Yl[Ne],Yl[me],Yl[We]]},function(xe,Ne,me){var We=xe.constants.stencilOps;fe.optional(function(){xe.assert(Ne,me+"&&typeof "+me+'==="object"',"invalid "+Be)});function nt(dt){return fe.optional(function(){xe.assert(Ne,'!("'+dt+'" in '+me+")||("+me+"."+dt+" in "+We+")","invalid "+Be+"."+dt+", must be one of "+Object.keys(Yl))}),Ne.def('"',dt,'" in ',me,"?",We,"[",me,".",dt,"]:",kc)}return[Be===pu?Xl:wh,nt("fail"),nt("zfail"),nt("zpass")]});case gd:return $e(function(xe){fe.commandType(xe,"object",Le,ie.commandStr);var Ne=xe.factor|0,me=xe.units|0;return fe.commandType(Ne,"number",Le+".factor",ie.commandStr),fe.commandType(me,"number",Le+".units",ie.commandStr),[Ne,me]},function(xe,Ne,me){fe.optional(function(){xe.assert(Ne,me+"&&typeof "+me+'==="object"',"invalid "+Be)});var We=Ne.def(me,".factor|0"),nt=Ne.def(me,".units|0");return[We,nt]});case Yp:return $e(function(xe){var Ne=0;return xe==="front"?Ne=wh:xe==="back"&&(Ne=Xl),fe.command(!!Ne,Le,ie.commandStr),Ne},function(xe,Ne,me){return fe.optional(function(){xe.assert(Ne,me+'==="front"||'+me+'==="back"',"invalid cull.face")}),Ne.def(me,'==="front"?',wh,":",Xl)});case kf:return $e(function(xe){return fe.command(typeof xe=="number"&&xe>=at.lineWidthDims[0]&&xe<=at.lineWidthDims[1],"invalid line width, must be a positive number between "+at.lineWidthDims[0]+" and "+at.lineWidthDims[1],ie.commandStr),xe},function(xe,Ne,me){return fe.optional(function(){xe.assert(Ne,"typeof "+me+'==="number"&&'+me+">="+at.lineWidthDims[0]+"&&"+me+"<="+at.lineWidthDims[1],"invalid line width")}),me});case um:return $e(function(xe){return fe.commandParameter(xe,tg,Le,ie.commandStr),tg[xe]},function(xe,Ne,me){return fe.optional(function(){xe.assert(Ne,me+'==="cw"||'+me+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Ne.def(me+'==="cw"?'+fm+":"+eg)});case ll:return $e(function(xe){return fe.command(br(xe)&&xe.length===4,"color.mask must be length 4 array",ie.commandStr),xe.map(function(Ne){return!!Ne})},function(xe,Ne,me){return fe.optional(function(){xe.assert(Ne,xe.shared.isArrayLike+"("+me+")&&"+me+".length===4","invalid color.mask")}),No(4,function(We){return"!!"+me+"["+We+"]"})});case Kp:return $e(function(xe){fe.command(typeof xe=="object"&&xe,Le,ie.commandStr);var Ne="value"in xe?xe.value:1,me=!!xe.invert;return fe.command(typeof Ne=="number"&&Ne>=0&&Ne<=1,"sample.coverage.value must be a number between 0 and 1",ie.commandStr),[Ne,me]},function(xe,Ne,me){fe.optional(function(){xe.assert(Ne,me+"&&typeof "+me+'==="object"',"invalid sample.coverage")});var We=Ne.def('"value" in ',me,"?+",me,".value:1"),nt=Ne.def("!!",me,".invert");return[We,nt]})}}),Qe}function Wo(ye,ie){var Ie=ye.static,Xe=ye.dynamic,Qe={};return Object.keys(Ie).forEach(function(Be){var Le=Ie[Be],$e;if(typeof Le=="number"||typeof Le=="boolean")$e=hi(function(){return Le});else if(typeof Le=="function"){var xe=Le._reglType;xe==="texture2d"||xe==="textureCube"?$e=hi(function(Ne){return Ne.link(Le)}):xe==="framebuffer"||xe==="framebufferCube"?(fe.command(Le.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Be+'"',ie.commandStr),$e=hi(function(Ne){return Ne.link(Le.color[0])})):fe.commandRaise('invalid data for uniform "'+Be+'"',ie.commandStr)}else br(Le)?$e=hi(function(Ne){var me=Ne.global.def("[",No(Le.length,function(We){return fe.command(typeof Le[We]=="number"||typeof Le[We]=="boolean","invalid uniform "+Be,Ne.commandStr),Le[We]}),"]");return me}):fe.commandRaise('invalid or missing data for uniform "'+Be+'"',ie.commandStr);$e.value=Le,Qe[Be]=$e}),Object.keys(Xe).forEach(function(Be){var Le=Xe[Be];Qe[Be]=Fi(Le,function($e,xe){return $e.invoke(xe,Le)})}),Qe}function Vr(ye,ie){var Ie=ye.static,Xe=ye.dynamic,Qe={};return Object.keys(Ie).forEach(function(Be){var Le=Ie[Be],$e=de.id(Be),xe=new Je;if(jf(Le))xe.state=Ua,xe.buffer=Tt.getBuffer(Tt.create(Le,Zl,!1,!0)),xe.type=0;else{var Ne=Tt.getBuffer(Le);if(Ne)xe.state=Ua,xe.buffer=Ne,xe.type=0;else if(fe.command(typeof Le=="object"&&Le,"invalid data for attribute "+Be,ie.commandStr),"constant"in Le){var me=Le.constant;xe.buffer="null",xe.state=ud,typeof me=="number"?xe.x=me:(fe.command(br(me)&&me.length>0&&me.length<=4,"invalid constant for attribute "+Be,ie.commandStr),rs.forEach(function(Fn,ar){ar<me.length&&(xe[Fn]=me[ar])}))}else{jf(Le.buffer)?Ne=Tt.getBuffer(Tt.create(Le.buffer,Zl,!1,!0)):Ne=Tt.getBuffer(Le.buffer),fe.command(!!Ne,'missing buffer for attribute "'+Be+'"',ie.commandStr);var We=Le.offset|0;fe.command(We>=0,'invalid offset for attribute "'+Be+'"',ie.commandStr);var nt=Le.stride|0;fe.command(nt>=0&&nt<256,'invalid stride for attribute "'+Be+'", must be integer betweeen [0, 255]',ie.commandStr);var dt=Le.size|0;fe.command(!("size"in Le)||dt>0&&dt<=4,'invalid size for attribute "'+Be+'", must be 1,2,3,4',ie.commandStr);var Mt=!!Le.normalized,Et=0;"type"in Le&&(fe.commandParameter(Le.type,Qs,"invalid type for attribute "+Be,ie.commandStr),Et=Qs[Le.type]);var qt=Le.divisor|0;"divisor"in Le&&(fe.command(qt===0||Jt,'cannot specify divisor for attribute "'+Be+'", instancing not supported',ie.commandStr),fe.command(qt>=0,'invalid divisor for attribute "'+Be+'"',ie.commandStr)),fe.optional(function(){var Fn=ie.commandStr,ar=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Le).forEach(function(Tn){fe.command(ar.indexOf(Tn)>=0,'unknown parameter "'+Tn+'" for attribute pointer "'+Be+'" (valid parameters are '+ar+")",Fn)})}),xe.buffer=Ne,xe.state=Ua,xe.size=dt,xe.normalized=Mt,xe.type=Et||Ne.dtype,xe.offset=We,xe.stride=nt,xe.divisor=qt}}Qe[Be]=hi(function(Fn,ar){var Tn=Fn.attribCache;if($e in Tn)return Tn[$e];var Gn={isStream:!1};return Object.keys(xe).forEach(function(xr){Gn[xr]=xe[xr]}),xe.buffer&&(Gn.buffer=Fn.link(xe.buffer),Gn.type=Gn.type||Gn.buffer+".dtype"),Tn[$e]=Gn,Gn})}),Object.keys(Xe).forEach(function(Be){var Le=Xe[Be];function $e(xe,Ne){var me=xe.invoke(Ne,Le),We=xe.shared,nt=xe.constants,dt=We.isBufferArgs,Mt=We.buffer;fe.optional(function(){xe.assert(Ne,me+"&&(typeof "+me+'==="object"||typeof '+me+'==="function")&&('+dt+"("+me+")||"+Mt+".getBuffer("+me+")||"+Mt+".getBuffer("+me+".buffer)||"+dt+"("+me+'.buffer)||("constant" in '+me+"&&(typeof "+me+'.constant==="number"||'+We.isArrayLike+"("+me+".constant))))",'invalid dynamic attribute "'+Be+'"')});var Et={isStream:Ne.def(!1)},qt=new Je;qt.state=Ua,Object.keys(qt).forEach(function(Gn){Et[Gn]=Ne.def(""+qt[Gn])});var Fn=Et.buffer,ar=Et.type;Ne("if(",dt,"(",me,")){",Et.isStream,"=true;",Fn,"=",Mt,".createStream(",Zl,",",me,");",ar,"=",Fn,".dtype;","}else{",Fn,"=",Mt,".getBuffer(",me,");","if(",Fn,"){",ar,"=",Fn,".dtype;",'}else if("constant" in ',me,"){",Et.state,"=",ud,";","if(typeof "+me+'.constant === "number"){',Et[rs[0]],"=",me,".constant;",rs.slice(1).map(function(Gn){return Et[Gn]}).join("="),"=0;","}else{",rs.map(function(Gn,xr){return Et[Gn]+"="+me+".constant.length>"+xr+"?"+me+".constant["+xr+"]:0;"}).join(""),"}}else{","if(",dt,"(",me,".buffer)){",Fn,"=",Mt,".createStream(",Zl,",",me,".buffer);","}else{",Fn,"=",Mt,".getBuffer(",me,".buffer);","}",ar,'="type" in ',me,"?",nt.glTypes,"[",me,".type]:",Fn,".dtype;",Et.normalized,"=!!",me,".normalized;");function Tn(Gn){Ne(Et[Gn],"=",me,".",Gn,"|0;")}return Tn("size"),Tn("offset"),Tn("stride"),Tn("divisor"),Ne("}}"),Ne.exit("if(",Et.isStream,"){",Mt,".destroyStream(",Fn,");","}"),Et}Qe[Be]=Fi(Le,$e)}),Qe}function oo(ye,ie){var Ie=ye.static,Xe=ye.dynamic;if(Oc in Ie){var Qe=Ie[Oc];return Qe!==null&&Kt.getVAO(Qe)===null&&(Qe=Kt.createVAO(Qe)),hi(function(Le){return Le.link(Kt.getVAO(Qe))})}else if(Oc in Xe){var Be=Xe[Oc];return Fi(Be,function(Le,$e){var xe=Le.invoke($e,Be);return $e.def(Le.shared.vao+".getVAO("+xe+")")})}return null}function fi(ye){var ie=ye.static,Ie=ye.dynamic,Xe={};return Object.keys(ie).forEach(function(Qe){var Be=ie[Qe];Xe[Qe]=hi(function(Le,$e){return typeof Be=="number"||typeof Be=="boolean"?""+Be:Le.link(Be)})}),Object.keys(Ie).forEach(function(Qe){var Be=Ie[Qe];Xe[Qe]=Fi(Be,function(Le,$e){return Le.invoke($e,Be)})}),Xe}function so(ye,ie,Ie,Xe,Qe){var Be=ye.static,Le=ye.dynamic;fe.optional(function(){var Tn=[ja,Pc,$l,Ha,$a,gu,dl,Rf,Hl,Oc].concat(Ft);function Gn(xr){Object.keys(xr).forEach(function(ni){fe.command(Tn.indexOf(ni)>=0,'unknown parameter "'+ni+'"',Qe.commandStr)})}Gn(Be),Gn(Le)});var $e=hr(ye,ie),xe=Mn(ye,Qe),Ne=Lr(ye,xe,Qe),me=si(ye,Qe),We=To(ye,Qe),nt=Mr(ye,Qe,$e);function dt(Tn){var Gn=Ne[Tn];Gn&&(We[Tn]=Gn)}dt(ul),dt(un(Jp));var Mt=Object.keys(We).length>0,Et={framebuffer:xe,draw:me,shader:nt,state:We,dirty:Mt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Et.profile=Ar(ye,Qe),Et.uniforms=Wo(Ie,Qe),Et.drawVAO=Et.scopeVAO=oo(ye,Qe),!Et.drawVAO&&nt.program&&!$e&&_e.angle_instanced_arrays){var qt=!0,Fn=nt.program.attributes.map(function(Tn){var Gn=ie.static[Tn];return qt=qt&&!!Gn,Gn});if(qt&&Fn.length>0){var ar=Kt.getVAO(Kt.createVAO(Fn));Et.drawVAO=new fs(null,null,null,function(Tn,Gn){return Tn.link(ar)}),Et.useVAO=!0}}return $e?Et.useVAO=!0:Et.attributes=Vr(ie,Qe),Et.context=fi(Xe,Qe),Et}function Mo(ye,ie,Ie){var Xe=ye.shared,Qe=Xe.context,Be=ye.scope();Object.keys(Ie).forEach(function(Le){ie.save(Qe,"."+Le);var $e=Ie[Le],xe=$e.append(ye,ie);Array.isArray(xe)?Be(Qe,".",Le,"=[",xe.join(),"];"):Be(Qe,".",Le,"=",xe,";")}),ie(Be)}function Po(ye,ie,Ie,Xe){var Qe=ye.shared,Be=Qe.gl,Le=Qe.framebuffer,$e;mn&&($e=ie.def(Qe.extensions,".webgl_draw_buffers"));var xe=ye.constants,Ne=xe.drawBuffer,me=xe.backBuffer,We;Ie?We=Ie.append(ye,ie):We=ie.def(Le,".next"),Xe||ie("if(",We,"!==",Le,".cur){"),ie("if(",We,"){",Be,".bindFramebuffer(",vm,",",We,".framebuffer);"),mn&&ie($e,".drawBuffersWEBGL(",Ne,"[",We,".colorAttachments.length]);"),ie("}else{",Be,".bindFramebuffer(",vm,",null);"),mn&&ie($e,".drawBuffersWEBGL(",me,");"),ie("}",Le,".cur=",We,";"),Xe||ie("}")}function is(ye,ie,Ie){var Xe=ye.shared,Qe=Xe.gl,Be=ye.current,Le=ye.next,$e=Xe.current,xe=Xe.next,Ne=ye.cond($e,".dirty");Ft.forEach(function(me){var We=un(me);if(!(We in Ie.state)){var nt,dt;if(We in Le){nt=Le[We],dt=Be[We];var Mt=No(Dt[We].length,function(qt){return Ne.def(nt,"[",qt,"]")});Ne(ye.cond(Mt.map(function(qt,Fn){return qt+"!=="+dt+"["+Fn+"]"}).join("||")).then(Qe,".",Nt[We],"(",Mt,");",Mt.map(function(qt,Fn){return dt+"["+Fn+"]="+qt}).join(";"),";"))}else{nt=Ne.def(xe,".",We);var Et=ye.cond(nt,"!==",$e,".",We);Ne(Et),We in ln?Et(ye.cond(nt).then(Qe,".enable(",ln[We],");").else(Qe,".disable(",ln[We],");"),$e,".",We,"=",nt,";"):Et(Qe,".",Nt[We],"(",nt,");",$e,".",We,"=",nt,";")}}}),Object.keys(Ie.state).length===0&&Ne($e,".dirty=false;"),ie(Ne)}function os(ye,ie,Ie,Xe){var Qe=ye.shared,Be=ye.current,Le=Qe.current,$e=Qe.gl;Hf(Object.keys(Ie)).forEach(function(xe){var Ne=Ie[xe];if(!(Xe&&!Xe(Ne))){var me=Ne.append(ye,ie);if(ln[xe]){var We=ln[xe];Kl(Ne)?me?ie($e,".enable(",We,");"):ie($e,".disable(",We,");"):ie(ye.cond(me).then($e,".enable(",We,");").else($e,".disable(",We,");")),ie(Le,".",xe,"=",me,";")}else if(br(me)){var nt=Be[xe];ie($e,".",Nt[xe],"(",me,");",me.map(function(dt,Mt){return nt+"["+Mt+"]="+dt}).join(";"),";")}else ie($e,".",Nt[xe],"(",me,");",Le,".",xe,"=",me,";")}})}function mo(ye,ie){Jt&&(ye.instancing=ie.def(ye.shared.extensions,".angle_instanced_arrays"))}function wr(ye,ie,Ie,Xe,Qe){var Be=ye.shared,Le=ye.stats,$e=Be.current,xe=Be.timer,Ne=Ie.profile;function me(){return typeof performance>"u"?"Date.now()":"performance.now()"}var We,nt;function dt(Tn){We=ie.def(),Tn(We,"=",me(),";"),typeof Qe=="string"?Tn(Le,".count+=",Qe,";"):Tn(Le,".count++;"),Ut&&(Xe?(nt=ie.def(),Tn(nt,"=",xe,".getNumPendingQueries();")):Tn(xe,".beginQuery(",Le,");"))}function Mt(Tn){Tn(Le,".cpuTime+=",me(),"-",We,";"),Ut&&(Xe?Tn(xe,".pushScopeStats(",nt,",",xe,".getNumPendingQueries(),",Le,");"):Tn(xe,".endQuery();"))}function Et(Tn){var Gn=ie.def($e,".profile");ie($e,".profile=",Tn,";"),ie.exit($e,".profile=",Gn,";")}var qt;if(Ne){if(Kl(Ne)){Ne.enable?(dt(ie),Mt(ie.exit),Et("true")):Et("false");return}qt=Ne.append(ye,ie),Et(qt)}else qt=ie.def($e,".profile");var Fn=ye.block();dt(Fn),ie("if(",qt,"){",Fn,"}");var ar=ye.block();Mt(ar),ie.exit("if(",qt,"){",ar,"}")}function ss(ye,ie,Ie,Xe,Qe){var Be=ye.shared;function Le(xe){switch(xe){case Dc:case Kr:case xh:return 2;case Bf:case Nc:case Ch:return 3;case Ea:case bh:case yu:return 4;default:return 1}}function $e(xe,Ne,me){var We=Be.gl,nt=ie.def(xe,".location"),dt=ie.def(Be.attributes,"[",nt,"]"),Mt=me.state,Et=me.buffer,qt=[me.x,me.y,me.z,me.w],Fn=["buffer","normalized","offset","stride"];function ar(){ie("if(!",dt,".buffer){",We,".enableVertexAttribArray(",nt,");}");var Gn=me.type,xr;if(me.size?xr=ie.def(me.size,"||",Ne):xr=Ne,ie("if(",dt,".type!==",Gn,"||",dt,".size!==",xr,"||",Fn.map(function(Ji){return dt+"."+Ji+"!=="+me[Ji]}).join("||"),"){",We,".bindBuffer(",Zl,",",Et,".buffer);",We,".vertexAttribPointer(",[nt,xr,Gn,me.normalized,me.stride,me.offset],");",dt,".type=",Gn,";",dt,".size=",xr,";",Fn.map(function(Ji){return dt+"."+Ji+"="+me[Ji]+";"}).join(""),"}"),Jt){var ni=me.divisor;ie("if(",dt,".divisor!==",ni,"){",ye.instancing,".vertexAttribDivisorANGLE(",[nt,ni],");",dt,".divisor=",ni,";}")}}function Tn(){ie("if(",dt,".buffer){",We,".disableVertexAttribArray(",nt,");",dt,".buffer=null;","}if(",rs.map(function(Gn,xr){return dt+"."+Gn+"!=="+qt[xr]}).join("||"),"){",We,".vertexAttrib4f(",nt,",",qt,");",rs.map(function(Gn,xr){return dt+"."+Gn+"="+qt[xr]+";"}).join(""),"}")}Mt===Ua?ar():Mt===ud?Tn():(ie("if(",Mt,"===",Ua,"){"),ar(),ie("}else{"),Tn(),ie("}"))}Xe.forEach(function(xe){var Ne=xe.name,me=Ie.attributes[Ne],We;if(me){if(!Qe(me))return;We=me.append(ye,ie)}else{if(!Qe(ql))return;var nt=ye.scopeAttrib(Ne);fe.optional(function(){ye.assert(ie,nt+".state","missing attribute "+Ne)}),We={},Object.keys(new Je).forEach(function(dt){We[dt]=ie.def(nt,".",dt)})}$e(ye.link(xe),Le(xe.info.type),We)})}function ai(ye,ie,Ie,Xe,Qe){for(var Be=ye.shared,Le=Be.gl,$e,xe=0;xe<Xe.length;++xe){var Ne=Xe[xe],me=Ne.name,We=Ne.info.type,nt=Ie.uniforms[me],dt=ye.link(Ne),Mt=dt+".location",Et;if(nt){if(!Qe(nt))continue;if(Kl(nt)){var qt=nt.value;if(fe.command(qt!==null&&typeof qt<"u",'missing uniform "'+me+'"',ye.commandStr),We===Vf||We===bu){fe.command(typeof qt=="function"&&(We===Vf&&(qt._reglType==="texture2d"||qt._reglType==="framebuffer")||We===bu&&(qt._reglType==="textureCube"||qt._reglType==="framebufferCube")),"invalid texture for uniform "+me,ye.commandStr);var Fn=ye.link(qt._texture||qt.color[0]._texture);ie(Le,".uniform1i(",Mt,",",Fn+".bind());"),ie.exit(Fn,".unbind();")}else if(We===Sa||We===Ds||We===Uf){fe.optional(function(){fe.command(br(qt),"invalid matrix for uniform "+me,ye.commandStr),fe.command(We===Sa&&qt.length===4||We===Ds&&qt.length===9||We===Uf&&qt.length===16,"invalid length for matrix uniform "+me,ye.commandStr)});var ar=ye.global.def("new Float32Array(["+Array.prototype.slice.call(qt)+"])"),Tn=2;We===Ds?Tn=3:We===Uf&&(Tn=4),ie(Le,".uniformMatrix",Tn,"fv(",Mt,",false,",ar,");")}else{switch(We){case En:fe.commandType(qt,"number","uniform "+me,ye.commandStr),$e="1f";break;case Dc:fe.command(br(qt)&&qt.length===2,"uniform "+me,ye.commandStr),$e="2f";break;case Bf:fe.command(br(qt)&&qt.length===3,"uniform "+me,ye.commandStr),$e="3f";break;case Ea:fe.command(br(qt)&&qt.length===4,"uniform "+me,ye.commandStr),$e="4f";break;case zf:fe.commandType(qt,"boolean","uniform "+me,ye.commandStr),$e="1i";break;case _c:fe.commandType(qt,"number","uniform "+me,ye.commandStr),$e="1i";break;case xh:fe.command(br(qt)&&qt.length===2,"uniform "+me,ye.commandStr),$e="2i";break;case Kr:fe.command(br(qt)&&qt.length===2,"uniform "+me,ye.commandStr),$e="2i";break;case Ch:fe.command(br(qt)&&qt.length===3,"uniform "+me,ye.commandStr),$e="3i";break;case Nc:fe.command(br(qt)&&qt.length===3,"uniform "+me,ye.commandStr),$e="3i";break;case yu:fe.command(br(qt)&&qt.length===4,"uniform "+me,ye.commandStr),$e="4i";break;case bh:fe.command(br(qt)&&qt.length===4,"uniform "+me,ye.commandStr),$e="4i";break}ie(Le,".uniform",$e,"(",Mt,",",br(qt)?Array.prototype.slice.call(qt):qt,");")}continue}else Et=nt.append(ye,ie)}else{if(!Qe(ql))continue;Et=ie.def(Be.uniforms,"[",de.id(me),"]")}We===Vf?(fe(!Array.isArray(Et),"must specify a scalar prop for textures"),ie("if(",Et,"&&",Et,'._reglType==="framebuffer"){',Et,"=",Et,".color[0];","}")):We===bu&&(fe(!Array.isArray(Et),"must specify a scalar prop for cube maps"),ie("if(",Et,"&&",Et,'._reglType==="framebufferCube"){',Et,"=",Et,".color[0];","}")),fe.optional(function(){function as(ra,rv){ye.assert(ie,ra,'bad data or missing for uniform "'+me+'".  '+rv)}function Zf(ra){fe(!Array.isArray(Et),"must not specify an array type for uniform"),as("typeof "+Et+'==="'+ra+'"',"invalid type, expected "+ra)}function Aa(ra,rv){Array.isArray(Et)?fe(Et.length===ra,"must have length "+ra):as(Be.isArrayLike+"("+Et+")&&"+Et+".length==="+ra,"invalid vector, should have length "+ra,ye.commandStr)}function rg(ra){fe(!Array.isArray(Et),"must not specify a value type"),as("typeof "+Et+'==="function"&&'+Et+'._reglType==="texture'+(ra===gh?"2d":"Cube")+'"',"invalid texture type",ye.commandStr)}switch(We){case _c:Zf("number");break;case Kr:Aa(2,"number");break;case Nc:Aa(3,"number");break;case bh:Aa(4,"number");break;case En:Zf("number");break;case Dc:Aa(2,"number");break;case Bf:Aa(3,"number");break;case Ea:Aa(4,"number");break;case zf:Zf("boolean");break;case xh:Aa(2,"boolean");break;case Ch:Aa(3,"boolean");break;case yu:Aa(4,"boolean");break;case Sa:Aa(4,"number");break;case Ds:Aa(9,"number");break;case Uf:Aa(16,"number");break;case Vf:rg(gh);break;case bu:rg(yd);break}});var Gn=1;switch(We){case Vf:case bu:var xr=ie.def(Et,"._texture");ie(Le,".uniform1i(",Mt,",",xr,".bind());"),ie.exit(xr,".unbind();");continue;case _c:case zf:$e="1i";break;case Kr:case xh:$e="2i",Gn=2;break;case Nc:case Ch:$e="3i",Gn=3;break;case bh:case yu:$e="4i",Gn=4;break;case En:$e="1f";break;case Dc:$e="2f",Gn=2;break;case Bf:$e="3f",Gn=3;break;case Ea:$e="4f",Gn=4;break;case Sa:$e="Matrix2fv";break;case Ds:$e="Matrix3fv";break;case Uf:$e="Matrix4fv";break}if(ie(Le,".uniform",$e,"(",Mt,","),$e.charAt(0)==="M"){var ni=Math.pow(We-Sa+2,2),Ji=ye.global.def("new Float32Array(",ni,")");Array.isArray(Et)?ie("false,(",No(ni,function(as){return Ji+"["+as+"]="+Et[as]}),",",Ji,")"):ie("false,(Array.isArray(",Et,")||",Et," instanceof Float32Array)?",Et,":(",No(ni,function(as){return Ji+"["+as+"]="+Et+"["+as+"]"}),",",Ji,")")}else Gn>1?ie(No(Gn,function(as){return Array.isArray(Et)?Et[as]:Et+"["+as+"]"})):(fe(!Array.isArray(Et),"uniform value must not be an array"),ie(Et));ie(");")}}function Yn(ye,ie,Ie,Xe){var Qe=ye.shared,Be=Qe.gl,Le=Qe.draw,$e=Xe.draw;function xe(){var xr=$e.elements,ni,Ji=ie;return xr?((xr.contextDep&&Xe.contextDynamic||xr.propDep)&&(Ji=Ie),ni=xr.append(ye,Ji)):ni=Ji.def(Le,".",Ha),ni&&Ji("if("+ni+")"+Be+".bindBuffer("+Lf+","+ni+".buffer.buffer);"),ni}function Ne(){var xr=$e.count,ni,Ji=ie;return xr?((xr.contextDep&&Xe.contextDynamic||xr.propDep)&&(Ji=Ie),ni=xr.append(ye,Ji),fe.optional(function(){xr.MISSING&&ye.assert(ie,"false","missing vertex count"),xr.DYNAMIC&&ye.assert(Ji,ni+">=0","missing vertex count")})):(ni=Ji.def(Le,".",dl),fe.optional(function(){ye.assert(Ji,ni+">=0","missing vertex count")})),ni}var me=xe();function We(xr){var ni=$e[xr];return ni?ni.contextDep&&Xe.contextDynamic||ni.propDep?ni.append(ye,Ie):ni.append(ye,ie):ie.def(Le,".",xr)}var nt=We($a),dt=We(gu),Mt=Ne();if(typeof Mt=="number"){if(Mt===0)return}else Ie("if(",Mt,"){"),Ie.exit("}");var Et,qt;Jt&&(Et=We(Rf),qt=ye.instancing);var Fn=me+".type",ar=$e.elements&&Kl($e.elements);function Tn(){function xr(){Ie(qt,".drawElementsInstancedANGLE(",[nt,Mt,Fn,dt+"<<(("+Fn+"-"+Tc+")>>1)",Et],");")}function ni(){Ie(qt,".drawArraysInstancedANGLE(",[nt,dt,Mt,Et],");")}me?ar?xr():(Ie("if(",me,"){"),xr(),Ie("}else{"),ni(),Ie("}")):ni()}function Gn(){function xr(){Ie(Be+".drawElements("+[nt,Mt,Fn,dt+"<<(("+Fn+"-"+Tc+")>>1)"]+");")}function ni(){Ie(Be+".drawArrays("+[nt,dt,Mt]+");")}me?ar?xr():(Ie("if(",me,"){"),xr(),Ie("}else{"),ni(),Ie("}")):ni()}Jt&&(typeof Et!="number"||Et>=0)?typeof Et=="string"?(Ie("if(",Et,">0){"),Tn(),Ie("}else if(",Et,"<0){"),Gn(),Ie("}")):Tn():Gn()}function kr(ye,ie,Ie,Xe,Qe){var Be=Jn(),Le=Be.proc("body",Qe);return fe.optional(function(){Be.commandStr=ie.commandStr,Be.command=Be.link(ie.commandStr)}),Jt&&(Be.instancing=Le.def(Be.shared.extensions,".angle_instanced_arrays")),ye(Be,Le,Ie,Xe),Be.compile().body}function Wr(ye,ie,Ie,Xe){mo(ye,ie),Ie.useVAO?Ie.drawVAO?ie(ye.shared.vao,".setVAO(",Ie.drawVAO.append(ye,ie),");"):ie(ye.shared.vao,".setVAO(",ye.shared.vao,".targetVAO);"):(ie(ye.shared.vao,".setVAO(null);"),ss(ye,ie,Ie,Xe.attributes,function(){return!0})),ai(ye,ie,Ie,Xe.uniforms,function(){return!0}),Yn(ye,ie,ie,Ie)}function ao(ye,ie){var Ie=ye.proc("draw",1);mo(ye,Ie),Mo(ye,Ie,ie.context),Po(ye,Ie,ie.framebuffer),is(ye,Ie,ie),os(ye,Ie,ie.state),wr(ye,Ie,ie,!1,!0);var Xe=ie.shader.progVar.append(ye,Ie);if(Ie(ye.shared.gl,".useProgram(",Xe,".program);"),ie.shader.program)Wr(ye,Ie,ie,ie.shader.program);else{Ie(ye.shared.vao,".setVAO(null);");var Qe=ye.global.def("{}"),Be=Ie.def(Xe,".id"),Le=Ie.def(Qe,"[",Be,"]");Ie(ye.cond(Le).then(Le,".call(this,a0);").else(Le,"=",Qe,"[",Be,"]=",ye.link(function($e){return kr(Wr,ye,ie,$e,1)}),"(",Xe,");",Le,".call(this,a0);"))}Object.keys(ie.state).length>0&&Ie(ye.shared.current,".dirty=true;")}function Us(ye,ie,Ie,Xe){ye.batchId="a1",mo(ye,ie);function Qe(){return!0}ss(ye,ie,Ie,Xe.attributes,Qe),ai(ye,ie,Ie,Xe.uniforms,Qe),Yn(ye,ie,ie,Ie)}function Ed(ye,ie,Ie,Xe){mo(ye,ie);var Qe=Ie.contextDep,Be=ie.def(),Le="a0",$e="a1",xe=ie.def();ye.shared.props=xe,ye.batchId=Be;var Ne=ye.scope(),me=ye.scope();ie(Ne.entry,"for(",Be,"=0;",Be,"<",$e,";++",Be,"){",xe,"=",Le,"[",Be,"];",me,"}",Ne.exit);function We(Fn){return Fn.contextDep&&Qe||Fn.propDep}function nt(Fn){return!We(Fn)}if(Ie.needsContext&&Mo(ye,me,Ie.context),Ie.needsFramebuffer&&Po(ye,me,Ie.framebuffer),os(ye,me,Ie.state,We),Ie.profile&&We(Ie.profile)&&wr(ye,me,Ie,!1,!0),Xe)Ie.useVAO?Ie.drawVAO?We(Ie.drawVAO)?me(ye.shared.vao,".setVAO(",Ie.drawVAO.append(ye,me),");"):Ne(ye.shared.vao,".setVAO(",Ie.drawVAO.append(ye,Ne),");"):Ne(ye.shared.vao,".setVAO(",ye.shared.vao,".targetVAO);"):(Ne(ye.shared.vao,".setVAO(null);"),ss(ye,Ne,Ie,Xe.attributes,nt),ss(ye,me,Ie,Xe.attributes,We)),ai(ye,Ne,Ie,Xe.uniforms,nt),ai(ye,me,Ie,Xe.uniforms,We),Yn(ye,Ne,me,Ie);else{var dt=ye.global.def("{}"),Mt=Ie.shader.progVar.append(ye,me),Et=me.def(Mt,".id"),qt=me.def(dt,"[",Et,"]");me(ye.shared.gl,".useProgram(",Mt,".program);","if(!",qt,"){",qt,"=",dt,"[",Et,"]=",ye.link(function(Fn){return kr(Us,ye,Ie,Fn,2)}),"(",Mt,");}",qt,".call(this,a0[",Be,"],",Be,");")}}function Te(ye,ie){var Ie=ye.proc("batch",2);ye.batchId="0",mo(ye,Ie);var Xe=!1,Qe=!0;Object.keys(ie.context).forEach(function(dt){Xe=Xe||ie.context[dt].propDep}),Xe||(Mo(ye,Ie,ie.context),Qe=!1);var Be=ie.framebuffer,Le=!1;Be?(Be.propDep?Xe=Le=!0:Be.contextDep&&Xe&&(Le=!0),Le||Po(ye,Ie,Be)):Po(ye,Ie,null),ie.state.viewport&&ie.state.viewport.propDep&&(Xe=!0);function $e(dt){return dt.contextDep&&Xe||dt.propDep}is(ye,Ie,ie),os(ye,Ie,ie.state,function(dt){return!$e(dt)}),(!ie.profile||!$e(ie.profile))&&wr(ye,Ie,ie,!1,"a1"),ie.contextDep=Xe,ie.needsContext=Qe,ie.needsFramebuffer=Le;var xe=ie.shader.progVar;if(xe.contextDep&&Xe||xe.propDep)Ed(ye,Ie,ie,null);else{var Ne=xe.append(ye,Ie);if(Ie(ye.shared.gl,".useProgram(",Ne,".program);"),ie.shader.program)Ed(ye,Ie,ie,ie.shader.program);else{Ie(ye.shared.vao,".setVAO(null);");var me=ye.global.def("{}"),We=Ie.def(Ne,".id"),nt=Ie.def(me,"[",We,"]");Ie(ye.cond(nt).then(nt,".call(this,a0,a1);").else(nt,"=",me,"[",We,"]=",ye.link(function(dt){return kr(Ed,ye,ie,dt,2)}),"(",Ne,");",nt,".call(this,a0,a1);"))}}Object.keys(ie.state).length>0&&Ie(ye.shared.current,".dirty=true;")}function ut(ye,ie){var Ie=ye.proc("scope",3);ye.batchId="a2";var Xe=ye.shared,Qe=Xe.current;Mo(ye,Ie,ie.context),ie.framebuffer&&ie.framebuffer.append(ye,Ie),Hf(Object.keys(ie.state)).forEach(function(Le){var $e=ie.state[Le],xe=$e.append(ye,Ie);br(xe)?xe.forEach(function(Ne,me){Ie.set(ye.next[Le],"["+me+"]",Ne)}):Ie.set(Xe.next,"."+Le,xe)}),wr(ye,Ie,ie,!0,!0),[Ha,gu,dl,Rf,$a].forEach(function(Le){var $e=ie.draw[Le];!$e||Ie.set(Xe.draw,"."+Le,""+$e.append(ye,Ie))}),Object.keys(ie.uniforms).forEach(function(Le){var $e=ie.uniforms[Le].append(ye,Ie);Array.isArray($e)&&($e="["+$e.join()+"]"),Ie.set(Xe.uniforms,"["+de.id(Le)+"]",$e)}),Object.keys(ie.attributes).forEach(function(Le){var $e=ie.attributes[Le].append(ye,Ie),xe=ye.scopeAttrib(Le);Object.keys(new Je).forEach(function(Ne){Ie.set(xe,"."+Ne,$e[Ne])})}),ie.scopeVAO&&Ie.set(Xe.vao,".targetVAO",ie.scopeVAO.append(ye,Ie));function Be(Le){var $e=ie.shader[Le];$e&&Ie.set(Xe.shader,"."+Le,$e.append(ye,Ie))}Be(Pc),Be($l),Object.keys(ie.state).length>0&&(Ie(Qe,".dirty=true;"),Ie.exit(Qe,".dirty=true;")),Ie("a1(",ye.shared.context,",a0,",ye.batchId,");")}function ot(ye){if(!(typeof ye!="object"||br(ye))){for(var ie=Object.keys(ye),Ie=0;Ie<ie.length;++Ie)if(Ss.isDynamic(ye[ie[Ie]]))return!0;return!1}}function wn(ye,ie,Ie){var Xe=ie.static[Ie];if(!Xe||!ot(Xe))return;var Qe=ye.global,Be=Object.keys(Xe),Le=!1,$e=!1,xe=!1,Ne=ye.global.def("{}");Be.forEach(function(We){var nt=Xe[We];if(Ss.isDynamic(nt)){typeof nt=="function"&&(nt=Xe[We]=Ss.unbox(nt));var dt=Fi(nt,null);Le=Le||dt.thisDep,xe=xe||dt.propDep,$e=$e||dt.contextDep}else{switch(Qe(Ne,".",We,"="),typeof nt){case"number":Qe(nt);break;case"string":Qe('"',nt,'"');break;case"object":Array.isArray(nt)&&Qe("[",nt.join(),"]");break;default:Qe(ye.link(nt));break}Qe(";")}});function me(We,nt){Be.forEach(function(dt){var Mt=Xe[dt];if(!!Ss.isDynamic(Mt)){var Et=We.invoke(nt,Mt);nt(Ne,".",dt,"=",Et,";")}})}ie.dynamic[Ie]=new Ss.DynamicVariable(al,{thisDep:Le,contextDep:$e,propDep:xe,ref:Ne,append:me}),delete ie.static[Ie]}function Rr(ye,ie,Ie,Xe,Qe){var Be=Jn();Be.stats=Be.link(Qe),Object.keys(ie.static).forEach(function($e){wn(Be,ie,$e)}),vu.forEach(function($e){wn(Be,ye,$e)});var Le=so(ye,ie,Ie,Xe,Be);return ao(Be,Le),ut(Be,Le),Te(Be,Le),P(Be.compile(),{destroy:function(){Le.shader.program.destroy()}})}return{next:Cn,current:Dt,procs:function(){var ye=Jn(),ie=ye.proc("poll"),Ie=ye.proc("refresh"),Xe=ye.block();ie(Xe),Ie(Xe);var Qe=ye.shared,Be=Qe.gl,Le=Qe.next,$e=Qe.current;Xe($e,".dirty=false;"),Po(ye,ie),Po(ye,Ie,null,!0);var xe;Jt&&(xe=ye.link(Jt)),_e.oes_vertex_array_object&&Ie(ye.link(_e.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Ne=0;Ne<at.maxAttributes;++Ne){var me=Ie.def(Qe.attributes,"[",Ne,"]"),We=ye.cond(me,".buffer");We.then(Be,".enableVertexAttribArray(",Ne,");",Be,".bindBuffer(",Zl,",",me,".buffer.buffer);",Be,".vertexAttribPointer(",Ne,",",me,".size,",me,".type,",me,".normalized,",me,".stride,",me,".offset);").else(Be,".disableVertexAttribArray(",Ne,");",Be,".vertexAttrib4f(",Ne,",",me,".x,",me,".y,",me,".z,",me,".w);",me,".buffer=null;"),Ie(We),Jt&&Ie(xe,".vertexAttribDivisorANGLE(",Ne,",",me,".divisor);")}return Ie(ye.shared.vao,".currentVAO=null;",ye.shared.vao,".setVAO(",ye.shared.vao,".targetVAO);"),Object.keys(ln).forEach(function(nt){var dt=ln[nt],Mt=Xe.def(Le,".",nt),Et=ye.block();Et("if(",Mt,"){",Be,".enable(",dt,")}else{",Be,".disable(",dt,")}",$e,".",nt,"=",Mt,";"),Ie(Et),ie("if(",Mt,"!==",$e,".",nt,"){",Et,"}")}),Object.keys(Nt).forEach(function(nt){var dt=Nt[nt],Mt=Dt[nt],Et,qt,Fn=ye.block();if(Fn(Be,".",dt,"("),br(Mt)){var ar=Mt.length;Et=ye.global.def(Le,".",nt),qt=ye.global.def($e,".",nt),Fn(No(ar,function(Tn){return Et+"["+Tn+"]"}),");",No(ar,function(Tn){return qt+"["+Tn+"]="+Et+"["+Tn+"];"}).join("")),ie("if(",No(ar,function(Tn){return Et+"["+Tn+"]!=="+qt+"["+Tn+"]"}).join("||"),"){",Fn,"}")}else Et=Xe.def(Le,".",nt),qt=Xe.def($e,".",nt),Fn(Et,");",$e,".",nt,"=",Et,";"),ie("if(",Et,"!==",qt,"){",Fn,"}");Ie(Fn)}),ye.compile()}(),compile:Rr}}function Cm(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var $f=34918,wm=34919,Em=35007,Sm=function(z,de){if(!de.ext_disjoint_timer_query)return null;var _e=[];function at(){return _e.pop()||de.ext_disjoint_timer_query.createQueryEXT()}function Tt(Jt){_e.push(Jt)}var lt=[];function mt(Jt){var mn=at();de.ext_disjoint_timer_query.beginQueryEXT(Em,mn),lt.push(mn),Ut(lt.length-1,lt.length,Jt)}function zt(){de.ext_disjoint_timer_query.endQueryEXT(Em)}function Ht(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Kt=[];function $t(){return Kt.pop()||new Ht}function sn(Jt){Kt.push(Jt)}var fn=[];function Ut(Jt,mn,Dt){var Cn=$t();Cn.startQueryIndex=Jt,Cn.endQueryIndex=mn,Cn.sum=0,Cn.stats=Dt,fn.push(Cn)}var an=[],Je=[];function yt(){var Jt,mn,Dt=lt.length;if(Dt!==0){Je.length=Math.max(Je.length,Dt+1),an.length=Math.max(an.length,Dt+1),an[0]=0,Je[0]=0;var Cn=0;for(Jt=0,mn=0;mn<lt.length;++mn){var Ft=lt[mn];de.ext_disjoint_timer_query.getQueryObjectEXT(Ft,wm)?(Cn+=de.ext_disjoint_timer_query.getQueryObjectEXT(Ft,$f),Tt(Ft)):lt[Jt++]=Ft,an[mn+1]=Cn,Je[mn+1]=Jt}for(lt.length=Jt,Jt=0,mn=0;mn<fn.length;++mn){var ln=fn[mn],Nt=ln.startQueryIndex,un=ln.endQueryIndex;ln.sum+=an[un]-an[Nt];var $n=Je[Nt],lr=Je[un];lr===$n?(ln.stats.gpuTime+=ln.sum/1e6,sn(ln)):(ln.startQueryIndex=$n,ln.endQueryIndex=lr,fn[Jt++]=ln)}fn.length=Jt}}return{beginQuery:mt,endQuery:zt,pushScopeStats:Ut,update:yt,getNumPendingQueries:function(){return lt.length},clear:function(){_e.push.apply(_e,lt);for(var Jt=0;Jt<_e.length;Jt++)de.ext_disjoint_timer_query.deleteQueryEXT(_e[Jt]);lt.length=0,_e.length=0},restore:function(){lt.length=0,_e.length=0}}},nv=16384,xd=256,Eh=1024,Cd=34962,ng="webglcontextlost",Sh="webglcontextrestored",wd=1,Wf=2,xu=3;function Ah(z,de){for(var _e=0;_e<z.length;++_e)if(z[_e]===de)return _e;return-1}function Rc(z){var de=Fp(z);if(!de)return null;var _e=de.gl,at=_e.getContextAttributes(),Tt=_e.isContextLost(),lt=F(_e,de);if(!lt)return null;var mt=ac(),zt=Cm(),Ht=lt.extensions,Kt=Sm(_e,Ht),$t=Ks(),sn=_e.drawingBufferWidth,fn=_e.drawingBufferHeight,Ut={tick:0,time:0,viewportWidth:sn,viewportHeight:fn,framebufferWidth:sn,framebufferHeight:fn,drawingBufferWidth:sn,drawingBufferHeight:fn,pixelRatio:de.pixelRatio},an={},Je={elements:null,primitive:4,count:-1,offset:0,instances:-1},yt=_l(_e,Ht),Jt=ea(_e,zt,de,Dt),mn=io(_e,Ht,yt,zt,Jt);function Dt(Yn){return mn.destroyBuffer(Yn)}var Cn=Ir(_e,Ht,Jt,zt),Ft=Df(_e,mt,zt,de),ln=il(_e,Ht,yt,function(){$n.procs.poll()},Ut,zt,de),Nt=wf(_e,Ht,yt,zt,de),un=tm(_e,Ht,yt,ln,Nt,zt),$n=tv(_e,mt,Ht,yt,Jt,Cn,ln,un,an,mn,Ft,Je,Ut,Kt,de),lr=Wp(_e,un,$n.procs.poll,Ut,at,Ht,yt),pn=$n.next,en=_e.canvas,Ot=[],Jn=[],Ar=[],Mn=[de.onDestroy],Lr=null;function hr(){if(Ot.length===0){Kt&&Kt.update(),Lr=null;return}Lr=Jo.next(hr),os();for(var Yn=Ot.length-1;Yn>=0;--Yn){var kr=Ot[Yn];kr&&kr(Ut,null,0)}_e.flush(),Kt&&Kt.update()}function Mr(){!Lr&&Ot.length>0&&(Lr=Jo.next(hr))}function si(){Lr&&(Jo.cancel(hr),Lr=null)}function To(Yn){Yn.preventDefault(),Tt=!0,si(),Jn.forEach(function(kr){kr()})}function Wo(Yn){_e.getError(),Tt=!1,lt.restore(),Ft.restore(),Jt.restore(),ln.restore(),Nt.restore(),un.restore(),mn.restore(),Kt&&Kt.restore(),$n.procs.refresh(),Mr(),Ar.forEach(function(kr){kr()})}en&&(en.addEventListener(ng,To,!1),en.addEventListener(Sh,Wo,!1));function Vr(){Ot.length=0,si(),en&&(en.removeEventListener(ng,To),en.removeEventListener(Sh,Wo)),Ft.clear(),un.clear(),Nt.clear(),ln.clear(),Cn.clear(),Jt.clear(),mn.clear(),Kt&&Kt.clear(),Mn.forEach(function(Yn){Yn()})}function oo(Yn){fe(!!Yn,"invalid args to regl({...})"),fe.type(Yn,"object","invalid args to regl({...})");function kr(Qe){var Be=P({},Qe);delete Be.uniforms,delete Be.attributes,delete Be.context,delete Be.vao,"stencil"in Be&&Be.stencil.op&&(Be.stencil.opBack=Be.stencil.opFront=Be.stencil.op,delete Be.stencil.op);function Le($e){if($e in Be){var xe=Be[$e];delete Be[$e],Object.keys(xe).forEach(function(Ne){Be[$e+"."+Ne]=xe[Ne]})}}return Le("blend"),Le("depth"),Le("cull"),Le("stencil"),Le("polygonOffset"),Le("scissor"),Le("sample"),"vao"in Qe&&(Be.vao=Qe.vao),Be}function Wr(Qe,Be){var Le={},$e={};return Object.keys(Qe).forEach(function(xe){var Ne=Qe[xe];if(Ss.isDynamic(Ne)){$e[xe]=Ss.unbox(Ne,xe);return}else if(Be&&Array.isArray(Ne)){for(var me=0;me<Ne.length;++me)if(Ss.isDynamic(Ne[me])){$e[xe]=Ss.unbox(Ne,xe);return}}Le[xe]=Ne}),{dynamic:$e,static:Le}}var ao=Wr(Yn.context||{},!0),Us=Wr(Yn.uniforms||{},!0),Ed=Wr(Yn.attributes||{},!1),Te=Wr(kr(Yn),!1),ut={gpuTime:0,cpuTime:0,count:0},ot=$n.compile(Te,Ed,Us,ao,ut),wn=ot.draw,Rr=ot.batch,ye=ot.scope,ie=[];function Ie(Qe){for(;ie.length<Qe;)ie.push(null);return ie}function Xe(Qe,Be){var Le;if(Tt&&fe.raise("context lost"),typeof Qe=="function")return ye.call(this,null,Qe,0);if(typeof Be=="function")if(typeof Qe=="number")for(Le=0;Le<Qe;++Le)ye.call(this,null,Be,Le);else if(Array.isArray(Qe))for(Le=0;Le<Qe.length;++Le)ye.call(this,Qe[Le],Be,Le);else return ye.call(this,Qe,Be,0);else if(typeof Qe=="number"){if(Qe>0)return Rr.call(this,Ie(Qe|0),Qe|0)}else if(Array.isArray(Qe)){if(Qe.length)return Rr.call(this,Qe,Qe.length)}else return wn.call(this,Qe)}return P(Xe,{stats:ut,destroy:function(){ot.destroy()}})}var fi=un.setFBO=oo({framebuffer:Ss.define.call(null,wd,"framebuffer")});function so(Yn,kr){var Wr=0;$n.procs.poll();var ao=kr.color;ao&&(_e.clearColor(+ao[0]||0,+ao[1]||0,+ao[2]||0,+ao[3]||0),Wr|=nv),"depth"in kr&&(_e.clearDepth(+kr.depth),Wr|=xd),"stencil"in kr&&(_e.clearStencil(kr.stencil|0),Wr|=Eh),fe(!!Wr,"called regl.clear with no buffer specified"),_e.clear(Wr)}function Mo(Yn){if(fe(typeof Yn=="object"&&Yn,"regl.clear() takes an object as input"),"framebuffer"in Yn)if(Yn.framebuffer&&Yn.framebuffer_reglType==="framebufferCube")for(var kr=0;kr<6;++kr)fi(P({framebuffer:Yn.framebuffer.faces[kr]},Yn),so);else fi(Yn,so);else so(null,Yn)}function Po(Yn){fe.type(Yn,"function","regl.frame() callback must be a function"),Ot.push(Yn);function kr(){var Wr=Ah(Ot,Yn);fe(Wr>=0,"cannot cancel a frame twice");function ao(){var Us=Ah(Ot,ao);Ot[Us]=Ot[Ot.length-1],Ot.length-=1,Ot.length<=0&&si()}Ot[Wr]=ao}return Mr(),{cancel:kr}}function is(){var Yn=pn.viewport,kr=pn.scissor_box;Yn[0]=Yn[1]=kr[0]=kr[1]=0,Ut.viewportWidth=Ut.framebufferWidth=Ut.drawingBufferWidth=Yn[2]=kr[2]=_e.drawingBufferWidth,Ut.viewportHeight=Ut.framebufferHeight=Ut.drawingBufferHeight=Yn[3]=kr[3]=_e.drawingBufferHeight}function os(){Ut.tick+=1,Ut.time=wr(),is(),$n.procs.poll()}function mo(){ln.refresh(),is(),$n.procs.refresh(),Kt&&Kt.update()}function wr(){return(Ks()-$t)/1e3}mo();function ss(Yn,kr){fe.type(kr,"function","listener callback must be a function");var Wr;switch(Yn){case"frame":return Po(kr);case"lost":Wr=Jn;break;case"restore":Wr=Ar;break;case"destroy":Wr=Mn;break;default:fe.raise("invalid event, must be one of frame,lost,restore,destroy")}return Wr.push(kr),{cancel:function(){for(var ao=0;ao<Wr.length;++ao)if(Wr[ao]===kr){Wr[ao]=Wr[Wr.length-1],Wr.pop();return}}}}var ai=P(oo,{clear:Mo,prop:Ss.define.bind(null,wd),context:Ss.define.bind(null,Wf),this:Ss.define.bind(null,xu),draw:oo({}),buffer:function(Yn){return Jt.create(Yn,Cd,!1,!1)},elements:function(Yn){return Cn.create(Yn,!1)},texture:ln.create2D,cube:ln.createCube,renderbuffer:Nt.create,framebuffer:un.create,framebufferCube:un.createCube,vao:mn.createVAO,attributes:at,frame:Po,on:ss,limits:yt,hasExtension:function(Yn){return yt.extensions.indexOf(Yn.toLowerCase())>=0},read:lr,destroy:Vr,_gl:_e,_refresh:mo,poll:function(){os(),Kt&&Kt.update()},now:wr,stats:zt});return de.onDone(null,ai),ai}return Rc})},94633:function(je){je.exports=function(J){return $(P(J),J)},je.exports.array=$;function $(J,U){var pe=J.length,ke=new Array(pe),Ce={},ge=pe,Me=Z(U),Se=H(J);for(U.forEach(function(oe){if(!Se.has(oe[0])||!Se.has(oe[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});ge--;)Ce[ge]||ee(J[ge],ge,new Set);return ke;function ee(oe,Ae,X){if(X.has(oe)){var le;try{le=", node was:"+JSON.stringify(oe)}catch{le=""}throw new Error("Cyclic dependency"+le)}if(!Se.has(oe))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(oe));if(!Ce[Ae]){Ce[Ae]=!0;var Q=Me.get(oe)||new Set;if(Q=Array.from(Q),Ae=Q.length){X.add(oe);do{var ne=Q[--Ae];ee(ne,Se.get(ne),X)}while(Ae);X.delete(oe)}ke[--pe]=oe}}}function P(J){for(var U=new Set,pe=0,ke=J.length;pe<ke;pe++){var Ce=J[pe];U.add(Ce[0]),U.add(Ce[1])}return Array.from(U)}function Z(J){for(var U=new Map,pe=0,ke=J.length;pe<ke;pe++){var Ce=J[pe];U.has(Ce[0])||U.set(Ce[0],new Set),U.has(Ce[1])||U.set(Ce[1],new Set),U.get(Ce[0]).add(Ce[1])}return U}function H(J){for(var U=new Map,pe=0,ke=J.length;pe<ke;pe++)U.set(J[pe],pe);return U}}}]);
